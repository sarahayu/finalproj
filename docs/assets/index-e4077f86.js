function RI(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var zI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function s3(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Cw={exports:{}},Xn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R2=Symbol.for("react.element"),BI=Symbol.for("react.portal"),OI=Symbol.for("react.fragment"),FI=Symbol.for("react.strict_mode"),NI=Symbol.for("react.profiler"),UI=Symbol.for("react.provider"),VI=Symbol.for("react.context"),GI=Symbol.for("react.forward_ref"),jI=Symbol.for("react.suspense"),HI=Symbol.for("react.memo"),WI=Symbol.for("react.lazy"),b9=Symbol.iterator;function $I(t){return t===null||typeof t!="object"?null:(t=b9&&t[b9]||t["@@iterator"],typeof t=="function"?t:null)}var Pw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Mw=Object.assign,Iw={};function I1(t,e,n){this.props=t,this.context=e,this.refs=Iw,this.updater=n||Pw}I1.prototype.isReactComponent={};I1.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};I1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kw(){}kw.prototype=I1.prototype;function jg(t,e,n){this.props=t,this.context=e,this.refs=Iw,this.updater=n||Pw}var Hg=jg.prototype=new kw;Hg.constructor=jg;Mw(Hg,I1.prototype);Hg.isPureReactComponent=!0;var E9=Array.isArray,Lw=Object.prototype.hasOwnProperty,Wg={current:null},Dw={key:!0,ref:!0,__self:!0,__source:!0};function Rw(t,e,n){var i,r={},s=null,u=null;if(e!=null)for(i in e.ref!==void 0&&(u=e.ref),e.key!==void 0&&(s=""+e.key),e)Lw.call(e,i)&&!Dw.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var y=Array(a),w=0;w<a;w++)y[w]=arguments[w+2];r.children=y}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:R2,type:t,key:s,ref:u,props:r,_owner:Wg.current}}function qI(t,e){return{$$typeof:R2,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $g(t){return typeof t=="object"&&t!==null&&t.$$typeof===R2}function ZI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var T9=/\/+/g;function Sm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ZI(""+t.key):e.toString(36)}function vd(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var u=!1;if(t===null)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case R2:case BI:u=!0}}if(u)return u=t,r=r(u),t=i===""?"."+Sm(u,0):i,E9(r)?(n="",t!=null&&(n=t.replace(T9,"$&/")+"/"),vd(r,e,n,"",function(w){return w})):r!=null&&($g(r)&&(r=qI(r,n+(!r.key||u&&u.key===r.key?"":(""+r.key).replace(T9,"$&/")+"/")+t)),e.push(r)),1;if(u=0,i=i===""?".":i+":",E9(t))for(var a=0;a<t.length;a++){s=t[a];var y=i+Sm(s,a);u+=vd(s,e,n,y,r)}else if(y=$I(t),typeof y=="function")for(t=y.call(t),a=0;!(s=t.next()).done;)s=s.value,y=i+Sm(s,a++),u+=vd(s,e,n,y,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return u}function EA(t,e,n){if(t==null)return t;var i=[],r=0;return vd(t,i,"","",function(s){return e.call(n,s,r++)}),i}function XI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Cs={current:null},xd={transition:null},QI={ReactCurrentDispatcher:Cs,ReactCurrentBatchConfig:xd,ReactCurrentOwner:Wg};Xn.Children={map:EA,forEach:function(t,e,n){EA(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return EA(t,function(){e++}),e},toArray:function(t){return EA(t,function(e){return e})||[]},only:function(t){if(!$g(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Xn.Component=I1;Xn.Fragment=OI;Xn.Profiler=NI;Xn.PureComponent=jg;Xn.StrictMode=FI;Xn.Suspense=jI;Xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QI;Xn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=Mw({},t.props),r=t.key,s=t.ref,u=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,u=Wg.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(y in e)Lw.call(e,y)&&!Dw.hasOwnProperty(y)&&(i[y]=e[y]===void 0&&a!==void 0?a[y]:e[y])}var y=arguments.length-2;if(y===1)i.children=n;else if(1<y){a=Array(y);for(var w=0;w<y;w++)a[w]=arguments[w+2];i.children=a}return{$$typeof:R2,type:t.type,key:r,ref:s,props:i,_owner:u}};Xn.createContext=function(t){return t={$$typeof:VI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:UI,_context:t},t.Consumer=t};Xn.createElement=Rw;Xn.createFactory=function(t){var e=Rw.bind(null,t);return e.type=t,e};Xn.createRef=function(){return{current:null}};Xn.forwardRef=function(t){return{$$typeof:GI,render:t}};Xn.isValidElement=$g;Xn.lazy=function(t){return{$$typeof:WI,_payload:{_status:-1,_result:t},_init:XI}};Xn.memo=function(t,e){return{$$typeof:HI,type:t,compare:e===void 0?null:e}};Xn.startTransition=function(t){var e=xd.transition;xd.transition={};try{t()}finally{xd.transition=e}};Xn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Xn.useCallback=function(t,e){return Cs.current.useCallback(t,e)};Xn.useContext=function(t){return Cs.current.useContext(t)};Xn.useDebugValue=function(){};Xn.useDeferredValue=function(t){return Cs.current.useDeferredValue(t)};Xn.useEffect=function(t,e){return Cs.current.useEffect(t,e)};Xn.useId=function(){return Cs.current.useId()};Xn.useImperativeHandle=function(t,e,n){return Cs.current.useImperativeHandle(t,e,n)};Xn.useInsertionEffect=function(t,e){return Cs.current.useInsertionEffect(t,e)};Xn.useLayoutEffect=function(t,e){return Cs.current.useLayoutEffect(t,e)};Xn.useMemo=function(t,e){return Cs.current.useMemo(t,e)};Xn.useReducer=function(t,e,n){return Cs.current.useReducer(t,e,n)};Xn.useRef=function(t){return Cs.current.useRef(t)};Xn.useState=function(t){return Cs.current.useState(t)};Xn.useSyncExternalStore=function(t,e,n){return Cs.current.useSyncExternalStore(t,e,n)};Xn.useTransition=function(){return Cs.current.useTransition()};Xn.version="18.2.0";Cw.exports=Xn;var _t=Cw.exports;const En=s3(_t);var zw={exports:{}},_o={},Bw={exports:{}},Ow={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(yt,Ot){var Jt=yt.length;yt.push(Ot);e:for(;0<Jt;){var In=Jt-1>>>1,Tn=yt[In];if(0<r(Tn,Ot))yt[In]=Ot,yt[Jt]=Tn,Jt=In;else break e}}function n(yt){return yt.length===0?null:yt[0]}function i(yt){if(yt.length===0)return null;var Ot=yt[0],Jt=yt.pop();if(Jt!==Ot){yt[0]=Jt;e:for(var In=0,Tn=yt.length,Di=Tn>>>1;In<Di;){var di=2*(In+1)-1,ii=yt[di],hi=di+1,On=yt[hi];if(0>r(ii,Jt))hi<Tn&&0>r(On,ii)?(yt[In]=On,yt[hi]=Jt,In=hi):(yt[In]=ii,yt[di]=Jt,In=di);else if(hi<Tn&&0>r(On,Jt))yt[In]=On,yt[hi]=Jt,In=hi;else break e}}return Ot}function r(yt,Ot){var Jt=yt.sortIndex-Ot.sortIndex;return Jt!==0?Jt:yt.id-Ot.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var u=Date,a=u.now();t.unstable_now=function(){return u.now()-a}}var y=[],w=[],M=1,R=null,L=3,U=!1,q=!1,te=!1,pe=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function re(yt){for(var Ot=n(w);Ot!==null;){if(Ot.callback===null)i(w);else if(Ot.startTime<=yt)i(w),Ot.sortIndex=Ot.expirationTime,e(y,Ot);else break;Ot=n(w)}}function _e(yt){if(te=!1,re(yt),!q)if(n(y)!==null)q=!0,Ft(Te);else{var Ot=n(w);Ot!==null&&Zn(_e,Ot.startTime-yt)}}function Te(yt,Ot){q=!1,te&&(te=!1,ne(nt),nt=-1),U=!0;var Jt=L;try{for(re(Ot),R=n(y);R!==null&&(!(R.expirationTime>Ot)||yt&&!lt());){var In=R.callback;if(typeof In=="function"){R.callback=null,L=R.priorityLevel;var Tn=In(R.expirationTime<=Ot);Ot=t.unstable_now(),typeof Tn=="function"?R.callback=Tn:R===n(y)&&i(y),re(Ot)}else i(y);R=n(y)}if(R!==null)var Di=!0;else{var di=n(w);di!==null&&Zn(_e,di.startTime-Ot),Di=!1}return Di}finally{R=null,L=Jt,U=!1}}var De=!1,$e=null,nt=-1,ut=5,st=-1;function lt(){return!(t.unstable_now()-st<ut)}function Lt(){if($e!==null){var yt=t.unstable_now();st=yt;var Ot=!0;try{Ot=$e(!0,yt)}finally{Ot?ht():(De=!1,$e=null)}}else De=!1}var ht;if(typeof ie=="function")ht=function(){ie(Lt)};else if(typeof MessageChannel<"u"){var Tt=new MessageChannel,Pn=Tt.port2;Tt.port1.onmessage=Lt,ht=function(){Pn.postMessage(null)}}else ht=function(){pe(Lt,0)};function Ft(yt){$e=yt,De||(De=!0,ht())}function Zn(yt,Ot){nt=pe(function(){yt(t.unstable_now())},Ot)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(yt){yt.callback=null},t.unstable_continueExecution=function(){q||U||(q=!0,Ft(Te))},t.unstable_forceFrameRate=function(yt){0>yt||125<yt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ut=0<yt?Math.floor(1e3/yt):5},t.unstable_getCurrentPriorityLevel=function(){return L},t.unstable_getFirstCallbackNode=function(){return n(y)},t.unstable_next=function(yt){switch(L){case 1:case 2:case 3:var Ot=3;break;default:Ot=L}var Jt=L;L=Ot;try{return yt()}finally{L=Jt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(yt,Ot){switch(yt){case 1:case 2:case 3:case 4:case 5:break;default:yt=3}var Jt=L;L=yt;try{return Ot()}finally{L=Jt}},t.unstable_scheduleCallback=function(yt,Ot,Jt){var In=t.unstable_now();switch(typeof Jt=="object"&&Jt!==null?(Jt=Jt.delay,Jt=typeof Jt=="number"&&0<Jt?In+Jt:In):Jt=In,yt){case 1:var Tn=-1;break;case 2:Tn=250;break;case 5:Tn=1073741823;break;case 4:Tn=1e4;break;default:Tn=5e3}return Tn=Jt+Tn,yt={id:M++,callback:Ot,priorityLevel:yt,startTime:Jt,expirationTime:Tn,sortIndex:-1},Jt>In?(yt.sortIndex=Jt,e(w,yt),n(y)===null&&yt===n(w)&&(te?(ne(nt),nt=-1):te=!0,Zn(_e,Jt-In))):(yt.sortIndex=Tn,e(y,yt),q||U||(q=!0,Ft(Te))),yt},t.unstable_shouldYield=lt,t.unstable_wrapCallback=function(yt){var Ot=L;return function(){var Jt=L;L=Ot;try{return yt.apply(this,arguments)}finally{L=Jt}}}})(Ow);Bw.exports=Ow;var YI=Bw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fw=_t,mo=YI;function vt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nw=new Set,i2={};function yu(t,e){o1(t,e),o1(t+"Capture",e)}function o1(t,e){for(i2[t]=e,t=0;t<e.length;t++)Nw.add(e[t])}var Yl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Y4=Object.prototype.hasOwnProperty,KI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S9={},C9={};function JI(t){return Y4.call(C9,t)?!0:Y4.call(S9,t)?!1:KI.test(t)?C9[t]=!0:(S9[t]=!0,!1)}function ek(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function tk(t,e,n,i){if(e===null||typeof e>"u"||ek(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ps(t,e,n,i,r,s,u){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=u}var jr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){jr[t]=new Ps(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];jr[e]=new Ps(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){jr[t]=new Ps(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){jr[t]=new Ps(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){jr[t]=new Ps(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){jr[t]=new Ps(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){jr[t]=new Ps(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){jr[t]=new Ps(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){jr[t]=new Ps(t,5,!1,t.toLowerCase(),null,!1,!1)});var qg=/[\-:]([a-z])/g;function Zg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(qg,Zg);jr[e]=new Ps(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(qg,Zg);jr[e]=new Ps(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(qg,Zg);jr[e]=new Ps(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){jr[t]=new Ps(t,1,!1,t.toLowerCase(),null,!1,!1)});jr.xlinkHref=new Ps("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){jr[t]=new Ps(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xg(t,e,n,i){var r=jr.hasOwnProperty(e)?jr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tk(e,n,r,i)&&(n=null),i||r===null?JI(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var c0=Fw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,TA=Symbol.for("react.element"),Sh=Symbol.for("react.portal"),Ch=Symbol.for("react.fragment"),Qg=Symbol.for("react.strict_mode"),K4=Symbol.for("react.profiler"),Uw=Symbol.for("react.provider"),Vw=Symbol.for("react.context"),Yg=Symbol.for("react.forward_ref"),J4=Symbol.for("react.suspense"),e5=Symbol.for("react.suspense_list"),Kg=Symbol.for("react.memo"),F0=Symbol.for("react.lazy"),Gw=Symbol.for("react.offscreen"),P9=Symbol.iterator;function lf(t){return t===null||typeof t!="object"?null:(t=P9&&t[P9]||t["@@iterator"],typeof t=="function"?t:null)}var ji=Object.assign,Cm;function kf(t){if(Cm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Cm=e&&e[1]||""}return`
`+Cm+t}var Pm=!1;function Mm(t,e){if(!t||Pm)return"";Pm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(w){var i=w}Reflect.construct(t,[],e)}else{try{e.call()}catch(w){i=w}t.call(e.prototype)}else{try{throw Error()}catch(w){i=w}t()}}catch(w){if(w&&i&&typeof w.stack=="string"){for(var r=w.stack.split(`
`),s=i.stack.split(`
`),u=r.length-1,a=s.length-1;1<=u&&0<=a&&r[u]!==s[a];)a--;for(;1<=u&&0<=a;u--,a--)if(r[u]!==s[a]){if(u!==1||a!==1)do if(u--,a--,0>a||r[u]!==s[a]){var y=`
`+r[u].replace(" at new "," at ");return t.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",t.displayName)),y}while(1<=u&&0<=a);break}}}finally{Pm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?kf(t):""}function nk(t){switch(t.tag){case 5:return kf(t.type);case 16:return kf("Lazy");case 13:return kf("Suspense");case 19:return kf("SuspenseList");case 0:case 2:case 15:return t=Mm(t.type,!1),t;case 11:return t=Mm(t.type.render,!1),t;case 1:return t=Mm(t.type,!0),t;default:return""}}function t5(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ch:return"Fragment";case Sh:return"Portal";case K4:return"Profiler";case Qg:return"StrictMode";case J4:return"Suspense";case e5:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vw:return(t.displayName||"Context")+".Consumer";case Uw:return(t._context.displayName||"Context")+".Provider";case Yg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Kg:return e=t.displayName||null,e!==null?e:t5(t.type)||"Memo";case F0:e=t._payload,t=t._init;try{return t5(t(e))}catch{}}return null}function ik(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return t5(e);case 8:return e===Qg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function rc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function jw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rk(t){var e=jw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(u){i=""+u,s.call(this,u)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(u){i=""+u},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function SA(t){t._valueTracker||(t._valueTracker=rk(t))}function Hw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=jw(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Qd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function n5(t,e){var n=e.checked;return ji({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function M9(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=rc(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ww(t,e){e=e.checked,e!=null&&Xg(t,"checked",e,!1)}function i5(t,e){Ww(t,e);var n=rc(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?r5(t,e.type,n):e.hasOwnProperty("defaultValue")&&r5(t,e.type,rc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function I9(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function r5(t,e,n){(e!=="number"||Qd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Lf=Array.isArray;function Xh(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+rc(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function s5(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(vt(91));return ji({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function k9(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(vt(92));if(Lf(n)){if(1<n.length)throw Error(vt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:rc(n)}}function $w(t,e){var n=rc(e.value),i=rc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function L9(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function qw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function o5(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?qw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var CA,Zw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(CA=CA||document.createElement("div"),CA.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=CA.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function r2(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Vf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sk=["Webkit","ms","Moz","O"];Object.keys(Vf).forEach(function(t){sk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vf[e]=Vf[t]})});function Xw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Vf.hasOwnProperty(t)&&Vf[t]?(""+e).trim():e+"px"}function Qw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=Xw(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var ok=ji({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function a5(t,e){if(e){if(ok[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(vt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(vt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(vt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(vt(62))}}function l5(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var c5=null;function Jg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var u5=null,Qh=null,Yh=null;function D9(t){if(t=O2(t)){if(typeof u5!="function")throw Error(vt(280));var e=t.stateNode;e&&(e=u3(e),u5(t.stateNode,t.type,e))}}function Yw(t){Qh?Yh?Yh.push(t):Yh=[t]:Qh=t}function Kw(){if(Qh){var t=Qh,e=Yh;if(Yh=Qh=null,D9(t),e)for(t=0;t<e.length;t++)D9(e[t])}}function Jw(t,e){return t(e)}function eb(){}var Im=!1;function tb(t,e,n){if(Im)return t(e,n);Im=!0;try{return Jw(t,e,n)}finally{Im=!1,(Qh!==null||Yh!==null)&&(eb(),Kw())}}function s2(t,e){var n=t.stateNode;if(n===null)return null;var i=u3(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(vt(231,e,typeof n));return n}var h5=!1;if(Yl)try{var cf={};Object.defineProperty(cf,"passive",{get:function(){h5=!0}}),window.addEventListener("test",cf,cf),window.removeEventListener("test",cf,cf)}catch{h5=!1}function ak(t,e,n,i,r,s,u,a,y){var w=Array.prototype.slice.call(arguments,3);try{e.apply(n,w)}catch(M){this.onError(M)}}var Gf=!1,Yd=null,Kd=!1,f5=null,lk={onError:function(t){Gf=!0,Yd=t}};function ck(t,e,n,i,r,s,u,a,y){Gf=!1,Yd=null,ak.apply(lk,arguments)}function uk(t,e,n,i,r,s,u,a,y){if(ck.apply(this,arguments),Gf){if(Gf){var w=Yd;Gf=!1,Yd=null}else throw Error(vt(198));Kd||(Kd=!0,f5=w)}}function vu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function nb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function R9(t){if(vu(t)!==t)throw Error(vt(188))}function hk(t){var e=t.alternate;if(!e){if(e=vu(t),e===null)throw Error(vt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return R9(r),t;if(s===i)return R9(r),e;s=s.sibling}throw Error(vt(188))}if(n.return!==i.return)n=r,i=s;else{for(var u=!1,a=r.child;a;){if(a===n){u=!0,n=r,i=s;break}if(a===i){u=!0,i=r,n=s;break}a=a.sibling}if(!u){for(a=s.child;a;){if(a===n){u=!0,n=s,i=r;break}if(a===i){u=!0,i=s,n=r;break}a=a.sibling}if(!u)throw Error(vt(189))}}if(n.alternate!==i)throw Error(vt(190))}if(n.tag!==3)throw Error(vt(188));return n.stateNode.current===n?t:e}function ib(t){return t=hk(t),t!==null?rb(t):null}function rb(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=rb(t);if(e!==null)return e;t=t.sibling}return null}var sb=mo.unstable_scheduleCallback,z9=mo.unstable_cancelCallback,fk=mo.unstable_shouldYield,Ak=mo.unstable_requestPaint,ir=mo.unstable_now,dk=mo.unstable_getCurrentPriorityLevel,e6=mo.unstable_ImmediatePriority,ob=mo.unstable_UserBlockingPriority,Jd=mo.unstable_NormalPriority,pk=mo.unstable_LowPriority,ab=mo.unstable_IdlePriority,o3=null,Ya=null;function mk(t){if(Ya&&typeof Ya.onCommitFiberRoot=="function")try{Ya.onCommitFiberRoot(o3,t,void 0,(t.current.flags&128)===128)}catch{}}var pa=Math.clz32?Math.clz32:yk,gk=Math.log,_k=Math.LN2;function yk(t){return t>>>=0,t===0?32:31-(gk(t)/_k|0)|0}var PA=64,MA=4194304;function Df(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ep(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,u=n&268435455;if(u!==0){var a=u&~r;a!==0?i=Df(a):(s&=u,s!==0&&(i=Df(s)))}else u=n&~r,u!==0?i=Df(u):s!==0&&(i=Df(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-pa(e),r=1<<n,i|=t[n],e&=~r;return i}function vk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xk(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var u=31-pa(s),a=1<<u,y=r[u];y===-1?(!(a&n)||a&i)&&(r[u]=vk(a,e)):y<=e&&(t.expiredLanes|=a),s&=~a}}function A5(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function lb(){var t=PA;return PA<<=1,!(PA&4194240)&&(PA=64),t}function km(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function z2(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pa(e),t[e]=n}function wk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-pa(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function t6(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-pa(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Ai=0;function cb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ub,n6,hb,fb,Ab,d5=!1,IA=[],q0=null,Z0=null,X0=null,o2=new Map,a2=new Map,U0=[],bk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function B9(t,e){switch(t){case"focusin":case"focusout":q0=null;break;case"dragenter":case"dragleave":Z0=null;break;case"mouseover":case"mouseout":X0=null;break;case"pointerover":case"pointerout":o2.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":a2.delete(e.pointerId)}}function uf(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=O2(e),e!==null&&n6(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function Ek(t,e,n,i,r){switch(e){case"focusin":return q0=uf(q0,t,e,n,i,r),!0;case"dragenter":return Z0=uf(Z0,t,e,n,i,r),!0;case"mouseover":return X0=uf(X0,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return o2.set(s,uf(o2.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,a2.set(s,uf(a2.get(s)||null,t,e,n,i,r)),!0}return!1}function db(t){var e=Zc(t.target);if(e!==null){var n=vu(e);if(n!==null){if(e=n.tag,e===13){if(e=nb(n),e!==null){t.blockedOn=e,Ab(t.priority,function(){hb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=p5(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);c5=i,n.target.dispatchEvent(i),c5=null}else return e=O2(n),e!==null&&n6(e),t.blockedOn=n,!1;e.shift()}return!0}function O9(t,e,n){wd(t)&&n.delete(e)}function Tk(){d5=!1,q0!==null&&wd(q0)&&(q0=null),Z0!==null&&wd(Z0)&&(Z0=null),X0!==null&&wd(X0)&&(X0=null),o2.forEach(O9),a2.forEach(O9)}function hf(t,e){t.blockedOn===e&&(t.blockedOn=null,d5||(d5=!0,mo.unstable_scheduleCallback(mo.unstable_NormalPriority,Tk)))}function l2(t){function e(r){return hf(r,t)}if(0<IA.length){hf(IA[0],t);for(var n=1;n<IA.length;n++){var i=IA[n];i.blockedOn===t&&(i.blockedOn=null)}}for(q0!==null&&hf(q0,t),Z0!==null&&hf(Z0,t),X0!==null&&hf(X0,t),o2.forEach(e),a2.forEach(e),n=0;n<U0.length;n++)i=U0[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<U0.length&&(n=U0[0],n.blockedOn===null);)db(n),n.blockedOn===null&&U0.shift()}var Kh=c0.ReactCurrentBatchConfig,tp=!0;function Sk(t,e,n,i){var r=Ai,s=Kh.transition;Kh.transition=null;try{Ai=1,i6(t,e,n,i)}finally{Ai=r,Kh.transition=s}}function Ck(t,e,n,i){var r=Ai,s=Kh.transition;Kh.transition=null;try{Ai=4,i6(t,e,n,i)}finally{Ai=r,Kh.transition=s}}function i6(t,e,n,i){if(tp){var r=p5(t,e,n,i);if(r===null)Vm(t,e,i,np,n),B9(t,i);else if(Ek(r,t,e,n,i))i.stopPropagation();else if(B9(t,i),e&4&&-1<bk.indexOf(t)){for(;r!==null;){var s=O2(r);if(s!==null&&ub(s),s=p5(t,e,n,i),s===null&&Vm(t,e,i,np,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Vm(t,e,i,null,n)}}var np=null;function p5(t,e,n,i){if(np=null,t=Jg(i),t=Zc(t),t!==null)if(e=vu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=nb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return np=t,null}function pb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dk()){case e6:return 1;case ob:return 4;case Jd:case pk:return 16;case ab:return 536870912;default:return 16}default:return 16}}var G0=null,r6=null,bd=null;function mb(){if(bd)return bd;var t,e=r6,n=e.length,i,r="value"in G0?G0.value:G0.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var u=n-t;for(i=1;i<=u&&e[n-i]===r[s-i];i++);return bd=r.slice(t,1<i?1-i:void 0)}function Ed(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function kA(){return!0}function F9(){return!1}function yo(t){function e(n,i,r,s,u){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=u,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?kA:F9,this.isPropagationStopped=F9,this}return ji(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kA)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kA)},persist:function(){},isPersistent:kA}),e}var k1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},s6=yo(k1),B2=ji({},k1,{view:0,detail:0}),Pk=yo(B2),Lm,Dm,ff,a3=ji({},B2,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:o6,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ff&&(ff&&t.type==="mousemove"?(Lm=t.screenX-ff.screenX,Dm=t.screenY-ff.screenY):Dm=Lm=0,ff=t),Lm)},movementY:function(t){return"movementY"in t?t.movementY:Dm}}),N9=yo(a3),Mk=ji({},a3,{dataTransfer:0}),Ik=yo(Mk),kk=ji({},B2,{relatedTarget:0}),Rm=yo(kk),Lk=ji({},k1,{animationName:0,elapsedTime:0,pseudoElement:0}),Dk=yo(Lk),Rk=ji({},k1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),zk=yo(Rk),Bk=ji({},k1,{data:0}),U9=yo(Bk),Ok={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Uk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Nk[t])?!!e[t]:!1}function o6(){return Uk}var Vk=ji({},B2,{key:function(t){if(t.key){var e=Ok[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ed(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Fk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:o6,charCode:function(t){return t.type==="keypress"?Ed(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ed(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Gk=yo(Vk),jk=ji({},a3,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),V9=yo(jk),Hk=ji({},B2,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:o6}),Wk=yo(Hk),$k=ji({},k1,{propertyName:0,elapsedTime:0,pseudoElement:0}),qk=yo($k),Zk=ji({},a3,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Xk=yo(Zk),Qk=[9,13,27,32],a6=Yl&&"CompositionEvent"in window,jf=null;Yl&&"documentMode"in document&&(jf=document.documentMode);var Yk=Yl&&"TextEvent"in window&&!jf,gb=Yl&&(!a6||jf&&8<jf&&11>=jf),G9=String.fromCharCode(32),j9=!1;function _b(t,e){switch(t){case"keyup":return Qk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ph=!1;function Kk(t,e){switch(t){case"compositionend":return yb(e);case"keypress":return e.which!==32?null:(j9=!0,G9);case"textInput":return t=e.data,t===G9&&j9?null:t;default:return null}}function Jk(t,e){if(Ph)return t==="compositionend"||!a6&&_b(t,e)?(t=mb(),bd=r6=G0=null,Ph=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gb&&e.locale!=="ko"?null:e.data;default:return null}}var eL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function H9(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!eL[t.type]:e==="textarea"}function vb(t,e,n,i){Yw(i),e=ip(e,"onChange"),0<e.length&&(n=new s6("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Hf=null,c2=null;function tL(t){kb(t,0)}function l3(t){var e=kh(t);if(Hw(e))return t}function nL(t,e){if(t==="change")return e}var xb=!1;if(Yl){var zm;if(Yl){var Bm="oninput"in document;if(!Bm){var W9=document.createElement("div");W9.setAttribute("oninput","return;"),Bm=typeof W9.oninput=="function"}zm=Bm}else zm=!1;xb=zm&&(!document.documentMode||9<document.documentMode)}function $9(){Hf&&(Hf.detachEvent("onpropertychange",wb),c2=Hf=null)}function wb(t){if(t.propertyName==="value"&&l3(c2)){var e=[];vb(e,c2,t,Jg(t)),tb(tL,e)}}function iL(t,e,n){t==="focusin"?($9(),Hf=e,c2=n,Hf.attachEvent("onpropertychange",wb)):t==="focusout"&&$9()}function rL(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return l3(c2)}function sL(t,e){if(t==="click")return l3(e)}function oL(t,e){if(t==="input"||t==="change")return l3(e)}function aL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var _a=typeof Object.is=="function"?Object.is:aL;function u2(t,e){if(_a(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Y4.call(e,r)||!_a(t[r],e[r]))return!1}return!0}function q9(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Z9(t,e){var n=q9(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=q9(n)}}function bb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?bb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Eb(){for(var t=window,e=Qd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qd(t.document)}return e}function l6(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function lL(t){var e=Eb(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&bb(n.ownerDocument.documentElement,n)){if(i!==null&&l6(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=Z9(n,s);var u=Z9(n,i);r&&u&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==u.node||t.focusOffset!==u.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(u.node,u.offset)):(e.setEnd(u.node,u.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var cL=Yl&&"documentMode"in document&&11>=document.documentMode,Mh=null,m5=null,Wf=null,g5=!1;function X9(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;g5||Mh==null||Mh!==Qd(i)||(i=Mh,"selectionStart"in i&&l6(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Wf&&u2(Wf,i)||(Wf=i,i=ip(m5,"onSelect"),0<i.length&&(e=new s6("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Mh)))}function LA(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ih={animationend:LA("Animation","AnimationEnd"),animationiteration:LA("Animation","AnimationIteration"),animationstart:LA("Animation","AnimationStart"),transitionend:LA("Transition","TransitionEnd")},Om={},Tb={};Yl&&(Tb=document.createElement("div").style,"AnimationEvent"in window||(delete Ih.animationend.animation,delete Ih.animationiteration.animation,delete Ih.animationstart.animation),"TransitionEvent"in window||delete Ih.transitionend.transition);function c3(t){if(Om[t])return Om[t];if(!Ih[t])return t;var e=Ih[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Tb)return Om[t]=e[n];return t}var Sb=c3("animationend"),Cb=c3("animationiteration"),Pb=c3("animationstart"),Mb=c3("transitionend"),Ib=new Map,Q9="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cc(t,e){Ib.set(t,e),yu(e,[t])}for(var Fm=0;Fm<Q9.length;Fm++){var Nm=Q9[Fm],uL=Nm.toLowerCase(),hL=Nm[0].toUpperCase()+Nm.slice(1);cc(uL,"on"+hL)}cc(Sb,"onAnimationEnd");cc(Cb,"onAnimationIteration");cc(Pb,"onAnimationStart");cc("dblclick","onDoubleClick");cc("focusin","onFocus");cc("focusout","onBlur");cc(Mb,"onTransitionEnd");o1("onMouseEnter",["mouseout","mouseover"]);o1("onMouseLeave",["mouseout","mouseover"]);o1("onPointerEnter",["pointerout","pointerover"]);o1("onPointerLeave",["pointerout","pointerover"]);yu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yu("onBeforeInput",["compositionend","keypress","textInput","paste"]);yu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fL=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rf));function Y9(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,uk(i,e,void 0,t),t.currentTarget=null}function kb(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var u=i.length-1;0<=u;u--){var a=i[u],y=a.instance,w=a.currentTarget;if(a=a.listener,y!==s&&r.isPropagationStopped())break e;Y9(r,a,w),s=y}else for(u=0;u<i.length;u++){if(a=i[u],y=a.instance,w=a.currentTarget,a=a.listener,y!==s&&r.isPropagationStopped())break e;Y9(r,a,w),s=y}}}if(Kd)throw t=f5,Kd=!1,f5=null,t}function ki(t,e){var n=e[w5];n===void 0&&(n=e[w5]=new Set);var i=t+"__bubble";n.has(i)||(Lb(e,t,2,!1),n.add(i))}function Um(t,e,n){var i=0;e&&(i|=4),Lb(n,t,i,e)}var DA="_reactListening"+Math.random().toString(36).slice(2);function h2(t){if(!t[DA]){t[DA]=!0,Nw.forEach(function(n){n!=="selectionchange"&&(fL.has(n)||Um(n,!1,t),Um(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[DA]||(e[DA]=!0,Um("selectionchange",!1,e))}}function Lb(t,e,n,i){switch(pb(e)){case 1:var r=Sk;break;case 4:r=Ck;break;default:r=i6}n=r.bind(null,e,n,t),r=void 0,!h5||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Vm(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var u=i.tag;if(u===3||u===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(u===4)for(u=i.return;u!==null;){var y=u.tag;if((y===3||y===4)&&(y=u.stateNode.containerInfo,y===r||y.nodeType===8&&y.parentNode===r))return;u=u.return}for(;a!==null;){if(u=Zc(a),u===null)return;if(y=u.tag,y===5||y===6){i=s=u;continue e}a=a.parentNode}}i=i.return}tb(function(){var w=s,M=Jg(n),R=[];e:{var L=Ib.get(t);if(L!==void 0){var U=s6,q=t;switch(t){case"keypress":if(Ed(n)===0)break e;case"keydown":case"keyup":U=Gk;break;case"focusin":q="focus",U=Rm;break;case"focusout":q="blur",U=Rm;break;case"beforeblur":case"afterblur":U=Rm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=N9;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=Ik;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=Wk;break;case Sb:case Cb:case Pb:U=Dk;break;case Mb:U=qk;break;case"scroll":U=Pk;break;case"wheel":U=Xk;break;case"copy":case"cut":case"paste":U=zk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=V9}var te=(e&4)!==0,pe=!te&&t==="scroll",ne=te?L!==null?L+"Capture":null:L;te=[];for(var ie=w,re;ie!==null;){re=ie;var _e=re.stateNode;if(re.tag===5&&_e!==null&&(re=_e,ne!==null&&(_e=s2(ie,ne),_e!=null&&te.push(f2(ie,_e,re)))),pe)break;ie=ie.return}0<te.length&&(L=new U(L,q,null,n,M),R.push({event:L,listeners:te}))}}if(!(e&7)){e:{if(L=t==="mouseover"||t==="pointerover",U=t==="mouseout"||t==="pointerout",L&&n!==c5&&(q=n.relatedTarget||n.fromElement)&&(Zc(q)||q[Kl]))break e;if((U||L)&&(L=M.window===M?M:(L=M.ownerDocument)?L.defaultView||L.parentWindow:window,U?(q=n.relatedTarget||n.toElement,U=w,q=q?Zc(q):null,q!==null&&(pe=vu(q),q!==pe||q.tag!==5&&q.tag!==6)&&(q=null)):(U=null,q=w),U!==q)){if(te=N9,_e="onMouseLeave",ne="onMouseEnter",ie="mouse",(t==="pointerout"||t==="pointerover")&&(te=V9,_e="onPointerLeave",ne="onPointerEnter",ie="pointer"),pe=U==null?L:kh(U),re=q==null?L:kh(q),L=new te(_e,ie+"leave",U,n,M),L.target=pe,L.relatedTarget=re,_e=null,Zc(M)===w&&(te=new te(ne,ie+"enter",q,n,M),te.target=re,te.relatedTarget=pe,_e=te),pe=_e,U&&q)t:{for(te=U,ne=q,ie=0,re=te;re;re=Ah(re))ie++;for(re=0,_e=ne;_e;_e=Ah(_e))re++;for(;0<ie-re;)te=Ah(te),ie--;for(;0<re-ie;)ne=Ah(ne),re--;for(;ie--;){if(te===ne||ne!==null&&te===ne.alternate)break t;te=Ah(te),ne=Ah(ne)}te=null}else te=null;U!==null&&K9(R,L,U,te,!1),q!==null&&pe!==null&&K9(R,pe,q,te,!0)}}e:{if(L=w?kh(w):window,U=L.nodeName&&L.nodeName.toLowerCase(),U==="select"||U==="input"&&L.type==="file")var Te=nL;else if(H9(L))if(xb)Te=oL;else{Te=rL;var De=iL}else(U=L.nodeName)&&U.toLowerCase()==="input"&&(L.type==="checkbox"||L.type==="radio")&&(Te=sL);if(Te&&(Te=Te(t,w))){vb(R,Te,n,M);break e}De&&De(t,L,w),t==="focusout"&&(De=L._wrapperState)&&De.controlled&&L.type==="number"&&r5(L,"number",L.value)}switch(De=w?kh(w):window,t){case"focusin":(H9(De)||De.contentEditable==="true")&&(Mh=De,m5=w,Wf=null);break;case"focusout":Wf=m5=Mh=null;break;case"mousedown":g5=!0;break;case"contextmenu":case"mouseup":case"dragend":g5=!1,X9(R,n,M);break;case"selectionchange":if(cL)break;case"keydown":case"keyup":X9(R,n,M)}var $e;if(a6)e:{switch(t){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else Ph?_b(t,n)&&(nt="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(nt="onCompositionStart");nt&&(gb&&n.locale!=="ko"&&(Ph||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&Ph&&($e=mb()):(G0=M,r6="value"in G0?G0.value:G0.textContent,Ph=!0)),De=ip(w,nt),0<De.length&&(nt=new U9(nt,t,null,n,M),R.push({event:nt,listeners:De}),$e?nt.data=$e:($e=yb(n),$e!==null&&(nt.data=$e)))),($e=Yk?Kk(t,n):Jk(t,n))&&(w=ip(w,"onBeforeInput"),0<w.length&&(M=new U9("onBeforeInput","beforeinput",null,n,M),R.push({event:M,listeners:w}),M.data=$e))}kb(R,e)})}function f2(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ip(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=s2(t,n),s!=null&&i.unshift(f2(t,s,r)),s=s2(t,e),s!=null&&i.push(f2(t,s,r))),t=t.return}return i}function Ah(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function K9(t,e,n,i,r){for(var s=e._reactName,u=[];n!==null&&n!==i;){var a=n,y=a.alternate,w=a.stateNode;if(y!==null&&y===i)break;a.tag===5&&w!==null&&(a=w,r?(y=s2(n,s),y!=null&&u.unshift(f2(n,y,a))):r||(y=s2(n,s),y!=null&&u.push(f2(n,y,a)))),n=n.return}u.length!==0&&t.push({event:e,listeners:u})}var AL=/\r\n?/g,dL=/\u0000|\uFFFD/g;function J9(t){return(typeof t=="string"?t:""+t).replace(AL,`
`).replace(dL,"")}function RA(t,e,n){if(e=J9(e),J9(t)!==e&&n)throw Error(vt(425))}function rp(){}var _5=null,y5=null;function v5(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var x5=typeof setTimeout=="function"?setTimeout:void 0,pL=typeof clearTimeout=="function"?clearTimeout:void 0,e_=typeof Promise=="function"?Promise:void 0,mL=typeof queueMicrotask=="function"?queueMicrotask:typeof e_<"u"?function(t){return e_.resolve(null).then(t).catch(gL)}:x5;function gL(t){setTimeout(function(){throw t})}function Gm(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),l2(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);l2(e)}function Q0(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function t_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var L1=Math.random().toString(36).slice(2),Za="__reactFiber$"+L1,A2="__reactProps$"+L1,Kl="__reactContainer$"+L1,w5="__reactEvents$"+L1,_L="__reactListeners$"+L1,yL="__reactHandles$"+L1;function Zc(t){var e=t[Za];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Kl]||n[Za]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=t_(t);t!==null;){if(n=t[Za])return n;t=t_(t)}return e}t=n,n=t.parentNode}return null}function O2(t){return t=t[Za]||t[Kl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function kh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(vt(33))}function u3(t){return t[A2]||null}var b5=[],Lh=-1;function uc(t){return{current:t}}function Li(t){0>Lh||(t.current=b5[Lh],b5[Lh]=null,Lh--)}function Ci(t,e){Lh++,b5[Lh]=t.current,t.current=e}var sc={},cs=uc(sc),Gs=uc(!1),ru=sc;function a1(t,e){var n=t.type.contextTypes;if(!n)return sc;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function js(t){return t=t.childContextTypes,t!=null}function sp(){Li(Gs),Li(cs)}function n_(t,e,n){if(cs.current!==sc)throw Error(vt(168));Ci(cs,e),Ci(Gs,n)}function Db(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(vt(108,ik(t)||"Unknown",r));return ji({},n,i)}function op(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||sc,ru=cs.current,Ci(cs,t),Ci(Gs,Gs.current),!0}function i_(t,e,n){var i=t.stateNode;if(!i)throw Error(vt(169));n?(t=Db(t,e,ru),i.__reactInternalMemoizedMergedChildContext=t,Li(Gs),Li(cs),Ci(cs,t)):Li(Gs),Ci(Gs,n)}var Nl=null,h3=!1,jm=!1;function Rb(t){Nl===null?Nl=[t]:Nl.push(t)}function vL(t){h3=!0,Rb(t)}function hc(){if(!jm&&Nl!==null){jm=!0;var t=0,e=Ai;try{var n=Nl;for(Ai=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Nl=null,h3=!1}catch(r){throw Nl!==null&&(Nl=Nl.slice(t+1)),sb(e6,hc),r}finally{Ai=e,jm=!1}}return null}var Dh=[],Rh=0,ap=null,lp=0,Bo=[],Oo=0,su=null,Gl=1,jl="";function Hc(t,e){Dh[Rh++]=lp,Dh[Rh++]=ap,ap=t,lp=e}function zb(t,e,n){Bo[Oo++]=Gl,Bo[Oo++]=jl,Bo[Oo++]=su,su=t;var i=Gl;t=jl;var r=32-pa(i)-1;i&=~(1<<r),n+=1;var s=32-pa(e)+r;if(30<s){var u=r-r%5;s=(i&(1<<u)-1).toString(32),i>>=u,r-=u,Gl=1<<32-pa(e)+r|n<<r|i,jl=s+t}else Gl=1<<s|n<<r|i,jl=t}function c6(t){t.return!==null&&(Hc(t,1),zb(t,1,0))}function u6(t){for(;t===ap;)ap=Dh[--Rh],Dh[Rh]=null,lp=Dh[--Rh],Dh[Rh]=null;for(;t===su;)su=Bo[--Oo],Bo[Oo]=null,jl=Bo[--Oo],Bo[Oo]=null,Gl=Bo[--Oo],Bo[Oo]=null}var fo=null,uo=null,Oi=!1,la=null;function Bb(t,e){var n=Fo(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function r_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fo=t,uo=Q0(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fo=t,uo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=su!==null?{id:Gl,overflow:jl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Fo(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fo=t,uo=null,!0):!1;default:return!1}}function E5(t){return(t.mode&1)!==0&&(t.flags&128)===0}function T5(t){if(Oi){var e=uo;if(e){var n=e;if(!r_(t,e)){if(E5(t))throw Error(vt(418));e=Q0(n.nextSibling);var i=fo;e&&r_(t,e)?Bb(i,n):(t.flags=t.flags&-4097|2,Oi=!1,fo=t)}}else{if(E5(t))throw Error(vt(418));t.flags=t.flags&-4097|2,Oi=!1,fo=t}}}function s_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fo=t}function zA(t){if(t!==fo)return!1;if(!Oi)return s_(t),Oi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!v5(t.type,t.memoizedProps)),e&&(e=uo)){if(E5(t))throw Ob(),Error(vt(418));for(;e;)Bb(t,e),e=Q0(e.nextSibling)}if(s_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(vt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){uo=Q0(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}uo=null}}else uo=fo?Q0(t.stateNode.nextSibling):null;return!0}function Ob(){for(var t=uo;t;)t=Q0(t.nextSibling)}function l1(){uo=fo=null,Oi=!1}function h6(t){la===null?la=[t]:la.push(t)}var xL=c0.ReactCurrentBatchConfig;function oa(t,e){if(t&&t.defaultProps){e=ji({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var cp=uc(null),up=null,zh=null,f6=null;function A6(){f6=zh=up=null}function d6(t){var e=cp.current;Li(cp),t._currentValue=e}function S5(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Jh(t,e){up=t,f6=zh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Us=!0),t.firstContext=null)}function Go(t){var e=t._currentValue;if(f6!==t)if(t={context:t,memoizedValue:e,next:null},zh===null){if(up===null)throw Error(vt(308));zh=t,up.dependencies={lanes:0,firstContext:t}}else zh=zh.next=t;return e}var Xc=null;function p6(t){Xc===null?Xc=[t]:Xc.push(t)}function Fb(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,p6(e)):(n.next=r.next,r.next=n),e.interleaved=n,Jl(t,i)}function Jl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var N0=!1;function m6(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Y0(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,ni&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Jl(t,n)}return r=i.interleaved,r===null?(e.next=e,p6(i)):(e.next=r.next,r.next=e),i.interleaved=e,Jl(t,n)}function Td(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,t6(t,n)}}function o_(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var u={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=u:s=s.next=u,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function hp(t,e,n,i){var r=t.updateQueue;N0=!1;var s=r.firstBaseUpdate,u=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var y=a,w=y.next;y.next=null,u===null?s=w:u.next=w,u=y;var M=t.alternate;M!==null&&(M=M.updateQueue,a=M.lastBaseUpdate,a!==u&&(a===null?M.firstBaseUpdate=w:a.next=w,M.lastBaseUpdate=y))}if(s!==null){var R=r.baseState;u=0,M=w=y=null,a=s;do{var L=a.lane,U=a.eventTime;if((i&L)===L){M!==null&&(M=M.next={eventTime:U,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var q=t,te=a;switch(L=e,U=n,te.tag){case 1:if(q=te.payload,typeof q=="function"){R=q.call(U,R,L);break e}R=q;break e;case 3:q.flags=q.flags&-65537|128;case 0:if(q=te.payload,L=typeof q=="function"?q.call(U,R,L):q,L==null)break e;R=ji({},R,L);break e;case 2:N0=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,L=r.effects,L===null?r.effects=[a]:L.push(a))}else U={eventTime:U,lane:L,tag:a.tag,payload:a.payload,callback:a.callback,next:null},M===null?(w=M=U,y=R):M=M.next=U,u|=L;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;L=a,a=L.next,L.next=null,r.lastBaseUpdate=L,r.shared.pending=null}}while(1);if(M===null&&(y=R),r.baseState=y,r.firstBaseUpdate=w,r.lastBaseUpdate=M,e=r.shared.interleaved,e!==null){r=e;do u|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);au|=u,t.lanes=u,t.memoizedState=R}}function a_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(vt(191,r));r.call(i)}}}var Ub=new Fw.Component().refs;function C5(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:ji({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var f3={isMounted:function(t){return(t=t._reactInternals)?vu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Ts(),r=J0(t),s=Zl(i,r);s.payload=e,n!=null&&(s.callback=n),e=Y0(t,s,r),e!==null&&(ma(e,t,r,i),Td(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Ts(),r=J0(t),s=Zl(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Y0(t,s,r),e!==null&&(ma(e,t,r,i),Td(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ts(),i=J0(t),r=Zl(n,i);r.tag=2,e!=null&&(r.callback=e),e=Y0(t,r,i),e!==null&&(ma(e,t,i,n),Td(e,t,i))}};function l_(t,e,n,i,r,s,u){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,u):e.prototype&&e.prototype.isPureReactComponent?!u2(n,i)||!u2(r,s):!0}function Vb(t,e,n){var i=!1,r=sc,s=e.contextType;return typeof s=="object"&&s!==null?s=Go(s):(r=js(e)?ru:cs.current,i=e.contextTypes,s=(i=i!=null)?a1(t,r):sc),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=f3,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function c_(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&f3.enqueueReplaceState(e,e.state,null)}function P5(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=Ub,m6(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Go(s):(s=js(e)?ru:cs.current,r.context=a1(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(C5(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&f3.enqueueReplaceState(r,r.state,null),hp(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Af(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(vt(309));var i=n.stateNode}if(!i)throw Error(vt(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(u){var a=r.refs;a===Ub&&(a=r.refs={}),u===null?delete a[s]:a[s]=u},e._stringRef=s,e)}if(typeof t!="string")throw Error(vt(284));if(!n._owner)throw Error(vt(290,t))}return t}function BA(t,e){throw t=Object.prototype.toString.call(e),Error(vt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function u_(t){var e=t._init;return e(t._payload)}function Gb(t){function e(ne,ie){if(t){var re=ne.deletions;re===null?(ne.deletions=[ie],ne.flags|=16):re.push(ie)}}function n(ne,ie){if(!t)return null;for(;ie!==null;)e(ne,ie),ie=ie.sibling;return null}function i(ne,ie){for(ne=new Map;ie!==null;)ie.key!==null?ne.set(ie.key,ie):ne.set(ie.index,ie),ie=ie.sibling;return ne}function r(ne,ie){return ne=ec(ne,ie),ne.index=0,ne.sibling=null,ne}function s(ne,ie,re){return ne.index=re,t?(re=ne.alternate,re!==null?(re=re.index,re<ie?(ne.flags|=2,ie):re):(ne.flags|=2,ie)):(ne.flags|=1048576,ie)}function u(ne){return t&&ne.alternate===null&&(ne.flags|=2),ne}function a(ne,ie,re,_e){return ie===null||ie.tag!==6?(ie=Qm(re,ne.mode,_e),ie.return=ne,ie):(ie=r(ie,re),ie.return=ne,ie)}function y(ne,ie,re,_e){var Te=re.type;return Te===Ch?M(ne,ie,re.props.children,_e,re.key):ie!==null&&(ie.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===F0&&u_(Te)===ie.type)?(_e=r(ie,re.props),_e.ref=Af(ne,ie,re),_e.return=ne,_e):(_e=kd(re.type,re.key,re.props,null,ne.mode,_e),_e.ref=Af(ne,ie,re),_e.return=ne,_e)}function w(ne,ie,re,_e){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==re.containerInfo||ie.stateNode.implementation!==re.implementation?(ie=Ym(re,ne.mode,_e),ie.return=ne,ie):(ie=r(ie,re.children||[]),ie.return=ne,ie)}function M(ne,ie,re,_e,Te){return ie===null||ie.tag!==7?(ie=eu(re,ne.mode,_e,Te),ie.return=ne,ie):(ie=r(ie,re),ie.return=ne,ie)}function R(ne,ie,re){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=Qm(""+ie,ne.mode,re),ie.return=ne,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case TA:return re=kd(ie.type,ie.key,ie.props,null,ne.mode,re),re.ref=Af(ne,null,ie),re.return=ne,re;case Sh:return ie=Ym(ie,ne.mode,re),ie.return=ne,ie;case F0:var _e=ie._init;return R(ne,_e(ie._payload),re)}if(Lf(ie)||lf(ie))return ie=eu(ie,ne.mode,re,null),ie.return=ne,ie;BA(ne,ie)}return null}function L(ne,ie,re,_e){var Te=ie!==null?ie.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return Te!==null?null:a(ne,ie,""+re,_e);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case TA:return re.key===Te?y(ne,ie,re,_e):null;case Sh:return re.key===Te?w(ne,ie,re,_e):null;case F0:return Te=re._init,L(ne,ie,Te(re._payload),_e)}if(Lf(re)||lf(re))return Te!==null?null:M(ne,ie,re,_e,null);BA(ne,re)}return null}function U(ne,ie,re,_e,Te){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return ne=ne.get(re)||null,a(ie,ne,""+_e,Te);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case TA:return ne=ne.get(_e.key===null?re:_e.key)||null,y(ie,ne,_e,Te);case Sh:return ne=ne.get(_e.key===null?re:_e.key)||null,w(ie,ne,_e,Te);case F0:var De=_e._init;return U(ne,ie,re,De(_e._payload),Te)}if(Lf(_e)||lf(_e))return ne=ne.get(re)||null,M(ie,ne,_e,Te,null);BA(ie,_e)}return null}function q(ne,ie,re,_e){for(var Te=null,De=null,$e=ie,nt=ie=0,ut=null;$e!==null&&nt<re.length;nt++){$e.index>nt?(ut=$e,$e=null):ut=$e.sibling;var st=L(ne,$e,re[nt],_e);if(st===null){$e===null&&($e=ut);break}t&&$e&&st.alternate===null&&e(ne,$e),ie=s(st,ie,nt),De===null?Te=st:De.sibling=st,De=st,$e=ut}if(nt===re.length)return n(ne,$e),Oi&&Hc(ne,nt),Te;if($e===null){for(;nt<re.length;nt++)$e=R(ne,re[nt],_e),$e!==null&&(ie=s($e,ie,nt),De===null?Te=$e:De.sibling=$e,De=$e);return Oi&&Hc(ne,nt),Te}for($e=i(ne,$e);nt<re.length;nt++)ut=U($e,ne,nt,re[nt],_e),ut!==null&&(t&&ut.alternate!==null&&$e.delete(ut.key===null?nt:ut.key),ie=s(ut,ie,nt),De===null?Te=ut:De.sibling=ut,De=ut);return t&&$e.forEach(function(lt){return e(ne,lt)}),Oi&&Hc(ne,nt),Te}function te(ne,ie,re,_e){var Te=lf(re);if(typeof Te!="function")throw Error(vt(150));if(re=Te.call(re),re==null)throw Error(vt(151));for(var De=Te=null,$e=ie,nt=ie=0,ut=null,st=re.next();$e!==null&&!st.done;nt++,st=re.next()){$e.index>nt?(ut=$e,$e=null):ut=$e.sibling;var lt=L(ne,$e,st.value,_e);if(lt===null){$e===null&&($e=ut);break}t&&$e&&lt.alternate===null&&e(ne,$e),ie=s(lt,ie,nt),De===null?Te=lt:De.sibling=lt,De=lt,$e=ut}if(st.done)return n(ne,$e),Oi&&Hc(ne,nt),Te;if($e===null){for(;!st.done;nt++,st=re.next())st=R(ne,st.value,_e),st!==null&&(ie=s(st,ie,nt),De===null?Te=st:De.sibling=st,De=st);return Oi&&Hc(ne,nt),Te}for($e=i(ne,$e);!st.done;nt++,st=re.next())st=U($e,ne,nt,st.value,_e),st!==null&&(t&&st.alternate!==null&&$e.delete(st.key===null?nt:st.key),ie=s(st,ie,nt),De===null?Te=st:De.sibling=st,De=st);return t&&$e.forEach(function(Lt){return e(ne,Lt)}),Oi&&Hc(ne,nt),Te}function pe(ne,ie,re,_e){if(typeof re=="object"&&re!==null&&re.type===Ch&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case TA:e:{for(var Te=re.key,De=ie;De!==null;){if(De.key===Te){if(Te=re.type,Te===Ch){if(De.tag===7){n(ne,De.sibling),ie=r(De,re.props.children),ie.return=ne,ne=ie;break e}}else if(De.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===F0&&u_(Te)===De.type){n(ne,De.sibling),ie=r(De,re.props),ie.ref=Af(ne,De,re),ie.return=ne,ne=ie;break e}n(ne,De);break}else e(ne,De);De=De.sibling}re.type===Ch?(ie=eu(re.props.children,ne.mode,_e,re.key),ie.return=ne,ne=ie):(_e=kd(re.type,re.key,re.props,null,ne.mode,_e),_e.ref=Af(ne,ie,re),_e.return=ne,ne=_e)}return u(ne);case Sh:e:{for(De=re.key;ie!==null;){if(ie.key===De)if(ie.tag===4&&ie.stateNode.containerInfo===re.containerInfo&&ie.stateNode.implementation===re.implementation){n(ne,ie.sibling),ie=r(ie,re.children||[]),ie.return=ne,ne=ie;break e}else{n(ne,ie);break}else e(ne,ie);ie=ie.sibling}ie=Ym(re,ne.mode,_e),ie.return=ne,ne=ie}return u(ne);case F0:return De=re._init,pe(ne,ie,De(re._payload),_e)}if(Lf(re))return q(ne,ie,re,_e);if(lf(re))return te(ne,ie,re,_e);BA(ne,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,ie!==null&&ie.tag===6?(n(ne,ie.sibling),ie=r(ie,re),ie.return=ne,ne=ie):(n(ne,ie),ie=Qm(re,ne.mode,_e),ie.return=ne,ne=ie),u(ne)):n(ne,ie)}return pe}var c1=Gb(!0),jb=Gb(!1),F2={},Ka=uc(F2),d2=uc(F2),p2=uc(F2);function Qc(t){if(t===F2)throw Error(vt(174));return t}function g6(t,e){switch(Ci(p2,e),Ci(d2,t),Ci(Ka,F2),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:o5(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=o5(e,t)}Li(Ka),Ci(Ka,e)}function u1(){Li(Ka),Li(d2),Li(p2)}function Hb(t){Qc(p2.current);var e=Qc(Ka.current),n=o5(e,t.type);e!==n&&(Ci(d2,t),Ci(Ka,n))}function _6(t){d2.current===t&&(Li(Ka),Li(d2))}var Ui=uc(0);function fp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Hm=[];function y6(){for(var t=0;t<Hm.length;t++)Hm[t]._workInProgressVersionPrimary=null;Hm.length=0}var Sd=c0.ReactCurrentDispatcher,Wm=c0.ReactCurrentBatchConfig,ou=0,Gi=null,_r=null,Pr=null,Ap=!1,$f=!1,m2=0,wL=0;function Kr(){throw Error(vt(321))}function v6(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!_a(t[n],e[n]))return!1;return!0}function x6(t,e,n,i,r,s){if(ou=s,Gi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Sd.current=t===null||t.memoizedState===null?SL:CL,t=n(i,r),$f){s=0;do{if($f=!1,m2=0,25<=s)throw Error(vt(301));s+=1,Pr=_r=null,e.updateQueue=null,Sd.current=PL,t=n(i,r)}while($f)}if(Sd.current=dp,e=_r!==null&&_r.next!==null,ou=0,Pr=_r=Gi=null,Ap=!1,e)throw Error(vt(300));return t}function w6(){var t=m2!==0;return m2=0,t}function $a(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pr===null?Gi.memoizedState=Pr=t:Pr=Pr.next=t,Pr}function jo(){if(_r===null){var t=Gi.alternate;t=t!==null?t.memoizedState:null}else t=_r.next;var e=Pr===null?Gi.memoizedState:Pr.next;if(e!==null)Pr=e,_r=t;else{if(t===null)throw Error(vt(310));_r=t,t={memoizedState:_r.memoizedState,baseState:_r.baseState,baseQueue:_r.baseQueue,queue:_r.queue,next:null},Pr===null?Gi.memoizedState=Pr=t:Pr=Pr.next=t}return Pr}function g2(t,e){return typeof e=="function"?e(t):e}function $m(t){var e=jo(),n=e.queue;if(n===null)throw Error(vt(311));n.lastRenderedReducer=t;var i=_r,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var u=r.next;r.next=s.next,s.next=u}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=u=null,y=null,w=s;do{var M=w.lane;if((ou&M)===M)y!==null&&(y=y.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),i=w.hasEagerState?w.eagerState:t(i,w.action);else{var R={lane:M,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};y===null?(a=y=R,u=i):y=y.next=R,Gi.lanes|=M,au|=M}w=w.next}while(w!==null&&w!==s);y===null?u=i:y.next=a,_a(i,e.memoizedState)||(Us=!0),e.memoizedState=i,e.baseState=u,e.baseQueue=y,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,Gi.lanes|=s,au|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function qm(t){var e=jo(),n=e.queue;if(n===null)throw Error(vt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var u=r=r.next;do s=t(s,u.action),u=u.next;while(u!==r);_a(s,e.memoizedState)||(Us=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Wb(){}function $b(t,e){var n=Gi,i=jo(),r=e(),s=!_a(i.memoizedState,r);if(s&&(i.memoizedState=r,Us=!0),i=i.queue,b6(Xb.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||Pr!==null&&Pr.memoizedState.tag&1){if(n.flags|=2048,_2(9,Zb.bind(null,n,i,r,e),void 0,null),Ir===null)throw Error(vt(349));ou&30||qb(n,e,r)}return r}function qb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Gi.updateQueue,e===null?(e={lastEffect:null,stores:null},Gi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Zb(t,e,n,i){e.value=n,e.getSnapshot=i,Qb(e)&&Yb(t)}function Xb(t,e,n){return n(function(){Qb(e)&&Yb(t)})}function Qb(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!_a(t,n)}catch{return!0}}function Yb(t){var e=Jl(t,1);e!==null&&ma(e,t,1,-1)}function h_(t){var e=$a();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g2,lastRenderedState:t},e.queue=t,t=t.dispatch=TL.bind(null,Gi,t),[e.memoizedState,t]}function _2(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Gi.updateQueue,e===null?(e={lastEffect:null,stores:null},Gi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function Kb(){return jo().memoizedState}function Cd(t,e,n,i){var r=$a();Gi.flags|=t,r.memoizedState=_2(1|e,n,void 0,i===void 0?null:i)}function A3(t,e,n,i){var r=jo();i=i===void 0?null:i;var s=void 0;if(_r!==null){var u=_r.memoizedState;if(s=u.destroy,i!==null&&v6(i,u.deps)){r.memoizedState=_2(e,n,s,i);return}}Gi.flags|=t,r.memoizedState=_2(1|e,n,s,i)}function f_(t,e){return Cd(8390656,8,t,e)}function b6(t,e){return A3(2048,8,t,e)}function Jb(t,e){return A3(4,2,t,e)}function eE(t,e){return A3(4,4,t,e)}function tE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function nE(t,e,n){return n=n!=null?n.concat([t]):null,A3(4,4,tE.bind(null,e,t),n)}function E6(){}function iE(t,e){var n=jo();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&v6(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function rE(t,e){var n=jo();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&v6(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function sE(t,e,n){return ou&21?(_a(n,e)||(n=lb(),Gi.lanes|=n,au|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Us=!0),t.memoizedState=n)}function bL(t,e){var n=Ai;Ai=n!==0&&4>n?n:4,t(!0);var i=Wm.transition;Wm.transition={};try{t(!1),e()}finally{Ai=n,Wm.transition=i}}function oE(){return jo().memoizedState}function EL(t,e,n){var i=J0(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},aE(t))lE(e,n);else if(n=Fb(t,e,n,i),n!==null){var r=Ts();ma(n,t,i,r),cE(n,e,i)}}function TL(t,e,n){var i=J0(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(aE(t))lE(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var u=e.lastRenderedState,a=s(u,n);if(r.hasEagerState=!0,r.eagerState=a,_a(a,u)){var y=e.interleaved;y===null?(r.next=r,p6(e)):(r.next=y.next,y.next=r),e.interleaved=r;return}}catch{}finally{}n=Fb(t,e,r,i),n!==null&&(r=Ts(),ma(n,t,i,r),cE(n,e,i))}}function aE(t){var e=t.alternate;return t===Gi||e!==null&&e===Gi}function lE(t,e){$f=Ap=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function cE(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,t6(t,n)}}var dp={readContext:Go,useCallback:Kr,useContext:Kr,useEffect:Kr,useImperativeHandle:Kr,useInsertionEffect:Kr,useLayoutEffect:Kr,useMemo:Kr,useReducer:Kr,useRef:Kr,useState:Kr,useDebugValue:Kr,useDeferredValue:Kr,useTransition:Kr,useMutableSource:Kr,useSyncExternalStore:Kr,useId:Kr,unstable_isNewReconciler:!1},SL={readContext:Go,useCallback:function(t,e){return $a().memoizedState=[t,e===void 0?null:e],t},useContext:Go,useEffect:f_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Cd(4194308,4,tE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Cd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Cd(4,2,t,e)},useMemo:function(t,e){var n=$a();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=$a();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=EL.bind(null,Gi,t),[i.memoizedState,t]},useRef:function(t){var e=$a();return t={current:t},e.memoizedState=t},useState:h_,useDebugValue:E6,useDeferredValue:function(t){return $a().memoizedState=t},useTransition:function(){var t=h_(!1),e=t[0];return t=bL.bind(null,t[1]),$a().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Gi,r=$a();if(Oi){if(n===void 0)throw Error(vt(407));n=n()}else{if(n=e(),Ir===null)throw Error(vt(349));ou&30||qb(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,f_(Xb.bind(null,i,s,t),[t]),i.flags|=2048,_2(9,Zb.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=$a(),e=Ir.identifierPrefix;if(Oi){var n=jl,i=Gl;n=(i&~(1<<32-pa(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=m2++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wL++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},CL={readContext:Go,useCallback:iE,useContext:Go,useEffect:b6,useImperativeHandle:nE,useInsertionEffect:Jb,useLayoutEffect:eE,useMemo:rE,useReducer:$m,useRef:Kb,useState:function(){return $m(g2)},useDebugValue:E6,useDeferredValue:function(t){var e=jo();return sE(e,_r.memoizedState,t)},useTransition:function(){var t=$m(g2)[0],e=jo().memoizedState;return[t,e]},useMutableSource:Wb,useSyncExternalStore:$b,useId:oE,unstable_isNewReconciler:!1},PL={readContext:Go,useCallback:iE,useContext:Go,useEffect:b6,useImperativeHandle:nE,useInsertionEffect:Jb,useLayoutEffect:eE,useMemo:rE,useReducer:qm,useRef:Kb,useState:function(){return qm(g2)},useDebugValue:E6,useDeferredValue:function(t){var e=jo();return _r===null?e.memoizedState=t:sE(e,_r.memoizedState,t)},useTransition:function(){var t=qm(g2)[0],e=jo().memoizedState;return[t,e]},useMutableSource:Wb,useSyncExternalStore:$b,useId:oE,unstable_isNewReconciler:!1};function h1(t,e){try{var n="",i=e;do n+=nk(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function Zm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function M5(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ML=typeof WeakMap=="function"?WeakMap:Map;function uE(t,e,n){n=Zl(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){mp||(mp=!0,N5=i),M5(t,e)},n}function hE(t,e,n){n=Zl(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){M5(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){M5(t,e),typeof i!="function"&&(K0===null?K0=new Set([this]):K0.add(this));var u=e.stack;this.componentDidCatch(e.value,{componentStack:u!==null?u:""})}),n}function A_(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new ML;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=jL.bind(null,t,e,n),e.then(t,t))}function d_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function p_(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Zl(-1,1),e.tag=2,Y0(n,e,1))),n.lanes|=1),t)}var IL=c0.ReactCurrentOwner,Us=!1;function ws(t,e,n,i){e.child=t===null?jb(e,null,n,i):c1(e,t.child,n,i)}function m_(t,e,n,i,r){n=n.render;var s=e.ref;return Jh(e,r),i=x6(t,e,n,i,s,r),n=w6(),t!==null&&!Us?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,e0(t,e,r)):(Oi&&n&&c6(e),e.flags|=1,ws(t,e,i,r),e.child)}function g_(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!L6(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,fE(t,e,s,i,r)):(t=kd(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var u=s.memoizedProps;if(n=n.compare,n=n!==null?n:u2,n(u,i)&&t.ref===e.ref)return e0(t,e,r)}return e.flags|=1,t=ec(s,i),t.ref=e.ref,t.return=e,e.child=t}function fE(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(u2(s,i)&&t.ref===e.ref)if(Us=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Us=!0);else return e.lanes=t.lanes,e0(t,e,r)}return I5(t,e,n,i,r)}function AE(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Oh,lo),lo|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ci(Oh,lo),lo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Ci(Oh,lo),lo|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Ci(Oh,lo),lo|=i;return ws(t,e,r,n),e.child}function dE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function I5(t,e,n,i,r){var s=js(n)?ru:cs.current;return s=a1(e,s),Jh(e,r),n=x6(t,e,n,i,s,r),i=w6(),t!==null&&!Us?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,e0(t,e,r)):(Oi&&i&&c6(e),e.flags|=1,ws(t,e,n,r),e.child)}function __(t,e,n,i,r){if(js(n)){var s=!0;op(e)}else s=!1;if(Jh(e,r),e.stateNode===null)Pd(t,e),Vb(e,n,i),P5(e,n,i,r),i=!0;else if(t===null){var u=e.stateNode,a=e.memoizedProps;u.props=a;var y=u.context,w=n.contextType;typeof w=="object"&&w!==null?w=Go(w):(w=js(n)?ru:cs.current,w=a1(e,w));var M=n.getDerivedStateFromProps,R=typeof M=="function"||typeof u.getSnapshotBeforeUpdate=="function";R||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==i||y!==w)&&c_(e,u,i,w),N0=!1;var L=e.memoizedState;u.state=L,hp(e,i,u,r),y=e.memoizedState,a!==i||L!==y||Gs.current||N0?(typeof M=="function"&&(C5(e,n,M,i),y=e.memoizedState),(a=N0||l_(e,n,a,i,L,y,w))?(R||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(e.flags|=4194308)):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=y),u.props=i,u.state=y,u.context=w,i=a):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{u=e.stateNode,Nb(t,e),a=e.memoizedProps,w=e.type===e.elementType?a:oa(e.type,a),u.props=w,R=e.pendingProps,L=u.context,y=n.contextType,typeof y=="object"&&y!==null?y=Go(y):(y=js(n)?ru:cs.current,y=a1(e,y));var U=n.getDerivedStateFromProps;(M=typeof U=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==R||L!==y)&&c_(e,u,i,y),N0=!1,L=e.memoizedState,u.state=L,hp(e,i,u,r);var q=e.memoizedState;a!==R||L!==q||Gs.current||N0?(typeof U=="function"&&(C5(e,n,U,i),q=e.memoizedState),(w=N0||l_(e,n,w,i,L,q,y)||!1)?(M||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(i,q,y),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(i,q,y)),typeof u.componentDidUpdate=="function"&&(e.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof u.componentDidUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=q),u.props=i,u.state=q,u.context=y,i=w):(typeof u.componentDidUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=1024),i=!1)}return k5(t,e,n,i,s,r)}function k5(t,e,n,i,r,s){dE(t,e);var u=(e.flags&128)!==0;if(!i&&!u)return r&&i_(e,n,!1),e0(t,e,s);i=e.stateNode,IL.current=e;var a=u&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&u?(e.child=c1(e,t.child,null,s),e.child=c1(e,null,a,s)):ws(t,e,a,s),e.memoizedState=i.state,r&&i_(e,n,!0),e.child}function pE(t){var e=t.stateNode;e.pendingContext?n_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&n_(t,e.context,!1),g6(t,e.containerInfo)}function y_(t,e,n,i,r){return l1(),h6(r),e.flags|=256,ws(t,e,n,i),e.child}var L5={dehydrated:null,treeContext:null,retryLane:0};function D5(t){return{baseLanes:t,cachePool:null,transitions:null}}function mE(t,e,n){var i=e.pendingProps,r=Ui.current,s=!1,u=(e.flags&128)!==0,a;if((a=u)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Ci(Ui,r&1),t===null)return T5(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(u=i.children,t=i.fallback,s?(i=e.mode,s=e.child,u={mode:"hidden",children:u},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=u):s=m3(u,i,0,null),t=eu(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=D5(n),e.memoizedState=L5,t):T6(e,u));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return kL(t,e,u,i,a,r,n);if(s){s=i.fallback,u=e.mode,r=t.child,a=r.sibling;var y={mode:"hidden",children:i.children};return!(u&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=y,e.deletions=null):(i=ec(r,y),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=ec(a,s):(s=eu(s,u,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,u=t.child.memoizedState,u=u===null?D5(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=t.childLanes&~n,e.memoizedState=L5,i}return s=t.child,t=s.sibling,i=ec(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function T6(t,e){return e=m3({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function OA(t,e,n,i){return i!==null&&h6(i),c1(e,t.child,null,n),t=T6(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function kL(t,e,n,i,r,s,u){if(n)return e.flags&256?(e.flags&=-257,i=Zm(Error(vt(422))),OA(t,e,u,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=m3({mode:"visible",children:i.children},r,0,null),s=eu(s,r,u,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&c1(e,t.child,null,u),e.child.memoizedState=D5(u),e.memoizedState=L5,s);if(!(e.mode&1))return OA(t,e,u,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(vt(419)),i=Zm(s,i,void 0),OA(t,e,u,i)}if(a=(u&t.childLanes)!==0,Us||a){if(i=Ir,i!==null){switch(u&-u){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|u)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Jl(t,r),ma(i,t,r,-1))}return k6(),i=Zm(Error(vt(421))),OA(t,e,u,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=HL.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,uo=Q0(r.nextSibling),fo=e,Oi=!0,la=null,t!==null&&(Bo[Oo++]=Gl,Bo[Oo++]=jl,Bo[Oo++]=su,Gl=t.id,jl=t.overflow,su=e),e=T6(e,i.children),e.flags|=4096,e)}function v_(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),S5(t.return,e,n)}function Xm(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function gE(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(ws(t,e,i.children,n),i=Ui.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&v_(t,n,e);else if(t.tag===19)v_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Ci(Ui,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&fp(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Xm(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&fp(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Xm(e,!0,n,null,s);break;case"together":Xm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function e0(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),au|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(vt(153));if(e.child!==null){for(t=e.child,n=ec(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ec(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function LL(t,e,n){switch(e.tag){case 3:pE(e),l1();break;case 5:Hb(e);break;case 1:js(e.type)&&op(e);break;case 4:g6(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Ci(cp,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Ci(Ui,Ui.current&1),e.flags|=128,null):n&e.child.childLanes?mE(t,e,n):(Ci(Ui,Ui.current&1),t=e0(t,e,n),t!==null?t.sibling:null);Ci(Ui,Ui.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return gE(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ci(Ui,Ui.current),i)break;return null;case 22:case 23:return e.lanes=0,AE(t,e,n)}return e0(t,e,n)}var _E,R5,yE,vE;_E=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};R5=function(){};yE=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Qc(Ka.current);var s=null;switch(n){case"input":r=n5(t,r),i=n5(t,i),s=[];break;case"select":r=ji({},r,{value:void 0}),i=ji({},i,{value:void 0}),s=[];break;case"textarea":r=s5(t,r),i=s5(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=rp)}a5(n,i);var u;n=null;for(w in r)if(!i.hasOwnProperty(w)&&r.hasOwnProperty(w)&&r[w]!=null)if(w==="style"){var a=r[w];for(u in a)a.hasOwnProperty(u)&&(n||(n={}),n[u]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(i2.hasOwnProperty(w)?s||(s=[]):(s=s||[]).push(w,null));for(w in i){var y=i[w];if(a=r?.[w],i.hasOwnProperty(w)&&y!==a&&(y!=null||a!=null))if(w==="style")if(a){for(u in a)!a.hasOwnProperty(u)||y&&y.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in y)y.hasOwnProperty(u)&&a[u]!==y[u]&&(n||(n={}),n[u]=y[u])}else n||(s||(s=[]),s.push(w,n)),n=y;else w==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,a=a?a.__html:void 0,y!=null&&a!==y&&(s=s||[]).push(w,y)):w==="children"?typeof y!="string"&&typeof y!="number"||(s=s||[]).push(w,""+y):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(i2.hasOwnProperty(w)?(y!=null&&w==="onScroll"&&ki("scroll",t),s||a===y||(s=[])):(s=s||[]).push(w,y))}n&&(s=s||[]).push("style",n);var w=s;(e.updateQueue=w)&&(e.flags|=4)}};vE=function(t,e,n,i){n!==i&&(e.flags|=4)};function df(t,e){if(!Oi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Jr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function DL(t,e,n){var i=e.pendingProps;switch(u6(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jr(e),null;case 1:return js(e.type)&&sp(),Jr(e),null;case 3:return i=e.stateNode,u1(),Li(Gs),Li(cs),y6(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(zA(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,la!==null&&(G5(la),la=null))),R5(t,e),Jr(e),null;case 5:_6(e);var r=Qc(p2.current);if(n=e.type,t!==null&&e.stateNode!=null)yE(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(vt(166));return Jr(e),null}if(t=Qc(Ka.current),zA(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[Za]=e,i[A2]=s,t=(e.mode&1)!==0,n){case"dialog":ki("cancel",i),ki("close",i);break;case"iframe":case"object":case"embed":ki("load",i);break;case"video":case"audio":for(r=0;r<Rf.length;r++)ki(Rf[r],i);break;case"source":ki("error",i);break;case"img":case"image":case"link":ki("error",i),ki("load",i);break;case"details":ki("toggle",i);break;case"input":M9(i,s),ki("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},ki("invalid",i);break;case"textarea":k9(i,s),ki("invalid",i)}a5(n,s),r=null;for(var u in s)if(s.hasOwnProperty(u)){var a=s[u];u==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&RA(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&RA(i.textContent,a,t),r=["children",""+a]):i2.hasOwnProperty(u)&&a!=null&&u==="onScroll"&&ki("scroll",i)}switch(n){case"input":SA(i),I9(i,s,!0);break;case"textarea":SA(i),L9(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=rp)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{u=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=qw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=u.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=u.createElement(n,{is:i.is}):(t=u.createElement(n),n==="select"&&(u=t,i.multiple?u.multiple=!0:i.size&&(u.size=i.size))):t=u.createElementNS(t,n),t[Za]=e,t[A2]=i,_E(t,e,!1,!1),e.stateNode=t;e:{switch(u=l5(n,i),n){case"dialog":ki("cancel",t),ki("close",t),r=i;break;case"iframe":case"object":case"embed":ki("load",t),r=i;break;case"video":case"audio":for(r=0;r<Rf.length;r++)ki(Rf[r],t);r=i;break;case"source":ki("error",t),r=i;break;case"img":case"image":case"link":ki("error",t),ki("load",t),r=i;break;case"details":ki("toggle",t),r=i;break;case"input":M9(t,i),r=n5(t,i),ki("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=ji({},i,{value:void 0}),ki("invalid",t);break;case"textarea":k9(t,i),r=s5(t,i),ki("invalid",t);break;default:r=i}a5(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var y=a[s];s==="style"?Qw(t,y):s==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&Zw(t,y)):s==="children"?typeof y=="string"?(n!=="textarea"||y!=="")&&r2(t,y):typeof y=="number"&&r2(t,""+y):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(i2.hasOwnProperty(s)?y!=null&&s==="onScroll"&&ki("scroll",t):y!=null&&Xg(t,s,y,u))}switch(n){case"input":SA(t),I9(t,i,!1);break;case"textarea":SA(t),L9(t);break;case"option":i.value!=null&&t.setAttribute("value",""+rc(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?Xh(t,!!i.multiple,s,!1):i.defaultValue!=null&&Xh(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=rp)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Jr(e),null;case 6:if(t&&e.stateNode!=null)vE(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(vt(166));if(n=Qc(p2.current),Qc(Ka.current),zA(e)){if(i=e.stateNode,n=e.memoizedProps,i[Za]=e,(s=i.nodeValue!==n)&&(t=fo,t!==null))switch(t.tag){case 3:RA(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&RA(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Za]=e,e.stateNode=i}return Jr(e),null;case 13:if(Li(Ui),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Oi&&uo!==null&&e.mode&1&&!(e.flags&128))Ob(),l1(),e.flags|=98560,s=!1;else if(s=zA(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(vt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(vt(317));s[Za]=e}else l1(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Jr(e),s=!1}else la!==null&&(G5(la),la=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Ui.current&1?yr===0&&(yr=3):k6())),e.updateQueue!==null&&(e.flags|=4),Jr(e),null);case 4:return u1(),R5(t,e),t===null&&h2(e.stateNode.containerInfo),Jr(e),null;case 10:return d6(e.type._context),Jr(e),null;case 17:return js(e.type)&&sp(),Jr(e),null;case 19:if(Li(Ui),s=e.memoizedState,s===null)return Jr(e),null;if(i=(e.flags&128)!==0,u=s.rendering,u===null)if(i)df(s,!1);else{if(yr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(u=fp(t),u!==null){for(e.flags|=128,df(s,!1),i=u.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,u=s.alternate,u===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,t=u.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ci(Ui,Ui.current&1|2),e.child}t=t.sibling}s.tail!==null&&ir()>f1&&(e.flags|=128,i=!0,df(s,!1),e.lanes=4194304)}else{if(!i)if(t=fp(u),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),df(s,!0),s.tail===null&&s.tailMode==="hidden"&&!u.alternate&&!Oi)return Jr(e),null}else 2*ir()-s.renderingStartTime>f1&&n!==1073741824&&(e.flags|=128,i=!0,df(s,!1),e.lanes=4194304);s.isBackwards?(u.sibling=e.child,e.child=u):(n=s.last,n!==null?n.sibling=u:e.child=u,s.last=u)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ir(),e.sibling=null,n=Ui.current,Ci(Ui,i?n&1|2:n&1),e):(Jr(e),null);case 22:case 23:return I6(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?lo&1073741824&&(Jr(e),e.subtreeFlags&6&&(e.flags|=8192)):Jr(e),null;case 24:return null;case 25:return null}throw Error(vt(156,e.tag))}function RL(t,e){switch(u6(e),e.tag){case 1:return js(e.type)&&sp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return u1(),Li(Gs),Li(cs),y6(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _6(e),null;case 13:if(Li(Ui),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(vt(340));l1()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Li(Ui),null;case 4:return u1(),null;case 10:return d6(e.type._context),null;case 22:case 23:return I6(),null;case 24:return null;default:return null}}var FA=!1,os=!1,zL=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function Bh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Yi(t,e,i)}else n.current=null}function z5(t,e,n){try{n()}catch(i){Yi(t,e,i)}}var x_=!1;function BL(t,e){if(_5=tp,t=Eb(),l6(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var u=0,a=-1,y=-1,w=0,M=0,R=t,L=null;t:for(;;){for(var U;R!==n||r!==0&&R.nodeType!==3||(a=u+r),R!==s||i!==0&&R.nodeType!==3||(y=u+i),R.nodeType===3&&(u+=R.nodeValue.length),(U=R.firstChild)!==null;)L=R,R=U;for(;;){if(R===t)break t;if(L===n&&++w===r&&(a=u),L===s&&++M===i&&(y=u),(U=R.nextSibling)!==null)break;R=L,L=R.parentNode}R=U}n=a===-1||y===-1?null:{start:a,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(y5={focusedElem:t,selectionRange:n},tp=!1,Qt=e;Qt!==null;)if(e=Qt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Qt=t;else for(;Qt!==null;){e=Qt;try{var q=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(q!==null){var te=q.memoizedProps,pe=q.memoizedState,ne=e.stateNode,ie=ne.getSnapshotBeforeUpdate(e.elementType===e.type?te:oa(e.type,te),pe);ne.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var re=e.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(vt(163))}}catch(_e){Yi(e,e.return,_e)}if(t=e.sibling,t!==null){t.return=e.return,Qt=t;break}Qt=e.return}return q=x_,x_=!1,q}function qf(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&z5(e,n,s)}r=r.next}while(r!==i)}}function d3(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function B5(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function xE(t){var e=t.alternate;e!==null&&(t.alternate=null,xE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Za],delete e[A2],delete e[w5],delete e[_L],delete e[yL])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function wE(t){return t.tag===5||t.tag===3||t.tag===4}function w_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||wE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function O5(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=rp));else if(i!==4&&(t=t.child,t!==null))for(O5(t,e,n),t=t.sibling;t!==null;)O5(t,e,n),t=t.sibling}function F5(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(F5(t,e,n),t=t.sibling;t!==null;)F5(t,e,n),t=t.sibling}var Ur=null,aa=!1;function k0(t,e,n){for(n=n.child;n!==null;)bE(t,e,n),n=n.sibling}function bE(t,e,n){if(Ya&&typeof Ya.onCommitFiberUnmount=="function")try{Ya.onCommitFiberUnmount(o3,n)}catch{}switch(n.tag){case 5:os||Bh(n,e);case 6:var i=Ur,r=aa;Ur=null,k0(t,e,n),Ur=i,aa=r,Ur!==null&&(aa?(t=Ur,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ur.removeChild(n.stateNode));break;case 18:Ur!==null&&(aa?(t=Ur,n=n.stateNode,t.nodeType===8?Gm(t.parentNode,n):t.nodeType===1&&Gm(t,n),l2(t)):Gm(Ur,n.stateNode));break;case 4:i=Ur,r=aa,Ur=n.stateNode.containerInfo,aa=!0,k0(t,e,n),Ur=i,aa=r;break;case 0:case 11:case 14:case 15:if(!os&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,u=s.destroy;s=s.tag,u!==void 0&&(s&2||s&4)&&z5(n,e,u),r=r.next}while(r!==i)}k0(t,e,n);break;case 1:if(!os&&(Bh(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Yi(n,e,a)}k0(t,e,n);break;case 21:k0(t,e,n);break;case 22:n.mode&1?(os=(i=os)||n.memoizedState!==null,k0(t,e,n),os=i):k0(t,e,n);break;default:k0(t,e,n)}}function b_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new zL),e.forEach(function(i){var r=WL.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function sa(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,u=e,a=u;e:for(;a!==null;){switch(a.tag){case 5:Ur=a.stateNode,aa=!1;break e;case 3:Ur=a.stateNode.containerInfo,aa=!0;break e;case 4:Ur=a.stateNode.containerInfo,aa=!0;break e}a=a.return}if(Ur===null)throw Error(vt(160));bE(s,u,r),Ur=null,aa=!1;var y=r.alternate;y!==null&&(y.return=null),r.return=null}catch(w){Yi(r,e,w)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)EE(e,t),e=e.sibling}function EE(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(sa(e,t),Ua(t),i&4){try{qf(3,t,t.return),d3(3,t)}catch(te){Yi(t,t.return,te)}try{qf(5,t,t.return)}catch(te){Yi(t,t.return,te)}}break;case 1:sa(e,t),Ua(t),i&512&&n!==null&&Bh(n,n.return);break;case 5:if(sa(e,t),Ua(t),i&512&&n!==null&&Bh(n,n.return),t.flags&32){var r=t.stateNode;try{r2(r,"")}catch(te){Yi(t,t.return,te)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,u=n!==null?n.memoizedProps:s,a=t.type,y=t.updateQueue;if(t.updateQueue=null,y!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Ww(r,s),l5(a,u);var w=l5(a,s);for(u=0;u<y.length;u+=2){var M=y[u],R=y[u+1];M==="style"?Qw(r,R):M==="dangerouslySetInnerHTML"?Zw(r,R):M==="children"?r2(r,R):Xg(r,M,R,w)}switch(a){case"input":i5(r,s);break;case"textarea":$w(r,s);break;case"select":var L=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var U=s.value;U!=null?Xh(r,!!s.multiple,U,!1):L!==!!s.multiple&&(s.defaultValue!=null?Xh(r,!!s.multiple,s.defaultValue,!0):Xh(r,!!s.multiple,s.multiple?[]:"",!1))}r[A2]=s}catch(te){Yi(t,t.return,te)}}break;case 6:if(sa(e,t),Ua(t),i&4){if(t.stateNode===null)throw Error(vt(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(te){Yi(t,t.return,te)}}break;case 3:if(sa(e,t),Ua(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{l2(e.containerInfo)}catch(te){Yi(t,t.return,te)}break;case 4:sa(e,t),Ua(t);break;case 13:sa(e,t),Ua(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(P6=ir())),i&4&&b_(t);break;case 22:if(M=n!==null&&n.memoizedState!==null,t.mode&1?(os=(w=os)||M,sa(e,t),os=w):sa(e,t),Ua(t),i&8192){if(w=t.memoizedState!==null,(t.stateNode.isHidden=w)&&!M&&t.mode&1)for(Qt=t,M=t.child;M!==null;){for(R=Qt=M;Qt!==null;){switch(L=Qt,U=L.child,L.tag){case 0:case 11:case 14:case 15:qf(4,L,L.return);break;case 1:Bh(L,L.return);var q=L.stateNode;if(typeof q.componentWillUnmount=="function"){i=L,n=L.return;try{e=i,q.props=e.memoizedProps,q.state=e.memoizedState,q.componentWillUnmount()}catch(te){Yi(i,n,te)}}break;case 5:Bh(L,L.return);break;case 22:if(L.memoizedState!==null){T_(R);continue}}U!==null?(U.return=L,Qt=U):T_(R)}M=M.sibling}e:for(M=null,R=t;;){if(R.tag===5){if(M===null){M=R;try{r=R.stateNode,w?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=R.stateNode,y=R.memoizedProps.style,u=y!=null&&y.hasOwnProperty("display")?y.display:null,a.style.display=Xw("display",u))}catch(te){Yi(t,t.return,te)}}}else if(R.tag===6){if(M===null)try{R.stateNode.nodeValue=w?"":R.memoizedProps}catch(te){Yi(t,t.return,te)}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===t)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===t)break e;for(;R.sibling===null;){if(R.return===null||R.return===t)break e;M===R&&(M=null),R=R.return}M===R&&(M=null),R.sibling.return=R.return,R=R.sibling}}break;case 19:sa(e,t),Ua(t),i&4&&b_(t);break;case 21:break;default:sa(e,t),Ua(t)}}function Ua(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(wE(n)){var i=n;break e}n=n.return}throw Error(vt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(r2(r,""),i.flags&=-33);var s=w_(t);F5(t,s,r);break;case 3:case 4:var u=i.stateNode.containerInfo,a=w_(t);O5(t,a,u);break;default:throw Error(vt(161))}}catch(y){Yi(t,t.return,y)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function OL(t,e,n){Qt=t,TE(t)}function TE(t,e,n){for(var i=(t.mode&1)!==0;Qt!==null;){var r=Qt,s=r.child;if(r.tag===22&&i){var u=r.memoizedState!==null||FA;if(!u){var a=r.alternate,y=a!==null&&a.memoizedState!==null||os;a=FA;var w=os;if(FA=u,(os=y)&&!w)for(Qt=r;Qt!==null;)u=Qt,y=u.child,u.tag===22&&u.memoizedState!==null?S_(r):y!==null?(y.return=u,Qt=y):S_(r);for(;s!==null;)Qt=s,TE(s),s=s.sibling;Qt=r,FA=a,os=w}E_(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Qt=s):E_(t)}}function E_(t){for(;Qt!==null;){var e=Qt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:os||d3(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!os)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:oa(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&a_(e,s,i);break;case 3:var u=e.updateQueue;if(u!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}a_(e,u,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var y=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&n.focus();break;case"img":y.src&&(n.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var w=e.alternate;if(w!==null){var M=w.memoizedState;if(M!==null){var R=M.dehydrated;R!==null&&l2(R)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(vt(163))}os||e.flags&512&&B5(e)}catch(L){Yi(e,e.return,L)}}if(e===t){Qt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Qt=n;break}Qt=e.return}}function T_(t){for(;Qt!==null;){var e=Qt;if(e===t){Qt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Qt=n;break}Qt=e.return}}function S_(t){for(;Qt!==null;){var e=Qt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{d3(4,e)}catch(y){Yi(e,n,y)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(y){Yi(e,r,y)}}var s=e.return;try{B5(e)}catch(y){Yi(e,s,y)}break;case 5:var u=e.return;try{B5(e)}catch(y){Yi(e,u,y)}}}catch(y){Yi(e,e.return,y)}if(e===t){Qt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Qt=a;break}Qt=e.return}}var FL=Math.ceil,pp=c0.ReactCurrentDispatcher,S6=c0.ReactCurrentOwner,Uo=c0.ReactCurrentBatchConfig,ni=0,Ir=null,cr=null,Gr=0,lo=0,Oh=uc(0),yr=0,y2=null,au=0,p3=0,C6=0,Zf=null,Fs=null,P6=0,f1=1/0,Fl=null,mp=!1,N5=null,K0=null,NA=!1,j0=null,gp=0,Xf=0,U5=null,Md=-1,Id=0;function Ts(){return ni&6?ir():Md!==-1?Md:Md=ir()}function J0(t){return t.mode&1?ni&2&&Gr!==0?Gr&-Gr:xL.transition!==null?(Id===0&&(Id=lb()),Id):(t=Ai,t!==0||(t=window.event,t=t===void 0?16:pb(t.type)),t):1}function ma(t,e,n,i){if(50<Xf)throw Xf=0,U5=null,Error(vt(185));z2(t,n,i),(!(ni&2)||t!==Ir)&&(t===Ir&&(!(ni&2)&&(p3|=n),yr===4&&V0(t,Gr)),Hs(t,i),n===1&&ni===0&&!(e.mode&1)&&(f1=ir()+500,h3&&hc()))}function Hs(t,e){var n=t.callbackNode;xk(t,e);var i=ep(t,t===Ir?Gr:0);if(i===0)n!==null&&z9(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&z9(n),e===1)t.tag===0?vL(C_.bind(null,t)):Rb(C_.bind(null,t)),mL(function(){!(ni&6)&&hc()}),n=null;else{switch(cb(i)){case 1:n=e6;break;case 4:n=ob;break;case 16:n=Jd;break;case 536870912:n=ab;break;default:n=Jd}n=DE(n,SE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function SE(t,e){if(Md=-1,Id=0,ni&6)throw Error(vt(327));var n=t.callbackNode;if(e1()&&t.callbackNode!==n)return null;var i=ep(t,t===Ir?Gr:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=_p(t,i);else{e=i;var r=ni;ni|=2;var s=PE();(Ir!==t||Gr!==e)&&(Fl=null,f1=ir()+500,Jc(t,e));do try{VL();break}catch(a){CE(t,a)}while(1);A6(),pp.current=s,ni=r,cr!==null?e=0:(Ir=null,Gr=0,e=yr)}if(e!==0){if(e===2&&(r=A5(t),r!==0&&(i=r,e=V5(t,r))),e===1)throw n=y2,Jc(t,0),V0(t,i),Hs(t,ir()),n;if(e===6)V0(t,i);else{if(r=t.current.alternate,!(i&30)&&!NL(r)&&(e=_p(t,i),e===2&&(s=A5(t),s!==0&&(i=s,e=V5(t,s))),e===1))throw n=y2,Jc(t,0),V0(t,i),Hs(t,ir()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(vt(345));case 2:Wc(t,Fs,Fl);break;case 3:if(V0(t,i),(i&130023424)===i&&(e=P6+500-ir(),10<e)){if(ep(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Ts(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=x5(Wc.bind(null,t,Fs,Fl),e);break}Wc(t,Fs,Fl);break;case 4:if(V0(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var u=31-pa(i);s=1<<u,u=e[u],u>r&&(r=u),i&=~s}if(i=r,i=ir()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*FL(i/1960))-i,10<i){t.timeoutHandle=x5(Wc.bind(null,t,Fs,Fl),i);break}Wc(t,Fs,Fl);break;case 5:Wc(t,Fs,Fl);break;default:throw Error(vt(329))}}}return Hs(t,ir()),t.callbackNode===n?SE.bind(null,t):null}function V5(t,e){var n=Zf;return t.current.memoizedState.isDehydrated&&(Jc(t,e).flags|=256),t=_p(t,e),t!==2&&(e=Fs,Fs=n,e!==null&&G5(e)),t}function G5(t){Fs===null?Fs=t:Fs.push.apply(Fs,t)}function NL(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!_a(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function V0(t,e){for(e&=~C6,e&=~p3,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-pa(e),i=1<<n;t[n]=-1,e&=~i}}function C_(t){if(ni&6)throw Error(vt(327));e1();var e=ep(t,0);if(!(e&1))return Hs(t,ir()),null;var n=_p(t,e);if(t.tag!==0&&n===2){var i=A5(t);i!==0&&(e=i,n=V5(t,i))}if(n===1)throw n=y2,Jc(t,0),V0(t,e),Hs(t,ir()),n;if(n===6)throw Error(vt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Wc(t,Fs,Fl),Hs(t,ir()),null}function M6(t,e){var n=ni;ni|=1;try{return t(e)}finally{ni=n,ni===0&&(f1=ir()+500,h3&&hc())}}function lu(t){j0!==null&&j0.tag===0&&!(ni&6)&&e1();var e=ni;ni|=1;var n=Uo.transition,i=Ai;try{if(Uo.transition=null,Ai=1,t)return t()}finally{Ai=i,Uo.transition=n,ni=e,!(ni&6)&&hc()}}function I6(){lo=Oh.current,Li(Oh)}function Jc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,pL(n)),cr!==null)for(n=cr.return;n!==null;){var i=n;switch(u6(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&sp();break;case 3:u1(),Li(Gs),Li(cs),y6();break;case 5:_6(i);break;case 4:u1();break;case 13:Li(Ui);break;case 19:Li(Ui);break;case 10:d6(i.type._context);break;case 22:case 23:I6()}n=n.return}if(Ir=t,cr=t=ec(t.current,null),Gr=lo=e,yr=0,y2=null,C6=p3=au=0,Fs=Zf=null,Xc!==null){for(e=0;e<Xc.length;e++)if(n=Xc[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var u=s.next;s.next=r,i.next=u}n.pending=i}Xc=null}return t}function CE(t,e){do{var n=cr;try{if(A6(),Sd.current=dp,Ap){for(var i=Gi.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Ap=!1}if(ou=0,Pr=_r=Gi=null,$f=!1,m2=0,S6.current=null,n===null||n.return===null){yr=1,y2=e,cr=null;break}e:{var s=t,u=n.return,a=n,y=e;if(e=Gr,a.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var w=y,M=a,R=M.tag;if(!(M.mode&1)&&(R===0||R===11||R===15)){var L=M.alternate;L?(M.updateQueue=L.updateQueue,M.memoizedState=L.memoizedState,M.lanes=L.lanes):(M.updateQueue=null,M.memoizedState=null)}var U=d_(u);if(U!==null){U.flags&=-257,p_(U,u,a,s,e),U.mode&1&&A_(s,w,e),e=U,y=w;var q=e.updateQueue;if(q===null){var te=new Set;te.add(y),e.updateQueue=te}else q.add(y);break e}else{if(!(e&1)){A_(s,w,e),k6();break e}y=Error(vt(426))}}else if(Oi&&a.mode&1){var pe=d_(u);if(pe!==null){!(pe.flags&65536)&&(pe.flags|=256),p_(pe,u,a,s,e),h6(h1(y,a));break e}}s=y=h1(y,a),yr!==4&&(yr=2),Zf===null?Zf=[s]:Zf.push(s),s=u;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var ne=uE(s,y,e);o_(s,ne);break e;case 1:a=y;var ie=s.type,re=s.stateNode;if(!(s.flags&128)&&(typeof ie.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(K0===null||!K0.has(re)))){s.flags|=65536,e&=-e,s.lanes|=e;var _e=hE(s,a,e);o_(s,_e);break e}}s=s.return}while(s!==null)}IE(n)}catch(Te){e=Te,cr===n&&n!==null&&(cr=n=n.return);continue}break}while(1)}function PE(){var t=pp.current;return pp.current=dp,t===null?dp:t}function k6(){(yr===0||yr===3||yr===2)&&(yr=4),Ir===null||!(au&268435455)&&!(p3&268435455)||V0(Ir,Gr)}function _p(t,e){var n=ni;ni|=2;var i=PE();(Ir!==t||Gr!==e)&&(Fl=null,Jc(t,e));do try{UL();break}catch(r){CE(t,r)}while(1);if(A6(),ni=n,pp.current=i,cr!==null)throw Error(vt(261));return Ir=null,Gr=0,yr}function UL(){for(;cr!==null;)ME(cr)}function VL(){for(;cr!==null&&!fk();)ME(cr)}function ME(t){var e=LE(t.alternate,t,lo);t.memoizedProps=t.pendingProps,e===null?IE(t):cr=e,S6.current=null}function IE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=RL(n,e),n!==null){n.flags&=32767,cr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yr=6,cr=null;return}}else if(n=DL(n,e,lo),n!==null){cr=n;return}if(e=e.sibling,e!==null){cr=e;return}cr=e=t}while(e!==null);yr===0&&(yr=5)}function Wc(t,e,n){var i=Ai,r=Uo.transition;try{Uo.transition=null,Ai=1,GL(t,e,n,i)}finally{Uo.transition=r,Ai=i}return null}function GL(t,e,n,i){do e1();while(j0!==null);if(ni&6)throw Error(vt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(vt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(wk(t,s),t===Ir&&(cr=Ir=null,Gr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||NA||(NA=!0,DE(Jd,function(){return e1(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Uo.transition,Uo.transition=null;var u=Ai;Ai=1;var a=ni;ni|=4,S6.current=null,BL(t,n),EE(n,t),lL(y5),tp=!!_5,y5=_5=null,t.current=n,OL(n),Ak(),ni=a,Ai=u,Uo.transition=s}else t.current=n;if(NA&&(NA=!1,j0=t,gp=r),s=t.pendingLanes,s===0&&(K0=null),mk(n.stateNode),Hs(t,ir()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(mp)throw mp=!1,t=N5,N5=null,t;return gp&1&&t.tag!==0&&e1(),s=t.pendingLanes,s&1?t===U5?Xf++:(Xf=0,U5=t):Xf=0,hc(),null}function e1(){if(j0!==null){var t=cb(gp),e=Uo.transition,n=Ai;try{if(Uo.transition=null,Ai=16>t?16:t,j0===null)var i=!1;else{if(t=j0,j0=null,gp=0,ni&6)throw Error(vt(331));var r=ni;for(ni|=4,Qt=t.current;Qt!==null;){var s=Qt,u=s.child;if(Qt.flags&16){var a=s.deletions;if(a!==null){for(var y=0;y<a.length;y++){var w=a[y];for(Qt=w;Qt!==null;){var M=Qt;switch(M.tag){case 0:case 11:case 15:qf(8,M,s)}var R=M.child;if(R!==null)R.return=M,Qt=R;else for(;Qt!==null;){M=Qt;var L=M.sibling,U=M.return;if(xE(M),M===w){Qt=null;break}if(L!==null){L.return=U,Qt=L;break}Qt=U}}}var q=s.alternate;if(q!==null){var te=q.child;if(te!==null){q.child=null;do{var pe=te.sibling;te.sibling=null,te=pe}while(te!==null)}}Qt=s}}if(s.subtreeFlags&2064&&u!==null)u.return=s,Qt=u;else e:for(;Qt!==null;){if(s=Qt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:qf(9,s,s.return)}var ne=s.sibling;if(ne!==null){ne.return=s.return,Qt=ne;break e}Qt=s.return}}var ie=t.current;for(Qt=ie;Qt!==null;){u=Qt;var re=u.child;if(u.subtreeFlags&2064&&re!==null)re.return=u,Qt=re;else e:for(u=ie;Qt!==null;){if(a=Qt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:d3(9,a)}}catch(Te){Yi(a,a.return,Te)}if(a===u){Qt=null;break e}var _e=a.sibling;if(_e!==null){_e.return=a.return,Qt=_e;break e}Qt=a.return}}if(ni=r,hc(),Ya&&typeof Ya.onPostCommitFiberRoot=="function")try{Ya.onPostCommitFiberRoot(o3,t)}catch{}i=!0}return i}finally{Ai=n,Uo.transition=e}}return!1}function P_(t,e,n){e=h1(n,e),e=uE(t,e,1),t=Y0(t,e,1),e=Ts(),t!==null&&(z2(t,1,e),Hs(t,e))}function Yi(t,e,n){if(t.tag===3)P_(t,t,n);else for(;e!==null;){if(e.tag===3){P_(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(K0===null||!K0.has(i))){t=h1(n,t),t=hE(e,t,1),e=Y0(e,t,1),t=Ts(),e!==null&&(z2(e,1,t),Hs(e,t));break}}e=e.return}}function jL(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Ts(),t.pingedLanes|=t.suspendedLanes&n,Ir===t&&(Gr&n)===n&&(yr===4||yr===3&&(Gr&130023424)===Gr&&500>ir()-P6?Jc(t,0):C6|=n),Hs(t,e)}function kE(t,e){e===0&&(t.mode&1?(e=MA,MA<<=1,!(MA&130023424)&&(MA=4194304)):e=1);var n=Ts();t=Jl(t,e),t!==null&&(z2(t,e,n),Hs(t,n))}function HL(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kE(t,n)}function WL(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(vt(314))}i!==null&&i.delete(e),kE(t,n)}var LE;LE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Gs.current)Us=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Us=!1,LL(t,e,n);Us=!!(t.flags&131072)}else Us=!1,Oi&&e.flags&1048576&&zb(e,lp,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Pd(t,e),t=e.pendingProps;var r=a1(e,cs.current);Jh(e,n),r=x6(null,e,i,t,r,n);var s=w6();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,js(i)?(s=!0,op(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,m6(e),r.updater=f3,e.stateNode=r,r._reactInternals=e,P5(e,i,t,n),e=k5(null,e,i,!0,s,n)):(e.tag=0,Oi&&s&&c6(e),ws(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Pd(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=qL(i),t=oa(i,t),r){case 0:e=I5(null,e,i,t,n);break e;case 1:e=__(null,e,i,t,n);break e;case 11:e=m_(null,e,i,t,n);break e;case 14:e=g_(null,e,i,oa(i.type,t),n);break e}throw Error(vt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:oa(i,r),I5(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:oa(i,r),__(t,e,i,r,n);case 3:e:{if(pE(e),t===null)throw Error(vt(387));i=e.pendingProps,s=e.memoizedState,r=s.element,Nb(t,e),hp(e,i,null,n);var u=e.memoizedState;if(i=u.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=h1(Error(vt(423)),e),e=y_(t,e,i,n,r);break e}else if(i!==r){r=h1(Error(vt(424)),e),e=y_(t,e,i,n,r);break e}else for(uo=Q0(e.stateNode.containerInfo.firstChild),fo=e,Oi=!0,la=null,n=jb(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(l1(),i===r){e=e0(t,e,n);break e}ws(t,e,i,n)}e=e.child}return e;case 5:return Hb(e),t===null&&T5(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,u=r.children,v5(i,r)?u=null:s!==null&&v5(i,s)&&(e.flags|=32),dE(t,e),ws(t,e,u,n),e.child;case 6:return t===null&&T5(e),null;case 13:return mE(t,e,n);case 4:return g6(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=c1(e,null,i,n):ws(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:oa(i,r),m_(t,e,i,r,n);case 7:return ws(t,e,e.pendingProps,n),e.child;case 8:return ws(t,e,e.pendingProps.children,n),e.child;case 12:return ws(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,u=r.value,Ci(cp,i._currentValue),i._currentValue=u,s!==null)if(_a(s.value,u)){if(s.children===r.children&&!Gs.current){e=e0(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){u=s.child;for(var y=a.firstContext;y!==null;){if(y.context===i){if(s.tag===1){y=Zl(-1,n&-n),y.tag=2;var w=s.updateQueue;if(w!==null){w=w.shared;var M=w.pending;M===null?y.next=y:(y.next=M.next,M.next=y),w.pending=y}}s.lanes|=n,y=s.alternate,y!==null&&(y.lanes|=n),S5(s.return,n,e),a.lanes|=n;break}y=y.next}}else if(s.tag===10)u=s.type===e.type?null:s.child;else if(s.tag===18){if(u=s.return,u===null)throw Error(vt(341));u.lanes|=n,a=u.alternate,a!==null&&(a.lanes|=n),S5(u,n,e),u=s.sibling}else u=s.child;if(u!==null)u.return=s;else for(u=s;u!==null;){if(u===e){u=null;break}if(s=u.sibling,s!==null){s.return=u.return,u=s;break}u=u.return}s=u}ws(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Jh(e,n),r=Go(r),i=i(r),e.flags|=1,ws(t,e,i,n),e.child;case 14:return i=e.type,r=oa(i,e.pendingProps),r=oa(i.type,r),g_(t,e,i,r,n);case 15:return fE(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:oa(i,r),Pd(t,e),e.tag=1,js(i)?(t=!0,op(e)):t=!1,Jh(e,n),Vb(e,i,r),P5(e,i,r,n),k5(null,e,i,!0,t,n);case 19:return gE(t,e,n);case 22:return AE(t,e,n)}throw Error(vt(156,e.tag))};function DE(t,e){return sb(t,e)}function $L(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fo(t,e,n,i){return new $L(t,e,n,i)}function L6(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qL(t){if(typeof t=="function")return L6(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Yg)return 11;if(t===Kg)return 14}return 2}function ec(t,e){var n=t.alternate;return n===null?(n=Fo(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function kd(t,e,n,i,r,s){var u=2;if(i=t,typeof t=="function")L6(t)&&(u=1);else if(typeof t=="string")u=5;else e:switch(t){case Ch:return eu(n.children,r,s,e);case Qg:u=8,r|=8;break;case K4:return t=Fo(12,n,e,r|2),t.elementType=K4,t.lanes=s,t;case J4:return t=Fo(13,n,e,r),t.elementType=J4,t.lanes=s,t;case e5:return t=Fo(19,n,e,r),t.elementType=e5,t.lanes=s,t;case Gw:return m3(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Uw:u=10;break e;case Vw:u=9;break e;case Yg:u=11;break e;case Kg:u=14;break e;case F0:u=16,i=null;break e}throw Error(vt(130,t==null?t:typeof t,""))}return e=Fo(u,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function eu(t,e,n,i){return t=Fo(7,t,i,e),t.lanes=n,t}function m3(t,e,n,i){return t=Fo(22,t,i,e),t.elementType=Gw,t.lanes=n,t.stateNode={isHidden:!1},t}function Qm(t,e,n){return t=Fo(6,t,null,e),t.lanes=n,t}function Ym(t,e,n){return e=Fo(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ZL(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=km(0),this.expirationTimes=km(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=km(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function D6(t,e,n,i,r,s,u,a,y){return t=new ZL(t,e,n,a,y),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Fo(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},m6(s),t}function XL(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Sh,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function RE(t){if(!t)return sc;t=t._reactInternals;e:{if(vu(t)!==t||t.tag!==1)throw Error(vt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(js(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(vt(171))}if(t.tag===1){var n=t.type;if(js(n))return Db(t,n,e)}return e}function zE(t,e,n,i,r,s,u,a,y){return t=D6(n,i,!0,t,r,s,u,a,y),t.context=RE(null),n=t.current,i=Ts(),r=J0(n),s=Zl(i,r),s.callback=e??null,Y0(n,s,r),t.current.lanes=r,z2(t,r,i),Hs(t,i),t}function g3(t,e,n,i){var r=e.current,s=Ts(),u=J0(r);return n=RE(n),e.context===null?e.context=n:e.pendingContext=n,e=Zl(s,u),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Y0(r,e,u),t!==null&&(ma(t,r,u,s),Td(t,r,u)),u}function yp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function M_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function R6(t,e){M_(t,e),(t=t.alternate)&&M_(t,e)}function QL(){return null}var BE=typeof reportError=="function"?reportError:function(t){console.error(t)};function z6(t){this._internalRoot=t}_3.prototype.render=z6.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(vt(409));g3(t,e,null,null)};_3.prototype.unmount=z6.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;lu(function(){g3(null,t,null,null)}),e[Kl]=null}};function _3(t){this._internalRoot=t}_3.prototype.unstable_scheduleHydration=function(t){if(t){var e=fb();t={blockedOn:null,target:t,priority:e};for(var n=0;n<U0.length&&e!==0&&e<U0[n].priority;n++);U0.splice(n,0,t),n===0&&db(t)}};function B6(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function y3(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function I_(){}function YL(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var w=yp(u);s.call(w)}}var u=zE(e,i,t,0,null,!1,!1,"",I_);return t._reactRootContainer=u,t[Kl]=u.current,h2(t.nodeType===8?t.parentNode:t),lu(),u}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var w=yp(y);a.call(w)}}var y=D6(t,0,!1,null,null,!1,!1,"",I_);return t._reactRootContainer=y,t[Kl]=y.current,h2(t.nodeType===8?t.parentNode:t),lu(function(){g3(e,y,n,i)}),y}function v3(t,e,n,i,r){var s=n._reactRootContainer;if(s){var u=s;if(typeof r=="function"){var a=r;r=function(){var y=yp(u);a.call(y)}}g3(e,u,t,r)}else u=YL(n,e,t,r,i);return yp(u)}ub=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Df(e.pendingLanes);n!==0&&(t6(e,n|1),Hs(e,ir()),!(ni&6)&&(f1=ir()+500,hc()))}break;case 13:lu(function(){var i=Jl(t,1);if(i!==null){var r=Ts();ma(i,t,1,r)}}),R6(t,1)}};n6=function(t){if(t.tag===13){var e=Jl(t,134217728);if(e!==null){var n=Ts();ma(e,t,134217728,n)}R6(t,134217728)}};hb=function(t){if(t.tag===13){var e=J0(t),n=Jl(t,e);if(n!==null){var i=Ts();ma(n,t,e,i)}R6(t,e)}};fb=function(){return Ai};Ab=function(t,e){var n=Ai;try{return Ai=t,e()}finally{Ai=n}};u5=function(t,e,n){switch(e){case"input":if(i5(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=u3(i);if(!r)throw Error(vt(90));Hw(i),i5(i,r)}}}break;case"textarea":$w(t,n);break;case"select":e=n.value,e!=null&&Xh(t,!!n.multiple,e,!1)}};Jw=M6;eb=lu;var KL={usingClientEntryPoint:!1,Events:[O2,kh,u3,Yw,Kw,M6]},pf={findFiberByHostInstance:Zc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},JL={bundleType:pf.bundleType,version:pf.version,rendererPackageName:pf.rendererPackageName,rendererConfig:pf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c0.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ib(t),t===null?null:t.stateNode},findFiberByHostInstance:pf.findFiberByHostInstance||QL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var UA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!UA.isDisabled&&UA.supportsFiber)try{o3=UA.inject(JL),Ya=UA}catch{}}_o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KL;_o.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B6(e))throw Error(vt(200));return XL(t,e,null,n)};_o.createRoot=function(t,e){if(!B6(t))throw Error(vt(299));var n=!1,i="",r=BE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=D6(t,1,!1,null,null,n,!1,i,r),t[Kl]=e.current,h2(t.nodeType===8?t.parentNode:t),new z6(e)};_o.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(vt(188)):(t=Object.keys(t).join(","),Error(vt(268,t)));return t=ib(e),t=t===null?null:t.stateNode,t};_o.flushSync=function(t){return lu(t)};_o.hydrate=function(t,e,n){if(!y3(e))throw Error(vt(200));return v3(null,t,e,!0,n)};_o.hydrateRoot=function(t,e,n){if(!B6(t))throw Error(vt(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",u=BE;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),e=zE(e,null,t,1,n??null,r,!1,s,u),t[Kl]=e.current,h2(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new _3(e)};_o.render=function(t,e,n){if(!y3(e))throw Error(vt(200));return v3(null,t,e,!1,n)};_o.unmountComponentAtNode=function(t){if(!y3(t))throw Error(vt(40));return t._reactRootContainer?(lu(function(){v3(null,null,t,!1,function(){t._reactRootContainer=null,t[Kl]=null})}),!0):!1};_o.unstable_batchedUpdates=M6;_o.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!y3(n))throw Error(vt(200));if(t==null||t._reactInternals===void 0)throw Error(vt(38));return v3(t,e,n,!1,i)};_o.version="18.2.0-next-9e3b772b8-20220608";function OE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(OE)}catch(t){console.error(t)}}OE(),zw.exports=_o;var O6=zw.exports,FE,k_=O6;FE=k_.createRoot,k_.hydrateRoot;function Ld(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function eD(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function F6(t){let e,n,i;t.length!==2?(e=Ld,n=(a,y)=>Ld(t(a),y),i=(a,y)=>t(a)-y):(e=t===Ld||t===eD?t:tD,n=t,i=t);function r(a,y,w=0,M=a.length){if(w<M){if(e(y,y)!==0)return M;do{const R=w+M>>>1;n(a[R],y)<0?w=R+1:M=R}while(w<M)}return w}function s(a,y,w=0,M=a.length){if(w<M){if(e(y,y)!==0)return M;do{const R=w+M>>>1;n(a[R],y)<=0?w=R+1:M=R}while(w<M)}return w}function u(a,y,w=0,M=a.length){const R=r(a,y,w,M-1);return R>w&&i(a[R-1],y)>-i(a[R],y)?R-1:R}return{left:r,center:u,right:s}}function tD(){return 0}function nD(t){return t===null?NaN:+t}const iD=F6(Ld),rD=iD.right;F6(nD).center;const NE=rD;function N6(t,e){let n,i;if(e===void 0)for(const r of t)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let s of t)(s=e(s,++r,t))!=null&&(n===void 0?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)))}return[n,i]}const sD=Math.sqrt(50),oD=Math.sqrt(10),aD=Math.sqrt(2);function vp(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),u=s>=sD?10:s>=oD?5:s>=aD?2:1;let a,y,w;return r<0?(w=Math.pow(10,-r)/u,a=Math.round(t*w),y=Math.round(e*w),a/w<t&&++a,y/w>e&&--y,w=-w):(w=Math.pow(10,r)*u,a=Math.round(t/w),y=Math.round(e/w),a*w<t&&++a,y*w>e&&--y),y<a&&.5<=n&&n<2?vp(t,e,n*2):[a,y,w]}function lD(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,s,u]=i?vp(e,t,n):vp(t,e,n);if(!(s>=r))return[];const a=s-r+1,y=new Array(a);if(i)if(u<0)for(let w=0;w<a;++w)y[w]=(s-w)/-u;else for(let w=0;w<a;++w)y[w]=(s-w)*u;else if(u<0)for(let w=0;w<a;++w)y[w]=(r+w)/-u;else for(let w=0;w<a;++w)y[w]=(r+w)*u;return y}function j5(t,e,n){return e=+e,t=+t,n=+n,vp(t,e,n)[2]}function H5(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?j5(e,t,n):j5(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function cD(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function D1(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}var uD={value:()=>{}};function UE(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Dd(n)}function Dd(t){this._=t}function hD(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Dd.prototype=UE.prototype={constructor:Dd,on:function(t,e){var n=this._,i=hD(t+"",n),r,s=-1,u=i.length;if(arguments.length<2){for(;++s<u;)if((r=(t=i[s]).type)&&(r=fD(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<u;)if(r=(t=i[s]).type)n[r]=L_(n[r],t.name,e);else if(e==null)for(r in n)n[r]=L_(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Dd(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function fD(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function L_(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=uD,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var W5="http://www.w3.org/1999/xhtml";const D_={svg:"http://www.w3.org/2000/svg",xhtml:W5,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function x3(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),D_.hasOwnProperty(e)?{space:D_[e],local:t}:t}function AD(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===W5&&e.documentElement.namespaceURI===W5?e.createElement(t):e.createElementNS(n,t)}}function dD(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function VE(t){var e=x3(t);return(e.local?dD:AD)(e)}function pD(){}function U6(t){return t==null?pD:function(){return this.querySelector(t)}}function mD(t){typeof t!="function"&&(t=U6(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=new Array(u),y,w,M=0;M<u;++M)(y=s[M])&&(w=t.call(y,y.__data__,M,s))&&("__data__"in y&&(w.__data__=y.__data__),a[M]=w);return new Ss(i,this._parents)}function GE(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function gD(){return[]}function jE(t){return t==null?gD:function(){return this.querySelectorAll(t)}}function _D(t){return function(){return GE(t.apply(this,arguments))}}function yD(t){typeof t=="function"?t=_D(t):t=jE(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var u=e[s],a=u.length,y,w=0;w<a;++w)(y=u[w])&&(i.push(t.call(y,y.__data__,w,u)),r.push(y));return new Ss(i,r)}function HE(t){return function(){return this.matches(t)}}function WE(t){return function(e){return e.matches(t)}}var vD=Array.prototype.find;function xD(t){return function(){return vD.call(this.children,t)}}function wD(){return this.firstElementChild}function bD(t){return this.select(t==null?wD:xD(typeof t=="function"?t:WE(t)))}var ED=Array.prototype.filter;function TD(){return Array.from(this.children)}function SD(t){return function(){return ED.call(this.children,t)}}function CD(t){return this.selectAll(t==null?TD:SD(typeof t=="function"?t:WE(t)))}function PD(t){typeof t!="function"&&(t=HE(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=[],y,w=0;w<u;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new Ss(i,this._parents)}function $E(t){return new Array(t.length)}function MD(){return new Ss(this._enter||this._groups.map($E),this._parents)}function xp(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}xp.prototype={constructor:xp,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ID(t){return function(){return t}}function kD(t,e,n,i,r,s){for(var u=0,a,y=e.length,w=s.length;u<w;++u)(a=e[u])?(a.__data__=s[u],i[u]=a):n[u]=new xp(t,s[u]);for(;u<y;++u)(a=e[u])&&(r[u]=a)}function LD(t,e,n,i,r,s,u){var a,y,w=new Map,M=e.length,R=s.length,L=new Array(M),U;for(a=0;a<M;++a)(y=e[a])&&(L[a]=U=u.call(y,y.__data__,a,e)+"",w.has(U)?r[a]=y:w.set(U,y));for(a=0;a<R;++a)U=u.call(t,s[a],a,s)+"",(y=w.get(U))?(i[a]=y,y.__data__=s[a],w.delete(U)):n[a]=new xp(t,s[a]);for(a=0;a<M;++a)(y=e[a])&&w.get(L[a])===y&&(r[a]=y)}function DD(t){return t.__data__}function RD(t,e){if(!arguments.length)return Array.from(this,DD);var n=e?LD:kD,i=this._parents,r=this._groups;typeof t!="function"&&(t=ID(t));for(var s=r.length,u=new Array(s),a=new Array(s),y=new Array(s),w=0;w<s;++w){var M=i[w],R=r[w],L=R.length,U=zD(t.call(M,M&&M.__data__,w,i)),q=U.length,te=a[w]=new Array(q),pe=u[w]=new Array(q),ne=y[w]=new Array(L);n(M,R,te,pe,ne,U,e);for(var ie=0,re=0,_e,Te;ie<q;++ie)if(_e=te[ie]){for(ie>=re&&(re=ie+1);!(Te=pe[re])&&++re<q;);_e._next=Te||null}}return u=new Ss(u,i),u._enter=a,u._exit=y,u}function zD(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function BD(){return new Ss(this._exit||this._groups.map($E),this._parents)}function OD(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function FD(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,u=Math.min(r,s),a=new Array(r),y=0;y<u;++y)for(var w=n[y],M=i[y],R=w.length,L=a[y]=new Array(R),U,q=0;q<R;++q)(U=w[q]||M[q])&&(L[q]=U);for(;y<r;++y)a[y]=n[y];return new Ss(a,this._parents)}function ND(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],u;--r>=0;)(u=i[r])&&(s&&u.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(u,s),s=u);return this}function UD(t){t||(t=VD);function e(R,L){return R&&L?t(R.__data__,L.__data__):!R-!L}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var u=n[s],a=u.length,y=r[s]=new Array(a),w,M=0;M<a;++M)(w=u[M])&&(y[M]=w);y.sort(e)}return new Ss(r,this._parents).order()}function VD(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function GD(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function jD(){return Array.from(this)}function HD(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var u=i[r];if(u)return u}return null}function WD(){let t=0;for(const e of this)++t;return t}function $D(){return!this.node()}function qD(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,u=r.length,a;s<u;++s)(a=r[s])&&t.call(a,a.__data__,s,r);return this}function ZD(t){return function(){this.removeAttribute(t)}}function XD(t){return function(){this.removeAttributeNS(t.space,t.local)}}function QD(t,e){return function(){this.setAttribute(t,e)}}function YD(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function KD(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function JD(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function eR(t,e){var n=x3(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?XD:ZD:typeof e=="function"?n.local?JD:KD:n.local?YD:QD)(n,e))}function qE(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function tR(t){return function(){this.style.removeProperty(t)}}function nR(t,e,n){return function(){this.style.setProperty(t,e,n)}}function iR(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function rR(t,e,n){return arguments.length>1?this.each((e==null?tR:typeof e=="function"?iR:nR)(t,e,n??"")):A1(this.node(),t)}function A1(t,e){return t.style.getPropertyValue(e)||qE(t).getComputedStyle(t,null).getPropertyValue(e)}function sR(t){return function(){delete this[t]}}function oR(t,e){return function(){this[t]=e}}function aR(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function lR(t,e){return arguments.length>1?this.each((e==null?sR:typeof e=="function"?aR:oR)(t,e)):this.node()[t]}function ZE(t){return t.trim().split(/^|\s+/)}function V6(t){return t.classList||new XE(t)}function XE(t){this._node=t,this._names=ZE(t.getAttribute("class")||"")}XE.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function QE(t,e){for(var n=V6(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function YE(t,e){for(var n=V6(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function cR(t){return function(){QE(this,t)}}function uR(t){return function(){YE(this,t)}}function hR(t,e){return function(){(e.apply(this,arguments)?QE:YE)(this,t)}}function fR(t,e){var n=ZE(t+"");if(arguments.length<2){for(var i=V6(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?hR:e?cR:uR)(n,e))}function AR(){this.textContent=""}function dR(t){return function(){this.textContent=t}}function pR(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function mR(t){return arguments.length?this.each(t==null?AR:(typeof t=="function"?pR:dR)(t)):this.node().textContent}function gR(){this.innerHTML=""}function _R(t){return function(){this.innerHTML=t}}function yR(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function vR(t){return arguments.length?this.each(t==null?gR:(typeof t=="function"?yR:_R)(t)):this.node().innerHTML}function xR(){this.nextSibling&&this.parentNode.appendChild(this)}function wR(){return this.each(xR)}function bR(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ER(){return this.each(bR)}function TR(t){var e=typeof t=="function"?t:VE(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function SR(){return null}function CR(t,e){var n=typeof t=="function"?t:VE(t),i=e==null?SR:typeof e=="function"?e:U6(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function PR(){var t=this.parentNode;t&&t.removeChild(this)}function MR(){return this.each(PR)}function IR(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function kR(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function LR(t){return this.select(t?kR:IR)}function DR(t){return arguments.length?this.property("__data__",t):this.node().__data__}function RR(t){return function(e){t.call(this,e,this.__data__)}}function zR(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function BR(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function OR(t,e,n){return function(){var i=this.__on,r,s=RR(e);if(i){for(var u=0,a=i.length;u<a;++u)if((r=i[u]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function FR(t,e,n){var i=zR(t+""),r,s=i.length,u;if(arguments.length<2){var a=this.node().__on;if(a){for(var y=0,w=a.length,M;y<w;++y)for(r=0,M=a[y];r<s;++r)if((u=i[r]).type===M.type&&u.name===M.name)return M.value}return}for(a=e?OR:BR,r=0;r<s;++r)this.each(a(i[r],e,n));return this}function KE(t,e,n){var i=qE(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function NR(t,e){return function(){return KE(this,t,e)}}function UR(t,e){return function(){return KE(this,t,e.apply(this,arguments))}}function VR(t,e){return this.each((typeof e=="function"?UR:NR)(t,e))}function*GR(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,u;r<s;++r)(u=i[r])&&(yield u)}var G6=[null];function Ss(t,e){this._groups=t,this._parents=e}function N2(){return new Ss([[document.documentElement]],G6)}function jR(){return this}Ss.prototype=N2.prototype={constructor:Ss,select:mD,selectAll:yD,selectChild:bD,selectChildren:CD,filter:PD,data:RD,enter:MD,exit:BD,join:OD,merge:FD,selection:jR,order:ND,sort:UD,call:GD,nodes:jD,node:HD,size:WD,empty:$D,each:qD,attr:eR,style:rR,property:lR,classed:fR,text:mR,html:vR,raise:wR,lower:ER,append:TR,insert:CR,remove:MR,clone:LR,datum:DR,on:FR,dispatch:VR,[Symbol.iterator]:GR};function Lo(t){return typeof t=="string"?new Ss([[document.querySelector(t)]],[document.documentElement]):new Ss([[t]],G6)}function HR(t){return typeof t=="string"?new Ss([document.querySelectorAll(t)],[document.documentElement]):new Ss([GE(t)],G6)}function j6(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function JE(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function U2(){}var v2=.7,wp=1/v2,t1="\\s*([+-]?\\d+)\\s*",x2="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ja="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",WR=/^#([0-9a-f]{3,8})$/,$R=new RegExp(`^rgb\\(${t1},${t1},${t1}\\)$`),qR=new RegExp(`^rgb\\(${Ja},${Ja},${Ja}\\)$`),ZR=new RegExp(`^rgba\\(${t1},${t1},${t1},${x2}\\)$`),XR=new RegExp(`^rgba\\(${Ja},${Ja},${Ja},${x2}\\)$`),QR=new RegExp(`^hsl\\(${x2},${Ja},${Ja}\\)$`),YR=new RegExp(`^hsla\\(${x2},${Ja},${Ja},${x2}\\)$`),R_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};j6(U2,cu,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:z_,formatHex:z_,formatHex8:KR,formatHsl:JR,formatRgb:B_,toString:B_});function z_(){return this.rgb().formatHex()}function KR(){return this.rgb().formatHex8()}function JR(){return eT(this).formatHsl()}function B_(){return this.rgb().formatRgb()}function cu(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=WR.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?O_(e):n===3?new Vs(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?VA(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?VA(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=$R.exec(t))?new Vs(e[1],e[2],e[3],1):(e=qR.exec(t))?new Vs(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ZR.exec(t))?VA(e[1],e[2],e[3],e[4]):(e=XR.exec(t))?VA(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=QR.exec(t))?U_(e[1],e[2]/100,e[3]/100,1):(e=YR.exec(t))?U_(e[1],e[2]/100,e[3]/100,e[4]):R_.hasOwnProperty(t)?O_(R_[t]):t==="transparent"?new Vs(NaN,NaN,NaN,0):null}function O_(t){return new Vs(t>>16&255,t>>8&255,t&255,1)}function VA(t,e,n,i){return i<=0&&(t=e=n=NaN),new Vs(t,e,n,i)}function ez(t){return t instanceof U2||(t=cu(t)),t?(t=t.rgb(),new Vs(t.r,t.g,t.b,t.opacity)):new Vs}function bp(t,e,n,i){return arguments.length===1?ez(t):new Vs(t,e,n,i??1)}function Vs(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}j6(Vs,bp,JE(U2,{brighter(t){return t=t==null?wp:Math.pow(wp,t),new Vs(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?v2:Math.pow(v2,t),new Vs(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Vs(tu(this.r),tu(this.g),tu(this.b),Ep(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:F_,formatHex:F_,formatHex8:tz,formatRgb:N_,toString:N_}));function F_(){return`#${Yc(this.r)}${Yc(this.g)}${Yc(this.b)}`}function tz(){return`#${Yc(this.r)}${Yc(this.g)}${Yc(this.b)}${Yc((isNaN(this.opacity)?1:this.opacity)*255)}`}function N_(){const t=Ep(this.opacity);return`${t===1?"rgb(":"rgba("}${tu(this.r)}, ${tu(this.g)}, ${tu(this.b)}${t===1?")":`, ${t})`}`}function Ep(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function tu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Yc(t){return t=tu(t),(t<16?"0":"")+t.toString(16)}function U_(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ua(t,e,n,i)}function eT(t){if(t instanceof ua)return new ua(t.h,t.s,t.l,t.opacity);if(t instanceof U2||(t=cu(t)),!t)return new ua;if(t instanceof ua)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),u=NaN,a=s-r,y=(s+r)/2;return a?(e===s?u=(n-i)/a+(n<i)*6:n===s?u=(i-e)/a+2:u=(e-n)/a+4,a/=y<.5?s+r:2-s-r,u*=60):a=y>0&&y<1?0:u,new ua(u,a,y,t.opacity)}function nz(t,e,n,i){return arguments.length===1?eT(t):new ua(t,e,n,i??1)}function ua(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}j6(ua,nz,JE(U2,{brighter(t){return t=t==null?wp:Math.pow(wp,t),new ua(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?v2:Math.pow(v2,t),new ua(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Vs(Km(t>=240?t-240:t+120,r,i),Km(t,r,i),Km(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new ua(V_(this.h),GA(this.s),GA(this.l),Ep(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ep(this.opacity);return`${t===1?"hsl(":"hsla("}${V_(this.h)}, ${GA(this.s)*100}%, ${GA(this.l)*100}%${t===1?")":`, ${t})`}`}}));function V_(t){return t=(t||0)%360,t<0?t+360:t}function GA(t){return Math.max(0,Math.min(1,t||0))}function Km(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function iz(t,e,n,i,r){var s=t*t,u=s*t;return((1-3*t+3*s-u)*e+(4-6*s+3*u)*n+(1+3*t+3*s-3*u)*i+u*r)/6}function rz(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],u=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return iz((n-i/e)*e,u,r,s,a)}}const H6=t=>()=>t;function sz(t,e){return function(n){return t+n*e}}function oz(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function az(t){return(t=+t)==1?tT:function(e,n){return n-e?oz(e,n,t):H6(isNaN(e)?n:e)}}function tT(t,e){var n=e-t;return n?sz(t,n):H6(isNaN(t)?e:t)}const Tp=function t(e){var n=az(e);function i(r,s){var u=n((r=bp(r)).r,(s=bp(s)).r),a=n(r.g,s.g),y=n(r.b,s.b),w=tT(r.opacity,s.opacity);return function(M){return r.r=u(M),r.g=a(M),r.b=y(M),r.opacity=w(M),r+""}}return i.gamma=t,i}(1);function lz(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),s=new Array(n),u,a;for(u=0;u<n;++u)a=bp(e[u]),i[u]=a.r||0,r[u]=a.g||0,s[u]=a.b||0;return i=t(i),r=t(r),s=t(s),a.opacity=1,function(y){return a.r=i(y),a.g=r(y),a.b=s(y),a+""}}}var cz=lz(rz);function uz(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function hz(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function fz(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),u;for(u=0;u<i;++u)r[u]=W6(t[u],e[u]);for(;u<n;++u)s[u]=e[u];return function(a){for(u=0;u<i;++u)s[u]=r[u](a);return s}}function Az(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function ca(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function dz(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=W6(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var $5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jm=new RegExp($5.source,"g");function pz(t){return function(){return t}}function mz(t){return function(e){return t(e)+""}}function nT(t,e){var n=$5.lastIndex=Jm.lastIndex=0,i,r,s,u=-1,a=[],y=[];for(t=t+"",e=e+"";(i=$5.exec(t))&&(r=Jm.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),a[u]?a[u]+=s:a[++u]=s),(i=i[0])===(r=r[0])?a[u]?a[u]+=r:a[++u]=r:(a[++u]=null,y.push({i:u,x:ca(i,r)})),n=Jm.lastIndex;return n<e.length&&(s=e.slice(n),a[u]?a[u]+=s:a[++u]=s),a.length<2?y[0]?mz(y[0].x):pz(e):(e=y.length,function(w){for(var M=0,R;M<e;++M)a[(R=y[M]).i]=R.x(w);return a.join("")})}function W6(t,e){var n=typeof e,i;return e==null||n==="boolean"?H6(e):(n==="number"?ca:n==="string"?(i=cu(e))?(e=i,Tp):nT:e instanceof cu?Tp:e instanceof Date?Az:hz(e)?uz:Array.isArray(e)?fz:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?dz:ca)(t,e)}function gz(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var G_=180/Math.PI,q5={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function iT(t,e,n,i,r,s){var u,a,y;return(u=Math.sqrt(t*t+e*e))&&(t/=u,e/=u),(y=t*n+e*i)&&(n-=t*y,i-=e*y),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,y/=a),t*i<e*n&&(t=-t,e=-e,y=-y,u=-u),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*G_,skewX:Math.atan(y)*G_,scaleX:u,scaleY:a}}var jA;function _z(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?q5:iT(e.a,e.b,e.c,e.d,e.e,e.f)}function yz(t){return t==null||(jA||(jA=document.createElementNS("http://www.w3.org/2000/svg","g")),jA.setAttribute("transform",t),!(t=jA.transform.baseVal.consolidate()))?q5:(t=t.matrix,iT(t.a,t.b,t.c,t.d,t.e,t.f))}function rT(t,e,n,i){function r(w){return w.length?w.pop()+" ":""}function s(w,M,R,L,U,q){if(w!==R||M!==L){var te=U.push("translate(",null,e,null,n);q.push({i:te-4,x:ca(w,R)},{i:te-2,x:ca(M,L)})}else(R||L)&&U.push("translate("+R+e+L+n)}function u(w,M,R,L){w!==M?(w-M>180?M+=360:M-w>180&&(w+=360),L.push({i:R.push(r(R)+"rotate(",null,i)-2,x:ca(w,M)})):M&&R.push(r(R)+"rotate("+M+i)}function a(w,M,R,L){w!==M?L.push({i:R.push(r(R)+"skewX(",null,i)-2,x:ca(w,M)}):M&&R.push(r(R)+"skewX("+M+i)}function y(w,M,R,L,U,q){if(w!==R||M!==L){var te=U.push(r(U)+"scale(",null,",",null,")");q.push({i:te-4,x:ca(w,R)},{i:te-2,x:ca(M,L)})}else(R!==1||L!==1)&&U.push(r(U)+"scale("+R+","+L+")")}return function(w,M){var R=[],L=[];return w=t(w),M=t(M),s(w.translateX,w.translateY,M.translateX,M.translateY,R,L),u(w.rotate,M.rotate,R,L),a(w.skewX,M.skewX,R,L),y(w.scaleX,w.scaleY,M.scaleX,M.scaleY,R,L),w=M=null,function(U){for(var q=-1,te=L.length,pe;++q<te;)R[(pe=L[q]).i]=pe.x(U);return R.join("")}}}var vz=rT(_z,"px, ","px)","deg)"),xz=rT(yz,", ",")",")"),d1=0,zf=0,mf=0,sT=1e3,Sp,Bf,Cp=0,uu=0,w3=0,w2=typeof performance=="object"&&performance.now?performance:Date,oT=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $6(){return uu||(oT(wz),uu=w2.now()+w3)}function wz(){uu=0}function Pp(){this._call=this._time=this._next=null}Pp.prototype=aT.prototype={constructor:Pp,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?$6():+n)+(e==null?0:+e),!this._next&&Bf!==this&&(Bf?Bf._next=this:Sp=this,Bf=this),this._call=t,this._time=n,Z5()},stop:function(){this._call&&(this._call=null,this._time=1/0,Z5())}};function aT(t,e,n){var i=new Pp;return i.restart(t,e,n),i}function bz(){$6(),++d1;for(var t=Sp,e;t;)(e=uu-t._time)>=0&&t._call.call(void 0,e),t=t._next;--d1}function j_(){uu=(Cp=w2.now())+w3,d1=zf=0;try{bz()}finally{d1=0,Tz(),uu=0}}function Ez(){var t=w2.now(),e=t-Cp;e>sT&&(w3-=e,Cp=t)}function Tz(){for(var t,e=Sp,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Sp=n);Bf=t,Z5(i)}function Z5(t){if(!d1){zf&&(zf=clearTimeout(zf));var e=t-uu;e>24?(t<1/0&&(zf=setTimeout(j_,t-w2.now()-w3)),mf&&(mf=clearInterval(mf))):(mf||(Cp=w2.now(),mf=setInterval(Ez,sT)),d1=1,oT(j_))}}function H_(t,e,n){var i=new Pp;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var Sz=UE("start","end","cancel","interrupt"),Cz=[],lT=0,W_=1,X5=2,Rd=3,$_=4,Q5=5,zd=6;function b3(t,e,n,i,r,s){var u=t.__transition;if(!u)t.__transition={};else if(n in u)return;Pz(t,n,{name:e,index:i,group:r,on:Sz,tween:Cz,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:lT})}function q6(t,e){var n=va(t,e);if(n.state>lT)throw new Error("too late; already scheduled");return n}function nl(t,e){var n=va(t,e);if(n.state>Rd)throw new Error("too late; already running");return n}function va(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Pz(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=aT(s,0,n.time);function s(w){n.state=W_,n.timer.restart(u,n.delay,n.time),n.delay<=w&&u(w-n.delay)}function u(w){var M,R,L,U;if(n.state!==W_)return y();for(M in i)if(U=i[M],U.name===n.name){if(U.state===Rd)return H_(u);U.state===$_?(U.state=zd,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete i[M]):+M<e&&(U.state=zd,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete i[M])}if(H_(function(){n.state===Rd&&(n.state=$_,n.timer.restart(a,n.delay,n.time),a(w))}),n.state=X5,n.on.call("start",t,t.__data__,n.index,n.group),n.state===X5){for(n.state=Rd,r=new Array(L=n.tween.length),M=0,R=-1;M<L;++M)(U=n.tween[M].value.call(t,t.__data__,n.index,n.group))&&(r[++R]=U);r.length=R+1}}function a(w){for(var M=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(y),n.state=Q5,1),R=-1,L=r.length;++R<L;)r[R].call(t,M);n.state===Q5&&(n.on.call("end",t,t.__data__,n.index,n.group),y())}function y(){n.state=zd,n.timer.stop(),delete i[e];for(var w in i)return;delete t.__transition}}function Mz(t,e){var n=t.__transition,i,r,s=!0,u;if(n){e=e==null?null:e+"";for(u in n){if((i=n[u]).name!==e){s=!1;continue}r=i.state>X5&&i.state<Q5,i.state=zd,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[u]}s&&delete t.__transition}}function Iz(t){return this.each(function(){Mz(this,t)})}function kz(t,e){var n,i;return function(){var r=nl(this,t),s=r.tween;if(s!==n){i=n=s;for(var u=0,a=i.length;u<a;++u)if(i[u].name===e){i=i.slice(),i.splice(u,1);break}}r.tween=i}}function Lz(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=nl(this,t),u=s.tween;if(u!==i){r=(i=u).slice();for(var a={name:e,value:n},y=0,w=r.length;y<w;++y)if(r[y].name===e){r[y]=a;break}y===w&&r.push(a)}s.tween=r}}function Dz(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=va(this.node(),n).tween,r=0,s=i.length,u;r<s;++r)if((u=i[r]).name===t)return u.value;return null}return this.each((e==null?kz:Lz)(n,t,e))}function Z6(t,e,n){var i=t._id;return t.each(function(){var r=nl(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return va(r,i).value[e]}}function cT(t,e){var n;return(typeof e=="number"?ca:e instanceof cu?Tp:(n=cu(e))?(e=n,Tp):nT)(t,e)}function Rz(t){return function(){this.removeAttribute(t)}}function zz(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Bz(t,e,n){var i,r=n+"",s;return function(){var u=this.getAttribute(t);return u===r?null:u===i?s:s=e(i=u,n)}}function Oz(t,e,n){var i,r=n+"",s;return function(){var u=this.getAttributeNS(t.space,t.local);return u===r?null:u===i?s:s=e(i=u,n)}}function Fz(t,e,n){var i,r,s;return function(){var u,a=n(this),y;return a==null?void this.removeAttribute(t):(u=this.getAttribute(t),y=a+"",u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a)))}}function Nz(t,e,n){var i,r,s;return function(){var u,a=n(this),y;return a==null?void this.removeAttributeNS(t.space,t.local):(u=this.getAttributeNS(t.space,t.local),y=a+"",u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a)))}}function Uz(t,e){var n=x3(t),i=n==="transform"?xz:cT;return this.attrTween(t,typeof e=="function"?(n.local?Nz:Fz)(n,i,Z6(this,"attr."+t,e)):e==null?(n.local?zz:Rz)(n):(n.local?Oz:Bz)(n,i,e))}function Vz(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Gz(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function jz(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Gz(t,s)),n}return r._value=e,r}function Hz(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Vz(t,s)),n}return r._value=e,r}function Wz(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=x3(t);return this.tween(n,(i.local?jz:Hz)(i,e))}function $z(t,e){return function(){q6(this,t).delay=+e.apply(this,arguments)}}function qz(t,e){return e=+e,function(){q6(this,t).delay=e}}function Zz(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?$z:qz)(e,t)):va(this.node(),e).delay}function Xz(t,e){return function(){nl(this,t).duration=+e.apply(this,arguments)}}function Qz(t,e){return e=+e,function(){nl(this,t).duration=e}}function Yz(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Xz:Qz)(e,t)):va(this.node(),e).duration}function Kz(t,e){if(typeof e!="function")throw new Error;return function(){nl(this,t).ease=e}}function Jz(t){var e=this._id;return arguments.length?this.each(Kz(e,t)):va(this.node(),e).ease}function eB(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;nl(this,t).ease=n}}function tB(t){if(typeof t!="function")throw new Error;return this.each(eB(this._id,t))}function nB(t){typeof t!="function"&&(t=HE(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=[],y,w=0;w<u;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new t0(i,this._parents,this._name,this._id)}function iB(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),u=new Array(i),a=0;a<s;++a)for(var y=e[a],w=n[a],M=y.length,R=u[a]=new Array(M),L,U=0;U<M;++U)(L=y[U]||w[U])&&(R[U]=L);for(;a<i;++a)u[a]=e[a];return new t0(u,this._parents,this._name,this._id)}function rB(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function sB(t,e,n){var i,r,s=rB(e)?q6:nl;return function(){var u=s(this,t),a=u.on;a!==i&&(r=(i=a).copy()).on(e,n),u.on=r}}function oB(t,e){var n=this._id;return arguments.length<2?va(this.node(),n).on.on(t):this.each(sB(n,t,e))}function aB(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function lB(){return this.on("end.remove",aB(this._id))}function cB(t){var e=this._name,n=this._id;typeof t!="function"&&(t=U6(t));for(var i=this._groups,r=i.length,s=new Array(r),u=0;u<r;++u)for(var a=i[u],y=a.length,w=s[u]=new Array(y),M,R,L=0;L<y;++L)(M=a[L])&&(R=t.call(M,M.__data__,L,a))&&("__data__"in M&&(R.__data__=M.__data__),w[L]=R,b3(w[L],e,n,L,w,va(M,n)));return new t0(s,this._parents,e,n)}function uB(t){var e=this._name,n=this._id;typeof t!="function"&&(t=jE(t));for(var i=this._groups,r=i.length,s=[],u=[],a=0;a<r;++a)for(var y=i[a],w=y.length,M,R=0;R<w;++R)if(M=y[R]){for(var L=t.call(M,M.__data__,R,y),U,q=va(M,n),te=0,pe=L.length;te<pe;++te)(U=L[te])&&b3(U,e,n,te,L,q);s.push(L),u.push(M)}return new t0(s,u,e,n)}var hB=N2.prototype.constructor;function fB(){return new hB(this._groups,this._parents)}function AB(t,e){var n,i,r;return function(){var s=A1(this,t),u=(this.style.removeProperty(t),A1(this,t));return s===u?null:s===n&&u===i?r:r=e(n=s,i=u)}}function uT(t){return function(){this.style.removeProperty(t)}}function dB(t,e,n){var i,r=n+"",s;return function(){var u=A1(this,t);return u===r?null:u===i?s:s=e(i=u,n)}}function pB(t,e,n){var i,r,s;return function(){var u=A1(this,t),a=n(this),y=a+"";return a==null&&(y=a=(this.style.removeProperty(t),A1(this,t))),u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a))}}function mB(t,e){var n,i,r,s="style."+e,u="end."+s,a;return function(){var y=nl(this,t),w=y.on,M=y.value[s]==null?a||(a=uT(e)):void 0;(w!==n||r!==M)&&(i=(n=w).copy()).on(u,r=M),y.on=i}}function gB(t,e,n){var i=(t+="")=="transform"?vz:cT;return e==null?this.styleTween(t,AB(t,i)).on("end.style."+t,uT(t)):typeof e=="function"?this.styleTween(t,pB(t,i,Z6(this,"style."+t,e))).each(mB(this._id,t)):this.styleTween(t,dB(t,i,e),n).on("end.style."+t,null)}function _B(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function yB(t,e,n){var i,r;function s(){var u=e.apply(this,arguments);return u!==r&&(i=(r=u)&&_B(t,u,n)),i}return s._value=e,s}function vB(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,yB(t,e,n??""))}function xB(t){return function(){this.textContent=t}}function wB(t){return function(){var e=t(this);this.textContent=e??""}}function bB(t){return this.tween("text",typeof t=="function"?wB(Z6(this,"text",t)):xB(t==null?"":t+""))}function EB(t){return function(e){this.textContent=t.call(this,e)}}function TB(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&EB(r)),e}return i._value=t,i}function SB(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,TB(t))}function CB(){for(var t=this._name,e=this._id,n=hT(),i=this._groups,r=i.length,s=0;s<r;++s)for(var u=i[s],a=u.length,y,w=0;w<a;++w)if(y=u[w]){var M=va(y,e);b3(y,t,n,w,u,{time:M.time+M.delay+M.duration,delay:0,duration:M.duration,ease:M.ease})}return new t0(i,this._parents,t,n)}function PB(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,u){var a={value:u},y={value:function(){--r===0&&s()}};n.each(function(){var w=nl(this,i),M=w.on;M!==t&&(e=(t=M).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(y)),w.on=e}),r===0&&s()})}var MB=0;function t0(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function hT(){return++MB}var zl=N2.prototype;t0.prototype={constructor:t0,select:cB,selectAll:uB,selectChild:zl.selectChild,selectChildren:zl.selectChildren,filter:nB,merge:iB,selection:fB,transition:CB,call:zl.call,nodes:zl.nodes,node:zl.node,size:zl.size,empty:zl.empty,each:zl.each,on:oB,attr:Uz,attrTween:Wz,style:gB,styleTween:vB,text:bB,textTween:SB,remove:lB,tween:Dz,delay:Zz,duration:Yz,ease:Jz,easeVarying:tB,end:PB,[Symbol.iterator]:zl[Symbol.iterator]};function IB(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var X6=1.70158;(function t(e){e=+e;function n(i){return(i=+i)*i*(e*(i-1)+i)}return n.overshoot=t,n})(X6);var q_=function t(e){e=+e;function n(i){return--i*i*((i+1)*e+i)+1}return n.overshoot=t,n}(X6);(function t(e){e=+e;function n(i){return((i*=2)<1?i*i*((e+1)*i-e):(i-=2)*i*((e+1)*i+e)+2)/2}return n.overshoot=t,n})(X6);var kB={time:null,delay:0,duration:250,ease:IB};function LB(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function DB(t){var e,n;t instanceof t0?(e=t._id,t=t._name):(e=hT(),(n=kB).time=$6(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var u=i[s],a=u.length,y,w=0;w<a;++w)(y=u[w])&&b3(y,t,e,w,u,n||LB(y,e));return new t0(i,this._parents,t,e)}N2.prototype.interrupt=Iz;N2.prototype.transition=DB;const Y5=Math.PI,K5=2*Y5,$c=1e-6,RB=K5-$c;function fT(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function zB(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return fT;const n=10**e;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}class BB{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?fT:zB(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,i,r){this._append`Q${+e},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(e,n,i,r,s,u){this._append`C${+e},${+n},${+i},${+r},${this._x1=+s},${this._y1=+u}`}arcTo(e,n,i,r,s){if(e=+e,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let u=this._x1,a=this._y1,y=i-e,w=r-n,M=u-e,R=a-n,L=M*M+R*R;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(L>$c)if(!(Math.abs(R*y-w*M)>$c)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let U=i-u,q=r-a,te=y*y+w*w,pe=U*U+q*q,ne=Math.sqrt(te),ie=Math.sqrt(L),re=s*Math.tan((Y5-Math.acos((te+L-pe)/(2*ne*ie)))/2),_e=re/ie,Te=re/ne;Math.abs(_e-1)>$c&&this._append`L${e+_e*M},${n+_e*R}`,this._append`A${s},${s},0,0,${+(R*U>M*q)},${this._x1=e+Te*y},${this._y1=n+Te*w}`}}arc(e,n,i,r,s,u){if(e=+e,n=+n,i=+i,u=!!u,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),y=i*Math.sin(r),w=e+a,M=n+y,R=1^u,L=u?r-s:s-r;this._x1===null?this._append`M${w},${M}`:(Math.abs(this._x1-w)>$c||Math.abs(this._y1-M)>$c)&&this._append`L${w},${M}`,i&&(L<0&&(L=L%K5+K5),L>RB?this._append`A${i},${i},0,1,${R},${e-a},${n-y}A${i},${i},0,1,${R},${this._x1=w},${this._y1=M}`:L>$c&&this._append`A${i},${i},0,${+(L>=Y5)},${R},${this._x1=e+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(e,n,i,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}function OB(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Mp(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function p1(t){return t=Mp(Math.abs(t)),t?t[1]:NaN}function FB(t,e){return function(n,i){for(var r=n.length,s=[],u=0,a=t[0],y=0;r>0&&a>0&&(y+a+1>i&&(a=Math.max(1,i-y)),s.push(n.substring(r-=a,r+a)),!((y+=a+1)>i));)a=t[u=(u+1)%t.length];return s.reverse().join(e)}}function NB(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var UB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ip(t){if(!(e=UB.exec(t)))throw new Error("invalid format: "+t);var e;return new Q6({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Ip.prototype=Q6.prototype;function Q6(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Q6.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function VB(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var AT;function GB(t,e){var n=Mp(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(AT=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,u=i.length;return s===u?i:s>u?i+new Array(s-u+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Mp(t,Math.max(0,e+s-1))[0]}function Z_(t,e){var n=Mp(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const X_={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:OB,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Z_(t*100,e),r:Z_,s:GB,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Q_(t){return t}var Y_=Array.prototype.map,K_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function jB(t){var e=t.grouping===void 0||t.thousands===void 0?Q_:FB(Y_.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Q_:NB(Y_.call(t.numerals,String)),u=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",y=t.nan===void 0?"NaN":t.nan+"";function w(R){R=Ip(R);var L=R.fill,U=R.align,q=R.sign,te=R.symbol,pe=R.zero,ne=R.width,ie=R.comma,re=R.precision,_e=R.trim,Te=R.type;Te==="n"?(ie=!0,Te="g"):X_[Te]||(re===void 0&&(re=12),_e=!0,Te="g"),(pe||L==="0"&&U==="=")&&(pe=!0,L="0",U="=");var De=te==="$"?n:te==="#"&&/[boxX]/.test(Te)?"0"+Te.toLowerCase():"",$e=te==="$"?i:/[%p]/.test(Te)?u:"",nt=X_[Te],ut=/[defgprs%]/.test(Te);re=re===void 0?6:/[gprs]/.test(Te)?Math.max(1,Math.min(21,re)):Math.max(0,Math.min(20,re));function st(lt){var Lt=De,ht=$e,Tt,Pn,Ft;if(Te==="c")ht=nt(lt)+ht,lt="";else{lt=+lt;var Zn=lt<0||1/lt<0;if(lt=isNaN(lt)?y:nt(Math.abs(lt),re),_e&&(lt=VB(lt)),Zn&&+lt==0&&q!=="+"&&(Zn=!1),Lt=(Zn?q==="("?q:a:q==="-"||q==="("?"":q)+Lt,ht=(Te==="s"?K_[8+AT/3]:"")+ht+(Zn&&q==="("?")":""),ut){for(Tt=-1,Pn=lt.length;++Tt<Pn;)if(Ft=lt.charCodeAt(Tt),48>Ft||Ft>57){ht=(Ft===46?r+lt.slice(Tt+1):lt.slice(Tt))+ht,lt=lt.slice(0,Tt);break}}}ie&&!pe&&(lt=e(lt,1/0));var yt=Lt.length+lt.length+ht.length,Ot=yt<ne?new Array(ne-yt+1).join(L):"";switch(ie&&pe&&(lt=e(Ot+lt,Ot.length?ne-ht.length:1/0),Ot=""),U){case"<":lt=Lt+lt+ht+Ot;break;case"=":lt=Lt+Ot+lt+ht;break;case"^":lt=Ot.slice(0,yt=Ot.length>>1)+Lt+lt+ht+Ot.slice(yt);break;default:lt=Ot+Lt+lt+ht;break}return s(lt)}return st.toString=function(){return R+""},st}function M(R,L){var U=w((R=Ip(R),R.type="f",R)),q=Math.max(-8,Math.min(8,Math.floor(p1(L)/3)))*3,te=Math.pow(10,-q),pe=K_[8+q/3];return function(ne){return U(te*ne)+pe}}return{format:w,formatPrefix:M}}var HA,dT,pT;HB({thousands:",",grouping:[3],currency:["$",""]});function HB(t){return HA=jB(t),dT=HA.format,pT=HA.formatPrefix,HA}function WB(t){return Math.max(0,-p1(Math.abs(t)))}function $B(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(p1(e)/3)))*3-p1(Math.abs(t)))}function qB(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,p1(e)-p1(t))+1}function Y6(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ZB(t){return function(){return t}}function XB(t){return+t}var J_=[0,1];function Fh(t){return t}function J5(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:ZB(isNaN(e)?NaN:.5)}function QB(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function YB(t,e,n){var i=t[0],r=t[1],s=e[0],u=e[1];return r<i?(i=J5(r,i),s=n(u,s)):(i=J5(i,r),s=n(s,u)),function(a){return s(i(a))}}function KB(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),u=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++u<i;)r[u]=J5(t[u],t[u+1]),s[u]=n(e[u],e[u+1]);return function(a){var y=NE(t,a,1,i)-1;return s[y](r[y](a))}}function mT(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function JB(){var t=J_,e=J_,n=W6,i,r,s,u=Fh,a,y,w;function M(){var L=Math.min(t.length,e.length);return u!==Fh&&(u=QB(t[0],t[L-1])),a=L>2?KB:YB,y=w=null,R}function R(L){return L==null||isNaN(L=+L)?s:(y||(y=a(t.map(i),e,n)))(i(u(L)))}return R.invert=function(L){return u(r((w||(w=a(e,t.map(i),ca)))(L)))},R.domain=function(L){return arguments.length?(t=Array.from(L,XB),M()):t.slice()},R.range=function(L){return arguments.length?(e=Array.from(L),M()):e.slice()},R.rangeRound=function(L){return e=Array.from(L),n=gz,M()},R.clamp=function(L){return arguments.length?(u=L?!0:Fh,M()):u!==Fh},R.interpolate=function(L){return arguments.length?(n=L,M()):n},R.unknown=function(L){return arguments.length?(s=L,R):s},function(L,U){return i=L,r=U,M()}}function gT(){return JB()(Fh,Fh)}function eO(t,e,n,i){var r=H5(t,e,n),s;switch(i=Ip(i??",f"),i.type){case"s":{var u=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(s=$B(r,u))&&(i.precision=s),pT(i,u)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=qB(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=WB(r))&&(i.precision=s-(i.type==="%")*2);break}}return dT(i)}function _T(t){var e=t.domain;return t.ticks=function(n){var i=e();return lD(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return eO(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,s=i.length-1,u=i[r],a=i[s],y,w,M=10;for(a<u&&(w=u,u=a,a=w,w=r,r=s,s=w);M-- >0;){if(w=j5(u,a,n),w===y)return i[r]=u,i[s]=a,e(i);if(w>0)u=Math.floor(u/w)*w,a=Math.ceil(a/w)*w;else if(w<0)u=Math.ceil(u*w)/w,a=Math.floor(a*w)/w;else break;y=w}return t},t}function oc(){var t=gT();return t.copy=function(){return mT(t,oc())},Y6.apply(t,arguments),_T(t)}function tO(t,e){t=t.slice();var n=0,i=t.length-1,r=t[n],s=t[i],u;return s<r&&(u=n,n=i,i=u,u=r,r=s,s=u),t[n]=e.floor(r),t[i]=e.ceil(s),t}function il(){var t=0,e=1,n=1,i=[.5],r=[0,1],s;function u(y){return y!=null&&y<=y?r[NE(i,y,0,n)]:s}function a(){var y=-1;for(i=new Array(n);++y<n;)i[y]=((y+1)*e-(y-n)*t)/(n+1);return u}return u.domain=function(y){return arguments.length?([t,e]=y,t=+t,e=+e,a()):[t,e]},u.range=function(y){return arguments.length?(n=(r=Array.from(y)).length-1,a()):r.slice()},u.invertExtent=function(y){var w=r.indexOf(y);return w<0?[NaN,NaN]:w<1?[t,i[0]]:w>=n?[i[n-1],e]:[i[w-1],i[w]]},u.unknown=function(y){return arguments.length&&(s=y),u},u.thresholds=function(){return i.slice()},u.copy=function(){return il().domain([t,e]).range(r).unknown(s)},Y6.apply(_T(u),arguments)}const e4=new Date,t4=new Date;function xr(t,e,n,i){function r(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(t(s=new Date(+s)),s),r.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),r.round=s=>{const u=r(s),a=r.ceil(s);return s-u<a-s?u:a},r.offset=(s,u)=>(e(s=new Date(+s),u==null?1:Math.floor(u)),s),r.range=(s,u,a)=>{const y=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<u)||!(a>0))return y;let w;do y.push(w=new Date(+s)),e(s,a),t(s);while(w<s&&s<u);return y},r.filter=s=>xr(u=>{if(u>=u)for(;t(u),!s(u);)u.setTime(u-1)},(u,a)=>{if(u>=u)if(a<0)for(;++a<=0;)for(;e(u,-1),!s(u););else for(;--a>=0;)for(;e(u,1),!s(u););}),n&&(r.count=(s,u)=>(e4.setTime(+s),t4.setTime(+u),t(e4),t(t4),Math.floor(n(e4,t4))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?u=>i(u)%s===0:u=>r.count(0,u)%s===0):r)),r}const kp=xr(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);kp.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?xr(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):kp);kp.range;const Hl=1e3,No=Hl*60,Wl=No*60,n0=Wl*24,K6=n0*7,ey=n0*30,n4=n0*365,Nh=xr(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Hl)},(t,e)=>(e-t)/Hl,t=>t.getUTCSeconds());Nh.range;const J6=xr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Hl)},(t,e)=>{t.setTime(+t+e*No)},(t,e)=>(e-t)/No,t=>t.getMinutes());J6.range;const nO=xr(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*No)},(t,e)=>(e-t)/No,t=>t.getUTCMinutes());nO.range;const e8=xr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Hl-t.getMinutes()*No)},(t,e)=>{t.setTime(+t+e*Wl)},(t,e)=>(e-t)/Wl,t=>t.getHours());e8.range;const iO=xr(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Wl)},(t,e)=>(e-t)/Wl,t=>t.getUTCHours());iO.range;const V2=xr(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*No)/n0,t=>t.getDate()-1);V2.range;const t8=xr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/n0,t=>t.getUTCDate()-1);t8.range;const rO=xr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/n0,t=>Math.floor(t/n0));rO.range;function xu(t){return xr(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*No)/K6)}const E3=xu(0),Lp=xu(1),sO=xu(2),oO=xu(3),m1=xu(4),aO=xu(5),lO=xu(6);E3.range;Lp.range;sO.range;oO.range;m1.range;aO.range;lO.range;function wu(t){return xr(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/K6)}const yT=wu(0),Dp=wu(1),cO=wu(2),uO=wu(3),g1=wu(4),hO=wu(5),fO=wu(6);yT.range;Dp.range;cO.range;uO.range;g1.range;hO.range;fO.range;const n8=xr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());n8.range;const AO=xr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());AO.range;const i0=xr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());i0.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xr(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});i0.range;const hu=xr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());hu.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xr(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});hu.range;function dO(t,e,n,i,r,s){const u=[[Nh,1,Hl],[Nh,5,5*Hl],[Nh,15,15*Hl],[Nh,30,30*Hl],[s,1,No],[s,5,5*No],[s,15,15*No],[s,30,30*No],[r,1,Wl],[r,3,3*Wl],[r,6,6*Wl],[r,12,12*Wl],[i,1,n0],[i,2,2*n0],[n,1,K6],[e,1,ey],[e,3,3*ey],[t,1,n4]];function a(w,M,R){const L=M<w;L&&([w,M]=[M,w]);const U=R&&typeof R.range=="function"?R:y(w,M,R),q=U?U.range(w,+M+1):[];return L?q.reverse():q}function y(w,M,R){const L=Math.abs(M-w)/R,U=F6(([,,pe])=>pe).right(u,L);if(U===u.length)return t.every(H5(w/n4,M/n4,R));if(U===0)return kp.every(Math.max(H5(w,M,R),1));const[q,te]=u[L/u[U-1][2]<u[U][2]/L?U-1:U];return q.every(te)}return[a,y]}const[pO,mO]=dO(i0,n8,E3,V2,e8,J6);function i4(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function r4(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function gf(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function gO(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,s=t.days,u=t.shortDays,a=t.months,y=t.shortMonths,w=_f(r),M=yf(r),R=_f(s),L=yf(s),U=_f(u),q=yf(u),te=_f(a),pe=yf(a),ne=_f(y),ie=yf(y),re={a:Zn,A:yt,b:Ot,B:Jt,c:null,d:oy,e:oy,f:UO,g:QO,G:KO,H:OO,I:FO,j:NO,L:vT,m:VO,M:GO,p:In,q:Tn,Q:cy,s:uy,S:jO,u:HO,U:WO,V:$O,w:qO,W:ZO,x:null,X:null,y:XO,Y:YO,Z:JO,"%":ly},_e={a:Di,A:di,b:ii,B:hi,c:null,d:ay,e:ay,f:iF,g:AF,G:pF,H:eF,I:tF,j:nF,L:wT,m:rF,M:sF,p:On,q:vi,Q:cy,s:uy,S:oF,u:aF,U:lF,V:cF,w:uF,W:hF,x:null,X:null,y:fF,Y:dF,Z:mF,"%":ly},Te={a:st,A:lt,b:Lt,B:ht,c:Tt,d:ry,e:ry,f:DO,g:iy,G:ny,H:sy,I:sy,j:MO,L:LO,m:PO,M:IO,p:ut,q:CO,Q:zO,s:BO,S:kO,u:wO,U:bO,V:EO,w:xO,W:TO,x:Pn,X:Ft,y:iy,Y:ny,Z:SO,"%":RO};re.x=De(n,re),re.X=De(i,re),re.c=De(e,re),_e.x=De(n,_e),_e.X=De(i,_e),_e.c=De(e,_e);function De(mt,Yt){return function(mn){var dt=[],Fn=-1,Rn=0,ri=mt.length,Qn,si,hr;for(mn instanceof Date||(mn=new Date(+mn));++Fn<ri;)mt.charCodeAt(Fn)===37&&(dt.push(mt.slice(Rn,Fn)),(si=ty[Qn=mt.charAt(++Fn)])!=null?Qn=mt.charAt(++Fn):si=Qn==="e"?" ":"0",(hr=Yt[Qn])&&(Qn=hr(mn,si)),dt.push(Qn),Rn=Fn+1);return dt.push(mt.slice(Rn,Fn)),dt.join("")}}function $e(mt,Yt){return function(mn){var dt=gf(1900,void 0,1),Fn=nt(dt,mt,mn+="",0),Rn,ri;if(Fn!=mn.length)return null;if("Q"in dt)return new Date(dt.Q);if("s"in dt)return new Date(dt.s*1e3+("L"in dt?dt.L:0));if(Yt&&!("Z"in dt)&&(dt.Z=0),"p"in dt&&(dt.H=dt.H%12+dt.p*12),dt.m===void 0&&(dt.m="q"in dt?dt.q:0),"V"in dt){if(dt.V<1||dt.V>53)return null;"w"in dt||(dt.w=1),"Z"in dt?(Rn=r4(gf(dt.y,0,1)),ri=Rn.getUTCDay(),Rn=ri>4||ri===0?Dp.ceil(Rn):Dp(Rn),Rn=t8.offset(Rn,(dt.V-1)*7),dt.y=Rn.getUTCFullYear(),dt.m=Rn.getUTCMonth(),dt.d=Rn.getUTCDate()+(dt.w+6)%7):(Rn=i4(gf(dt.y,0,1)),ri=Rn.getDay(),Rn=ri>4||ri===0?Lp.ceil(Rn):Lp(Rn),Rn=V2.offset(Rn,(dt.V-1)*7),dt.y=Rn.getFullYear(),dt.m=Rn.getMonth(),dt.d=Rn.getDate()+(dt.w+6)%7)}else("W"in dt||"U"in dt)&&("w"in dt||(dt.w="u"in dt?dt.u%7:"W"in dt?1:0),ri="Z"in dt?r4(gf(dt.y,0,1)).getUTCDay():i4(gf(dt.y,0,1)).getDay(),dt.m=0,dt.d="W"in dt?(dt.w+6)%7+dt.W*7-(ri+5)%7:dt.w+dt.U*7-(ri+6)%7);return"Z"in dt?(dt.H+=dt.Z/100|0,dt.M+=dt.Z%100,r4(dt)):i4(dt)}}function nt(mt,Yt,mn,dt){for(var Fn=0,Rn=Yt.length,ri=mn.length,Qn,si;Fn<Rn;){if(dt>=ri)return-1;if(Qn=Yt.charCodeAt(Fn++),Qn===37){if(Qn=Yt.charAt(Fn++),si=Te[Qn in ty?Yt.charAt(Fn++):Qn],!si||(dt=si(mt,mn,dt))<0)return-1}else if(Qn!=mn.charCodeAt(dt++))return-1}return dt}function ut(mt,Yt,mn){var dt=w.exec(Yt.slice(mn));return dt?(mt.p=M.get(dt[0].toLowerCase()),mn+dt[0].length):-1}function st(mt,Yt,mn){var dt=U.exec(Yt.slice(mn));return dt?(mt.w=q.get(dt[0].toLowerCase()),mn+dt[0].length):-1}function lt(mt,Yt,mn){var dt=R.exec(Yt.slice(mn));return dt?(mt.w=L.get(dt[0].toLowerCase()),mn+dt[0].length):-1}function Lt(mt,Yt,mn){var dt=ne.exec(Yt.slice(mn));return dt?(mt.m=ie.get(dt[0].toLowerCase()),mn+dt[0].length):-1}function ht(mt,Yt,mn){var dt=te.exec(Yt.slice(mn));return dt?(mt.m=pe.get(dt[0].toLowerCase()),mn+dt[0].length):-1}function Tt(mt,Yt,mn){return nt(mt,e,Yt,mn)}function Pn(mt,Yt,mn){return nt(mt,n,Yt,mn)}function Ft(mt,Yt,mn){return nt(mt,i,Yt,mn)}function Zn(mt){return u[mt.getDay()]}function yt(mt){return s[mt.getDay()]}function Ot(mt){return y[mt.getMonth()]}function Jt(mt){return a[mt.getMonth()]}function In(mt){return r[+(mt.getHours()>=12)]}function Tn(mt){return 1+~~(mt.getMonth()/3)}function Di(mt){return u[mt.getUTCDay()]}function di(mt){return s[mt.getUTCDay()]}function ii(mt){return y[mt.getUTCMonth()]}function hi(mt){return a[mt.getUTCMonth()]}function On(mt){return r[+(mt.getUTCHours()>=12)]}function vi(mt){return 1+~~(mt.getUTCMonth()/3)}return{format:function(mt){var Yt=De(mt+="",re);return Yt.toString=function(){return mt},Yt},parse:function(mt){var Yt=$e(mt+="",!1);return Yt.toString=function(){return mt},Yt},utcFormat:function(mt){var Yt=De(mt+="",_e);return Yt.toString=function(){return mt},Yt},utcParse:function(mt){var Yt=$e(mt+="",!0);return Yt.toString=function(){return mt},Yt}}}var ty={"-":"",_:" ",0:"0"},kr=/^\s*\d+/,_O=/^%/,yO=/[\\^$*+?|[\]().{}]/g;function ai(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function vO(t){return t.replace(yO,"\\$&")}function _f(t){return new RegExp("^(?:"+t.map(vO).join("|")+")","i")}function yf(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function xO(t,e,n){var i=kr.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function wO(t,e,n){var i=kr.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function bO(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function EO(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function TO(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function ny(t,e,n){var i=kr.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function iy(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function SO(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function CO(t,e,n){var i=kr.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function PO(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function ry(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function MO(t,e,n){var i=kr.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function sy(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function IO(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function kO(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function LO(t,e,n){var i=kr.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function DO(t,e,n){var i=kr.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function RO(t,e,n){var i=_O.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function zO(t,e,n){var i=kr.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function BO(t,e,n){var i=kr.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function oy(t,e){return ai(t.getDate(),e,2)}function OO(t,e){return ai(t.getHours(),e,2)}function FO(t,e){return ai(t.getHours()%12||12,e,2)}function NO(t,e){return ai(1+V2.count(i0(t),t),e,3)}function vT(t,e){return ai(t.getMilliseconds(),e,3)}function UO(t,e){return vT(t,e)+"000"}function VO(t,e){return ai(t.getMonth()+1,e,2)}function GO(t,e){return ai(t.getMinutes(),e,2)}function jO(t,e){return ai(t.getSeconds(),e,2)}function HO(t){var e=t.getDay();return e===0?7:e}function WO(t,e){return ai(E3.count(i0(t)-1,t),e,2)}function xT(t){var e=t.getDay();return e>=4||e===0?m1(t):m1.ceil(t)}function $O(t,e){return t=xT(t),ai(m1.count(i0(t),t)+(i0(t).getDay()===4),e,2)}function qO(t){return t.getDay()}function ZO(t,e){return ai(Lp.count(i0(t)-1,t),e,2)}function XO(t,e){return ai(t.getFullYear()%100,e,2)}function QO(t,e){return t=xT(t),ai(t.getFullYear()%100,e,2)}function YO(t,e){return ai(t.getFullYear()%1e4,e,4)}function KO(t,e){var n=t.getDay();return t=n>=4||n===0?m1(t):m1.ceil(t),ai(t.getFullYear()%1e4,e,4)}function JO(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ai(e/60|0,"0",2)+ai(e%60,"0",2)}function ay(t,e){return ai(t.getUTCDate(),e,2)}function eF(t,e){return ai(t.getUTCHours(),e,2)}function tF(t,e){return ai(t.getUTCHours()%12||12,e,2)}function nF(t,e){return ai(1+t8.count(hu(t),t),e,3)}function wT(t,e){return ai(t.getUTCMilliseconds(),e,3)}function iF(t,e){return wT(t,e)+"000"}function rF(t,e){return ai(t.getUTCMonth()+1,e,2)}function sF(t,e){return ai(t.getUTCMinutes(),e,2)}function oF(t,e){return ai(t.getUTCSeconds(),e,2)}function aF(t){var e=t.getUTCDay();return e===0?7:e}function lF(t,e){return ai(yT.count(hu(t)-1,t),e,2)}function bT(t){var e=t.getUTCDay();return e>=4||e===0?g1(t):g1.ceil(t)}function cF(t,e){return t=bT(t),ai(g1.count(hu(t),t)+(hu(t).getUTCDay()===4),e,2)}function uF(t){return t.getUTCDay()}function hF(t,e){return ai(Dp.count(hu(t)-1,t),e,2)}function fF(t,e){return ai(t.getUTCFullYear()%100,e,2)}function AF(t,e){return t=bT(t),ai(t.getUTCFullYear()%100,e,2)}function dF(t,e){return ai(t.getUTCFullYear()%1e4,e,4)}function pF(t,e){var n=t.getUTCDay();return t=n>=4||n===0?g1(t):g1.ceil(t),ai(t.getUTCFullYear()%1e4,e,4)}function mF(){return"+0000"}function ly(){return"%"}function cy(t){return+t}function uy(t){return Math.floor(+t/1e3)}var dh,ET;gF({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function gF(t){return dh=gO(t),ET=dh.format,dh.parse,dh.utcFormat,dh.utcParse,dh}function _F(t){return new Date(t)}function yF(t){return t instanceof Date?+t:+new Date(+t)}function TT(t,e,n,i,r,s,u,a,y,w){var M=gT(),R=M.invert,L=M.domain,U=w(".%L"),q=w(":%S"),te=w("%I:%M"),pe=w("%I %p"),ne=w("%a %d"),ie=w("%b %d"),re=w("%B"),_e=w("%Y");function Te(De){return(y(De)<De?U:a(De)<De?q:u(De)<De?te:s(De)<De?pe:i(De)<De?r(De)<De?ne:ie:n(De)<De?re:_e)(De)}return M.invert=function(De){return new Date(R(De))},M.domain=function(De){return arguments.length?L(Array.from(De,yF)):L().map(_F)},M.ticks=function(De){var $e=L();return t($e[0],$e[$e.length-1],De??10)},M.tickFormat=function(De,$e){return $e==null?Te:w($e)},M.nice=function(De){var $e=L();return(!De||typeof De.range!="function")&&(De=e($e[0],$e[$e.length-1],De??10)),De?L(tO($e,De)):M},M.copy=function(){return mT(M,TT(t,e,n,i,r,s,u,a,y,w))},M}function vF(){return Y6.apply(TT(pO,mO,i0,n8,E3,V2,e8,J6,Nh,ET).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function T3(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const S3=t=>cz(t[t.length-1]);var xF=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(T3);const wF=S3(xF);var bF=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(T3);const EF=S3(bF);var TF=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(T3);const SF=S3(TF);var CF=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(T3);const ST=S3(CF);function Os(t){return function(){return t}}const hy=Math.abs,es=Math.atan2,Uc=Math.cos,PF=Math.max,s4=Math.min,Va=Math.sin,Uh=Math.sqrt,is=1e-12,b2=Math.PI,Rp=b2/2,MF=2*b2;function IF(t){return t>1?0:t<-1?b2:Math.acos(t)}function fy(t){return t>=1?Rp:t<=-1?-Rp:Math.asin(t)}function CT(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);e=i}return t},()=>new BB(e)}function kF(t){return t.innerRadius}function LF(t){return t.outerRadius}function DF(t){return t.startAngle}function RF(t){return t.endAngle}function zF(t){return t&&t.padAngle}function BF(t,e,n,i,r,s,u,a){var y=n-t,w=i-e,M=u-r,R=a-s,L=R*y-M*w;if(!(L*L<is))return L=(M*(e-s)-R*(t-r))/L,[t+L*y,e+L*w]}function WA(t,e,n,i,r,s,u){var a=t-n,y=e-i,w=(u?s:-s)/Uh(a*a+y*y),M=w*y,R=-w*a,L=t+M,U=e+R,q=n+M,te=i+R,pe=(L+q)/2,ne=(U+te)/2,ie=q-L,re=te-U,_e=ie*ie+re*re,Te=r-s,De=L*te-q*U,$e=(re<0?-1:1)*Uh(PF(0,Te*Te*_e-De*De)),nt=(De*re-ie*$e)/_e,ut=(-De*ie-re*$e)/_e,st=(De*re+ie*$e)/_e,lt=(-De*ie+re*$e)/_e,Lt=nt-pe,ht=ut-ne,Tt=st-pe,Pn=lt-ne;return Lt*Lt+ht*ht>Tt*Tt+Pn*Pn&&(nt=st,ut=lt),{cx:nt,cy:ut,x01:-M,y01:-R,x11:nt*(r/Te-1),y11:ut*(r/Te-1)}}function Ay(){var t=kF,e=LF,n=Os(0),i=null,r=DF,s=RF,u=zF,a=null,y=CT(w);function w(){var M,R,L=+t.apply(this,arguments),U=+e.apply(this,arguments),q=r.apply(this,arguments)-Rp,te=s.apply(this,arguments)-Rp,pe=hy(te-q),ne=te>q;if(a||(a=M=y()),U<L&&(R=U,U=L,L=R),!(U>is))a.moveTo(0,0);else if(pe>MF-is)a.moveTo(U*Uc(q),U*Va(q)),a.arc(0,0,U,q,te,!ne),L>is&&(a.moveTo(L*Uc(te),L*Va(te)),a.arc(0,0,L,te,q,ne));else{var ie=q,re=te,_e=q,Te=te,De=pe,$e=pe,nt=u.apply(this,arguments)/2,ut=nt>is&&(i?+i.apply(this,arguments):Uh(L*L+U*U)),st=s4(hy(U-L)/2,+n.apply(this,arguments)),lt=st,Lt=st,ht,Tt;if(ut>is){var Pn=fy(ut/L*Va(nt)),Ft=fy(ut/U*Va(nt));(De-=Pn*2)>is?(Pn*=ne?1:-1,_e+=Pn,Te-=Pn):(De=0,_e=Te=(q+te)/2),($e-=Ft*2)>is?(Ft*=ne?1:-1,ie+=Ft,re-=Ft):($e=0,ie=re=(q+te)/2)}var Zn=U*Uc(ie),yt=U*Va(ie),Ot=L*Uc(Te),Jt=L*Va(Te);if(st>is){var In=U*Uc(re),Tn=U*Va(re),Di=L*Uc(_e),di=L*Va(_e),ii;if(pe<b2)if(ii=BF(Zn,yt,Di,di,In,Tn,Ot,Jt)){var hi=Zn-ii[0],On=yt-ii[1],vi=In-ii[0],mt=Tn-ii[1],Yt=1/Va(IF((hi*vi+On*mt)/(Uh(hi*hi+On*On)*Uh(vi*vi+mt*mt)))/2),mn=Uh(ii[0]*ii[0]+ii[1]*ii[1]);lt=s4(st,(L-mn)/(Yt-1)),Lt=s4(st,(U-mn)/(Yt+1))}else lt=Lt=0}$e>is?Lt>is?(ht=WA(Di,di,Zn,yt,U,Lt,ne),Tt=WA(In,Tn,Ot,Jt,U,Lt,ne),a.moveTo(ht.cx+ht.x01,ht.cy+ht.y01),Lt<st?a.arc(ht.cx,ht.cy,Lt,es(ht.y01,ht.x01),es(Tt.y01,Tt.x01),!ne):(a.arc(ht.cx,ht.cy,Lt,es(ht.y01,ht.x01),es(ht.y11,ht.x11),!ne),a.arc(0,0,U,es(ht.cy+ht.y11,ht.cx+ht.x11),es(Tt.cy+Tt.y11,Tt.cx+Tt.x11),!ne),a.arc(Tt.cx,Tt.cy,Lt,es(Tt.y11,Tt.x11),es(Tt.y01,Tt.x01),!ne))):(a.moveTo(Zn,yt),a.arc(0,0,U,ie,re,!ne)):a.moveTo(Zn,yt),!(L>is)||!(De>is)?a.lineTo(Ot,Jt):lt>is?(ht=WA(Ot,Jt,In,Tn,L,-lt,ne),Tt=WA(Zn,yt,Di,di,L,-lt,ne),a.lineTo(ht.cx+ht.x01,ht.cy+ht.y01),lt<st?a.arc(ht.cx,ht.cy,lt,es(ht.y01,ht.x01),es(Tt.y01,Tt.x01),!ne):(a.arc(ht.cx,ht.cy,lt,es(ht.y01,ht.x01),es(ht.y11,ht.x11),!ne),a.arc(0,0,L,es(ht.cy+ht.y11,ht.cx+ht.x11),es(Tt.cy+Tt.y11,Tt.cx+Tt.x11),ne),a.arc(Tt.cx,Tt.cy,lt,es(Tt.y11,Tt.x11),es(Tt.y01,Tt.x01),!ne))):a.arc(0,0,L,Te,_e,ne)}if(a.closePath(),M)return a=null,M+""||null}return w.centroid=function(){var M=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,R=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-b2/2;return[Uc(R)*M,Va(R)*M]},w.innerRadius=function(M){return arguments.length?(t=typeof M=="function"?M:Os(+M),w):t},w.outerRadius=function(M){return arguments.length?(e=typeof M=="function"?M:Os(+M),w):e},w.cornerRadius=function(M){return arguments.length?(n=typeof M=="function"?M:Os(+M),w):n},w.padRadius=function(M){return arguments.length?(i=M==null?null:typeof M=="function"?M:Os(+M),w):i},w.startAngle=function(M){return arguments.length?(r=typeof M=="function"?M:Os(+M),w):r},w.endAngle=function(M){return arguments.length?(s=typeof M=="function"?M:Os(+M),w):s},w.padAngle=function(M){return arguments.length?(u=typeof M=="function"?M:Os(+M),w):u},w.context=function(M){return arguments.length?(a=M??null,w):a},w}function OF(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function PT(t){this._context=t}PT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function MT(t){return new PT(t)}function FF(t){return t[0]}function NF(t){return t[1]}function UF(t,e){var n=Os(!0),i=null,r=MT,s=null,u=CT(a);t=typeof t=="function"?t:t===void 0?FF:Os(t),e=typeof e=="function"?e:e===void 0?NF:Os(e);function a(y){var w,M=(y=OF(y)).length,R,L=!1,U;for(i==null&&(s=r(U=u())),w=0;w<=M;++w)!(w<M&&n(R=y[w],w,y))===L&&((L=!L)?s.lineStart():s.lineEnd()),L&&s.point(+t(R,w,y),+e(R,w,y));if(U)return s=null,U+""||null}return a.x=function(y){return arguments.length?(t=typeof y=="function"?y:Os(+y),a):t},a.y=function(y){return arguments.length?(e=typeof y=="function"?y:Os(+y),a):e},a.defined=function(y){return arguments.length?(n=typeof y=="function"?y:Os(!!y),a):n},a.curve=function(y){return arguments.length?(r=y,i!=null&&(s=r(i)),a):r},a.context=function(y){return arguments.length?(y==null?i=s=null:s=r(i=y),a):i},a}var VF=kT(MT);function IT(t){this._curve=t}IT.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function kT(t){function e(n){return new IT(t(n))}return e._curve=t,e}function GF(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(kT(n)):e()._curve},t}function dy(){return GF(UF().curve(VF))}function py(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function i8(t,e){this._context=t,this._k=(1-e)/6}i8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:py(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:py(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(i){return new i8(i,e)}return n.tension=function(i){return t(+i)},n})(0);function jF(t,e,n){var i=t._x1,r=t._y1,s=t._x2,u=t._y2;if(t._l01_a>is){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,y=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/y,r=(r*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/y}if(t._l23_a>is){var w=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,M=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*w+t._x1*t._l23_2a-e*t._l12_2a)/M,u=(u*w+t._y1*t._l23_2a-n*t._l12_2a)/M}t._context.bezierCurveTo(i,r,s,u,t._x2,t._y2)}function LT(t,e){this._context=t,this._alpha=e}LT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:jF(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const my=function t(e){function n(i){return e?new LT(i,e):new i8(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function Of(t,e,n){this.k=t,this.x=e,this.y=n}Of.prototype={constructor:Of,scale:function(t){return t===1?this:new Of(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Of(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Of.prototype;function HF(t){let e,n,i,r,s,u;e=t[0],n=t[1],i=t[2];let a=Math.min(e,n,i),y=Math.max(e,n,i);u=y;let w=y-a;if(y!=0)s=w/y;else return s=0,r=-1,u=0,[r,s,u];return e===y?r=(n-i)/w:n===y?r=2+(i-e)/w:r=4+(e-n)/w,r*=60,r<0&&(r+=360),isNaN(r)&&(r=0),[r,s,u]}function WF(t){let e,n,i,r,s,u,a;if(n=t[0],i=t[1],r=t[2],i===0)return s=u=a=r,[s,u,a];n/=60,e=Math.floor(n);let y=n-e,w=r*(1-i),M=r*(1-i*y),R=r*(1-i*(1-y));switch(e){case 0:s=r,u=R,a=w;break;case 1:s=M,u=r,a=w;break;case 2:s=w,u=r,a=R;break;case 3:s=w,u=M,a=r;break;case 4:s=R,u=w,a=r;break;default:s=r,u=w,a=M;break}return[s,u,a]}function ha({col:t,saturation:e,brightness:n}){e=e||2,n=n||1;const i=HF(t);i[1]*=e;const r=WF(i);return oc().domain([-1,0,1]).range([[0,0,0],r,[255,255,255]]).clamp(!0)((1-Math.exp(-2*(n-1)))/(1+Math.exp(-2*(n-1))))}function $l(t,e,n){let i={};return n||(n=[]),Object.keys(t).forEach(r=>{if(n.includes(r))return;let s=t[r],u={};Object.keys(s).forEach(a=>{e(s[a])&&(u[a]=s[a])}),i[r]=u}),i}const C3=[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]],$F=[[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]]],G2=$l(await(await fetch("./src/assets/combine_hex_5_6_100.json")).json(),t=>t.DemandBaseline);function zp(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const r8=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),gy=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);gy&&parseFloat(gy[1]);const qF="3.4.14";function r0(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Bd=typeof process!="object"||String(process)!=="[object process]"||process.browser,ZF=typeof window<"u"&&typeof window.orientation<"u",_y=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);_y&&parseFloat(_y[1]);function E2(t){"@babel/helpers - typeof";return E2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E2(t)}function XF(t,e){if(E2(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(E2(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QF(t){var e=XF(t,"string");return E2(e)==="symbol"?e:String(e)}function Z(t,e,n){return e=QF(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class YF{constructor(e,n){Z(this,"name",void 0),Z(this,"workerThread",void 0),Z(this,"isRunning",!0),Z(this,"result",void 0),Z(this,"_resolve",()=>{}),Z(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){r0(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){r0(this.isRunning),this.isRunning=!1,this._reject(e)}}let o4=class{terminate(){}};const a4=new Map;function KF(t){r0(t.source&&!t.url||!t.source&&t.url);let e=a4.get(t.source||t.url);return e||(t.url&&(e=JF(t.url),a4.set(t.url,e)),t.source&&(e=DT(t.source),a4.set(t.source,e))),r0(e),e}function JF(t){if(!t.startsWith("http"))return t;const e=eN(t);return DT(e)}function DT(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function eN(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function RT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(yy(t))i.add(t);else if(yy(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const r in t)RT(t[r],e,i)}}return n===void 0?Array.from(i):[]}function yy(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const l4=()=>{};class eg{static isSupported(){return typeof Worker<"u"&&Bd||typeof o4<"u"&&!Bd}constructor(e){Z(this,"name",void 0),Z(this,"source",void 0),Z(this,"url",void 0),Z(this,"terminated",!1),Z(this,"worker",void 0),Z(this,"onMessage",void 0),Z(this,"onError",void 0),Z(this,"_loadableURL","");const{name:n,source:i,url:r}=e;r0(i||r),this.name=n,this.source=i,this.url=r,this.onMessage=l4,this.onError=s=>console.log(s),this.worker=Bd?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=l4,this.onError=l4,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||RT(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=KF({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new o4(i,{eval:!1})}else if(this.source)e=new o4(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class tN{static isSupported(){return eg.isSupported()}constructor(e){Z(this,"name","unnamed"),Z(this,"source",void 0),Z(this,"url",void 0),Z(this,"maxConcurrency",1),Z(this,"maxMobileConcurrency",1),Z(this,"onDebug",()=>{}),Z(this,"reuseWorkers",!0),Z(this,"props",{}),Z(this,"jobQueue",[]),Z(this,"idleQueue",[]),Z(this,"count",0),Z(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,u,a)=>s.done(a),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,u)=>s.error(u);const r=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:i,onStart:s}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const i=new YF(n.name,e);e.onMessage=r=>n.onMessage(i,r.type,r.payload),e.onError=r=>n.onError(i,r),n.onStart(i);try{await i.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new eg({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ZF?this.maxMobileConcurrency:this.maxConcurrency}}const nN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Ul{static isSupported(){return eg.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ul._workerFarm=Ul._workerFarm||new Ul({}),Ul._workerFarm.setProps(e),Ul._workerFarm}constructor(e){Z(this,"props",void 0),Z(this,"workerPools",new Map),this.props={...nN},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:i,url:r}=e;let s=this.workerPools.get(n);return s||(s=new tN({name:n,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}Z(Ul,"_workerFarm",void 0);const iN="latest";function rN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(!r&&t.id==="compression"&&(r=e.workerUrl),e._workerType==="test"&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let s=t.version;s==="latest"&&(s=iN);const u=s?"@".concat(s):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(u,"/dist/").concat(i)}return r0(r),r}function sN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qF;r0(t,"no worker provided");const n=t.version;return!(!e||!n)}function oN(t,e){return!Ul.isSupported()||!Bd&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function aN(t,e,n,i,r){const s=t.id,u=rN(t,n),y=Ul.getWorkerFarm(n).getWorkerPool({name:s,url:u});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const w=await y.startJob("process-on-worker",lN.bind(null,r));return w.postMessage("process",{input:e,options:n,context:i}),await(await w.result).result}async function lN(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:s,options:u}=i;try{const a=await t(s,u);e.postMessage("done",{id:r,result:a})}catch(a){const y=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:y})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function cN(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}function uN(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=i.reduce((a,y)=>a+y.byteLength,0),s=new Uint8Array(r);let u=0;for(const a of i)s.set(a,u),u+=a.byteLength;return s.buffer}async function hN(t){const e=[];for await(const n of t)e.push(n);return uN(...e)}function vy(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let xy=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=vy(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(vy()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},fN=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:i}=e;let r=this.stats[n];return r||(e instanceof xy?r=e:r=new xy(n,i),this.stats[n]=r),r}};const AN="Queued Requests",dN="Active Requests",pN="Cancelled Requests",mN="Queued Requests Ever",gN="Active Requests Ever",_N={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class yN{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Z(this,"props",void 0),Z(this,"stats",void 0),Z(this,"activeRequestCount",0),Z(this,"requestQueue",[]),Z(this,"requestMap",new Map),Z(this,"deferredUpdate",null),this.props={..._N,...e},this.stats=new fN({id:this.props.id}),this.stats.get(AN),this.stats.get(dN),this.stats.get(pN),this.stats.get(mN),this.stats.get(gN)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const i={handle:e,priority:0,getPriority:n},r=new Promise(s=>(i.resolve=s,i));return this.requestQueue.push(i),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:n,resolve:i}=e;let r=!1;const s=()=>{r||(r=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const i=this.requestQueue.shift();i&&this._issueRequest(i)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const i=e[n];this._updateRequest(i)||(e.splice(n,1),this.requestMap.delete(i.handle),n--)}e.sort((n,i)=>n.priority-i.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let vN="";const wy={};function xN(t){for(const e in wy)if(t.startsWith(e)){const n=wy[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(vN).concat(t)),t}function wN(t){return t&&typeof t=="object"&&t.isBuffer}function zT(t){if(wN(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function BT(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function bN(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const EN=t=>typeof t=="boolean",Qf=t=>typeof t=="function",j2=t=>t!==null&&typeof t=="object",by=t=>j2(t)&&t.constructor==={}.constructor,TN=t=>t&&typeof t[Symbol.iterator]=="function",SN=t=>t&&typeof t[Symbol.asyncIterator]=="function",bu=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Eu=t=>typeof Blob<"u"&&t instanceof Blob,CN=t=>t&&typeof t=="object"&&t.isBuffer,PN=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||j2(t)&&Qf(t.tee)&&Qf(t.cancel)&&Qf(t.getReader),MN=t=>j2(t)&&Qf(t.read)&&Qf(t.pipe)&&EN(t.readable),OT=t=>PN(t)||MN(t),IN=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,kN=/^([-\w.]+\/[-\w.+]+)/;function LN(t){const e=kN.exec(t);return e?e[1]:t}function Ey(t){const e=IN.exec(t);return e?e[1]:""}const FT=/\?.*/;function DN(t){const e=t.match(FT);return e&&e[0]}function s8(t){return t.replace(FT,"")}function P3(t){return bu(t)?t.url:Eu(t)?t.name||"":typeof t=="string"?t:""}function o8(t){if(bu(t)){const e=t,n=e.headers.get("content-type")||"",i=s8(e.url);return LN(n)||Ey(i)}return Eu(t)?t.type||"":typeof t=="string"?Ey(t):""}function RN(t){return bu(t)?t.headers["content-length"]||-1:Eu(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function NT(t){if(bu(t))return t;const e={},n=RN(t);n>=0&&(e["content-length"]=String(n));const i=P3(t),r=o8(t);r&&(e["content-type"]=r);const s=await ON(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const u=new Response(t,{headers:e});return Object.defineProperty(u,"url",{value:i}),u}async function zN(t){if(!t.ok){const e=await BN(t);throw new Error(e)}}async function BN(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function ON(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(i=>{const r=new FileReader;r.onload=s=>{var u;return i(s==null||(u=s.target)===null||u===void 0?void 0:u.result)},r.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),i=FN(n);return"data:base64,".concat(i)}return null}function FN(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}async function Ty(t,e){if(typeof t=="string"){t=xN(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await NT(t)}function NN(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function H2(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||NN()}const $A=globalThis.window||globalThis.self||globalThis.global,vf=globalThis.process||{},UT=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";H2();function UN(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let VN=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=UN(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function GN(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function jN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function c4(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Bp;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Bp||(Bp={}));const HN=10;function Sy(t){return typeof t!="string"?t:(t=t.toUpperCase(),Bp[t]||Bp.WHITE)}function WN(t,e,n){if(!H2&&typeof t=="string"){if(e){const i=Sy(e);t="\x1B[".concat(i,"m").concat(t,"\x1B[39m")}if(n){const i=Sy(n);t="\x1B[".concat(i+HN,"m").concat(t,"\x1B[49m")}}return t}function $N(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n),r=t;for(const s of i){const u=r[s];typeof u=="function"&&(e.find(a=>s===a)||(r[s]=u.bind(t)))}}function Op(t,e){if(!t)throw new Error(e||"Assertion failed")}function ph(){let t;if(H2()&&$A.performance){var e,n;t=$A==null||(e=$A.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in vf){var i;const r=vf==null||(i=vf.hrtime)===null||i===void 0?void 0:i.call(vf);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const mh={debug:H2()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},qN={enabled:!0,level:0};function Do(){}const Cy={},Py={once:!0};let a8=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=UT,this._startTs=ph(),this._deltaTs=ph(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new VN("__probe-".concat(this.id,"__"),qN),this.timeStamp("".concat(this.id," started")),$N(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ph()-this._startTs).toPrecision(10))}getDelta(){return Number((ph()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Op(e,n)}warn(e){return this._getLogFunction(0,e,mh.warn,arguments,Py)}error(e){return this._getLogFunction(0,e,mh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,mh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,mh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,mh.debug||mh.info,arguments,Py)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Do,i&&[i],{tag:YN(n)}):Do}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?H2()?QN({image:r,message:s,scale:u}):XN():Do}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Do)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=My({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Do)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=VT(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=My({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,Op(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=ph();const u=s.tag||s.message;if(s.once&&u)if(!Cy[u])Cy[u]=ph();else return Do;return n=ZN(this.id,s.message,s),i.bind(console,n,...s.args)}return Do}};a8.VERSION=UT;function VT(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Op(Number.isFinite(e)&&e>=0),e}function My(t){const{logLevel:e,message:n}=t;t.logLevel=VT(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return Op(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function ZN(t,e,n){if(typeof e=="string"){const i=n.time?jN(GN(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=WN(e,n.color,n.background)}return e}function XN(t){return console.warn("removed"),Do}function QN(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=c4(s,n,i);console.log(...u)},s.src=e,Do}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...c4(e,n,i)),Do;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...c4(s,n,i)),s.src=e.toDataURL(),Do}return Do}function YN(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Iy=new a8({id:"loaders.gl"});class KN{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class JN{constructor(){Z(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.error.bind(this.console,...n)}}const GT={fetch:null,mimeType:void 0,nothrow:!1,log:new JN,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:r8,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},eU={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function jT(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const HT=()=>{const t=jT();return t.globalOptions=t.globalOptions||{...GT},t.globalOptions};function tU(t,e,n,i){return n=n||[],n=Array.isArray(n)?n:[n],nU(t,n),rU(e,t,i)}function nU(t,e){ky(t,null,GT,eU,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};ky(i,n.id,r,s,e)}}function ky(t,e,n,i,r){const s=e||"Top level",u=e?"".concat(e,"."):"";for(const a in t){const y=!e&&j2(t[a]),w=a==="baseUri"&&!e,M=a==="workerUrl"&&e;if(!(a in n)&&!w&&!M){if(a in i)Iy.warn("".concat(s," loader option '").concat(u).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!y){const R=iU(a,r);Iy.warn("".concat(s," loader option '").concat(u).concat(a,"' not recognized. ").concat(R))()}}}}function iU(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(t===s)return"Did you mean '".concat(r.id,".").concat(s,"'?");const u=s.toLowerCase();(n.startsWith(u)||u.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(s,"'?"))}return i}function rU(t,e,n){const r={...t.options||{}};return sU(r,n),r.log===null&&(r.log=new KN),Ly(r,HT()),Ly(r,e),r}function Ly(t,e){for(const n in e)if(n in e){const i=e[n];by(i)&&by(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function sU(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function l8(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function c8(t){var e,n;zp(t,"null loader"),zp(l8(t),"invalid loader");let i;return Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const WT=()=>{const t=jT();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function oU(t){const e=WT();t=Array.isArray(t)?t:[t];for(const n of t){const i=c8(n);e.find(r=>i===r)||e.unshift(i)}}function aU(){return WT()}const lU=new a8({id:"loaders.gl"}),cU=/\.([^.]+)$/;async function uU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!$T(t))return null;let r=Dy(t,e,{...n,nothrow:!0},i);if(r)return r;if(Eu(t)&&(t=await t.slice(0,10).arrayBuffer(),r=Dy(t,e,n,i)),!r&&!(n!=null&&n.nothrow))throw new Error(qT(t));return r}function Dy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!$T(t))return null;if(e&&!Array.isArray(e))return c8(e);let r=[];e&&(r=r.concat(e)),n!=null&&n.ignoreRegisteredLoaders||r.push(...aU()),fU(r);const s=hU(t,r,n,i);if(!s&&!(n!=null&&n.nothrow))throw new Error(qT(t));return s}function hU(t,e,n,i){const r=P3(t),s=o8(t),u=s8(r)||i?.url;let a=null,y="";if(n!=null&&n.mimeType&&(a=u4(e,n?.mimeType),y="match forced by supplied MIME type ".concat(n?.mimeType)),a=a||AU(e,u),y=y||(a?"matched url ".concat(u):""),a=a||u4(e,s),y=y||(a?"matched MIME type ".concat(s):""),a=a||pU(e,t),y=y||(a?"matched initial data ".concat(ZT(t)):""),a=a||u4(e,n?.fallbackMimeType),y=y||(a?"matched fallback MIME type ".concat(s):""),y){var w;lU.log(1,"selectLoader selected ".concat((w=a)===null||w===void 0?void 0:w.name,": ").concat(y,"."))}return a}function $T(t){return!(t instanceof Response&&t.status===204)}function qT(t){const e=P3(t),n=o8(t);let i="No valid loader found (";i+=e?"".concat(BT(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?ZT(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function fU(t){for(const e of t)c8(e)}function AU(t,e){const n=e&&cU.exec(e),i=n&&n[1];return i?dU(t,i):null}function dU(t,e){e=e.toLowerCase();for(const n of t)for(const i of n.extensions)if(i.toLowerCase()===e)return n;return null}function u4(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function pU(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(mU(e,n))return n}else if(ArrayBuffer.isView(e)){if(Ry(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Ry(e,0,n))return n;return null}function mU(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function Ry(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>gU(t,e,n,r))}function gU(t,e,n,i){if(i instanceof ArrayBuffer)return cN(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":const r=tg(t,e,i.length);return i===r;default:return!1}}function ZT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?tg(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?tg(t,0,e):""}function tg(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let s=0;s<n;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}const _U=256*1024;function*yU(t,e){const n=e?.chunkSize||_U;let i=0;const r=new TextEncoder;for(;i<t.length;){const s=Math.min(t.length-i,n),u=t.slice(i,i+s);i+=s,yield r.encode(u)}}const vU=256*1024;function xU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=vU}=e;let i=0;for(;i<t.byteLength;){const r=Math.min(t.byteLength-i,n),s=new ArrayBuffer(r),u=new Uint8Array(t,i,r);new Uint8Array(s).set(u),i+=r,yield s}}()}const wU=1024*1024;async function*bU(t,e){const n=e?.chunkSize||wU;let i=0;for(;i<t.size;){const r=i+n,s=await t.slice(i,r).arrayBuffer();i=r,yield s}}function zy(t,e){return r8?EU(t,e):TU(t)}async function*EU(t,e){const n=t.getReader();let i;try{for(;;){const r=i||n.read();e!=null&&e._streamReadAhead&&(i=n.read());const{done:s,value:u}=await r;if(s)return;yield zT(u)}}catch{n.releaseLock()}}async function*TU(t,e){for await(const n of t)yield zT(n)}function SU(t,e){if(typeof t=="string")return yU(t,e);if(t instanceof ArrayBuffer)return xU(t,e);if(Eu(t))return bU(t,e);if(OT(t))return zy(t,e);if(bu(t))return zy(t.body,e);throw new Error("makeIterator")}const XT="Cannot convert supplied data type";function CU(t,e,n){if(e.text&&typeof t=="string")return t;if(CN(t)&&(t=t.buffer),t instanceof ArrayBuffer){const i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer;const r=t.byteLength||t.length;return(t.byteOffset!==0||r!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+r)),i}throw new Error(XT)}async function PU(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||i)return CU(t,e);if(Eu(t)&&(t=await NT(t)),bu(t)){const r=t;return await zN(r),e.binary?await r.arrayBuffer():await r.text()}if(OT(t)&&(t=SU(t,n)),TN(t)||SN(t))return hN(t);throw new Error(XT)}function QT(t,e){const n=HT(),i=t||n;return typeof i.fetch=="function"?i.fetch:j2(i.fetch)?r=>Ty(r,i):e!=null&&e.fetch?e?.fetch:Ty}function MU(t,e,n){if(n)return n;const i={fetch:QT(e,t),...t};if(i.url){const r=s8(i.url);i.baseUrl=r,i.queryString=DN(i.url),i.filename=BT(r),i.baseUrl=bN(r)}return Array.isArray(i.loaders)||(i.loaders=null),i}function IU(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...i]:i}return n&&n.length?n:null}async function u8(t,e,n,i){r0(!i||typeof i=="object"),e&&!Array.isArray(e)&&!l8(e)&&(i=void 0,n=e,e=void 0),t=await t,n=n||{};const r=P3(t),u=IU(e,i),a=await uU(t,u,n);return a?(n=tU(n,a,u,r),i=MU({url:r,parse:u8,loaders:u},n,i||null),await kU(a,t,n,i)):null}async function kU(t,e,n,i){if(sN(t),bu(e)){const r=e,{ok:s,redirected:u,status:a,statusText:y,type:w,url:M}=r,R=Object.fromEntries(r.headers.entries());i.response={headers:R,ok:s,redirected:u,status:a,statusText:y,type:w,url:M}}if(e=await PU(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,i,t);if(oN(t,n))return await aN(t,e,n,i,u8);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw r0(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Fp(t,e,n,i){!Array.isArray(e)&&!l8(e)&&(n=e,e=void 0);const r=QT(n);let s=t;return typeof t=="string"&&(s=await r(t)),Eu(t)&&(s=await r(t)),await u8(s,e,n)}const LU="3.4.14",{_parseImageNode:DU}=globalThis,ng=typeof Image<"u",ig=typeof ImageBitmap<"u",RU=!!DU,rg=r8?!0:RU;function zU(t){switch(t){case"auto":return ig||ng||rg;case"imagebitmap":return ig;case"image":return ng;case"data":return rg;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function BU(){if(ig)return"imagebitmap";if(ng)return"image";if(rg)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function OU(t){const e=NU(t);if(!e)throw new Error("Not an image");return e}function FU(t){switch(OU(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function NU(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const UU=/^data:image\/svg\+xml/,VU=/\.svg((\?|#).*)?$/;function h8(t){return t&&(UU.test(t)||VU.test(t))}function GU(t,e){if(h8(e)){let i=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return YT(t,e)}function YT(t,e){if(h8(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function KT(t,e,n){const i=GU(t,n),r=self.URL||self.webkitURL,s=typeof i!="string"&&r.createObjectURL(i);try{return await jU(s||i,e)}finally{s&&r.revokeObjectURL(s)}}async function jU(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=s=>r(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){r(s)}})}const HU={};let By=!0;async function WU(t,e,n){let i;h8(n)?i=await KT(t,e,n):i=YT(t,n);const r=e&&e.imagebitmap;return await $U(i,r)}async function $U(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((qU(e)||!By)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),By=!1}return await createImageBitmap(t)}function qU(t){for(const e in t||HU)return!1;return!0}function ZU(t){return!KU(t,"ftyp",4)||!(t[8]&96)?null:XU(t)}function XU(t){switch(QU(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function QU(t,e,n){return String.fromCharCode(...t.slice(e,n))}function YU(t){return[...t].map(e=>e.charCodeAt(0))}function KU(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=YU(e);for(let r=0;r<i.length;++r)if(i[r]!==t[r+n])return!1;return!0}const Xa=!1,Yf=!0;function JT(t){const e=W2(t);return eV(e)||iV(e)||tV(e)||nV(e)||JU(e)}function JU(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=ZU(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function eV(t){const e=W2(t);return e.byteLength>=24&&e.getUint32(0,Xa)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Xa),height:e.getUint32(20,Xa)}:null}function tV(t){const e=W2(t);return e.byteLength>=10&&e.getUint32(0,Xa)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Yf),height:e.getUint16(8,Yf)}:null}function nV(t){const e=W2(t);return e.byteLength>=14&&e.getUint16(0,Xa)===16973&&e.getUint32(2,Yf)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Yf),height:e.getUint32(22,Yf)}:null}function iV(t){const e=W2(t);if(!(e.byteLength>=3&&e.getUint16(0,Xa)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:r}=rV();let s=2;for(;s+9<e.byteLength;){const u=e.getUint16(s,Xa);if(r.has(u))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Xa),width:e.getUint16(s+7,Xa)};if(!i.has(u))return null;s+=2,s+=e.getUint16(s,Xa)}return null}function rV(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function W2(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function sV(t,e){const{mimeType:n}=JT(t)||{},i=globalThis._parseImageNode;return zp(i),await i(t,n)}async function oV(t,e,n){e=e||{};const r=(e.image||{}).type||"auto",{url:s}=n||{},u=aV(r);let a;switch(u){case"imagebitmap":a=await WU(t,e,s);break;case"image":a=await KT(t,e,s);break;case"data":a=await sV(t);break;default:zp(!1)}return r==="data"&&(a=FU(a)),a}function aV(t){switch(t){case"auto":case"data":return BU();default:return zU(t),t}}const lV=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],cV=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],uV={image:{type:"auto",decode:!0}},hV={id:"image",module:"images",name:"Images",version:LU,mimeTypes:cV,extensions:lV,parse:oV,tests:[t=>!!JT(new DataView(t))],options:uV};function eS(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function R1(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||eS()}const Od={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},qA=Od.window||Od.self||Od.global,xf=Od.process||{},tS=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";R1();const h4=globalThis;function fV(t){if(!t&&!R1())return"Node";if(eS(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":h4.chrome?"Chrome":h4.safari?"Safari":h4.mozInnerScreenX?"Firefox":"Unknown"}function AV(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let dV=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Z(this,"storage",void 0),Z(this,"id",void 0),Z(this,"config",void 0),this.storage=AV(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function pV(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function mV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function f4(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Np;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Np||(Np={}));function Oy(t){return typeof t=="string"?Np[t.toUpperCase()]||Np.WHITE:t}function gV(t,e,n){return!R1&&typeof t=="string"&&(e&&(e=Oy(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=Oy(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function _V(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(s=>r===s)||(t[r]=t[r].bind(t)))}function Up(t,e){if(!t)throw new Error(e||"Assertion failed")}function gh(){let t;if(R1&&"performance"in qA){var e,n;t=qA==null||(e=qA.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in xf){var i;const r=xf==null||(i=xf.hrtime)===null||i===void 0?void 0:i.call(xf);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const _h={debug:R1&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},yV={enabled:!0,level:0};function Ro(){}const Fy={},Ny={once:!0};let nS=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};Z(this,"id",void 0),Z(this,"VERSION",tS),Z(this,"_startTs",gh()),Z(this,"_deltaTs",gh()),Z(this,"_storage",void 0),Z(this,"userData",{}),Z(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new dV("__probe-".concat(this.id,"__"),yV),this.timeStamp("".concat(this.id," started")),_V(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((gh()-this._startTs).toPrecision(10))}getDelta(){return Number((gh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Up(e,n)}warn(e){return this._getLogFunction(0,e,_h.warn,arguments,Ny)}error(e){return this._getLogFunction(0,e,_h.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,_h.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,_h.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,n,_h.debug||_h.info,arguments,Ny)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Ro,i&&[i],{tag:bV(n)}):Ro}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?R1?wV({image:r,message:s,scale:u}):xV():Ro}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ro)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=Uy({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ro)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=iS(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=Uy({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,Up(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=gh();const u=s.tag||s.message;if(s.once)if(!Fy[u])Fy[u]=gh();else return Ro;return n=vV(this.id,s.message,s),i.bind(console,n,...s.args)}return Ro}};Z(nS,"VERSION",tS);function iS(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Up(Number.isFinite(e)&&e>=0),e}function Uy(t){const{logLevel:e,message:n}=t;t.logLevel=iS(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return Up(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function vV(t,e,n){if(typeof e=="string"){const i=n.time?mV(pV(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=gV(e,n.color,n.background)}return e}function xV(t){return console.warn("removed"),Ro}function wV(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=f4(s,n,i);console.log(...u)},s.src=e,Ro}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...f4(e,n,i)),Ro;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...f4(s,n,i)),s.src=e.toDataURL(),Ro}return Ro}function bV(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Hn=new nS({id:"deck"});let sg={};function EV(t){sg=t}function rs(t,e,n,i){Hn.level>0&&sg[t]&&sg[t].call(null,e,n,i)}function TV(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const SV={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:TV,parseTextSync:JSON.parse};function CV(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Hn.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Hn,_registerLoggers:EV},oU([SV,[hV,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const PV=CV(),$n={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty($n,"IDENTITY",{get:()=>(Hn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const fa={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},fu={common:0,meters:1,pixels:2},Vy={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function MV(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function z1(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||MV()}const Fd={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},ZA=Fd.window||Fd.self||Fd.global,wf=Fd.process||{},rS=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";z1();function IV(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class kV{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Z(this,"storage",void 0),Z(this,"id",void 0),Z(this,"config",void 0),this.storage=IV(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function LV(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function DV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function A4(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Vp;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Vp||(Vp={}));function Gy(t){return typeof t=="string"?Vp[t.toUpperCase()]||Vp.WHITE:t}function RV(t,e,n){return!z1&&typeof t=="string"&&(e&&(e=Gy(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=Gy(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function zV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(s=>r===s)||(t[r]=t[r].bind(t)))}function Gp(t,e){if(!t)throw new Error(e||"Assertion failed")}function yh(){let t;if(z1&&"performance"in ZA){var e,n;t=ZA==null||(e=ZA.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in wf){var i;const r=wf==null||(i=wf.hrtime)===null||i===void 0?void 0:i.call(wf);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const vh={debug:z1&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},BV={enabled:!0,level:0};function zo(){}const jy={},Hy={once:!0};class sS{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};Z(this,"id",void 0),Z(this,"VERSION",rS),Z(this,"_startTs",yh()),Z(this,"_deltaTs",yh()),Z(this,"_storage",void 0),Z(this,"userData",{}),Z(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new kV("__probe-".concat(this.id,"__"),BV),this.timeStamp("".concat(this.id," started")),zV(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((yh()-this._startTs).toPrecision(10))}getDelta(){return Number((yh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Gp(e,n)}warn(e){return this._getLogFunction(0,e,vh.warn,arguments,Hy)}error(e){return this._getLogFunction(0,e,vh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,vh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,vh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,n,vh.debug||vh.info,arguments,Hy)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||zo,i&&[i],{tag:UV(n)}):zo}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?z1?NV({image:r,message:s,scale:u}):FV():zo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||zo)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=Wy({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||zo)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=oS(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=Wy({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,Gp(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=yh();const u=s.tag||s.message;if(s.once)if(!jy[u])jy[u]=yh();else return zo;return n=OV(this.id,s.message,s),i.bind(console,n,...s.args)}return zo}}Z(sS,"VERSION",rS);function oS(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Gp(Number.isFinite(e)&&e>=0),e}function Wy(t){const{logLevel:e,message:n}=t;t.logLevel=oS(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return Gp(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function OV(t,e,n){if(typeof e=="string"){const i=n.time?DV(LV(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=RV(e,n.color,n.background)}return e}function FV(t){return console.warn("removed"),zo}function NV(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=A4(s,n,i);console.log(...u)},s.src=e,zo}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...A4(e,n,i)),zo;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...A4(s,n,i)),s.src=e.toDataURL(),zo}return zo}function UV(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const an=new sS({id:"luma.gl"});function bs(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const VV="Invalid WebGLRenderingContext",GV="Requires WebGL2";function M3(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function qn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function jV(t){return qn(t)?t:null}function I3(t){return bs(M3(t),VV),t}function ls(t){return bs(qn(t),GV),t}const Ff={};function HV(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function WV(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function $V(t,e){Ff[t]=!0,e!==void 0&&HV(e)}function qV(t){const e=t.getError;t.getError=function(){let i;do i=e.apply(t),i!==0&&(Ff[i]=!0);while(i!==0);for(i in Ff)if(Ff[i])return delete Ff[i],parseInt(i,10);return 0}}const $2=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};$2.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};$2.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Tu=function(e){const n=this;this.gl=e,qV(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const u=n.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,s);const a=u.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const u=n.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,s);const a=u.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,u){switch(s){case 34962:n.currentArrayBuffer=u;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=u;break}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,u){const y=n.currentVertexArrayObject.attribs[s];switch(u){case 34975:return y.buffer;case 34338:return y.enabled;case 34339:return y.size;case 34340:return y.stride;case 34341:return y.type;case 34922:return y.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,u,a,y,w,M){const R=n.currentVertexArrayObject;R.maxAttrib=Math.max(R.maxAttrib,s);const L=R.attribs[s];return L.buffer=n.currentArrayBuffer,L.size=u,L.type=a,L.normalized=y,L.stride=w,L.offset=M,L.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{WV("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Tu.prototype.VERTEX_ARRAY_BINDING_OES=34229;Tu.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new $2(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Tu.prototype.createVertexArrayOES=function(){const e=new $2(this);return this.vertexArrayObjects.push(e),e};Tu.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Tu.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof $2&&e.hasBeenBound&&e.ext===this)};Tu.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){$V(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(n,34963,s.elementArrayBuffer);let u=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let y=0;y<=a;y++){const w=s.attribs[y],M=r?r.attribs[y]:null;if((!r||w.enabled!==M.enabled)&&(w.enabled?i.enableVertexAttribArray.call(n,y):i.disableVertexAttribArray.call(n,y)),w.enabled){let R=!1;(!r||w.buffer!==M.buffer)&&(u!==w.buffer&&(i.bindBuffer.call(n,34962,w.buffer),u=w.buffer),R=!0),(R||w.cached!==M.cached)&&i.vertexAttribPointer.call(n,y,w.size,w.type,w.normalized,w.stride,w.offset)}}this.currentArrayBuffer!==u&&i.bindBuffer.call(n,34962,this.currentArrayBuffer)};function ZV(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const n=t.getExtension;t.getExtension=function(r){const s=n.call(this,r);return s||(r!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Tu(this)),this.__OESVertexArrayObject))}}const $y="OES_element_index",qy="WEBGL_draw_buffers",XV="EXT_disjoint_timer_query",QV="EXT_disjoint_timer_query_webgl2",YV="EXT_texture_filter_anisotropic",Zy="WEBGL_debug_renderer_info",KV=35723,JV=4352,eG=36795,tG=34047,nG=37445,iG=37446,Ti=t=>qn(t)?void 0:0,rG={3074:t=>qn(t)?void 0:36064,[KV]:t=>qn(t)?void 0:JV,35977:Ti,32937:Ti,[eG]:(t,e)=>{const n=qn(t)?t.getExtension(QV):t.getExtension(XV);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[nG]:(t,e)=>{const n=t.getExtension(Zy);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[iG]:(t,e)=>{const n=t.getExtension(Zy);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[tG]:(t,e)=>{const n=t.luma.extensions[YV];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Ti,35071:Ti,37447:Ti,36063:(t,e)=>{if(!qn(t)){const n=t.getExtension(qy);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Ti,35374:Ti,35377:Ti,34852:t=>{if(!qn(t)){const e=t.getExtension(qy);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension($y)?2147483647:65535,33001:t=>t.getExtension($y)?16777216:65535,33e3:t=>16777216,37157:Ti,35373:Ti,35657:Ti,36183:Ti,37137:Ti,34045:Ti,35978:Ti,35979:Ti,35968:Ti,35376:Ti,35375:Ti,35659:Ti,37154:Ti,35371:Ti,35658:Ti,35076:Ti,35077:Ti,35380:Ti};function sG(t,e,n){const i=rG[n],r=typeof i=="function"?i(t,e,n):i;return r!==void 0?r:e(n)}const oG="OES_vertex_array_object",aS="ANGLE_instanced_arrays",aG="WEBGL_draw_buffers",lG="EXT_disjoint_timer_query",cG="EXT_texture_filter_anisotropic",uG="VertexArray requires WebGL2 or OES_vertex_array_object extension";function hG(t,e){return{webgl2:qn(t),ext:t.getExtension(e)}}const lS={[oG]:{meta:{suffix:"OES"},createVertexArray:()=>{bs(!1,uG)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[aS]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){bs(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[aG]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{bs(!1)}},[lG]:{meta:{suffix:"EXT"},createQuery:()=>{bs(!1)},deleteQuery:()=>{bs(!1)},beginQuery:()=>{bs(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},d4={readBuffer:(t,e,n)=>{qn(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:s}=hG(t,aS);let u;switch(i){case 35069:u=r?void 0:!1;break;case 35070:u=!r&&!s?0:void 0;break}return u!==void 0?u:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!qn(t))switch(i){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>{if(!qn(t))switch(r){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,i,r)},getTexParameter(t,e,n,i){switch(i){case 34046:const{extensions:r}=t.luma,s=r[cG];i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,i)},getParameter:sG,hint(t,e,n,i){return e(n,i)}};function fG(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(ZV(t),AG(t),pG(t,lS),dG(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=fG;function AG(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function dG(t,e){let{target:n,target2:i}=e;Object.keys(d4).forEach(r=>{if(typeof d4[r]=="function"){const s=t[r]?t[r].bind(t):()=>{},u=d4[r].bind(null,t,s);n[r]=u,i[r]=u}})}function pG(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&mG(t,{extension:n,target:t.luma,target2:t})}function mG(t,e){let{extension:n,target:i,target2:r}=e;const s=lS[n];bs(s);const{meta:u={}}=s,{suffix:a=""}=u,y=t.getExtension(n);for(const w of Object.keys(s)){const M="".concat(w).concat(a);let R=null;w==="meta"||typeof t[w]=="function"||(y&&typeof y[M]=="function"?R=function(){return y[M](...arguments)}:typeof s[w]=="function"&&(R=s[w].bind(i))),R&&(i[w]=R,r[w]=R)}}const f8={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},L0=(t,e,n)=>e?t.enable(n):t.disable(n),Xy=(t,e,n)=>t.hint(n,e),so=(t,e,n)=>t.pixelStorei(n,e),gG=(t,e)=>{const n=qn(t)?36009:36160;return t.bindFramebuffer(n,e)},_G=(t,e)=>t.bindFramebuffer(36008,e);function bf(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const yG={3042:L0,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:L0,2885:(t,e)=>t.cullFace(e),2929:L0,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:L0,35723:Xy,36006:gG,2886:(t,e)=>t.frontFace(e),33170:Xy,2849:(t,e)=>t.lineWidth(e),32823:L0,32824:"polygonOffset",10752:"polygonOffset",35977:L0,32938:"sampleCoverage",32939:"sampleCoverage",3089:L0,3088:(t,e)=>t.scissor(...e),2960:L0,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:so,3317:so,37440:so,37441:so,37443:so,3330:so,3332:so,3331:so,36010:_G,3314:so,32878:so,3316:so,3315:so,32877:so,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=bf(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=bf(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=bf(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=bf(e)&&e.length===3?[...e,...e]:e;const[n,i,r,s,u,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,s,u,a)},stencilOp:(t,e)=>{e=bf(e)&&e.length===3?[...e,...e]:e;const[n,i,r,s,u,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,s,u,a)},viewport:(t,e)=>t.viewport(...e)};function Xi(t,e,n){return e[t]!==void 0?e[t]:n[t]}const vG={blendEquation:(t,e,n)=>t.blendEquationSeparate(Xi(32777,e,n),Xi(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Xi(32969,e,n),Xi(32968,e,n),Xi(32971,e,n),Xi(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Xi(32824,e,n),Xi(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Xi(32938,e,n),Xi(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Xi(2962,e,n),Xi(2967,e,n),Xi(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Xi(34816,e,n),Xi(36003,e,n),Xi(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Xi(2964,e,n),Xi(2965,e,n),Xi(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Xi(34817,e,n),Xi(34818,e,n),Xi(34819,e,n))},Qy={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:i,[e===1028?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:i,[e===1028?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Ga=(t,e)=>t.isEnabled(e),Yy={3042:Ga,2884:Ga,2929:Ga,3024:Ga,32823:Ga,32926:Ga,32928:Ga,3089:Ga,2960:Ga,35977:Ga};function cS(t){for(const e in t)return!1;return!0}function xG(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function Ky(t,e){const n=t[e].bind(t);t[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in t.state.cache?t.state.enable?t.state.cache[r]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function wG(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var s=arguments.length,u=new Array(s),a=0;a<s;a++)u[a]=arguments[a];const{valueChanged:y,oldValue:w}=n(t.state._updateCache,...u);return y&&i(...u),w},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function bG(t){const e=t.useProgram.bind(t);t.useProgram=function(i){t.state.program!==i&&(e(i),t.state.program=i)}}class EG{constructor(e){let{copyState:n=!1,log:i=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?SG(e):Object.assign({},f8),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){bs(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];s0(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,i;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){bs(s!==void 0);const u=e[s],a=this.cache[s];xG(u,a)||(n=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=u)}return{valueChanged:n,oldValue:i}}}function uS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(bs(i!==void 0),!t.state){const{polyfillContext:r}=globalThis;r&&r(t),t.state=new EG(t,{copyState:i}),bG(t);for(const s in Qy){const u=Qy[s];wG(t,s,u)}Ky(t,"getParameter"),Ky(t,"isEnabled")}return t.state.enable=n,t}function TG(t){t.state||uS(t,{copyState:!1}),t.state.push()}function Jy(t){bs(t.state),t.state.pop()}function s0(t,e){if(bs(M3(t),"setParameters requires a WebGL context"),cS(e))return;const n={};for(const r in e){const s=Number(r),u=yG[r];u&&(typeof u=="string"?n[u]=!0:u(t,e[r],s))}const i=t.state&&t.state.cache;if(i)for(const r in n){const s=vG[r];s(t,e,i)}}function SG(t,e){if(e=e||f8,typeof e=="number"){const r=e,s=Yy[r];return s?s(t,r):t.getParameter(r)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const s=Yy[r];i[r]=s?s(t,Number(r)):t.getParameter(Number(r))}return i}function CG(t){s0(t,f8)}function ga(t,e,n){if(cS(e))return n(t);const{nocatch:i=!0}=e;TG(t),s0(t,e);let r;if(i)r=n(t),Jy(t);else try{r=n(t)}finally{Jy(t)}return r}function _1(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function p4(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=_1(t),r=t.drawingBufferWidth,s=t.drawingBufferHeight;return MG(e,i,r,s,n)}function PG(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function MG(t,e,n,i,r){const s=ev(t[0],e,n);let u=tv(t[1],e,i,r),a=ev(t[0]+1,e,n);const y=a===n-1?a:a-1;a=tv(t[1]+1,e,i,r);let w;return r?(a=a===0?a:a+1,w=u,u=a):w=a===i-1?a:a-1,{x:s,y:u,width:Math.max(y-s+1,1),height:Math.max(w-u+1,1)}}function ev(t,e,n){return Math.min(Math.round(t*e),n-1)}function tv(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const A8=z1(),IG=A8&&typeof document<"u",hS={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function fS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bs(A8,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},hS,t);const{width:e,height:n}=t;function i(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=i;let r;const{canvas:s}=t,u=RG({canvas:s,width:e,height:n,onError:i});return r=DG(u,t),r?(r=d8(r,t),zG(r),r):null}function d8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||BG(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},hS,e);const{manageState:n,debug:i}=e;return n&&uS(t,{copyState:!1,log:function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];return an.log(1,...s)()}}),A8&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),an.level=Math.max(an.level,1)):an.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function kG(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info"),r=i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),s=i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function LG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const i=PG(e.useDevicePixels);OG(t,i,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function DG(t,e){const{onError:n}=e;let i=null;const r=y=>i=y.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:u=!0}=e;let a=null;return u&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(u&&!s?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function RG(t){let{canvas:e,width:n=800,height:i=600,onError:r}=t,s;return typeof e=="string"?(IG&&document.readyState==="complete"||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function zG(t){const e=qn(t)?"WebGL2":"WebGL1",n=kG(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";an.info(1,"".concat(e).concat(r," context ").concat(i))()}function BG(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function OG(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;(!i||!r)&&(an.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let u=e;const a=Math.floor(i*u),y=Math.floor(r*u);t.canvas.width=a,t.canvas.height=y,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==y)&&(an.warn("Device pixel ratio clamped")(),u=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*u),t.canvas.height=Math.floor(r*u)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}function nv(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let iv=class{constructor(e,n){Z(this,"name",void 0),Z(this,"type",void 0),Z(this,"sampleSize",1),Z(this,"time",void 0),Z(this,"count",void 0),Z(this,"samples",void 0),Z(this,"lastTiming",void 0),Z(this,"lastSampleTime",void 0),Z(this,"lastSampleCount",void 0),Z(this,"_count",0),Z(this,"_time",0),Z(this,"_samples",0),Z(this,"_startTime",0),Z(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=nv(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(nv()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},FG=class{constructor(e){Z(this,"id",void 0),Z(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof iv?this.stats[n]=e:this.stats[n]=new iv(n,i)),this.stats[n]}};function AS(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function dS(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||AS()}const m4=globalThis;function NG(t){if(!t&&!dS())return"Node";if(AS(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":m4.chrome?"Chrome":m4.safari?"Safari":m4.mozInnerScreenX?"Firefox":"Unknown"}const Kf="8.5.21",UG="set luma.log.level=1 (or higher) to trace rendering";class VG{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new FG({id:e})),this.stats.get(e)}}const Kc=new VG;if(globalThis.luma&&globalThis.luma.VERSION!==Kf)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Kf));globalThis.luma||(dS()&&an.log(1,"luma.gl ".concat(Kf," - ").concat(UG))(),globalThis.luma=globalThis.luma||{VERSION:Kf,version:Kf,log:an,stats:Kc,globals:{modules:{},nodeIO:{}}});function GG(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function jG(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function jt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function g4(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const i=t[e];return jt(i!==void 0,"Accessing undefined constant GL.".concat(e)),i}function tc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const _4={};function ac(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";_4[t]=_4[t]||1;const e=_4[t]++;return"".concat(t,"-").concat(e)}function rv(t){return jt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function y1(t){let e=!0;for(const n in t){e=!1;break}return e}function pS(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);i.forEach(u=>{s.methodName||(s[u]=()=>{throw an.removed("Calling removed method ".concat(e,".").concat(u,": "),r)(),new Error(u)})})}const xh="Resource subclass must define virtual methods";let u0=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};I3(e);const{id:i,userData:r={}}=n;this.gl=e,this.gl2=e,this.id=i||ac(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(i=>i.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=g4(this.gl,e),jt(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=qn(this.gl);if(!((!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const a=r.webgl1,y="webgl2"in r?r.webgl2:r.webgl1;return s?y:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:i}=e,r=this.constructor.PARAMETERS||{},s=qn(this.gl),u={},a=n||Object.keys(r);for(const y of a){const w=r[y];if(w&&(!("webgl2"in w)||s)&&(!("extension"in w)||this.gl.getExtension(w.extension))){const R=i?tc(this.gl,y):y;u[R]=this.getParameter(y,e),i&&w.type==="GLenum"&&(u[R]=tc(this.gl,u[R]))}}return u}setParameter(e,n){e=g4(this.gl,e),jt(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=qn(this.gl);if(!((!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");r.type==="GLenum"&&(n=g4(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,i){return pS(this,e,n,i)}initialize(e){}_createHandle(){throw new Error(xh)}_deleteHandle(){throw new Error(xh)}_bindHandle(e){throw new Error(xh)}_getOptsFromHandle(){throw new Error(xh)}_getParameter(e,n){throw new Error(xh)}_setParameter(e,n){throw new Error(xh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Kc.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Kc.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const r=Kc.get("Memory Usage".concat(i));r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=Kc.get("Memory Usage".concat(n));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const HG="Failed to deduce GL constant from typed array";function og(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(HG)}}function T2(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function WG(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:s}=t;const u=n*r;s=s||new Uint8Array(u);for(let a=0;a<i/2;++a){const y=a*u,w=(i-a-1)*u;s.set(e.subarray(y,y+u)),e.copyWithin(y,w,w+u),e.set(s,w)}}function $G(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),s=Math.round(i/2),u=new Uint8Array(r*s*4);for(let a=0;a<s;a++)for(let y=0;y<r;y++)for(let w=0;w<4;w++)u[(a*r+y)*4+w]=e[(a*2*n+y*2)*4+w];return{data:u,width:r,height:s}}function ag(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=n;for(const a in i)if(a in e){const w=i[a]?"".concat(t,".").concat(i[a]):"N/A";an.removed("".concat(t,".").concat(a),w)()}for(const a in r)if(a in e){const y=r[a];an.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(y))()}let u=null;for(const a in s)if(a in e){const y=s[a];an.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(y))(),u=u||Object.assign({},e),u[y]=e[a],delete u[a]}return u||e}const qG={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},ZG={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class co{static getBytesPerElement(e){return T2(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return jt(e.size),T2(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new co(qG,...n)}constructor(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return co.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return co.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=ag("Accessor",e,ZG),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const sv=10,mS={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},XG={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:mS},QG={removedProps:mS};class gi extends u0{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/co.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/co.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=ag("Buffer",e,XG),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=ag("Buffer",e,QG),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new co(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;jt(n);const u=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(u,this.handle),r!==0||s!==void 0?(ls(this.gl),this.gl.bufferSubData(this.target,i,n,r,s)):this.gl.bufferSubData(u,i,n),this.gl.bindBuffer(u,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:i=0,writeOffset:r=0,size:s}=e;const{gl:u}=this;return ls(u),u.bindBuffer(36662,n.handle),u.bindBuffer(36663,this.handle),u.copyBufferSubData(36662,36663,i,r,s),u.bindBuffer(36662,null),u.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:i=0,length:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ls(this.gl);const s=T2(this.accessor.type||5126,{clamped:!1}),u=this._getAvailableElementCount(n),a=i;let y,w;e?(w=e.length,y=w-a):(y=Math.min(u,r||u),w=a+y);const M=Math.min(u,y);return r=r||M,jt(r<=M),e=e||new s(w),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?r!==void 0?this.gl.bindBufferRange(e,n,this.handle,i,r):(jt(i===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(sv,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;jt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,n,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,sv),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=og(e);return jt(s),this.setAccessor(new co(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;jt(e>=0),this._trackDeallocatedMemory();let i=e;e===0&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,n),this.gl.bindBuffer(r,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=T2(this.accessor.type||5126,{clamped:!1}),i=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new co(this.accessor,{type:og(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return an.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return an.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return an.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return an.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new co(this.accessor,e),this}}const p8={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},gS={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},_S={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function YG(t,e){const n=p8[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const i=qn(t)&&n.gl2||n.gl1;return typeof i=="string"?t.getExtension(i):i}function KG(t,e){const n=p8[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const JG=[9729,9728],ov=globalThis.WebGLBuffer||function(){};class Au extends u0{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:i,linearFiltering:r}=n;let s=!0;return i&&(s=s&&YG(e,i),s=s&&(!r||KG(e,i))),s}constructor(e,n){const{id:i=ac("texture"),handle:r,target:s}=n;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(ie=>this.initialize(Object.assign({},e,{pixels:ie,data:ie}))),this;const i=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(i&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:u=0,recreate:a=!1,parameters:y={},pixelStore:w={},textureUnit:M=void 0}=e;n||(n=r);let{width:R,height:L,dataFormat:U,type:q,compressed:te=!1,mipmaps:pe=!0}=e;const{depth:ne=0}=e;return{width:R,height:L,compressed:te,dataFormat:U,type:q}=this._deduceParameters({format:s,type:q,dataFormat:U,compressed:te,data:n,width:R,height:L}),this.width=R,this.height=L,this.depth=ne,this.format=s,this.type=q,this.dataFormat=U,this.border=u,this.textureUnit=M,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),pe&&this._isNPOT()&&(an.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),pe=!1,this._updateForNPOT(y)),this.mipmaps=pe,this.setImageData({data:n,width:R,height:L,depth:ne,format:s,type:q,dataFormat:U,border:u,mipmaps:pe,parameters:w,compressed:te}),pe&&this.generateMipmap(),this.setParameters(y),a&&(this.data=n),i&&(this._video={video:n,parameters:y,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:i,mipmaps:r=!1}=e;return i!==this.width||n!==this.height?this.initialize({width:i,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(an.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ga(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:i=null,level:r=0,format:s=this.format,border:u=this.border,offset:a=0,parameters:y={}}=e;let{data:w=null,type:M=this.type,width:R=this.width,height:L=this.height,dataFormat:U=this.dataFormat,compressed:q=!1}=e;w||(w=i),{type:M,dataFormat:U,compressed:q,width:R,height:L}=this._deduceParameters({format:s,type:M,dataFormat:U,compressed:q,data:w,width:R,height:L});const{gl:te}=this;te.bindTexture(this.target,this.handle);let pe=null;({data:w,dataType:pe}=this._getDataType({data:w,compressed:q}));let ne,ie=0;if(ga(this.gl,y,()=>{switch(pe){case"null":te.texImage2D(n,r,s,R,L,u,U,M,w);break;case"typed-array":te.texImage2D(n,r,s,R,L,u,U,M,w,a);break;case"buffer":ne=ls(te),ne.bindBuffer(35052,w.handle||w),ne.texImage2D(n,r,s,R,L,u,U,M,a),ne.bindBuffer(35052,null);break;case"browser-object":qn(te)?te.texImage2D(n,r,s,R,L,u,U,M,w):te.texImage2D(n,r,s,U,M,w);break;case"compressed":for(const[re,_e]of w.entries())te.compressedTexImage2D(n,re,_e.format,_e.width,_e.height,u,_e.data),ie+=_e.levelSize;break;default:jt(!1,"Unknown image data type")}}),pe==="compressed")this._trackAllocatedMemory(ie,"Texture");else if(w&&w.byteLength)this._trackAllocatedMemory(w.byteLength,"Texture");else{const re=gS[this.dataFormat]||4,_e=_S[this.type]||1;this._trackAllocatedMemory(this.width*this.height*re*_e,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:i=null,data:r=null,x:s=0,y:u=0,width:a=this.width,height:y=this.height,level:w=0,format:M=this.format,type:R=this.type,dataFormat:L=this.dataFormat,compressed:U=!1,offset:q=0,border:te=this.border,parameters:pe={}}=e;if({type:R,dataFormat:L,compressed:U,width:a,height:y}=this._deduceParameters({format:M,type:R,dataFormat:L,compressed:U,data:r,width:a,height:y}),jt(this.depth===0,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const ne=r;r=ne.data,a=ne.shape[0],y=ne.shape[1]}r instanceof gi&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),ga(this.gl,pe,()=>{if(U)this.gl.compressedTexSubImage2D(n,w,s,u,a,y,M,r);else if(r===null)this.gl.texSubImage2D(n,w,s,u,a,y,L,R,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(n,w,s,u,a,y,L,R,r,q);else if(r instanceof ov){const ne=ls(this.gl);ne.bindBuffer(35052,r),ne.texSubImage2D(n,w,s,u,a,y,L,R,q),ne.bindBuffer(35052,null)}else qn(this.gl)?ls(this.gl).texSubImage2D(n,w,s,u,a,y,L,R,r):this.gl.texSubImage2D(n,w,s,u,L,R,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return an.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:i=!1}=e;return i?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof gi?{data:n.handle,dataType:"buffer"}:n instanceof ov?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:i}=e;let{width:r,height:s,dataFormat:u,type:a,compressed:y}=e;const w=p8[n];return u=u||w&&w.dataFormat,a=a||w&&w.types[0],y=y||w&&w.compressed,{width:r,height:s}=this._deduceImageSize(i,r,s),{dataFormat:u,type:a,compressed:y,width:r,height:s,format:n,data:i}}_deduceImageSize(e,n,i){let r;return typeof ImageData<"u"&&e instanceof ImageData?r={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?r={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?r={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?r={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?r={width:e.videoWidth,height:e.videoHeight}:e?r={width:n,height:i}:r={width:n>=0?n:1,height:i>=0?i:1},jt(r,"Could not deduced texture size"),jt(n===void 0||r.width===n,"Deduced texture width does not match supplied width"),jt(i===void 0||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:jt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return qn(this.gl)||!this.width||!this.height?!1:!rv(this.width)||!rv(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:JG.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let ej="";function tj(t,e){return jt(typeof t=="string"),t=ej+t,new Promise((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error("Could not load image ".concat(t,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=t}catch(r){i(r)}})}class $s extends Au{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Au.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};I3(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:tj(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const lg=[34069,34070,34071,34072,34073,34074];class yS extends Au{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};I3(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:i={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(i)}),this}subImage(e){let{face:n,data:i,x:r=0,y:s=0,mipmapLevel:u=0}=e;return this._subImage({target:n,data:i,x:r,y:s,mipmapLevel:u})}async setCubeMapImageData(e){let{width:n,height:i,pixels:r,data:s,border:u=0,format:a=6408,type:y=5121}=e;const{gl:w}=this,M=r||s,R=await Promise.all(lg.map(L=>{const U=M[L];return Promise.all(Array.isArray(U)?U:[U])}));this.bind(),lg.forEach((L,U)=>{R[U].length>1&&this.opts.mipmaps!==!1&&an.warn("".concat(this.id," has mipmap and multiple LODs."))(),R[U].forEach((q,te)=>{n&&i?w.texImage2D(L,te,a,n,i,u,a,y,q):w.texImage2D(L,te,a,a,y,q)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:i,height:r,pixels:s,data:u,border:a=0,format:y=6408,type:w=5121}=e,{gl:M}=this,R=s||u;return this.bind(),R instanceof Promise?R.then(L=>this.setImageDataForFace(Object.assign({},e,{face:n,data:L,pixels:L}))):this.width||this.height?M.texImage2D(n,0,y,i,r,a,y,w,R):M.texImage2D(n,0,y,y,w,R),this}}yS.FACES=lg;class nj extends Au{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return qn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ls(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:i=6408,width:r,height:s,depth:u=1,border:a=0,format:y,type:w=5121,offset:M=0,data:R,parameters:L={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),ga(this.gl,L,()=>{ArrayBuffer.isView(R)&&this.gl.texImage3D(this.target,n,i,r,s,u,a,y,w,R),R instanceof gi&&(this.gl.bindBuffer(35052,R.handle),this.gl.texImage3D(this.target,n,i,r,s,u,a,y,w,M))}),R&&R.byteLength)this._trackAllocatedMemory(R.byteLength,"Texture");else{const U=gS[this.dataFormat]||4,q=_S[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*U*q,"Texture")}return this.loaded=!0,this}}const Vc="EXT_color_buffer_float",av={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Vc,bpp:2},33327:{gl2:Vc,bpp:4},34842:{gl2:Vc,bpp:8},33326:{gl2:Vc,bpp:4},33328:{gl2:Vc,bpp:8},34836:{gl2:Vc,bpp:16},35898:{gl2:Vc,bpp:4}};function ij(t,e,n){const i=n[e];if(!i)return!1;const r=qn(t)&&i.gl2||i.gl1;return typeof r=="string"?t.getExtension(r):r}class Vh extends u0{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||ij(e,n,av)}static getSamplesForFormat(e,n){let{format:i}=n;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:i=1,height:r=1,samples:s=0}=e;return jt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&qn(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,i,r):this.gl.renderbufferStorage(36161,n,i,r),this.format=n,this.width=i,this.height=r,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*av[this.format].bpp),this}resize(e){let{width:n,height:i}=e;return n!==this.width||i!==this.height?this.initialize({width:n,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const rj=256,sj=1024,oj=16384,lv=6144,cv=6145,uv=6146,hv=34041,vS="clear: bad arguments";function m8(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let u=0;n&&(u|=oj,n!==!0&&(s.clearColor=n)),i&&(u|=rj,i!==!0&&(s.clearDepth=i)),r&&(u|=sj,i!==!0&&(s.clearStencil=i)),jt(u!==0,vS),ga(t,s,()=>{t.clear(u)})}function aj(t){let{framebuffer:e=null,buffer:n=lv,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ls(t),ga(t,{framebuffer:e},()=>{switch(n){case lv:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case cv:t.clearBufferfv(cv,0,[r]);break;case uv:t.clearBufferiv(uv,0,[r]);break;case hv:const[s,u]=r;t.clearBufferfi(hv,0,s,u);break;default:jt(!1,vS)}})}function lj(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return jt(!1),0}}function k3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:u=null,sourceWidth:a,sourceHeight:y,sourceType:w}=e;const{framebuffer:M,deleteFramebuffer:R}=xS(t);jt(M);const{gl:L,handle:U,attachments:q}=M;a=a||M.width,y=y||M.height,s===36064&&U===null&&(s=1028),jt(q[s]),w=w||q[s].type,u=uj(u,w,r,a,y),w=w||og(u);const te=L.bindFramebuffer(36160,U);return L.readPixels(n,i,a,y,r,w,u),L.bindFramebuffer(36160,te||null),R&&M.delete(),u}function fv(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=k3(t,{sourceAttachment:e}),{width:r,height:s}=t;for(;s>n;)({data:i,width:r,height:s}=$G({data:i,width:r,height:s}));WG({data:i,width:r,height:s});const u=document.createElement("canvas");u.width=r,u.height=s;const a=u.getContext("2d"),y=a.createImageData(r,s);return y.data.set(i),a.putImageData(y,0,0),u.toDataURL()}function cj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:u=6408}=n;let{targetX:a,targetY:y,targetZ:w,width:M,height:R}=n;const{framebuffer:L,deleteFramebuffer:U}=xS(t);jt(L);const{gl:q,handle:te}=L,pe=typeof a<"u"||typeof y<"u"||typeof w<"u";a=a||0,y=y||0,w=w||0;const ne=q.bindFramebuffer(36160,te);jt(e);let ie=null;if(e instanceof Au&&(ie=e,M=Number.isFinite(M)?M:ie.width,R=Number.isFinite(R)?R:ie.height,ie.bind(0),e=ie.target),!pe)q.copyTexImage2D(e,s,u,i,r,M,R,0);else switch(e){case 3553:case 34067:q.copyTexSubImage2D(e,s,a,y,i,r,M,R);break;case 35866:case 32879:ls(q).copyTexSubImage3D(e,s,a,y,w,i,r,M,R);break}return ie&&ie.unbind(),q.bindFramebuffer(36160,ne||null),U&&L.delete(),ie}function xS(t){return t instanceof vr?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:yj(t),deleteFramebuffer:!0}}function uj(t,e,n,i,r){if(t)return t;e=e||5121;const s=T2(e,{clamped:!1}),u=lj(n);return new s(i*r*u)}const Si={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function hj(t){const e=new $s(t,{format:6408,type:5126,dataFormat:6408}),n=new vr(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),i===36053}const wS={[Si.WEBGL2]:[!1,!0],[Si.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Si.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Si.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Si.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Si.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Si.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Si.FLOAT_BLEND]:["EXT_float_blend"],[Si.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Si.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Si.TEXTURE_FLOAT]:["OES_texture_float",!0],[Si.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Si.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Si.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Si.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Si.COLOR_ATTACHMENT_RGBA32F]:[hj,"EXT_color_buffer_float"],[Si.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Si.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Si.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Si.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Si.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Si.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},fj=2;function bS(t,e){return g8(t,e)}function g8(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>ES(t,n))}function Aj(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in wS)t.luma.caps[e]===void 0&&(t.luma.caps[e]=ES(t,e));return t.luma.caps}function ES(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=dj(t,e)),t.luma.caps[e]||an.log(fj,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function dj(t,e){const n=wS[e];jt(n,e);let i;const r=qn(t)&&n[1]||n[0];if(typeof r=="function")i=r(t);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&!!t.getExtension(s)}else typeof r=="string"?i=!!t.getExtension(r):typeof r=="boolean"?i=r:jt(!1);return i}const Av="Multiple render targets not supported";class vr extends u0{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=n;let s=!0;return i&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new vr(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=ls(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=ls(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:i=1,attachments:r=null,color:s=!0,depth:u=!0,stencil:a=!1,check:y=!0,readBuffer:w=void 0,drawBuffers:M=void 0}=e;if(jt(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,r)for(const R in r){const L=r[R];(Array.isArray(L)?L[0]:L).resize({width:n,height:i})}else r=this._createDefaultAttachments(s,u,a,n,i);this.update({clearAttachments:!0,attachments:r,readBuffer:w,drawBuffers:M}),r&&y&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:i,drawBuffers:r,clearAttachments:s=!1,resizeAttachments:u=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:u});const{gl:a}=this,y=a.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),a.bindFramebuffer(36160,y||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:i}=e;if(this.handle===null)return jt(n===void 0&&i===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),i===void 0&&(i=this.gl.drawingBufferHeight),n!==this.width&&i!==this.height&&an.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:n,height:i});return this.width=n,this.height=i,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:i=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={};n&&Object.keys(this.attachments).forEach(u=>{r[u]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const u in r){jt(u!==void 0,"Misspelled framebuffer binding point?");const a=Number(u),y=r[a];let w=y;if(!w)this._unattach(a);else if(w instanceof Vh)this._attachRenderbuffer({attachment:a,renderbuffer:w});else if(Array.isArray(y)){const[M,R=0,L=0]=y;w=M,this._attachTexture({attachment:a,texture:M,layer:R,level:L})}else this._attachTexture({attachment:a,texture:w,layer:0,level:0});i&&w&&w.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(u=>!this.attachments[u]).forEach(u=>{delete this.attachments[u]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(mj(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),i}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:i,stencil:r,drawBuffers:s=[]}=e,u=this.gl.bindFramebuffer(36160,this.handle);return(n||i||r)&&m8(this.gl,{color:n,depth:i,stencil:r}),s.forEach((a,y)=>{aj(this.gl,{drawBuffer:y,value:a})}),this.gl.bindFramebuffer(36160,u||null),this}readPixels(){return an.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return an.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return an.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return an.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return an.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return an.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:i=0,y:r=0,width:s,height:u}=e;const a=ls(this.gl),y=a.bindFramebuffer(36008,this.handle);return i===0&&r===0&&s===void 0&&u===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,i,r,s,u),a.bindFramebuffer(36008,y),this}getAttachmentParameter(e,n,i){let r=this._getAttachmentParameterFallback(n);return r===null&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=tc(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const s of i){const u=n?tc(this.gl,s):s;r[u]=this.getAttachmentParameter(e,s,n)}return r}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),i={};for(const r of n){const s=Number(r),u=e?tc(this.gl,s):s;i[u]=this.getAttachmentParameters(s,e)}return i}show(){return typeof window<"u"&&window.open(fv(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>an.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const i=fv(this,{targetMaxHeight:100});return an.image({logLevel:e,message:n,image:i},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,i,r,s){let u=null;return e&&(u=u||{},u[36064]=new $s(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(u[36064])),n&&i?(u=u||{},u[33306]=new Vh(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(u[33306])):n?(u=u||{},u[36096]=new Vh(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:s}),this.ownResources.push(u[36096])):i&&jt(!1),u}_unattach(e){const n=this.attachments[e];n&&(n instanceof Vh?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,n,36161,i.handle),this.attachments[n]=i}_attachTexture(e){let{attachment:n=36064,texture:i,layer:r,level:s}=e;const{gl:u}=this;switch(u.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:ls(u).framebufferTextureLayer(36160,n,i.target,s,r);break;case 34067:const y=pj(r);u.framebufferTexture2D(36160,n,y,i.handle,s);break;case 3553:u.framebufferTexture2D(36160,n,3553,i.handle,s);break;default:jt(!1,"Illegal texture type")}u.bindTexture(i.target,null),this.attachments[n]=i}_setReadBuffer(e){const n=jV(this.gl);n?n.readBuffer(e):jt(e===36064||e===1029,Av),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,i=ls(n);if(i)i.drawBuffers(e);else{const r=n.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):jt(e.length===1&&(e[0]===36064||e[0]===1029),Av)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=Aj(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function pj(t){return t<34069?t+34069:t}function mj(t){return(vr.STATUS||{})[t]||"Framebuffer error ".concat(t)}const gj=[36049,36048,33296,33298,33299,33300,33301,33302,33303];vr.ATTACHMENT_PARAMETERS=gj;function _j(t,e){jt(t instanceof $s||t instanceof yS||t instanceof nj);const n=t.constructor,{gl:i,width:r,height:s,format:u,type:a,dataFormat:y,border:w,mipmaps:M}=t,R=Object.assign({width:r,height:s,format:u,type:a,dataFormat:y,border:w,mipmaps:M},e);return new n(i,R)}function yj(t,e){const{gl:n,width:i,height:r,id:s}=t;return new vr(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:i,height:r,attachments:{36064:t}}))}function Nd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}const vj=35632,xj=35633;function wj(t){switch(t){case vj:return"fragment";case xj:return"vertex";default:return"unknown type"}}function bj(t,e,n,i){const r=t.split(/\r?\n/),s={},u={},a=i||Nd(e)||"(unnamed)",y="".concat(wj(n)," shader ").concat(a);for(let M=0;M<r.length;M++){const R=r[M];if(R.length<=1)continue;const L=R.split(":"),U=L[0],q=parseInt(L[2],10);if(isNaN(q))throw new Error("GLSL compilation error in ".concat(y,": ").concat(t));U!=="WARNING"?s[q]=R:u[q]=R}const w=Ej(e);return{shaderName:y,errors:dv(s,w),warnings:dv(u,w)}}function dv(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if(!(!t[i+3]&&!t[i+2]&&!t[i+1])&&(n+="".concat(r,`
`),t[i+1])){const s=t[i+1],u=s.split(":",3),a=u[0],y=parseInt(u[1],10)||0,w=s.substring(u.join(":").length+1).trim();n+=TS("^^^ ".concat(a,": ").concat(w,`

`),y)}}return n}function Ej(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,u)=>{const a=String(u+e),y=a.length;return TS(a,r-y)+n+s})}function TS(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}function SS(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const i=parseInt(n[1],10);Number.isFinite(i)&&(e=i)}return e}const Tj="Shader: GLSL source code must be a JavaScript string";class S2 extends u0{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return jt(!1),"unknown"}}constructor(e,n){I3(e),jt(typeof n.source=="string",Tj);const i=Nd(n.source,null)||n.id||ac("unnamed ".concat(S2.getTypeName(n.shaderType)));super(e,{id:i}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const i=Nd(n,null);i&&(this.id=ac(i)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(S2.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Nd(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:u}=bj(i,this.source,this.shaderType,this.id);throw an.error("GLSL compilation errors in ".concat(r,`
`).concat(s))(),an.warn("GLSL compilation warnings in ".concat(r,`
`).concat(u))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class y4 extends S2{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class v4 extends S2{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Sj={5126:Ii.bind(null,"uniform1fv",oo,1,ts),35664:Ii.bind(null,"uniform2fv",oo,2,ts),35665:Ii.bind(null,"uniform3fv",oo,3,ts),35666:Ii.bind(null,"uniform4fv",oo,4,ts),5124:Ii.bind(null,"uniform1iv",D0,1,ts),35667:Ii.bind(null,"uniform2iv",D0,2,ts),35668:Ii.bind(null,"uniform3iv",D0,3,ts),35669:Ii.bind(null,"uniform4iv",D0,4,ts),35670:Ii.bind(null,"uniform1iv",D0,1,ts),35671:Ii.bind(null,"uniform2iv",D0,2,ts),35672:Ii.bind(null,"uniform3iv",D0,3,ts),35673:Ii.bind(null,"uniform4iv",D0,4,ts),35674:Ii.bind(null,"uniformMatrix2fv",oo,4,Bl),35675:Ii.bind(null,"uniformMatrix3fv",oo,9,Bl),35676:Ii.bind(null,"uniformMatrix4fv",oo,16,Bl),35678:Nr,35680:Nr,5125:Ii.bind(null,"uniform1uiv",XA,1,ts),36294:Ii.bind(null,"uniform2uiv",XA,2,ts),36295:Ii.bind(null,"uniform3uiv",XA,3,ts),36296:Ii.bind(null,"uniform4uiv",XA,4,ts),35685:Ii.bind(null,"uniformMatrix2x3fv",oo,6,Bl),35686:Ii.bind(null,"uniformMatrix2x4fv",oo,8,Bl),35687:Ii.bind(null,"uniformMatrix3x2fv",oo,6,Bl),35688:Ii.bind(null,"uniformMatrix3x4fv",oo,12,Bl),35689:Ii.bind(null,"uniformMatrix4x2fv",oo,8,Bl),35690:Ii.bind(null,"uniformMatrix4x3fv",oo,12,Bl),35678:Nr,35680:Nr,35679:Nr,35682:Nr,36289:Nr,36292:Nr,36293:Nr,36298:Nr,36299:Nr,36300:Nr,36303:Nr,36306:Nr,36307:Nr,36308:Nr,36311:Nr},Cj={},Pj={},Mj={},pv=[0];function _8(t,e,n,i){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(pv[0]=t,t=pv);const r=t.length;if(r%e&&an.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=i[r];s||(s=new n(r),i[r]=s);for(let u=0;u<r;u++)s[u]=t[u];return s}function oo(t,e){return _8(t,e,Float32Array,Cj)}function D0(t,e){return _8(t,e,Int32Array,Pj)}function XA(t,e){return _8(t,e,Uint32Array,Mj)}function mv(t,e,n){const i=Sj[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function Ij(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function kj(t,e,n){for(const i in t){const r=t[i];if((!n||!!n[i])&&!Lj(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}return!0}function Lj(t){return Array.isArray(t)||ArrayBuffer.isView(t)?Rj(t):isFinite(t)||t===!0||t===!1||t instanceof Au||t instanceof Vh?!0:t instanceof vr?!!t.texture:!1}function Dj(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let r=0,s=n.length;r<s;++r)i[r]=n[r]}else t[e]=n.slice();else t[e]=n}function Rj(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Nr(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function Ii(t,e,n,i){let r=null,s=null;return(u,a,y)=>{const w=e(y,n),M=w.length;let R=!1;if(r===null)r=new Float32Array(M),s=M,R=!0;else{jt(s===M,"Uniform length cannot change.");for(let L=0;L<M;++L)if(w[L]!==r[L]){R=!0;break}}return R&&(i(u,t,a,w),r.set(w)),R}}function ts(t,e,n,i){t[e](n,i)}function Bl(t,e,n,i){t[e](n,!1,i)}const zj=5120,Bj=5121,Oj=5122,Fj=5123,gv=0,QA=1,Nj=2,Uj=3,YA=4,Vj=5,Gj=6,gr=5126,jj=35664,Hj=35665,Wj=35666,Ef=5124,$j=35667,qj=35668,Zj=35669,Tf=5125,Xj=36294,Qj=36295,Yj=36296,Kj=35670,Jj=35671,eH=35672,tH=35673,nH=35674,iH=35675,rH=35676,sH=35685,oH=35686,aH=35687,lH=35688,cH=35689,uH=35690,cg={[gr]:[gr,1,"float"],[jj]:[gr,2,"vec2"],[Hj]:[gr,3,"vec3"],[Wj]:[gr,4,"vec4"],[Ef]:[Ef,1,"int"],[$j]:[Ef,2,"ivec2"],[qj]:[Ef,3,"ivec3"],[Zj]:[Ef,4,"ivec4"],[Tf]:[Tf,1,"uint"],[Xj]:[Tf,2,"uvec2"],[Qj]:[Tf,3,"uvec3"],[Yj]:[Tf,4,"uvec4"],[Kj]:[gr,1,"bool"],[Jj]:[gr,2,"bvec2"],[eH]:[gr,3,"bvec3"],[tH]:[gr,4,"bvec4"],[nH]:[gr,8,"mat2"],[sH]:[gr,8,"mat2x3"],[oH]:[gr,8,"mat2x4"],[iH]:[gr,12,"mat3"],[aH]:[gr,12,"mat3x2"],[lH]:[gr,12,"mat3x4"],[rH]:[gr,16,"mat4"],[cH]:[gr,16,"mat4x2"],[uH]:[gr,16,"mat4x3"]};function hH(t){switch(t){case gv:return gv;case QA:return QA;case Uj:return QA;case Nj:return QA;case YA:return YA;case Vj:return YA;case Gj:return YA;default:return jt(!1),0}}function _v(t){const e=cg[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function CS(t,e){switch(t){case zj:case Bj:case Oj:case Fj:t=gr;break}for(const n in cg){const[i,r,s]=cg[n];if(i===t&&r===e)return{glType:n,name:s}}return null}class fH{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,i=n.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:u,size:a}=n.getActiveAttrib(e.handle,r),y=n.getAttribLocation(e.handle,s);y>=0&&this._addAttribute(y,s,u,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!qn(n))return;const i=n.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:u,size:a}=n.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,u,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,n,i,r){const{type:s,components:u}=_v(i),a={type:s,size:r*u};this._inferProperties(e,n,a);const y={location:e,name:n,accessor:new co(a)};this.attributeInfos.push(y),this.attributeInfosByLocation[e]=y,this.attributeInfosByName[y.name]=y}_inferProperties(e,n,i){/instance/i.test(n)&&(i.divisor=1)}_addVarying(e,n,i,r){const{type:s,components:u}=_v(i),a=new co({type:s,size:r*u}),y={location:e,name:n,accessor:a};this.varyingInfos.push(y),this.varyingInfosByName[y.name]=y}}const yv=4,AH=35981,dH=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class PS extends u0{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",dH),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:i,fs:r,varyings:s,bufferMode:u=AH}=e;return this.hash=n||"",this.vs=typeof i=="string"?new y4(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs=typeof r=="string"?new v4(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,jt(this.vs instanceof y4),jt(this.fs instanceof v4),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(ls(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,u)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new fH(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:i=4,vertexCount:r,offset:s=0,start:u,end:a,isIndexed:y=!1,indexType:w=5123,instanceCount:M=0,isInstanced:R=M>0,vertexArray:L=null,transformFeedback:U,framebuffer:q,parameters:te={},uniforms:pe,samplers:ne}=e;if((pe||ne)&&(an.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(pe||{})),an.priority>=n){const ie=q?q.id:"default",re="mode=".concat(tc(this.gl,i)," verts=").concat(r," ")+"instances=".concat(M," indexType=").concat(tc(this.gl,w)," ")+"isInstanced=".concat(R," isIndexed=").concat(y," ")+"Framebuffer=".concat(ie);an.log(n,re)()}return jt(L),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||r===0||R&&M===0?!1:(L.bindForDraw(r,M,()=>{if(q!==void 0&&(te=Object.assign({},te,{framebuffer:q})),U){const ie=hH(i);U.begin(ie)}this._bindTextures(),ga(this.gl,te,()=>{y&&R?this.gl2.drawElementsInstanced(i,r,w,s,M):y&&qn(this.gl)&&!isNaN(u)&&!isNaN(a)?this.gl2.drawRangeElements(i,u,a,r,w,s):y?this.gl.drawElements(i,r,w,s):R?this.gl2.drawArraysInstanced(i,s,r,M):this.gl.drawArrays(i,s,r)}),U&&U.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};an.priority>=2&&kj(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const i=e[n],r=this._uniformSetters[n];if(r){let s=i,u=!1;if(s instanceof vr&&(s=s.texture),s instanceof Au)if(u=this.uniforms[n]!==i,u){r.textureIndex===void 0&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:y}=r;a.bind(y),s=y,this._textureUniforms[n]=a}else s=r.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(r(s)||u)&&Dj(this.uniforms,n,i)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const i=this._textureUniforms[n];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),i={};for(const r of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new y4({handle:r});break;case 35632:i.fs=new v4({handle:r});break}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=ac(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),an.time(yv,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),an.timeEnd(yv,"linkProgram for ".concat(this._getName()))(),e.debug||an.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const i=this.gl.getActiveUniform(this.handle,n),{name:r}=Ij(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=mv(e,s,i),i.size>1)for(let u=0;u<i.size;u++)s=e.getUniformLocation(this.handle,"".concat(r,"[").concat(u,"]")),this._uniformSetters["".concat(r,"[").concat(u,"]")]=mv(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const pH=34918,mH=34919,gH=35007,_H=36795,yH=35976,vH=35887,xH=36202;class jp extends u0{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=qn(e),r=g8(e,Si.TIMER_QUERY);let s=i||r;for(const u of n)switch(u){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:jt(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(gH)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?xH:vH)}beginTransformFeedbackQuery(){return this.begin(yH)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,mH);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(_H)}getResult(){return this.gl2.getQueryParameter(this.handle,pH)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return jp.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class MS extends u0{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return qn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ls(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,y1(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:u}=this._getBufferParams(n);return i<0?(this.unused[e]=r,an.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=n,this.bindOnUse||this._bindBuffer(i,r,u,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,i,r;return e instanceof gi?r=e:(r=e.buffer,i=e.byteSize,n=e.byteOffset),(n!==void 0||i!==void 0)&&(n=n||0,i=i||r.byteLength-n),{buffer:r,byteOffset:n,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||r===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,i,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let KA=null;function wH(t){return(!KA||KA.byteLength<t)&&(KA=new ArrayBuffer(t)),KA}function bH(t,e){const n=wH(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function EH(t){let{target:e,source:n,start:i=0,count:r=1}=t;const s=n.length,u=r*s;let a=0;for(let y=i;a<s;a++)e[y++]=n[a];for(;a<u;)a<u-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+u-a),a=u);return e}const TH="elements must be GL.ELEMENT_ARRAY_BUFFER";class ao extends u0{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?qn(e)||NG()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new ao(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return ao.MAX_ATTRIBUTES=ao.MAX_ATTRIBUTES||e.getParameter(34921),ao.MAX_ATTRIBUTES}static setConstant(e,n,i){switch(i.constructor){case Float32Array:ao._setConstantFloatArray(e,n,i);break;case Int32Array:ao._setConstantIntArray(e,n,i);break;case Uint32Array:ao._setConstantUintArray(e,n,i);break;default:jt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:i})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ao.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return jt(!e||e.target===34963,TH),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,i){if(n.target===34963)return this.setElementBuffer(n,i);const{size:r,type:s,stride:u,offset:a,normalized:y,integer:w,divisor:M}=i,{gl:R,gl2:L}=this;return e=Number(e),this.bind(()=>{R.bindBuffer(34962,n.handle),w?(jt(qn(R)),L.vertexAttribIPointer(e,r,s,u,a)):R.vertexAttribPointer(e,r,s,y,u,a),R.enableVertexAttribArray(e),L.vertexAttribDivisor(e,M||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!ao.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const i=this._normalizeConstantArrayValue(n),r=i.byteLength*e,s=i.length*e;let u=!this.buffer;if(this.buffer=this.buffer||new gi(this.gl,r),u=u||this.buffer.reallocate(r),u=u||!this._compareConstantArrayValues(i,this.bufferValue),u){const a=bH(n.constructor,s);EH({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==n[i])return!1;return!0}static _setConstantFloatArray(e,n,i){switch(i.length){case 1:e.vertexAttrib1fv(n,i);break;case 2:e.vertexAttrib2fv(n,i);break;case 3:e.vertexAttrib3fv(n,i);break;case 4:e.vertexAttrib4fv(n,i);break;default:jt(!1)}}static _setConstantIntArray(e,n,i){switch(jt(qn(e)),i.length){case 1:e.vertexAttribI1iv(n,i);break;case 2:e.vertexAttribI2iv(n,i);break;case 3:e.vertexAttribI3iv(n,i);break;case 4:e.vertexAttribI4iv(n,i);break;default:jt(!1)}}static _setConstantUintArray(e,n,i){switch(jt(qn(e)),i.length){case 1:e.vertexAttribI1uiv(n,i);break;case 2:e.vertexAttribI2uiv(n,i);break;case 3:e.vertexAttribI3uiv(n,i);break;case 4:e.vertexAttribI4uiv(n,i);break;default:jt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:i}=n;return jt(Number.isFinite(i)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(i,e);default:return this.gl.getVertexAttrib(i,e)}})}}const SH="VertexArray: attributes must be Buffers or constants (i.e. typed array)",CH=/^(.+)__LOCATION_([0-9]+)$/,PH=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class MH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;this.id=i,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ao(e),pS(this,"VertexArray","v6.0",PH),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const i=e[n];this._setAttribute(n,i)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,i);return r>=0&&(this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,n,s)),this}setConstant(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},i));return r>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new gi(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof gi&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof gi&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),r=i()}),r}_resolveLocationAndAccessor(e,n,i,r){const s={location:-1,accessor:null},{location:u,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(u)||u<0)return this.unused[e]=n,an.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const y=this._getAttributeInfo(a||u);if(!y)return s;const w=this.accessors[u]||{},M=co.resolve(y.accessor,w,i,r),{size:R,type:L}=M;return jt(Number.isFinite(R)&&Number.isFinite(L)),{location:u,accessor:M}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const i=CH.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,n){if(n instanceof gi)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof gi){const i=n[0],r=n[1];this.setBuffer(e,i,r)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const i=n;this.setConstant(e,i)}else if(n.buffer instanceof gi){const i=n;this.setBuffer(e,i.buffer,i)}else throw new Error(SH)}_setConstantAttributes(e,n){const i=Math.max(e|0,n|0);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,n){if(ao.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const i=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,n){ao.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const i=this.values[n],r=this.accessors[n];if(!i)return;const{divisor:s}=r,u=s>0;if(e.isInstanced=e.isInstanced||u,i instanceof gi){const a=i;if(u){const y=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,y)}else{const y=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,y)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return an.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function IH(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let u=0;u<t.length&&u<n;++u)u>0&&(r+=",".concat(u%i===0?" ":"")),r+=C2(t[u],e);const s=t.length>n?"...":"]";return"".concat(r).concat(s)}function C2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return IH(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function vv(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;jt(n);const s=".*_.*",u=".*Matrix",a=n._uniformSetters,y={},w=Object.keys(a).sort();let M=0;for(const U of w)!U.match(s)&&!U.match(u)&&x4({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&M++;for(const U of w)U.match(u)&&x4({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&M++;for(const U of w)y[U]||x4({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&M++;let R=0;const L={};if(!r)for(const U in i){const q=i[U];y[U]||(R++,L[U]={Type:"NOT USED: ".concat(q),[e]:C2(q)})}return{table:y,count:M,unusedTable:L,unusedCount:R}}function x4(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:s}=t;const u=i[r],a=kH(u);return!s||!a?(e[r]={[n]:a?C2(u):"N/A","Uniform Type":a?u:"NOT PROVIDED"},!0):!1}function kH(t){return t!=null}function LH(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=xv(e,e.elements,null,n));const r=e.values;for(const s in r){const u=e._getAttributeInfo(s);if(u){let a="".concat(s,": ").concat(u.name);const y=e.accessors[u.location];y&&(a="".concat(s,": ").concat(DH(u.name,y))),i[a]=xv(e,r[s],y,n)}}return i}function xv(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let s="NOT PROVIDED",u=1,a=0,y=0,w,M,R;if(n&&(s=n.type,u=n.size,s=String(s).replace("Array",""),w=s.indexOf("nt")!==-1),e instanceof gi){const L=e,{data:U,changed:q}=L.getDebugData();M=q?"*":"",R=U,y=L.byteLength,a=y/U.BYTES_PER_ELEMENT/u;let te;if(n){const pe=n.divisor>0;te="".concat(pe?"I ":"P "," ").concat(a," (x").concat(u,"=").concat(y," bytes ").concat(tc(r,s),")")}else w=!0,te="".concat(y," bytes");return{[i]:"".concat(M).concat(C2(R,{size:u,isInteger:w})),"Format ":te}}return R=e,u=e.length,s=String(e.constructor.name).replace("Array",""),w=s.indexOf("nt")!==-1,{[i]:"".concat(C2(R,{size:u,isInteger:w})," (constant)"),"Format ":"".concat(u,"x").concat(s," (constant)")}}function DH(t,e){const{type:n,size:i}=e,r=CS(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function RH(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const r=wv(i);e["in ".concat(r)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const r=wv(i);e["out ".concat(r)]={[n]:JSON.stringify(i.accessor)}}return e}function wv(t){const{type:e,size:n}=t.accessor,i=CS(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}function zH(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function BH(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||zH()}const bv=BH()&&typeof document<"u";let OH=0;class FH{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=pe=>fS(pe),onAddHTML:i=null,onInitialize:r=()=>{},onRender:s=()=>{},onFinalize:u=()=>{},onError:a,gl:y=null,glOptions:w={},debug:M=!1,createFramebuffer:R=!1,autoResizeViewport:L=!0,autoResizeDrawingBuffer:U=!0,stats:q=Kc.get("animation-loop-".concat(OH++))}=e;let{useDevicePixels:te=!0}=e;"useDevicePixelRatio"in e&&(an.deprecated("useDevicePixelRatio","useDevicePixels")(),te=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:u,onError:a,gl:y,glOptions:w,debug:M,createFramebuffer:R},this.gl=y,this.needsRedraw=null,this.timeline=null,this.stats=q,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:L,autoResizeDrawingBuffer:U,useDevicePixels:te}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return jt(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=jp.isSupported(this.gl,["timers"])?new jp(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),i!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):n}setViewParameters(){return an.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=bv?new Promise((e,n)=>{if(bv&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):jG(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):GG(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?d8(this.props.gl,e):this.onCreateContext(e),!M3(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");CG(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const i=this.props.onAddHTML(n);i&&(n.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&n>0&&(i=e/n),{width:e,height:n,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&LG(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new vr(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const q2="vs",y8="fs";function Ao(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const w4={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function NH(t){const e={};for(const n in t){const i=t[n],r=UH(i);e[n]=r}return e}function UH(t){let e=Ev(t);return e==="object"?t?"type"in t?Object.assign({},t,w4[t.type]):"value"in t?(e=Ev(t.value),Object.assign({type:e},t,w4[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},w4[e])}function Ev(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const VH="vs",GH="fs";class Tv{constructor(e){let{name:n,vs:i,fs:r,dependencies:s=[],uniforms:u,getUniforms:a,deprecations:y=[],defines:w={},inject:M={},vertexShader:R,fragmentShader:L}=e;Ao(typeof n=="string"),this.name=n,this.vs=i||R,this.fs=r||L,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(y),this.defines=w,this.injections=jH(M),u&&(this.uniforms=NH(u))}getModuleSource(e){let n;switch(e){case VH:n=this.vs||"";break;case GH:n=this.fs||"";break;default:Ao(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Ao(s.validate(e[r],s),"".concat(this.name,": invalid ").concat(r)),n[r]=e[r]):n[r]=s.value}return n}}function jH(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);typeof i=="string"&&(i={order:0,injection:i}),e[r][n]=i}return e}function HH(t){return WH(kS(t))}function WH(t){const e={},n={};return IS({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((i,r)=>n[r]-n[i]).map(i=>e[i])}function IS(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)i[s.name]=s,(r[s.name]===void 0||r[s.name]<n)&&(r[s.name]=n);for(const s of e)s.dependencies&&IS({modules:s.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function kS(t,e){return t.map(n=>(n instanceof Tv||(Ao(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Ao(n.name,"shader module has no name"),n=new Tv(n),n.dependencies=kS(n.dependencies)),n))}function $H(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r}const qH=7936,ZH=7937,XH=7938,QH=35724,v8={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},qc={};Object.keys(v8).forEach(t=>{qc[t]=t});function YH(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function KH(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||qH),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||ZH);return{gpuVendor:JH(n,i),vendor:n,renderer:i,version:t.getParameter(XH),shadingLanguageVersion:t.getParameter(QH)}}function JH(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const b4={};function Sv(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=v8[e];if(Ao(i,e),!$H(n))return!0;if(e in b4)return b4[e];const r=i[0],s=n.behavior||"enable",u="#extension GL_".concat(r," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,u),t.compileShader(a);const y=t.getShaderParameter(a,35713);return t.deleteShader(a),b4[e]=y,y}function eW(t,e){const n=v8[e];Ao(n,e);const i=YH(t)&&n[1]||n[0],r=typeof i=="string"?!!t.getExtension(i):i;return Ao(r===!1||r===!0),r}function JA(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>eW(t,n))}function tW(t){switch(KH(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function nW(t,e,n){let i=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return JA(t,qc.GLSL_FRAG_DEPTH)&&(i+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),JA(t,qc.GLSL_DERIVATIVES)&&Sv(t,qc.GLSL_DERIVATIVES)&&(i+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),JA(t,qc.GLSL_FRAG_DATA)&&Sv(t,qc.GLSL_FRAG_DATA,{behavior:"require"})&&(i+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),JA(t,qc.GLSL_TEXTURE_LOD)&&(i+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),i}const iW=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,rW=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,sW={[q2]:iW,[y8]:rW},Ud="__LUMA_INJECT_DECLARATIONS__",Cv=/void\s+main\s*\([^)]*\)\s*\{\n?/,Pv=/}\n?[^{}]*$/,E4=[];function Mv(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=e===q2;for(const s in n){const u=n[s];u.sort((y,w)=>y.order-w.order),E4.length=u.length;for(let y=0,w=u.length;y<w;++y)E4[y]=u[y].injection;const a="".concat(E4.join(`
`),`
`);switch(s){case"vs:#decl":r&&(t=t.replace(Ud,a));break;case"vs:#main-start":r&&(t=t.replace(Cv,y=>y+a));break;case"vs:#main-end":r&&(t=t.replace(Pv,y=>a+y));break;case"fs:#decl":r||(t=t.replace(Ud,a));break;case"fs:#main-start":r||(t=t.replace(Cv,y=>y+a));break;case"fs:#main-end":r||(t=t.replace(Pv,y=>a+y));break;default:t=t.replace(s,y=>y+a)}}return t=t.replace(Ud,""),i&&(t=t.replace(/\}\s*$/,s=>s+sW[e])),t}function ug(t){const e={};return Ao(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const i in n)e[i]=e[i]?"".concat(e[i],`
`).concat(n[i]):n[i]}),e}function v1(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const LS=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],oW=[...LS,[v1("attribute"),"in $1"],[v1("varying"),"out $1"]],aW=[...LS,[v1("varying"),"in $1"]],DS=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],lW=[...DS,[v1("in"),"attribute $1"],[v1("out"),"varying $1"]],cW=[...DS,[v1("in"),"varying $1"]],hg="gl_FragColor",fg=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,uW=/void\s+main\s*\([^)]*\)\s*\{\n?/;function hW(t,e,n){switch(e){case 300:return n?Hp(t,oW):fW(t);case 100:return n?Hp(t,lW):AW(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Hp(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}function fW(t){t=Hp(t,aW);const e=t.match(fg);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(hg,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(uW,i=>"out vec4 ".concat(n,`;
`).concat(i)).replace(new RegExp("\\b".concat(hg,"\\b"),"g"),n)}return t}function AW(t){t=Hp(t,cW);const e=t.match(fg);if(e){const n=e[1];t=t.replace(fg,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),hg)}return t}const dW=`

`.concat(Ud,`

`),RS={[q2]:"vertex",[y8]:"fragment"},pW=`precision highp float;

`;function mW(t,e){const{vs:n,fs:i}=e,r=HH(e.modules||[]);return{gl:t,vs:Iv(t,Object.assign({},e,{source:n,type:q2,modules:r})),fs:Iv(t,Object.assign({},e,{source:i,type:y8,modules:r})),getUniforms:gW(r)}}function Iv(t,e){let{id:n,source:i,type:r,modules:s,defines:u={},hookFunctions:a=[],inject:y={},transpileToGLSL100:w=!1,prologue:M=!0,log:R}=e;Ao(typeof i=="string","shader source must be a string");const L=r===q2,U=i.split(`
`);let q=100,te="",pe=i;U[0].indexOf("#version ")===0?(q=300,te=U[0],pe=U.slice(1).join(`
`)):te="#version ".concat(q);const ne={};s.forEach($e=>{Object.assign(ne,$e.getDefines())}),Object.assign(ne,u);let ie=M?"".concat(te,`
`).concat(yW({id:n,source:i,type:r}),`
`).concat(_W({type:r}),`
`).concat(tW(t),`
`).concat(nW(t),`
`).concat(vW(ne),`
`).concat(L?"":pW,`
`):"".concat(te,`
`);const re=wW(a),_e={},Te={},De={};for(const $e in y){const nt=typeof y[$e]=="string"?{injection:y[$e],order:0}:y[$e],ut=$e.match(/^(v|f)s:(#)?([\w-]+)$/);if(ut){const st=ut[2],lt=ut[3];st?lt==="decl"?Te[$e]=[nt]:De[$e]=[nt]:_e[$e]=[nt]}else De[$e]=[nt]}for(const $e of s){R&&$e.checkDeprecations(pe,R);const nt=$e.getModuleSource(r,q);ie+=nt;const ut=$e.injections[r];for(const st in ut){const lt=st.match(/^(v|f)s:#([\w-]+)$/);if(lt){const ht=lt[2]==="decl"?Te:De;ht[st]=ht[st]||[],ht[st].push(ut[st])}else _e[st]=_e[st]||[],_e[st].push(ut[st])}}return ie+=dW,ie=Mv(ie,r,Te),ie+=xW(re[r],_e),ie+=pe,ie=Mv(ie,r,De),ie=hW(ie,w?100:q,L),ie}function gW(t){return function(n){const i={};for(const r of t){const s=r.getUniforms(n,i);Object.assign(i,s)}return i}}function _W(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(RS[e].toUpperCase(),`
`)}function yW(t){let{id:e,source:n,type:i}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(RS[i],`

`):""}function vW(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const i in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],`
`))}return e===0&&(n+=`
`),n}function xW(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature,` {
`),r.header&&(n+="  ".concat(r.header)),e[i]){const s=e[i];s.sort((u,a)=>u.order-a.order);for(const u of s)n+="  ".concat(u.injection,`
`)}r.footer&&(n+="  ".concat(r.footer)),n+=`}
`}return n}function wW(t){const e={vs:{},fs:{}};return t.forEach(n=>{let i;typeof n!="string"?(i=n,n=i.hook):i={},n=n.trim();const[r,s]=n.split(":"),u=n.replace(/\(.+/,"");e[r][u]=Object.assign(i,{signature:s})}),e}const bW="void main() {gl_FragColor = vec4(0);}",zS=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,EW=`#version 300 es
`.concat(zS);function BS(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,s]=n;if(!e.includes(i)||!r||!s)return null;const u=s.split(";")[0];return{qualifier:i,type:r,name:u}}function OS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return e===300?EW:e>300?"#version ".concat(e,`
`).concat(zS):bW;const s=CW(n,i);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(i," ").concat(n,`;
out vec4 `).concat(r,`;
void main() {
  `).concat(r," = ").concat(s,`;
}`):"varying ".concat(i," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function TW(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ao(!1),null}}function SW(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ao(!1),null}}function CW(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ao(!1),null}}const PW=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,MW={name:"fp32",vs:PW,fs:null};function P2(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Es={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function IW(t,{precision:e=Es.precision}={}){return t=kW(t),"".concat(parseFloat(t.toPrecision(e)))}function du(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function H0(t,e,n){return DW(t,i=>Math.max(e,Math.min(n,i)))}function el(t,e,n){return du(t)?t.map((i,r)=>el(i,e[r],n)):n*e+(1-n)*t}function Xl(t,e,n){const i=Es.EPSILON;n&&(Es.EPSILON=n);try{if(t===e)return!0;if(du(t)&&du(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!Xl(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Es.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Es.EPSILON=i}}function kW(t){return Math.round(t/Es.EPSILON)*Es.EPSILON}function LW(t){return t.clone?t.clone():new Array(t.length)}function DW(t,e,n){if(du(t)){const i=t;n=n||LW(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}function RW(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class x8 extends RW(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+n];return this.check()}toArray(e=[],n=0){for(let i=0;i<this.ELEMENTS;++i)e[n+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:du(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Es)}formatString(e){let n="";for(let i=0;i<this.ELEMENTS;++i)n+=(i>0?", ":"")+IW(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Xl(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,i){if(i===void 0)return this.lerp(this,e,n);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(n[r]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),n[i]);return this.check()}add(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=n[i];return this.check()}subtract(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=n[i];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Es.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),n);return this.check()}get elements(){return this}}function zW(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function yi(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Jf(t,e,n=""){if(Es.debug&&!zW(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class FS extends x8{get x(){return this[0]}set x(e){this[0]=yi(e)}get y(){return this[1]}set y(e){this[1]=yi(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];n+=r*r}return yi(n)}dot(e){let n=0;for(let i=0;i<this.ELEMENTS;++i)n+=this[i]*e[i];return yi(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=n[i];return this.check()}divide(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=n[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return P2(e>=0&&e<this.ELEMENTS,"index is out of range"),yi(this[e])}setComponent(e,n){return P2(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var e2=1e-6,ya=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function BW(){var t=new ya(2);return ya!=Float32Array&&(t[0]=0,t[1]=0),t}function Ag(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function OW(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function FW(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function NW(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function UW(t,e){return t[0]=-e[0],t[1]=-e[1],t}function NS(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t}function VW(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function GW(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}var jW=OW;(function(){var t=BW();return function(e,n,i,r,s,u){var a,y;for(n||(n=2),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,u),e[a]=t[0],e[a+1]=t[1];return e}})();function HW(t,e,n){const i=e[0],r=e[1],s=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/s,t[1]=(n[1]*i+n[5]*r)/s,t}function US(t,e,n){const i=e[0],r=e[1],s=e[2],u=n[3]*i+n[7]*r+n[11]*s||1;return t[0]=(n[0]*i+n[4]*r+n[8]*s)/u,t[1]=(n[1]*i+n[5]*r+n[9]*s)/u,t[2]=(n[2]*i+n[6]*r+n[10]*s)/u,t}function WW(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}function $W(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3],t}function VS(t,e,n){const i=e[0],r=e[1],s=e[2];return t[0]=n[0]*i+n[3]*r+n[6]*s,t[1]=n[1]*i+n[4]*r+n[7]*s,t[2]=n[2]*i+n[5]*r+n[8]*s,t[3]=e[3],t}function GS(){var t=new ya(3);return ya!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function qW(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function kv(t,e,n){var i=new ya(3);return i[0]=t,i[1]=e,i[2]=n,i}function ZW(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function XW(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function QW(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function YW(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function jS(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Vd(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[0],a=n[1],y=n[2];return t[0]=r*y-s*a,t[1]=s*u-i*y,t[2]=i*a-r*u,t}function KW(t,e,n,i){var r=e[0],s=e[1],u=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=u+i*(n[2]-u),t}function w8(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[3]*i+n[7]*r+n[11]*s+n[15];return u=u||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/u,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/u,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/u,t}function HS(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t}function WS(t,e,n){var i=n[0],r=n[1],s=n[2],u=n[3],a=e[0],y=e[1],w=e[2],M=r*w-s*y,R=s*a-i*w,L=i*y-r*a,U=r*L-s*R,q=s*M-i*L,te=i*R-r*M,pe=u*2;return M*=pe,R*=pe,L*=pe,U*=2,q*=2,te*=2,t[0]=a+M+U,t[1]=y+R+q,t[2]=w+L+te,t}function JW(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function e$(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function t$(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function n$(t,e){var n=t[0],i=t[1],r=t[2],s=e[0],u=e[1],a=e[2],y=Math.sqrt(n*n+i*i+r*r),w=Math.sqrt(s*s+u*u+a*a),M=y*w,R=M&&jS(t,e)/M;return Math.acos(Math.min(Math.max(R,-1),1))}var $S=ZW,qS=qW,T4=XW;(function(){var t=GS();return function(e,n,i,r,s,u){var a,y;for(n||(n=3),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,u),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const S4=[0,0,0];let ed;class qt extends FS{static get ZERO(){return ed||(ed=new qt(0,0,0),Object.freeze(ed)),ed}constructor(e=0,n=0,i=0){super(-0,-0,-0),arguments.length===1&&du(e)?this.copy(e):(Es.debug&&(yi(e),yi(n),yi(i)),this[0]=e,this[1]=n,this[2]=i)}set(e,n,i){return this[0]=e,this[1]=n,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Es.debug&&(yi(e.x),yi(e.y),yi(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=yi(e)}angle(e){return n$(this,e)}cross(e){return Vd(this,this,e),this.check()}rotateX({radians:e,origin:n=S4}){return JW(this,this,n,e),this.check()}rotateY({radians:e,origin:n=S4}){return e$(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=S4}){return t$(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return w8(this,this,e),this.check()}transformAsVector(e){return US(this,this,e),this.check()}transformByMatrix3(e){return HS(this,this,e),this.check()}transformByMatrix2(e){return WW(this,this,e),this.check()}transformByQuaternion(e){return WS(this,this,e),this.check()}}let td;class b8 extends FS{static get ZERO(){return td||(td=new b8(0,0,0,0),Object.freeze(td)),td}constructor(e=0,n=0,i=0,r=0){super(-0,-0,-0,-0),du(e)&&arguments.length===1?this.copy(e):(Es.debug&&(yi(e),yi(n),yi(i),yi(r)),this[0]=e,this[1]=n,this[2]=i,this[3]=r)}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Es.debug&&(yi(e.x),yi(e.y),yi(e.z),yi(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=yi(e)}get w(){return this[3]}set w(e){this[3]=yi(e)}transform(e){return w8(this,this,e),this.check()}transformByMatrix3(e){return VS(this,this,e),this.check()}transformByMatrix2(e){return $W(this,this,e),this.check()}transformByQuaternion(e){return WS(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class ZS extends x8{toString(){let e="[";if(Es.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,i){return this[n*this.RANK+e]=yi(i),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)n[r]=this[i+r];return n}setColumn(e,n){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=n[r];return this}}function i$(){var t=new ya(9);return ya!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function r$(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function s$(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=e[4],a=e[5],y=e[6],w=e[7],M=e[8],R=M*u-a*w,L=-M*s+a*y,U=w*s-u*y,q=n*R+i*L+r*U;return q?(q=1/q,t[0]=R*q,t[1]=(-M*i+r*w)*q,t[2]=(a*i-r*u)*q,t[3]=L*q,t[4]=(M*n-r*y)*q,t[5]=(-a*n+r*s)*q,t[6]=U*q,t[7]=(-w*n+i*y)*q,t[8]=(u*n-i*s)*q,t):null}function o$(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],u=t[5],a=t[6],y=t[7],w=t[8];return e*(w*s-u*y)+n*(-w*r+u*a)+i*(y*r-s*a)}function Lv(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],M=e[7],R=e[8],L=n[0],U=n[1],q=n[2],te=n[3],pe=n[4],ne=n[5],ie=n[6],re=n[7],_e=n[8];return t[0]=L*i+U*u+q*w,t[1]=L*r+U*a+q*M,t[2]=L*s+U*y+q*R,t[3]=te*i+pe*u+ne*w,t[4]=te*r+pe*a+ne*M,t[5]=te*s+pe*y+ne*R,t[6]=ie*i+re*u+_e*w,t[7]=ie*r+re*a+_e*M,t[8]=ie*s+re*y+_e*R,t}function a$(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],M=e[7],R=e[8],L=n[0],U=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=u,t[4]=a,t[5]=y,t[6]=L*i+U*u+w,t[7]=L*r+U*a+M,t[8]=L*s+U*y+R,t}function l$(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],M=e[7],R=e[8],L=Math.sin(n),U=Math.cos(n);return t[0]=U*i+L*u,t[1]=U*r+L*a,t[2]=U*s+L*y,t[3]=U*u-L*i,t[4]=U*a-L*r,t[5]=U*y-L*s,t[6]=w,t[7]=M,t[8]=R,t}function Dv(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function c$(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n+n,a=i+i,y=r+r,w=n*u,M=i*u,R=i*a,L=r*u,U=r*a,q=r*y,te=s*u,pe=s*a,ne=s*y;return t[0]=1-R-q,t[3]=M-ne,t[6]=L+pe,t[1]=M+ne,t[4]=1-w-q,t[7]=U-te,t[2]=L-pe,t[5]=U+te,t[8]=1-w-R,t}var dg;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(dg||(dg={}));const u$=Object.freeze([1,0,0,0,1,0,0,0,1]);class Vr extends ZS{static get IDENTITY(){return f$()}static get ZERO(){return h$()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return dg}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(u$)}fromObject(e){return this.check()}fromQuaternion(e){return c$(this,e),this.check()}set(e,n,i,r,s,u,a,y,w){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=u,this[6]=a,this[7]=y,this[8]=w,this.check()}setRowMajor(e,n,i,r,s,u,a,y,w){return this[0]=e,this[1]=r,this[2]=a,this[3]=n,this[4]=s,this[5]=y,this[6]=i,this[7]=u,this[8]=w,this.check()}determinant(){return o$(this)}transpose(){return r$(this,this),this.check()}invert(){return s$(this,this),this.check()}multiplyLeft(e){return Lv(this,e,this),this.check()}multiplyRight(e){return Lv(this,this,e),this.check()}rotate(e){return l$(this,this,e),this.check()}scale(e){return Array.isArray(e)?Dv(this,this,e):Dv(this,this,[e,e]),this.check()}translate(e){return a$(this,this,e),this.check()}transform(e,n){let i;switch(e.length){case 2:i=VW(n||[-0,-0],e,this);break;case 3:i=HS(n||[-0,-0,-0],e,this);break;case 4:i=VS(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Jf(i,e.length),i}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let nd,id;function h$(){return nd||(nd=new Vr([0,0,0,0,0,0,0,0,0]),Object.freeze(nd)),nd}function f$(){return id||(id=new Vr,Object.freeze(id)),id}function A$(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function d$(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],u=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=u,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function pg(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=e[4],a=e[5],y=e[6],w=e[7],M=e[8],R=e[9],L=e[10],U=e[11],q=e[12],te=e[13],pe=e[14],ne=e[15],ie=n*a-i*u,re=n*y-r*u,_e=n*w-s*u,Te=i*y-r*a,De=i*w-s*a,$e=r*w-s*y,nt=M*te-R*q,ut=M*pe-L*q,st=M*ne-U*q,lt=R*pe-L*te,Lt=R*ne-U*te,ht=L*ne-U*pe,Tt=ie*ht-re*Lt+_e*lt+Te*st-De*ut+$e*nt;return Tt?(Tt=1/Tt,t[0]=(a*ht-y*Lt+w*lt)*Tt,t[1]=(r*Lt-i*ht-s*lt)*Tt,t[2]=(te*$e-pe*De+ne*Te)*Tt,t[3]=(L*De-R*$e-U*Te)*Tt,t[4]=(y*st-u*ht-w*ut)*Tt,t[5]=(n*ht-r*st+s*ut)*Tt,t[6]=(pe*_e-q*$e-ne*re)*Tt,t[7]=(M*$e-L*_e+U*re)*Tt,t[8]=(u*Lt-a*st+w*nt)*Tt,t[9]=(i*st-n*Lt-s*nt)*Tt,t[10]=(q*De-te*_e+ne*ie)*Tt,t[11]=(R*_e-M*De-U*ie)*Tt,t[12]=(a*ut-u*lt-y*nt)*Tt,t[13]=(n*lt-i*ut+r*nt)*Tt,t[14]=(te*re-q*Te-pe*ie)*Tt,t[15]=(M*Te-R*re+L*ie)*Tt,t):null}function p$(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],u=t[5],a=t[6],y=t[7],w=t[8],M=t[9],R=t[10],L=t[11],U=t[12],q=t[13],te=t[14],pe=t[15],ne=e*u-n*s,ie=e*a-i*s,re=e*y-r*s,_e=n*a-i*u,Te=n*y-r*u,De=i*y-r*a,$e=w*q-M*U,nt=w*te-R*U,ut=w*pe-L*U,st=M*te-R*q,lt=M*pe-L*q,Lt=R*pe-L*te;return ne*Lt-ie*lt+re*st+_e*ut-Te*nt+De*$e}function nu(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],M=e[7],R=e[8],L=e[9],U=e[10],q=e[11],te=e[12],pe=e[13],ne=e[14],ie=e[15],re=n[0],_e=n[1],Te=n[2],De=n[3];return t[0]=re*i+_e*a+Te*R+De*te,t[1]=re*r+_e*y+Te*L+De*pe,t[2]=re*s+_e*w+Te*U+De*ne,t[3]=re*u+_e*M+Te*q+De*ie,re=n[4],_e=n[5],Te=n[6],De=n[7],t[4]=re*i+_e*a+Te*R+De*te,t[5]=re*r+_e*y+Te*L+De*pe,t[6]=re*s+_e*w+Te*U+De*ne,t[7]=re*u+_e*M+Te*q+De*ie,re=n[8],_e=n[9],Te=n[10],De=n[11],t[8]=re*i+_e*a+Te*R+De*te,t[9]=re*r+_e*y+Te*L+De*pe,t[10]=re*s+_e*w+Te*U+De*ne,t[11]=re*u+_e*M+Te*q+De*ie,re=n[12],_e=n[13],Te=n[14],De=n[15],t[12]=re*i+_e*a+Te*R+De*te,t[13]=re*r+_e*y+Te*L+De*pe,t[14]=re*s+_e*w+Te*U+De*ne,t[15]=re*u+_e*M+Te*q+De*ie,t}function Wp(t,e,n){var i=n[0],r=n[1],s=n[2],u,a,y,w,M,R,L,U,q,te,pe,ne;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*s+e[12],t[13]=e[1]*i+e[5]*r+e[9]*s+e[13],t[14]=e[2]*i+e[6]*r+e[10]*s+e[14],t[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(u=e[0],a=e[1],y=e[2],w=e[3],M=e[4],R=e[5],L=e[6],U=e[7],q=e[8],te=e[9],pe=e[10],ne=e[11],t[0]=u,t[1]=a,t[2]=y,t[3]=w,t[4]=M,t[5]=R,t[6]=L,t[7]=U,t[8]=q,t[9]=te,t[10]=pe,t[11]=ne,t[12]=u*i+M*r+q*s+e[12],t[13]=a*i+R*r+te*s+e[13],t[14]=y*i+L*r+pe*s+e[14],t[15]=w*i+U*r+ne*s+e[15]),t}function E8(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function m$(t,e,n,i){var r=i[0],s=i[1],u=i[2],a=Math.hypot(r,s,u),y,w,M,R,L,U,q,te,pe,ne,ie,re,_e,Te,De,$e,nt,ut,st,lt,Lt,ht,Tt,Pn;return a<e2?null:(a=1/a,r*=a,s*=a,u*=a,y=Math.sin(n),w=Math.cos(n),M=1-w,R=e[0],L=e[1],U=e[2],q=e[3],te=e[4],pe=e[5],ne=e[6],ie=e[7],re=e[8],_e=e[9],Te=e[10],De=e[11],$e=r*r*M+w,nt=s*r*M+u*y,ut=u*r*M-s*y,st=r*s*M-u*y,lt=s*s*M+w,Lt=u*s*M+r*y,ht=r*u*M+s*y,Tt=s*u*M-r*y,Pn=u*u*M+w,t[0]=R*$e+te*nt+re*ut,t[1]=L*$e+pe*nt+_e*ut,t[2]=U*$e+ne*nt+Te*ut,t[3]=q*$e+ie*nt+De*ut,t[4]=R*st+te*lt+re*Lt,t[5]=L*st+pe*lt+_e*Lt,t[6]=U*st+ne*lt+Te*Lt,t[7]=q*st+ie*lt+De*Lt,t[8]=R*ht+te*Tt+re*Pn,t[9]=L*ht+pe*Tt+_e*Pn,t[10]=U*ht+ne*Tt+Te*Pn,t[11]=q*ht+ie*Tt+De*Pn,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function XS(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],u=e[5],a=e[6],y=e[7],w=e[8],M=e[9],R=e[10],L=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+w*i,t[5]=u*r+M*i,t[6]=a*r+R*i,t[7]=y*r+L*i,t[8]=w*r-s*i,t[9]=M*r-u*i,t[10]=R*r-a*i,t[11]=L*r-y*i,t}function g$(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],u=e[1],a=e[2],y=e[3],w=e[8],M=e[9],R=e[10],L=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-w*i,t[1]=u*r-M*i,t[2]=a*r-R*i,t[3]=y*r-L*i,t[8]=s*i+w*r,t[9]=u*i+M*r,t[10]=a*i+R*r,t[11]=y*i+L*r,t}function QS(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],u=e[1],a=e[2],y=e[3],w=e[4],M=e[5],R=e[6],L=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+w*i,t[1]=u*r+M*i,t[2]=a*r+R*i,t[3]=y*r+L*i,t[4]=w*r-s*i,t[5]=M*r-u*i,t[6]=R*r-a*i,t[7]=L*r-y*i,t}function _$(t,e){var n=e[0],i=e[1],r=e[2],s=e[4],u=e[5],a=e[6],y=e[8],w=e[9],M=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(s,u,a),t[2]=Math.hypot(y,w,M),t}function y$(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n+n,a=i+i,y=r+r,w=n*u,M=i*u,R=i*a,L=r*u,U=r*a,q=r*y,te=s*u,pe=s*a,ne=s*y;return t[0]=1-R-q,t[1]=M+ne,t[2]=L-pe,t[3]=0,t[4]=M-ne,t[5]=1-w-q,t[6]=U+te,t[7]=0,t[8]=L+pe,t[9]=U-te,t[10]=1-w-R,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function v$(t,e,n,i,r,s,u){var a=1/(n-e),y=1/(r-i),w=1/(s-u);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*y,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*y,t[10]=(u+s)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*s*2*w,t[15]=0,t}function x$(t,e,n,i,r){var s=1/Math.tan(e/2),u;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(u=1/(i-r),t[10]=(r+i)*u,t[14]=2*r*i*u):(t[10]=-1,t[14]=-2*i),t}var w$=x$;function b$(t,e,n,i,r,s,u){var a=1/(e-n),y=1/(i-r),w=1/(s-u);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*y,t[14]=(u+s)*w,t[15]=1,t}var E$=b$;function T$(t,e,n,i){var r,s,u,a,y,w,M,R,L,U,q=e[0],te=e[1],pe=e[2],ne=i[0],ie=i[1],re=i[2],_e=n[0],Te=n[1],De=n[2];return Math.abs(q-_e)<e2&&Math.abs(te-Te)<e2&&Math.abs(pe-De)<e2?A$(t):(M=q-_e,R=te-Te,L=pe-De,U=1/Math.hypot(M,R,L),M*=U,R*=U,L*=U,r=ie*L-re*R,s=re*M-ne*L,u=ne*R-ie*M,U=Math.hypot(r,s,u),U?(U=1/U,r*=U,s*=U,u*=U):(r=0,s=0,u=0),a=R*u-L*s,y=L*r-M*u,w=M*s-R*r,U=Math.hypot(a,y,w),U?(U=1/U,a*=U,y*=U,w*=U):(a=0,y=0,w=0),t[0]=r,t[1]=a,t[2]=M,t[3]=0,t[4]=s,t[5]=y,t[6]=R,t[7]=0,t[8]=u,t[9]=w,t[10]=L,t[11]=0,t[12]=-(r*q+s*te+u*pe),t[13]=-(a*q+y*te+w*pe),t[14]=-(M*q+R*te+L*pe),t[15]=1,t)}function S$(){var t=new ya(4);return ya!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function C$(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function T8(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function P$(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function M$(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function I$(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n*n+i*i+r*r+s*s;return u>0&&(u=1/Math.sqrt(u)),t[0]=n*u,t[1]=i*u,t[2]=r*u,t[3]=s*u,t}function k$(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function L$(t,e,n,i){var r=e[0],s=e[1],u=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=u+i*(n[2]-u),t[3]=a+i*(n[3]-a),t}function B1(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*u,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*u,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*u,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*u,t}function D$(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[0],a=n[1],y=n[2],w=n[3],M=w*i+a*s-y*r,R=w*r+y*i-u*s,L=w*s+u*r-a*i,U=-u*i-a*r-y*s;return t[0]=M*w+U*-u+R*-y-L*-a,t[1]=R*w+U*-a+L*-u-M*-y,t[2]=L*w+U*-y+M*-a-R*-u,t[3]=e[3],t}(function(){var t=S$();return function(e,n,i,r,s,u){var a,y;for(n||(n=4),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,u),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var mg;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(mg||(mg={}));const R$=45*Math.PI/180,z$=1,C4=.1,P4=500,B$=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ws extends ZS{static get IDENTITY(){return F$()}static get ZERO(){return O$()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return mg}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,i,r,s,u,a,y,w,M,R,L,U,q,te,pe){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=u,this[6]=a,this[7]=y,this[8]=w,this[9]=M,this[10]=R,this[11]=L,this[12]=U,this[13]=q,this[14]=te,this[15]=pe,this.check()}setRowMajor(e,n,i,r,s,u,a,y,w,M,R,L,U,q,te,pe){return this[0]=e,this[1]=s,this[2]=w,this[3]=U,this[4]=n,this[5]=u,this[6]=M,this[7]=q,this[8]=i,this[9]=a,this[10]=R,this[11]=te,this[12]=r,this[13]=y,this[14]=L,this[15]=pe,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(B$)}fromObject(e){return this.check()}fromQuaternion(e){return y$(this,e),this.check()}frustum(e){const{left:n,right:i,bottom:r,top:s,near:u=C4,far:a=P4}=e;return a===1/0?N$(this,n,i,r,s,u):v$(this,n,i,r,s,u,a),this.check()}lookAt(e){const{eye:n,center:i=[0,0,0],up:r=[0,1,0]}=e;return T$(this,n,i,r),this.check()}ortho(e){const{left:n,right:i,bottom:r,top:s,near:u=C4,far:a=P4}=e;return E$(this,n,i,r,s,u,a),this.check()}orthographic(e){const{fovy:n=R$,aspect:i=z$,focalDistance:r=1,near:s=C4,far:u=P4}=e;Rv(n);const a=n/2,y=r*Math.tan(a),w=y*i;return this.ortho({left:-w,right:w,bottom:-y,top:y,near:s,far:u})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}=e;return Rv(n),w$(this,n,i,r,s),this.check()}determinant(){return p$(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],s=1/i[1],u=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*u,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*u,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],s=1/i[1],u=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*u,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*u,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*u,e}transpose(){return d$(this,this),this.check()}invert(){return pg(this,this),this.check()}multiplyLeft(e){return nu(this,e,this),this.check()}multiplyRight(e){return nu(this,this,e),this.check()}rotateX(e){return XS(this,this,e),this.check()}rotateY(e){return g$(this,this,e),this.check()}rotateZ(e){return QS(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return m$(this,this,e,n),this.check()}scale(e){return E8(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Wp(this,this,e),this.check()}transform(e,n){return e.length===4?(n=B1(n||[-0,-0,-0,-0],e,this),Jf(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:i}=e;let r;switch(i){case 2:r=GW(n||[-0,-0],e,this);break;case 3:r=w8(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Jf(r,e.length),r}transformAsVector(e,n){let i;switch(e.length){case 2:i=HW(n||[-0,-0],e,this);break;case 3:i=US(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Jf(i,e.length),i}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,i){return this.identity().translate([e,n,i])}}let rd,sd;function O$(){return rd||(rd=new Ws([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(rd)),rd}function F$(){return sd||(sd=new Ws,Object.freeze(sd)),sd}function Rv(t){if(t>Math.PI*2)throw Error("expected radians")}function N$(t,e,n,i,r,s){const u=2*s/(n-e),a=2*s/(r-i),y=(n+e)/(n-e),w=(r+i)/(r-i),M=-1,R=-1,L=-2*s;return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=y,t[9]=w,t[10]=M,t[11]=R,t[12]=0,t[13]=0,t[14]=L,t[15]=0,t}function zv(){var t=new ya(4);return ya!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function U$(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function YS(t,e,n){n=n*.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function Bv(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=n[0],y=n[1],w=n[2],M=n[3];return t[0]=i*M+u*a+r*w-s*y,t[1]=r*M+u*y+s*a-i*w,t[2]=s*M+u*w+i*y-r*a,t[3]=u*M-i*a-r*y-s*w,t}function V$(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y+u*a,t[1]=r*y+s*a,t[2]=s*y-r*a,t[3]=u*y-i*a,t}function G$(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y-s*a,t[1]=r*y+u*a,t[2]=s*y+i*a,t[3]=u*y-r*a,t}function j$(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y+r*a,t[1]=r*y-i*a,t[2]=s*y+u*a,t[3]=u*y-s*a,t}function H$(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function Gd(t,e,n,i){var r=e[0],s=e[1],u=e[2],a=e[3],y=n[0],w=n[1],M=n[2],R=n[3],L,U,q,te,pe;return U=r*y+s*w+u*M+a*R,U<0&&(U=-U,y=-y,w=-w,M=-M,R=-R),1-U>e2?(L=Math.acos(U),q=Math.sin(L),te=Math.sin((1-i)*L)/q,pe=Math.sin(i*L)/q):(te=1-i,pe=i),t[0]=te*r+pe*y,t[1]=te*s+pe*w,t[2]=te*u+pe*M,t[3]=te*a+pe*R,t}function W$(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n*n+i*i+r*r+s*s,a=u?1/u:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t}function $$(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function KS(t,e){var n=e[0]+e[4]+e[8],i;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[r*3+r]&&(r=2);var s=(r+1)%3,u=(r+2)%3;i=Math.sqrt(e[r*3+r]-e[s*3+s]-e[u*3+u]+1),t[r]=.5*i,i=.5/i,t[3]=(e[s*3+u]-e[u*3+s])*i,t[s]=(e[s*3+r]+e[r*3+s])*i,t[u]=(e[u*3+r]+e[r*3+u])*i}return t}var q$=C$,Z$=T8,X$=k$,Q$=L$,Y$=P$,K$=M$,JS=I$,J$=function(){var t=GS(),e=kv(1,0,0),n=kv(0,1,0);return function(i,r,s){var u=jS(r,s);return u<-.999999?(Vd(t,e,r),qS(t)<1e-6&&Vd(t,n,r),YW(t,t),YS(i,t,Math.PI),i):u>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(Vd(t,r,s),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+u,JS(i,i))}}();(function(){var t=zv(),e=zv();return function(n,i,r,s,u,a){return Gd(t,i,u,a),Gd(e,r,s,a),Gd(n,t,e,2*a*(1-a)),n}})();(function(){var t=i$();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],JS(e,KS(e,t))}})();const eq=[0,0,0,1];class Ov extends x8{constructor(e=0,n=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return KS(this,e),this.check()}fromAxisRotation(e,n){return YS(this,e,n),this.check()}identity(){return U$(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=yi(e)}get y(){return this[1]}set y(e){this[1]=yi(e)}get z(){return this[2]}set z(e){this[2]=yi(e)}get w(){return this[3]}set w(e){this[3]=yi(e)}len(){return Y$(this)}lengthSquared(){return K$(this)}dot(e){return X$(this,e)}rotationTo(e,n){return J$(this,e,n),this.check()}add(e){return q$(this,this,e),this.check()}calculateW(){return H$(this,this),this.check()}conjugate(){return $$(this,this),this.check()}invert(){return W$(this,this),this.check()}lerp(e,n,i){return i===void 0?this.lerp(this,e,n):(Q$(this,e,n,i),this.check())}multiplyRight(e){return Bv(this,this,e),this.check()}multiplyLeft(e){return Bv(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return V$(this,this,e),this.check()}rotateY(e){return G$(this,this,e),this.check()}rotateZ(e){return j$(this,this,e),this.check()}scale(e){return Z$(this,this,e),this.check()}slerp(e,n,i){let r,s,u;switch(arguments.length){case 1:({start:r=eq,target:s,ratio:u}=e);break;case 2:r=this,s=e,u=n;break;default:r=e,s=n,u=i}return Gd(this,r,s,u),this.check()}transformVector4(e,n=new b8){return D$(n,e,this),Jf(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const eC={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},Fv=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,tq={lightSources:{}};function M4(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function nq(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return e?r["lighting_uAmbientLight.color"]=M4(e):r["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,u)=>{r["lighting_uPointLight[".concat(u,"].color")]=M4(s),r["lighting_uPointLight[".concat(u,"].position")]=s.position,r["lighting_uPointLight[".concat(u,"].attenuation")]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=n.length,i.forEach((s,u)=>{r["lighting_uDirectionalLight[".concat(u,"].color")]=M4(s),r["lighting_uDirectionalLight[".concat(u,"].direction")]=s.direction}),r.lighting_uDirectionalLightCount=i.length,r}function tC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tq;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},nq({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return tC({lightSources:e})}return{}}const nC={name:"lights",vs:Fv,fs:Fv,getUniforms:tC,defines:{MAX_LIGHTS:3}},iq=new Uint8Array([0,255,255,255]),rq={pickingSelectedColor:null,pickingHighlightColor:iq,pickingActive:!1,pickingAttribute:!1};function sq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rq;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const oq=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,aq=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,lq={name:"picking",vs:oq,fs:aq,getUniforms:sq},iC=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,cq={};function uq(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}function rC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cq;if(!("material"in t))return{};const{material:e}=t;return e?uq(e):{lighting_uEnabled:!1}}const hq={name:"gouraud-lighting",dependencies:[nC],vs:iC,defines:{LIGHTING_VERTEX:1},getUniforms:rC},fq={name:"phong-lighting",dependencies:[nC],fs:iC,defines:{LIGHTING_FRAGMENT:1},getUniforms:rC},Aq=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,dq={name:"transform",vs:Aq,fs:null};class Z2{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Z2(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:i="",defines:r={},inject:s={},varyings:u=[],bufferMode:a=35981,transpileToGLSL100:y=!1}=e,w=this._getModuleList(e.modules),M=this._getHash(n),R=this._getHash(i),L=w.map(re=>this._getHash(re.name)).sort(),U=u.map(re=>this._getHash(re)),q=Object.keys(r).sort(),te=Object.keys(s).sort(),pe=[],ne=[];for(const re of q)pe.push(this._getHash(re)),pe.push(this._getHash(r[re]));for(const re of te)ne.push(this._getHash(re)),ne.push(this._getHash(s[re]));const ie="".concat(M,"/").concat(R,"D").concat(pe.join("/"),"M").concat(L.join("/"),"I").concat(ne.join("/"),"V").concat(U.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(y?"T":"");if(!this._programCache[ie]){const re=mW(this.gl,{vs:n,fs:i,modules:w,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:y});this._programCache[ie]=new PS(this.gl,{hash:ie,vs:re.vs,fs:re.fs,varyings:u,bufferMode:a}),this._getUniforms[ie]=re.getUniforms||(_e=>{}),this._useCounts[ie]=0}return this._useCounts[ie]++,this._programCache[ie]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,u=this._defaultModules.length;s<u;++s){const a=this._defaultModules[s],y=a.name;n[r++]=a,i[y]=!0}for(let s=0,u=e.length;s<u;++s){const a=e[s],y=a.name;i[y]||(n[r++]=a,i[y]=!0)}return n.length=r,n}}const pq={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function mq(t,e,n){const i={};let r=e.indices;for(const s in e.attributes){const u=e.attributes[s],a=gq(s,n);if(s==="indices")r=u;else if(u.constant)i[a]=u.value;else{const y=u.value,w={...u};delete w.value,i[a]=[new gi(t,y),w],_q(s,w)}}if(r){const s=r.value||r;jt(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const u={size:1,isIndexed:r.isIndexed===void 0?!0:r.isIndexed};i.indices=[new gi(t,{data:s,target:34963}),u]}return i}function gq(t,e){const{attributeMap:n=pq}=e||{};return n&&n[t]||t}function _q(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}jt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const wh=2,yq=1e4,vq="Model needs drawMode and vertexCount",Nv=()=>{},xq={};class o0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:i=ac("model")}=n;jt(M3(e)),this.id=i,this.gl=e,this.id=n.id||ac("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Z2.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:M}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:M},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},jt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),vq)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:M}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:M},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return jt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return jt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=mq(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(y1(e))return this;const n={};for(const i in e){const r=e[i];n[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return m8(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:u=this.transformFeedback,parameters:a={},vertexArray:y=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(r);let w;an.priority>=wh&&(w=this._logDrawCallStart(wh));const M=this.vertexArray.getDrawParams(),{isIndexed:R=M.isIndexed,indexType:L=M.indexType,indexOffset:U=M.indexOffset,vertexArrayInstanced:q=M.isInstanced}=this.props;q&&!this.isInstanced&&an.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:te,instanceCount:pe}=this,{onBeforeRender:ne=Nv,onAfterRender:ie=Nv}=this.props;ne(),this.program.setUniforms(this.uniforms);const re=this.program.draw(Object.assign(xq,e,{logPriority:w,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:y,transformFeedback:u,isIndexed:R,indexType:L,isInstanced:te,instanceCount:pe,offset:R?U:0}));return ie(),an.priority>=wh&&this._logDrawCallEnd(w,y,i),re}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),n&&(s=Object.assign({},s,{35977:n})),r.forEach(u=>u.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(u=>u.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return an.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:u,defines:a,varyings:y,bufferMode:w,transpileToGLSL100:M}=this.programProps;n=this.programManager.get({vs:i,fs:r,modules:s,inject:u,defines:a,varyings:y,bufferMode:w,transpileToGLSL100:M}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}jt(n instanceof PS,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new MH(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof gi&&n.delete()}}_setAnimationProps(e){this.animated&&jt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(y1(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new MS(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:yq;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),an.group(wh,">>> DRAWING MODEL ".concat(this.id),{collapsed:an.level<=2})(),e}_logDrawCallEnd(e,n,i,r){if(e===void 0)return;const s=LH({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:u,unusedTable:a,unusedCount:y}=vv({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:w,count:M}=vv({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});M>0&&an.log("MISSING UNIFORMS",Object.keys(w))(),y>0&&an.log("UNUSED UNIFORMS",Object.keys(a))();const R=RH(this.vertexArray.configuration);an.table(e,s)(),an.table(e,u)(),an.table(e+1,R)(),r&&r.log({logLevel:wh,message:"Rendered to ".concat(r.id)}),an.groupEnd(wh)()}}class wq{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=n;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],i=e?n[e]:null;return i?i instanceof gi?i:i.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,i=this.getBuffer(n);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&jt(qn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in n&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if(typeof s=="string"){const u=n[s],{byteLength:a,usage:y,accessor:w}=u;i[r]=this._createNewBuffer(r,{byteLength:a,usage:y,accessor:w})}}return i}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:i})}_setupTransformFeedback(e,n){let{model:i}=n;const{program:r}=i;e.transformFeedback=new MS(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:n,feedbackBuffers:i})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];n[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],jt(i[s]instanceof gi)}return{sourceBuffers:n,feedbackBuffers:i}}_createNewBuffer(e,n){const i=new gi(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}const bq="transform_uSampler_",$p="transform_uSize_",Uv="transform_position";function Eq(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,u=Object.keys(n).length,a=null;const y={};let w=e,M={};if(u>0||i){const R=w.split(`
`),L=R.slice();if(R.forEach((U,q,te)=>{if(u>0){const pe=Mq(U,n);if(pe){const{updatedLine:ne,inject:ie}=pe;L[q]=ne,M=ug([M,ie]),Object.assign(y,pe.samplerTextureMap),u--}}i&&!a&&(a=Pq(U,i))}),i){jt(r);const U="".concat($p).concat(i),q="uniform vec2 ".concat(U,`;
`),te="     vec2 ".concat(Uv," = transform_getPos(").concat(U,`);
     gl_Position = vec4(`).concat(Uv,`, 0, 1.);
`);M=ug([M,{"vs:#decl":q,"vs:#main-start":te}])}w=L.join(`
`)}return{vs:w,targetTextureType:a,inject:M,samplerTextureMap:y}}function Tq(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let s,u;n&&({width:s,height:u}=i,r["".concat($p).concat(n)]=[s,u]);for(const a in e)({width:s,height:u}=e[a]),r["".concat($p).concat(a)]=[s,u];return r}function Sq(t){return BS(t,["attribute","in"])}function Cq(t){const e="".concat(bq).concat(t),n="".concat($p).concat(t),i="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}function Pq(t,e){const n=BS(t,["varying","out"]);return n&&n.name===e?n.type:null}function Mq(t,e){const n={},i=Sq(t);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const u="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:y,uniformDeclerations:w}=Cq(s),M=TW(r),R="  ".concat(r," ").concat(s," = transform_getInput(").concat(a,", ").concat(y,").").concat(M,`;
`);return n[a]=s,{updatedLine:u,inject:{"vs:#decl":w,"vs:#main-start":R},samplerTextureMap:n}}return null}const Iq={10241:9728,10240:9728,10242:33071,10243:33071},kq="transform_output";class Lq{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],u=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),y=Object.assign({},e.parameters);let w=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){u.transform_elementID=this.elementIDBuffer;for(const R in this.samplerTextureMap){const L=this.samplerTextureMap[R];a[R]=i[L]}this._setSourceTextureParameters();const M=Tq({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,M)}return this.hasTargetTexture&&(w=!1,y.viewport=[0,0,r.width,r.height]),{attributes:u,framebuffer:r,uniforms:a,discard:w,parameters:y}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],i=k3(n);if(!e)return i;const r=i.constructor,s=SW(this.targetTextureType),u=new r(i.length*s/4);let a=0;for(let y=0;y<i.length;y+=4)for(let w=0;w<s;w++)u[a++]=i[y+w];return u}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:i}=e;if(i instanceof $s)return i;const r=n[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new gi(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:n,targetTexture:i})}}_updateBinding(e,n){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:u,height:a}=s,{framebuffer:y}=e;y?(y.update({attachments:{36064:s},resizeAttachments:!1}),y.resize({width:u,height:a})):e.framebuffer=new vr(this.gl,{id:"transform-framebuffer",width:u,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const i in n)n[i].setParameters(Iq)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const i=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:i}}_createNewTexture(e){const n=_j(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:u,inject:a,samplerTextureMap:y}=Eq({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),w=ug([e.inject||{},a]);this.targetTextureType=u,this.samplerTextureMap=y;const M=e._fs||OS({version:SS(r),input:this.targetTextureVarying,inputType:u,output:kq}),R=this.hasSourceTextures||this.targetTextureVarying?[dq].concat(e.modules||[]):e.modules;return{vs:r,fs:M,modules:R,uniforms:s,inject:w}}}class S8{static isSupported(e){return qn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:i}=this;e&&e.delete(),n&&n.delete(),i&&i.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,i=this._updateDrawOptions(e);n&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=e||i.swap();jt(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)i.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new o0(n,Object.assign({},e,{fs:e.fs||OS({version:SS(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=r.updateModelProps(n);return n}_buildResourceTransforms(e,n){Dq(n)&&(this.bufferTransform=new wq(e,n)),Rq(n)&&(this.textureTransform=new Lq(e,n)),jt(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=Object.assign(n,r.getDrawOptions(n));return n}}function Dq(t){return!!(!y1(t.feedbackBuffers)||!y1(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function Rq(t){return!!(!y1(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const Vv={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Ql{static get DRAW_MODE(){return Vv}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=ac("geometry"),drawMode:i=Vv.TRIANGLES,attributes:r={},indices:s=null,vertexCount:u=null}=e;this.id=n,this.drawMode=i|0,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=u||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,jt(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),(i==="POSITION"||i==="positions")&&!r.size&&(r.size=3),i==="indices"?(jt(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let i=1/0;for(const r in e){const s=e[r],{value:u,size:a,constant:y}=s;!y&&u&&a>=1&&(i=Math.min(i,u.length/a))}return jt(Number.isFinite(i)),i}}let zq=1,Bq=1;class sC{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,u=zq++,a={time:0,delay:n,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(u,a),u}removeChannel(e){this.channels.delete(e);for(const[n,i]of this.animations)i.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const r of n)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:u}=r;s.setTime(this.getTime(u))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const i=Bq++;return this.animations.set(i,{animation:e,channel:n}),e.setTime(this.getTime(n)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const i=n-e.delay,r=e.duration*e.repeat;i>=r?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const Oq=[255,255,255],Fq=1;let Nq=0;class oC{constructor(e={}){Z(this,"id",void 0),Z(this,"color",void 0),Z(this,"intensity",void 0),Z(this,"type","ambient");const{color:n=Oq}=e,{intensity:i=Fq}=e;this.id=e.id||"ambient-".concat(Nq++),this.color=n,this.intensity=i}}const Uq=[255,255,255],Vq=1,Gq=[0,0,-1];let jq=0;class gg{constructor(e={}){Z(this,"id",void 0),Z(this,"color",void 0),Z(this,"intensity",void 0),Z(this,"type","directional"),Z(this,"direction",void 0),Z(this,"shadow",void 0);const{color:n=Uq}=e,{intensity:i=Vq}=e,{direction:r=Gq}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(jq++),this.color=n,this.intensity=i,this.type="directional",this.direction=new qt(r).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class Hq{constructor(e,n={id:"pass"}){Z(this,"id",void 0),Z(this,"gl",void 0),Z(this,"props",void 0);const{id:i}=n;this.id=i,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class C8 extends Hq{constructor(...e){super(...e),Z(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return s0(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:i,viewports:r,views:s,onViewportActive:u,clearStack:a=!0,clearCanvas:y=!0}=e;e.pass=e.pass||"unknown";const w=this.gl;y&&$q(w,n),a&&(this._lastRenderIndex=-1);const M=[];for(const R of r){const L=s&&s[R.id];u?.(R);const U=this._getDrawLayerParams(R,e),q=R.subViewports||[R];for(const te of q){const pe=this._drawLayersInViewport(w,{target:n,moduleParameters:i,viewport:te,view:L,pass:e.pass,layers:e.layers},U);M.push(pe)}}return M}_getDrawLayerParams(e,{layers:n,pass:i,isPicking:r=!1,layerFilter:s,cullRect:u,effects:a,moduleParameters:y},w=!1){const M=[],R=aC(this._lastRenderIndex+1),L={layer:n[0],viewport:e,isPicking:r,renderPass:i,cullRect:u},U={};for(let q=0;q<n.length;q++){const te=n[q],pe=this._shouldDrawLayer(te,L,s,U),ne={shouldDrawLayer:pe};pe&&!w&&(ne.layerRenderIndex=R(te,pe),ne.moduleParameters=this._getModuleParameters(te,a,i,y),ne.layerParameters=this.getLayerParameters(te,q,e)),M[q]=ne}return M}_drawLayersInViewport(e,{layers:n,moduleParameters:i,pass:r,target:s,viewport:u,view:a},y){const w=Wq(e,{moduleParameters:i,target:s,viewport:u});if(a&&a.props.clear){const R=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;ga(e,{scissorTest:!0,scissor:w},()=>m8(e,R))}const M={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};s0(e,{viewport:w});for(let R=0;R<n.length;R++){const L=n[R],{shouldDrawLayer:U,layerRenderIndex:q,moduleParameters:te,layerParameters:pe}=y[R];if(U&&L.props.pickable&&M.pickableCount++,L.isComposite)M.compositeCount++;else if(U){M.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,q),te.viewport=u;try{L._drawLayer({moduleParameters:te,uniforms:{layerIndex:q},parameters:pe})}catch(ne){L.raiseError(ne,"drawing ".concat(L," to ").concat(r))}}}return M}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,i){return e.props.parameters}_shouldDrawLayer(e,n,i,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let u=e.parent;for(;u;){if(!u.props.visible||!u.filterSubLayer(n))return!1;n.layer=u,u=u.parent}if(i){const a=n.layer.id;if(a in r||(r[a]=i(n)),!r[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,i,r){var s;const u=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:_1(this.gl)});if(n)for(const y of n){var a;Object.assign(u,(a=y.getModuleParameters)===null||a===void 0?void 0:a.call(y,e))}return Object.assign(u,this.getModuleParameters(e,n),r)}}function aC(t=0,e={}){const n={},i=(r,s)=>{const u=r.props._offset,a=r.id,y=r.parent&&r.parent.id;let w;if(y&&!(y in e)&&i(r.parent,!1),y in n){const M=n[y]=n[y]||aC(e[y],e);w=M(r,s),n[a]=M}else Number.isFinite(u)?(w=u+(e[y]||0),n[a]=null):w=t;return s&&w>=t&&(t=w+1),e[a]=w,w};return i}function Wq(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||_1(t),u=r?n.height:t.drawingBufferHeight,a=i;return[a.x*s,u-(a.y+a.height)*s,a.width*s,a.height*s]}function $q(t,e){const n=e?e.width:t.drawingBufferWidth,i=e?e.height:t.drawingBufferHeight;s0(t,{viewport:[0,0,n,i]}),t.clear(16640)}class qq extends C8{constructor(e,n){super(e,n),Z(this,"shadowMap",void 0),Z(this,"depthBuffer",void 0),Z(this,"fbo",void 0),this.shadowMap=new $s(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Vh(e,{format:33189,width:1,height:1}),this.fbo=new vr(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;ga(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=_1(this.gl),s=i.width*r,u=i.height*r;(s!==n.width||u!==n.height)&&n.resize({width:s,height:u}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const lC="#define SMOOTH_EDGE_RADIUS 0.5",Zq=`
`.concat(lC,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),Xq=`
`.concat(lC,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),Qq={name:"geometry",vs:Zq,fs:Xq},Yq=Object.keys($n).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat($n[t],";")).join(""),Kq=Object.keys(fa).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(fa[t],";")).join(""),Jq=Object.keys(fu).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(fu[t],";")).join(""),eZ="".concat(Yq,`
`).concat(Kq,`
`).concat(Jq,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function tZ(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function X2(t){let e={},n;return i=>{for(const r in i)if(!tZ(i[r],e[r])){n=t(i),e=i;break}return n}}const Gv=[0,0,0,0],nZ=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],cC=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],iZ=[0,0,0],uC=[0,0,0],rZ=X2(aZ);function hC(t,e,n=uC){n.length<3&&(n=[n[0],n[1],0]);let i=n,r,s=!0;switch(e===$n.LNGLAT_OFFSETS||e===$n.METER_OFFSETS?r=n:r=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case fa.WEB_MERCATOR:(e===$n.LNGLAT||e===$n.CARTESIAN)&&(r=[0,0,0],s=!1);break;case fa.WEB_MERCATOR_AUTO_OFFSET:e===$n.LNGLAT?i=r:e===$n.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case fa.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case fa.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function sZ(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:s,viewProjectionMatrix:u}=t,a=Gv,y=Gv,w=t.cameraPosition;const{geospatialOrigin:M,shaderCoordinateOrigin:R,offsetMode:L}=hC(t,e,n);return L&&(y=t.projectPosition(M||R),w=[w[0]-y[0],w[1]-y[1],w[2]-y[2]],y[3]=1,a=B1([],y,u),s=i||s,u=nu([],r,s),u=nu([],u,nZ)),{viewMatrix:s,viewProjectionMatrix:u,projectionCenter:a,originCommon:y,cameraPosCommon:w,shaderCoordinateOrigin:R,geospatialOrigin:M}}function oZ({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=$n.DEFAULT,coordinateOrigin:r=uC,autoWrapLongitude:s=!1}){i===$n.DEFAULT&&(i=t.isGeospatial?$n.LNGLAT:$n.CARTESIAN);const u=rZ({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return u.project_uWrapLongitude=s,u.project_uModelMatrix=n||cC,u}function aZ({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:u,cameraPosCommon:a,shaderCoordinateOrigin:y,geospatialOrigin:w}=sZ(t,n,i),M=t.getDistanceScales(),R=[t.width*e,t.height*e],L=B1([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,U={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:y,project_uCommonOrigin:u.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:R,project_uDevicePixelRatio:e,project_uFocalDistance:L,project_uCommonUnitsPerMeter:M.unitsPerMeter,project_uCommonUnitsPerWorldUnit:M.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:iZ,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:cC,project_uCameraPosition:a};if(w){const q=t.getDistanceScales(w);switch(n){case $n.METER_OFFSETS:U.project_uCommonUnitsPerWorldUnit=q.unitsPerMeter,U.project_uCommonUnitsPerWorldUnit2=q.unitsPerMeter2;break;case $n.LNGLAT:case $n.LNGLAT_OFFSETS:t._pseudoMeters||(U.project_uCommonUnitsPerMeter=q.unitsPerMeter),U.project_uCommonUnitsPerWorldUnit=q.unitsPerDegree,U.project_uCommonUnitsPerWorldUnit2=q.unitsPerDegree2;break;case $n.CARTESIAN:U.project_uCommonUnitsPerWorldUnit=[1,1,q.unitsPerMeter[2]],U.project_uCommonUnitsPerWorldUnit2=[0,0,q.unitsPerMeter2[2]];break}}return U}const lZ={};function cZ(t=lZ){return"viewport"in t?oZ(t):{}}const P8={name:"project",dependencies:[MW,Qq],vs:eZ,getUniforms:cZ};function uZ(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function n1(t,e){const n=B1([],e,t);return T8(n,n,1/n[3]),n}function jv(t,e){const n=t%e;return n<0?e+n:n}function hZ(t,e,n){return n*e+(1-n)*t}function _g(t,e,n){return t<e?e:t>n?n:t}function fZ(t){return Math.log(t)*Math.LOG2E}const M8=Math.log2||fZ;function a0(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Aa=Math.PI,fC=Aa/4,Vo=Aa/180,yg=180/Aa,x1=512,qp=4003e4,od=85.051129,AZ=1.5;function Hv(t){return Math.pow(2,t)}function AC(t){return M8(t)}function tl(t){const[e,n]=t;a0(Number.isFinite(e)),a0(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=e*Vo,r=n*Vo,s=x1*(i+Aa)/(2*Aa),u=x1*(Aa+Math.log(Math.tan(fC+r*.5)))/(2*Aa);return[s,u]}function pu(t){const[e,n]=t,i=e/x1*(2*Aa)-Aa,r=2*(Math.atan(Math.exp(n/x1*(2*Aa)-Aa))-fC);return[i*yg,r*yg]}function dZ(t){const{latitude:e}=t;a0(Number.isFinite(e));const n=Math.cos(e*Vo);return AC(qp*n)-9}function I4(t){const e=Math.cos(t*Vo);return x1/qp/e}function vg(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;a0(Number.isFinite(e)&&Number.isFinite(n));const r=x1,s=Math.cos(e*Vo),u=r/360,a=u/s,y=r/qp/s,w={unitsPerMeter:[y,y,y],metersPerUnit:[1/y,1/y,1/y],unitsPerDegree:[u,a,y],degreesPerUnit:[1/u,1/a,1/y]};if(i){const M=Vo*Math.tan(e*Vo)/s,R=u*M/2,L=r/qp*M,U=L/a*y;w.unitsPerDegree2=[0,R,L],w.unitsPerMeter2=[U,0,U]}return w}function dC(t,e){const[n,i,r]=t,[s,u,a]=e,{unitsPerMeter:y,unitsPerMeter2:w}=vg({longitude:n,latitude:i,highPrecision:!0}),M=tl(t);M[0]+=s*(y[0]+w[0]*u),M[1]+=u*(y[1]+w[1]*u);const R=pu(M),L=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[R[0],R[1],L]:R}function pZ(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:s,center:u}=t,a=uZ();Wp(a,a,[0,0,-r]),XS(a,a,-n*Vo),QS(a,a,i*Vo);const y=s/e;return E8(a,a,[y,y,y]),u&&Wp(a,a,QW([],u)),a}function mZ(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:s,center:u,scale:a,nearZMultiplier:y=1,farZMultiplier:w=1}=t;let{fovy:M=Zp(AZ)}=t;i!==void 0&&(M=Zp(i));const R=M*Vo,L=r*Vo,U=pC(M);let q=U;u&&(q+=u[2]*a/Math.cos(L)/n);const te=R*(.5+(s?s[1]:0)/n),pe=Math.sin(te)*q/Math.sin(_g(Math.PI/2-L-te,.01,Math.PI-.01)),ne=Math.sin(L)*pe+q,ie=q*10,re=Math.min(ne*w,ie);return{fov:R,aspect:e/n,focalDistance:U,near:y,far:re}}function Zp(t){return 2*Math.atan(.5/t)*yg}function pC(t){return .5/Math.tan(.5*t*Vo)}function mC(t,e){const[n,i,r=0]=t;return a0(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),n1(e,[n,i,r,1])}function I8(t,e,n=0){const[i,r,s]=t;if(a0(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return n1(e,[i,r,s,1]);const u=n1(e,[i,r,0,1]),a=n1(e,[i,r,1,1]),y=u[2],w=a[2],M=y===w?0:((n||0)-y)/(w-y);return NS([],u,a,M)}function gZ(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:s=24,offset:u=[0,0]}=t,[[a,y],[w,M]]=i,R=_Z(t.padding),L=tl([a,_g(M,-od,od)]),U=tl([w,_g(y,-od,od)]),q=[Math.max(Math.abs(U[0]-L[0]),r),Math.max(Math.abs(U[1]-L[1]),r)],te=[e-R.left-R.right-Math.abs(u[0])*2,n-R.top-R.bottom-Math.abs(u[1])*2];a0(te[0]>0&&te[1]>0);const pe=te[0]/q[0],ne=te[1]/q[1],ie=(R.right-R.left)/2/pe,re=(R.top-R.bottom)/2/ne,_e=[(U[0]+L[0])/2+ie,(U[1]+L[1])/2+re],Te=pu(_e),De=Math.min(s,M8(Math.abs(Math.min(pe,ne))));return a0(Number.isFinite(De)),{longitude:Te[0],latitude:Te[1],zoom:De}}function _Z(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(a0(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const Wv=Math.PI/180;function yZ(t,e=0){const{width:n,height:i,unproject:r}=t,s={targetZ:e},u=r([0,i],s),a=r([n,i],s);let y,w;const M=t.fovy?.5*t.fovy*Wv:Math.atan(.5/t.altitude),R=(90-t.pitch)*Wv;return M>R-.01?(y=$v(t,0,e),w=$v(t,n,e)):(y=r([0,0],s),w=r([n,0],s)),[u,a,w,y]}function $v(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=n1(i,[e,0,1,1]),s=n1(i,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2]),y=NS([],r,s,a),w=pu(y);return w.push(n),w}const qv=512;function vZ(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:s,zoom:u,bearing:a=0}=t;(r<-180||r>180)&&(r=jv(r+180,360)-180),(a<-180||a>180)&&(a=jv(a+180,360)-180);const y=M8(n/qv);if(u<=y)u=y,s=0;else{const w=n/2/Math.pow(2,u),M=pu([0,w])[1];if(s<M)s=M;else{const R=pu([0,qv-w])[1];s>R&&(s=R)}}return{width:e,height:n,longitude:r,latitude:s,zoom:u,pitch:i,bearing:a}}const gC=.01,xZ=["longitude","latitude","zoom"],_C={curve:1.414,speed:1.2};function wZ(t,e,n,i){const{startZoom:r,startCenterXY:s,uDelta:u,w0:a,u1:y,S:w,rho:M,rho2:R,r0:L}=yC(t,e,i);if(y<gC){const _e={};for(const Te of xZ){const De=t[Te],$e=e[Te];_e[Te]=hZ(De,$e,n)}return _e}const U=n*w,q=Math.cosh(L)/Math.cosh(L+M*U),te=a*((Math.cosh(L)*Math.tanh(L+M*U)-Math.sinh(L))/R)/y,pe=1/q,ne=r+AC(pe),ie=FW([],u,te);Ag(ie,ie,s);const re=pu(ie);return{longitude:re[0],latitude:re[1],zoom:ne}}function bZ(t,e,n){const i={..._C,...n},{screenSpeed:r,speed:s,maxDuration:u}=i,{S:a,rho:y}=yC(t,e,i),w=1e3*a;let M;return Number.isFinite(r)?M=w/(r/y):M=w/s,Number.isFinite(u)&&M>u?0:M}function yC(t,e,n){n=Object.assign({},_C,n);const i=n.curve,r=t.zoom,s=[t.longitude,t.latitude],u=Hv(r),a=e.zoom,y=[e.longitude,e.latitude],w=Hv(a-r),M=tl(s),R=tl(y),L=jW([],R,M),U=Math.max(t.width,t.height),q=U/w,te=NW(L)*u,pe=Math.max(te,gC),ne=i*i,ie=(q*q-U*U+ne*ne*pe*pe)/(2*U*ne*pe),re=(q*q-U*U-ne*ne*pe*pe)/(2*q*ne*pe),_e=Math.log(Math.sqrt(ie*ie+1)-ie),Te=Math.log(Math.sqrt(re*re+1)-re),De=(Te-_e)/i;return{startZoom:r,startCenterXY:M,uDelta:L,w0:U,u1:te,S:De,rho:i,rho2:ne,r0:_e,r1:Te}}const EZ=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,TZ=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,SZ=X2(kZ),CZ=X2(LZ),PZ=[0,0,0,1],MZ=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function IZ(t,e){const[n,i,r]=t,s=I8([n,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}function kZ({viewport:t,center:e}){return new Ws(t.viewProjectionMatrix).invert().transform(e)}function LZ({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,s=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(u=>IZ(u,i));for(const u of e){const a=u.clone().translate(new qt(t.center).negate()),y=s.map(M=>a.transform(M)),w=new Ws().ortho({left:Math.min(...y.map(M=>M[0])),right:Math.max(...y.map(M=>M[0])),bottom:Math.min(...y.map(M=>M[1])),top:Math.max(...y.map(M=>M[1])),near:Math.min(...y.map(M=>-M[2])),far:Math.max(...y.map(M=>-M[2]))});n.push(w.multiplyRight(u))}return n}function DZ(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||PZ,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=SZ({viewport:t.viewport,center:e.project_uCenter}),s=[],u=CZ({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const y=u[a],w=y.clone().translate(new qt(t.viewport.center).negate());e.project_uCoordinateSystem===$n.LNGLAT&&e.project_uProjectionMode===fa.WEB_MERCATOR?(u[a]=w,s[a]=r):(u[a]=y.clone().multiplyRight(MZ),s[a]=w.transform(r))}for(let a=0;a<u.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=u[a],i["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:i["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return i}const k4={name:"shadow",dependencies:[P8],vs:EZ,fs:TZ,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?DZ(t,e):{}},RZ={color:[255,255,255],intensity:1},Zv=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],zZ=[0,0,0,200/255];class k8{constructor(e={}){Z(this,"id","lighting-effect"),Z(this,"props",void 0),Z(this,"shadowColor",zZ),Z(this,"shadow",void 0),Z(this,"ambientLight",void 0),Z(this,"directionalLights",void 0),Z(this,"pointLights",void 0),Z(this,"shadowPasses",[]),Z(this,"shadowMaps",[]),Z(this,"dummyShadowMap",null),Z(this,"programManager",void 0),Z(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const i=e[n];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:u}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Z2.getDefaultProgramManager(e),k4&&this.programManager.addDefaultModule(k4)),this.dummyShadowMap||(this.dummyShadowMap=new $s(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:u,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(k4),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const i=new Ws().lookAt({eye:new qt(n.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const i=new qq(e);this.shadowPasses[n]=i,this.shadowMaps[n]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:i}=this;!e&&n.length===0&&i.length===0&&(this.ambientLight=new oC(RZ),this.directionalLights.push(new gg(Zv[0]),new gg(Zv[1])))}}class BZ{constructor(e={}){Z(this,"_pool",[]),Z(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:i=1,type:r,padding:s=0,copy:u=!1,initialize:a=!1,maxCount:y}){const w=r||e&&e.constructor||Float32Array,M=n*i+s;if(ArrayBuffer.isView(e)){if(M<=e.length)return e;if(M*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new w(e.buffer,0,M)}let R=1/0;y&&(R=y*i+s);const L=this._allocate(w,M,a,R);return e&&u?L.set(e):a||L.fill(0,0,4),this._release(e),L}release(e){this._release(e)}_allocate(e,n,i,r){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>r&&(s=r);const u=this._pool,a=e.BYTES_PER_ELEMENT*s,y=u.findIndex(w=>w.byteLength>=a);if(y>=0){const w=new e(u.splice(y,1)[0],0,s);return i&&w.fill(0),w}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:i}=e,{byteLength:r}=i,s=n.findIndex(u=>u.byteLength>=r);s<0?n.push(i):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,i),n.length>this.opts.poolSize&&n.shift()}}const w1=new BZ;function Nf(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function OZ(t){return[t[12],t[13],t[14]]}function FZ(t){return{left:bh(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:bh(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:bh(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:bh(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:bh(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:bh(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const Xv=new qt;function bh(t,e,n,i){Xv.set(t,e,n);const r=Xv.len();return{distance:i/r,normal:new qt(-t/r,-e/r,-n/r)}}function NZ(t){return t-Math.fround(t)}let Sf;function L4(t,e){const{size:n=1,startIndex:i=0}=e,r=e.endIndex!==void 0?e.endIndex:t.length,s=(r-i)/n;Sf=w1.allocate(Sf,s,{type:Float32Array,size:n*2});let u=i,a=0;for(;u<r;){for(let y=0;y<n;y++){const w=t[u++];Sf[a+y]=w,Sf[a+y+n]=NZ(w)}a+=n*2}return Sf.subarray(0,s*n*2)}function UZ(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}const VZ=Math.PI/180,GZ=Nf(),Qv=[0,0,0],jZ={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function HZ({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:s,near:u,far:a}){const y=t/e,w=n?new Ws().orthographic({fovy:i,aspect:y,focalDistance:r,near:u,far:a}):new Ws().perspective({fovy:i,aspect:y,near:u,far:a});if(s){const{left:M=0,right:R=0,top:L=0,bottom:U=0}=s,q=H0((M+t-R)/2,0,t)-t/2,te=H0((L+e-U)/2,0,e)-e/2;w[8]-=q*2/t,w[9]+=te*2/e}return w}class Su{constructor(e={}){Z(this,"id",void 0),Z(this,"x",void 0),Z(this,"y",void 0),Z(this,"width",void 0),Z(this,"height",void 0),Z(this,"padding",void 0),Z(this,"isGeospatial",void 0),Z(this,"zoom",void 0),Z(this,"focalDistance",void 0),Z(this,"position",void 0),Z(this,"modelMatrix",void 0),Z(this,"distanceScales",void 0),Z(this,"scale",void 0),Z(this,"center",void 0),Z(this,"cameraPosition",void 0),Z(this,"projectionMatrix",void 0),Z(this,"viewMatrix",void 0),Z(this,"viewMatrixUncentered",void 0),Z(this,"viewMatrixInverse",void 0),Z(this,"viewProjectionMatrix",void 0),Z(this,"pixelProjectionMatrix",void 0),Z(this,"pixelUnprojectionMatrix",void 0),Z(this,"resolution",void 0),Z(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||jZ,this.focalDistance=e.focalDistance||1,this.position=e.position||Qv,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?fa.WEB_MERCATOR:fa.WEB_MERCATOR_AUTO_OFFSET:fa.IDENTITY}equals(e){return e instanceof Su?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Xl(e.projectionMatrix,this.projectionMatrix)&&Xl(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const i=this.projectPosition(e),r=mC(i,this.pixelProjectionMatrix),[s,u]=r,a=n?u:this.height-u;return e.length===2?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,u]=e,a=n?s:this.height-s,y=i&&i*this.distanceScales.unitsPerMeter[2],w=I8([r,a,u],this.pixelUnprojectionMatrix,y),[M,R,L]=this.unprojectPosition(w);return Number.isFinite(u)?[M,R,L]:Number.isFinite(i)?[M,R,i]:[M,R]}projectPosition(e){const[n,i]=this.projectFlat(e),r=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,i,r]}unprojectPosition(e){const[n,i]=this.unprojectFlat(e),r=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,i,r]}projectFlat(e){if(this.isGeospatial){const n=tl(e);return n[1]=H0(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?pu(e):e}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,0],n),r=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),u=this.unproject([this.width,this.height],n);return[Math.min(i[0],r[0],s[0],u[0]),Math.min(i[1],r[1],s[1],u[1]),Math.max(i[0],r[0],s[0],u[0]),Math.max(i[1],r[1],s[1],u[1])]}getDistanceScales(e){return e?vg({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,FZ(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=dZ({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||vg({latitude:i,longitude:n}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:u}=e;let a=Qv;if(s&&(a=u?new Ws(u).transformAsVector(s,[]):s),this.isGeospatial){const y=this.projectPosition([n,i,0]);this.center=new qt(a).scale(this.distanceScales.unitsPerMeter).add(y)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=GZ,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:u=75,near:a=.1,far:y=1e3,padding:w=null,focalDistance:M=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Ws().multiplyRight(n).translate(new qt(this.center).negate()),this.projectionMatrix=i||HZ({width:this.width,height:this.height,orthographic:r,fovyRadians:s||u*VZ,focalDistance:M,padding:w,near:a,far:y});const R=Nf();nu(R,R,this.projectionMatrix),nu(R,R,this.viewMatrix),this.viewProjectionMatrix=R,this.viewMatrixInverse=pg([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=OZ(this.viewMatrixInverse);const L=Nf(),U=Nf();E8(L,L,[this.width/2,-this.height/2,1]),Wp(L,L,[1,-1,0]),nu(U,L,this.viewProjectionMatrix),this.pixelProjectionMatrix=U,this.pixelUnprojectionMatrix=pg(Nf(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Hn.warn("Pixel project matrix not invertible")()}}Z(Su,"displayName","Viewport");class lc extends Su{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,pitch:s=0,bearing:u=0,nearZMultiplier:a=.1,farZMultiplier:y=1.01,nearZ:w,farZ:M,orthographic:R=!1,projectionMatrix:L,repeat:U=!1,worldOffset:q=0,position:te,padding:pe,legacyMeterSizes:ne=!1}=e;let{width:ie,height:re,altitude:_e=1.5}=e;const Te=Math.pow(2,r);ie=ie||1,re=re||1;let De,$e=null;if(L)_e=L[5]/2,De=Zp(_e);else{e.fovy?(De=e.fovy,_e=pC(De)):De=Zp(_e);let ut;if(pe){const{top:st=0,bottom:lt=0}=pe;ut=[0,H0((st+re-lt)/2,0,re)-re/2]}$e=mZ({width:ie,height:re,scale:Te,center:te&&[0,0,te[2]*I4(n)],offset:ut,pitch:s,fovy:De,nearZMultiplier:a,farZMultiplier:y}),Number.isFinite(w)&&($e.near=w),Number.isFinite(M)&&($e.far=M)}let nt=pZ({height:re,pitch:s,bearing:u,scale:Te,altitude:_e});q&&(nt=new Ws().translate([512*q,0,0]).multiplyLeft(nt)),super({...e,width:ie,height:re,viewMatrix:nt,longitude:i,latitude:n,zoom:r,...$e,fovy:De,focalDistance:_e}),Z(this,"longitude",void 0),Z(this,"latitude",void 0),Z(this,"pitch",void 0),Z(this,"bearing",void 0),Z(this,"altitude",void 0),Z(this,"fovy",void 0),Z(this,"orthographic",void 0),Z(this,"_subViewports",void 0),Z(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=s,this.bearing=u,this.altitude=_e,this.fovy=De,this.orthographic=R,this._subViewports=U?[]:null,this._pseudoMeters=ne,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=n;r<=i;r++){const s=r?new lc({...this,worldOffset:r}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,i]=this.projectFlat(e),r=(e[2]||0)*I4(e[1]);return[n,i,r]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,i]=this.unprojectFlat(e),r=(e[2]||0)/I4(i);return[n,i,r]}addMetersToLngLat(e,n){return dC(e,n)}panByPosition(e,n){const i=I8(n,this.pixelUnprojectionMatrix),r=this.projectFlat(e),s=Ag([],r,UW([],i)),u=Ag([],this.center,s),[a,y]=this.unprojectFlat(u);return{longitude:a,latitude:y}}getBounds(e={}){const n=yZ(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:i,height:r}=this,{longitude:s,latitude:u,zoom:a}=gZ({width:i,height:r,bounds:e,...n});return new lc({width:i,height:r,longitude:s,latitude:u,zoom:a})}}Z(lc,"displayName","WebMercatorViewport");const Yv=[0,0,0];function D4(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof lc){const[r,s,u=0]=t,a=e.getDistanceScales([r,s]);i[2]=u*a.unitsPerMeter[2]}return i}function WZ(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:u}=t;return r===$n.DEFAULT&&(r=e.isGeospatial?$n.LNGLAT:$n.CARTESIAN),s===void 0&&(s=r),u===void 0&&(u=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:u}}function vC(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[u,a,y=0]=t;switch(n&&([u,a,y]=B1([],[u,a,y,1],n)),i){case $n.LNGLAT:return D4([u,a,y],e,s);case $n.LNGLAT_OFFSETS:return D4([u+r[0],a+r[1],y+(r[2]||0)],e,s);case $n.METER_OFFSETS:return D4(dC(r,[u,a,y]),e,s);case $n.CARTESIAN:default:return e.isGeospatial?[u+r[0],a+r[1],y+r[2]]:e.projectPosition([u,a,y])}}function $Z(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:u,fromCoordinateOrigin:a}=WZ(e),{autoOffset:y=!0}=e,{geospatialOrigin:w=Yv,shaderCoordinateOrigin:M=Yv,offsetMode:R=!1}=y?hC(n,i,r):{},L=vC(t,{viewport:n,modelMatrix:s,coordinateSystem:u,coordinateOrigin:a,offsetMode:R});if(R){const U=n.projectPosition(w||M);$S(L,L,U)}return L}const mu=Math.PI/180,qZ=1e3*60*60*24,ZZ=2440588,XZ=2451545,Xp=mu*23.4397,QZ=357.5291,YZ=.98560028,KZ=280.147,JZ=360.9856235;function eX(t,e,n){const i=mu*-n,r=mu*e,s=nX(t),u=uX(s),a=aX(s,i)-u.rightAscension;return{azimuth:sX(a,r,u.declination),altitude:oX(a,r,u.declination)}}function Kv(t,e,n){const{azimuth:i,altitude:r}=eX(t,e,n);return[Math.sin(i)*Math.cos(r),Math.cos(i)*Math.cos(r),-Math.sin(r)]}function tX(t){return(typeof t=="number"?t:t.getTime())/qZ-.5+ZZ}function nX(t){return tX(t)-XZ}function iX(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(Xp)-Math.tan(e)*Math.sin(Xp),Math.cos(n))}function rX(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(Xp)+Math.cos(e)*Math.sin(Xp)*Math.sin(n))}function sX(t,e,n){const i=t,r=e,s=n;return Math.atan2(Math.sin(i),Math.cos(i)*Math.sin(r)-Math.tan(s)*Math.cos(r))}function oX(t,e,n){const i=t,r=e,s=n;return Math.asin(Math.sin(r)*Math.sin(s)+Math.cos(r)*Math.cos(s)*Math.cos(i))}function aX(t,e){return mu*(KZ+JZ*t)-e}function lX(t){return mu*(QZ+YZ*t)}function cX(t){const e=t,n=mu*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),i=mu*102.9372;return e+n+i+Math.PI}function uX(t){const e=lX(t),n=cX(e);return{declination:rX(n,0),rightAscension:iX(n,0)}}class hX extends gg{constructor(e){super(e),Z(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[r,s,u]=Kv(this.timestamp,0,0);this.direction=[r,-u,s]}else{const{latitude:r,longitude:s}=n;this.direction=Kv(this.timestamp,r,s)}return this}}const Jv={blendFunc:[1,0,32771,0],blendEquation:32774};class xC extends C8{constructor(...e){super(...e),Z(this,"pickZ",void 0),Z(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,pickingFBO:u,deviceRect:{x:a,y,width:w,height:M},cullRect:R,effects:L,pass:U="picking",pickZ:q,moduleParameters:te}){const pe=this.gl;this.pickZ=q;const ne=this._resetColorEncoder(q),ie=ga(pe,{scissorTest:!0,scissor:[a,y,w,M],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Jv,blend:!q},()=>super.render({target:u,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,cullRect:R,effects:L?.filter(_e=>_e.useInPicking),pass:U,isPicking:!0,moduleParameters:te}));return this._colorEncoderState=null,{decodePickingColor:ne&&AX.bind(null,ne),stats:ie}}shouldDrawLayer(e){const{pickable:n,operation:i}=e.props;return n&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,i){const r={...e.props.parameters},{pickable:s,operation:u}=e.props;return this._colorEncoderState?s&&u.includes("draw")&&(Object.assign(r,Jv),r.blend=!0,r.blendColor=fX(this._colorEncoderState,e,i)):r.blend=!1,u.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function fX(t,e,n){const{byLayer:i,byAlpha:r}=t;let s,u=i.get(e);return u?(u.viewports.push(n),s=u.a):(s=i.size+1,s<=255?(u={a:s,layer:e,viewports:[n]},i.set(e,u),r[s]=u):(Hn.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function AX(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Th={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Qp=Symbol.for("component"),nc=Symbol.for("propTypes"),R4=Symbol.for("deprecatedProps"),i1=Symbol.for("asyncPropDefaults"),gu=Symbol.for("asyncPropOriginal"),W0=Symbol.for("asyncPropResolved");function L3(t,e=()=>!0){return Array.isArray(t)?wC(t,e,[]):e(t)?[t]:[]}function wC(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?wC(r,e,n):e(r)&&n.push(r)}return n}function dX({target:t,source:e,start:n=0,count:i=1}){const r=e.length,s=i*r;let u=0;for(let a=n;u<r;u++)t[a++]=e[u];for(;u<s;)u<s-u?(t.copyWithin(n+u,n,n+u),u*=2):(t.copyWithin(n+u,n,n+s-u),u=s);return t}function ex(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class tx{constructor(e,n){Z(this,"name",void 0),Z(this,"type",void 0),Z(this,"sampleSize",1),Z(this,"time",void 0),Z(this,"count",void 0),Z(this,"samples",void 0),Z(this,"lastTiming",void 0),Z(this,"lastSampleTime",void 0),Z(this,"lastSampleCount",void 0),Z(this,"_count",0),Z(this,"_time",0),Z(this,"_samples",0),Z(this,"_startTime",0),Z(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=ex(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(ex()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class bC{constructor(e){Z(this,"id",void 0),Z(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof tx?this.stats[n]=e:this.stats[n]=new tx(n,i)),this.stats[n]}}class pX{constructor(e,n,i){Z(this,"id",void 0),Z(this,"context",void 0),Z(this,"isLoaded",void 0),Z(this,"persistent",void 0),Z(this,"_loadCount",0),Z(this,"_subscribers",new Set),Z(this,"_data",void 0),Z(this,"_loader",void 0),Z(this,"_error",void 0),Z(this,"_content",void 0),this.id=e,this.context=i,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const i=++this._loadCount;let r=e;typeof e=="string"&&(r=Fp(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class mX{constructor({gl:e,protocol:n}){Z(this,"protocol",void 0),Z(this,"_context",void 0),Z(this,"_resources",void 0),Z(this,"_consumers",void 0),Z(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(n,i):(s=new pX(e,n,this._context),this._resources[e]=s),s.persistent=r}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const i in n){const r=n[i],s=this._resources[r.resourceId];s&&s.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:u}=this;e.startsWith(u)&&(e=e.replace(u,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,i,r){const s=this._consumers,u=s[e]=s[e]||{},a=u[n]||{},y=a.resourceId&&this._resources[a.resourceId];y&&(y.unsubscribe(a),this.prune()),i&&(u[n]=a,a.onChange=r,a.resourceId=i.id,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const gX=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Cu={name:"project32",dependencies:[P8],vs:gX},Pu={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...lq},_X=[P8],yX=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function vX(t){const e=Z2.getDefaultProgramManager(t);for(const n of _X)e.addDefaultModule(n);for(const n of yX)e.addShaderHook(n);return e}const xX="layerManager.setLayers",wX="layerManager.activateViewport";class bX{constructor(e,{deck:n,stats:i,viewport:r,timeline:s}={}){Z(this,"layers",void 0),Z(this,"context",void 0),Z(this,"resourceManager",void 0),Z(this,"_lastRenderedLayers",[]),Z(this,"_needsRedraw",!1),Z(this,"_needsUpdate",!1),Z(this,"_nextLayers",null),Z(this,"_debug",!1),Z(this,"activateViewport",u=>{rs(wX,this,u),u&&(this.context.viewport=u)}),this.layers=[],this.resourceManager=new mX({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&vX(e),stats:i||new bC({id:"deck.gl"}),viewport:r||new Su({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new sC,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);n=n||r}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(i=>n.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){rs(xX,this,n,e),this._lastRenderedLayers=e;const i=L3(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,i){i.raiseError(n,"".concat(e," of ").concat(i))}_updateLayers(e,n){const i={};for(const u of e)i[u.id]?Hn.warn("Multiple old layers with same id ".concat(u.id))():i[u.id]=u;const r=[];this._updateSublayersRecursively(n,i,r),this._finalizeOldLayers(i);let s=!1;for(const u of r)if(u.hasUniformTransition()){s="Uniform transition in ".concat(u);break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,n,i){for(const r of e){r.context=this.context;const s=n[r.id];s===null&&Hn.warn("Multiple new layers with same id ".concat(r.id))(),n[r.id]=null;let u=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),u=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}u&&this._updateSublayersRecursively(u,n,i)}}_finalizeOldLayers(e){for(const n in e){const i=e[n];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Th.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Th.MATCHED,n!==e&&(e.lifecycle=Th.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Th.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Th.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Qa(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!Qa(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const s of i)if(!e.hasOwnProperty(s)||!Qa(t[s],e[s],n-1))return!1;return!0}return!1}class EX{constructor(e){Z(this,"width",void 0),Z(this,"height",void 0),Z(this,"views",void 0),Z(this,"viewState",void 0),Z(this,"controllers",void 0),Z(this,"timeline",void 0),Z(this,"_viewports",void 0),Z(this,"_viewportMap",void 0),Z(this,"_isUpdating",void 0),Z(this,"_needsRedraw",void 0),Z(this,"_needsUpdate",void 0),Z(this,"_eventManager",void 0),Z(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,i=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,n){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const u=i[s];if(u.containsPixel(r)){const a=e.slice();return a[0]-=u.x,a[1]-=u.y,u.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=L3(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Qa(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Hn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const i=n.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var u;return(u=this.getView(e.id))===null||u===void 0?void 0:u.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,i,r){const s=e.controller;if(s&&i){const u={...n,...s,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!r||r.constructor!==s.type)&&(r=this._createController(e,u)),r&&r.setProps(u),r}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const s=e[r],u=this.getViewState(s),a=s.makeViewport({viewState:u,width:this.width,height:this.height});let y=n[s.id];const w=!!s.controller;w&&!y&&(i=!0),(i||!w)&&y&&(y.finalize(),y=null),this.controllers[s.id]=this._updateController(s,u,a,y),a&&this._viewports.unshift(a)}for(const r in n){const s=n[r];s&&!this.controllers[r]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((i,r)=>!e[r].equals(n[r]))}}const TX=/([0-9]+\.?[0-9]*)(%|px)/;function R0(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=TX.exec(t);if(e&&e.length>=3){const n=e[2]==="%",i=parseFloat(e[1]);return{position:n?i/100:i,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function z0(t,e){return t.relative?Math.round(t.position*e):t.position}function Mr(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class b1{constructor(e){Z(this,"id",void 0),Z(this,"viewportInstance",void 0),Z(this,"_x",void 0),Z(this,"_y",void 0),Z(this,"_width",void 0),Z(this,"_height",void 0),Z(this,"_padding",void 0),Z(this,"props",void 0);const{id:n,x:i=0,y:r=0,width:s="100%",height:u="100%",padding:a=null,viewportInstance:y}=e||{};Mr(!y||y instanceof Su),this.viewportInstance=y,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=R0(i),this._y=R0(r),this._width=R0(s),this._height=R0(u),this._padding=a&&{left:R0(a.left||0),right:R0(a.right||0),top:R0(a.top||0),bottom:R0(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Qa(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return!r.height||!r.width?null:new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const i in this.props.viewState)i!=="id"&&(n[i]=this.props.viewState[i]);return n}return e}getDimensions({width:e,height:n}){const i={x:z0(this._x,e),y:z0(this._y,n),width:z0(this._width,e),height:z0(this._height,n)};return this._padding&&(i.padding={left:z0(this._padding.left,e),top:z0(this._padding.top,n),right:z0(this._padding.right,e),bottom:z0(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Q2{constructor(e){Z(this,"_inProgress",void 0),Z(this,"_handle",void 0),Z(this,"_timeline",void 0),Z(this,"time",void 0),Z(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,i;this.cancel(),this.settings=e,this._inProgress=!0,(n=(i=this.settings).onStart)===null||n===void 0||n.call(i,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const nx=()=>{},xg={BREAK:1,SNAP_TO_END:2,IGNORE:3},SX=t=>t,CX=xg.BREAK;class PX{constructor(e){Z(this,"getControllerState",void 0),Z(this,"props",void 0),Z(this,"propsInTransition",void 0),Z(this,"transition",void 0),Z(this,"onViewStateChange",void 0),Z(this,"onStateChange",void 0),Z(this,"_onTransitionUpdate",n=>{const{time:i,settings:{interpolator:r,startProps:s,endProps:u,duration:a,easing:y}}=n,w=y(i/a),M=r.interpolateProps(s,u,w);this.propsInTransition=this.getControllerState({...this.props,...M}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Q2(e.timeline),this.onViewStateChange=e.onViewStateChange||nx,this.onStateChange=e.onStateChange||nx}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:s,endProps:u}=this.transition.settings;r={...i,...s===xg.SNAP_TO_END?u:this.propsInTransition||i}}this._triggerTransition(r,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:i}=e;return(n>0||n==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===xg.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const i=this.getControllerState(e),r=this.getControllerState(n).shortestPathFrom(i),s=n.transitionInterpolator,u=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(u===0)return;const a=s.initializeProps(e,r);this.propsInTransition={};const y={duration:u,easing:n.transitionEasing||SX,interpolator:s,interruption:n.transitionInterruption||CX,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(y),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class EC{constructor(e){Z(this,"_propsToCompare",void 0),Z(this,"_propsToExtract",void 0),Z(this,"_requiredProps",void 0);const{compare:n,extract:i,required:r}=e;this._propsToCompare=n,this._propsToExtract=i||n,this._requiredProps=r}arePropsEqual(e,n){for(const i of this._propsToCompare)if(!(i in e)||!(i in n)||!Xl(e[i],n[i]))return!1;return!0}initializeProps(e,n){const i={},r={};for(const s of this._propsToExtract)(s in e||s in n)&&(i[s]=e[s],r[s]=n[s]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const i=e[n];Mr(Number.isFinite(i)||Array.isArray(i),"".concat(n," is required for transition"))})}}const MX=["longitude","latitude","zoom","bearing","pitch"],IX=["longitude","latitude","zoom"];class TC extends EC{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:MX,required:IX},super(i.transitionProps),Z(this,"opts",void 0),this.opts=i}initializeProps(e,n){const i=super.initializeProps(e,n),{makeViewport:r,around:s}=this.opts;if(r&&s){const u=r(e),a=r(n),y=u.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(y),aroundPosition:y,width:n.width,height:n.height})}return i}interpolateProps(e,n,i){const r={};for(const s of this._propsToExtract)r[s]=el(e[s]||0,n[s]||0,i);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...r});Object.assign(r,s.panByPosition(n.aroundPosition,el(e.around,n.around,i)))}return r}}const B0={transitionDuration:0},kX=300,ad=t=>1-(1-t)*(1-t),Eh={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Gc={};class LX{constructor(e){Z(this,"props",void 0),Z(this,"state",{}),Z(this,"transitionManager",void 0),Z(this,"eventManager",void 0),Z(this,"onViewStateChange",void 0),Z(this,"onStateChange",void 0),Z(this,"makeViewport",void 0),Z(this,"_controllerState",void 0),Z(this,"_events",{}),Z(this,"_interactionState",{isDragging:!1}),Z(this,"_customEvents",[]),Z(this,"_eventStartBlocked",null),Z(this,"_panMove",!1),Z(this,"invertPan",!1),Z(this,"dragMode","rotate"),Z(this,"inertia",0),Z(this,"scrollZoom",!0),Z(this,"dragPan",!0),Z(this,"dragRotate",!0),Z(this,"doubleClickZoom",!0),Z(this,"touchZoom",!0),Z(this,"touchRotate",!1),Z(this,"keyboard",!0),this.transitionManager=new PX({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:i}=this.props,{offsetCenter:r}=e;return[r.x-n,r.y-i]}isPointInBounds(e,n){const{width:i,height:r}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?kX:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:u=!0,touchZoom:a=!0,touchRotate:y=!1,keyboard:w=!0}=e,M=!!this.onViewStateChange;this.toggleEvents(Eh.WHEEL,M&&i),this.toggleEvents(Eh.PAN,M),this.toggleEvents(Eh.PINCH,M&&(a||y)),this.toggleEvents(Eh.TRIPLE_PAN,M&&y),this.toggleEvents(Eh.DOUBLE_TAP,M&&u),this.toggleEvents(Eh.KEYBOARD,M&&w),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=u,this.touchZoom=a,this.touchRotate=y,this.keyboard=w}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(i=>{this._events[i]!==n&&(this._events[i]=n,n?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,n=null,i={}){const r={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const u=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:u})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:n});return this._panMove=i,this.updateViewport(r,B0,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),i=this.controllerState.pan({pos:n});return this.updateViewport(i,B0,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ad},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),i=this.controllerState.rotate({pos:n});return this.updateViewport(i,B0,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ad},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:i=.01,smooth:r=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let u=2/(1+Math.exp(-Math.abs(s*i)));s<0&&u!==0&&(u=1/u);const a=this.controllerState.zoom({pos:n,scale:u});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.rotateStart({pos:n});return this.updateViewport(i,B0,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const i=this.controllerState.rotate({pos:n});return this.updateViewport(i,B0,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ad},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Gc._startPinchRotation=e.rotation,Gc._lastPinchEvent=e,this.updateViewport(i,B0,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);n=n.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;n=n.rotate({deltaAngleX:Gc._startPinchRotation-i})}return this.updateViewport(n,B0,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Gc._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:i}=Gc;if(this.touchZoom&&n&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const u=Math.log2(e.scale),a=(u-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),y=Math.pow(2,u+a*n/2);s=s.zoom({pos:r,scale:y}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:r}),transitionDuration:n,transitionEasing:ad},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Gc._startPinchRotation=null,Gc._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:n,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:u}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let y;const w={};switch(e.srcEvent.code){case"Minus":y=n?a.zoomOut(i).zoomOut(i):a.zoomOut(i),w.isZooming=!0;break;case"Equal":y=n?a.zoomIn(i).zoomIn(i):a.zoomIn(i),w.isZooming=!0;break;case"ArrowLeft":n?(y=a.rotateLeft(s),w.isRotating=!0):(y=a.moveLeft(r),w.isPanning=!0);break;case"ArrowRight":n?(y=a.rotateRight(s),w.isRotating=!0):(y=a.moveRight(r),w.isPanning=!0);break;case"ArrowUp":n?(y=a.rotateUp(u),w.isRotating=!0):(y=a.moveUp(r),w.isPanning=!0);break;case"ArrowDown":n?(y=a.rotateDown(u),w.isRotating=!0):(y=a.moveDown(r),w.isPanning=!0);break;default:return!1}return this.updateViewport(y,this._getTransitionProps(),w),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?B0:e?{...n,transitionInterpolator:new TC({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class DX{constructor(e,n){Z(this,"_viewportProps",void 0),Z(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const ix=5,RX=1.2;class zX extends DX{constructor(e){const{width:n,height:i,latitude:r,longitude:s,zoom:u,bearing:a=0,pitch:y=0,altitude:w=1.5,position:M=[0,0,0],maxZoom:R=20,minZoom:L=0,maxPitch:U=60,minPitch:q=0,startPanLngLat:te,startZoomLngLat:pe,startRotatePos:ne,startBearing:ie,startPitch:re,startZoom:_e,normalize:Te=!0}=e;Mr(Number.isFinite(s)),Mr(Number.isFinite(r)),Mr(Number.isFinite(u)),super({width:n,height:i,latitude:r,longitude:s,zoom:u,bearing:a,pitch:y,altitude:w,maxZoom:R,minZoom:L,maxPitch:U,minPitch:q,normalize:Te,position:M},{startPanLngLat:te,startZoomLngLat:pe,startRotatePos:ne,startBearing:ie,startPitch:re,startZoom:_e}),Z(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:u}=this.getState();if(!r||s===void 0||u===void 0)return this;let a;return e?a=this._getNewRotation(e,r,u,s):a={bearing:s+n,pitch:u+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomLngLat:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:u,minZoom:a}=this.getViewportProps();let y=r+Math.log2(i);y=H0(y,a,u);const w=this.makeViewport({...this.getViewportProps(),zoom:y});return this._getUpdatedState({zoom:y,...w.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:s}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-n.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=H0(r,i,n);const{maxPitch:s,minPitch:u,pitch:a}=e;e.pitch=H0(a,u,s);const{normalize:y=!0}=e;return y&&Object.assign(e,vZ(e)),e}_zoomFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.zoom({pos:[n/2,i/2],scale:e})}_panFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.pan({startPos:[n/2,i/2],pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,i,r){const s=e[0]-n[0],u=e[1]-n[1],a=e[1],y=n[1],{width:w,height:M}=this.getViewportProps(),R=s/w;let L=0;u>0?Math.abs(M-y)>ix&&(L=u/(y-M)*RX):u<0&&y>ix&&(L=1-a/y),L=H0(L,-1,1);const{minPitch:U,maxPitch:q}=this.getViewportProps(),te=r+180*R;let pe=i;return L>0?pe=i+L*(q-i):L<0&&(pe=i-L*(U-i)),{pitch:pe,bearing:te}}}class BX extends LX{constructor(...e){super(...e),Z(this,"ControllerState",zX),Z(this,"transition",{transitionDuration:300,transitionInterpolator:new TC({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),Z(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class SC extends b1{get ViewportType(){return lc}get ControllerType(){return BX}}Z(SC,"displayName","MapView");const OX=new k8;function FX(t,e){var n,i;const r=(n=t.order)!==null&&n!==void 0?n:1/0,s=(i=e.order)!==null&&i!==void 0?i:1/0;return r-s}class NX{constructor(){Z(this,"effects",void 0),Z(this,"_resolvedEffects",[]),Z(this,"_defaultEffects",[]),Z(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(i=>i.id===e.id)){const i=n.findIndex(r=>FX(r,e)>0);i<0?n.push(e):n.splice(i,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Qa(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const r of this.effects)n[r.id]=r;const i=[];for(const r of e){const s=n[r.id];s&&s!==r?s.setProps?(s.setProps(r.props),i.push(s)):(s.cleanup(),i.push(r)):i.push(r),delete n[r.id]}for(const r in n)n[r].cleanup();this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(r=>r instanceof k8)||this._resolvedEffects.push(OX),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class UX extends C8{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const VX="deckRenderer.renderLayers";class GX{constructor(e){Z(this,"gl",void 0),Z(this,"layerFilter",void 0),Z(this,"drawPickingColors",void 0),Z(this,"drawLayersPass",void 0),Z(this,"pickLayersPass",void 0),Z(this,"renderCount",void 0),Z(this,"_needsRedraw",void 0),Z(this,"renderBuffers",void 0),Z(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new UX(e),this.pickLayersPass=new xC(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||vr.getDefaultFramebuffer(this.gl)};i.effects&&this._preRender(i.effects,i);const r=this.lastPostProcessEffect?this.renderBuffers[0]:i.target,s=n.render({...i,target:r});i.effects&&this._postRender(i.effects,i),this.renderCount++,rs(VX,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const i of e)n.preRenderStats[i.id]=i.preRender(this.gl,n),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new vr(this.gl),new vr(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:i}=this,r={...n,inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){r.target=n.target,s.postRender(this.gl,r);break}const u=s.postRender(this.gl,r);r.inputBuffer=u,r.swapBuffer=u===i[0]?i[1]:i[0]}}}const jX={pickedColor:null,pickedObjectIndex:-1};function HX({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:s}){const{x:u,y:a,width:y,height:w}=s;let M=r*r,R=-1,L=0;for(let U=0;U<w;U++){const q=U+a-i,te=q*q;if(te>M)L+=4*y;else for(let pe=0;pe<y;pe++){if(t[L+3]-1>=0){const ie=pe+u-n,re=ie*ie+te;re<=M&&(M=re,R=L)}L+=4}}if(R>=0){const U=t.slice(R,R+4),q=e(U);if(q){const te=Math.floor(R/4/y),pe=R/4-te*y;return{...q,pickedColor:U,pickedX:u+pe,pickedY:a+te}}Hn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return jX}function WX({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const s=t.slice(i,i+4),u=s.join(",");if(!n.has(u)){const a=e(s);a?n.set(u,{...a,color:s}):Hn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function CC({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:s}){let u=e[0];e.length>1&&(u=qX(t?.pickedViewports||e,{x:i,y:r}));let a;if(u){const y=[i-u.x,r-u.y];s!==void 0&&(y[2]=s),a=u.unproject(y)}return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function $X(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:s,pickedLayer:u,pickedObjectIndex:a}=e,y=u?[u]:[];if(i==="hover"){const R=n.index,L=n.layerId,U=u?u.props.id:null;if(U!==L||a!==R){if(U!==L){const q=r.find(te=>te.props.id===L);q&&y.unshift(q)}n.layerId=U,n.index=a,n.info=null}}const w=CC(t),M=new Map;return M.set(null,w),y.forEach(R=>{let L={...w};R===u&&(L.color=s,L.index=a,L.picked=!0),L=PC({layer:R,info:L,mode:i});const U=L.layer;R===u&&i==="hover"&&(n.info=L),M.set(U.id,L),i==="hover"&&U.updateAutoHighlight(L)}),M}function PC({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function qX(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}class ZX{constructor(e){Z(this,"gl",void 0),Z(this,"pickingFBO",void 0),Z(this,"depthFBO",void 0),Z(this,"pickLayersPass",void 0),Z(this,"layerFilter",void 0),Z(this,"lastPickedInfo",void 0),Z(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new xC(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:i,viewports:r},s=this.lastPickedInfo.info){const u=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,y=u?i.find(L=>L.id===u):null,w=a&&r.find(L=>L.id===a)||r[0],M=w&&w.unproject([e-w.x,n-w.y]);return{...s,...{x:e,y:n,viewport:w,coordinate:M,layer:y}}}_resizeBuffer(){var e,n;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new vr(i),vr.isSupported(i,{colorBufferFloat:!0}))){const r=new vr(i);r.attach({36064:new $s(i,{format:qn(i)?34836:6408,type:5126})}),this.depthFBO=r}(e=this.pickingFBO)===null||e===void 0||e.resize({width:i.canvas.width,height:i.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:i,x:r,y:s,radius:u=0,depth:a=1,mode:y="query",unproject3D:w,onViewportActive:M,effects:R}){const L=this._getPickable(e),U=_1(this.gl);if(!L)return{result:[],emptyInfo:CC({viewports:i,x:r,y:s,pixelRatio:U})};this._resizeBuffer();const q=p4(this.gl,[r,s],!0),te=[q.x+Math.floor(q.width/2),q.y+Math.floor(q.height/2)],pe=Math.round(u*U),{width:ne,height:ie}=this.pickingFBO,re=this._getPickingRect({deviceX:te[0],deviceY:te[1],deviceRadius:pe,deviceWidth:ne,deviceHeight:ie}),_e={x:r-u,y:s-u,width:u*2+1,height:u*2+1};let Te;const De=[],$e=new Set;for(let nt=0;nt<a;nt++){let ut;if(re){const lt=this._drawAndSample({layers:L,views:n,viewports:i,onViewportActive:M,deviceRect:re,cullRect:_e,effects:R,pass:"picking:".concat(y)});ut=HX({...lt,deviceX:te[0],deviceY:te[1],deviceRadius:pe,deviceRect:re})}else ut={pickedColor:null,pickedObjectIndex:-1};let st;if(ut.pickedLayer&&w&&this.depthFBO){const{pickedColors:lt}=this._drawAndSample({layers:[ut.pickedLayer],views:n,viewports:i,onViewportActive:M,deviceRect:{x:ut.pickedX,y:ut.pickedY,width:1,height:1},cullRect:_e,effects:R,pass:"picking:".concat(y,":z")},!0);lt[3]&&(st=lt[0])}ut.pickedLayer&&nt+1<a&&($e.add(ut.pickedLayer),ut.pickedLayer.disablePickingIndex(ut.pickedObjectIndex)),Te=$X({pickInfo:ut,lastPickedInfo:this.lastPickedInfo,mode:y,layers:L,viewports:i,x:r,y:s,z:st,pixelRatio:U});for(const lt of Te.values())lt.layer&&De.push(lt);if(!ut.pickedColor)break}for(const nt of $e)nt.restorePickingColors();return{result:De,emptyInfo:Te.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:i,x:r,y:s,width:u=1,height:a=1,mode:y="query",maxObjects:w=null,onViewportActive:M,effects:R}){const L=this._getPickable(e);if(!L)return[];this._resizeBuffer();const U=_1(this.gl),q=p4(this.gl,[r,s],!0),te=q.x,pe=q.y+q.height,ne=p4(this.gl,[r+u,s+a],!0),ie=ne.x+ne.width,re=ne.y,_e={x:te,y:re,width:ie-te,height:pe-re},Te=this._drawAndSample({layers:L,views:n,viewports:i,onViewportActive:M,deviceRect:_e,cullRect:{x:r,y:s,width:u,height:a},effects:R,pass:"picking:".concat(y)}),De=WX(Te),$e=new Map,nt=Number.isFinite(w);for(let ut=0;ut<De.length&&!(nt&&w&&$e.size>=w);ut++){const st=De[ut];let lt={color:st.pickedColor,layer:null,index:st.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:U};lt=PC({layer:st.pickedLayer,info:lt,mode:y}),$e.has(lt.object)||$e.set(lt.object,lt)}return Array.from($e.values())}_drawAndSample({layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:s,cullRect:u,effects:a,pass:y},w=!1){const M=w?this.depthFBO:this.pickingFBO,R={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:M,deviceRect:s,cullRect:u,effects:a,pass:y,pickZ:w,preRenderStats:{}};for(const ie of a)ie.useInPicking&&(R.preRenderStats[ie.id]=ie.preRender(this.gl,R));const{decodePickingColor:L}=this.pickLayersPass.render(R),{x:U,y:q,width:te,height:pe}=s,ne=new(w?Float32Array:Uint8Array)(te*pe*4);return k3(M,{sourceX:U,sourceY:q,sourceWidth:te,sourceHeight:pe,target:ne}),{pickedColors:ne,decodePickingColor:L}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const u=Math.max(0,e-i),a=Math.max(0,n-i),y=Math.min(r,e+i+1)-u,w=Math.min(s,n+i+1)-a;return y<=0||w<=0?null:{x:u,y:a,width:y,height:w}}}const XX={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class QX{constructor(e){Z(this,"el",null),Z(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,XX),n.appendChild(this.el))}setTooltip(e,n,i){const r=this.el;if(r){if(typeof e=="string")r.innerText=e;else if(e)e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className);else{this.isVisible=!1,r.style.display="none";return}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(n,"px, ").concat(i,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(r.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var MC={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,i,r){var s=["","webkit","Moz","MS","ms","o"],u=n.createElement("div"),a="function",y=Math.round,w=Math.abs,M=Date.now;function R(ue,me,Ie){return setTimeout(re(ue,Ie),me)}function L(ue,me,Ie){return Array.isArray(ue)?(U(ue,Ie[me],Ie),!0):!1}function U(ue,me,Ie){var Xe;if(ue)if(ue.forEach)ue.forEach(me,Ie);else if(ue.length!==r)for(Xe=0;Xe<ue.length;)me.call(Ie,ue[Xe],Xe,ue),Xe++;else for(Xe in ue)ue.hasOwnProperty(Xe)&&me.call(Ie,ue[Xe],Xe,ue)}function q(ue,me,Ie){var Xe="DEPRECATED METHOD: "+me+`
`+Ie+` AT 
`;return function(){var pt=new Error("get-stack-trace"),Nt=pt&&pt.stack?pt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",vn=e.console&&(e.console.warn||e.console.log);return vn&&vn.call(e.console,Xe,Nt),ue.apply(this,arguments)}}var te;typeof Object.assign!="function"?te=function(me){if(me===r||me===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ie=Object(me),Xe=1;Xe<arguments.length;Xe++){var pt=arguments[Xe];if(pt!==r&&pt!==null)for(var Nt in pt)pt.hasOwnProperty(Nt)&&(Ie[Nt]=pt[Nt])}return Ie}:te=Object.assign;var pe=q(function(me,Ie,Xe){for(var pt=Object.keys(Ie),Nt=0;Nt<pt.length;)(!Xe||Xe&&me[pt[Nt]]===r)&&(me[pt[Nt]]=Ie[pt[Nt]]),Nt++;return me},"extend","Use `assign`."),ne=q(function(me,Ie){return pe(me,Ie,!0)},"merge","Use `assign`.");function ie(ue,me,Ie){var Xe=me.prototype,pt;pt=ue.prototype=Object.create(Xe),pt.constructor=ue,pt._super=Xe,Ie&&te(pt,Ie)}function re(ue,me){return function(){return ue.apply(me,arguments)}}function _e(ue,me){return typeof ue==a?ue.apply(me&&me[0]||r,me):ue}function Te(ue,me){return ue===r?me:ue}function De(ue,me,Ie){U(st(me),function(Xe){ue.addEventListener(Xe,Ie,!1)})}function $e(ue,me,Ie){U(st(me),function(Xe){ue.removeEventListener(Xe,Ie,!1)})}function nt(ue,me){for(;ue;){if(ue==me)return!0;ue=ue.parentNode}return!1}function ut(ue,me){return ue.indexOf(me)>-1}function st(ue){return ue.trim().split(/\s+/g)}function lt(ue,me,Ie){if(ue.indexOf&&!Ie)return ue.indexOf(me);for(var Xe=0;Xe<ue.length;){if(Ie&&ue[Xe][Ie]==me||!Ie&&ue[Xe]===me)return Xe;Xe++}return-1}function Lt(ue){return Array.prototype.slice.call(ue,0)}function ht(ue,me,Ie){for(var Xe=[],pt=[],Nt=0;Nt<ue.length;){var vn=me?ue[Nt][me]:ue[Nt];lt(pt,vn)<0&&Xe.push(ue[Nt]),pt[Nt]=vn,Nt++}return Ie&&(me?Xe=Xe.sort(function(xn,Mi){return xn[me]>Mi[me]}):Xe=Xe.sort()),Xe}function Tt(ue,me){for(var Ie,Xe,pt=me[0].toUpperCase()+me.slice(1),Nt=0;Nt<s.length;){if(Ie=s[Nt],Xe=Ie?Ie+pt:me,Xe in ue)return Xe;Nt++}return r}var Pn=1;function Ft(){return Pn++}function Zn(ue){var me=ue.ownerDocument||ue;return me.defaultView||me.parentWindow||e}var yt=/mobile|tablet|ip(ad|hone|od)|android/i,Ot="ontouchstart"in e,Jt=Tt(e,"PointerEvent")!==r,In=Ot&&yt.test(navigator.userAgent),Tn="touch",Di="pen",di="mouse",ii="kinect",hi=25,On=1,vi=2,mt=4,Yt=8,mn=1,dt=2,Fn=4,Rn=8,ri=16,Qn=dt|Fn,si=Rn|ri,hr=Qn|si,kn=["x","y"],fr=["clientX","clientY"];function Yn(ue,me){var Ie=this;this.manager=ue,this.callback=me,this.element=ue.element,this.target=ue.options.inputTarget,this.domHandler=function(Xe){_e(ue.options.enable,[ue])&&Ie.handler(Xe)},this.init()}Yn.prototype={handler:function(){},init:function(){this.evEl&&De(this.element,this.evEl,this.domHandler),this.evTarget&&De(this.target,this.evTarget,this.domHandler),this.evWin&&De(Zn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&$e(this.element,this.evEl,this.domHandler),this.evTarget&&$e(this.target,this.evTarget,this.domHandler),this.evWin&&$e(Zn(this.element),this.evWin,this.domHandler)}};function Wr(ue){var me,Ie=ue.options.inputClass;return Ie?me=Ie:Jt?me=At:In?me=Rr:Ot?me=Y:me=An,new me(ue,vo)}function vo(ue,me,Ie){var Xe=Ie.pointers.length,pt=Ie.changedPointers.length,Nt=me&On&&Xe-pt===0,vn=me&(mt|Yt)&&Xe-pt===0;Ie.isFirst=!!Nt,Ie.isFinal=!!vn,Nt&&(ue.session={}),Ie.eventType=me,rr(ue,Ie),ue.emit("hammer.input",Ie),ue.recognize(Ie),ue.session.prevInput=Ie}function rr(ue,me){var Ie=ue.session,Xe=me.pointers,pt=Xe.length;Ie.firstInput||(Ie.firstInput=$r(me)),pt>1&&!Ie.firstMultiple?Ie.firstMultiple=$r(me):pt===1&&(Ie.firstMultiple=!1);var Nt=Ie.firstInput,vn=Ie.firstMultiple,pi=vn?vn.center:Nt.center,xn=me.center=et(Xe);me.timeStamp=M(),me.deltaTime=me.timeStamp-Nt.timeStamp,me.angle=Sn(pi,xn),me.distance=sr(pi,xn),Lr(Ie,me),me.offsetDirection=Ms(me.deltaX,me.deltaY);var Mi=xt(me.deltaTime,me.deltaX,me.deltaY);me.overallVelocityX=Mi.x,me.overallVelocityY=Mi.y,me.overallVelocity=w(Mi.x)>w(Mi.y)?Mi.x:Mi.y,me.scale=vn?Ar(vn.pointers,Xe):1,me.rotation=vn?wr(vn.pointers,Xe):0,me.maxPointers=Ie.prevInput?me.pointers.length>Ie.prevInput.maxPointers?me.pointers.length:Ie.prevInput.maxPointers:me.pointers.length,xo(Ie,me);var zn=ue.element;nt(me.srcEvent.target,zn)&&(zn=me.srcEvent.target),me.target=zn}function Lr(ue,me){var Ie=me.center,Xe=ue.offsetDelta||{},pt=ue.prevDelta||{},Nt=ue.prevInput||{};(me.eventType===On||Nt.eventType===mt)&&(pt=ue.prevDelta={x:Nt.deltaX||0,y:Nt.deltaY||0},Xe=ue.offsetDelta={x:Ie.x,y:Ie.y}),me.deltaX=pt.x+(Ie.x-Xe.x),me.deltaY=pt.y+(Ie.y-Xe.y)}function xo(ue,me){var Ie=ue.lastInterval||me,Xe=me.timeStamp-Ie.timeStamp,pt,Nt,vn,pi;if(me.eventType!=Yt&&(Xe>hi||Ie.velocity===r)){var xn=me.deltaX-Ie.deltaX,Mi=me.deltaY-Ie.deltaY,zn=xt(Xe,xn,Mi);Nt=zn.x,vn=zn.y,pt=w(zn.x)>w(zn.y)?zn.x:zn.y,pi=Ms(xn,Mi),ue.lastInterval=me}else pt=Ie.velocity,Nt=Ie.velocityX,vn=Ie.velocityY,pi=Ie.direction;me.velocity=pt,me.velocityX=Nt,me.velocityY=vn,me.direction=pi}function $r(ue){for(var me=[],Ie=0;Ie<ue.pointers.length;)me[Ie]={clientX:y(ue.pointers[Ie].clientX),clientY:y(ue.pointers[Ie].clientY)},Ie++;return{timeStamp:M(),pointers:me,center:et(me),deltaX:ue.deltaX,deltaY:ue.deltaY}}function et(ue){var me=ue.length;if(me===1)return{x:y(ue[0].clientX),y:y(ue[0].clientY)};for(var Ie=0,Xe=0,pt=0;pt<me;)Ie+=ue[pt].clientX,Xe+=ue[pt].clientY,pt++;return{x:y(Ie/me),y:y(Xe/me)}}function xt(ue,me,Ie){return{x:me/ue||0,y:Ie/ue||0}}function Ms(ue,me){return ue===me?mn:w(ue)>=w(me)?ue<0?dt:Fn:me<0?Rn:ri}function sr(ue,me,Ie){Ie||(Ie=kn);var Xe=me[Ie[0]]-ue[Ie[0]],pt=me[Ie[1]]-ue[Ie[1]];return Math.sqrt(Xe*Xe+pt*pt)}function Sn(ue,me,Ie){Ie||(Ie=kn);var Xe=me[Ie[0]]-ue[Ie[0]],pt=me[Ie[1]]-ue[Ie[1]];return Math.atan2(pt,Xe)*180/Math.PI}function wr(ue,me){return Sn(me[1],me[0],fr)+Sn(ue[1],ue[0],fr)}function Ar(ue,me){return sr(me[0],me[1],fr)/sr(ue[0],ue[1],fr)}var dr={mousedown:On,mousemove:vi,mouseup:mt},us="mousedown",wt="mousemove mouseup";function An(){this.evEl=us,this.evWin=wt,this.pressed=!1,Yn.apply(this,arguments)}ie(An,Yn,{handler:function(me){var Ie=dr[me.type];Ie&On&&me.button===0&&(this.pressed=!0),Ie&vi&&me.which!==1&&(Ie=mt),this.pressed&&(Ie&mt&&(this.pressed=!1),this.callback(this.manager,Ie,{pointers:[me],changedPointers:[me],pointerType:di,srcEvent:me}))}});var fn={pointerdown:On,pointermove:vi,pointerup:mt,pointercancel:Yt,pointerout:Yt},Pi={2:Tn,3:Di,4:di,5:ii},hs="pointerdown",cn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(hs="MSPointerDown",cn="MSPointerMove MSPointerUp MSPointerCancel");function At(){this.evEl=hs,this.evWin=cn,Yn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ie(At,Yn,{handler:function(me){var Ie=this.store,Xe=!1,pt=me.type.toLowerCase().replace("ms",""),Nt=fn[pt],vn=Pi[me.pointerType]||me.pointerType,pi=vn==Tn,xn=lt(Ie,me.pointerId,"pointerId");Nt&On&&(me.button===0||pi)?xn<0&&(Ie.push(me),xn=Ie.length-1):Nt&(mt|Yt)&&(Xe=!0),!(xn<0)&&(Ie[xn]=me,this.callback(this.manager,Nt,{pointers:Ie,changedPointers:[me],pointerType:vn,srcEvent:me}),Xe&&Ie.splice(xn,1))}});var Ri={touchstart:On,touchmove:vi,touchend:mt,touchcancel:Yt},qs="touchstart",xi="touchstart touchmove touchend touchcancel";function Hi(){this.evTarget=qs,this.evWin=xi,this.started=!1,Yn.apply(this,arguments)}ie(Hi,Yn,{handler:function(me){var Ie=Ri[me.type];if(Ie===On&&(this.started=!0),!!this.started){var Xe=Nn.call(this,me,Ie);Ie&(mt|Yt)&&Xe[0].length-Xe[1].length===0&&(this.started=!1),this.callback(this.manager,Ie,{pointers:Xe[0],changedPointers:Xe[1],pointerType:Tn,srcEvent:me})}}});function Nn(ue,me){var Ie=Lt(ue.touches),Xe=Lt(ue.changedTouches);return me&(mt|Yt)&&(Ie=ht(Ie.concat(Xe),"identifier",!0)),[Ie,Xe]}var Zs={touchstart:On,touchmove:vi,touchend:mt,touchcancel:Yt},Dr="touchstart touchmove touchend touchcancel";function Rr(){this.evTarget=Dr,this.targetIds={},Yn.apply(this,arguments)}ie(Rr,Yn,{handler:function(me){var Ie=Zs[me.type],Xe=qr.call(this,me,Ie);Xe&&this.callback(this.manager,Ie,{pointers:Xe[0],changedPointers:Xe[1],pointerType:Tn,srcEvent:me})}});function qr(ue,me){var Ie=Lt(ue.touches),Xe=this.targetIds;if(me&(On|vi)&&Ie.length===1)return Xe[Ie[0].identifier]=!0,[Ie,Ie];var pt,Nt,vn=Lt(ue.changedTouches),pi=[],xn=this.target;if(Nt=Ie.filter(function(Mi){return nt(Mi.target,xn)}),me===On)for(pt=0;pt<Nt.length;)Xe[Nt[pt].identifier]=!0,pt++;for(pt=0;pt<vn.length;)Xe[vn[pt].identifier]&&pi.push(vn[pt]),me&(mt|Yt)&&delete Xe[vn[pt].identifier],pt++;if(pi.length)return[ht(Nt.concat(pi),"identifier",!0),pi]}var Is=2500,or=25;function Y(){Yn.apply(this,arguments);var ue=re(this.handler,this);this.touch=new Rr(this.manager,ue),this.mouse=new An(this.manager,ue),this.primaryTouch=null,this.lastTouches=[]}ie(Y,Yn,{handler:function(me,Ie,Xe){var pt=Xe.pointerType==Tn,Nt=Xe.pointerType==di;if(!(Nt&&Xe.sourceCapabilities&&Xe.sourceCapabilities.firesTouchEvents)){if(pt)V.call(this,Ie,Xe);else if(Nt&&oe.call(this,Xe))return;this.callback(me,Ie,Xe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function V(ue,me){ue&On?(this.primaryTouch=me.changedPointers[0].identifier,X.call(this,me)):ue&(mt|Yt)&&X.call(this,me)}function X(ue){var me=ue.changedPointers[0];if(me.identifier===this.primaryTouch){var Ie={x:me.clientX,y:me.clientY};this.lastTouches.push(Ie);var Xe=this.lastTouches,pt=function(){var Nt=Xe.indexOf(Ie);Nt>-1&&Xe.splice(Nt,1)};setTimeout(pt,Is)}}function oe(ue){for(var me=ue.srcEvent.clientX,Ie=ue.srcEvent.clientY,Xe=0;Xe<this.lastTouches.length;Xe++){var pt=this.lastTouches[Xe],Nt=Math.abs(me-pt.x),vn=Math.abs(Ie-pt.y);if(Nt<=or&&vn<=or)return!0}return!1}var f=Tt(u.style,"touchAction"),W=f!==r,ke="compute",Ce="auto",be="manipulation",Me="none",Ne="pan-x",it="pan-y",Ue=St();function ct(ue,me){this.manager=ue,this.set(me)}ct.prototype={set:function(ue){ue==ke&&(ue=this.compute()),W&&this.manager.element.style&&Ue[ue]&&(this.manager.element.style[f]=ue),this.actions=ue.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ue=[];return U(this.manager.recognizers,function(me){_e(me.options.enable,[me])&&(ue=ue.concat(me.getTouchAction()))}),It(ue.join(" "))},preventDefaults:function(ue){var me=ue.srcEvent,Ie=ue.offsetDirection;if(this.manager.session.prevented){me.preventDefault();return}var Xe=this.actions,pt=ut(Xe,Me)&&!Ue[Me],Nt=ut(Xe,it)&&!Ue[it],vn=ut(Xe,Ne)&&!Ue[Ne];if(pt){var pi=ue.pointers.length===1,xn=ue.distance<2,Mi=ue.deltaTime<250;if(pi&&xn&&Mi)return}if(!(vn&&Nt)&&(pt||Nt&&Ie&Qn||vn&&Ie&si))return this.preventSrc(me)},preventSrc:function(ue){this.manager.session.prevented=!0,ue.preventDefault()}};function It(ue){if(ut(ue,Me))return Me;var me=ut(ue,Ne),Ie=ut(ue,it);return me&&Ie?Me:me||Ie?me?Ne:it:ut(ue,be)?be:Ce}function St(){if(!W)return!1;var ue={},me=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ie){ue[Ie]=me?e.CSS.supports("touch-action",Ie):!0}),ue}var Zt=1,Vt=2,sn=4,Wt=8,Xt=Wt,yn=16,Mn=32;function Un(ue){this.options=te({},this.defaults,ue||{}),this.id=Ft(),this.manager=null,this.options.enable=Te(this.options.enable,!0),this.state=Zt,this.simultaneous={},this.requireFail=[]}Un.prototype={defaults:{},set:function(ue){return te(this.options,ue),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ue){if(L(ue,"recognizeWith",this))return this;var me=this.simultaneous;return ue=en(ue,this),me[ue.id]||(me[ue.id]=ue,ue.recognizeWith(this)),this},dropRecognizeWith:function(ue){return L(ue,"dropRecognizeWith",this)?this:(ue=en(ue,this),delete this.simultaneous[ue.id],this)},requireFailure:function(ue){if(L(ue,"requireFailure",this))return this;var me=this.requireFail;return ue=en(ue,this),lt(me,ue)===-1&&(me.push(ue),ue.requireFailure(this)),this},dropRequireFailure:function(ue){if(L(ue,"dropRequireFailure",this))return this;ue=en(ue,this);var me=lt(this.requireFail,ue);return me>-1&&this.requireFail.splice(me,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ue){return!!this.simultaneous[ue.id]},emit:function(ue){var me=this,Ie=this.state;function Xe(pt){me.manager.emit(pt,ue)}Ie<Wt&&Xe(me.options.event+Ut(Ie)),Xe(me.options.event),ue.additionalEvent&&Xe(ue.additionalEvent),Ie>=Wt&&Xe(me.options.event+Ut(Ie))},tryEmit:function(ue){if(this.canEmit())return this.emit(ue);this.state=Mn},canEmit:function(){for(var ue=0;ue<this.requireFail.length;){if(!(this.requireFail[ue].state&(Mn|Zt)))return!1;ue++}return!0},recognize:function(ue){var me=te({},ue);if(!_e(this.options.enable,[this,me])){this.reset(),this.state=Mn;return}this.state&(Xt|yn|Mn)&&(this.state=Zt),this.state=this.process(me),this.state&(Vt|sn|Wt|yn)&&this.tryEmit(me)},process:function(ue){},getTouchAction:function(){},reset:function(){}};function Ut(ue){return ue&yn?"cancel":ue&Wt?"end":ue&sn?"move":ue&Vt?"start":""}function ge(ue){return ue==ri?"down":ue==Rn?"up":ue==dt?"left":ue==Fn?"right":""}function en(ue,me){var Ie=me.manager;return Ie?Ie.get(ue):ue}function Wi(){Un.apply(this,arguments)}ie(Wi,Un,{defaults:{pointers:1},attrTest:function(ue){var me=this.options.pointers;return me===0||ue.pointers.length===me},process:function(ue){var me=this.state,Ie=ue.eventType,Xe=me&(Vt|sn),pt=this.attrTest(ue);return Xe&&(Ie&Yt||!pt)?me|yn:Xe||pt?Ie&mt?me|Wt:me&Vt?me|sn:Vt:Mn}});function Vn(){Wi.apply(this,arguments),this.pX=null,this.pY=null}ie(Vn,Wi,{defaults:{event:"pan",threshold:10,pointers:1,direction:hr},getTouchAction:function(){var ue=this.options.direction,me=[];return ue&Qn&&me.push(it),ue&si&&me.push(Ne),me},directionTest:function(ue){var me=this.options,Ie=!0,Xe=ue.distance,pt=ue.direction,Nt=ue.deltaX,vn=ue.deltaY;return pt&me.direction||(me.direction&Qn?(pt=Nt===0?mn:Nt<0?dt:Fn,Ie=Nt!=this.pX,Xe=Math.abs(ue.deltaX)):(pt=vn===0?mn:vn<0?Rn:ri,Ie=vn!=this.pY,Xe=Math.abs(ue.deltaY))),ue.direction=pt,Ie&&Xe>me.threshold&&pt&me.direction},attrTest:function(ue){return Wi.prototype.attrTest.call(this,ue)&&(this.state&Vt||!(this.state&Vt)&&this.directionTest(ue))},emit:function(ue){this.pX=ue.deltaX,this.pY=ue.deltaY;var me=ge(ue.direction);me&&(ue.additionalEvent=this.options.event+me),this._super.emit.call(this,ue)}});function Wo(){Wi.apply(this,arguments)}ie(Wo,Wi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Me]},attrTest:function(ue){return this._super.attrTest.call(this,ue)&&(Math.abs(ue.scale-1)>this.options.threshold||this.state&Vt)},emit:function(ue){if(ue.scale!==1){var me=ue.scale<1?"in":"out";ue.additionalEvent=this.options.event+me}this._super.emit.call(this,ue)}});function $o(){Un.apply(this,arguments),this._timer=null,this._input=null}ie($o,Un,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ce]},process:function(ue){var me=this.options,Ie=ue.pointers.length===me.pointers,Xe=ue.distance<me.threshold,pt=ue.deltaTime>me.time;if(this._input=ue,!Xe||!Ie||ue.eventType&(mt|Yt)&&!pt)this.reset();else if(ue.eventType&On)this.reset(),this._timer=R(function(){this.state=Xt,this.tryEmit()},me.time,this);else if(ue.eventType&mt)return Xt;return Mn},reset:function(){clearTimeout(this._timer)},emit:function(ue){this.state===Xt&&(ue&&ue.eventType&mt?this.manager.emit(this.options.event+"up",ue):(this._input.timeStamp=M(),this.manager.emit(this.options.event,this._input)))}});function wa(){Wi.apply(this,arguments)}ie(wa,Wi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Me]},attrTest:function(ue){return this._super.attrTest.call(this,ue)&&(Math.abs(ue.rotation)>this.options.threshold||this.state&Vt)}});function de(){Wi.apply(this,arguments)}ie(de,Wi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Qn|si,pointers:1},getTouchAction:function(){return Vn.prototype.getTouchAction.call(this)},attrTest:function(ue){var me=this.options.direction,Ie;return me&(Qn|si)?Ie=ue.overallVelocity:me&Qn?Ie=ue.overallVelocityX:me&si&&(Ie=ue.overallVelocityY),this._super.attrTest.call(this,ue)&&me&ue.offsetDirection&&ue.distance>this.options.threshold&&ue.maxPointers==this.options.pointers&&w(Ie)>this.options.velocity&&ue.eventType&mt},emit:function(ue){var me=ge(ue.offsetDirection);me&&this.manager.emit(this.options.event+me,ue),this.manager.emit(this.options.event,ue)}});function wo(){Un.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ie(wo,Un,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[be]},process:function(ue){var me=this.options,Ie=ue.pointers.length===me.pointers,Xe=ue.distance<me.threshold,pt=ue.deltaTime<me.time;if(this.reset(),ue.eventType&On&&this.count===0)return this.failTimeout();if(Xe&&pt&&Ie){if(ue.eventType!=mt)return this.failTimeout();var Nt=this.pTime?ue.timeStamp-this.pTime<me.interval:!0,vn=!this.pCenter||sr(this.pCenter,ue.center)<me.posThreshold;this.pTime=ue.timeStamp,this.pCenter=ue.center,!vn||!Nt?this.count=1:this.count+=1,this._input=ue;var pi=this.count%me.taps;if(pi===0)return this.hasRequireFailures()?(this._timer=R(function(){this.state=Xt,this.tryEmit()},me.interval,this),Vt):Xt}return Mn},failTimeout:function(){return this._timer=R(function(){this.state=Mn},this.options.interval,this),Mn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Xt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function fs(ue,me){return me=me||{},me.recognizers=Te(me.recognizers,fs.defaults.preset),new Ta(ue,me)}fs.VERSION="2.0.7",fs.defaults={domEvents:!1,touchAction:ke,enable:!0,inputTarget:null,inputClass:null,preset:[[wa,{enable:!1}],[Wo,{enable:!1},["rotate"]],[de,{direction:Qn}],[Vn,{direction:Qn},["swipe"]],[wo],[wo,{event:"doubletap",taps:2},["tap"]],[$o]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ba=1,Ea=2;function Ta(ue,me){this.options=te({},fs.defaults,me||{}),this.options.inputTarget=this.options.inputTarget||ue,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ue,this.input=Wr(this),this.touchAction=new ct(this,this.options.touchAction),rl(this,!0),U(this.options.recognizers,function(Ie){var Xe=this.add(new Ie[0](Ie[1]));Ie[2]&&Xe.recognizeWith(Ie[2]),Ie[3]&&Xe.requireFailure(Ie[3])},this)}Ta.prototype={set:function(ue){return te(this.options,ue),ue.touchAction&&this.touchAction.update(),ue.inputTarget&&(this.input.destroy(),this.input.target=ue.inputTarget,this.input.init()),this},stop:function(ue){this.session.stopped=ue?Ea:ba},recognize:function(ue){var me=this.session;if(!me.stopped){this.touchAction.preventDefaults(ue);var Ie,Xe=this.recognizers,pt=me.curRecognizer;(!pt||pt&&pt.state&Xt)&&(pt=me.curRecognizer=null);for(var Nt=0;Nt<Xe.length;)Ie=Xe[Nt],me.stopped!==Ea&&(!pt||Ie==pt||Ie.canRecognizeWith(pt))?Ie.recognize(ue):Ie.reset(),!pt&&Ie.state&(Vt|sn|Wt)&&(pt=me.curRecognizer=Ie),Nt++}},get:function(ue){if(ue instanceof Un)return ue;for(var me=this.recognizers,Ie=0;Ie<me.length;Ie++)if(me[Ie].options.event==ue)return me[Ie];return null},add:function(ue){if(L(ue,"add",this))return this;var me=this.get(ue.options.event);return me&&this.remove(me),this.recognizers.push(ue),ue.manager=this,this.touchAction.update(),ue},remove:function(ue){if(L(ue,"remove",this))return this;if(ue=this.get(ue),ue){var me=this.recognizers,Ie=lt(me,ue);Ie!==-1&&(me.splice(Ie,1),this.touchAction.update())}return this},on:function(ue,me){if(ue!==r&&me!==r){var Ie=this.handlers;return U(st(ue),function(Xe){Ie[Xe]=Ie[Xe]||[],Ie[Xe].push(me)}),this}},off:function(ue,me){if(ue!==r){var Ie=this.handlers;return U(st(ue),function(Xe){me?Ie[Xe]&&Ie[Xe].splice(lt(Ie[Xe],me),1):delete Ie[Xe]}),this}},emit:function(ue,me){this.options.domEvents&&sl(ue,me);var Ie=this.handlers[ue]&&this.handlers[ue].slice();if(!(!Ie||!Ie.length)){me.type=ue,me.preventDefault=function(){me.srcEvent.preventDefault()};for(var Xe=0;Xe<Ie.length;)Ie[Xe](me),Xe++}},destroy:function(){this.element&&rl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function rl(ue,me){var Ie=ue.element;if(Ie.style){var Xe;U(ue.options.cssProps,function(pt,Nt){Xe=Tt(Ie.style,Nt),me?(ue.oldCssProps[Xe]=Ie.style[Xe],Ie.style[Xe]=pt):Ie.style[Xe]=ue.oldCssProps[Xe]||""}),me||(ue.oldCssProps={})}}function sl(ue,me){var Ie=n.createEvent("Event");Ie.initEvent(ue,!0,!0),Ie.gesture=me,me.target.dispatchEvent(Ie)}te(fs,{INPUT_START:On,INPUT_MOVE:vi,INPUT_END:mt,INPUT_CANCEL:Yt,STATE_POSSIBLE:Zt,STATE_BEGAN:Vt,STATE_CHANGED:sn,STATE_ENDED:Wt,STATE_RECOGNIZED:Xt,STATE_CANCELLED:yn,STATE_FAILED:Mn,DIRECTION_NONE:mn,DIRECTION_LEFT:dt,DIRECTION_RIGHT:Fn,DIRECTION_UP:Rn,DIRECTION_DOWN:ri,DIRECTION_HORIZONTAL:Qn,DIRECTION_VERTICAL:si,DIRECTION_ALL:hr,Manager:Ta,Input:Yn,TouchAction:ct,TouchInput:Rr,MouseInput:An,PointerEventInput:At,TouchMouseInput:Y,SingleTouchInput:Hi,Recognizer:Un,AttrRecognizer:Wi,Tap:wo,Pan:Vn,Swipe:de,Pinch:Wo,Rotate:wa,Press:$o,on:De,off:$e,each:U,merge:ne,extend:pe,assign:te,inherit:ie,bindFn:re,prefixed:Tt});var ks=typeof e<"u"?e:typeof self<"u"?self:{};ks.Hammer=fs,typeof r=="function"&&r.amd?r(function(){return fs}):t.exports?t.exports=fs:e[i]=fs})(window,document,"Hammer")})(MC);var Y2=MC.exports;const YX=s3(Y2),ja=RI({__proto__:null,default:YX},[Y2]),IC=1,kC=2,wg=4,KX={mousedown:IC,mousemove:kC,mouseup:wg};function JX(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function eQ(t){const e=t.prototype.handler;t.prototype.handler=function(i){const r=this.store;i.button>0&&i.type==="pointerdown"&&(JX(r,s=>s.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}}function tQ(t){t.prototype.handler=function(n){let i=KX[n.type];i&IC&&n.button>=0&&(this.pressed=!0),i&kC&&n.which===0&&(i=wg),this.pressed&&(i&wg&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}eQ(Y2.PointerEventInput);tQ(Y2.MouseInput);const nQ=Y2.Manager;class D3{constructor(e,n,i){this.element=e,this.callback=n,this.options={enable:!0,...i}}}const iQ=ja?[[ja.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[ja.Rotate,{enable:!1}],[ja.Pinch,{enable:!1}],[ja.Swipe,{enable:!1}],[ja.Pan,{threshold:0,enable:!1}],[ja.Press,{enable:!1}],[ja.Tap,{event:"doubletap",taps:2,enable:!1}],[ja.Tap,{event:"anytap",enable:!1}],[ja.Tap,{enable:!1}]]:null,rx={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},rQ={doubletap:["tap"]},sQ={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},L8={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},oQ={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},sx={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},aQ=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Gh=typeof window<"u"?window:global;let bg=!1;try{const t={get passive(){return bg=!0,!0}};Gh.addEventListener("test",null,t),Gh.removeEventListener("test",null)}catch{bg=!1}const lQ=aQ.indexOf("firefox")!==-1,{WHEEL_EVENTS:cQ}=L8,ox="wheel",ax=4.000244140625,uQ=40,hQ=.25;class fQ extends D3{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{if(!this.options.enable)return;let s=r.deltaY;Gh.WheelEvent&&(lQ&&r.deltaMode===Gh.WheelEvent.DOM_DELTA_PIXEL&&(s/=Gh.devicePixelRatio),r.deltaMode===Gh.WheelEvent.DOM_DELTA_LINE&&(s*=uQ)),s!==0&&s%ax===0&&(s=Math.floor(s/ax)),r.shiftKey&&s&&(s=s*hQ),this.callback({type:ox,center:{x:r.clientX,y:r.clientY},delta:-s,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(cQ),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,bg?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===ox&&(this.options.enable=n)}}const{MOUSE_EVENTS:AQ}=L8,lx="pointermove",cx="pointerover",ux="pointerout",hx="pointerenter",fx="pointerleave";class dQ extends D3{constructor(e,n,i){super(e,n,i),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(AQ),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===lx&&(this.enableMoveEvent=n),e===cx&&(this.enableOverEvent=n),e===ux&&(this.enableOutEvent=n),e===hx&&(this.enableEnterEvent=n),e===fx&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(cx,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(ux,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(hx,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(fx,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(lx,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:pQ}=L8,Ax="keydown",dx="keyup";class mQ extends D3{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{const s=r.target||r.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&r.type==="keydown"&&this.callback({type:Ax,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&r.type==="keyup"&&this.callback({type:dx,srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(pQ),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Ax&&(this.enableDownEvent=n),e===dx&&(this.enableUpEvent=n)}}const px="contextmenu";class gQ extends D3{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:px,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===px&&(this.options.enable=n)}}const Eg=1,Yp=2,Tg=4,_Q={pointerdown:Eg,pointermove:Yp,pointerup:Tg,mousedown:Eg,mousemove:Yp,mouseup:Tg},yQ=1,vQ=2,xQ=3,wQ=0,bQ=1,EQ=2,TQ=1,SQ=2,CQ=4;function PQ(t){const e=_Q[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let s=!1,u=!1,a=!1;return e===Tg||e===Yp&&!Number.isFinite(n)?(s=r===yQ,u=r===vQ,a=r===xQ):e===Yp?(s=!!(n&TQ),u=!!(n&CQ),a=!!(n&SQ)):e===Eg&&(s=i===wQ,u=i===bQ,a=i===EQ),{leftButton:s,middleButton:u,rightButton:a}}function MQ(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1,u={x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/s};return{center:n,offsetCenter:u}}const z4={srcElement:"root",priority:0};class IQ{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let r=n.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,i,r=!1,s=!1){const{handlers:u,handlersByElement:a}=this;let y=z4;typeof i=="string"||i&&i.addEventListener?y={...z4,srcElement:i}:i&&(y={...z4,...i});let w=a.get(y.srcElement);w||(w=[],a.set(y.srcElement,w));const M={type:e,handler:n,srcElement:y.srcElement,priority:y.priority};r&&(M.once=!0),s&&(M.passive=!0),u.push(M),this._active=this._active||!M.passive;let R=w.length-1;for(;R>=0&&!(w[R].priority>=M.priority);)R--;w.splice(R+1,0,M)}remove(e,n){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const u=i[s];if(u.type===e&&u.handler===n){i.splice(s,1);const a=r.get(u.srcElement);a.splice(a.indexOf(u),1),a.length===0&&r.delete(u.srcElement)}}this._active=i.some(s=>!s.passive)}_emit(e,n){const i=this.handlersByElement.get(n);if(i){let r=!1;const s=()=>{e.handled=!0},u=()=>{e.handled=!0,r=!0},a=[];for(let y=0;y<i.length;y++){const{type:w,handler:M,once:R}=i[y];if(M({...e,type:w,stopPropagation:s,stopImmediatePropagation:u}),R&&a.push(i[y]),r)break}for(let y=0;y<a.length;y++){const{type:w,handler:M}=a[y];this.remove(w,M)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...PQ(e),...MQ(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const kQ={events:null,recognizers:null,recognizerOptions:{},Manager:nQ,touchAction:"none",tabIndex:0};class LQ{constructor(e=null,n){this._onBasicInput=r=>{const{srcEvent:s}=r,u=sQ[s.type];u&&this.manager.emit(u,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...kQ,...n},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,i=n.Manager;this.manager=new i(e,{touchAction:n.touchAction,recognizers:n.recognizers||iQ}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(rx).forEach(r=>{const s=this.manager.get(r);s&&rx[r].forEach(u=>{s.recognizeWith(u)})});for(const r in n.recognizerOptions){const s=this.manager.get(r);if(s){const u=n.recognizerOptions[r];delete u.enable,s.set(u)}}this.wheelInput=new fQ(e,this._onOtherEvent,{enable:!1}),this.moveInput=new dQ(e,this._onOtherEvent,{enable:!1}),this.keyInput=new mQ(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new gQ(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,i){this._addEventHandler(e,n,i,!1)}once(e,n,i){this._addEventHandler(e,n,i,!0)}watch(e,n,i){this._addEventHandler(e,n,i,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==n){r.set({enable:n});const s=rQ[e];s&&!this.options.recognizers&&s.forEach(u=>{const a=i.get(u);n?(a.requireFailure(e),r.dropRequireFailure(u)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,i,r,s){if(typeof e!="string"){i=n;for(const M in e)this._addEventHandler(M,e[M],i,r,s);return}const{manager:u,events:a}=this,y=sx[e]||e;let w=a.get(y);w||(w=new IQ(this),a.set(y,w),w.recognizerName=oQ[y]||y,u&&u.on(y,w.handleEvent)),w.add(e,n,i,r,s),w.isEmpty()||this._toggleRecognizer(w.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const u in e)this._removeEventHandler(u,e[u]);return}const{events:i}=this,r=sx[e]||e,s=i.get(r);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:u}=s;let a=!1;for(const y of i.values())if(y.recognizerName===u&&!y.isEmpty()){a=!0;break}a||this._toggleRecognizer(u,!1)}}}function jc(){}const DQ=({isDragging:t})=>t?"grabbing":"grab",LC={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:jc,onResize:jc,onViewStateChange:jc,onInteractionStateChange:jc,onBeforeRender:jc,onAfterRender:jc,onLoad:jc,onError:t=>Hn.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:DQ,getTooltip:null,debug:!1,drawPickingColors:!1};class R3{constructor(e){Z(this,"props",void 0),Z(this,"width",0),Z(this,"height",0),Z(this,"userData",{}),Z(this,"canvas",null),Z(this,"viewManager",null),Z(this,"layerManager",null),Z(this,"effectManager",null),Z(this,"deckRenderer",null),Z(this,"deckPicker",null),Z(this,"eventManager",null),Z(this,"tooltip",null),Z(this,"metrics",void 0),Z(this,"animationLoop",void 0),Z(this,"stats",void 0),Z(this,"viewState",void 0),Z(this,"cursorState",void 0),Z(this,"_needsRedraw",void 0),Z(this,"_pickRequest",void 0),Z(this,"_lastPointerDownInfo",null),Z(this,"_metricsCounter",void 0),Z(this,"_onPointerMove",n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const r=n.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n}),Z(this,"_onEvent",n=>{const i=Vy[n.type],r=n.offsetCenter;if(!i||!r||!this.layerManager)return;const s=this.layerManager.getLayers(),u=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:s,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:a}=u,y=a&&(a[i.handler]||a.props[i.handler]),w=this.props[i.handler];let M=!1;y&&(M=y.call(a,u,n)),!M&&w&&w(u,n)}),Z(this,"_onPointerDown",n=>{const i=n.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...LC,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Hn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),fV()==="IE"&&Hn.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new bC({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&w1.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,i,r,s,u,a,y;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(i=this.viewManager)===null||i===void 0||i.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(u=this.deckPicker)===null||u===void 0||u.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(y=this.tooltip)===null||y===void 0||y.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var w;(w=this.canvas.parentElement)===null||w===void 0||w.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Hn.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Hn.removed("onLayerClick","onClick")(),e.initialViewState&&!Qa(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),u=this.deckRenderer.needsRedraw(e);return n=n||i||r||s||u,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Mr(this.viewManager),this.viewManager.views}getViewports(e){return Mr(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,i){Mr(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Mr(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:i}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(i||i===0){var r;const s=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=((r=e.style)===null||r===void 0?void 0:r.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:i}=this;if(!i)return;const r=(e=i.clientWidth)!==null&&e!==void 0?e:i.width,s=(n=i.clientHeight)!==null&&n!==void 0?n:i.height;if(r!==this.width||s!==this.height){var u,a;this.width=r,this.height=s,(u=this.viewManager)===null||u===void 0||u.setProps({width:r,height:s}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:s})}}_createAnimationLoop(e){const{width:n,height:i,gl:r,glOptions:s,debug:u,onError:a,onBeforeRender:y,onAfterRender:w,useDevicePixels:M}=e;return new FH({width:n,height:i,useDevicePixels:M,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:R=>fS({...s,...R,canvas:this.canvas,debug:u,onContextLost:()=>this._onContextLost()}),onInitialize:R=>this._setGLContext(R.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:y,onAfterRender:w,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new SC({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let s=r,u=!1;for(const a of i){var n;s=a,u=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||u}if(!u&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,d8(e,{enable:!0,copyState:!0})),this.tooltip=new QX(this.canvas),s0(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new sC;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new LQ(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in Vy)this.eventManager.on(r,this._onEvent);this.viewManager=new EX({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new bX(e,{deck:this,stats:this.stats,viewport:i,timeline:n}),this.effectManager=new NX,this.deckRenderer=new GX(e),this.deckPicker=new ZX(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:i}=this.layerManager.context;s0(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Hn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const i=Kc.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}Z(R3,"defaultProps",LC);Z(R3,"VERSION",PV);class B4{constructor(e,n){Z(this,"opts",void 0),Z(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:i}=this.source,{size:r}=n;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const u=n.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[u+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function RQ(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function jd(t){return t.stride||t.size*t.bytesPerElement}function DC(t,e){e.offset&&Hn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=jd(t),i=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,r=e.elementOffset||0,s=i*n+r*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function zQ(t,e){const n=DC(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class BQ{constructor(e,n,i){Z(this,"gl",void 0),Z(this,"id",void 0),Z(this,"size",void 0),Z(this,"settings",void 0),Z(this,"value",void 0),Z(this,"doublePrecision",void 0),Z(this,"_buffer",void 0),Z(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const r=n.logicalType||n.type,s=r===5130;let{defaultValue:u}=n;u=Number.isFinite(u)?[u]:u||new Array(this.size).fill(0);let a;s?a=5126:!r&&n.isIndexed?a=e&&bS(e,Si.ELEMENT_INDEX_UINT32)?5125:5123:a=r||5126;let y=RQ(r||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(y=Float32Array),this.value=null,this.settings={...n,defaultType:y,defaultValue:u,logicalType:r,type:a,size:this.size,bytesPerElement:y.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new gi(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*jd(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),w1.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=zQ(this.getAccessor(),n||{});return i[e]=new B4(this,s.high),i["".concat(e,"64Low")]=r?new B4(this,s.low):new Float32Array(this.size),i}if(n){const i=DC(this.getAccessor(),n);return{[e]:new B4(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:i,size:r}=this,s=i*r;if(n&&s&&n.length>=s){const u=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let y=0;y<s;)for(let w=0;w<r;w++){const M=n[y++];M<u[w]&&(u[w]=M),M>a[w]&&(a[w]=M)}e=[u,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof gi?i={buffer:e}:i=e;const r={...this.settings,...i};if(n.bufferAccessor=r,n.bounds=null,i.constant){let s=i.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(i.buffer){const s=i.buffer;n.externalBuffer=s,n.constant=!1,this.value=i.value||null;const u=i.value instanceof Float64Array;r.type=i.type||s.accessor.type,r.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(u?2:1),r.stride=jd(r)}else if(i.value){this._checkExternalBuffer(i);let s=i.value;n.externalBuffer=null,n.constant=!1,this.value=s,r.bytesPerElement=s.BYTES_PER_ELEMENT,r.stride=jd(r);const{buffer:u,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=L4(s,r));const y=s.byteLength+a+r.stride*2;u.byteLength<y&&u.reallocate(y),u.setAccessor(null),u.subData({data:s,offset:a}),r.type=i.type||u.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?L4(n,{size:this.size,startIndex:i,endIndex:r}):n.subarray(i,r),offset:i*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:i}=this,r=i.allocatedValue,s=w1.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:u,byteOffset:a}=this;return u.byteLength<s.byteLength+a&&(u.reallocate(s.byteLength+a),n&&r&&u.subData({data:r instanceof Float64Array?L4(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=n.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Hn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return n[i]=e,n;if(!e){let u=s;for(;--u>=0;)n[i+u]=r[u];return n}switch(s){case 4:n[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:n[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:n[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:n[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let u=s;for(;--u>=0;)n[i+u]=Number.isFinite(e[u])?e[u]:r[u]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==n[r])return!1;return!0}}const mx=[],gx=[];function K2(t,e=0,n=1/0){let i=mx;const r={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?i=t:t.length>0&&(gx.length=t.length,i=gx):i=mx,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function RC(t){return t&&t[Symbol.asyncIterator]}function zC(t,e){const{size:n,stride:i,offset:r,startIndices:s,nested:u}=e,a=t.BYTES_PER_ELEMENT,y=i?i/a:n,w=r?r/a:0,M=Math.floor((t.length-w)/y);return(R,{index:L,target:U})=>{if(!s){const ne=L*y+w;for(let ie=0;ie<n;ie++)U[ie]=t[ne+ie];return U}const q=s[L],te=s[L+1]||M;let pe;if(u){pe=new Array(te-q);for(let ne=q;ne<te;ne++){const ie=ne*y+w;U=new Array(n);for(let re=0;re<n;re++)U[re]=t[ie+re];pe[ne-q]=U}}else if(y===n)pe=t.subarray(q*n+w,te*n+w);else{pe=new t.constructor((te-q)*n);let ne=0;for(let ie=q;ie<te;ie++){const re=ie*y+w;for(let _e=0;_e<n;_e++)pe[ne++]=t[re+_e]}}return pe}}const OQ=[],Hd=[[0,1/0]];function FQ(t,e){if(t===Hd||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],i=t.length;let r=0;for(let s=0;s<i;s++){const u=t[s];u[1]<e[0]?(n.push(u),r=s+1):u[0]>e[1]?n.push(u):e=[Math.min(u[0],e[0]),Math.max(u[1],e[1])]}return n.splice(r,0,e),n}function O4(t){const{source:e,target:n,start:i=0,size:r,getData:s}=t,u=t.end||n.length,a=e.length,y=u-i;if(a>y){n.set(e.subarray(0,y),i);return}if(n.set(e,i),!s)return;let w=a;for(;w<y;){const M=s(w,e);for(let R=0;R<r;R++)n[i+w]=M[R]||0,w++}}function NQ({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return O4({source:t,target:e,size:n,getData:i}),e;let u=0,a=0;const y=i&&((M,R)=>i(M+a,R)),w=Math.min(r.length,s.length);for(let M=1;M<w;M++){const R=r[M]*n,L=s[M]*n;O4({source:t.subarray(u,R),target:e,start:a,end:L,size:n,getData:y}),u=R,a=L}return a<e.length&&O4({source:[],target:e,start:a,size:n,getData:y}),e}const UQ={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function BC(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...UQ[n],...e,...t,type:n}}function OC(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function FC(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function NC(t){t.push(t.shift())}function D8(t,e){const{doublePrecision:n,settings:i,value:r,size:s}=t,u=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*u}function UC({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:s=u=>u}){const u=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*u,y=n.byteOffset,w=n.startIndices,M=r&&w,R=D8(n,e),L=n.isConstant;if(!M&&i>=R)return;const U=L?n.value:n.getBuffer().getData({srcByteOffset:y});if(n.settings.normalized&&!L){const ne=s;s=(ie,re)=>n.normalizeConstant(ne(ie,re))}const q=L?(ne,ie)=>s(U,ie):(ne,ie)=>s(U.subarray(ne,ne+a),ie),te=t.getData({length:i}),pe=new Float32Array(R);NQ({source:te,target:pe,sourceStartIndices:r,targetStartIndices:w,size:a,getData:q}),t.byteLength<pe.byteLength+y&&t.reallocate(pe.byteLength+y),t.subData({data:pe,offset:y})}class R8 extends BQ{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Hd}),Z(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,i=this.settings.transition,r=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return BC(r,i)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:i=0,endRow:r=1/0}=n;this.state.updateRanges=FQ(this.state.updateRanges,[i,r])}else this.state.updateRanges=Hd}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=OQ}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,n.updateRanges!==Hd),!0):!1}updateBuffer({numInstances:e,data:n,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:u,noAlloc:a}}=this;let y=!0;if(u){for(const[w,M]of s)u.call(r,this,{data:n,startRow:w,endRow:M,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[w,M]of s){const R=Number.isFinite(w)?this.getVertexOffset(w):0,L=Number.isFinite(M)?this.getVertexOffset(M):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:R,endOffset:L})}this._checkAttributeArray()}else y=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),y}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const u=e;Mr(ArrayBuffer.isView(u.value),"invalid ".concat(r.accessor));const a=!!u.size&&u.size!==this.size;return i.binaryAccessor=zC(u.value,{size:u.size||this.size,stride:u.stride,offset:u.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const i in e)Object.assign(n,super.getShaderAttributes(i,e[i]));return n}_autoUpdater(e,{data:n,startRow:i,endRow:r,props:s,numInstances:u}){if(e.constant)return;const{settings:a,state:y,value:w,size:M,startIndices:R}=e,{accessor:L,transform:U}=a,q=y.binaryAccessor||(typeof L=="function"?L:s[L]);Mr(typeof q=="function",'accessor "'.concat(L,'" is not a function'));let te=e.getVertexOffset(i);const{iterable:pe,objectInfo:ne}=K2(n,i,r);for(const ie of pe){ne.index++;let re=q(ie,ne);if(U&&(re=U.call(this,re)),R){const _e=(ne.index<R.length-1?R[ne.index+1]:u)-R[ne.index];if(re&&Array.isArray(re[0])){let Te=te;for(const De of re)e._normalizeValue(De,w,Te),Te+=M}else re&&re.length>M?w.set(re,te):(e._normalizeValue(re,ne.target,0),dX({target:w,source:ne.target,start:te,count:_e}));te+=_e*M}else e._normalizeValue(re,w,te),te+=M}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let i=!0;switch(n){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class VQ{constructor({gl:e,attribute:n,timeline:i}){Z(this,"gl",void 0),Z(this,"type","interpolation"),Z(this,"attributeInTransition",void 0),Z(this,"settings",void 0),Z(this,"attribute",void 0),Z(this,"transition",void 0),Z(this,"currentStartIndices",void 0),Z(this,"currentLength",void 0),Z(this,"transform",void 0),Z(this,"buffers",void 0),this.gl=e,this.transition=new Q2(i),this.attribute=n,this.attributeInTransition=new R8(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=jQ(e,n);const r={byteLength:0,usage:35050};this.buffers=[new gi(e,r),new gi(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:i,buffers:r,attribute:s}=this;NC(r);const u={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)UC({buffer:a,...u});this.currentStartIndices=s.startIndices,this.currentLength=D8(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:OC(i,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:i}=this.settings,{time:r}=this.transition;let s=r/n;i&&(s=i(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const GQ=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function jQ(t,e){const n=FC(e.size);return new S8(t,{vs:GQ,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class HQ{constructor({gl:e,attribute:n,timeline:i}){Z(this,"gl",void 0),Z(this,"type","spring"),Z(this,"attributeInTransition",void 0),Z(this,"settings",void 0),Z(this,"attribute",void 0),Z(this,"transition",void 0),Z(this,"currentStartIndices",void 0),Z(this,"currentLength",void 0),Z(this,"texture",void 0),Z(this,"framebuffer",void 0),Z(this,"transform",void 0),Z(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Q2(i),this.attribute=n,this.attributeInTransition=new R8(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=$Q(e),this.framebuffer=qQ(e,this.texture),this.transform=WQ(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new gi(e,r),new gi(e,r),new gi(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:i,buffers:r,attribute:s}=this,u={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)UC({buffer:a,...u});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=D8(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:OC(i,s)}})}update(){const{buffers:e,transform:n,framebuffer:i,transition:r}=this;if(!r.update())return!1;const u=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:u.stiffness,damping:u.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),NC(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),k3(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function WQ(t,e,n){const i=FC(e.size);return new S8(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}function $Q(t){return new $s(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function qQ(t,e){return new vr(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const ZQ={interpolation:VQ,spring:HQ};class XQ{constructor(e,{id:n,timeline:i}){Z(this,"id",void 0),Z(this,"isSupported",void 0),Z(this,"gl",void 0),Z(this,"timeline",void 0),Z(this,"transitions",void 0),Z(this,"needsRedraw",void 0),Z(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=S8.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],u=s.getTransitionSetting(n);u&&this._updateAttribute(r,s,u)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(n))&&this._removeTransition(r)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const i=this.transitions[n];i.inProgress&&(e[n]=i.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported){Hn.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}r&&this._removeTransition(e);const u=ZQ[i.type];u?this.transitions[e]=new u({attribute:n,timeline:this.timeline,gl:this.gl}):(Hn.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const _x="attributeManager.invalidate",QQ="attributeManager.updateStart",YQ="attributeManager.updateEnd",KQ="attribute.updateStart",JQ="attribute.allocate",eY="attribute.updateEnd";class tY{constructor(e,{id:n="attribute-manager",stats:i,timeline:r}={}){Z(this,"id",void 0),Z(this,"gl",void 0),Z(this,"attributes",void 0),Z(this,"updateTriggers",void 0),Z(this,"needsRedraw",void 0),Z(this,"userData",void 0),Z(this,"stats",void 0),Z(this,"attributeTransitionManager",void 0),Z(this,"mergeBoundsMemoized",X2(UZ)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new XQ(e,{id:"".concat(n,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const i=this._invalidateTrigger(e,n);rs(_x,this,e,i)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);rs(_x,this,"all")}update({data:e,numInstances:n,startIndices:i=null,transitions:r,props:s={},buffers:u={},context:a={}}){let y=!1;rs(QQ,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const w in this.attributes){const M=this.attributes[w],R=M.settings.accessor;M.startIndices=i,M.numInstances=n,s[w]&&Hn.removed("props.".concat(w),"data.attributes.".concat(w))(),M.setExternalBuffer(u[w])||M.setBinaryValue(typeof R=="string"?u[R]:void 0,e.startIndices)||typeof R=="string"&&!u[R]&&M.setConstantValue(s[R])||M.needsUpdate()&&(y=!0,this._updateAttribute({attribute:M,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||M.needsRedraw()}y&&rs(YQ,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(i=>{var r;return(r=this.attributes[i])===null||r===void 0?void 0:r.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const s in n){const u=n[s];u.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=u)}return r}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const i={};for(const r in e)n[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,n={}){for(const i in e){const r=e[i];this.attributes[i]=this._createAttribute(i,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,i){const r={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:i.instanced?1:n.divisor||0};return new R8(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(u=>{const a=i[u];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:i}=e;if(rs(KQ,n),n.constant){n.setConstantValue(n.value);return}n.allocate(i)&&rs(JQ,n,i),n.updateBuffer(e)&&(this.needsRedraw=!0,rs(eY,n,i))}}class nY extends Q2{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:i,duration:r,easing:s}}=this,u=s(e/r);this._value=el(n,i,u)}}const yx=1e-5;function vx(t,e,n,i,r){const s=e-t,a=(n-e)*r,y=-s*i;return a+y+s+e}function iY(t,e,n,i,r){if(Array.isArray(n)){const s=[];for(let u=0;u<n.length;u++)s[u]=vx(t[u],e[u],n[u],i,r);return s}return vx(t,e,n,i,r)}function xx(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class rY extends Q2{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:u=e}=this;let a=iY(s,u,n,i,r);const y=xx(a,n),w=xx(a,u);y<yx&&w<yx&&(a=n,this.end()),this._prevValue=u,this._currValue=a}}const sY={interpolation:nY,spring:rY};class oY{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,i,r){const{transitions:s}=this;if(s.has(e)){const y=s.get(e),{value:w=y.settings.fromValue}=y;n=w,this.remove(e)}if(r=BC(r),!r)return;const u=sY[r.type];if(!u){Hn.error("unsupported transition type '".concat(r.type,"'"))();return}const a=new u(this.timeline);a.start({...r,fromValue:n,toValue:i}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,i]of this.transitions)i.update(),e[n]=i.value,i.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function aY(t){const e=t[nc];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function lY(t,e){const n=VC({newProps:t,oldProps:e,propTypes:t[nc],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=uY(t,e);let r=!1;return i||(r=hY(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:fY(t,e),transitionsChanged:cY(t,e)}}function cY(t,e){if(!t.transitions)return!1;const n={},i=t[nc];let r=!1;for(const s in t.transitions){const u=i[s],a=u&&u.type;(a==="number"||a==="color"||a==="array")&&Sg(t[s],e[s],u)&&(n[s]=!0,r=!0)}return r?n:!1}function VC({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(r," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(r,".").concat(s," added");const u=Sg(t[s],e[s],i[s]);if(u)return"".concat(r,".").concat(s," ").concat(u)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const u=Sg(t[s],e[s],i[s]);if(u)return"".concat(r,".").concat(s," ").concat(u)}}return!1}function Sg(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":!i&&e!==t?"changed shallowly":null}function uY(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}function hY(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&wx(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)r!=="all"&&wx(t,e,r)&&(n[r]=!0,i=!0);return i?n:!1}function fY(t,e){if(e===null)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i||i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function wx(t,e,n){let i=t.updateTriggers[n];i=i??{};let r=e.updateTriggers[n];return r=r??{},VC({oldProps:r,newProps:i,triggerName:n})}const AY="count(): argument not an object",dY="count(): argument not a container";function pY(t){if(!gY(t))throw new Error(AY);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(mY(t))return Object.keys(t).length;throw new Error(dY)}function mY(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function gY(t){return t!==null&&typeof t=="object"}function _Y(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=n.modules.findIndex(r=>r.name==="project32");i>=0&&n.modules.splice(i,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const i={...t.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];n.inject=i}return n}const yY={10241:9987,10240:9729,10242:33071,10243:33071},Cg={};function vY(t,e,n,i){if(n instanceof $s)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const s=new $s(e,{...n,parameters:{...yY,...r,...i}});return Cg[s.id]=t,s}function xY(t,e){!e||!(e instanceof $s)||Cg[e.id]===t&&(e.delete(),delete Cg[e.id])}const wY={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Pg(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Qa(t,e,1)}},accessor:{validate(t,e){const n=Kp(t);return n==="function"||n===Kp(e.value)},equal(t,e,n){return typeof e=="function"?!0:Qa(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Pg(t)},equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?Qa(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?Qa(t,e,r):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return!i||!i.gl?null:vY(n.id,i.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{xY(n.id,t)}}};function bY(t){const e={},n={},i={};for(const[r,s]of Object.entries(t)){const u=s?.deprecatedFor;if(u)i[r]=Array.isArray(u)?u:[u];else{const a=EY(r,s);e[r]=a,n[r]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}function EY(t,e){switch(Kp(e)){case"object":return Cf(t,e);case"array":return Cf(t,{type:"array",value:e,compare:!1});case"boolean":return Cf(t,{type:"boolean",value:e});case"number":return Cf(t,{type:"number",value:e});case"function":return Cf(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Cf(t,e){return"type"in e?{name:t,...wY[e.type],...e}:"value"in e?{name:t,type:Kp(e.value),...e}:{name:t,type:"object",value:e}}function Pg(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Kp(t){return Pg(t)?"array":t===null?"null":typeof t}function TY(t,e){let n;for(let s=e.length-1;s>=0;s--){const u=e[s];"extensions"in u&&(n=u.extensions)}const i=Mg(t.constructor,n),r=Object.create(i);r[Qp]=t,r[gu]={},r[W0]={};for(let s=0;s<e.length;++s){const u=e[s];for(const a in u)r[a]=u[a]}return Object.freeze(r),r}const SY="_mergedDefaultProps";function Mg(t,e){let n=SY;if(e)for(const r of e){const s=r.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const i=GC(t,n);return i||(t[n]=CY(t,e||[]))}function CY(t,e){if(!t.prototype)return null;const i=Object.getPrototypeOf(t),r=Mg(i),s=GC(t,"defaultProps")||{},u=bY(s),a=Object.assign(Object.create(null),r,u.defaultProps),y=Object.assign(Object.create(null),r?.[nc],u.propTypes),w=Object.assign(Object.create(null),r?.[R4],u.deprecatedProps);for(const M of e){const R=Mg(M.constructor);R&&(Object.assign(a,R),Object.assign(y,R[nc]),Object.assign(w,R[R4]))}return PY(a,t),IY(a,y),MY(a,w),a[nc]=y,a[R4]=w,e.length===0&&!z8(t,"_propTypes")&&(t._propTypes=y),a}function PY(t,e){const n=LY(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function MY(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(n);for(const s of e[n])z8(this,s)||(this[s]=i);Hn.deprecated(r,e[n].join("/"))()}})}function IY(t,e){const n={},i={};for(const r in e){const s=e[r],{name:u,value:a}=s;s.async&&(n[u]=a,i[u]=kY(u))}t[i1]=n,t[gu]={},Object.defineProperties(t,i)}function kY(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||RC(e)?this[gu][t]=e:this[W0][t]=e},get(){if(this[W0]){if(t in this[W0])return this[W0][t]||this[i1][t];if(t in this[gu]){const e=this[Qp]&&this[Qp].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[i1][t]}}return this[i1][t]}}}function z8(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function GC(t,e){return z8(t,e)&&t[e]}function LY(t){const e=t.componentName;return e||Hn.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let DY=0;class B8{constructor(...e){Z(this,"id",void 0),Z(this,"props",void 0),Z(this,"count",void 0),this.props=TY(this,e),this.id=this.props.id,this.count=DY++}clone(e){const{props:n}=this,i={};for(const r in n[i1])r in n[W0]?i[r]=n[W0][r]:r in n[gu]&&(i[r]=n[gu][r]);return new this.constructor({...n,...i,...e})}}Z(B8,"componentName","Component");Z(B8,"defaultProps",{});const RY=Object.freeze({});class zY{constructor(e){Z(this,"component",void 0),Z(this,"onAsyncPropUpdated",void 0),Z(this,"asyncProps",void 0),Z(this,"oldProps",void 0),Z(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||RY}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Qp]||this.component;const n=e[W0]||{},i=e[gu]||e,r=e[i1]||{};for(const s in n){const u=n[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,u),n[s]=this.getAsyncProp(s)}for(const s in i){const u=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,u)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(RC(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const i=this.asyncProps[e];return n===i.resolvedValue||n===i.lastValue?!1:(i.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(n=this._postProcessValue(i,n),i.resolvedValue=n,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,n,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),r.resolvedValue=n,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const r=i.pendingLoadCount;let s=[],u=0;for await(const a of n){if(!this.component)return;const{dataTransform:y}=this.component.props;y?s=y(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:u,endRow:s.length}]}),u=s.length,this._setAsyncPropValue(e,s,r)}this._onResolve(e,s)}_postProcessValue(e,n){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(n,i,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const r=this.component&&this.component.props[nc];this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class BY extends zY{constructor({attributeManager:e,layer:n}){super(n),Z(this,"attributeManager",void 0),Z(this,"needsRedraw",void 0),Z(this,"needsUpdate",void 0),Z(this,"subLayers",void 0),Z(this,"usesPickingColorCache",void 0),Z(this,"hasPickingBuffer",void 0),Z(this,"changeFlags",void 0),Z(this,"viewport",void 0),Z(this,"uniformTransitions",void 0),Z(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const i=this.layer,r=i?.props.fetch;return r?r(n,{propName:e,layer:i}):super._fetch(e,n)}_onResolve(e,n){const i=this.layer;if(i){const r=i.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:i})}}_onError(e,n){const i=this.layer;i&&i.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const OY="layer.changeFlag",FY="layer.initialize",NY="layer.update",UY="layer.finalize",VY="layer.matched",bx=2**24-1,GY=Object.freeze([]),jY=X2(({oldViewport:t,viewport:e})=>t.equals(e));let Ha=new Uint8ClampedArray(0);const HY={data:{type:"data",value:GY,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:u}=n.context;if(r=r||n.getLoadOptions(),i=i||n.props.loaders,s){var a;r={...r,fetch:{...(a=r)===null||a===void 0?void 0:a.fetch,signal:s}}}let y=u.contains(t);return!y&&!r&&(u.add({resourceId:t,data:Fp(t,i),persistent:!1}),y=!0),y?u.subscribe({resourceId:t,onChange:w=>{var M;return(M=n.internalState)===null||M===void 0?void 0:M.reloadAsyncProp(e,w)},consumerId:n.id,requestId:e}):Fp(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:$n.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class xa extends B8{constructor(...e){super(...e),Z(this,"internalState",null),Z(this,"lifecycle",Th.NO_STATE),Z(this,"context",void 0),Z(this,"state",void 0),Z(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Mr(this.internalState);const n=this.internalState.viewport||this.context.viewport,i=vC(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,u]=mC(i,n.pixelProjectionMatrix);return e.length===2?[r,s]:[r,s,u]}unproject(e){return Mr(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Mr(this.internalState);const i=this.internalState.viewport||this.context.viewport;return $Z(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===$n.DEFAULT||e===$n.LNGLAT||e===$n.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Mr(e instanceof Uint8Array);const[n,i,r]=e;return n+i*256+r*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:pY(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=_Y(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&n)if(Array.isArray(i))for(const r of i)n.invalidateAll(r);else n.invalidateAll();if(n){const{props:r}=e,s=this.internalState.hasPickingBuffer,u=Number.isInteger(r.highlightedObjectIndex)||r.pickable||r.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==u){this.internalState.hasPickingBuffer=u;const{pickingColors:a,instancePickingColors:y}=n.attributes,w=a||y;w&&(u&&w.constant&&(w.constant=!1,n.invalidate(w.id)),!w.value&&!u&&(w.constant=!0,w.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:i}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,n){var i,r;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((i=(r=this.props).onError)!==null&&i!==void 0&&i.call(r,e))){var s,u;(s=this.context)===null||s===void 0||(u=s.onError)===null||u===void 0||u.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!jY({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:n.data,numInstances:i,startIndices:r,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),i=Object.create(this.props);for(const r in n)Object.defineProperty(i,r,{value:n[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const i=Math.floor(Ha.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>bx&&Hn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ha=w1.allocate(Ha,n,{size:3,copy:!0,maxCount:Math.max(n,bx)});const r=Math.floor(Ha.length/3),s=[];for(let u=i;u<r;u++)this.encodePickingColor(u,s),Ha[u*3+0]=s[0],Ha[u*3+1]=s[1],Ha[u*3+2]=s[2]}e.value=Ha.subarray(0,n*3)}_setModelAttributes(e,n){const i=this.getAttributeManager(),r=e.userData.excludeAttributes||{},s=i.getShaderAttributes(n,r);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,u=s&&n.attributes&&n.attributes[s.id];if(u&&u.value){const a=u.value,y=this.encodePickingColor(e);for(let w=0;w<n.length;w++){const M=s.getVertexOffset(w);a[M]===y[0]&&a[M+1]===y[1]&&a[M+2]===y[2]&&this._disablePickingIndex(w)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i;if(!r)return;const s=r.getVertexOffset(e),u=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(u-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==Ha.buffer&&(i.value=Ha.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Mr(!this.internalState),Mr(Number.isFinite(this.props.coordinateSystem)),rs(FY,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new BY({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Hn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new oY(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){rs(VY,this,this===e);const{state:n,internalState:i}=e;this!==e&&(this.internalState=i,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(rs(NY,this,e),!e)return;const n=this.props,i=this.context,r=this.internalState,s=i.viewport,u=this._updateUniformTransition();r.propsInTransition=u,i.viewport=r.viewport||s,this.props=u;try{const a=this._getUpdateParams(),y=this.getModels();if(i.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const M of this.props.extensions)M.updateState.call(this,a,M);const w=this.getModels()[0]!==y[0];this._postUpdate(a,w)}finally{i.viewport=s,this.props=n,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){rs(UY,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,s=this.context;this.props=this.internalState.propsInTransition||r;const u=this.props.opacity;n.opacity=Math.pow(u,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,y=a&&a(n)||[0,0];s0(s.gl,{polygonOffset:y}),ga(s.gl,i,()=>{const w={moduleParameters:e,uniforms:n,parameters:i,context:s};for(const M of this.props.extensions)M.draw.call(this,w,M);this.draw(w)})}finally{this.props=r}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const r in e)if(e[r]){let s=!1;switch(r){case"dataChanged":const u=e[r],a=n[r];u&&Array.isArray(a)&&(n.dataChanged=Array.isArray(u)?a.concat(u):u,s=!0);default:n[r]||(n[r]=e[r],s=!0)}s&&rs(OY,this,r,e)}const i=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=i,n.somethingChanged=i||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const i=lY(e,n);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(s,n[s],e[s],(r=e.transitions)===null||r===void 0?void 0:r[s])}return this.setChangeFlags(i)}validateProps(){aY(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(n.pickingHighlightColor=i(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new tY(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:u,highlightedObjectIndex:a,highlightColor:y}=i;if(n||r.autoHighlight!==u||r.highlightedObjectIndex!==a||r.highlightColor!==y){const w={};u||(w.pickingSelectedColor=null),Array.isArray(y)&&(w.pickingHighlightColor=y),(n||a!==r.highlightedObjectIndex)&&(w.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(w)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),r=i?i.getNeedsRedraw(e):!1;if(n=n||r,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Z(xa,"defaultProps",HY);Z(xa,"layerName","Layer");const WY="compositeLayer.renderLayers";class ur extends xa{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||n}getSubLayerRow(e,n,i){return e.__source={parent:this,object:n,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(n.index=i.__source.index,e(i.__source.object,n)):e(i,r)}return e}getSubLayerProps(e={}){var n;const{opacity:i,pickable:r,visible:s,parameters:u,getPolygonOffset:a,highlightedObjectIndex:y,autoHighlight:w,highlightColor:M,coordinateSystem:R,coordinateOrigin:L,wrapLongitude:U,positionFormat:q,modelMatrix:te,extensions:pe,fetch:ne,operation:ie,_subLayerProps:re}=this.props,_e={id:"",updateTriggers:{},opacity:i,pickable:r,visible:s,parameters:u,getPolygonOffset:a,highlightedObjectIndex:y,autoHighlight:w,highlightColor:M,coordinateSystem:R,coordinateOrigin:L,wrapLongitude:U,positionFormat:q,modelMatrix:te,extensions:pe,fetch:ne,operation:ie},Te=re&&e.id&&re[e.id],De=Te&&Te.updateTriggers,$e=e.id||"sublayer";if(Te){const nt=this.props[nc],ut=e.type?e.type._propTypes:{};for(const st in Te){const lt=ut[st]||nt[st];lt&&lt.type==="accessor"&&(Te[st]=this.getSubLayerAccessor(Te[st]))}}Object.assign(_e,e,Te),_e.id="".concat(this.props.id,"-").concat($e),_e.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...De};for(const nt of pe){const ut=nt.getSubLayerProps.call(this,nt);ut&&Object.assign(_e,ut,{updateTriggers:Object.assign(_e.updateTriggers,ut.updateTriggers)})}return _e}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();if(r){const s=this.renderLayers();i=L3(s,Boolean),this.internalState.subLayers=i}rs(WY,this,r,i);for(const s of i)s.parent=this}}Z(ur,"layerName","CompositeLayer");const ld=Math.PI/180,Ex=180/Math.PI,Wd=6370972,jh=256;function $Y(){const t=jh/Wd,e=Math.PI/180*jh;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class qY extends Su{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,nearZMultiplier:s=.1,farZMultiplier:u=2,resolution:a=10}=e;let{height:y,altitude:w=1.5}=e;y=y||1,w=Math.max(.75,w);const M=new Ws().lookAt({eye:[0,-w,0],up:[0,0,1]}),R=Math.pow(2,r);M.rotateX(n*ld),M.rotateZ(-i*ld),M.scale(R/y);const L=Math.atan(.5/w),U=jh*2*R/y;super({...e,height:y,viewMatrix:M,longitude:i,latitude:n,zoom:r,distanceScales:$Y(),fovyRadians:L*2,focalDistance:w,near:s,far:Math.min(2,1/U+1)*w*u}),Z(this,"longitude",void 0),Z(this,"latitude",void 0),Z(this,"resolution",void 0),this.latitude=n,this.longitude=i,this.resolution=a}get projectionMode(){return fa.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,this.height/2],n),r=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),u=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],s[0],r[0],u[0]),Math.min(i[1],s[1],r[1],u[1]),Math.max(i[0],s[0],r[0],u[0]),Math.max(i[1],s[1],r[1],u[1])]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,u]=e,a=n?s:this.height-s,{pixelUnprojectionMatrix:y}=this;let w;if(Number.isFinite(u))w=F4(y,[r,a,u,1]);else{const U=F4(y,[r,a,-1,1]),q=F4(y,[r,a,1,1]),te=((i||0)/Wd+1)*jh,pe=T4($S([],U,q)),ne=T4(U),ie=T4(q),_e=4*((4*ne*ie-(pe-ne-ie)**2)/16)/pe,Te=Math.sqrt(ne-_e),De=Math.sqrt(Math.max(0,te*te-_e)),$e=(Te-De)/Math.sqrt(pe);w=KW([],U,q,$e)}const[M,R,L]=this.unprojectPosition(w);return Number.isFinite(u)?[M,R,L]:Number.isFinite(i)?[M,R,i]:[M,R]}projectPosition(e){const[n,i,r=0]=e,s=n*ld,u=i*ld,a=Math.cos(u),y=(r/Wd+1)*jh;return[Math.sin(s)*a*y,-Math.cos(s)*a*y,Math.sin(u)*y]}unprojectPosition(e){const[n,i,r]=e,s=qS(e),u=Math.asin(r/s),y=Math.atan2(n,-i)*Ex,w=u*Ex,M=(s/jh-1)*Wd;return[y,w,M]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const i=this.unproject(n);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}}function F4(t,e){const n=B1([],e,t);return T8(n,n,1/n[3]),n}const N4={bearing:0,pitch:0,position:[0,0,0]},ZY={speed:1.2,curve:1.414};class O1 extends EC{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),Z(this,"opts",void 0),this.opts={...ZY,...e}}interpolateProps(e,n,i){const r=wZ(e,n,i,this.opts);for(const s in N4)r[s]=el(e[s]||N4[s],n[s]||N4[s],i);return r}getDuration(e,n){let{transitionDuration:i}=n;return i==="auto"&&(i=bZ(e,n,this.opts)),i}}class jC{constructor(e){Z(this,"opts",void 0),Z(this,"typedArrayManager",void 0),Z(this,"indexStarts",[0]),Z(this,"vertexStarts",[0]),Z(this,"vertexCount",0),Z(this,"instanceCount",0),Z(this,"attributes",void 0),Z(this,"_attributeDefs",void 0),Z(this,"data",void 0),Z(this,"getGeometry",void 0),Z(this,"geometryBuffer",void 0),Z(this,"buffers",void 0),Z(this,"positionSize",void 0),Z(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=w1,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:i={},getGeometry:r,geometryBuffer:s,positionFormat:u,dataChanged:a,normalize:y=!0}=this.opts;if(this.data=n,this.getGeometry=r,this.positionSize=s&&s.size||(u==="XY"?2:3),this.buffers=i,this.normalize=y,s&&(Mr(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),y||(i.positions=s)),this.geometryBuffer=i.positions,Array.isArray(a))for(const w of a)this._rebuildGeometry(w);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?zC(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:i,buffers:r,_attributeDefs:s,typedArrayManager:u}=this;for(const a in s)if(a in r)u.release(i[a]),i[a]=null;else{const y=s[a];y.copy=n,i[a]=u.allocate(i[a],e,y)}}_forEachGeometry(e,n,i){const{data:r,getGeometry:s}=this,{iterable:u,objectInfo:a}=K2(r,n,i);for(const y of u){a.index++;const w=s?s(y,a):null;e(w,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:i,instanceCount:r}=this;const{data:s,geometryBuffer:u}=this,{startRow:a=0,endRow:y=1/0}=e||{},w={};if(e||(n=[0],i=[0]),this.normalize||!u)this._forEachGeometry((R,L)=>{const U=R&&this.normalizeGeometry(R);w[L]=U,i[L+1]=i[L]+(U?this.getGeometrySize(U):0)},a,y),r=i[i.length-1];else if(i=s.startIndices,r=i[s.length]||0,ArrayBuffer.isView(u))r=r||u.length/this.positionSize;else if(u instanceof gi){const R=u.accessor.stride||this.positionSize*4;r=r||u.byteLength/R}else if(u.buffer){const R=u.stride||this.positionSize*4;r=r||u.buffer.byteLength/R}else if(u.value){const R=u.value,L=u.stride/R.BYTES_PER_ELEMENT||this.positionSize;r=r||R.length/L}this._allocate(r,!!e),this.indexStarts=n,this.vertexStarts=i,this.instanceCount=r;const M={};this._forEachGeometry((R,L)=>{const U=w[L]||R;M.vertexStart=i[L],M.indexStart=n[L];const q=L<i.length-1?i[L+1]:r;M.geometrySize=q-i[L],M.geometryIndex=L,this.updateGeometryAttributes(U,M)},a,y),this.vertexCount=n[n.length-1]}}const XY=new Uint16Array([0,2,1,0,3,2]),QY=new Float32Array([0,1,0,0,1,0,1,1]);function YY(t,e){if(!e)return KY(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),i=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),r=Math.ceil(n/e)+1,s=Math.ceil(i/e)+1,u=(r-1)*(s-1)*6,a=new Uint32Array(u),y=new Float32Array(r*s*2),w=new Float64Array(r*s*3);let M=0,R=0;for(let L=0;L<r;L++){const U=L/(r-1);for(let q=0;q<s;q++){const te=q/(s-1),pe=JY(t,U,te);w[M*3+0]=pe[0],w[M*3+1]=pe[1],w[M*3+2]=pe[2]||0,y[M*2+0]=U,y[M*2+1]=1-te,L>0&&q>0&&(a[R++]=M-s,a[R++]=M-s-1,a[R++]=M-1,a[R++]=M-s,a[R++]=M-1,a[R++]=M),M++}}return{vertexCount:u,positions:w,indices:a,texCoords:y}}function KY(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:XY,texCoords:QY}}function JY(t,e,n){return el(el(t[0],t[1],n),el(t[3],t[2],n),e)}const eK=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,tK=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,nK=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(tK,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),iK={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:$n.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class O8 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return super.getShaders({vs:eK,fs:nK,modules:[Cu,Pu]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:i=>i.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:i=>i.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:i=>i.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:i}){const r=this.getAttributeManager();if(i.extensionsChanged){var s;const{gl:u}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(u),r.invalidateAll()}if(e.bounds!==n.bounds){const u=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const y in a)u&&u[y]!==a[y]&&r.invalidate(y);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,i=e.info;if(!i.color||!n)return i.bitmap=null,i;const{width:r,height:s}=n;i.index=0;const u=rK(i.color),a=[Math.floor(u[0]*r),Math.floor(u[1]*s)];return i.bitmap={size:{width:r,height:s},uv:u,pixel:a},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return Tx(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),YY(n,this.context.viewport.resolution)}_getModel(e){return e?new o0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:i}=e,{model:r,coordinateConversion:s,bounds:u,disablePicking:a}=this.state,{image:y,desaturate:w,transparentColor:M,tintColor:R}=this.props;i.pickingActive&&a||y&&r&&r.setUniforms(n).setUniforms({bitmapTexture:y,desaturate:w,transparentColor:M.map(L=>L/255),tintColor:R.slice(0,3).map(L=>L/255),coordinateConversion:s,bounds:u}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:i}=$n;let{_imageCoordinateSystem:r}=this.props;if(r!==i){const{bounds:s}=this.props;if(!Tx(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const u=this.context.viewport.resolution?e:n;if(r=r===e?e:n,r===e&&u===n)return{coordinateConversion:-1,bounds:s};if(r===n&&u===e){const a=tl([s[0],s[1]]),y=tl([s[2],s[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],y[0],y[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}Z(O8,"layerName","BitmapLayer");Z(O8,"defaultProps",iK);function rK(t){const[e,n,i]=t,r=(i&240)/256,s=(i&15)/16;return[(e+s)/256,(n+r)/256]}function Tx(t){return Number.isFinite(t[0])}const sK=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,oK=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,aK=1024,lK=4,Sx=()=>{},Cx={10241:9987,10240:9729,10242:33071,10243:33071};function cK(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function uK(t,e,n,i){const r=Math.min(n/e.width,i/e.height),s=Math.floor(e.width*r),u=Math.floor(e.height*r);return r===1?{data:e,width:s,height:u}:(t.canvas.height=u,t.canvas.width=s,t.clearRect(0,0,s,u),t.drawImage(e,0,0,e.width,e.height,0,0,s,u),{data:t.canvas,width:s,height:u})}function M2(t){return t&&(t.id||t.url)}function hK(t,e,n,i){const r=t.width,s=t.height,u=new $s(t.gl,{width:e,height:n,parameters:i});return cj(t,u,{targetY:0,width:r,height:s}),t.delete(),u}function Px(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i],u=M2(r);t[u]={...r,x:s,y:n}}}function fK({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:u}){let a=[];for(let y=0;y<t.length;y++){const w=t[y],M=M2(w);if(!n[M]){const{height:R,width:L}=w;i+L+e>u&&(Px(n,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:w,xOffset:i}),i=i+L+e,s=Math.max(s,R)}}return a.length>0&&Px(n,a,r),{mapping:n,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:u,canvasHeight:cK(s+r+e)}}function AK(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:s}=K2(t);for(const u of r){s.index++;const a=e(u,s),y=M2(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[y]&&(!n[y]||a.url!==n[y].url)&&(i[y]={...a,source:u,sourceIndex:s.index})}return i}class dK{constructor(e,{onUpdate:n=Sx,onError:i=Sx}){Z(this,"gl",void 0),Z(this,"onUpdate",void 0),Z(this,"onError",void 0),Z(this,"_loadOptions",null),Z(this,"_texture",null),Z(this,"_externalTexture",null),Z(this,"_mapping",{}),Z(this,"_textureParameters",null),Z(this,"_pendingCount",0),Z(this,"_autoPacking",!1),Z(this,"_xOffset",0),Z(this,"_yOffset",0),Z(this,"_rowHeight",0),Z(this,"_buffer",lK),Z(this,"_canvasWidth",aK),Z(this,"_canvasHeight",0),Z(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=i}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?M2(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),r&&(this._mapping=r),i){var u;(u=this._texture)===null||u===void 0||u.delete(),this._texture=null,this._externalTexture=i}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(AK(e,n,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:s,yOffset:u,rowHeight:a,canvasHeight:y}=fK({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=r,this._xOffset=s,this._yOffset=u,this._canvasHeight=y,this._texture||(this._texture=new $s(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||Cx})),this._texture.height!==this._canvasHeight&&(this._texture=hK(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||Cx)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const i of e)this._pendingCount++,Fp(i.url,this._loadOptions).then(r=>{const s=M2(i),u=this._mapping[s],{x:a,y,width:w,height:M}=u,{data:R,width:L,height:U}=uK(n,r,w,M);this._texture.setSubImageData({data:R,x:a+(w-L)/2,y:y+(M-U)/2,width:L,height:U}),u.width=L,u.height=U,this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const HC=[0,0,0,255],pK={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:HC},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class z3 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return super.getShaders({vs:sK,fs:oK,modules:[Cu,Pu]})}initializeState(){this.state={iconManager:new dK(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:HC},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager(),{iconAtlas:u,iconMapping:a,data:y,getIcon:w,textureParameters:M}=n,{iconManager:R}=this.state,L=u||this.internalState.isAsyncPropLoading("iconAtlas");if(R.setProps({loadOptions:n.loadOptions,autoPacking:!L,iconAtlas:u,iconMapping:L?a:null,textureParameters:M}),L?i.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&R.packIcons(y,w),r.extensionsChanged){var U;const{gl:q}=this.context;(U=this.state.model)===null||U===void 0||U.delete(),this.state.model=this._getModel(q),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:s,billboard:u,alphaCutoff:a}=this.props,{iconManager:y}=this.state,w=y.getTexture();w&&this.state.model.setUniforms(e).setUniforms({iconsTexture:w,iconsTextureDim:[w.width,w.height],sizeUnits:fu[s],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:u,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new o0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const i=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;i?i(e):Hn.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:i,anchorX:r=n/2,anchorY:s=i/2}=this.state.iconManager.getIconMapping(e);return[n/2-r,i/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:i,width:r,height:s}=this.state.iconManager.getIconMapping(e);return[n,i,r,s]}}Z(z3,"defaultProps",pK);Z(z3,"layerName","IconLayer");const mK=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,gK=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Mx=[0,0,0,255],_K={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Mx},getLineColor:{type:"accessor",value:Mx},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class F8 extends xa{getShaders(){return super.getShaders({vs:mK,fs:gK,modules:[Cu,Pu]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:i}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,stroked:u,filled:a,billboard:y,antialiasing:w,lineWidthUnits:M,lineWidthScale:R,lineWidthMinPixels:L,lineWidthMaxPixels:U}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:u?1:0,filled:a,billboard:y,antialiasing:w,radiusUnits:fu[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,lineWidthUnits:fu[M],lineWidthScale:R,lineWidthMinPixels:L,lineWidthMaxPixels:U}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new o0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}Z(F8,"defaultProps",_K);Z(F8,"layerName","ScatterplotLayer");const WC={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function $C(t,e,n={}){return yK(t,n)!==e?(xK(t,n),!0):!1}function yK(t,e={}){return Math.sign(vK(t,e))}function vK(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let s=0;for(let u=n,a=i-r;u<i;u+=r)s+=(t[u]-t[a])*(t[u+1]+t[a+1]),a=u;return s/2}function xK(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,s=(i-n)/r,u=Math.floor(s/2);for(let a=0;a<u;++a){const y=n+a*r,w=n+(s-1-a)*r;for(let M=0;M<r;++M){const R=t[y+M];t[y+M]=t[w+M],t[w+M]=R}}}function da(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let s=0;s<n;s++)if(t[i-n+s]!==e[s]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function Ig(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function I2(t,e,n,i,r=[]){const s=i+e*n;for(let u=0;u<n;u++)r[u]=t[s+u];return r}function kg(t,e,n,i,r=[]){let s,u;if(n&8)s=(i[3]-t[1])/(e[1]-t[1]),u=3;else if(n&4)s=(i[1]-t[1])/(e[1]-t[1]),u=1;else if(n&2)s=(i[2]-t[0])/(e[0]-t[0]),u=2;else if(n&1)s=(i[0]-t[0])/(e[0]-t[0]),u=0;else return null;for(let a=0;a<t.length;a++)r[a]=(u&1)===a?i[u]:s*(e[a]-t[a])+t[a];return r}function $d(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function qC(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:s=[0,0],startIndex:u=0,endIndex:a=t.length}=e||{},y=(a-u)/n;let w=[];const M=[w],R=I2(t,0,n,u);let L,U;const q=XC(R,r,s,[]),te=[];da(w,R);for(let pe=1;pe<y;pe++){for(L=I2(t,pe,n,u,L),U=$d(L,q);U;){kg(R,L,U,q,te);const ne=$d(te,q);ne&&(kg(R,te,ne,q,te),U=ne),da(w,te),Ig(R,te),bK(q,r,U),i&&w.length>n&&(w=[],M.push(w),da(w,R)),U=$d(L,q)}da(w,L),Ig(R,L)}return i?M:M[0]}const Ix=0,wK=1;function cd(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function ZC(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:s=[0,0],edgeTypes:u=!1}=n||{},a=[],y=[{pos:t,types:u?new Array(t.length/i).fill(wK):null,holes:e||[]}],w=[[],[]];let M=[];for(;y.length;){const{pos:R,types:L,holes:U}=y.shift();EK(R,i,U[0]||R.length,w),M=XC(w[0],r,s,M);const q=$d(w[1],M);if(q){let te=kx(R,L,i,0,U[0]||R.length,M,q);const pe={pos:te[0].pos,types:te[0].types,holes:[]},ne={pos:te[1].pos,types:te[1].types,holes:[]};y.push(pe,ne);for(let ie=0;ie<U.length;ie++)te=kx(R,L,i,U[ie],U[ie+1]||R.length,M,q),te[0]&&(pe.holes.push(pe.pos.length),pe.pos=cd(pe.pos,te[0].pos),u&&(pe.types=cd(pe.types,te[0].types))),te[1]&&(ne.holes.push(ne.pos.length),ne.pos=cd(ne.pos,te[1].pos),u&&(ne.types=cd(ne.types,te[1].types)))}else{const te={positions:R};u&&(te.edgeTypes=L),U.length&&(te.holeIndices=U),a.push(te)}}return a}function kx(t,e,n,i,r,s,u){const a=(r-i)/n,y=[],w=[],M=[],R=[],L=[];let U,q,te;const pe=I2(t,a-1,n,i);let ne=Math.sign(u&8?pe[1]-s[3]:pe[0]-s[2]),ie=e&&e[a-1],re=0,_e=0;for(let Te=0;Te<a;Te++)U=I2(t,Te,n,i,U),q=Math.sign(u&8?U[1]-s[3]:U[0]-s[2]),te=e&&e[i/n+Te],q&&ne&&ne!==q&&(kg(pe,U,u,s,L),da(y,L)&&M.push(ie),da(w,L)&&R.push(ie)),q<=0?(da(y,U)&&M.push(te),re-=q):M.length&&(M[M.length-1]=Ix),q>=0?(da(w,U)&&R.push(te),_e+=q):R.length&&(R[R.length-1]=Ix),Ig(pe,U),ne=q,ie=te;return[re?{pos:y,types:e&&M}:null,_e?{pos:w,types:e&&R}:null]}function XC(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=s,i[2]=r+e,i[3]=s+e,i}function bK(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function EK(t,e,n,i){let r=1/0,s=-1/0,u=1/0,a=-1/0;for(let y=0;y<n;y+=e){const w=t[y],M=t[y+1];r=w<r?w:r,s=w>s?w:s,u=M<u?M:u,a=M>a?M:a}return i[0][0]=r,i[0][1]=u,i[1][0]=s,i[1][1]=a,i}const TK=85.051129;function SK(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:s=!0}=e||{},u=t.slice(i,r);QC(u,n,0,r-i);const a=qC(u,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const y of a)YC(y,n);return a}function CK(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:s=!1}=n||{};e=e||[];const u=[],a=[];let y=0,w=0;for(let R=0;R<=e.length;R++){const L=e[R]||t.length,U=w,q=PK(t,i,y,L);for(let te=q;te<L;te++)u[w++]=t[te];for(let te=y;te<q;te++)u[w++]=t[te];QC(u,i,U,w),MK(u,i,U,w,n?.maxLatitude),y=L,a[R]=w}a.pop();const M=ZC(u,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(r)for(const R of M)YC(R.positions,i);return M}function PK(t,e,n,i){let r=-1,s=-1;for(let u=n+1;u<i;u+=e){const a=Math.abs(t[u]);a>r&&(r=a,s=u-1)}return s}function MK(t,e,n,i,r=TK){const s=t[n],u=t[i-e];if(Math.abs(s-u)>180){const a=I2(t,0,e,n);a[0]+=Math.round((u-s)/360)*360,da(t,a),a[1]=Math.sign(a[1])*r,da(t,a),a[0]=s,da(t,a)}}function QC(t,e,n,i){let r=t[0],s;for(let u=n;u<i;u+=e){s=t[u];const a=s-r;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[u]=r=s}}function YC(t,e){let n;const i=t.length/e;for(let s=0;s<i&&(n=t[s*e],(n+180)%360===0);s++);const r=-Math.round(n/360)*360;if(r!==0)for(let s=0;s<i;s++)t[s*e]+=r}function IK(t,e,n,i){let r;if(Array.isArray(t[0])){const s=t.length*e;r=new Array(s);for(let u=0;u<t.length;u++)for(let a=0;a<e;a++)r[u*e+a]=t[u][a]||0}else r=t;return n?qC(r,{size:e,gridResolution:n}):i?SK(r,{size:e}):r}const kK=1,LK=2,U4=4;class DK extends jC{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?IK(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(Lx(e)){let i=0;for(const r of e)i+=this.getGeometrySize(r);return i}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&Lx(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const i=this.attributes.segmentTypes,r=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:u}=n;i.fill(0,s,s+u),r?(i[s]=U4,i[s+u-2]=U4):(i[s]+=kK,i[s+u-2]+=LK),i[s+u-1]=U4}_updatePositions(e,n){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:r,geometrySize:s}=n,u=new Array(3);for(let a=r,y=0;y<s;a++,y++)this.getPointOnPath(e,y,u),i[a*3]=u[0],i[a*3+1]=u[1],i[a*3+2]=u[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,i=[]){const{positionSize:r}=this;n*r>=e.length&&(n+=1-e.length/r);const s=n*r;return i[0]=e[s],i[1]=e[s+1],i[2]=r===3&&e[s+2]||0,i}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,i=e.length-n;return e[0]===e[i]&&e[1]===e[i+1]&&(n===2||e[2]===e[i+2])}}function Lx(t){return Array.isArray(t[0])}const RK=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,zK=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,KC=[0,0,0,255],BK={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:KC},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},V4={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class N8 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return super.getShaders({vs:RK,fs:zK,modules:[Cu,Pu]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:V4,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:V4,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:V4,defaultValue:KC},instancePickingColors:{size:3,type:5121,accessor:(i,{index:r,target:s})=>this.encodePickingColor(i&&i.__source?i.__source.index:r,s)}}),this.setState({pathTesselator:new DK({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:i}=e,r=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,y=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:y.getPath,buffers:y,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),i.dataChanged||r.invalidateAll()}if(i.extensionsChanged){var u;const{gl:a}=this.context;(u=this.state.model)===null||u===void 0||u.delete(),this.state.model=this._getModel(a),r.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(s=>s.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:i,billboard:r,miterLimit:s,widthUnits:u,widthScale:a,widthMinPixels:y,widthMaxPixels:w}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:fu[u],widthScale:a,miterLimit:s,widthMinPixels:y,widthMaxPixels:w}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],i=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new o0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(i),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}Z(N8,"defaultProps",BK);Z(N8,"layerName","PathLayer");var U8={exports:{}};U8.exports=B3;U8.exports.default=B3;function B3(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,s=JC(t,0,r,n,!0),u=[];if(!s||s.next===s.prev)return u;var a,y,w,M,R,L,U;if(i&&(s=VK(t,e,s,n)),t.length>80*n){a=w=t[0],y=M=t[1];for(var q=n;q<r;q+=n)R=t[q],L=t[q+1],R<a&&(a=R),L<y&&(y=L),R>w&&(w=R),L>M&&(M=L);U=Math.max(w-a,M-y),U=U!==0?32767/U:0}return k2(s,u,n,a,y,U,0),u}function JC(t,e,n,i,r){var s,u;if(r===Rg(t,e,n,i)>0)for(s=e;s<n;s+=i)u=Dx(s,t[s],t[s+1],u);else for(s=n-i;s>=e;s-=i)u=Dx(s,t[s],t[s+1],u);return u&&O3(u,u.next)&&(D2(u),u=u.next),u}function _u(t,e){if(!t)return t;e||(e=t);var n=t,i;do if(i=!1,!n.steiner&&(O3(n,n.next)||Vi(n.prev,n,n.next)===0)){if(D2(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function k2(t,e,n,i,r,s,u){if(t){!u&&s&&$K(t,i,r,s);for(var a=t,y,w;t.prev!==t.next;){if(y=t.prev,w=t.next,s?FK(t,i,r,s):OK(t)){e.push(y.i/n|0),e.push(t.i/n|0),e.push(w.i/n|0),D2(t),t=w.next,a=w.next;continue}if(t=w,t===a){u?u===1?(t=NK(_u(t),e,n),k2(t,e,n,i,r,s,2)):u===2&&UK(t,e,n,i,r,s):k2(_u(t),e,n,i,r,s,1);break}}}}function OK(t){var e=t.prev,n=t,i=t.next;if(Vi(e,n,i)>=0)return!1;for(var r=e.x,s=n.x,u=i.x,a=e.y,y=n.y,w=i.y,M=r<s?r<u?r:u:s<u?s:u,R=a<y?a<w?a:w:y<w?y:w,L=r>s?r>u?r:u:s>u?s:u,U=a>y?a>w?a:w:y>w?y:w,q=i.next;q!==e;){if(q.x>=M&&q.x<=L&&q.y>=R&&q.y<=U&&Hh(r,a,s,y,u,w,q.x,q.y)&&Vi(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function FK(t,e,n,i){var r=t.prev,s=t,u=t.next;if(Vi(r,s,u)>=0)return!1;for(var a=r.x,y=s.x,w=u.x,M=r.y,R=s.y,L=u.y,U=a<y?a<w?a:w:y<w?y:w,q=M<R?M<L?M:L:R<L?R:L,te=a>y?a>w?a:w:y>w?y:w,pe=M>R?M>L?M:L:R>L?R:L,ne=Lg(U,q,e,n,i),ie=Lg(te,pe,e,n,i),re=t.prevZ,_e=t.nextZ;re&&re.z>=ne&&_e&&_e.z<=ie;){if(re.x>=U&&re.x<=te&&re.y>=q&&re.y<=pe&&re!==r&&re!==u&&Hh(a,M,y,R,w,L,re.x,re.y)&&Vi(re.prev,re,re.next)>=0||(re=re.prevZ,_e.x>=U&&_e.x<=te&&_e.y>=q&&_e.y<=pe&&_e!==r&&_e!==u&&Hh(a,M,y,R,w,L,_e.x,_e.y)&&Vi(_e.prev,_e,_e.next)>=0))return!1;_e=_e.nextZ}for(;re&&re.z>=ne;){if(re.x>=U&&re.x<=te&&re.y>=q&&re.y<=pe&&re!==r&&re!==u&&Hh(a,M,y,R,w,L,re.x,re.y)&&Vi(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;_e&&_e.z<=ie;){if(_e.x>=U&&_e.x<=te&&_e.y>=q&&_e.y<=pe&&_e!==r&&_e!==u&&Hh(a,M,y,R,w,L,_e.x,_e.y)&&Vi(_e.prev,_e,_e.next)>=0)return!1;_e=_e.nextZ}return!0}function NK(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!O3(r,s)&&eP(r,i,i.next,s)&&L2(r,s)&&L2(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),D2(i),D2(i.next),i=t=s),i=i.next}while(i!==t);return _u(i)}function UK(t,e,n,i,r,s){var u=t;do{for(var a=u.next.next;a!==u.prev;){if(u.i!==a.i&&XK(u,a)){var y=tP(u,a);u=_u(u,u.next),y=_u(y,y.next),k2(u,e,n,i,r,s,0),k2(y,e,n,i,r,s,0);return}a=a.next}u=u.next}while(u!==t)}function VK(t,e,n,i){var r=[],s,u,a,y,w;for(s=0,u=e.length;s<u;s++)a=e[s]*i,y=s<u-1?e[s+1]*i:t.length,w=JC(t,a,y,i,!1),w===w.next&&(w.steiner=!0),r.push(ZK(w));for(r.sort(GK),s=0;s<r.length;s++)n=jK(r[s],n);return n}function GK(t,e){return t.x-e.x}function jK(t,e){var n=HK(t,e);if(!n)return e;var i=tP(n,t);return _u(i,i.next),_u(n,n.next)}function HK(t,e){var n=e,i=t.x,r=t.y,s=-1/0,u;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s&&(s=a,u=n.x<n.next.x?n:n.next,a===i))return u}n=n.next}while(n!==e);if(!u)return null;var y=u,w=u.x,M=u.y,R=1/0,L;n=u;do i>=n.x&&n.x>=w&&i!==n.x&&Hh(r<M?i:s,r,w,M,r<M?s:i,r,n.x,n.y)&&(L=Math.abs(r-n.y)/(i-n.x),L2(n,t)&&(L<R||L===R&&(n.x>u.x||n.x===u.x&&WK(u,n)))&&(u=n,R=L)),n=n.next;while(n!==y);return u}function WK(t,e){return Vi(t.prev,t,e.prev)<0&&Vi(e.next,t,t.next)<0}function $K(t,e,n,i){var r=t;do r.z===0&&(r.z=Lg(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,qK(r)}function qK(t){var e,n,i,r,s,u,a,y,w=1;do{for(n=t,t=null,s=null,u=0;n;){for(u++,i=n,a=0,e=0;e<w&&(a++,i=i.nextZ,!!i);e++);for(y=w;a>0||y>0&&i;)a!==0&&(y===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,y--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,w*=2}while(u>1);return t}function Lg(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function ZK(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Hh(t,e,n,i,r,s,u,a){return(r-u)*(e-a)>=(t-u)*(s-a)&&(t-u)*(i-a)>=(n-u)*(e-a)&&(n-u)*(s-a)>=(r-u)*(i-a)}function XK(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!QK(t,e)&&(L2(t,e)&&L2(e,t)&&YK(t,e)&&(Vi(t.prev,t,e.prev)||Vi(t,e.prev,e))||O3(t,e)&&Vi(t.prev,t,t.next)>0&&Vi(e.prev,e,e.next)>0)}function Vi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function O3(t,e){return t.x===e.x&&t.y===e.y}function eP(t,e,n,i){var r=hd(Vi(t,e,n)),s=hd(Vi(t,e,i)),u=hd(Vi(n,i,t)),a=hd(Vi(n,i,e));return!!(r!==s&&u!==a||r===0&&ud(t,n,e)||s===0&&ud(t,i,e)||u===0&&ud(n,t,i)||a===0&&ud(n,e,i))}function ud(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function hd(t){return t>0?1:t<0?-1:0}function QK(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&eP(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function L2(t,e){return Vi(t.prev,t,t.next)<0?Vi(t,e,t.next)>=0&&Vi(t,t.prev,e)>=0:Vi(t,e,t.prev)<0||Vi(t,t.next,e)<0}function YK(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function tP(t,e){var n=new Dg(t.i,t.x,t.y),i=new Dg(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Dx(t,e,n,i){var r=new Dg(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function D2(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Dg(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}B3.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,u=Math.abs(Rg(t,0,s,n));if(r)for(var a=0,y=e.length;a<y;a++){var w=e[a]*n,M=a<y-1?e[a+1]*n:t.length;u-=Math.abs(Rg(t,w,M,n))}var R=0;for(a=0;a<i.length;a+=3){var L=i[a]*n,U=i[a+1]*n,q=i[a+2]*n;R+=Math.abs((t[L]-t[q])*(t[U+1]-t[L+1])-(t[L]-t[U])*(t[q+1]-t[L+1]))}return u===0&&R===0?0:Math.abs((R-u)/u)};function Rg(t,e,n,i){for(var r=0,s=e,u=n-i;s<n;s+=i)r+=(t[u]-t[s])*(t[s+1]+t[u+1]),u=s;return r}B3.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var u=0;u<e;u++)n.vertices.push(t[r][s][u]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var KK=U8.exports;const JK=s3(KK),fd=WC.CLOCKWISE,Rx=WC.COUNTER_CLOCKWISE,$0={isClosed:!0};function eJ(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Uf(t){return"positions"in t?t.positions:t}function qd(t){return"holeIndices"in t?t.holeIndices:null}function tJ(t){return Array.isArray(t[0])}function nJ(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function iJ(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function rJ(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}function zx(t,e,n,i,r){let s=e;const u=n.length;for(let a=0;a<u;a++)for(let y=0;y<i;y++)t[s++]=n[a][y]||0;if(!iJ(n))for(let a=0;a<i;a++)t[s++]=n[0][a]||0;return $0.start=e,$0.end=s,$0.size=i,$C(t,r,$0),s}function Bx(t,e,n,i,r=0,s,u){s=s||n.length;const a=s-r;if(a<=0)return e;let y=e;for(let w=0;w<a;w++)t[y++]=n[r+w];if(!rJ(n,i,r,s))for(let w=0;w<i;w++)t[y++]=n[r+w];return $0.start=e,$0.end=y,$0.size=i,$C(t,u,$0),y}function sJ(t,e){eJ(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:s}=t;if(s){let u=0;for(let a=0;a<=s.length;a++)u=Bx(n,u,r,e,s[a-1],s[a],a===0?fd:Rx),i.push(u);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!tJ(t))return Bx(n,0,t,e,0,n.length,fd),n;if(!nJ(t)){let r=0;for(const[s,u]of t.entries())r=zx(n,r,u,e,s===0?fd:Rx),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return zx(n,0,t,e,fd),n}function G4(t,e,n){const i=t.length/3;let r=0;for(let s=0;s<i;s++){const u=(s+1)%i;r+=t[s*3+e]*t[u*3+n],r-=t[u*3+e]*t[s*3+n]}return Math.abs(r/2)}function Ox(t,e,n,i){const r=t.length/3;for(let s=0;s<r;s++){const u=s*3,a=t[u+0],y=t[u+1],w=t[u+2];t[u+e]=a,t[u+n]=y,t[u+i]=w}}function oJ(t,e,n,i){let r=qd(t);r&&(r=r.map(a=>a/e));let s=Uf(t);const u=i&&e===3;if(n){const a=s.length;s=s.slice();const y=[];for(let w=0;w<a;w+=e){y[0]=s[w],y[1]=s[w+1],u&&(y[2]=s[w+2]);const M=n(y);s[w]=M[0],s[w+1]=M[1],u&&(s[w+2]=M[2])}}if(u){const a=G4(s,0,1),y=G4(s,0,2),w=G4(s,1,2);if(!a&&!y&&!w)return[];a>y&&a>w||(y>w?(n||(s=s.slice()),Ox(s,0,2,1)):(n||(s=s.slice()),Ox(s,2,0,1)))}return JK(s,r,e)}class aJ extends jC{constructor(e){const{fp64:n,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=sJ(e,this.positionSize);return this.opts.resolution?ZC(Uf(n),qd(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?CK(Uf(n),qd(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(Fx(e)){let n=0;for(const i of e)n+=this.getGeometrySize(i);return n}return Uf(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&Fx(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:i,indexStart:r}){const{attributes:s,indexStarts:u,typedArrayManager:a}=this;let y=s.indices;if(!y||!e)return;let w=r;const M=oJ(e,this.positionSize,this.opts.preproject,this.opts.full3d);y=a.allocate(y,r+M.length,{copy:!0});for(let R=0;R<M.length;R++)y[w++]=M[R]+i;u[n+1]=r+M.length,s.indices=y}_updatePositions(e,{vertexStart:n,geometrySize:i}){const{attributes:{positions:r},positionSize:s}=this;if(!r||!e)return;const u=Uf(e);for(let a=n,y=0;y<i;a++,y++){const w=u[y*s],M=u[y*s+1],R=s>2?u[y*s+2]:0;r[a*3]=w,r[a*3+1]=M,r[a*3+2]=R}}_updateVertexValid(e,{vertexStart:n,geometrySize:i}){const{positionSize:r}=this,s=this.attributes.vertexValid,u=e&&qd(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+i),u)for(let a=0;a<u.length;a++)s[n+u[a]/r-1]=0;s[n+i-1]=0}}function Fx(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const nP=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,lJ=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(nP,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),cJ=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(nP,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),uJ=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Jp=[0,0,0,255],hJ={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Jp},getLineColor:{type:"accessor",value:Jp},material:!0},Ad={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class J2 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?lJ:cJ,fs:uJ,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Cu,hq,Pu]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:i}=this.props;const{_full3d:r}=this.props;n.isGeospatial&&i===$n.DEFAULT&&(i=$n.LNGLAT);let s;i===$n.LNGLAT&&(r?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new aJ({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||g8(e,Si.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const u=this.getAttributeManager(),a=!0;u.remove(["instancePickingColors"]),u.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Ad,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,transition:Ad,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ad,accessor:"getFillColor",defaultValue:Jp,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ad,accessor:"getLineColor",defaultValue:Jp,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(y,{index:w,target:M})=>this.encodePickingColor(y&&y.__source?y.__source.index:w,M),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(s=>s.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:i,wireframe:r,elevationScale:s}=this.props,{topModel:u,sideModel:a,polygonTesselator:y}=this.state,w={...e,extruded:!!n,elevationScale:s};a&&(a.setInstanceCount(y.instanceCount-1),a.setUniforms(w),r&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),i&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),u&&(u.setVertexCount(y.vertexCount),u.setUniforms(w).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager();if(r.extensionsChanged||n.filled!==i.filled||n.extruded!==i.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(y=>y.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,u=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:u.getPolygon,buffers:u,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:i,extruded:r}=this.props;let s,u;if(i){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new o0(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(u=new o0(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Ql({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),u.userData.excludeAttributes={indices:!0}),{models:[u,s].filter(Boolean),topModel:s,sideModel:u}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}Z(J2,"defaultProps",hJ);Z(J2,"layerName","SolidPolygonLayer");function fJ({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:s=1/0}=n,u=t.length;let a=u,y=u;for(let L=0;L<u;L++){const U=e(t[L]);if(a>L&&U>=r&&(a=L),U>=s){y=L;break}}let w=a;const R=y-a!==i.length?t.slice(y):void 0;for(let L=0;L<i.length;L++)t[w++]=i[L];if(R){for(let L=0;L<R.length;L++)t[w++]=R[L];t.length=w}return{startRow:a,endRow:a+i.length}}function AJ(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return n!==-1?dJ(t,i,n):null}function dJ(t,e,n){const i={properties:{...t.properties[e]}};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}function pJ(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(r.length*3);const s=[];for(let u=0;u<r.length;u++)e(r[u],s),n[i][u*3+0]=s[0],n[i][u*3+1]=s[1],n[i][u*3+2]=s[2]}return n}const mJ=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,j4=192/256,Nx=[],gJ={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class V8 extends z3{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:mJ}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;let{outlineColor:r}=n;r!==i.outlineColor&&(r=r.map(s=>s/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!n.sdf&&n.outlineWidth&&Hn.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:i,outlineWidth:r}=this.props,{outlineColor:s}=this.state,u=r?Math.max(i,j4*(1-r)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:j4,outlineBuffer:u,gamma:i,sdf:!!n,outlineColor:s},super.draw(e),n&&r){const{iconManager:a}=this.state;a.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:j4}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):Nx}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):Nx}}Z(V8,"defaultProps",gJ);Z(V8,"layerName","MultiIconLayer");const t2=1e20;class _J{constructor({fontSize:e=24,buffer:n=3,radius:i=8,cutoff:r=.25,fontFamily:s="sans-serif",fontWeight:u="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=r,this.radius=i;const y=this.size=e+n*4,w=this._createCanvas(y),M=this.ctx=w.getContext("2d",{willReadFrequently:!0});M.font=`${a} ${u} ${e}px ${s}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:s,actualBoundingBoxRight:u}=this.ctx.measureText(e),a=Math.ceil(i),y=0,w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(u-s))),M=Math.min(this.size-this.buffer,a+Math.ceil(r)),R=w+2*this.buffer,L=M+2*this.buffer,U=Math.max(R*L,0),q=new Uint8ClampedArray(U),te={data:q,width:R,height:L,glyphWidth:w,glyphHeight:M,glyphTop:a,glyphLeft:y,glyphAdvance:n};if(w===0||M===0)return te;const{ctx:pe,buffer:ne,gridInner:ie,gridOuter:re}=this;pe.clearRect(ne,ne,w,M),pe.fillText(e,ne,ne+a);const _e=pe.getImageData(ne,ne,w,M);re.fill(t2,0,U),ie.fill(0,0,U);for(let Te=0;Te<M;Te++)for(let De=0;De<w;De++){const $e=_e.data[4*(Te*w+De)+3]/255;if($e===0)continue;const nt=(Te+ne)*R+De+ne;if($e===1)re[nt]=0,ie[nt]=t2;else{const ut=.5-$e;re[nt]=ut>0?ut*ut:0,ie[nt]=ut<0?ut*ut:0}}Ux(re,0,0,R,L,R,this.f,this.v,this.z),Ux(ie,ne,ne,w,M,R,this.f,this.v,this.z);for(let Te=0;Te<U;Te++){const De=Math.sqrt(re[Te])-Math.sqrt(ie[Te]);q[Te]=Math.round(255-255*(De/this.radius+this.cutoff))}return te}}function Ux(t,e,n,i,r,s,u,a,y){for(let w=e;w<e+i;w++)Vx(t,n*s+w,s,r,u,a,y);for(let w=n;w<n+r;w++)Vx(t,w*s+e,1,i,u,a,y)}function Vx(t,e,n,i,r,s,u){s[0]=0,u[0]=-t2,u[1]=t2,r[0]=t[e];for(let a=1,y=0,w=0;a<i;a++){r[a]=t[e+a*n];const M=a*a;do{const R=s[y];w=(r[a]-r[R]+M-R*R)/(a-R)/2}while(w<=u[y]&&--y>-1);y++,s[y]=a,u[y]=w,u[y+1]=t2}for(let a=0,y=0;a<i;a++){for(;u[y+1]<a;)y++;const w=s[y],M=a-w;t[e+a*n]=r[w]+M*M}}const yJ=32,vJ=[];function xJ(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function wJ({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:u=0,yOffset:a=0}){let y=0,w=u;const M=n+i*2;for(const R of t)if(!s[R]){const L=e(R);w+L+i*2>r&&(w=0,y++),s[R]={x:w+i,y:a+y*M+i,width:L,height:M,layoutWidth:L,layoutHeight:n},w+=L+i*2}return{mapping:s,xOffset:w,yOffset:a+y*M,canvasHeight:xJ(a+(y+1)*M)}}function iP(t,e,n,i){let r=0;for(let u=e;u<n;u++){var s;const a=t[u];r+=((s=i[a])===null||s===void 0?void 0:s.layoutWidth)||0}return r}function rP(t,e,n,i,r,s){let u=e,a=0;for(let y=e;y<n;y++){const w=iP(t,y,y+1,r);a+w>i&&(u<y&&s.push(y),u=y,a=0),a+=w}return a}function bJ(t,e,n,i,r,s){let u=e,a=e,y=e,w=0;for(let M=e;M<n;M++)if((t[M]===" "||t[M+1]===" "||M+1===n)&&(y=M+1),y>a){let R=iP(t,a,y,r);w+R>i&&(u<a&&(s.push(a),u=a,w=0),R>i&&(R=rP(t,a,y,i,r,s),u=s[s.length-1])),a=y,w+=R}return w}function EJ(t,e,n,i,r=0,s){s===void 0&&(s=t.length);const u=[];return e==="break-all"?rP(t,r,s,n,i,u):bJ(t,r,s,n,i,u),u}function TJ(t,e,n,i,r,s){let u=0,a=0;for(let y=e;y<n;y++){const w=t[y],M=i[w];M?(a||(a=M.layoutHeight),r[y]=u+M.layoutWidth/2,u+=M.layoutWidth):(Hn.warn("Missing character: ".concat(w," (").concat(w.codePointAt(0),")"))(),r[y]=u,u+=yJ)}s[0]=u,s[1]=a}function SJ(t,e,n,i,r){const s=Array.from(t),u=s.length,a=new Array(u),y=new Array(u),w=new Array(u),M=(n==="break-word"||n==="break-all")&&isFinite(i)&&i>0,R=[0,0],L=[0,0];let U=0,q=0,te=0;for(let ne=0;ne<=u;ne++){const ie=s[ne];if((ie===`
`||ne===u)&&(te=ne),te>q){const re=M?EJ(s,n,i,r,q,te):vJ;for(let _e=0;_e<=re.length;_e++){const Te=_e===0?q:re[_e-1],De=_e<re.length?re[_e]:te;TJ(s,Te,De,r,a,L);for(let $e=Te;$e<De;$e++){var pe;const nt=s[$e],ut=((pe=r[nt])===null||pe===void 0?void 0:pe.layoutOffsetY)||0;y[$e]=U+L[1]/2+ut,w[$e]=L[0]}U=U+L[1]*e,R[0]=Math.max(R[0],L[0])}q=te}ie===`
`&&(a[q]=0,y[q]=0,w[q]=0,q++)}return R[1]=U,{x:a,y,rowWidth:w,size:R}}function CJ({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:s}){const u=t.BYTES_PER_ELEMENT,a=n?n/u:1,y=i?i/u:0,w=r[e]||Math.ceil((t.length-y)/a),M=s&&new Set,R=new Array(e);let L=t;if(a>1||y>0){const U=t.constructor;L=new U(w);for(let q=0;q<w;q++)L[q]=t[q*a+y]}for(let U=0;U<e;U++){const q=r[U],te=r[U+1]||w,pe=L.subarray(q,te);R[U]=String.fromCodePoint.apply(null,pe),M&&pe.forEach(M.add,M)}if(M)for(const U of M)s.add(String.fromCodePoint(U));return{texts:R,characterCount:w}}class sP{constructor(e=5){Z(this,"limit",void 0),Z(this,"_cache",{}),Z(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function PJ(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const r1={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:PJ(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},Gx=1024,jx=.9,Hx=1.2,oP=3;let e3=new sP(oP);function MJ(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const i=e3.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}function IJ(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Wx(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function kJ(t){Hn.assert(Number.isFinite(t)&&t>=oP,"Invalid cache limit"),e3=new sP(t)}class LJ{constructor(){Z(this,"props",{...r1}),Z(this,"_key",void 0),Z(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*Hx+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=MJ(this._key,this.props.characterSet),i=e3.get(this._key);if(i&&n.size===0){this._atlas!==i&&(this._atlas=i);return}const r=this._generateFontAtlas(n,i);this._atlas=r,e3.set(this._key,r)}_generateFontAtlas(e,n){const{fontFamily:i,fontWeight:r,fontSize:s,buffer:u,sdf:a,radius:y,cutoff:w}=this.props;let M=n&&n.data;M||(M=document.createElement("canvas"),M.width=Gx);const R=M.getContext("2d",{willReadFrequently:!0});Wx(R,i,s,r);const{mapping:L,canvasHeight:U,xOffset:q,yOffset:te}=wJ({getFontWidth:pe=>R.measureText(pe).width,fontHeight:s*Hx,buffer:u,characterSet:e,maxCanvasWidth:Gx,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(M.height!==U){const pe=R.getImageData(0,0,M.width,M.height);M.height=U,R.putImageData(pe,0,0)}if(Wx(R,i,s,r),a){const pe=new _J({fontSize:s,buffer:u,radius:y,cutoff:w,fontFamily:i,fontWeight:"".concat(r)});for(const ne of e){const{data:ie,width:re,height:_e,glyphTop:Te}=pe.draw(ne);L[ne].width=re,L[ne].layoutOffsetY=s*jx-Te;const De=R.createImageData(re,_e);IJ(ie,De),R.putImageData(De,L[ne].x,L[ne].y)}}else for(const pe of e)R.fillText(pe,L[pe].x,L[pe].y+u+s*jx);return{xOffset:q,yOffset:te,mapping:L,data:M,width:M.width,height:M.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:i,buffer:r,sdf:s,radius:u,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(i," ").concat(r," ").concat(u," ").concat(a):"".concat(e," ").concat(n," ").concat(i," ").concat(r)}}const DJ=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,RJ=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,zJ={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class G8 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return super.getShaders({vs:DJ,fs:RJ,modules:[Cu,Pu]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var i;const{gl:r}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:s,sizeMaxPixels:u,getLineWidth:a}=this.props;let{padding:y}=this.props;y.length<4&&(y=[y[0],y[1],y[0],y[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!a,padding:y,sizeUnits:fu[r],sizeScale:i,sizeMinPixels:s,sizeMaxPixels:u}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new o0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}Z(G8,"defaultProps",zJ);Z(G8,"layerName","TextBackgroundLayer");const $x={start:1,middle:0,end:-1},qx={top:1,center:0,bottom:-1},H4=[0,0,0,255],BJ=1,OJ={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:H4},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:r1.characterSet},fontFamily:r1.fontFamily,fontWeight:r1.fontWeight,lineHeight:BJ,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:H4},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:H4},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class j8 extends ur{constructor(...e){super(...e),Z(this,"state",void 0),Z(this,"getBoundingRect",(n,i)=>{let{size:[r,s]}=this.transformParagraph(n,i);const{fontSize:u}=this.state.fontAtlasManager.props;r/=u,s/=u;const{getTextAnchor:a,getAlignmentBaseline:y}=this.props,w=$x[typeof a=="function"?a(n,i):a],M=qx[typeof y=="function"?y(n,i):y];return[(w-1)*r/2,(M-1)*s/2,r,s]}),Z(this,"getIconOffsets",(n,i)=>{const{getTextAnchor:r,getAlignmentBaseline:s}=this.props,{x:u,y:a,rowWidth:y,size:[w,M]}=this.transformParagraph(n,i),R=$x[typeof r=="function"?r(n,i):r],L=qx[typeof s=="function"?s(n,i):s],U=u.length,q=new Array(U*2);let te=0;for(let pe=0;pe<U;pe++){const ne=(1-R)*(w-y[pe])/2;q[te++]=(R-1)*w/2+ne+u[pe],q[te++]=(L-1)*M/2+a[pe]}return q})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new LJ},this.props.maxWidth>0&&Hn.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==i.lineHeight||n.wordBreak!==i.wordBreak||n.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:s}=this.state,u={...e,characterSet:s,fontFamily:n,fontWeight:i};if(!r.mapping)return r.setProps(u),!0;for(const a in u)if(u[a]!==r.props[a])return r.setProps(u),!0;return!1}_updateText(){var e;const{data:n,characterSet:i}=this.props,r=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,u=n.startIndices,a;const y=i==="auto"&&new Set;if(r&&u){const{texts:w,characterCount:M}=CJ({...ArrayBuffer.isView(r)?{value:r}:r,length:n.length,startIndices:u,characterSet:y});a=M,s=(R,{index:L})=>w[L]}else{const{iterable:w,objectInfo:M}=K2(n);u=[0],a=0;for(const R of w){M.index++;const L=Array.from(s(R,M)||"");y&&L.forEach(y.add,y),a+=L.length,u.push(a)}}this.setState({getText:s,startIndices:u,numInstances:a,characterSet:y||i})}transformParagraph(e,n){const{fontAtlasManager:i}=this.state,r=i.mapping,s=this.state.getText,{wordBreak:u,lineHeight:a,maxWidth:y}=this.props,w=s(e,n)||"";return SJ(w,a,u,y*i.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:n,getText:i,fontAtlasManager:{scale:r,texture:s,mapping:u},styleVersion:a}=this.state,{data:y,_dataDiff:w,getPosition:M,getColor:R,getSize:L,getAngle:U,getPixelOffset:q,getBackgroundColor:te,getBorderColor:pe,getBorderWidth:ne,backgroundPadding:ie,background:re,billboard:_e,fontSettings:Te,outlineWidth:De,outlineColor:$e,sizeScale:nt,sizeUnits:ut,sizeMinPixels:st,sizeMaxPixels:lt,transitions:Lt,updateTriggers:ht}=this.props,Tt=this.getSubLayerClass("characters",V8),Pn=this.getSubLayerClass("background",G8);return[re&&new Pn({getFillColor:te,getLineColor:pe,getLineWidth:ne,padding:ie,getPosition:M,getSize:L,getAngle:U,getPixelOffset:q,billboard:_e,sizeScale:nt,sizeUnits:ut,sizeMinPixels:st,sizeMaxPixels:lt,transitions:Lt&&{getPosition:Lt.getPosition,getAngle:Lt.getAngle,getSize:Lt.getSize,getFillColor:Lt.getBackgroundColor,getLineColor:Lt.getBorderColor,getLineWidth:Lt.getBorderWidth,getPixelOffset:Lt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:ht.getPosition,getAngle:ht.getAngle,getSize:ht.getSize,getFillColor:ht.getBackgroundColor,getLineColor:ht.getBorderColor,getLineWidth:ht.getBorderWidth,getPixelOffset:ht.getPixelOffset,getBoundingRect:{getText:ht.getText,getTextAnchor:ht.getTextAnchor,getAlignmentBaseline:ht.getAlignmentBaseline,styleVersion:a}}}),{data:y.attributes&&y.attributes.background?{length:y.length,attributes:y.attributes.background}:y,_dataDiff:w,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new Tt({sdf:Te.sdf,smoothing:Number.isFinite(Te.smoothing)?Te.smoothing:r1.smoothing,outlineWidth:De/(Te.radius||r1.radius),outlineColor:$e,iconAtlas:s,iconMapping:u,getPosition:M,getColor:R,getSize:L,getAngle:U,getPixelOffset:q,billboard:_e,sizeScale:nt*r,sizeUnits:ut,sizeMinPixels:st*r,sizeMaxPixels:lt*r,transitions:Lt&&{getPosition:Lt.getPosition,getAngle:Lt.getAngle,getColor:Lt.getColor,getSize:Lt.getSize,getPixelOffset:Lt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:ht.getText,getPosition:ht.getPosition,getAngle:ht.getAngle,getColor:ht.getColor,getSize:ht.getSize,getPixelOffset:ht.getPixelOffset,getIconOffsets:{getTextAnchor:ht.getTextAnchor,getAlignmentBaseline:ht.getAlignmentBaseline,styleVersion:a}}}),{data:y,_dataDiff:w,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){kJ(e)}}Z(j8,"defaultProps",OJ);Z(j8,"layerName","TextLayer");const Zd={circle:{type:F8,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:z3,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:j8,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Xd={type:N8,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},zg={type:J2,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Pf({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function W4(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const u=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[u]=i[s],n&&(r.transitions[u]=n[s])),r[u]=a}return r}function FJ(t){if(Array.isArray(t))return t;switch(Hn.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Hn.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function Zx(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:s=t.length}=n;for(let u=r;u<s;u++){const a=t[u],{geometry:y}=a;if(y)if(y.type==="GeometryCollection"){Hn.assert(Array.isArray(y.geometries),"GeoJSON does not have geometries array");const{geometries:w}=y;for(let M=0;M<w.length;M++){const R=w[M];Xx(R,i,e,a,u)}}else Xx(y,i,e,a,u)}return i}function Xx(t,e,n,i,r){const{type:s,coordinates:u}=t,{pointFeatures:a,lineFeatures:y,polygonFeatures:w,polygonOutlineFeatures:M}=e;if(!UJ(s,u)){Hn.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":u.forEach(R=>{a.push(n({geometry:{type:"Point",coordinates:R}},i,r))});break;case"LineString":y.push(n({geometry:t},i,r));break;case"MultiLineString":u.forEach(R=>{y.push(n({geometry:{type:"LineString",coordinates:R}},i,r))});break;case"Polygon":w.push(n({geometry:t},i,r)),u.forEach(R=>{M.push(n({geometry:{type:"LineString",coordinates:R}},i,r))});break;case"MultiPolygon":u.forEach(R=>{w.push(n({geometry:{type:"Polygon",coordinates:R}},i,r)),R.forEach(L=>{M.push(n({geometry:{type:"LineString",coordinates:L}},i,r))})});break}}const NJ={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function UJ(t,e){let n=NJ[t];for(Hn.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function aP(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function dd(t){return t.geometry.coordinates}function VJ(t,e){const n=aP(),{pointFeatures:i,lineFeatures:r,polygonFeatures:s,polygonOutlineFeatures:u}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=dd,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=dd,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=dd,n.polygonsOutline.data=u,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=dd,n}function GJ(t,e){const n=aP(),{points:i,lines:r,polygons:s}=t,u=pJ(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:u.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:u.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:u.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:u.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const jJ=["points","linestrings","polygons"],HJ={...Pf(Zd.circle),...Pf(Zd.icon),...Pf(Zd.text),...Pf(Xd),...Pf(zg),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class H8 extends ur{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const i=GJ(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:n}){const i=FJ(e.data),r=this.getSubLayerRow.bind(this);let s={};const u={};if(Array.isArray(n.dataChanged)){const y=this.state.features;for(const w in y)s[w]=y[w].slice(),u[w]=[];for(const w of n.dataChanged){const M=Zx(i,r,w);for(const R in y)u[R].push(fJ({data:s[R],getIndex:L=>L.__source.index,dataRange:w,replace:M[R]}))}}else s=Zx(i,r);const a=VJ(s,u);this.setState({features:s,featuresDiff:u,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i,sourceLayer:r}=n;return n.featureType=jJ.find(s=>r.id.startsWith("".concat(this.id,"-").concat(s,"-"))),i>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[i]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),i=e.featureType==="points";for(const r of this.getSubLayers())r.id.startsWith(n)===i&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:i}=this.state,r="polygons-fill",s=this.shouldRenderSubLayer(r,i.polygons.data)&&this.getSubLayerClass(r,zg.type);if(s){const u=W4(this,zg.props),a=e&&n;return a||delete u.getLineColor,u.updateTriggers.lineColors=a,new s(u,this.getSubLayerProps({id:r,updateTriggers:u.updateTriggers}),i.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:i}=this.state,r="polygons-stroke",s="linestrings",u=!e&&n&&this.shouldRenderSubLayer(r,i.polygonsOutline.data)&&this.getSubLayerClass(r,Xd.type),a=this.shouldRenderSubLayer(s,i.lines.data)&&this.getSubLayerClass(s,Xd.type);if(u||a){const y=W4(this,Xd.props);return[u&&new u(y,this.getSubLayerProps({id:r,updateTriggers:y.updateTriggers}),i.polygonsOutline),a&&new a(y,this.getSubLayerProps({id:s,updateTriggers:y.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:i}=this.state;let{highlightedObjectIndex:r}=this.props;!i&&Number.isFinite(r)&&(r=n.points.data.findIndex(a=>a.__source.index===r));const s=new Set(e.split("+")),u=[];for(const a of s){const y="points-".concat(a),w=Zd[a],M=w&&this.shouldRenderSubLayer(y,n.points.data)&&this.getSubLayerClass(y,w.type);if(M){const R=W4(this,w.props);let L=n.points;if(a==="text"&&i){const{instancePickingColors:U,...q}=L.data.attributes;L={...L,data:{...L.data,attributes:q}}}u.push(new M(R,this.getSubLayerProps({id:y,updateTriggers:R.updateTriggers,highlightedObjectIndex:r}),L))}}return u}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),i=this._renderLineLayers(),r=this._renderPointLayers();return[!e&&n,i,r,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(i,r)=>{const{data:s,index:u}=r,a=AJ(s,u);return e(a,r)}}}Z(H8,"layerName","GeoJsonLayer");Z(H8,"defaultProps",HJ);class WJ{constructor(e){Z(this,"index",void 0),Z(this,"isVisible",void 0),Z(this,"isSelected",void 0),Z(this,"parent",void 0),Z(this,"children",void 0),Z(this,"content",void 0),Z(this,"state",void 0),Z(this,"layers",void 0),Z(this,"id",void 0),Z(this,"zoom",void 0),Z(this,"userData",void 0),Z(this,"boundingBox",void 0),Z(this,"_abortController",void 0),Z(this,"_loader",void 0),Z(this,"_loaderId",void 0),Z(this,"_isLoaded",void 0),Z(this,"_isCancelled",void 0),Z(this,"_needsReload",void 0),Z(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:i,onError:r}){const{index:s,id:u,bbox:a,userData:y,zoom:w}=this,M=this._loaderId;this._abortController=new AbortController;const{signal:R}=this._abortController,L=await n.scheduleRequest(this,te=>te.isSelected?1:-1);if(!L){this._isCancelled=!0;return}if(this._isCancelled){L.done();return}let U=null,q;try{U=await e({index:s,id:u,bbox:a,userData:y,zoom:w,signal:R})}catch(te){q=te||!0}finally{L.done()}if(M===this._loaderId){if(this._loader=void 0,this.content=U,this._isCancelled&&!U){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,q?r(q,this):i(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const ss={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},Qx=new qt,$J=new qt;class W8{constructor(e=[0,0,0],n=[0,0,0],i){Z(this,"center",void 0),Z(this,"halfDiagonal",void 0),Z(this,"minimum",void 0),Z(this,"maximum",void 0),i=i||Qx.copy(e).add(n).scale(.5),this.center=new qt(i),this.halfDiagonal=new qt(n).subtract(this.center),this.minimum=new qt(e),this.maximum=new qt(n)}clone(){return new W8(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,i=$J.from(e.normal),r=n.x*Math.abs(i.x)+n.y*Math.abs(i.y)+n.z*Math.abs(i.z),s=this.center.dot(i)+e.distance;return s-r>0?ss.INSIDE:s+r<0?ss.OUTSIDE:ss.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=Qx.from(e).subtract(this.center),{halfDiagonal:i}=this;let r=0,s;return s=Math.abs(n.x)-i.x,s>0&&(r+=s*s),s=Math.abs(n.y)-i.y,s>0&&(r+=s*s),s=Math.abs(n.z)-i.z,s>0&&(r+=s*s),r}}const Mf=new qt,Yx=new qt;class $8{constructor(e=[0,0,0],n=0){Z(this,"center",void 0),Z(this,"radius",void 0),this.radius=-0,this.center=new qt,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Mf.from(n),this.center=new qt().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new $8(this.center,this.radius)}union(e){const n=this.center,i=this.radius,r=e.center,s=e.radius,u=Mf.copy(r).subtract(n),a=u.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const y=(i+a+s)*.5;return Yx.copy(u).scale((-i+y)/a).add(n),this.center.copy(Yx),this.radius=y,this}expand(e){const i=Mf.from(e).subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(e){this.center.transform(e);const n=_$(Mf,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const i=Mf.from(e).subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(e){const n=this.center,i=this.radius,s=e.normal.dot(n)+e.distance;return s<-i?ss.OUTSIDE:s<i?ss.INTERSECTING:ss.INSIDE}}const qJ=new qt,ZJ=new qt,pd=new qt,md=new qt,gd=new qt,XJ=new qt,QJ=new qt,Ol={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class q8{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){Z(this,"center",void 0),Z(this,"halfAxes",void 0),this.center=new qt().from(e),this.halfAxes=new Vr(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new qt(e).len(),new qt(n).len(),new qt(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new qt(e).normalize(),s=new qt(n).normalize(),u=new qt(i).normalize();return new Ov().fromMatrix3(new Vr([...r,...s,...u]))}fromCenterHalfSizeQuaternion(e,n,i){const r=new Ov(i),s=new Vr().fromQuaternion(r);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new qt().from(e),this.halfAxes=s,this}clone(){return new q8(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new $8){const n=this.halfAxes,i=n.getColumn(0,pd),r=n.getColumn(1,md),s=n.getColumn(2,gd),u=qJ.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=u.magnitude(),e}intersectPlane(e){const n=this.center,i=e.normal,r=this.halfAxes,s=i.x,u=i.y,a=i.z,y=Math.abs(s*r[Ol.COLUMN0ROW0]+u*r[Ol.COLUMN0ROW1]+a*r[Ol.COLUMN0ROW2])+Math.abs(s*r[Ol.COLUMN1ROW0]+u*r[Ol.COLUMN1ROW1]+a*r[Ol.COLUMN1ROW2])+Math.abs(s*r[Ol.COLUMN2ROW0]+u*r[Ol.COLUMN2ROW1]+a*r[Ol.COLUMN2ROW2]),w=i.dot(n)+e.distance;return w<=-y?ss.OUTSIDE:w>=y?ss.INSIDE:ss.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=ZJ.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,pd),s=i.getColumn(1,md),u=i.getColumn(2,gd),a=r.magnitude(),y=s.magnitude(),w=u.magnitude();r.normalize(),s.normalize(),u.normalize();let M=0,R;return R=Math.abs(n.dot(r))-a,R>0&&(M+=R*R),R=Math.abs(n.dot(s))-y,R>0&&(M+=R*R),R=Math.abs(n.dot(u))-w,R>0&&(M+=R*R),M}computePlaneDistances(e,n,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const u=this.center,a=this.halfAxes,y=a.getColumn(0,pd),w=a.getColumn(1,md),M=a.getColumn(2,gd),R=XJ.copy(y).add(w).add(M).add(u),L=QJ.copy(R).subtract(e);let U=n.dot(L);return r=Math.min(U,r),s=Math.max(U,s),R.copy(u).add(y).add(w).subtract(M),L.copy(R).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),R.copy(u).add(y).subtract(w).add(M),L.copy(R).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),R.copy(u).add(y).subtract(w).subtract(M),L.copy(R).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),u.copy(R).subtract(y).add(w).add(M),L.copy(R).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),u.copy(R).subtract(y).add(w).subtract(M),L.copy(R).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),u.copy(R).subtract(y).subtract(w).add(M),L.copy(R).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),u.copy(R).subtract(y).subtract(w).subtract(M),L.copy(R).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,pd);n.transformAsPoint(e);const i=this.halfAxes.getColumn(1,md);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,gd);return r.transformAsPoint(e),this.halfAxes=new Vr([...n,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const Kx=new qt,Jx=new qt;class E1{constructor(e=[0,0,1],n=0){Z(this,"normal",void 0),Z(this,"distance",void 0),this.normal=new qt,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return P2(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=Kx.from(e),this.normal.from(n).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,n,i,r){return this.normal.set(e,n,i),P2(Xl(this.normal.len(),1)),this.distance=r,this}clone(){return new E1(this.normal,this.distance)}equals(e){return Xl(this.distance,e.distance)&&Xl(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=Jx.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,n)}projectPointOntoPlane(e,n=[0,0,0]){e=Kx.from(e);const i=this.getPointDistance(e),r=Jx.copy(this.normal).scale(i);return e.subtract(r).to(n)}}const ew=[new qt([1,0,0]),new qt([0,1,0]),new qt([0,0,1])],tw=new qt,YJ=new qt;new E1(new qt(1,0,0),0);class ql{constructor(e=[]){Z(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*ew.length;const n=e.center,i=e.radius;let r=0;for(const s of ew){let u=this.planes[r],a=this.planes[r+1];u||(u=this.planes[r]=new E1),a||(a=this.planes[r+1]=new E1);const y=tw.copy(s).scale(-i).add(n);-s.dot(y),u.fromPointNormal(y,s);const w=tw.copy(s).scale(i).add(n),M=YJ.copy(s).negate();-M.dot(w),a.fromPointNormal(w,M),r+=2}return this}computeVisibility(e){let n=ss.INSIDE;for(const i of this.planes)switch(e.intersectPlane(i)){case ss.OUTSIDE:return ss.OUTSIDE;case ss.INTERSECTING:n=ss.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(P2(Number.isFinite(n),"parentPlaneMask is required."),n===ql.MASK_OUTSIDE||n===ql.MASK_INSIDE)return n;let i=ql.MASK_INSIDE;const r=this.planes;for(let s=0;s<this.planes.length;++s){const u=s<31?1<<s:0;if(s<31&&!(n&u))continue;const a=r[s],y=e.intersectPlane(a);if(y===ss.OUTSIDE)return ql.MASK_OUTSIDE;y===ss.INTERSECTING&&(i|=u)}return i}}Z(ql,"MASK_OUTSIDE",4294967295);Z(ql,"MASK_INSIDE",0);Z(ql,"MASK_INDETERMINATE",2147483647);new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;new qt;const Wa=new Vr,KJ=new Vr,JJ=new Vr,_d=new Vr,nw=new Vr;function eee(t,e={}){const n=eC.EPSILON20,i=10;let r=0,s=0;const u=KJ,a=JJ;u.identity(),a.copy(t);const y=n*tee(a);for(;s<i&&nee(a)>y;)iee(a,_d),nw.copy(_d).transpose(),a.multiplyRight(_d),a.multiplyLeft(nw),u.multiplyRight(_d),++r>2&&(++s,r=0);return e.unitary=u.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function tee(t){let e=0;for(let n=0;n<9;++n){const i=t[n];e+=i*i}return Math.sqrt(e)}const Bg=[1,0,0],Og=[2,2,1];function nee(t){let e=0;for(let n=0;n<3;++n){const i=t[Wa.getElementIndex(Og[n],Bg[n])];e+=2*i*i}return Math.sqrt(e)}function iee(t,e){const n=eC.EPSILON15;let i=0,r=1;for(let w=0;w<3;++w){const M=Math.abs(t[Wa.getElementIndex(Og[w],Bg[w])]);M>i&&(r=w,i=M)}const s=Bg[r],u=Og[r];let a=1,y=0;if(Math.abs(t[Wa.getElementIndex(u,s)])>n){const w=t[Wa.getElementIndex(u,u)],M=t[Wa.getElementIndex(s,s)],R=t[Wa.getElementIndex(u,s)],L=(w-M)/2/R;let U;L<0?U=-1/(-L+Math.sqrt(1+L*L)):U=1/(L+Math.sqrt(1+L*L)),a=1/Math.sqrt(1+U*U),y=U*a}return Vr.IDENTITY.to(e),e[Wa.getElementIndex(s,s)]=e[Wa.getElementIndex(u,u)]=a,e[Wa.getElementIndex(u,s)]=y,e[Wa.getElementIndex(s,u)]=-y,e}const O0=new qt,ree=new qt,see=new qt,oee=new qt,aee=new qt,lee=new Vr,cee={diagonal:new Vr,unitary:new Vr};function uee(t,e=new q8){if(!t||t.length===0)return e.halfAxes=new Vr([0,0,0,0,0,0,0,0,0]),e.center=new qt,e;const n=t.length,i=new qt(0,0,0);for(const ut of t)i.add(ut);const r=1/n;i.multiplyByScalar(r);let s=0,u=0,a=0,y=0,w=0,M=0;for(const ut of t){const st=O0.copy(ut).subtract(i);s+=st.x*st.x,u+=st.x*st.y,a+=st.x*st.z,y+=st.y*st.y,w+=st.y*st.z,M+=st.z*st.z}s*=r,u*=r,a*=r,y*=r,w*=r,M*=r;const R=lee;R[0]=s,R[1]=u,R[2]=a,R[3]=u,R[4]=y,R[5]=w,R[6]=a,R[7]=w,R[8]=M;const{unitary:L}=eee(R,cee),U=e.halfAxes.copy(L);let q=U.getColumn(0,see),te=U.getColumn(1,oee),pe=U.getColumn(2,aee),ne=-Number.MAX_VALUE,ie=-Number.MAX_VALUE,re=-Number.MAX_VALUE,_e=Number.MAX_VALUE,Te=Number.MAX_VALUE,De=Number.MAX_VALUE;for(const ut of t)O0.copy(ut),ne=Math.max(O0.dot(q),ne),ie=Math.max(O0.dot(te),ie),re=Math.max(O0.dot(pe),re),_e=Math.min(O0.dot(q),_e),Te=Math.min(O0.dot(te),Te),De=Math.min(O0.dot(pe),De);q=q.multiplyByScalar(.5*(_e+ne)),te=te.multiplyByScalar(.5*(Te+ie)),pe=pe.multiplyByScalar(.5*(De+re)),e.center.copy(q).add(te).add(pe);const $e=ree.set(ne-_e,ie-Te,re-De).multiplyByScalar(.5),nt=new Vr([$e[0],0,0,0,$e[1],0,0,0,$e[2]]);return e.halfAxes.multiplyRight(nt),e}const Wh=512,iw=3,lP=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],cP=lP.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),hee=cP.concat([[.25,.5],[.75,.5]]);class $h{constructor(e,n,i){Z(this,"x",void 0),Z(this,"y",void 0),Z(this,"z",void 0),Z(this,"childVisible",void 0),Z(this,"selected",void 0),Z(this,"_children",void 0),this.x=e,this.y=n,this.z=i}get children(){if(!this._children){const e=this.x*2,n=this.y*2,i=this.z+1;this._children=[new $h(e,n,i),new $h(e,n+1,i),new $h(e+1,n,i),new $h(e+1,n+1,i)]}return this._children}update(e){const{viewport:n,cullingVolume:i,elevationBounds:r,minZ:s,maxZ:u,bounds:a,offset:y,project:w}=e,M=this.getBoundingVolume(r,y,w);if(a&&!this.insideBounds(a)||i.computeVisibility(M)<0)return!1;if(!this.childVisible){let{z:L}=this;if(L<u&&L>=s){const U=M.distanceTo(n.cameraPosition)*n.scale/n.height;L+=Math.floor(Math.log2(U))}if(L>=u)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const L of this.children)L.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,i,r]){const s=Math.pow(2,this.z),u=Wh/s;return this.x*u<i&&this.y*u<r&&(this.x+1)*u>e&&(this.y+1)*u>n}getBoundingVolume(e,n,i){if(i){const y=this.z<1?hee:this.z<2?cP:lP,w=[];for(const M of y){const R=Ng(this.x+M[0],this.y+M[1],this.z);R[2]=e[0],w.push(i(R)),e[0]!==e[1]&&(R[2]=e[1],w.push(i(R)))}return uee(w)}const r=Math.pow(2,this.z),s=Wh/r,u=this.x*s+n*Wh,a=Wh-(this.y+1)*s;return new W8([u,a,e[0]],[u+s,a+s,e[1]])}}function fee(t,e,n,i){const r=t instanceof qY&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:U,distance:q})=>new E1(U.clone().negate(),q)),u=new ql(s),a=t.distanceScales.unitsPerMeter[2],y=n&&n[0]*a||0,w=n&&n[1]*a||0,M=t instanceof lc&&t.pitch<=60?e:0;if(i){const[U,q,te,pe]=i,ne=tl([U,pe]),ie=tl([te,q]);i=[ne[0],Wh-ne[1],ie[0],Wh-ie[1]]}const R=new $h(0,0,0),L={viewport:t,project:r,cullingVolume:u,elevationBounds:[y,w],minZ:M,maxZ:e,bounds:i,offset:0};if(R.update(L),t instanceof lc&&t.subViewports&&t.subViewports.length>1){for(L.offset=-1;R.update(L)&&!(--L.offset<-iw););for(L.offset=1;R.update(L)&&!(++L.offset>iw););}return R.getSelected()}const l0=512,Aee=[-1/0,-1/0,1/0,1/0],dee={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}};function uP(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(r=>r[0])),Math.min(...n.map(r=>r[1])),Math.max(...n.map(r=>r[0])),Math.max(...n.map(r=>r[1]))]}function pee(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function mee(t,e){if(!t||!t.length)return null;const{index:n,id:i}=e;if(Array.isArray(t)){const s=pee(i)%t.length;t=t[s]}let r=t;for(const s of Object.keys(n)){const u=new RegExp("{".concat(s,"}"),"g");r=r.replace(u,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(r=r.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),r}function gee(t,e,n){let i;if(e&&e.length===2){const[r,s]=e,u=t.getBounds({z:r}),a=t.getBounds({z:s});i=[Math.min(u[0],a[0]),Math.min(u[1],a[1]),Math.max(u[2],a[2]),Math.max(u[3],a[3])]}else i=t.getBounds();return t.isGeospatial?[Math.max(i[0],n[0]),Math.max(i[1],n[1]),Math.min(i[2],n[2]),Math.min(i[3],n[3])]:[Math.max(Math.min(i[0],n[2]),n[0]),Math.max(Math.min(i[1],n[3]),n[1]),Math.min(Math.max(i[2],n[0]),n[2]),Math.min(Math.max(i[3],n[1]),n[3])]}function _ee({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(r=>Fg(r,e,n))}function Fg(t,e,n){if(!Array.isArray(e)){const s=n.x-t.x,u=n.y-t.y,{width:a,height:y}=n,w={targetZ:e},M=t.unproject([s,u],w),R=t.unproject([s+a,u],w),L=t.unproject([s,u+y],w),U=t.unproject([s+a,u+y],w);return[Math.min(M[0],R[0],L[0],U[0]),Math.min(M[1],R[1],L[1],U[1]),Math.max(M[0],R[0],L[0],U[0]),Math.max(M[1],R[1],L[1],U[1])]}const i=Fg(t,e[0],n),r=Fg(t,e[1],n);return[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[2],r[2]),Math.max(i[3],r[3])]}function yee(t,e,n){return n?uP(t,n).map(r=>r*e/l0):t.map(i=>i*e/l0)}function Z8(t,e){return Math.pow(2,t)*l0/e}function Ng(t,e,n){const i=Z8(n,l0),r=t/i*360-180,s=Math.PI-2*Math.PI*e/i,u=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[r,u]}function rw(t,e,n,i){const r=Z8(n,i);return[t/r*l0,e/r*l0]}function vee(t,e,n,i,r=l0){if(t.isGeospatial){const[w,M]=Ng(e,n,i),[R,L]=Ng(e+1,n+1,i);return{west:w,north:M,east:R,south:L}}const[s,u]=rw(e,n,i,r),[a,y]=rw(e+1,n+1,i,r);return{left:s,top:u,right:a,bottom:y}}function xee(t,e,n,i,r){const s=gee(t,null,i),u=Z8(e,n),[a,y,w,M]=yee(s,u,r),R=[];for(let L=Math.floor(a);L<w;L++)for(let U=Math.floor(y);U<M;U++)R.push({x:L,y:U,z:e});return R}function wee({viewport:t,maxZoom:e,minZoom:n,zRange:i,extent:r,tileSize:s=l0,modelMatrix:u,modelMatrixInverse:a,zoomOffset:y=0}){let w=t.isGeospatial?Math.round(t.zoom+Math.log2(l0/s))+y:Math.ceil(t.zoom)+y;if(typeof n=="number"&&Number.isFinite(n)&&w<n){if(!r)return[];w=n}typeof e=="number"&&Number.isFinite(e)&&w>e&&(w=e);let M=r;return u&&a&&r&&!t.isGeospatial&&(M=uP(r,u)),t.isGeospatial?fee(t,w,i,r):xee(t,w,s,M||Aee,a)}function bee(t){let e={},n;return i=>{for(const r in i)if(!Eee(i[r],e[r])){n=t(i),e=i;break}return n}}function Eee(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}const sw=1,F3=2,Tee="never",See="no-overlap",X8="best-available",Cee=5,Pee={[X8]:kee,[See]:Lee,[Tee]:()=>{}},Mee={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class Iee{constructor(e){Z(this,"opts",void 0),Z(this,"_requestScheduler",void 0),Z(this,"_cache",void 0),Z(this,"_dirty",void 0),Z(this,"_tiles",void 0),Z(this,"_cacheByteSize",void 0),Z(this,"_viewport",void 0),Z(this,"_zRange",void 0),Z(this,"_selectedTiles",void 0),Z(this,"_frameNumber",void 0),Z(this,"_modelMatrix",void 0),Z(this,"_modelMatrixInverse",void 0),Z(this,"_maxZoom",void 0),Z(this,"_minZoom",void 0),Z(this,"onTileLoad",void 0),Z(this,"_getCullBounds",bee(_ee)),this.opts={...Mee,...e},this.onTileLoad=n=>{var i,r;(i=(r=this.opts).onTileLoad)===null||i===void 0||i.call(r,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new yN({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Ws,this._modelMatrixInverse=new Ws,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:i}={}){const r=new Ws(i),s=!r.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Xl(this._zRange,n)||s){s&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(y=>this._getTile(y,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const u=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),u&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:r}=e;for(const[s,u,a,y]of i){let w;if("west"in r)w=r.west<a&&r.east>s&&r.south<y&&r.north>u;else{const M=Math.min(r.top,r.bottom),R=Math.max(r.top,r.bottom);w=r.left<a&&r.right>s&&M<y&&R>u}if(w)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:i,zRange:r,modelMatrix:s,modelMatrixInverse:u}){const{tileSize:a,extent:y,zoomOffset:w}=this.opts;return wee({viewport:e,maxZoom:n,minZoom:i,zRange:r,tileSize:a,extent:y,modelMatrix:s,modelMatrixInverse:u,zoomOffset:w})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:vee(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),i=Math.floor(e.y/2),r=e.z-1;return{x:n,y:i,z:r}}updateTileStates(){const e=this.opts.refinementStrategy||X8,n=new Array(this._cache.size);let i=0;for(const r of this._cache.values())n[i++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;(typeof e=="function"?e:Pee[e])(Array.from(this._cache.values())),i=0;for(const r of this._cache.values())if(n[i++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let i=0;for(const r of this._cache.values())r.isLoading&&(i++,!r.isSelected&&!r.isVisible&&n.push(r));for(;e>0&&i>e&&n.length>0;)n.shift().abort(),i--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const i=this._getNearestAncestor(n);n.parent=i,i!=null&&i.children&&i.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,i=n.maxCacheSize||(n.maxCacheByteSize?1/0:Cee*this.selectedTiles.length),r=n.maxCacheByteSize||1/0;if(e.size>i||this._cacheByteSize>r){for(const[y,w]of e){if(!w.isVisible&&!w.isSelected){var u,a;this._cacheByteSize-=n.maxCacheByteSize?w.byteLength:0,e.delete(y),(u=(a=this.opts).onTileUnload)===null||u===void 0||u.call(a,w)}if(e.size<=i&&this._cacheByteSize<=r)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((y,w)=>y.zoom-w.zoom),this._dirty=!1)}_getTile(e,n){const i=this.getTileId(e);let r=this._cache.get(i),s=!1;return!r&&n?(r=new WJ(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:i,zoom:this.getTileZoom(r.index)}),s=!0,this._cache.set(i,r),this._dirty=!0):r&&r.needsReload&&(s=!0),r&&s&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:n=0}=this;let i=e.index;for(;this.getTileZoom(i)>n;){i=this.getParentIndex(i);const r=this._getTile(i);if(r)return r}return null}}function kee(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!hP(e)&&Q8(e);for(const e of t)e.isVisible=!!(e.state&F3)}function Lee(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&hP(n);const e=Array.from(t).sort((n,i)=>n.zoom-i.zoom);for(const n of e)if(n.isVisible=!!(n.state&F3),n.children&&(n.isVisible||n.state&sw))for(const i of n.children)i.state=sw;else n.isSelected&&Q8(n)}function hP(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=F3,!0;e=e.parent}return!1}function Q8(t){for(const e of t.children)e.isLoaded||e.content?e.state|=F3:Q8(e)}const Dee={TilesetClass:Iee,data:{type:"data",value:[]},dataComparator:dee.equal,renderSubLayers:{type:"function",value:t=>new H8(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:X8,zRange:null,maxRequests:6,zoomOffset:0};class Y8 extends ur{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,i;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(i=n.selectedTiles)===null||i===void 0?void 0:i.every(r=>r.isLoaded&&r.layers&&r.layers.every(s=>s.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const i=e.propsOrDataChanged||e.updateTriggersChanged,r=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?i&&(n.setOptions(this._getTilesetOptions()),r?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:i,refinementStrategy:r,extent:s,maxZoom:u,minZoom:a,maxRequests:y,zoomOffset:w}=this.props;return{maxCacheSize:n,maxCacheByteSize:i,maxZoom:u,minZoom:a,tileSize:e,refinementStrategy:r,extent:s,maxRequests:y,zoomOffset:w,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:i}=this.props,r=e.update(this.context.viewport,{zRange:n,modelMatrix:i}),{isLoaded:s}=e,u=this.state.isLoaded!==s,a=this.state.frameNumber!==r;s&&(u||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:r}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:i,fetch:r}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?mee(n,e):null,i?i(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const i=n.props.tile;return e.picked&&(e.tile=i),e.sourceTile=i,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const i of n.layers)i.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(i=>e.layers[0].props[i]!==n[i])&&(e.layers=e.layers.map(i=>i.clone(n)));else{const i=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=L3(i,Boolean).map(r=>r.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:i}=e.props;return this.state.tileset.isTileVisible(i,n)}}Z(Y8,"defaultProps",Dee);Z(Y8,"layerName","TileLayer");const $4=Math.PI/180,yd=new Float32Array(16),ow=new Float32Array(12);function aw(t,e,n){const i=e[0]*$4,r=e[1]*$4,s=e[2]*$4,u=Math.sin(s),a=Math.sin(i),y=Math.sin(r),w=Math.cos(s),M=Math.cos(i),R=Math.cos(r),L=n[0],U=n[1],q=n[2];t[0]=L*R*M,t[1]=L*y*M,t[2]=L*-a,t[3]=U*(-y*w+R*a*u),t[4]=U*(R*w+y*a*u),t[5]=U*M*u,t[6]=q*(y*u+R*a*w),t[7]=q*(-R*u+y*a*w),t[8]=q*M*w}function lw(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const Ree={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:r,getScale:s,getTranslation:u,getTransformMatrix:a}=this.props,y=Array.isArray(a),w=y&&a.length===16,M=Array.isArray(s),R=Array.isArray(r),L=Array.isArray(u),U=w||!y&&!!a(i[0]);U?t.constant=w:t.constant=R&&M&&L;const q=t.value;if(t.constant){let te;U?(yd.set(a),te=lw(yd)):(te=ow,aw(te,r,s),te.set(u,9)),t.value=new Float32Array(te)}else{let te=e*t.size;const{iterable:pe,objectInfo:ne}=K2(i,e,n);for(const ie of pe){ne.index++;let re;if(U)yd.set(w?a:a(ie,ne)),re=lw(yd);else{re=ow;const _e=R?r:r(ie,ne),Te=M?s:s(ie,ne);aw(re,_e,Te),re.set(L?u:u(ie,ne),9)}q[te++]=re[0],q[te++]=re[1],q[te++]=re[2],q[te++]=re[3],q[te++]=re[4],q[te++]=re[5],q[te++]=re[6],q[te++]=re[7],q[te++]=re[8],q[te++]=re[9],q[te++]=re[10],q[te++]=re[11]}}}};function zee(t,e){return e===$n.CARTESIAN||e===$n.METER_OFFSETS||e===$n.DEFAULT&&!t.isGeospatial}const Bee=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Oee=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function fP(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,u=-1/0;const a=t.POSITION?t.POSITION.value:[],y=a&&a.length;for(let w=0;w<y;w+=3){const M=a[w],R=a[w+1],L=a[w+2];e=M<e?M:e,n=R<n?R:n,i=L<i?L:i,r=M>r?M:r,s=R>s?R:s,u=L>u?L:u}return[[e,n,i],[r,s,u]]}function Fee(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class qh{constructor(e,n){Z(this,"fields",void 0),Z(this,"metadata",void 0),Fee(Array.isArray(e)),Nee(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(const u of i)e[u]=!0;const s=this.fields.filter(u=>e[u.name]);return new qh(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];const r=n.map(s=>this.fields[s]).filter(Boolean);return new qh(r,this.metadata)}assign(e){let n,i=this.metadata;if(e instanceof qh){const u=e;n=u.fields,i=cw(cw(new Map,this.metadata),u.metadata)}else n=e;const r=Object.create(null);for(const u of this.fields)r[u.name]=u;for(const u of n)r[u.name]=u;const s=Object.values(r);return new qh(s,i)}}function Nee(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function cw(t,e){return new Map([...t||new Map,...e||new Map])}class n2{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;Z(this,"name",void 0),Z(this,"type",void 0),Z(this,"nullable",void 0),Z(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new n2(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Qi=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),AP,dP,pP;class K8{static isNull(e){return e&&e.typeId===Qi.Null}static isInt(e){return e&&e.typeId===Qi.Int}static isFloat(e){return e&&e.typeId===Qi.Float}static isBinary(e){return e&&e.typeId===Qi.Binary}static isUtf8(e){return e&&e.typeId===Qi.Utf8}static isBool(e){return e&&e.typeId===Qi.Bool}static isDecimal(e){return e&&e.typeId===Qi.Decimal}static isDate(e){return e&&e.typeId===Qi.Date}static isTime(e){return e&&e.typeId===Qi.Time}static isTimestamp(e){return e&&e.typeId===Qi.Timestamp}static isInterval(e){return e&&e.typeId===Qi.Interval}static isList(e){return e&&e.typeId===Qi.List}static isStruct(e){return e&&e.typeId===Qi.Struct}static isUnion(e){return e&&e.typeId===Qi.Union}static isFixedSizeBinary(e){return e&&e.typeId===Qi.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Qi.FixedSizeList}static isMap(e){return e&&e.typeId===Qi.Map}static isDictionary(e){return e&&e.typeId===Qi.Dictionary}get typeId(){return Qi.NONE}compareTo(e){return this===e}}AP=Symbol.toStringTag;class F1 extends K8{constructor(e,n){super(),Z(this,"isSigned",void 0),Z(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Qi.Int}get[AP](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class Uee extends F1{constructor(){super(!0,8)}}class Vee extends F1{constructor(){super(!0,16)}}class Gee extends F1{constructor(){super(!0,32)}}class jee extends F1{constructor(){super(!1,8)}}class Hee extends F1{constructor(){super(!1,16)}}class Wee extends F1{constructor(){super(!1,32)}}const mP={HALF:16,SINGLE:32,DOUBLE:64};dP=Symbol.toStringTag;class gP extends K8{constructor(e){super(),Z(this,"precision",void 0),this.precision=e}get typeId(){return Qi.Float}get[dP](){return"Float"}toString(){return"Float".concat(this.precision)}}class $ee extends gP{constructor(){super(mP.SINGLE)}}class qee extends gP{constructor(){super(mP.DOUBLE)}}pP=Symbol.toStringTag;class Zee extends K8{constructor(e,n){super(),Z(this,"listSize",void 0),Z(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Qi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[pP](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function Xee(t){switch(t.constructor){case Int8Array:return new Uee;case Uint8Array:return new jee;case Int16Array:return new Vee;case Uint16Array:return new Hee;case Int32Array:return new Gee;case Uint32Array:return new Wee;case Float32Array:return new $ee;case Float64Array:return new qee;default:throw new Error("array type not supported")}}function uw(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),Hn.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function hw(t,e){if(t.attributes)return uw(t.attributes,e),t instanceof Ql?t:new Ql(t);if(t.positions||t.POSITION)return uw(t,e),new Ql({attributes:t});throw Error("Invalid mesh")}const Qee=[0,0,0,255],Yee={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Qee},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class N1 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){const e=!qn(this.context.gl),n={};return bS(this.context.gl,Si.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:Bee,fs:Oee,modules:[Cu,fq,Pu],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:i}=this.props;if(!i)return null;if(n=(e=i.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:r}=hw(i,this.props._useMeshColors);r.POSITION=r.POSITION||r.positions,n=fP(r)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:Ree}),this.setState({emptyTexture:new $s(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e;if(n.mesh!==i.mesh||r.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const u=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(u.NORMAL||u.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==i.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:r,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!s||zee(n,r),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new o0(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:hw(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:r}=this.state;return n.setUniforms({sampler:i||r,hasTexture:!!i}),n}setTexture(e){const{emptyTexture:n,model:i}=this.state;i&&i.setUniforms({sampler:e||n,hasTexture:!!e})}}Z(N1,"defaultProps",Yee);Z(N1,"layerName","SimpleMeshLayer");const Kee=typeof window<"u"?_t.useLayoutEffect:_t.useEffect,Jee=Kee;function t3(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const ete={position:"absolute",zIndex:-1};function _P(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>_P(n,e));if(N3(t)){if(tte(t))return e.style=ete,_t.cloneElement(t,e);if(nte(t))return _t.cloneElement(t,e)}return t}function N3(t){return t&&typeof t=="object"&&"type"in t||!1}function tte(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function nte(t){const e=t.type;return e&&e.deckGLViewProps}function Ug(t){if(typeof t=="function")return _t.createElement(b1,{},t);if(Array.isArray(t))return t.map(Ug);if(N3(t)){if(t.type===_t.Fragment)return Ug(t.props.children);if(t3(t.type,b1))return t}return t}function ite({children:t,layers:e=[],views:n=null}){const i=[],r=[],s={};return _t.Children.forEach(Ug(t),u=>{if(N3(u)){const a=u.type;if(t3(a,xa)){const y=rte(a,u.props);r.push(y)}else i.push(u);if(t3(a,b1)&&a!==b1&&u.props.id){const y=new a(u.props);s[y.id]=y}}else u&&i.push(u)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(u=>{s[u.id]=u}):n&&(s[n.id]=n),n=Object.values(s)),e=r.length>0?[...r,...e]:e,{layers:e,children:i,views:n}}function rte(t,e){const n={},i=t.defaultProps||{};for(const r in e)i[r]!==e[r]&&(n[r]=e[r]);return new t(n)}function ste({children:t,deck:e,ContextProvider:n}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const r={},s=i.views[0].id;for(const u of t){let a=s,y=u;N3(u)&&t3(u.type,b1)&&(a=u.props.id||s,y=u.props.children);const w=i.getViewport(a),M=i.getViewState(a);if(w){M.padding=w.padding;const{x:R,y:L,width:U,height:q}=w;y=_P(y,{x:R,y:L,width:U,height:q,viewport:w,viewState:M}),r[a]||(r[a]={viewport:w,children:[]}),r[a].children.push(y)}}return Object.keys(r).map(u=>{const{viewport:a,children:y}=r[u],{x:w,y:M,width:R,height:L}=a,U={position:"absolute",left:w,top:M,width:R,height:L},q="view-".concat(u),te=_t.createElement("div",{key:q,id:q,style:U},...y);if(n){const pe={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:ne=>{ne.viewId=u,e._onViewStateChange(ne)}};return _t.createElement(n,{key:q,value:pe},te)}return te})}const ote={mixBlendMode:null};function ate({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const s in n)s in ote?r[s]=n[s]:i[s]=n[s];return{containerStyle:i,canvasStyle:r}}function lte(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function yP(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function cte(t,e,n){const i=new e({...n,_customRender:r=>{t.redrawReason=r;const s=i.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():yP(t)}});return i}const vP=_t.forwardRef((t,e)=>{const[n,i]=_t.useState(0),s=_t.useRef({control:null,version:n,forceUpdate:()=>i(Te=>Te+1)}).current,u=_t.useRef(null),a=_t.useRef(null),y=_t.useMemo(()=>ite(t),[t.layers,t.views,t.children]);let w=!0;const M=Te=>{var De;return w&&t.viewState?(s.viewStateUpdateRequested=Te,null):(s.viewStateUpdateRequested=null,(De=t.onViewStateChange)===null||De===void 0?void 0:De.call(t,Te))},R=Te=>{if(w)s.interactionStateUpdateRequested=Te;else{var De;s.interactionStateUpdateRequested=null,(De=t.onInteractionStateChange)===null||De===void 0||De.call(t,Te)}},L=_t.useMemo(()=>{const Te={...t,style:null,width:"100%",height:"100%",parent:u.current,canvas:a.current,layers:y.layers,views:y.views,onViewStateChange:M,onInteractionStateChange:R};return delete Te._customRender,s.deck&&s.deck.setProps(Te),Te},[t]);_t.useEffect(()=>{const Te=t.Deck||R3;return s.deck=cte(s,Te,{...L,parent:u.current,canvas:a.current}),()=>{var De;return(De=s.deck)===null||De===void 0?void 0:De.finalize()}},[]),Jee(()=>{yP(s);const{viewStateUpdateRequested:Te,interactionStateUpdateRequested:De}=s;Te&&M(Te),De&&R(De)}),_t.useImperativeHandle(e,()=>lte(s),[]);const U=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:q,width:te,height:pe,id:ne,style:ie}=t,{containerStyle:re,canvasStyle:_e}=_t.useMemo(()=>ate({width:te,height:pe,style:ie}),[te,pe,ie]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===U||s.version!==n){s.lastRenderedViewports=U,s.version=n;const Te=ste({children:y.children,deck:s.deck,ContextProvider:q}),De=_t.createElement("canvas",{key:"canvas",id:ne||"deckgl-overlay",ref:a,style:_e});s.control=_t.createElement("div",{id:"".concat(ne||"deckgl","-wrapper"),ref:u,style:re},[De,Te])}return w=!1,s.control});vP.defaultProps=R3.defaultProps;const ute=vP;var go=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var r="";function s(Y){return e.locateFile?e.locateFile(Y,r):r+Y}var u;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",u=function(V,X,oe){var f=new XMLHttpRequest;f.open("GET",V,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status==200||f.status==0&&f.response){X(f.response);return}var ke=Pi(V);if(ke){X(ke.buffer);return}oe()},f.onerror=oe,f.send(null)};var a=e.print||console.log.bind(console),y=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var w=0,M=function(Y){w=Y},R=function(){return w},L=8;function U(Y,V,X,oe){switch(X=X||"i8",X.charAt(X.length-1)==="*"&&(X="i32"),X){case"i1":Lt[Y>>0]=V;break;case"i8":Lt[Y>>0]=V;break;case"i16":Tt[Y>>1]=V;break;case"i32":Pn[Y>>2]=V;break;case"i64":Lr=[V>>>0,(rr=V,+Fn(rr)>=1?rr>0?(Qn(+ri(rr/4294967296),4294967295)|0)>>>0:~~+Rn((rr-+(~~rr>>>0))/4294967296)>>>0:0)],Pn[Y>>2]=Lr[0],Pn[Y+4>>2]=Lr[1];break;case"float":Ft[Y>>2]=V;break;case"double":Zn[Y>>3]=V;break;default:or("invalid type for setValue: "+X)}}function q(Y,V,X){switch(V=V||"i8",V.charAt(V.length-1)==="*"&&(V="i32"),V){case"i1":return Lt[Y>>0];case"i8":return Lt[Y>>0];case"i16":return Tt[Y>>1];case"i32":return Pn[Y>>2];case"i64":return Pn[Y>>2];case"float":return Ft[Y>>2];case"double":return Zn[Y>>3];default:or("invalid type for getValue: "+V)}return null}var te=!1;function pe(Y,V){Y||or("Assertion failed: "+V)}function ne(Y){var V=e["_"+Y];return pe(V,"Cannot call unknown function "+Y+", make sure it is exported"),V}function ie(Y,V,X,oe,f){var W={string:function(ct){var It=0;if(ct!=null&&ct!==0){var St=(ct.length<<2)+1;It=qs(St),nt(ct,It,St)}return It},array:function(ct){var It=qs(ct.length);return ut(ct,It),It}};function ke(ct){return V==="string"?De(ct):V==="boolean"?!!ct:ct}var Ce=ne(Y),be=[],Me=0;if(oe)for(var Ne=0;Ne<oe.length;Ne++){var it=W[X[Ne]];it?(Me===0&&(Me=Hi()),be[Ne]=it(oe[Ne])):be[Ne]=oe[Ne]}var Ue=Ce.apply(null,be);return Ue=ke(Ue),Me!==0&&xi(Me),Ue}function re(Y,V,X,oe){X=X||[];var f=X.every(function(ke){return ke==="number"}),W=V!=="string";return W&&f&&!oe?ne(Y):function(){return ie(Y,V,X,arguments)}}var _e=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Te(Y,V,X){for(var oe=V+X,f=V;Y[f]&&!(f>=oe);)++f;if(f-V>16&&Y.subarray&&_e)return _e.decode(Y.subarray(V,f));for(var W="";V<f;){var ke=Y[V++];if(!(ke&128)){W+=String.fromCharCode(ke);continue}var Ce=Y[V++]&63;if((ke&224)==192){W+=String.fromCharCode((ke&31)<<6|Ce);continue}var be=Y[V++]&63;if((ke&240)==224?ke=(ke&15)<<12|Ce<<6|be:ke=(ke&7)<<18|Ce<<12|be<<6|Y[V++]&63,ke<65536)W+=String.fromCharCode(ke);else{var Me=ke-65536;W+=String.fromCharCode(55296|Me>>10,56320|Me&1023)}}return W}function De(Y,V){return Y?Te(ht,Y,V):""}function $e(Y,V,X,oe){if(!(oe>0))return 0;for(var f=X,W=X+oe-1,ke=0;ke<Y.length;++ke){var Ce=Y.charCodeAt(ke);if(Ce>=55296&&Ce<=57343){var be=Y.charCodeAt(++ke);Ce=65536+((Ce&1023)<<10)|be&1023}if(Ce<=127){if(X>=W)break;V[X++]=Ce}else if(Ce<=2047){if(X+1>=W)break;V[X++]=192|Ce>>6,V[X++]=128|Ce&63}else if(Ce<=65535){if(X+2>=W)break;V[X++]=224|Ce>>12,V[X++]=128|Ce>>6&63,V[X++]=128|Ce&63}else{if(X+3>=W)break;V[X++]=240|Ce>>18,V[X++]=128|Ce>>12&63,V[X++]=128|Ce>>6&63,V[X++]=128|Ce&63}}return V[X]=0,X-f}function nt(Y,V,X){return $e(Y,ht,V,X)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function ut(Y,V){Lt.set(Y,V)}function st(Y,V){return Y%V>0&&(Y+=V-Y%V),Y}var lt,Lt,ht,Tt,Pn,Ft,Zn;function yt(Y){lt=Y,e.HEAP8=Lt=new Int8Array(Y),e.HEAP16=Tt=new Int16Array(Y),e.HEAP32=Pn=new Int32Array(Y),e.HEAPU8=ht=new Uint8Array(Y),e.HEAPU16=new Uint16Array(Y),e.HEAPU32=new Uint32Array(Y),e.HEAPF32=Ft=new Float32Array(Y),e.HEAPF64=Zn=new Float64Array(Y)}var Ot=5267040,Jt=24128,In=e.TOTAL_MEMORY||33554432;e.buffer?lt=e.buffer:lt=new ArrayBuffer(In),In=lt.byteLength,yt(lt),Pn[Jt>>2]=Ot;function Tn(Y){for(;Y.length>0;){var V=Y.shift();if(typeof V=="function"){V();continue}var X=V.func;typeof X=="number"?V.arg===void 0?e.dynCall_v(X):e.dynCall_vi(X,V.arg):X(V.arg===void 0?null:V.arg)}}var Di=[],di=[],ii=[],hi=[];function On(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)mn(e.preRun.shift());Tn(Di)}function vi(){Tn(di)}function mt(){Tn(ii)}function Yt(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)dt(e.postRun.shift());Tn(hi)}function mn(Y){Di.unshift(Y)}function dt(Y){hi.unshift(Y)}var Fn=Math.abs,Rn=Math.ceil,ri=Math.floor,Qn=Math.min,si=0,hr=null;function kn(Y){si++,e.monitorRunDependencies&&e.monitorRunDependencies(si)}function fr(Y){if(si--,e.monitorRunDependencies&&e.monitorRunDependencies(si),si==0&&hr){var V=hr;hr=null,V()}}e.preloadedImages={},e.preloadedAudios={};var Yn=null,Wr="data:application/octet-stream;base64,";function vo(Y){return String.prototype.startsWith?Y.startsWith(Wr):Y.indexOf(Wr)===0}var rr,Lr;Yn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var xo=24144;function $r(Y){return Y}function et(Y){var V=/\b__Z[\w\d_]+/g;return Y.replace(V,function(X){var oe=X;return X===oe?X:oe+" ["+X+"]"})}function xt(){var Y=new Error;if(!Y.stack){try{throw new Error(0)}catch(V){Y=V}if(!Y.stack)return"(no stack trace available)"}return Y.stack.toString()}function Ms(){var Y=xt();return e.extraStackTrace&&(Y+=`
`+e.extraStackTrace()),et(Y)}function sr(Y,V,X,oe){or("Assertion failed: "+De(Y)+", at: "+[V?De(V):"unknown filename",X,oe?De(oe):"unknown function"])}function Sn(){return Lt.length}function wr(Y,V,X){ht.set(ht.subarray(V,V+X),Y)}function Ar(Y){return e.___errno_location&&(Pn[e.___errno_location()>>2]=Y),Y}function dr(Y){or("OOM")}function us(Y){try{var V=new ArrayBuffer(Y);return V.byteLength!=Y?void 0:(new Int8Array(V).set(Lt),Ri(V),yt(V),1)}catch{}}function wt(Y){var V=Sn(),X=16777216,oe=2147483648-X;if(Y>oe)return!1;for(var f=16777216,W=Math.max(V,f);W<Y;)W<=536870912?W=st(2*W,X):W=Math.min(st((3*W+2147483648)/4,X),oe);var ke=us(W);return!!ke}var An=typeof atob=="function"?atob:function(Y){var V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",X="",oe,f,W,ke,Ce,be,Me,Ne=0;Y=Y.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ke=V.indexOf(Y.charAt(Ne++)),Ce=V.indexOf(Y.charAt(Ne++)),be=V.indexOf(Y.charAt(Ne++)),Me=V.indexOf(Y.charAt(Ne++)),oe=ke<<2|Ce>>4,f=(Ce&15)<<4|be>>2,W=(be&3)<<6|Me,X=X+String.fromCharCode(oe),be!==64&&(X=X+String.fromCharCode(f)),Me!==64&&(X=X+String.fromCharCode(W));while(Ne<Y.length);return X};function fn(Y){try{for(var V=An(Y),X=new Uint8Array(V.length),oe=0;oe<V.length;++oe)X[oe]=V.charCodeAt(oe);return X}catch{throw new Error("Converting base64 string to bytes failed.")}}function Pi(Y){if(vo(Y))return fn(Y.slice(Wr.length))}var hs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},cn={a:or,b:M,c:R,d:sr,e:Ar,f:Sn,g:wr,h:wt,i:dr,j:$r,k:et,l:us,m:xt,n:Ms,o:xo,p:Jt},At=function(Y,V,X){"almost asm";var oe=new Y.Int8Array(X),f=new Y.Int32Array(X);new Y.Uint8Array(X),new Y.Float32Array(X);var W=new Y.Float64Array(X),ke=V.o|0,Ce=V.p|0,be=Y.Math.floor,Me=Y.Math.abs,Ne=Y.Math.sqrt,it=Y.Math.pow,Ue=Y.Math.cos,ct=Y.Math.sin,It=Y.Math.tan,St=Y.Math.acos,Zt=Y.Math.asin,Vt=Y.Math.atan,sn=Y.Math.atan2,Wt=Y.Math.ceil,Xt=Y.Math.imul,yn=Y.Math.min,Mn=Y.Math.max,Un=Y.Math.clz32,Ut=V.b,ge=V.c,en=V.d,Wi=V.e,Vn=V.f,Wo=V.g,$o=V.h,wa=V.i,de=24160;function wo(d){return oe=new Int8Array(d),f=new Int32Array(d),W=new Float64Array(d),X=d,!0}function fs(d){d=d|0;var A=0;return A=de,de=de+d|0,de=de+15&-16,A|0}function ba(){return de|0}function Ea(d){d=d|0,de=d}function Ta(d,A){d=d|0,de=d}function rl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;return(d|0)<0?(A=2,A|0):(d|0)>13780509?(A=Ba(15,A)|0,A|0):(m=((d|0)<0)<<31>>31,x=se(d|0,m|0,3,0)|0,_=ge()|0,m=P(d|0,m|0,1,0)|0,m=se(x|0,_|0,m|0,ge()|0)|0,m=P(m|0,ge()|0,1,0)|0,d=ge()|0,f[A>>2]=m,f[A+4>>2]=d,A=0,A|0)}function sl(d,A,m,_){return d=d|0,A=A|0,m=m|0,_=_|0,ks(d,A,m,_,0)|0}function ks(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0;if(O=de,de=de+16|0,I=O,!(ue(d,A,m,_,x)|0))return _=0,de=O,_|0;do if((m|0)>=0){if((m|0)>13780509){if(S=Ba(15,I)|0,S|0)break;D=I,I=f[D>>2]|0,D=f[D+4>>2]|0}else S=((m|0)<0)<<31>>31,H=se(m|0,S|0,3,0)|0,D=ge()|0,S=P(m|0,S|0,1,0)|0,S=se(H|0,D|0,S|0,ge()|0)|0,S=P(S|0,ge()|0,1,0)|0,D=ge()|0,f[I>>2]=S,f[I+4>>2]=D,I=S;if(je(_|0,0,I<<3|0)|0,x|0){je(x|0,0,I<<2|0)|0,S=me(d,A,m,_,x,I,D,0)|0;break}S=E(I,4)|0,S?(H=me(d,A,m,_,S,I,D,0)|0,v(S),S=H):S=13}else S=2;while(0);return H=S,de=O,H|0}function ue(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0;if(Be=de,de=de+16|0,Re=Be,Ee=Be+8|0,we=Re,f[we>>2]=d,f[we+4>>2]=A,(m|0)<0)return Ee=2,de=Be,Ee|0;if(S=_,f[S>>2]=d,f[S+4>>2]=A,S=(x|0)!=0,S&&(f[x>>2]=0),Jn(d,A)|0)return Ee=9,de=Be,Ee|0;f[Ee>>2]=0;e:do if((m|0)>=1)if(S)for(J=1,H=0,Ae=0,we=1,S=d;;){if(!(H|Ae)){if(S=Ie(S,A,4,Ee,Re)|0,S|0)break e;if(A=Re,S=f[A>>2]|0,A=f[A+4>>2]|0,Jn(S,A)|0){S=9;break e}}if(S=Ie(S,A,f[22384+(Ae<<2)>>2]|0,Ee,Re)|0,S|0)break e;if(A=Re,S=f[A>>2]|0,A=f[A+4>>2]|0,d=_+(J<<3)|0,f[d>>2]=S,f[d+4>>2]=A,f[x+(J<<2)>>2]=we,d=H+1|0,I=(d|0)==(we|0),D=Ae+1|0,O=(D|0)==6,Jn(S,A)|0){S=9;break e}if(we=we+(O&I&1)|0,(we|0)>(m|0)){S=0;break}else J=J+1|0,H=I?0:d,Ae=I?O?0:D:Ae}else for(J=1,H=0,Ae=0,we=1,S=d;;){if(!(H|Ae)){if(S=Ie(S,A,4,Ee,Re)|0,S|0)break e;if(A=Re,S=f[A>>2]|0,A=f[A+4>>2]|0,Jn(S,A)|0){S=9;break e}}if(S=Ie(S,A,f[22384+(Ae<<2)>>2]|0,Ee,Re)|0,S|0)break e;if(A=Re,S=f[A>>2]|0,A=f[A+4>>2]|0,d=_+(J<<3)|0,f[d>>2]=S,f[d+4>>2]=A,d=H+1|0,I=(d|0)==(we|0),D=Ae+1|0,O=(D|0)==6,Jn(S,A)|0){S=9;break e}if(we=we+(O&I&1)|0,(we|0)>(m|0)){S=0;break}else J=J+1|0,H=I?0:d,Ae=I?O?0:D:Ae}else S=0;while(0);return Ee=S,de=Be,Ee|0}function me(d,A,m,_,x,S,I,D){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0,I=I|0,D=D|0;var O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0;if(Be=de,de=de+16|0,Re=Be+8|0,Ee=Be,O=xe(d|0,A|0,S|0,I|0)|0,J=ge()|0,Ae=_+(O<<3)|0,Je=Ae,Ye=f[Je>>2]|0,Je=f[Je+4>>2]|0,H=(Ye|0)==(d|0)&(Je|0)==(A|0),!((Ye|0)==0&(Je|0)==0|H))do O=P(O|0,J|0,1,0)|0,O=ce(O|0,ge()|0,S|0,I|0)|0,J=ge()|0,Ae=_+(O<<3)|0,Ye=Ae,Je=f[Ye>>2]|0,Ye=f[Ye+4>>2]|0,H=(Je|0)==(d|0)&(Ye|0)==(A|0);while(!((Je|0)==0&(Ye|0)==0|H));if(O=x+(O<<2)|0,H&&(f[O>>2]|0)<=(D|0)||(Ye=Ae,f[Ye>>2]=d,f[Ye+4>>2]=A,f[O>>2]=D,(D|0)>=(m|0)))return Ye=0,de=Be,Ye|0;switch(H=D+1|0,f[Re>>2]=0,O=Ie(d,A,2,Re,Ee)|0,O|0){case 9:{we=9;break}case 0:{O=Ee,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,I,H)|0,O||(we=9);break}}e:do if((we|0)==9){switch(f[Re>>2]=0,O=Ie(d,A,3,Re,Ee)|0,O|0){case 9:break;case 0:{if(O=Ee,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,I,H)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,A,1,Re,Ee)|0,O|0){case 9:break;case 0:{if(O=Ee,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,I,H)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,A,5,Re,Ee)|0,O|0){case 9:break;case 0:{if(O=Ee,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,I,H)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,A,4,Re,Ee)|0,O|0){case 9:break;case 0:{if(O=Ee,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,I,H)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,A,6,Re,Ee)|0,O|0){case 9:break;case 0:{if(O=Ee,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,I,H)|0,O|0)break e;break}default:break e}return Ye=0,de=Be,Ye|0}while(0);return Ye=O,de=Be,Ye|0}function Ie(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0;if(m>>>0>6)return x=1,x|0;if(Ae=(f[_>>2]|0)%6|0,f[_>>2]=Ae,(Ae|0)>0){S=0;do m=Zo(m)|0,S=S+1|0;while((S|0)<(f[_>>2]|0))}if(Ae=le(d|0,A|0,45)|0,ge()|0,J=Ae&127,J>>>0>121)return x=5,x|0;O=Fi(d,A)|0,S=le(d|0,A|0,52)|0,ge()|0,S=S&15;e:do if(!S)H=8;else{for(;;){if(I=(15-S|0)*3|0,D=le(d|0,A|0,I|0)|0,ge()|0,D=D&7,(D|0)==7){A=5;break}if(Ee=(br(S)|0)==0,S=S+-1|0,we=ye(7,0,I|0)|0,A=A&~(ge()|0),Re=ye(f[(Ee?432:16)+(D*28|0)+(m<<2)>>2]|0,0,I|0)|0,I=ge()|0,m=f[(Ee?640:224)+(D*28|0)+(m<<2)>>2]|0,d=Re|d&~we,A=I|A,!m){m=0;break e}if(!S){H=8;break e}}return A|0}while(0);(H|0)==8&&(Ee=f[848+(J*28|0)+(m<<2)>>2]|0,Re=ye(Ee|0,0,45)|0,d=Re|d,A=ge()|0|A&-1040385,m=f[4272+(J*28|0)+(m<<2)>>2]|0,(Ee&127|0)==127&&(Ee=ye(f[848+(J*28|0)+20>>2]|0,0,45)|0,A=ge()|0|A&-1040385,m=f[4272+(J*28|0)+20>>2]|0,d=Ls(Ee|d,A)|0,A=ge()|0,f[_>>2]=(f[_>>2]|0)+1)),D=le(d|0,A|0,45)|0,ge()|0,D=D&127;e:do if(zn(D)|0){t:do if((Fi(d,A)|0)==1){if((J|0)!=(D|0))if(Lu(D,f[7696+(J*28|0)>>2]|0)|0){d=x0(d,A)|0,I=1,A=ge()|0;break}else en(23313,22416,436,22424);switch(O|0){case 3:{d=Ls(d,A)|0,A=ge()|0,f[_>>2]=(f[_>>2]|0)+1,I=0;break t}case 5:{d=x0(d,A)|0,A=ge()|0,f[_>>2]=(f[_>>2]|0)+5,I=0;break t}case 0:return Ee=9,Ee|0;default:return Ee=1,Ee|0}}else I=0;while(0);if((m|0)>0){S=0;do d=vc(d,A)|0,A=ge()|0,S=S+1|0;while((S|0)!=(m|0))}if((J|0)!=(D|0)){if(!(h0(D)|0)){if((I|0)!=0|(Fi(d,A)|0)!=5)break;f[_>>2]=(f[_>>2]|0)+1;break}switch(Ae&127){case 8:case 118:break e}(Fi(d,A)|0)!=3&&(f[_>>2]=(f[_>>2]|0)+1)}}else if((m|0)>0){S=0;do d=Ls(d,A)|0,A=ge()|0,S=S+1|0;while((S|0)!=(m|0))}while(0);return f[_>>2]=((f[_>>2]|0)+m|0)%6|0,Ee=x,f[Ee>>2]=d,f[Ee+4>>2]=A,Ee=0,Ee|0}function Xe(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0;for(D=de,de=de+16|0,S=D,I=D+8|0,x=(Jn(d,A)|0)==0,x=x?1:2;;){if(f[I>>2]=0,H=(Ie(d,A,x,I,S)|0)==0,O=S,H&((f[O>>2]|0)==(m|0)?(f[O+4>>2]|0)==(_|0):0)){d=4;break}if(x=x+1|0,x>>>0>=7){x=7,d=4;break}}return(d|0)==4?(de=D,x|0):0}function pt(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0;if(Ee=de,de=de+16|0,we=Ee,Re=Ee+8|0,Ae=we,f[Ae>>2]=d,f[Ae+4>>2]=A,!m)return Re=_,f[Re>>2]=d,f[Re+4>>2]=A,Re=0,de=Ee,Re|0;f[Re>>2]=0;e:do if(Jn(d,A)|0)d=9;else{if(S=(m|0)>0,S){x=0,Ae=d;do{if(d=Ie(Ae,A,4,Re,we)|0,d|0)break e;if(A=we,Ae=f[A>>2]|0,A=f[A+4>>2]|0,x=x+1|0,Jn(Ae,A)|0){d=9;break e}}while((x|0)<(m|0));if(J=_,f[J>>2]=Ae,f[J+4>>2]=A,J=m+-1|0,S){H=0,d=1;do{if(x=22384+(H<<2)|0,(H|0)==5)for(I=f[x>>2]|0,S=0,x=d;;){if(d=we,d=Ie(f[d>>2]|0,f[d+4>>2]|0,I,Re,we)|0,d|0)break e;if((S|0)!=(J|0))if(O=we,D=f[O>>2]|0,O=f[O+4>>2]|0,d=_+(x<<3)|0,f[d>>2]=D,f[d+4>>2]=O,!(Jn(D,O)|0))d=x+1|0;else{d=9;break e}else d=x;if(S=S+1|0,(S|0)>=(m|0))break;x=d}else for(I=we,O=f[x>>2]|0,D=0,x=d,S=f[I>>2]|0,I=f[I+4>>2]|0;;){if(d=Ie(S,I,O,Re,we)|0,d|0)break e;if(I=we,S=f[I>>2]|0,I=f[I+4>>2]|0,d=_+(x<<3)|0,f[d>>2]=S,f[d+4>>2]=I,d=x+1|0,Jn(S,I)|0){d=9;break e}if(D=D+1|0,(D|0)>=(m|0))break;x=d}H=H+1|0}while(H>>>0<6);d=we,I=Ae,x=f[d>>2]|0,S=A,d=f[d+4>>2]|0}else I=Ae,x=Ae,S=A,d=A}else I=_,f[I>>2]=d,f[I+4>>2]=A,I=d,x=d,S=A,d=A;d=(I|0)==(x|0)&(S|0)==(d|0)?0:9}while(0);return Re=d,de=Ee,Re|0}function Nt(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0;if(D=de,de=de+48|0,x=D+16|0,S=D+8|0,I=D,m|0)return I=15,de=D,I|0;if(H=d,O=f[H+4>>2]|0,m=S,f[m>>2]=f[H>>2],f[m+4>>2]=O,Ks(S,x),A=Du(x,A,I)|0,!A){if(m=f[S>>2]|0,S=f[d+8>>2]|0,(S|0)>0){x=f[d+12>>2]|0,A=0;do m=(f[x+(A<<3)>>2]|0)+m|0,A=A+1|0;while((A|0)<(S|0))}A=I,x=f[A>>2]|0,A=f[A+4>>2]|0,S=((m|0)<0)<<31>>31,(A|0)<(S|0)|(A|0)==(S|0)&x>>>0<m>>>0?(A=I,f[A>>2]=m,f[A+4>>2]=S,A=S):m=x,O=P(m|0,A|0,12,0)|0,H=ge()|0,A=I,f[A>>2]=O,f[A+4>>2]=H,A=_,f[A>>2]=O,f[A+4>>2]=H,A=0}return H=A,de=D,H|0}function vn(d,A,m,_,x,S,I){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0,I=I|0;var D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0,bt=0,rt=0,ft=0,dn=0,un=0,rn=0,on=0,hn=0,gn=0,jn=0,pn=0,ti=0,bi=0,Mo=0;if(jn=de,de=de+64|0,rn=jn+48|0,on=jn+32|0,hn=jn+24|0,Pt=jn+8|0,bt=jn,O=f[d>>2]|0,(O|0)<=0)return gn=0,de=jn,gn|0;for(rt=d+4|0,ft=rn+8|0,dn=on+8|0,un=Pt+8|0,D=0,We=0;;){H=f[rt>>2]|0,He=H+(We<<4)|0,f[rn>>2]=f[He>>2],f[rn+4>>2]=f[He+4>>2],f[rn+8>>2]=f[He+8>>2],f[rn+12>>2]=f[He+12>>2],(We|0)==(O+-1|0)?(f[on>>2]=f[H>>2],f[on+4>>2]=f[H+4>>2],f[on+8>>2]=f[H+8>>2],f[on+12>>2]=f[H+12>>2]):(He=H+(We+1<<4)|0,f[on>>2]=f[He>>2],f[on+4>>2]=f[He+4>>2],f[on+8>>2]=f[He+8>>2],f[on+12>>2]=f[He+12>>2]),O=ll(rn,on,_,hn)|0;e:do if(O)H=0,D=O;else if(H=hn,O=f[H>>2]|0,H=f[H+4>>2]|0,(H|0)>0|(H|0)==0&O>>>0>0){Ye=0,He=0;t:for(;;){if(Mo=+W[rn>>3],Je=z(O|0,H|0,Ye|0,He|0)|0,bi=+(Je>>>0)+4294967296*+(ge()|0),pn=+(O>>>0)+4294967296*+(H|0),ti=+(Ye>>>0)+4294967296*+(He|0),W[Pt>>3]=Mo*bi/pn+ +W[on>>3]*ti/pn,W[un>>3]=+W[ft>>3]*bi/pn+ +W[dn>>3]*ti/pn,O=xl(Pt,_,bt)|0,O|0){D=O;break}Je=bt,Be=f[Je>>2]|0,Je=f[Je+4>>2]|0,we=xe(Be|0,Je|0,A|0,m|0)|0,J=ge()|0,O=I+(we<<3)|0,Ae=O,H=f[Ae>>2]|0,Ae=f[Ae+4>>2]|0;n:do if((H|0)==0&(Ae|0)==0)Oe=O,gn=16;else for(Re=0,Ee=0;;){if((Re|0)>(m|0)|(Re|0)==(m|0)&Ee>>>0>A>>>0){D=1;break t}if((H|0)==(Be|0)&(Ae|0)==(Je|0))break n;if(O=P(we|0,J|0,1,0)|0,we=ce(O|0,ge()|0,A|0,m|0)|0,J=ge()|0,Ee=P(Ee|0,Re|0,1,0)|0,Re=ge()|0,O=I+(we<<3)|0,Ae=O,H=f[Ae>>2]|0,Ae=f[Ae+4>>2]|0,(H|0)==0&(Ae|0)==0){Oe=O,gn=16;break}}while(0);if((gn|0)==16&&(gn=0,!((Be|0)==0&(Je|0)==0))&&(Ee=Oe,f[Ee>>2]=Be,f[Ee+4>>2]=Je,Ee=S+(f[x>>2]<<3)|0,f[Ee>>2]=Be,f[Ee+4>>2]=Je,Ee=x,Ee=P(f[Ee>>2]|0,f[Ee+4>>2]|0,1,0)|0,Be=ge()|0,Je=x,f[Je>>2]=Ee,f[Je+4>>2]=Be),Ye=P(Ye|0,He|0,1,0)|0,He=ge()|0,H=hn,O=f[H>>2]|0,H=f[H+4>>2]|0,!((H|0)>(He|0)|(H|0)==(He|0)&O>>>0>Ye>>>0)){H=1;break e}}H=0}else H=1;while(0);if(We=We+1|0,!H){gn=21;break}if(O=f[d>>2]|0,(We|0)>=(O|0)){D=0,gn=21;break}}return(gn|0)==21?(de=jn,D|0):0}function pi(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0,bt=0,rt=0,ft=0,dn=0,un=0,rn=0,on=0,hn=0,gn=0,jn=0,pn=0,ti=0,bi=0;if(bi=de,de=de+112|0,gn=bi+80|0,O=bi+72|0,jn=bi,pn=bi+56|0,m|0)return ti=15,de=bi,ti|0;if(H=d+8|0,ti=p((f[H>>2]<<5)+32|0)|0,!ti)return ti=13,de=bi,ti|0;if(Ku(d,ti),on=d,hn=f[on+4>>2]|0,m=O,f[m>>2]=f[on>>2],f[m+4>>2]=hn,Ks(O,gn),m=Du(gn,A,jn)|0,m)on=0,hn=0;else{if(m=f[O>>2]|0,S=f[H>>2]|0,(S|0)>0){I=f[d+12>>2]|0,x=0;do m=(f[I+(x<<3)>>2]|0)+m|0,x=x+1|0;while((x|0)!=(S|0));x=m}else x=m;m=jn,S=f[m>>2]|0,m=f[m+4>>2]|0,I=((x|0)<0)<<31>>31,(m|0)<(I|0)|(m|0)==(I|0)&S>>>0<x>>>0?(m=jn,f[m>>2]=x,f[m+4>>2]=I,m=I):x=S,on=P(x|0,m|0,12,0)|0,hn=ge()|0,m=jn,f[m>>2]=on,f[m+4>>2]=hn,m=0}if(m|0)return v(ti),ti=m,de=bi,ti|0;if(x=E(on,8)|0,!x)return v(ti),ti=13,de=bi,ti|0;if(D=E(on,8)|0,!D)return v(ti),v(x),ti=13,de=bi,ti|0;un=gn,f[un>>2]=0,f[un+4>>2]=0,un=d,rn=f[un+4>>2]|0,m=O,f[m>>2]=f[un>>2],f[m+4>>2]=rn,m=vn(O,on,hn,A,gn,x,D)|0;e:do if(m)v(x),v(D),v(ti);else{t:do if((f[H>>2]|0)>0){for(I=d+12|0,S=0;m=vn((f[I>>2]|0)+(S<<3)|0,on,hn,A,gn,x,D)|0,S=S+1|0,!(m|0);)if((S|0)>=(f[H>>2]|0))break t;v(x),v(D),v(ti);break e}while(0);(hn|0)>0|(hn|0)==0&on>>>0>0&&je(D|0,0,on<<3|0)|0,rn=gn,un=f[rn+4>>2]|0;t:do if((un|0)>0|(un|0)==0&(f[rn>>2]|0)>>>0>0){rt=x,ft=D,dn=x,un=D,rn=x,m=x,Oe=x,Pt=D,bt=D,x=D;n:for(;;){for(Je=0,Ye=0,He=0,We=0,S=0,I=0;;){D=jn,O=D+56|0;do f[D>>2]=0,D=D+4|0;while((D|0)<(O|0));if(A=rt+(Je<<3)|0,H=f[A>>2]|0,A=f[A+4>>2]|0,ue(H,A,1,jn,0)|0){D=jn,O=D+56|0;do f[D>>2]=0,D=D+4|0;while((D|0)<(O|0));D=E(7,4)|0,D|0&&(me(H,A,1,jn,D,7,0,0)|0,v(D))}for(Be=0;;){Ee=jn+(Be<<3)|0,Re=f[Ee>>2]|0,Ee=f[Ee+4>>2]|0;i:do if((Re|0)==0&(Ee|0)==0)D=S,O=I;else{if(J=xe(Re|0,Ee|0,on|0,hn|0)|0,H=ge()|0,D=_+(J<<3)|0,A=D,O=f[A>>2]|0,A=f[A+4>>2]|0,!((O|0)==0&(A|0)==0)){Ae=0,we=0;do{if((Ae|0)>(hn|0)|(Ae|0)==(hn|0)&we>>>0>on>>>0)break n;if((O|0)==(Re|0)&(A|0)==(Ee|0)){D=S,O=I;break i}D=P(J|0,H|0,1,0)|0,J=ce(D|0,ge()|0,on|0,hn|0)|0,H=ge()|0,we=P(we|0,Ae|0,1,0)|0,Ae=ge()|0,D=_+(J<<3)|0,A=D,O=f[A>>2]|0,A=f[A+4>>2]|0}while(!((O|0)==0&(A|0)==0))}(Re|0)==0&(Ee|0)==0?(D=S,O=I):(Qs(Re,Ee,pn)|0,Fa(d,ti,pn)|0&&(we=P(S|0,I|0,1,0)|0,I=ge()|0,Ae=D,f[Ae>>2]=Re,f[Ae+4>>2]=Ee,S=ft+(S<<3)|0,f[S>>2]=Re,f[S+4>>2]=Ee,S=we),D=S,O=I)}while(0);if(Be=Be+1|0,Be>>>0>=7)break;S=D,I=O}if(Je=P(Je|0,Ye|0,1,0)|0,Ye=ge()|0,He=P(He|0,We|0,1,0)|0,We=ge()|0,I=gn,S=f[I>>2]|0,I=f[I+4>>2]|0,(We|0)<(I|0)|(We|0)==(I|0)&He>>>0<S>>>0)S=D,I=O;else break}if((I|0)>0|(I|0)==0&S>>>0>0){S=0,I=0;do We=rt+(S<<3)|0,f[We>>2]=0,f[We+4>>2]=0,S=P(S|0,I|0,1,0)|0,I=ge()|0,We=gn,He=f[We+4>>2]|0;while((I|0)<(He|0)|((I|0)==(He|0)?S>>>0<(f[We>>2]|0)>>>0:0))}if(We=gn,f[We>>2]=D,f[We+4>>2]=O,(O|0)>0|(O|0)==0&D>>>0>0)Be=x,Je=bt,Ye=rn,He=Pt,We=ft,x=Oe,bt=m,Pt=dn,Oe=Be,m=Je,rn=un,un=Ye,dn=He,ft=rt,rt=We;else break t}v(dn),v(un),v(ti),m=1;break e}else m=D;while(0);v(ti),v(x),v(m),m=0}while(0);return ti=m,de=bi,ti|0}function xn(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0;if(J=de,de=de+176|0,O=J,(A|0)<1)return Js(m,0,0),H=0,de=J,H|0;for(D=d,D=le(f[D>>2]|0,f[D+4>>2]|0,52)|0,ge()|0,Js(m,(A|0)>6?A:6,D&15),D=0;_=d+(D<<3)|0,_=La(f[_>>2]|0,f[_+4>>2]|0,O)|0,!(_|0);){if(_=f[O>>2]|0,(_|0)>0){I=0;do S=O+8+(I<<4)|0,I=I+1|0,_=O+8+(((I|0)%(_|0)|0)<<4)|0,x=zi(m,_,S)|0,x?eo(m,x)|0:wi(m,S,_)|0,_=f[O>>2]|0;while((I|0)<(_|0))}if(D=D+1|0,(D|0)>=(A|0)){_=0,H=13;break}}return(H|0)==13?(de=J,_|0):(ms(m),H=_,de=J,H|0)}function Mi(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0;if(S=de,de=de+32|0,_=S,x=S+16|0,d=xn(d,A,x)|0,d|0)return m=d,de=S,m|0;if(f[m>>2]=0,f[m+4>>2]=0,f[m+8>>2]=0,d=Lc(x)|0,d|0)do{A=kt(m)|0;do b0(A,d)|0,I=d+16|0,f[_>>2]=f[I>>2],f[_+4>>2]=f[I+4>>2],f[_+8>>2]=f[I+8>>2],f[_+12>>2]=f[I+12>>2],eo(x,d)|0,d=Dc(x,_)|0;while(d|0);d=Lc(x)|0}while(d|0);return ms(x),d=Ec(m)|0,d?(Qu(m),I=d,de=S,I|0):(I=0,de=S,I|0)}function zn(d){return d=d|0,d>>>0>121?(d=0,d|0):(d=f[7696+(d*28|0)+16>>2]|0,d|0)}function h0(d){return d=d|0,(d|0)==4|(d|0)==117|0}function f0(d){return d=d|0,f[11120+((f[d>>2]|0)*216|0)+((f[d+4>>2]|0)*72|0)+((f[d+8>>2]|0)*24|0)+(f[d+12>>2]<<3)>>2]|0}function A0(d){return d=d|0,f[11120+((f[d>>2]|0)*216|0)+((f[d+4>>2]|0)*72|0)+((f[d+8>>2]|0)*24|0)+(f[d+12>>2]<<3)+4>>2]|0}function ku(d,A){d=d|0,A=A|0,d=7696+(d*28|0)|0,f[A>>2]=f[d>>2],f[A+4>>2]=f[d+4>>2],f[A+8>>2]=f[d+8>>2],f[A+12>>2]=f[d+12>>2]}function U1(d,A){d=d|0,A=A|0;var m=0,_=0;if(A>>>0>20)return A=-1,A|0;do if((f[11120+(A*216|0)>>2]|0)!=(d|0))if((f[11120+(A*216|0)+8>>2]|0)!=(d|0))if((f[11120+(A*216|0)+16>>2]|0)!=(d|0))if((f[11120+(A*216|0)+24>>2]|0)!=(d|0))if((f[11120+(A*216|0)+32>>2]|0)!=(d|0))if((f[11120+(A*216|0)+40>>2]|0)!=(d|0))if((f[11120+(A*216|0)+48>>2]|0)!=(d|0))if((f[11120+(A*216|0)+56>>2]|0)!=(d|0))if((f[11120+(A*216|0)+64>>2]|0)!=(d|0))if((f[11120+(A*216|0)+72>>2]|0)!=(d|0))if((f[11120+(A*216|0)+80>>2]|0)!=(d|0))if((f[11120+(A*216|0)+88>>2]|0)!=(d|0))if((f[11120+(A*216|0)+96>>2]|0)!=(d|0))if((f[11120+(A*216|0)+104>>2]|0)!=(d|0))if((f[11120+(A*216|0)+112>>2]|0)!=(d|0))if((f[11120+(A*216|0)+120>>2]|0)!=(d|0))if((f[11120+(A*216|0)+128>>2]|0)!=(d|0))if((f[11120+(A*216|0)+136>>2]|0)==(d|0))d=2,m=1,_=2;else{if((f[11120+(A*216|0)+144>>2]|0)==(d|0)){d=0,m=2,_=0;break}if((f[11120+(A*216|0)+152>>2]|0)==(d|0)){d=0,m=2,_=1;break}if((f[11120+(A*216|0)+160>>2]|0)==(d|0)){d=0,m=2,_=2;break}if((f[11120+(A*216|0)+168>>2]|0)==(d|0)){d=1,m=2,_=0;break}if((f[11120+(A*216|0)+176>>2]|0)==(d|0)){d=1,m=2,_=1;break}if((f[11120+(A*216|0)+184>>2]|0)==(d|0)){d=1,m=2,_=2;break}if((f[11120+(A*216|0)+192>>2]|0)==(d|0)){d=2,m=2,_=0;break}if((f[11120+(A*216|0)+200>>2]|0)==(d|0)){d=2,m=2,_=1;break}if((f[11120+(A*216|0)+208>>2]|0)==(d|0)){d=2,m=2,_=2;break}else d=-1;return d|0}else d=2,m=1,_=1;else d=2,m=1,_=0;else d=1,m=1,_=2;else d=1,m=1,_=1;else d=1,m=1,_=0;else d=0,m=1,_=2;else d=0,m=1,_=1;else d=0,m=1,_=0;else d=2,m=0,_=2;else d=2,m=0,_=1;else d=2,m=0,_=0;else d=1,m=0,_=2;else d=1,m=0,_=1;else d=1,m=0,_=0;else d=0,m=0,_=2;else d=0,m=0,_=1;else d=0,m=0,_=0;while(0);return A=f[11120+(A*216|0)+(m*72|0)+(d*24|0)+(_<<3)+4>>2]|0,A|0}function Lu(d,A){return d=d|0,A=A|0,(f[7696+(d*28|0)+20>>2]|0)==(A|0)?(A=1,A|0):(A=(f[7696+(d*28|0)+24>>2]|0)==(A|0),A|0)}function ol(d,A){return d=d|0,A=A|0,f[848+(d*28|0)+(A<<2)>>2]|0}function al(d,A){return d=d|0,A=A|0,(f[848+(d*28|0)>>2]|0)==(A|0)?(A=0,A|0):(f[848+(d*28|0)+4>>2]|0)==(A|0)?(A=1,A|0):(f[848+(d*28|0)+8>>2]|0)==(A|0)?(A=2,A|0):(f[848+(d*28|0)+12>>2]|0)==(A|0)?(A=3,A|0):(f[848+(d*28|0)+16>>2]|0)==(A|0)?(A=4,A|0):(f[848+(d*28|0)+20>>2]|0)==(A|0)?(A=5,A|0):((f[848+(d*28|0)+24>>2]|0)==(A|0)?6:7)|0}function fc(){return 122}function Ac(d){d=d|0;var A=0,m=0,_=0;A=0;do ye(A|0,0,45)|0,_=ge()|0|134225919,m=d+(A<<3)|0,f[m>>2]=-1,f[m+4>>2]=_,A=A+1|0;while((A|0)!=122);return 0}function Gn(d){return d=d|0,+W[d+16>>3]<+W[d+24>>3]|0}function dc(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;return m=+W[A>>3],!(m>=+W[d+8>>3])||!(m<=+W[d>>3])?(A=0,A|0):(_=+W[d+16>>3],m=+W[d+24>>3],x=+W[A+8>>3],A=x>=m,d=x<=_&1,_<m?A&&(d=1):A||(d=0),A=(d|0)!=0,A|0)}function Du(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0;Ee=de,de=de+288|0,J=Ee+264|0,Ae=Ee+96|0,H=Ee,D=H,O=D+96|0;do f[D>>2]=0,D=D+4|0;while((D|0)<(O|0));return A=w0(A,H)|0,A|0?(Re=A,de=Ee,Re|0):(O=H,H=f[O>>2]|0,O=f[O+4>>2]|0,Qs(H,O,J)|0,La(H,O,Ae)|0,I=+bl(J,Ae+8|0),W[J>>3]=+W[d>>3],O=J+8|0,W[O>>3]=+W[d+16>>3],W[Ae>>3]=+W[d+8>>3],H=Ae+8|0,W[H>>3]=+W[d+24>>3],x=+bl(J,Ae),Je=+W[O>>3]-+W[H>>3],S=+Me(+Je),Be=+W[J>>3]-+W[Ae>>3],_=+Me(+Be),!(Je==0|Be==0)&&(Je=+ze(+S,+_),Je=+Wt(+(x*x/+Ge(+(Je/+Ge(+S,+_)),3)/(I*(I*2.59807621135)*.8))),W[ke>>3]=Je,we=~~Je>>>0,Re=+Me(Je)>=1?Je>0?~~+yn(+be(Je/4294967296),4294967295)>>>0:~~+Wt((Je-+(~~Je>>>0))/4294967296)>>>0:0,(f[ke+4>>2]&2146435072|0)!=2146435072)?(Ae=(we|0)==0&(Re|0)==0,A=m,f[A>>2]=Ae?1:we,f[A+4>>2]=Ae?0:Re,A=0):A=1,Re=A,de=Ee,Re|0)}function ll(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0,J=0;H=de,de=de+288|0,I=H+264|0,D=H+96|0,O=H,x=O,S=x+96|0;do f[x>>2]=0,x=x+4|0;while((x|0)<(S|0));return m=w0(m,O)|0,m|0?(_=m,de=H,_|0):(m=O,x=f[m>>2]|0,m=f[m+4>>2]|0,Qs(x,m,I)|0,La(x,m,D)|0,J=+bl(I,D+8|0),J=+Wt(+(+bl(d,A)/(J*2))),W[ke>>3]=J,m=~~J>>>0,x=+Me(J)>=1?J>0?~~+yn(+be(J/4294967296),4294967295)>>>0:~~+Wt((J-+(~~J>>>0))/4294967296)>>>0:0,(f[ke+4>>2]&2146435072|0)==2146435072?(_=1,de=H,_|0):(O=(m|0)==0&(x|0)==0,f[_>>2]=O?1:m,f[_+4>>2]=O?0:x,_=0,de=H,_|0))}function cl(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0,f[d>>2]=A,f[d+4>>2]=m,f[d+8>>2]=_}function Ru(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0;Ae=A+8|0,f[Ae>>2]=0,O=+W[d>>3],I=+Me(+O),H=+W[d+8>>3],D=+Me(+H)/.8660254037844386,I=I+D*.5,m=~~I,d=~~D,I=I-+(m|0),D=D-+(d|0);do if(I<.5)if(I<.3333333333333333)if(f[A>>2]=m,D<(I+1)*.5){f[A+4>>2]=d;break}else{d=d+1|0,f[A+4>>2]=d;break}else if(we=1-I,d=(!(D<we)&1)+d|0,f[A+4>>2]=d,we<=D&D<I*2){m=m+1|0,f[A>>2]=m;break}else{f[A>>2]=m;break}else{if(!(I<.6666666666666666))if(m=m+1|0,f[A>>2]=m,D<I*.5){f[A+4>>2]=d;break}else{d=d+1|0,f[A+4>>2]=d;break}if(D<1-I){if(f[A+4>>2]=d,I*2+-1<D){f[A>>2]=m;break}}else d=d+1|0,f[A+4>>2]=d;m=m+1|0,f[A>>2]=m}while(0);do if(O<0)if(d&1){J=(d+1|0)/2|0,J=z(m|0,((m|0)<0)<<31>>31|0,J|0,((J|0)<0)<<31>>31|0)|0,m=~~(+(m|0)-((+(J>>>0)+4294967296*+(ge()|0))*2+1)),f[A>>2]=m;break}else{J=(d|0)/2|0,J=z(m|0,((m|0)<0)<<31>>31|0,J|0,((J|0)<0)<<31>>31|0)|0,m=~~(+(m|0)-(+(J>>>0)+4294967296*+(ge()|0))*2),f[A>>2]=m;break}while(0);J=A+4|0,H<0&&(m=m-((d<<1|1|0)/2|0)|0,f[A>>2]=m,d=0-d|0,f[J>>2]=d),_=d-m|0,(m|0)<0?(x=0-m|0,f[J>>2]=_,f[Ae>>2]=x,f[A>>2]=0,d=_,m=0):x=0,(d|0)<0&&(m=m-d|0,f[A>>2]=m,x=x-d|0,f[Ae>>2]=x,f[J>>2]=0,d=0),S=m-x|0,_=d-x|0,(x|0)<0&&(f[A>>2]=S,f[J>>2]=_,f[Ae>>2]=0,d=_,m=S,x=0),_=(d|0)<(m|0)?d:m,_=(x|0)<(_|0)?x:_,!((_|0)<=0)&&(f[A>>2]=m-_,f[J>>2]=d-_,f[Ae>>2]=x-_)}function oi(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0;A=f[d>>2]|0,I=d+4|0,m=f[I>>2]|0,(A|0)<0&&(m=m-A|0,f[I>>2]=m,S=d+8|0,f[S>>2]=(f[S>>2]|0)-A,f[d>>2]=0,A=0),(m|0)<0?(A=A-m|0,f[d>>2]=A,S=d+8|0,x=(f[S>>2]|0)-m|0,f[S>>2]=x,f[I>>2]=0,m=0):(x=d+8|0,S=x,x=f[x>>2]|0),(x|0)<0&&(A=A-x|0,f[d>>2]=A,m=m-x|0,f[I>>2]=m,f[S>>2]=0,x=0),_=(m|0)<(A|0)?m:A,_=(x|0)<(_|0)?x:_,!((_|0)<=0)&&(f[d>>2]=A-_,f[I>>2]=m-_,f[S>>2]=x-_)}function Xs(d,A){d=d|0,A=A|0;var m=0,_=0;_=f[d+8>>2]|0,m=+((f[d+4>>2]|0)-_|0),W[A>>3]=+((f[d>>2]|0)-_|0)-m*.5,W[A+8>>3]=m*.8660254037844386}function $i(d,A,m){d=d|0,A=A|0,m=m|0,f[m>>2]=(f[A>>2]|0)+(f[d>>2]|0),f[m+4>>2]=(f[A+4>>2]|0)+(f[d+4>>2]|0),f[m+8>>2]=(f[A+8>>2]|0)+(f[d+8>>2]|0)}function Sa(d,A,m){d=d|0,A=A|0,m=m|0,f[m>>2]=(f[d>>2]|0)-(f[A>>2]|0),f[m+4>>2]=(f[d+4>>2]|0)-(f[A+4>>2]|0),f[m+8>>2]=(f[d+8>>2]|0)-(f[A+8>>2]|0)}function d0(d,A){d=d|0,A=A|0;var m=0,_=0;m=Xt(f[d>>2]|0,A)|0,f[d>>2]=m,m=d+4|0,_=Xt(f[m>>2]|0,A)|0,f[m>>2]=_,d=d+8|0,A=Xt(f[d>>2]|0,A)|0,f[d>>2]=A}function Ca(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;I=f[d>>2]|0,D=(I|0)<0,_=(f[d+4>>2]|0)-(D?I:0)|0,S=(_|0)<0,x=(S?0-_|0:0)+((f[d+8>>2]|0)-(D?I:0))|0,m=(x|0)<0,d=m?0:x,A=(S?0:_)-(m?x:0)|0,x=(D?0:I)-(S?_:0)-(m?x:0)|0,m=(A|0)<(x|0)?A:x,m=(d|0)<(m|0)?d:m,_=(m|0)>0,d=d-(_?m:0)|0,A=A-(_?m:0)|0;e:do switch(x-(_?m:0)|0){case 0:switch(A|0){case 0:return D=d|0?(d|0)==1?1:7:0,D|0;case 1:return D=d|0?(d|0)==1?3:7:2,D|0;default:break e}case 1:switch(A|0){case 0:return D=d|0?(d|0)==1?5:7:4,D|0;case 1:{if(!d)d=6;else break e;return d|0}default:break e}}while(0);return D=7,D|0}function p0(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;I=d+8|0,x=f[I>>2]|0,S=(f[d>>2]|0)-x|0,D=d+4|0,x=(f[D>>2]|0)-x|0;do if(S>>>0>715827881|x>>>0>715827881){if(m=(S|0)>0,m){if((2147483647-S|0)<(S|0)||(2147483647-(S<<1)|0)<(S|0))return D=1,D|0}else if((-2147483648-S|0)>(S|0)||(-2147483648-(S<<1)|0)>(S|0))return D=1,D|0;if(A=S*3|0,(x|0)>0){if((2147483647-x|0)<(x|0))return D=1,D|0}else if((-2147483648-x|0)>(x|0))return D=1,D|0;if(_=x<<1,(S|0)>-1){if((A|-2147483648|0)>=(x|0))return D=1,D|0}else if((A^-2147483648|0)<(x|0))return D=1,D|0;if(m){if((2147483647-S|0)<(_|0))A=1;else{m=_;break}return A|0}else{if((-2147483648-S|0)>(_|0))A=1;else{m=_;break}return A|0}}else m=x<<1,A=S*3|0;while(0);_=l(+(A-x|0)/7)|0,f[d>>2]=_,x=l(+(m+S|0)/7)|0,f[D>>2]=x,f[I>>2]=0,m=(x|0)<(_|0),A=m?_:x,m=m?x:_;do if((m|0)<0){if((A|0)>0){if((A|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-A|0)>=(m|0)))break;en(23313,22444,355,22455)}if((m|0)==-2147483648|(-2147483648-A|0)>(m|0)&&en(23313,22444,355,22455),(A|0)>-1){if((A|-2147483648|0)<(m|0))break;en(23313,22444,355,22455)}else{if((A^-2147483648|0)>=(m|0))break;en(23313,22444,355,22455)}}while(0);return A=x-_|0,(_|0)<0?(m=0-_|0,f[D>>2]=A,f[I>>2]=m,f[d>>2]=0,_=0):(A=x,m=0),(A|0)<0&&(_=_-A|0,f[d>>2]=_,m=m-A|0,f[I>>2]=m,f[D>>2]=0,A=0),S=_-m|0,x=A-m|0,(m|0)<0?(f[d>>2]=S,f[D>>2]=x,f[I>>2]=0,A=x,x=S,m=0):x=_,_=(A|0)<(x|0)?A:x,_=(m|0)<(_|0)?m:_,(_|0)<=0?(D=0,D|0):(f[d>>2]=x-_,f[D>>2]=A-_,f[I>>2]=m-_,D=0,D|0)}function pc(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;I=d+8|0,x=f[I>>2]|0,S=(f[d>>2]|0)-x|0,D=d+4|0,x=(f[D>>2]|0)-x|0;do if(S>>>0>715827881|x>>>0>715827881){if(m=(S|0)>0,m){if((2147483647-S|0)<(S|0))return D=1,D|0}else if((-2147483648-S|0)>(S|0))return D=1,D|0;if(A=S<<1,(x|0)>0){if((2147483647-x|0)<(x|0)||(2147483647-(x<<1)|0)<(x|0))return D=1,D|0}else if((-2147483648-x|0)>(x|0)||(-2147483648-(x<<1)|0)>(x|0))return D=1,D|0;if(_=x*3|0,m){if((2147483647-A|0)<(x|0))return D=1,D|0}else if((-2147483648-A|0)>(x|0))return D=1,D|0;if((x|0)>-1){if((_|-2147483648|0)<(S|0)){m=_;break}else A=1;return A|0}else{if((_^-2147483648|0)<(S|0))A=1;else{m=_;break}return A|0}}else m=x*3|0,A=S<<1;while(0);_=l(+(A+x|0)/7)|0,f[d>>2]=_,x=l(+(m-S|0)/7)|0,f[D>>2]=x,f[I>>2]=0,m=(x|0)<(_|0),A=m?_:x,m=m?x:_;do if((m|0)<0){if((A|0)>0){if((A|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-A|0)>=(m|0)))break;en(23313,22444,404,22469)}if((m|0)==-2147483648|(-2147483648-A|0)>(m|0)&&en(23313,22444,404,22469),(A|0)>-1){if((A|-2147483648|0)<(m|0))break;en(23313,22444,404,22469)}else{if((A^-2147483648|0)>=(m|0))break;en(23313,22444,404,22469)}}while(0);return A=x-_|0,(_|0)<0?(m=0-_|0,f[D>>2]=A,f[I>>2]=m,f[d>>2]=0,_=0):(A=x,m=0),(A|0)<0&&(_=_-A|0,f[d>>2]=_,m=m-A|0,f[I>>2]=m,f[D>>2]=0,A=0),S=_-m|0,x=A-m|0,(m|0)<0?(f[d>>2]=S,f[D>>2]=x,f[I>>2]=0,A=x,x=S,m=0):x=_,_=(A|0)<(x|0)?A:x,_=(m|0)<(_|0)?m:_,(_|0)<=0?(D=0,D|0):(f[d>>2]=x-_,f[D>>2]=A-_,f[I>>2]=m-_,D=0,D|0)}function mc(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;I=d+8|0,m=f[I>>2]|0,A=(f[d>>2]|0)-m|0,D=d+4|0,m=(f[D>>2]|0)-m|0,_=l(+((A*3|0)-m|0)/7)|0,f[d>>2]=_,A=l(+((m<<1)+A|0)/7)|0,f[D>>2]=A,f[I>>2]=0,m=A-_|0,(_|0)<0?(S=0-_|0,f[D>>2]=m,f[I>>2]=S,f[d>>2]=0,A=m,_=0,m=S):m=0,(A|0)<0&&(_=_-A|0,f[d>>2]=_,m=m-A|0,f[I>>2]=m,f[D>>2]=0,A=0),S=_-m|0,x=A-m|0,(m|0)<0?(f[d>>2]=S,f[D>>2]=x,f[I>>2]=0,A=x,x=S,m=0):x=_,_=(A|0)<(x|0)?A:x,_=(m|0)<(_|0)?m:_,!((_|0)<=0)&&(f[d>>2]=x-_,f[D>>2]=A-_,f[I>>2]=m-_)}function ul(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;I=d+8|0,m=f[I>>2]|0,A=(f[d>>2]|0)-m|0,D=d+4|0,m=(f[D>>2]|0)-m|0,_=l(+((A<<1)+m|0)/7)|0,f[d>>2]=_,A=l(+((m*3|0)-A|0)/7)|0,f[D>>2]=A,f[I>>2]=0,m=A-_|0,(_|0)<0?(S=0-_|0,f[D>>2]=m,f[I>>2]=S,f[d>>2]=0,A=m,_=0,m=S):m=0,(A|0)<0&&(_=_-A|0,f[d>>2]=_,m=m-A|0,f[I>>2]=m,f[D>>2]=0,A=0),S=_-m|0,x=A-m|0,(m|0)<0?(f[d>>2]=S,f[D>>2]=x,f[I>>2]=0,A=x,x=S,m=0):x=_,_=(A|0)<(x|0)?A:x,_=(m|0)<(_|0)?m:_,!((_|0)<=0)&&(f[d>>2]=x-_,f[D>>2]=A-_,f[I>>2]=m-_)}function hl(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;A=f[d>>2]|0,I=d+4|0,m=f[I>>2]|0,D=d+8|0,_=f[D>>2]|0,x=m+(A*3|0)|0,f[d>>2]=x,m=_+(m*3|0)|0,f[I>>2]=m,A=(_*3|0)+A|0,f[D>>2]=A,_=m-x|0,(x|0)<0?(A=A-x|0,f[I>>2]=_,f[D>>2]=A,f[d>>2]=0,m=_,_=0):_=x,(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[D>>2]=A,f[I>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[I>>2]=x,f[D>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[I>>2]=x-m,f[D>>2]=A-m)}function bo(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;x=f[d>>2]|0,I=d+4|0,A=f[I>>2]|0,D=d+8|0,m=f[D>>2]|0,_=(A*3|0)+x|0,x=m+(x*3|0)|0,f[d>>2]=x,f[I>>2]=_,A=(m*3|0)+A|0,f[D>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[I>>2]=m,f[D>>2]=A,f[d>>2]=0,x=0):m=_,(m|0)<0&&(x=x-m|0,f[d>>2]=x,A=A-m|0,f[D>>2]=A,f[I>>2]=0,m=0),S=x-A|0,_=m-A|0,(A|0)<0?(f[d>>2]=S,f[I>>2]=_,f[D>>2]=0,x=S,A=0):_=m,m=(_|0)<(x|0)?_:x,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=x-m,f[I>>2]=_-m,f[D>>2]=A-m)}function qo(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0;(A+-1|0)>>>0>=6||(x=(f[15440+(A*12|0)>>2]|0)+(f[d>>2]|0)|0,f[d>>2]=x,D=d+4|0,_=(f[15440+(A*12|0)+4>>2]|0)+(f[D>>2]|0)|0,f[D>>2]=_,I=d+8|0,A=(f[15440+(A*12|0)+8>>2]|0)+(f[I>>2]|0)|0,f[I>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[D>>2]=m,f[I>>2]=A,f[d>>2]=0,_=0):(m=_,_=x),(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[I>>2]=A,f[D>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[D>>2]=x,f[I>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[D>>2]=x-m,f[I>>2]=A-m))}function zu(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;x=f[d>>2]|0,I=d+4|0,A=f[I>>2]|0,D=d+8|0,m=f[D>>2]|0,_=A+x|0,x=m+x|0,f[d>>2]=x,f[I>>2]=_,A=m+A|0,f[D>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[I>>2]=m,f[D>>2]=A,f[d>>2]=0,_=0):(m=_,_=x),(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[D>>2]=A,f[I>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[I>>2]=x,f[D>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[I>>2]=x-m,f[D>>2]=A-m)}function m0(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;A=f[d>>2]|0,I=d+4|0,_=f[I>>2]|0,D=d+8|0,m=f[D>>2]|0,x=_+A|0,f[d>>2]=x,_=m+_|0,f[I>>2]=_,A=m+A|0,f[D>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[I>>2]=m,f[D>>2]=A,f[d>>2]=0,_=0):(m=_,_=x),(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[D>>2]=A,f[I>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[I>>2]=x,f[D>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[I>>2]=x-m,f[D>>2]=A-m)}function Zo(d){switch(d=d|0,d|0){case 1:{d=5;break}case 5:{d=4;break}case 4:{d=6;break}case 6:{d=2;break}case 2:{d=3;break}case 3:{d=1;break}}return d|0}function Eo(d){switch(d=d|0,d|0){case 1:{d=3;break}case 3:{d=2;break}case 2:{d=6;break}case 6:{d=4;break}case 4:{d=5;break}case 5:{d=1;break}}return d|0}function Bu(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;A=f[d>>2]|0,I=d+4|0,m=f[I>>2]|0,D=d+8|0,_=f[D>>2]|0,x=m+(A<<1)|0,f[d>>2]=x,m=_+(m<<1)|0,f[I>>2]=m,A=(_<<1)+A|0,f[D>>2]=A,_=m-x|0,(x|0)<0?(A=A-x|0,f[I>>2]=_,f[D>>2]=A,f[d>>2]=0,m=_,_=0):_=x,(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[D>>2]=A,f[I>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[I>>2]=x,f[D>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[I>>2]=x-m,f[D>>2]=A-m)}function Ou(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;x=f[d>>2]|0,I=d+4|0,A=f[I>>2]|0,D=d+8|0,m=f[D>>2]|0,_=(A<<1)+x|0,x=m+(x<<1)|0,f[d>>2]=x,f[I>>2]=_,A=(m<<1)+A|0,f[D>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[I>>2]=m,f[D>>2]=A,f[d>>2]=0,x=0):m=_,(m|0)<0&&(x=x-m|0,f[d>>2]=x,A=A-m|0,f[D>>2]=A,f[I>>2]=0,m=0),S=x-A|0,_=m-A|0,(A|0)<0?(f[d>>2]=S,f[I>>2]=_,f[D>>2]=0,x=S,A=0):_=m,m=(_|0)<(x|0)?_:x,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=x-m,f[I>>2]=_-m,f[D>>2]=A-m)}function fl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0;return I=(f[d>>2]|0)-(f[A>>2]|0)|0,D=(I|0)<0,_=(f[d+4>>2]|0)-(f[A+4>>2]|0)-(D?I:0)|0,S=(_|0)<0,x=(D?0-I|0:0)+(f[d+8>>2]|0)-(f[A+8>>2]|0)+(S?0-_|0:0)|0,d=(x|0)<0,A=d?0:x,m=(S?0:_)-(d?x:0)|0,x=(D?0:I)-(S?_:0)-(d?x:0)|0,d=(m|0)<(x|0)?m:x,d=(A|0)<(d|0)?A:d,_=(d|0)>0,A=A-(_?d:0)|0,m=m-(_?d:0)|0,d=x-(_?d:0)|0,d=(d|0)>-1?d:0-d|0,m=(m|0)>-1?m:0-m|0,A=(A|0)>-1?A:0-A|0,A=(m|0)>(A|0)?m:A,((d|0)>(A|0)?d:A)|0}function g0(d,A){d=d|0,A=A|0;var m=0;m=f[d+8>>2]|0,f[A>>2]=(f[d>>2]|0)-m,f[A+4>>2]=(f[d+4>>2]|0)-m}function gc(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0;_=f[d>>2]|0,f[A>>2]=_,x=f[d+4>>2]|0,I=A+4|0,f[I>>2]=x,D=A+8|0,f[D>>2]=0,m=(x|0)<(_|0),d=m?_:x,m=m?x:_;do if((m|0)<0){if((d|0)>0){if((d|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-d|0)>=(m|0)))break;return d=1,d|0}if((m|0)==-2147483648|(-2147483648-d|0)>(m|0))return A=1,A|0;if((d|0)>-1){if((d|-2147483648|0)<(m|0))break;return d=1,d|0}else{if((d^-2147483648|0)<(m|0))d=1;else break;return d|0}}while(0);return d=x-_|0,(_|0)<0?(m=0-_|0,f[I>>2]=d,f[D>>2]=m,f[A>>2]=0,_=0):(d=x,m=0),(d|0)<0&&(_=_-d|0,f[A>>2]=_,m=m-d|0,f[D>>2]=m,f[I>>2]=0,d=0),S=_-m|0,x=d-m|0,(m|0)<0?(f[A>>2]=S,f[I>>2]=x,f[D>>2]=0,d=x,x=S,m=0):x=_,_=(d|0)<(x|0)?d:x,_=(m|0)<(_|0)?m:_,(_|0)<=0?(A=0,A|0):(f[A>>2]=x-_,f[I>>2]=d-_,f[D>>2]=m-_,A=0,A|0)}function _0(d){d=d|0;var A=0,m=0,_=0,x=0;A=d+8|0,x=f[A>>2]|0,m=x-(f[d>>2]|0)|0,f[d>>2]=m,_=d+4|0,d=(f[_>>2]|0)-x|0,f[_>>2]=d,f[A>>2]=0-(d+m)}function Pa(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;m=f[d>>2]|0,A=0-m|0,f[d>>2]=A,I=d+8|0,f[I>>2]=0,D=d+4|0,_=f[D>>2]|0,x=_+m|0,(m|0)>0?(f[D>>2]=x,f[I>>2]=m,f[d>>2]=0,A=0,_=x):m=0,(_|0)<0?(S=A-_|0,f[d>>2]=S,m=m-_|0,f[I>>2]=m,f[D>>2]=0,x=S-m|0,A=0-m|0,(m|0)<0?(f[d>>2]=x,f[D>>2]=A,f[I>>2]=0,_=A,m=0):(_=0,x=S)):x=A,A=(_|0)<(x|0)?_:x,A=(m|0)<(A|0)?m:A,!((A|0)<=0)&&(f[d>>2]=x-A,f[D>>2]=_-A,f[I>>2]=m-A)}function Fu(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0;if(Ae=de,de=de+64|0,J=Ae,D=Ae+56|0,!(!0&(A&2013265920|0)==134217728&(!0&(_&2013265920|0)==134217728)))return x=5,de=Ae,x|0;if((d|0)==(m|0)&(A|0)==(_|0))return f[x>>2]=0,x=0,de=Ae,x|0;if(I=le(d|0,A|0,52)|0,ge()|0,I=I&15,H=le(m|0,_|0,52)|0,ge()|0,(I|0)!=(H&15|0))return x=12,de=Ae,x|0;if(S=I+-1|0,I>>>0>1){gl(d,A,S,J)|0,gl(m,_,S,D)|0,H=J,O=f[H>>2]|0,H=f[H+4>>2]|0;e:do if((O|0)==(f[D>>2]|0)&&(H|0)==(f[D+4>>2]|0)){I=(I^15)*3|0,S=le(d|0,A|0,I|0)|0,ge()|0,S=S&7,I=le(m|0,_|0,I|0)|0,ge()|0,I=I&7;do if((S|0)==0|(I|0)==0)f[x>>2]=1,S=0;else if((S|0)==7)S=5;else{if((S|0)==1|(I|0)==1&&Jn(O,H)|0){S=5;break}if((f[15536+(S<<2)>>2]|0)!=(I|0)&&(f[15568+(S<<2)>>2]|0)!=(I|0))break e;f[x>>2]=1,S=0}while(0);return x=S,de=Ae,x|0}while(0)}S=J,I=S+56|0;do f[S>>2]=0,S=S+4|0;while((S|0)<(I|0));return sl(d,A,1,J)|0,A=J,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0))&&(A=J+8|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))&&(A=J+16|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))&&(A=J+24|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))&&(A=J+32|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))&&(A=J+40|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))?(S=J+48|0,S=((f[S>>2]|0)==(m|0)?(f[S+4>>2]|0)==(_|0):0)&1):S=1,f[x>>2]=S,x=0,de=Ae,x|0}function Nu(d,A,m,_,x){return d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,m=Xe(d,A,m,_)|0,(m|0)==7?(x=11,x|0):(_=ye(m|0,0,56)|0,A=A&-2130706433|(ge()|0)|268435456,f[x>>2]=d|_,f[x+4>>2]=A,x=0,x|0)}function y0(d,A,m){return d=d|0,A=A|0,m=m|0,!0&(A&2013265920|0)==268435456?(f[m>>2]=d,f[m+4>>2]=A&-2130706433|134217728,m=0,m|0):(m=6,m|0)}function Xo(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;return x=de,de=de+16|0,_=x,f[_>>2]=0,!0&(A&2013265920|0)==268435456?(S=le(d|0,A|0,56)|0,ge()|0,_=Ie(d,A&-2130706433|134217728,S&7,_,m)|0,de=x,_|0):(_=6,de=x,_|0)}function Uu(d,A){d=d|0,A=A|0;var m=0;switch(m=le(d|0,A|0,56)|0,ge()|0,m&7){case 0:case 7:return m=0,m|0}return m=A&-2130706433|134217728,!(!0&(A&2013265920|0)==268435456)||!0&(A&117440512|0)==16777216&(Jn(d,m)|0)!=0?(m=0,m|0):(m=Qo(d,m)|0,m|0)}function Ma(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0;return x=de,de=de+16|0,_=x,!0&(A&2013265920|0)==268435456?(S=A&-2130706433|134217728,I=m,f[I>>2]=d,f[I+4>>2]=S,f[_>>2]=0,A=le(d|0,A|0,56)|0,ge()|0,_=Ie(d,S,A&7,_,m+8|0)|0,de=x,_|0):(_=6,de=x,_|0)}function ui(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;return x=(Jn(d,A)|0)==0,A=A&-2130706433,_=m,f[_>>2]=x?d:0,f[_+4>>2]=x?A|285212672:0,_=m+8|0,f[_>>2]=d,f[_+4>>2]=A|301989888,_=m+16|0,f[_>>2]=d,f[_+4>>2]=A|318767104,_=m+24|0,f[_>>2]=d,f[_+4>>2]=A|335544320,_=m+32|0,f[_>>2]=d,f[_+4>>2]=A|352321536,m=m+40|0,f[m>>2]=d,f[m+4>>2]=A|369098752,0}function Al(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0;return I=de,de=de+16|0,x=I,S=A&-2130706433|134217728,!0&(A&2013265920|0)==268435456?(_=le(d|0,A|0,56)|0,ge()|0,_=Ht(d,S,_&7)|0,(_|0)==-1?(f[m>>2]=0,S=6,de=I,S|0):(ds(d,S,x)|0&&en(23313,22484,282,22499),A=le(d|0,A|0,52)|0,ge()|0,A=A&15,Jn(d,S)|0?To(x,A,_,2,m):_c(x,A,_,2,m),S=0,de=I,S|0)):(S=6,de=I,S|0)}function Ln(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;_=de,de=de+16|0,x=_,Wn(d,A,m,x),Ru(x,m+4|0),de=_}function Wn(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0;if(D=de,de=de+16|0,O=D,li(d,m,O),S=+St(+(1-+W[O>>3]*.5)),S<1e-16){f[_>>2]=0,f[_+4>>2]=0,f[_+8>>2]=0,f[_+12>>2]=0,de=D;return}if(O=f[m>>2]|0,x=+W[15920+(O*24|0)>>3],x=+Ki(x-+Ki(+Zu(15600+(O<<4)|0,d))),br(A)|0?I=+Ki(x+-.3334731722518321):I=x,x=+It(+S)/.381966011250105,(A|0)>0){d=0;do x=x*2.6457513110645907,d=d+1|0;while((d|0)!=(A|0))}S=+Ue(+I)*x,W[_>>3]=S,I=+ct(+I)*x,W[_+8>>3]=I,de=D}function li(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if(S=de,de=de+32|0,x=S,Cl(d,x),f[A>>2]=0,W[m>>3]=5,_=+ei(16400,x),_<+W[m>>3]&&(f[A>>2]=0,W[m>>3]=_),_=+ei(16424,x),_<+W[m>>3]&&(f[A>>2]=1,W[m>>3]=_),_=+ei(16448,x),_<+W[m>>3]&&(f[A>>2]=2,W[m>>3]=_),_=+ei(16472,x),_<+W[m>>3]&&(f[A>>2]=3,W[m>>3]=_),_=+ei(16496,x),_<+W[m>>3]&&(f[A>>2]=4,W[m>>3]=_),_=+ei(16520,x),_<+W[m>>3]&&(f[A>>2]=5,W[m>>3]=_),_=+ei(16544,x),_<+W[m>>3]&&(f[A>>2]=6,W[m>>3]=_),_=+ei(16568,x),_<+W[m>>3]&&(f[A>>2]=7,W[m>>3]=_),_=+ei(16592,x),_<+W[m>>3]&&(f[A>>2]=8,W[m>>3]=_),_=+ei(16616,x),_<+W[m>>3]&&(f[A>>2]=9,W[m>>3]=_),_=+ei(16640,x),_<+W[m>>3]&&(f[A>>2]=10,W[m>>3]=_),_=+ei(16664,x),_<+W[m>>3]&&(f[A>>2]=11,W[m>>3]=_),_=+ei(16688,x),_<+W[m>>3]&&(f[A>>2]=12,W[m>>3]=_),_=+ei(16712,x),_<+W[m>>3]&&(f[A>>2]=13,W[m>>3]=_),_=+ei(16736,x),_<+W[m>>3]&&(f[A>>2]=14,W[m>>3]=_),_=+ei(16760,x),_<+W[m>>3]&&(f[A>>2]=15,W[m>>3]=_),_=+ei(16784,x),_<+W[m>>3]&&(f[A>>2]=16,W[m>>3]=_),_=+ei(16808,x),_<+W[m>>3]&&(f[A>>2]=17,W[m>>3]=_),_=+ei(16832,x),_<+W[m>>3]&&(f[A>>2]=18,W[m>>3]=_),_=+ei(16856,x),!(_<+W[m>>3])){de=S;return}f[A>>2]=19,W[m>>3]=_,de=S}function Kn(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0;if(S=+th(d),S<1e-16){A=15600+(A<<4)|0,f[x>>2]=f[A>>2],f[x+4>>2]=f[A+4>>2],f[x+8>>2]=f[A+8>>2],f[x+12>>2]=f[A+12>>2];return}if(I=+sn(+ +W[d+8>>3],+ +W[d>>3]),(m|0)>0){d=0;do S=S/2.6457513110645907,d=d+1|0;while((d|0)!=(m|0))}_?(S=S/3,m=(br(m)|0)==0,S=+Vt(+((m?S:S/2.6457513110645907)*.381966011250105))):(S=+Vt(+(S*.381966011250105)),br(m)|0&&(I=+Ki(I+.3334731722518321))),Ys(15600+(A<<4)|0,+Ki(+W[15920+(A*24|0)>>3]-I),S,x)}function dl(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;_=de,de=de+16|0,x=_,Xs(d+4|0,x),Kn(x,f[d>>2]|0,A,0,m),de=_}function To(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0,bt=0,rt=0,ft=0,dn=0,un=0,rn=0,on=0,hn=0,gn=0,jn=0,pn=0;if(gn=de,de=de+272|0,S=gn+256|0,He=gn+240|0,rn=gn,on=gn+224|0,hn=gn+208|0,We=gn+176|0,Oe=gn+160|0,Pt=gn+192|0,bt=gn+144|0,rt=gn+128|0,ft=gn+112|0,dn=gn+96|0,un=gn+80|0,f[S>>2]=A,f[He>>2]=f[d>>2],f[He+4>>2]=f[d+4>>2],f[He+8>>2]=f[d+8>>2],f[He+12>>2]=f[d+12>>2],Vu(He,S,rn),f[x>>2]=0,He=_+m+((_|0)==5&1)|0,(He|0)<=(m|0)){de=gn;return}O=f[S>>2]|0,H=on+4|0,J=We+4|0,Ae=m+5|0,we=16880+(O<<2)|0,Re=16960+(O<<2)|0,Ee=rt+8|0,Be=ft+8|0,Je=dn+8|0,Ye=hn+4|0,D=m;e:for(;;){I=rn+(((D|0)%5|0)<<4)|0,f[hn>>2]=f[I>>2],f[hn+4>>2]=f[I+4>>2],f[hn+8>>2]=f[I+8>>2],f[hn+12>>2]=f[I+12>>2];do;while((Ia(hn,O,0,1)|0)==2);if((D|0)>(m|0)&(br(A)|0)!=0){if(f[We>>2]=f[hn>>2],f[We+4>>2]=f[hn+4>>2],f[We+8>>2]=f[hn+8>>2],f[We+12>>2]=f[hn+12>>2],Xs(H,Oe),_=f[We>>2]|0,S=f[17040+(_*80|0)+(f[on>>2]<<2)>>2]|0,f[We>>2]=f[18640+(_*80|0)+(S*20|0)>>2],I=f[18640+(_*80|0)+(S*20|0)+16>>2]|0,(I|0)>0){d=0;do zu(J),d=d+1|0;while((d|0)<(I|0))}switch(I=18640+(_*80|0)+(S*20|0)+4|0,f[Pt>>2]=f[I>>2],f[Pt+4>>2]=f[I+4>>2],f[Pt+8>>2]=f[I+8>>2],d0(Pt,(f[we>>2]|0)*3|0),$i(J,Pt,J),oi(J),Xs(J,bt),jn=+(f[Re>>2]|0),W[rt>>3]=jn*3,W[Ee>>3]=0,pn=jn*-1.5,W[ft>>3]=pn,W[Be>>3]=jn*2.598076211353316,W[dn>>3]=pn,W[Je>>3]=jn*-2.598076211353316,f[17040+((f[We>>2]|0)*80|0)+(f[hn>>2]<<2)>>2]|0){case 1:{d=ft,_=rt;break}case 3:{d=dn,_=ft;break}case 2:{d=rt,_=dn;break}default:{d=12;break e}}Ic(Oe,bt,_,d,un),Kn(un,f[We>>2]|0,O,1,x+8+(f[x>>2]<<4)|0),f[x>>2]=(f[x>>2]|0)+1}if((D|0)<(Ae|0)&&(Xs(Ye,We),Kn(We,f[hn>>2]|0,O,1,x+8+(f[x>>2]<<4)|0),f[x>>2]=(f[x>>2]|0)+1),f[on>>2]=f[hn>>2],f[on+4>>2]=f[hn+4>>2],f[on+8>>2]=f[hn+8>>2],f[on+12>>2]=f[hn+12>>2],D=D+1|0,(D|0)>=(He|0)){d=3;break}}if((d|0)==3){de=gn;return}else(d|0)==12&&en(22522,22569,571,22579)}function Vu(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0;O=de,de=de+128|0,_=O+64|0,x=O,S=_,I=20240,D=S+60|0;do f[S>>2]=f[I>>2],S=S+4|0,I=I+4|0;while((S|0)<(D|0));S=x,I=20304,D=S+60|0;do f[S>>2]=f[I>>2],S=S+4|0,I=I+4|0;while((S|0)<(D|0));D=(br(f[A>>2]|0)|0)==0,_=D?_:x,x=d+4|0,Bu(x),Ou(x),br(f[A>>2]|0)|0&&(bo(x),f[A>>2]=(f[A>>2]|0)+1),f[m>>2]=f[d>>2],A=m+4|0,$i(x,_,A),oi(A),f[m+16>>2]=f[d>>2],A=m+20|0,$i(x,_+12|0,A),oi(A),f[m+32>>2]=f[d>>2],A=m+36|0,$i(x,_+24|0,A),oi(A),f[m+48>>2]=f[d>>2],A=m+52|0,$i(x,_+36|0,A),oi(A),f[m+64>>2]=f[d>>2],m=m+68|0,$i(x,_+48|0,m),oi(m),de=O}function Ia(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0;if(Ee=de,de=de+32|0,we=Ee+12|0,D=Ee,Re=d+4|0,Ae=f[16960+(A<<2)>>2]|0,J=(_|0)!=0,Ae=J?Ae*3|0:Ae,x=f[Re>>2]|0,H=d+8|0,I=f[H>>2]|0,J){if(S=d+12|0,_=f[S>>2]|0,x=I+x+_|0,(x|0)==(Ae|0))return Re=1,de=Ee,Re|0;O=S}else O=d+12|0,_=f[O>>2]|0,x=I+x+_|0;if((x|0)<=(Ae|0))return Re=0,de=Ee,Re|0;do if((_|0)>0){if(_=f[d>>2]|0,(I|0)>0){S=18640+(_*80|0)+60|0,_=d;break}_=18640+(_*80|0)+40|0,m?(cl(we,Ae,0,0),Sa(Re,we,D),m0(D),$i(D,we,Re),S=_,_=d):(S=_,_=d)}else S=18640+((f[d>>2]|0)*80|0)+20|0,_=d;while(0);if(f[_>>2]=f[S>>2],x=S+16|0,(f[x>>2]|0)>0){_=0;do zu(Re),_=_+1|0;while((_|0)<(f[x>>2]|0))}return d=S+4|0,f[we>>2]=f[d>>2],f[we+4>>2]=f[d+4>>2],f[we+8>>2]=f[d+8>>2],A=f[16880+(A<<2)>>2]|0,d0(we,J?A*3|0:A),$i(Re,we,Re),oi(Re),J?_=((f[H>>2]|0)+(f[Re>>2]|0)+(f[O>>2]|0)|0)==(Ae|0)?1:2:_=2,Re=_,de=Ee,Re|0}function Gu(d,A){d=d|0,A=A|0;var m=0;do m=Ia(d,A,0,1)|0;while((m|0)==2);return m|0}function _c(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0,bt=0,rt=0,ft=0,dn=0,un=0,rn=0;if(dn=de,de=de+240|0,S=dn+224|0,Pt=dn+208|0,bt=dn,rt=dn+192|0,ft=dn+176|0,Je=dn+160|0,Ye=dn+144|0,He=dn+128|0,We=dn+112|0,Oe=dn+96|0,f[S>>2]=A,f[Pt>>2]=f[d>>2],f[Pt+4>>2]=f[d+4>>2],f[Pt+8>>2]=f[d+8>>2],f[Pt+12>>2]=f[d+12>>2],pl(Pt,S,bt),f[x>>2]=0,Be=_+m+((_|0)==6&1)|0,(Be|0)<=(m|0)){de=dn;return}O=f[S>>2]|0,H=m+6|0,J=16960+(O<<2)|0,Ae=Ye+8|0,we=He+8|0,Re=We+8|0,Ee=rt+4|0,I=0,D=m,_=-1;e:for(;;){if(S=(D|0)%6|0,d=bt+(S<<4)|0,f[rt>>2]=f[d>>2],f[rt+4>>2]=f[d+4>>2],f[rt+8>>2]=f[d+8>>2],f[rt+12>>2]=f[d+12>>2],d=I,I=Ia(rt,O,0,1)|0,(D|0)>(m|0)&(br(A)|0)!=0&&(d|0)!=1&&(f[rt>>2]|0)!=(_|0)){switch(Xs(bt+(((S+5|0)%6|0)<<4)+4|0,ft),Xs(bt+(S<<4)+4|0,Je),un=+(f[J>>2]|0),W[Ye>>3]=un*3,W[Ae>>3]=0,rn=un*-1.5,W[He>>3]=rn,W[we>>3]=un*2.598076211353316,W[We>>3]=rn,W[Re>>3]=un*-2.598076211353316,S=f[Pt>>2]|0,f[17040+(S*80|0)+(((_|0)==(S|0)?f[rt>>2]|0:_)<<2)>>2]|0){case 1:{d=He,_=Ye;break}case 3:{d=We,_=He;break}case 2:{d=Ye,_=We;break}default:{d=8;break e}}Ic(ft,Je,_,d,Oe),!(nh(ft,Oe)|0)&&!(nh(Je,Oe)|0)&&(Kn(Oe,f[Pt>>2]|0,O,1,x+8+(f[x>>2]<<4)|0),f[x>>2]=(f[x>>2]|0)+1)}if((D|0)<(H|0)&&(Xs(Ee,ft),Kn(ft,f[rt>>2]|0,O,1,x+8+(f[x>>2]<<4)|0),f[x>>2]=(f[x>>2]|0)+1),D=D+1|0,(D|0)>=(Be|0)){d=3;break}else _=f[rt>>2]|0}if((d|0)==3){de=dn;return}else(d|0)==8&&en(22606,22569,736,22651)}function pl(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0;O=de,de=de+160|0,_=O+80|0,x=O,S=_,I=20368,D=S+72|0;do f[S>>2]=f[I>>2],S=S+4|0,I=I+4|0;while((S|0)<(D|0));S=x,I=20448,D=S+72|0;do f[S>>2]=f[I>>2],S=S+4|0,I=I+4|0;while((S|0)<(D|0));D=(br(f[A>>2]|0)|0)==0,_=D?_:x,x=d+4|0,Bu(x),Ou(x),br(f[A>>2]|0)|0&&(bo(x),f[A>>2]=(f[A>>2]|0)+1),f[m>>2]=f[d>>2],A=m+4|0,$i(x,_,A),oi(A),f[m+16>>2]=f[d>>2],A=m+20|0,$i(x,_+12|0,A),oi(A),f[m+32>>2]=f[d>>2],A=m+36|0,$i(x,_+24|0,A),oi(A),f[m+48>>2]=f[d>>2],A=m+52|0,$i(x,_+36|0,A),oi(A),f[m+64>>2]=f[d>>2],A=m+68|0,$i(x,_+48|0,A),oi(A),f[m+80>>2]=f[d>>2],m=m+84|0,$i(x,_+60|0,m),oi(m),de=O}function ml(d,A){return d=d|0,A=A|0,A=le(d|0,A|0,52)|0,ge()|0,A&15|0}function ka(d,A){return d=d|0,A=A|0,A=le(d|0,A|0,45)|0,ge()|0,A&127|0}function Qo(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0;if(!(!0&(A&-16777216|0)==134217728)||(I=le(d|0,A|0,45)|0,ge()|0,I=I&127,I>>>0>121))return A=0,A|0;m=le(d|0,A|0,52)|0,ge()|0,m=m&15;do if(m|0){for(x=1,_=0;;){if(S=le(d|0,A|0,(15-x|0)*3|0)|0,ge()|0,S=S&7,(S|0)!=0&(_^1))if((S|0)==1&(zn(I)|0)!=0){D=0,_=13;break}else _=1;if((S|0)==7){D=0,_=13;break}if(x>>>0<m>>>0)x=x+1|0;else{_=9;break}}if((_|0)==9){if((m|0)==15)D=1;else break;return D|0}else if((_|0)==13)return D|0}while(0);for(;;){if(D=le(d|0,A|0,(14-m|0)*3|0)|0,ge()|0,!((D&7|0)==7&!0)){D=0,_=13;break}if(m>>>0<14)m=m+1|0;else{D=1,_=13;break}}return(_|0)==13?D|0:0}function gl(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0;if(S=le(d|0,A|0,52)|0,ge()|0,S=S&15,m>>>0>15)return _=4,_|0;if((S|0)<(m|0))return _=12,_|0;if((S|0)==(m|0))return f[_>>2]=d,f[_+4>>2]=A,_=0,_|0;if(x=ye(m|0,0,52)|0,x=x|d,d=ge()|0|A&-15728641,(S|0)>(m|0))do A=ye(7,0,(14-m|0)*3|0)|0,m=m+1|0,x=A|x,d=ge()|0|d;while((m|0)<(S|0));return f[_>>2]=x,f[_+4>>2]=d,_=0,_|0}function _l(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0;if(S=le(d|0,A|0,52)|0,ge()|0,S=S&15,!((m|0)<16&(S|0)<=(m|0)))return _=4,_|0;x=m-S|0,m=le(d|0,A|0,45)|0,ge()|0;e:do if(!(zn(m&127)|0))m=zs(7,0,x,((x|0)<0)<<31>>31)|0,x=ge()|0;else{t:do if(S|0){for(m=1;I=ye(7,0,(15-m|0)*3|0)|0,!!((I&d|0)==0&((ge()|0)&A|0)==0);)if(m>>>0<S>>>0)m=m+1|0;else break t;m=zs(7,0,x,((x|0)<0)<<31>>31)|0,x=ge()|0;break e}while(0);m=zs(7,0,x,((x|0)<0)<<31>>31)|0,m=se(m|0,ge()|0,5,0)|0,m=P(m|0,ge()|0,-5,-1)|0,m=$(m|0,ge()|0,6,0)|0,m=P(m|0,ge()|0,1,0)|0,x=ge()|0}while(0);return I=_,f[I>>2]=m,f[I+4>>2]=x,I=0,I|0}function Jn(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;if(x=le(d|0,A|0,45)|0,ge()|0,!(zn(x&127)|0))return x=0,x|0;x=le(d|0,A|0,52)|0,ge()|0,x=x&15;e:do if(!x)m=0;else for(_=1;;){if(m=le(d|0,A|0,(15-_|0)*3|0)|0,ge()|0,m=m&7,m|0)break e;if(_>>>0<x>>>0)_=_+1|0;else{m=0;break}}while(0);return x=(m|0)==0&1,x|0}function v0(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0;if(I=de,de=de+16|0,S=I,Ra(S,d,A,m),A=S,d=f[A>>2]|0,A=f[A+4>>2]|0,(d|0)==0&(A|0)==0)return de=I,0;x=0,m=0;do D=_+(x<<3)|0,f[D>>2]=d,f[D+4>>2]=A,x=P(x|0,m|0,1,0)|0,m=ge()|0,za(S),D=S,d=f[D>>2]|0,A=f[D+4>>2]|0;while(!((d|0)==0&(A|0)==0));return de=I,0}function As(d,A,m,_){return d=d|0,A=A|0,m=m|0,_=_|0,(_|0)<(m|0)?(m=A,_=d,Ut(m|0),_|0):(m=ye(-1,-1,((_-m|0)*3|0)+3|0)|0,_=ye(~m|0,~(ge()|0)|0,(15-_|0)*3|0)|0,m=~(ge()|0)&A,_=~_&d,Ut(m|0),_|0)}function ju(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0;return x=le(d|0,A|0,52)|0,ge()|0,x=x&15,(m|0)<16&(x|0)<=(m|0)?((x|0)<(m|0)&&(x=ye(-1,-1,((m+-1-x|0)*3|0)+3|0)|0,x=ye(~x|0,~(ge()|0)|0,(15-m|0)*3|0)|0,A=~(ge()|0)&A,d=~x&d),x=ye(m|0,0,52)|0,m=A&-15728641|(ge()|0),f[_>>2]=d|x,f[_+4>>2]=m,_=0,_|0):(_=4,_|0)}function yc(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0,bt=0,rt=0,ft=0;if((m|0)==0&(_|0)==0)return rt=0,rt|0;if(x=d,S=f[x>>2]|0,x=f[x+4>>2]|0,!0&(x&15728640|0)==0){if(!((_|0)>0|(_|0)==0&m>>>0>0)||(rt=A,f[rt>>2]=S,f[rt+4>>2]=x,(m|0)==1&(_|0)==0))return rt=0,rt|0;x=1;do Pt=d+(x<<3)|0,bt=f[Pt+4>>2]|0,rt=A+(x<<3)|0,f[rt>>2]=f[Pt>>2],f[rt+4>>2]=bt,x=x+1|0;while(0<(_|0)|(_|0)==0&x>>>0<m>>>0);return x=0,x|0}if(Oe=m<<3,bt=p(Oe)|0,!bt)return rt=13,rt|0;if(Ze(bt|0,d|0,Oe|0)|0,Pt=E(m,8)|0,!Pt)return v(bt),rt=13,rt|0;e:do if(m|0){t:for(;;){x=bt,Ye=f[x>>2]|0,x=f[x+4>>2]|0,He=le(Ye|0,x|0,52)|0,ge()|0,He=He&15,We=He+-1|0,Je=(m|0)>0;n:do if((He|0)!=0&Je){if(Re=((m|0)<0)<<31>>31,Ee=ye(We|0,0,52)|0,Be=ge()|0,We>>>0>15){if(!((Ye|0)==0&(x|0)==0)){rt=17;break t}for(S=0;;){if(S=S+1|0,(S|0)>=(m|0))break n;if(_=bt+(S<<3)|0,Be=f[_>>2]|0,_=f[_+4>>2]|0,!((Be|0)==0&(_|0)==0)){x=_,rt=17;break t}}}for(S=0,d=Ye,_=x;;){if(!((d|0)==0&(_|0)==0)){if(!(!0&(_&117440512|0)==0)){rt=22;break t}if(D=le(d|0,_|0,52)|0,ge()|0,D=D&15,(D|0)<(We|0)){x=12,rt=28;break t}if((D|0)!=(We|0)&&(d=d|Ee,_=_&-15728641|Be,D>>>0>=He>>>0)){I=We;do we=ye(7,0,(14-I|0)*3|0)|0,I=I+1|0,d=we|d,_=ge()|0|_;while(I>>>0<D>>>0)}if(I=xe(d|0,_|0,m|0,Re|0)|0,ge()|0,H=Pt+(I<<3)|0,D=H,O=f[D>>2]|0,D=f[D+4>>2]|0,(O|0)==0&(D|0)==0)I=H;else for(we=0;;){if((we|0)>(m|0)){rt=32;break t}if((O|0)==(d|0)&(D&-117440513|0)==(_|0)){J=le(O|0,D|0,56)|0,ge()|0,J=J&7,Ae=J+1|0,ft=le(O|0,D|0,45)|0,ge()|0;i:do if(!(zn(ft&127)|0))D=7;else{if(O=le(O|0,D|0,52)|0,ge()|0,O=O&15,!O){D=6;break}for(D=1;;){if(ft=ye(7,0,(15-D|0)*3|0)|0,!((ft&d|0)==0&((ge()|0)&_|0)==0)){D=7;break i}if(D>>>0<O>>>0)D=D+1|0;else{D=6;break}}}while(0);if((J+2|0)>>>0>D>>>0){rt=42;break t}ft=ye(Ae|0,0,56)|0,_=ge()|0|_&-117440513,Ae=H,f[Ae>>2]=0,f[Ae+4>>2]=0,d=ft|d}else I=(I+1|0)%(m|0)|0;if(H=Pt+(I<<3)|0,D=H,O=f[D>>2]|0,D=f[D+4>>2]|0,(O|0)==0&(D|0)==0){I=H;break}else we=we+1|0}ft=I,f[ft>>2]=d,f[ft+4>>2]=_}if(S=S+1|0,(S|0)>=(m|0))break n;_=bt+(S<<3)|0,d=f[_>>2]|0,_=f[_+4>>2]|0}}while(0);if((m+5|0)>>>0<11){rt=85;break}if(Be=E((m|0)/6|0,8)|0,!Be){rt=49;break}n:do if(Je){we=0,Ae=0;do{if(D=Pt+(we<<3)|0,_=D,S=f[_>>2]|0,_=f[_+4>>2]|0,!((S|0)==0&(_|0)==0)){O=le(S|0,_|0,56)|0,ge()|0,O=O&7,d=O+1|0,H=_&-117440513,ft=le(S|0,_|0,45)|0,ge()|0;i:do if(zn(ft&127)|0){if(J=le(S|0,_|0,52)|0,ge()|0,J=J&15,J|0)for(I=1;;){if(ft=ye(7,0,(15-I|0)*3|0)|0,!((S&ft|0)==0&(H&(ge()|0)|0)==0))break i;if(I>>>0<J>>>0)I=I+1|0;else break}_=ye(d|0,0,56)|0,S=_|S,_=ge()|0|H,d=D,f[d>>2]=S,f[d+4>>2]=_,d=O+2|0}while(0);(d|0)==7&&(ft=Be+(Ae<<3)|0,f[ft>>2]=S,f[ft+4>>2]=_&-117440513,Ae=Ae+1|0)}we=we+1|0}while((we|0)!=(m|0));if(Je){if(we=((m|0)<0)<<31>>31,Re=ye(We|0,0,52)|0,Ee=ge()|0,We>>>0>15){if(!((Ye|0)==0&(x|0)==0)){x=4,rt=84;break t}for(x=0;;){if(x=x+1|0,(x|0)>=(m|0)){S=0,x=Ae;break n}if(ft=bt+(x<<3)|0,!((f[ft>>2]|0)==0&(f[ft+4>>2]|0)==0)){x=4,rt=84;break t}}}for(J=0,S=0,H=Ye;;){do if(!((H|0)==0&(x|0)==0)){if(D=le(H|0,x|0,52)|0,ge()|0,D=D&15,(D|0)<(We|0)){x=12,rt=84;break t}do if((D|0)==(We|0))_=H,D=x;else{if(_=H|Re,d=x&-15728641|Ee,D>>>0<He>>>0){D=d;break}I=We;do ft=ye(7,0,(14-I|0)*3|0)|0,I=I+1|0,_=ft|_,d=ge()|0|d;while(I>>>0<D>>>0);D=d}while(0);for(I=xe(_|0,D|0,m|0,we|0)|0,ge()|0,d=0;;){if((d|0)>(m|0)){rt=77;break t}if(ft=Pt+(I<<3)|0,O=f[ft+4>>2]|0,(O&-117440513|0)==(D|0)&&(f[ft>>2]|0)==(_|0)){rt=79;break}if(I=(I+1|0)%(m|0)|0,ft=Pt+(I<<3)|0,(f[ft>>2]|0)==(_|0)&&(f[ft+4>>2]|0)==(D|0))break;d=d+1|0}if((rt|0)==79&&(rt=0,!0&(O&117440512|0)==100663296))break;ft=A+(S<<3)|0,f[ft>>2]=H,f[ft+4>>2]=x,S=S+1|0}while(0);if(x=J+1|0,(x|0)>=(m|0)){x=Ae;break n}ft=bt+(x<<3)|0,J=x,H=f[ft>>2]|0,x=f[ft+4>>2]|0}}else S=0,x=Ae}else S=0,x=0;while(0);if(je(Pt|0,0,Oe|0)|0,Ze(bt|0,Be|0,x<<3|0)|0,v(Be),x)A=A+(S<<3)|0,m=x;else break e}if((rt|0)==17)!0&(x&117440512|0)==0?(x=4,rt=28):rt=22;else if((rt|0)==32)en(23313,22674,362,22684);else{if((rt|0)==42)return v(bt),v(Pt),ft=10,ft|0;if((rt|0)==49)return v(bt),v(Pt),ft=13,ft|0;if((rt|0)==77)en(23313,22674,462,22684);else{if((rt|0)==84)return v(Be),v(bt),v(Pt),ft=x,ft|0;if((rt|0)==85){Ze(A|0,bt|0,m<<3|0)|0;break}}}if((rt|0)==22)return v(bt),v(Pt),ft=5,ft|0;if((rt|0)==28)return v(bt),v(Pt),ft=x,ft|0}while(0);return v(bt),v(Pt),ft=0,ft|0}function Hu(d,A,m,_,x,S,I){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0,I=I|0;var D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0;if(Be=de,de=de+16|0,Ee=Be,!((m|0)>0|(m|0)==0&A>>>0>0))return Ee=0,de=Be,Ee|0;if((I|0)>=16)return Ee=12,de=Be,Ee|0;we=0,Re=0,Ae=0,D=0;e:for(;;){if(H=d+(we<<3)|0,O=f[H>>2]|0,H=f[H+4>>2]|0,J=le(O|0,H|0,52)|0,ge()|0,(J&15|0)>(I|0)){D=12,O=11;break}if(Ra(Ee,O,H,I),J=Ee,H=f[J>>2]|0,J=f[J+4>>2]|0,(H|0)==0&(J|0)==0)O=Ae;else{O=Ae;do{if(!((D|0)<(S|0)|(D|0)==(S|0)&O>>>0<x>>>0)){O=10;break e}Ae=_+(O<<3)|0,f[Ae>>2]=H,f[Ae+4>>2]=J,O=P(O|0,D|0,1,0)|0,D=ge()|0,za(Ee),Ae=Ee,H=f[Ae>>2]|0,J=f[Ae+4>>2]|0}while(!((H|0)==0&(J|0)==0))}if(we=P(we|0,Re|0,1,0)|0,Re=ge()|0,(Re|0)<(m|0)|(Re|0)==(m|0)&we>>>0<A>>>0)Ae=O;else{D=0,O=11;break}}return(O|0)==10?(Ee=14,de=Be,Ee|0):(O|0)==11?(de=Be,D|0):0}function Yo(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0;we=de,de=de+16|0,Ae=we;e:do if((m|0)>0|(m|0)==0&A>>>0>0){for(H=0,I=0,S=0,J=0;;){if(O=d+(H<<3)|0,D=f[O>>2]|0,O=f[O+4>>2]|0,!((D|0)==0&(O|0)==0)&&(O=(_l(D,O,_,Ae)|0)==0,D=Ae,I=P(f[D>>2]|0,f[D+4>>2]|0,I|0,S|0)|0,S=ge()|0,!O)){S=12;break}if(H=P(H|0,J|0,1,0)|0,J=ge()|0,!((J|0)<(m|0)|(J|0)==(m|0)&H>>>0<A>>>0))break e}return de=we,S|0}else I=0,S=0;while(0);return f[x>>2]=I,f[x+4>>2]=S,x=0,de=we,x|0}function yl(d,A){return d=d|0,A=A|0,A=le(d|0,A|0,52)|0,ge()|0,A&1|0}function Fi(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;if(x=le(d|0,A|0,52)|0,ge()|0,x=x&15,!x)return x=0,x|0;for(_=1;;){if(m=le(d|0,A|0,(15-_|0)*3|0)|0,ge()|0,m=m&7,m|0){_=5;break}if(_>>>0<x>>>0)_=_+1|0;else{m=0,_=5;break}}return(_|0)==5?m|0:0}function vc(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0,O=0;if(O=le(d|0,A|0,52)|0,ge()|0,O=O&15,!O)return D=A,O=d,Ut(D|0),O|0;for(D=1,m=0;;){S=(15-D|0)*3|0,_=ye(7,0,S|0)|0,x=ge()|0,I=le(d|0,A|0,S|0)|0,ge()|0,S=ye(Zo(I&7)|0,0,S|0)|0,I=ge()|0,d=S|d&~_,A=I|A&~x;e:do if(!m)if((S&_|0)==0&(I&x|0)==0)m=0;else if(_=le(d|0,A|0,52)|0,ge()|0,_=_&15,!_)m=1;else{m=1;t:for(;;){switch(I=le(d|0,A|0,(15-m|0)*3|0)|0,ge()|0,I&7){case 1:break t;case 0:break;default:{m=1;break e}}if(m>>>0<_>>>0)m=m+1|0;else{m=1;break e}}for(m=1;;)if(I=(15-m|0)*3|0,x=le(d|0,A|0,I|0)|0,ge()|0,S=ye(7,0,I|0)|0,A=A&~(ge()|0),I=ye(Zo(x&7)|0,0,I|0)|0,d=d&~S|I,A=A|(ge()|0),m>>>0<_>>>0)m=m+1|0;else{m=1;break}}while(0);if(D>>>0<O>>>0)D=D+1|0;else break}return Ut(A|0),d|0}function Ls(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0;if(_=le(d|0,A|0,52)|0,ge()|0,_=_&15,!_)return m=A,_=d,Ut(m|0),_|0;for(m=1;S=(15-m|0)*3|0,I=le(d|0,A|0,S|0)|0,ge()|0,x=ye(7,0,S|0)|0,A=A&~(ge()|0),S=ye(Zo(I&7)|0,0,S|0)|0,d=S|d&~x,A=ge()|0|A,m>>>0<_>>>0;)m=m+1|0;return Ut(A|0),d|0}function Wu(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0,O=0;if(O=le(d|0,A|0,52)|0,ge()|0,O=O&15,!O)return D=A,O=d,Ut(D|0),O|0;for(D=1,m=0;;){S=(15-D|0)*3|0,_=ye(7,0,S|0)|0,x=ge()|0,I=le(d|0,A|0,S|0)|0,ge()|0,S=ye(Eo(I&7)|0,0,S|0)|0,I=ge()|0,d=S|d&~_,A=I|A&~x;e:do if(!m)if((S&_|0)==0&(I&x|0)==0)m=0;else if(_=le(d|0,A|0,52)|0,ge()|0,_=_&15,!_)m=1;else{m=1;t:for(;;){switch(I=le(d|0,A|0,(15-m|0)*3|0)|0,ge()|0,I&7){case 1:break t;case 0:break;default:{m=1;break e}}if(m>>>0<_>>>0)m=m+1|0;else{m=1;break e}}for(m=1;;)if(x=(15-m|0)*3|0,S=ye(7,0,x|0)|0,I=A&~(ge()|0),A=le(d|0,A|0,x|0)|0,ge()|0,A=ye(Eo(A&7)|0,0,x|0)|0,d=d&~S|A,A=I|(ge()|0),m>>>0<_>>>0)m=m+1|0;else{m=1;break}}while(0);if(D>>>0<O>>>0)D=D+1|0;else break}return Ut(A|0),d|0}function x0(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0;if(_=le(d|0,A|0,52)|0,ge()|0,_=_&15,!_)return m=A,_=d,Ut(m|0),_|0;for(m=1;I=(15-m|0)*3|0,S=ye(7,0,I|0)|0,x=A&~(ge()|0),A=le(d|0,A|0,I|0)|0,ge()|0,A=ye(Eo(A&7)|0,0,I|0)|0,d=A|d&~S,A=ge()|0|x,m>>>0<_>>>0;)m=m+1|0;return Ut(A|0),d|0}function vl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0;if(O=de,de=de+64|0,D=O+40|0,_=O+24|0,x=O+12|0,S=O,ye(A|0,0,52)|0,m=ge()|0|134225919,!A)return(f[d+4>>2]|0)>2||(f[d+8>>2]|0)>2||(f[d+12>>2]|0)>2?(I=0,D=0,Ut(I|0),de=O,D|0):(ye(f0(d)|0,0,45)|0,I=ge()|0|m,D=-1,Ut(I|0),de=O,D|0);if(f[D>>2]=f[d>>2],f[D+4>>2]=f[d+4>>2],f[D+8>>2]=f[d+8>>2],f[D+12>>2]=f[d+12>>2],I=D+4|0,(A|0)>0)for(d=-1;f[_>>2]=f[I>>2],f[_+4>>2]=f[I+4>>2],f[_+8>>2]=f[I+8>>2],A&1?(mc(I),f[x>>2]=f[I>>2],f[x+4>>2]=f[I+4>>2],f[x+8>>2]=f[I+8>>2],hl(x)):(ul(I),f[x>>2]=f[I>>2],f[x+4>>2]=f[I+4>>2],f[x+8>>2]=f[I+8>>2],bo(x)),Sa(_,x,S),oi(S),J=(15-A|0)*3|0,H=ye(7,0,J|0)|0,m=m&~(ge()|0),J=ye(Ca(S)|0,0,J|0)|0,d=J|d&~H,m=ge()|0|m,(A|0)>1;)A=A+-1|0;else d=-1;e:do if((f[I>>2]|0)<=2&&(f[D+8>>2]|0)<=2&&(f[D+12>>2]|0)<=2){if(_=f0(D)|0,A=ye(_|0,0,45)|0,A=A|d,d=ge()|0|m&-1040385,S=A0(D)|0,!(zn(_)|0)){if((S|0)<=0)break;for(x=0;;){if(_=le(A|0,d|0,52)|0,ge()|0,_=_&15,_)for(m=1;J=(15-m|0)*3|0,D=le(A|0,d|0,J|0)|0,ge()|0,H=ye(7,0,J|0)|0,d=d&~(ge()|0),J=ye(Zo(D&7)|0,0,J|0)|0,A=A&~H|J,d=d|(ge()|0),m>>>0<_>>>0;)m=m+1|0;if(x=x+1|0,(x|0)==(S|0))break e}}x=le(A|0,d|0,52)|0,ge()|0,x=x&15;t:do if(x){m=1;n:for(;;){switch(J=le(A|0,d|0,(15-m|0)*3|0)|0,ge()|0,J&7){case 1:break n;case 0:break;default:break t}if(m>>>0<x>>>0)m=m+1|0;else break t}if(Lu(_,f[D>>2]|0)|0)for(m=1;D=(15-m|0)*3|0,H=ye(7,0,D|0)|0,J=d&~(ge()|0),d=le(A|0,d|0,D|0)|0,ge()|0,d=ye(Eo(d&7)|0,0,D|0)|0,A=A&~H|d,d=J|(ge()|0),m>>>0<x>>>0;)m=m+1|0;else for(m=1;J=(15-m|0)*3|0,D=le(A|0,d|0,J|0)|0,ge()|0,H=ye(7,0,J|0)|0,d=d&~(ge()|0),J=ye(Zo(D&7)|0,0,J|0)|0,A=A&~H|J,d=d|(ge()|0),m>>>0<x>>>0;)m=m+1|0}while(0);if((S|0)>0){m=0;do A=vc(A,d)|0,d=ge()|0,m=m+1|0;while((m|0)!=(S|0))}}else A=0,d=0;while(0);return H=d,J=A,Ut(H|0),de=O,J|0}function br(d){return d=d|0,(d|0)%2|0|0}function xl(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;return x=de,de=de+16|0,_=x,A>>>0>15?(_=4,de=x,_|0):(f[d+4>>2]&2146435072|0)==2146435072||(f[d+8+4>>2]&2146435072|0)==2146435072?(_=3,de=x,_|0):(Ln(d,A,_),A=vl(_,A)|0,_=ge()|0,f[m>>2]=A,f[m+4>>2]=_,(A|0)==0&(_|0)==0&&en(23313,22674,786,22697),_=0,de=x,_|0)}function Ko(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0;if(x=m+4|0,S=le(d|0,A|0,52)|0,ge()|0,S=S&15,I=le(d|0,A|0,45)|0,ge()|0,_=(S|0)==0,zn(I&127)|0){if(_)return I=1,I|0;_=1}else{if(_)return I=0,I|0;!(f[x>>2]|0)&&!(f[m+8>>2]|0)?_=(f[m+12>>2]|0)!=0&1:_=1}for(m=1;m&1?hl(x):bo(x),I=le(d|0,A|0,(15-m|0)*3|0)|0,ge()|0,qo(x,I&7),m>>>0<S>>>0;)m=m+1|0;return _|0}function ds(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0;if(J=de,de=de+16|0,O=J,H=le(d|0,A|0,45)|0,ge()|0,H=H&127,H>>>0>121)return f[m>>2]=0,f[m+4>>2]=0,f[m+8>>2]=0,f[m+12>>2]=0,H=5,de=J,H|0;e:do if(zn(H)|0&&(S=le(d|0,A|0,52)|0,ge()|0,S=S&15,(S|0)!=0)){_=1;t:for(;;){switch(D=le(d|0,A|0,(15-_|0)*3|0)|0,ge()|0,D&7){case 5:break t;case 0:break;default:{_=A;break e}}if(_>>>0<S>>>0)_=_+1|0;else{_=A;break e}}for(x=1,_=A;A=(15-x|0)*3|0,I=ye(7,0,A|0)|0,D=_&~(ge()|0),_=le(d|0,_|0,A|0)|0,ge()|0,_=ye(Eo(_&7)|0,0,A|0)|0,d=d&~I|_,_=D|(ge()|0),x>>>0<S>>>0;)x=x+1|0}else _=A;while(0);if(D=7696+(H*28|0)|0,f[m>>2]=f[D>>2],f[m+4>>2]=f[D+4>>2],f[m+8>>2]=f[D+8>>2],f[m+12>>2]=f[D+12>>2],!(Ko(d,_,m)|0))return H=0,de=J,H|0;if(I=m+4|0,f[O>>2]=f[I>>2],f[O+4>>2]=f[I+4>>2],f[O+8>>2]=f[I+8>>2],S=le(d|0,_|0,52)|0,ge()|0,D=S&15,S&1?(bo(I),S=D+1|0):S=D,!(zn(H)|0))_=0;else{e:do if(!D)_=0;else for(A=1;;){if(x=le(d|0,_|0,(15-A|0)*3|0)|0,ge()|0,x=x&7,x|0){_=x;break e}if(A>>>0<D>>>0)A=A+1|0;else{_=0;break}}while(0);_=(_|0)==4&1}if(!(Ia(m,S,_,0)|0))(S|0)!=(D|0)&&(f[I>>2]=f[O>>2],f[I+4>>2]=f[O+4>>2],f[I+8>>2]=f[O+8>>2]);else{if(zn(H)|0)do;while(Ia(m,S,0,0)|0);(S|0)!=(D|0)&&ul(I)}return H=0,de=J,H|0}function Qs(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;return S=de,de=de+16|0,_=S,x=ds(d,A,_)|0,x|0?(de=S,x|0):(x=le(d|0,A|0,52)|0,ge()|0,dl(_,x&15,m),x=0,de=S,x|0)}function La(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0;if(I=de,de=de+16|0,S=I,_=ds(d,A,S)|0,_|0)return S=_,de=I,S|0;_=le(d|0,A|0,45)|0,ge()|0,_=(zn(_&127)|0)==0,x=le(d|0,A|0,52)|0,ge()|0,x=x&15;e:do if(!_){if(x|0)for(_=1;;){if(D=ye(7,0,(15-_|0)*3|0)|0,!((D&d|0)==0&((ge()|0)&A|0)==0))break e;if(_>>>0<x>>>0)_=_+1|0;else break}return To(S,x,0,5,m),D=0,de=I,D|0}while(0);return _c(S,x,0,6,m),D=0,de=I,D|0}function wl(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if(x=le(d|0,A|0,45)|0,ge()|0,!(zn(x&127)|0))return x=2,f[m>>2]=x,0;if(x=le(d|0,A|0,52)|0,ge()|0,x=x&15,!x)return x=5,f[m>>2]=x,0;for(_=1;;){if(S=ye(7,0,(15-_|0)*3|0)|0,!((S&d|0)==0&((ge()|0)&A|0)==0)){_=2,d=6;break}if(_>>>0<x>>>0)_=_+1|0;else{_=5,d=6;break}}return(d|0)==6&&(f[m>>2]=_),0}function xc(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0;Ae=de,de=de+128|0,H=Ae+112|0,S=Ae+96|0,J=Ae,x=le(d|0,A|0,52)|0,ge()|0,D=x&15,f[H>>2]=D,I=le(d|0,A|0,45)|0,ge()|0,I=I&127;e:do if(zn(I)|0){if(D|0)for(_=1;;){if(O=ye(7,0,(15-_|0)*3|0)|0,!((O&d|0)==0&((ge()|0)&A|0)==0)){x=0;break e}if(_>>>0<D>>>0)_=_+1|0;else break}if(x&1)x=1;else return O=ye(D+1|0,0,52)|0,J=ge()|0|A&-15728641,H=ye(7,0,(14-D|0)*3|0)|0,J=xc((O|d)&~H,J&~(ge()|0),m)|0,de=Ae,J|0}else x=0;while(0);if(_=ds(d,A,S)|0,!_){x?(Vu(S,H,J),O=5):(pl(S,H,J),O=6);e:do if(zn(I)|0)if(!D)d=5;else for(_=1;;){if(I=ye(7,0,(15-_|0)*3|0)|0,!((I&d|0)==0&((ge()|0)&A|0)==0)){d=2;break e}if(_>>>0<D>>>0)_=_+1|0;else{d=5;break}}else d=2;while(0);je(m|0,-1,d<<2|0)|0;e:do if(x)for(S=0;;){if(I=J+(S<<4)|0,Gu(I,f[H>>2]|0)|0,I=f[I>>2]|0,D=f[m>>2]|0,(D|0)==-1|(D|0)==(I|0))_=m;else{x=0;do{if(x=x+1|0,x>>>0>=d>>>0){_=1;break e}_=m+(x<<2)|0,D=f[_>>2]|0}while(!((D|0)==-1|(D|0)==(I|0)))}if(f[_>>2]=I,S=S+1|0,S>>>0>=O>>>0){_=0;break}}else for(S=0;;){if(I=J+(S<<4)|0,Ia(I,f[H>>2]|0,0,1)|0,I=f[I>>2]|0,D=f[m>>2]|0,(D|0)==-1|(D|0)==(I|0))_=m;else{x=0;do{if(x=x+1|0,x>>>0>=d>>>0){_=1;break e}_=m+(x<<2)|0,D=f[_>>2]|0}while(!((D|0)==-1|(D|0)==(I|0)))}if(f[_>>2]=I,S=S+1|0,S>>>0>=O>>>0){_=0;break}}while(0)}return J=_,de=Ae,J|0}function $u(){return 12}function w0(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0,O=0;if(d>>>0>15)return D=4,D|0;if(ye(d|0,0,52)|0,D=ge()|0|134225919,!d){m=0,_=0;do zn(_)|0&&(ye(_|0,0,45)|0,I=D|(ge()|0),d=A+(m<<3)|0,f[d>>2]=-1,f[d+4>>2]=I,m=m+1|0),_=_+1|0;while((_|0)!=122);return m=0,m|0}m=0,I=0;do{if(zn(I)|0){for(ye(I|0,0,45)|0,_=1,x=-1,S=D|(ge()|0);O=ye(7,0,(15-_|0)*3|0)|0,x=x&~O,S=S&~(ge()|0),(_|0)!=(d|0);)_=_+1|0;O=A+(m<<3)|0,f[O>>2]=x,f[O+4>>2]=S,m=m+1|0}I=I+1|0}while((I|0)!=122);return m=0,m|0}function Da(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0;if(He=de,de=de+16|0,Je=He,Ye=le(d|0,A|0,52)|0,ge()|0,Ye=Ye&15,m>>>0>15)return Ye=4,de=He,Ye|0;if((Ye|0)<(m|0))return Ye=12,de=He,Ye|0;if((Ye|0)!=(m|0))if(S=ye(m|0,0,52)|0,S=S|d,D=ge()|0|A&-15728641,(Ye|0)>(m|0)){O=m;do Be=ye(7,0,(14-O|0)*3|0)|0,O=O+1|0,S=Be|S,D=ge()|0|D;while((O|0)<(Ye|0));Be=S}else Be=S;else Be=d,D=A;Ee=le(Be|0,D|0,45)|0,ge()|0;e:do if(zn(Ee&127)|0){if(O=le(Be|0,D|0,52)|0,ge()|0,O=O&15,O|0)for(S=1;;){if(Ee=ye(7,0,(15-S|0)*3|0)|0,!((Ee&Be|0)==0&((ge()|0)&D|0)==0)){H=33;break e}if(S>>>0<O>>>0)S=S+1|0;else break}if(Ee=_,f[Ee>>2]=0,f[Ee+4>>2]=0,(Ye|0)>(m|0)){for(Ee=A&-15728641,Re=Ye;;){if(we=Re,Re=Re+-1|0,Re>>>0>15|(Ye|0)<(Re|0)){H=19;break}if((Ye|0)!=(Re|0))if(S=ye(Re|0,0,52)|0,S=S|d,O=ge()|0|Ee,(Ye|0)<(we|0))Ae=S;else{H=Re;do Ae=ye(7,0,(14-H|0)*3|0)|0,H=H+1|0,S=Ae|S,O=ge()|0|O;while((H|0)<(Ye|0));Ae=S}else Ae=d,O=A;if(J=le(Ae|0,O|0,45)|0,ge()|0,!(zn(J&127)|0))S=0;else{J=le(Ae|0,O|0,52)|0,ge()|0,J=J&15;t:do if(!J)S=0;else for(H=1;;){if(S=le(Ae|0,O|0,(15-H|0)*3|0)|0,ge()|0,S=S&7,S|0)break t;if(H>>>0<J>>>0)H=H+1|0;else{S=0;break}}while(0);S=(S|0)==0&1}if(O=le(d|0,A|0,(15-we|0)*3|0)|0,ge()|0,O=O&7,(O|0)==7){x=5,H=42;break}if(S=(S|0)!=0,(O|0)==1&S){x=5,H=42;break}if(Ae=O+(((O|0)!=0&S)<<31>>31)|0,Ae|0&&(H=Ye-we|0,H=zs(7,0,H,((H|0)<0)<<31>>31)|0,J=ge()|0,S?(S=se(H|0,J|0,5,0)|0,S=P(S|0,ge()|0,-5,-1)|0,S=$(S|0,ge()|0,6,0)|0,S=P(S|0,ge()|0,1,0)|0,O=ge()|0):(S=H,O=J),we=Ae+-1|0,we=se(H|0,J|0,we|0,((we|0)<0)<<31>>31|0)|0,we=P(S|0,O|0,we|0,ge()|0)|0,Ae=ge()|0,J=_,J=P(we|0,Ae|0,f[J>>2]|0,f[J+4>>2]|0)|0,Ae=ge()|0,we=_,f[we>>2]=J,f[we+4>>2]=Ae),(Re|0)<=(m|0)){H=37;break}}if((H|0)==19)en(23313,22674,1099,22710);else if((H|0)==37){I=_,x=f[I+4>>2]|0,I=f[I>>2]|0;break}else if((H|0)==42)return de=He,x|0}else x=0,I=0}else H=33;while(0);e:do if((H|0)==33)if(Ee=_,f[Ee>>2]=0,f[Ee+4>>2]=0,(Ye|0)>(m|0)){for(S=Ye;;){if(x=le(d|0,A|0,(15-S|0)*3|0)|0,ge()|0,x=x&7,(x|0)==7){x=5;break}if(I=Ye-S|0,I=zs(7,0,I,((I|0)<0)<<31>>31)|0,x=se(I|0,ge()|0,x|0,0)|0,I=ge()|0,Ee=_,I=P(f[Ee>>2]|0,f[Ee+4>>2]|0,x|0,I|0)|0,x=ge()|0,Ee=_,f[Ee>>2]=I,f[Ee+4>>2]=x,S=S+-1|0,(S|0)<=(m|0))break e}return de=He,x|0}else x=0,I=0;while(0);return _l(Be,D,Ye,Je)|0&&en(23313,22674,1063,22725),Ye=Je,Je=f[Ye+4>>2]|0,((x|0)>-1|(x|0)==-1&I>>>0>4294967295)&((Je|0)>(x|0)|((Je|0)==(x|0)?(f[Ye>>2]|0)>>>0>I>>>0:0))?(Ye=0,de=He,Ye|0):(en(23313,22674,1139,22710),0)}function qu(d,A,m,_,x,S){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0;var I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0;if(Ae=de,de=de+16|0,I=Ae,x>>>0>15)return S=4,de=Ae,S|0;if(D=le(m|0,_|0,52)|0,ge()|0,D=D&15,(D|0)>(x|0))return S=12,de=Ae,S|0;if(_l(m,_,x,I)|0&&en(23313,22674,1063,22725),J=I,H=f[J+4>>2]|0,!(((A|0)>-1|(A|0)==-1&d>>>0>4294967295)&((H|0)>(A|0)|((H|0)==(A|0)?(f[J>>2]|0)>>>0>d>>>0:0))))return S=2,de=Ae,S|0;J=x-D|0,x=ye(x|0,0,52)|0,O=ge()|0|_&-15728641,H=S,f[H>>2]=x|m,f[H+4>>2]=O,H=le(m|0,_|0,45)|0,ge()|0;e:do if(zn(H&127)|0){if(D|0)for(I=1;;){if(H=ye(7,0,(15-I|0)*3|0)|0,!((H&m|0)==0&((ge()|0)&_|0)==0))break e;if(I>>>0<D>>>0)I=I+1|0;else break}if((J|0)<1)return S=0,de=Ae,S|0;for(H=D^15,_=-1,O=1,I=1;;){D=J-O|0,D=zs(7,0,D,((D|0)<0)<<31>>31)|0,m=ge()|0;do if(I)if(I=se(D|0,m|0,5,0)|0,I=P(I|0,ge()|0,-5,-1)|0,I=$(I|0,ge()|0,6,0)|0,x=ge()|0,(A|0)>(x|0)|(A|0)==(x|0)&d>>>0>I>>>0){A=P(d|0,A|0,-1,-1)|0,A=z(A|0,ge()|0,I|0,x|0)|0,I=ge()|0,we=S,Ee=f[we>>2]|0,we=f[we+4>>2]|0,Be=(H+_|0)*3|0,Re=ye(7,0,Be|0)|0,we=we&~(ge()|0),_=$(A|0,I|0,D|0,m|0)|0,d=ge()|0,x=P(_|0,d|0,2,0)|0,Be=ye(x|0,ge()|0,Be|0)|0,we=ge()|0|we,x=S,f[x>>2]=Be|Ee&~Re,f[x+4>>2]=we,d=se(_|0,d|0,D|0,m|0)|0,d=z(A|0,I|0,d|0,ge()|0)|0,I=0,A=ge()|0;break}else{Be=S,Re=f[Be>>2]|0,Be=f[Be+4>>2]|0,Ee=ye(7,0,(H+_|0)*3|0)|0,Be=Be&~(ge()|0),I=S,f[I>>2]=Re&~Ee,f[I+4>>2]=Be,I=1;break}else Re=S,x=f[Re>>2]|0,Re=f[Re+4>>2]|0,_=(H+_|0)*3|0,we=ye(7,0,_|0)|0,Re=Re&~(ge()|0),Be=$(d|0,A|0,D|0,m|0)|0,I=ge()|0,_=ye(Be|0,I|0,_|0)|0,Re=ge()|0|Re,Ee=S,f[Ee>>2]=_|x&~we,f[Ee+4>>2]=Re,I=se(Be|0,I|0,D|0,m|0)|0,d=z(d|0,A|0,I|0,ge()|0)|0,I=0,A=ge()|0;while(0);if((J|0)>(O|0))_=~O,O=O+1|0;else{A=0;break}}return de=Ae,A|0}while(0);if((J|0)<1)return Be=0,de=Ae,Be|0;for(x=D^15,I=1;;)if(Ee=J-I|0,Ee=zs(7,0,Ee,((Ee|0)<0)<<31>>31)|0,Be=ge()|0,O=S,m=f[O>>2]|0,O=f[O+4>>2]|0,D=(x-I|0)*3|0,_=ye(7,0,D|0)|0,O=O&~(ge()|0),we=$(d|0,A|0,Ee|0,Be|0)|0,Re=ge()|0,D=ye(we|0,Re|0,D|0)|0,O=ge()|0|O,H=S,f[H>>2]=D|m&~_,f[H+4>>2]=O,Be=se(we|0,Re|0,Ee|0,Be|0)|0,d=z(d|0,A|0,Be|0,ge()|0)|0,A=ge()|0,(J|0)<=(I|0)){A=0;break}else I=I+1|0;return de=Ae,A|0}function Ra(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0;x=le(A|0,m|0,52)|0,ge()|0,x=x&15,(A|0)==0&(m|0)==0|((_|0)>15|(x|0)>(_|0))?(_=-1,x=-1,A=0,m=0):(S=As(A,m,x+1|0,_)|0,m=(ge()|0)&-15728641,A=ye(_|0,0,52)|0,A=S|A,m=m|(ge()|0),S=(Jn(A,m)|0)==0,_=S?-1:_),S=d,f[S>>2]=A,f[S+4>>2]=m,f[d+8>>2]=x,f[d+12>>2]=_}function za(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0,O=0,H=0;if(m=d,A=f[m>>2]|0,m=f[m+4>>2]|0,!((A|0)==0&(m|0)==0)&&(_=le(A|0,m|0,52)|0,ge()|0,_=_&15,D=ye(1,0,(_^15)*3|0)|0,A=P(D|0,ge()|0,A|0,m|0)|0,m=ge()|0,D=d,f[D>>2]=A,f[D+4>>2]=m,D=d+8|0,I=f[D>>2]|0,!((_|0)<(I|0)))){for(O=d+12|0,S=_;;){if((S|0)==(I|0)){_=5;break}if(H=(S|0)==(f[O>>2]|0),x=(15-S|0)*3|0,_=le(A|0,m|0,x|0)|0,ge()|0,_=_&7,H&((_|0)==1&!0)){_=7;break}if(!((_|0)==7&!0)){_=10;break}if(H=ye(1,0,x|0)|0,A=P(A|0,m|0,H|0,ge()|0)|0,m=ge()|0,H=d,f[H>>2]=A,f[H+4>>2]=m,(S|0)>(I|0))S=S+-1|0;else{_=10;break}}if((_|0)==5){H=d,f[H>>2]=0,f[H+4>>2]=0,f[D>>2]=-1,f[O>>2]=-1;return}else if((_|0)==7){I=ye(1,0,x|0)|0,I=P(A|0,m|0,I|0,ge()|0)|0,D=ge()|0,H=d,f[H>>2]=I,f[H+4>>2]=D,f[O>>2]=S+-1;return}else if((_|0)==10)return}}function Ki(d){d=+d;var A=0;return A=d<0?d+6.283185307179586:d,+(d>=6.283185307179586?A+-6.283185307179586:A)}function Ds(d,A){return d=d|0,A=A|0,+Me(+(+W[d>>3]-+W[A>>3]))<17453292519943298e-27?(A=+Me(+(+W[d+8>>3]-+W[A+8>>3]))<17453292519943298e-27,A|0):(A=0,A|0)}function zr(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return x=+W[A>>3],_=+W[d>>3],S=+ct(+((x-_)*.5)),m=+ct(+((+W[A+8>>3]-+W[d+8>>3])*.5)),m=S*S+m*(+Ue(+x)*+Ue(+_)*m),+(+sn(+ +Ne(+m),+ +Ne(+(1-m)))*2)}function bl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return x=+W[A>>3],_=+W[d>>3],S=+ct(+((x-_)*.5)),m=+ct(+((+W[A+8>>3]-+W[d+8>>3])*.5)),m=S*S+m*(+Ue(+x)*+Ue(+_)*m),+(+sn(+ +Ne(+m),+ +Ne(+(1-m)))*2*6371.007180918475)}function So(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return x=+W[A>>3],_=+W[d>>3],S=+ct(+((x-_)*.5)),m=+ct(+((+W[A+8>>3]-+W[d+8>>3])*.5)),m=S*S+m*(+Ue(+x)*+Ue(+_)*m),+(+sn(+ +Ne(+m),+ +Ne(+(1-m)))*2*6371.007180918475*1e3)}function Zu(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0;return S=+W[A>>3],_=+Ue(+S),x=+W[A+8>>3]-+W[d+8>>3],I=_*+ct(+x),m=+W[d>>3],+ +sn(+I,+(+ct(+S)*+Ue(+m)-+Ue(+x)*(_*+ct(+m))))}function Ys(d,A,m,_){d=d|0,A=+A,m=+m,_=_|0;var x=0,S=0,I=0,D=0;if(m<1e-16){f[_>>2]=f[d>>2],f[_+4>>2]=f[d+4>>2],f[_+8>>2]=f[d+8>>2],f[_+12>>2]=f[d+12>>2];return}S=A<0?A+6.283185307179586:A,S=A>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)A=+W[d>>3]+m,W[_>>3]=A,x=_;else{if(x=+Me(+(S+-3.141592653589793))<1e-16,A=+W[d>>3],x){A=A-m,W[_>>3]=A,x=_;break}if(I=+Ue(+m),m=+ct(+m),A=I*+ct(+A)+ +Ue(+S)*(m*+Ue(+A)),A=A>1?1:A,A=+Zt(+(A<-1?-1:A)),W[_>>3]=A,+Me(+(A+-1.5707963267948966))<1e-16){W[_>>3]=1.5707963267948966,W[_+8>>3]=0;return}if(+Me(+(A+1.5707963267948966))<1e-16){W[_>>3]=-1.5707963267948966,W[_+8>>3]=0;return}if(D=+Ue(+A),S=m*+ct(+S)/D,m=+W[d>>3],A=(I-+ct(+A)*+ct(+m))/+Ue(+m)/D,I=S>1?1:S,A=A>1?1:A,A=+W[d+8>>3]+ +sn(+(I<-1?-1:I),+(A<-1?-1:A)),A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);W[_+8>>3]=A;return}while(0);if(+Me(+(A+-1.5707963267948966))<1e-16){W[x>>3]=1.5707963267948966,W[_+8>>3]=0;return}if(+Me(+(A+1.5707963267948966))<1e-16){W[x>>3]=-1.5707963267948966,W[_+8>>3]=0;return}if(A=+W[d+8>>3],A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);W[_+8>>3]=A}function El(d,A){return d=d|0,A=A|0,d>>>0>15?(A=4,A|0):(W[A>>3]=+W[20528+(d<<3)>>3],A=0,A|0)}function wc(d,A){return d=d|0,A=A|0,d>>>0>15?(A=4,A|0):(W[A>>3]=+W[20656+(d<<3)>>3],A=0,A|0)}function V1(d,A){return d=d|0,A=A|0,d>>>0>15?(A=4,A|0):(W[A>>3]=+W[20784+(d<<3)>>3],A=0,A|0)}function G1(d,A){return d=d|0,A=A|0,d>>>0>15?(A=4,A|0):(W[A>>3]=+W[20912+(d<<3)>>3],A=0,A|0)}function Ba(d,A){d=d|0,A=A|0;var m=0;return d>>>0>15?(A=4,A|0):(m=zs(7,0,d,((d|0)<0)<<31>>31)|0,m=se(m|0,ge()|0,120,0)|0,d=ge()|0,f[A>>2]=m|2,f[A+4>>2]=d,A=0,A|0)}function Oa(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0;return we=+W[A>>3],J=+W[d>>3],O=+ct(+((we-J)*.5)),S=+W[A+8>>3],H=+W[d+8>>3],I=+ct(+((S-H)*.5)),D=+Ue(+J),Ae=+Ue(+we),I=O*O+I*(Ae*D*I),I=+sn(+ +Ne(+I),+ +Ne(+(1-I)))*2,O=+W[m>>3],we=+ct(+((O-we)*.5)),_=+W[m+8>>3],S=+ct(+((_-S)*.5)),x=+Ue(+O),S=we*we+S*(Ae*x*S),S=+sn(+ +Ne(+S),+ +Ne(+(1-S)))*2,O=+ct(+((J-O)*.5)),_=+ct(+((H-_)*.5)),_=O*O+_*(D*x*_),_=+sn(+ +Ne(+_),+ +Ne(+(1-_)))*2,x=(I+S+_)*.5,+(+Vt(+ +Ne(+(+It(+(x*.5))*+It(+((x-I)*.5))*+It(+((x-S)*.5))*+It(+((x-_)*.5)))))*4)}function ps(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0;if(D=de,de=de+192|0,S=D+168|0,I=D,x=Qs(d,A,S)|0,x|0)return m=x,de=D,m|0;if(La(d,A,I)|0&&en(23313,22742,386,22751),A=f[I>>2]|0,(A|0)>0){if(_=+Oa(I+8|0,I+8+(((A|0)!=1&1)<<4)|0,S)+0,(A|0)!=1){d=1;do x=d,d=d+1|0,_=_+ +Oa(I+8+(x<<4)|0,I+8+(((d|0)%(A|0)|0)<<4)|0,S);while((d|0)<(A|0))}}else _=0;return W[m>>3]=_,m=0,de=D,m|0}function zt(d,A,m){return d=d|0,A=A|0,m=m|0,d=ps(d,A,m)|0,d|0||(W[m>>3]=+W[m>>3]*6371.007180918475*6371.007180918475),d|0}function Xu(d,A,m){return d=d|0,A=A|0,m=m|0,d=ps(d,A,m)|0,d|0||(W[m>>3]=+W[m>>3]*6371.007180918475*6371.007180918475*1e3*1e3),d|0}function Jo(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0;if(D=de,de=de+176|0,I=D,d=Al(d,A,I)|0,d|0)return I=d,de=D,I|0;if(W[m>>3]=0,d=f[I>>2]|0,(d|0)<=1)return I=0,de=D,I|0;A=d+-1|0,d=0,_=+W[I+8>>3],x=+W[I+16>>3],S=0;do d=d+1|0,H=_,_=+W[I+8+(d<<4)>>3],J=+ct(+((_-H)*.5)),O=x,x=+W[I+8+(d<<4)+8>>3],O=+ct(+((x-O)*.5)),O=J*J+O*(+Ue(+_)*+Ue(+H)*O),S=S+ +sn(+ +Ne(+O),+ +Ne(+(1-O)))*2;while((d|0)<(A|0));return W[m>>3]=S,I=0,de=D,I|0}function Co(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0;if(D=de,de=de+176|0,I=D,d=Al(d,A,I)|0,d|0)return I=d,S=+W[m>>3],S=S*6371.007180918475,W[m>>3]=S,de=D,I|0;if(W[m>>3]=0,d=f[I>>2]|0,(d|0)<=1)return I=0,S=0,S=S*6371.007180918475,W[m>>3]=S,de=D,I|0;A=d+-1|0,d=0,_=+W[I+8>>3],x=+W[I+16>>3],S=0;do d=d+1|0,H=_,_=+W[I+8+(d<<4)>>3],J=+ct(+((_-H)*.5)),O=x,x=+W[I+8+(d<<4)+8>>3],O=+ct(+((x-O)*.5)),O=J*J+O*(+Ue(+H)*+Ue(+_)*O),S=S+ +sn(+ +Ne(+O),+ +Ne(+(1-O)))*2;while((d|0)!=(A|0));return W[m>>3]=S,I=0,J=S,J=J*6371.007180918475,W[m>>3]=J,de=D,I|0}function bc(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0;if(D=de,de=de+176|0,I=D,d=Al(d,A,I)|0,d|0)return I=d,S=+W[m>>3],S=S*6371.007180918475,S=S*1e3,W[m>>3]=S,de=D,I|0;if(W[m>>3]=0,d=f[I>>2]|0,(d|0)<=1)return I=0,S=0,S=S*6371.007180918475,S=S*1e3,W[m>>3]=S,de=D,I|0;A=d+-1|0,d=0,_=+W[I+8>>3],x=+W[I+16>>3],S=0;do d=d+1|0,H=_,_=+W[I+8+(d<<4)>>3],J=+ct(+((_-H)*.5)),O=x,x=+W[I+8+(d<<4)+8>>3],O=+ct(+((x-O)*.5)),O=J*J+O*(+Ue(+H)*+Ue(+_)*O),S=S+ +sn(+ +Ne(+O),+ +Ne(+(1-O)))*2;while((d|0)!=(A|0));return W[m>>3]=S,I=0,J=S,J=J*6371.007180918475,J=J*1e3,W[m>>3]=J,de=D,I|0}function kt(d){d=d|0;var A=0,m=0,_=0;return A=E(1,12)|0,A||en(22832,22787,49,22845),m=d+4|0,_=f[m>>2]|0,_|0?(_=_+8|0,f[_>>2]=A,f[m>>2]=A,A|0):(f[d>>2]|0&&en(22862,22787,61,22885),_=d,f[_>>2]=A,f[m>>2]=A,A|0)}function b0(d,A){d=d|0,A=A|0;var m=0,_=0;return _=p(24)|0,_||en(22899,22787,78,22913),f[_>>2]=f[A>>2],f[_+4>>2]=f[A+4>>2],f[_+8>>2]=f[A+8>>2],f[_+12>>2]=f[A+12>>2],f[_+16>>2]=0,A=d+4|0,m=f[A>>2]|0,m|0?(f[m+16>>2]=_,f[A>>2]=_,_|0):(f[d>>2]|0&&en(22928,22787,82,22913),f[d>>2]=_,f[A>>2]=_,_|0)}function Qu(d){d=d|0;var A=0,m=0,_=0,x=0;if(d)for(_=1;;){if(A=f[d>>2]|0,A|0)do{if(m=f[A>>2]|0,m|0)do x=m,m=f[m+16>>2]|0,v(x);while(m|0);x=A,A=f[A+8>>2]|0,v(x)}while(A|0);if(A=d,d=f[d+8>>2]|0,_||v(A),d)_=0;else break}}function Ec(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0,bt=0,rt=0,ft=0,dn=0,un=0,rn=0,on=0,hn=0,gn=0,jn=0,pn=0;if(x=d+8|0,f[x>>2]|0)return pn=1,pn|0;if(_=f[d>>2]|0,!_)return pn=0,pn|0;A=_,m=0;do m=m+1|0,A=f[A+8>>2]|0;while(A|0);if(m>>>0<2)return pn=0,pn|0;gn=p(m<<2)|0,gn||en(22948,22787,317,22967),hn=p(m<<5)|0,hn||en(22989,22787,321,22967),f[d>>2]=0,bt=d+4|0,f[bt>>2]=0,f[x>>2]=0,m=0,on=0,Pt=0,Ae=0;e:for(;;){if(J=f[_>>2]|0,J){S=0,I=J;do{if(O=+W[I+8>>3],A=I,I=f[I+16>>2]|0,H=(I|0)==0,x=H?J:I,D=+W[x+8>>3],+Me(+(O-D))>3.141592653589793){pn=14;break}S=S+(D-O)*(+W[A>>3]+ +W[x>>3])}while(!H);if((pn|0)==14){pn=0,S=0,A=J;do Oe=+W[A+8>>3],rn=A+16|0,un=f[rn>>2]|0,un=un|0?un:J,We=+W[un+8>>3],S=S+(+W[A>>3]+ +W[un>>3])*((We<0?We+6.283185307179586:We)-(Oe<0?Oe+6.283185307179586:Oe)),A=f[(A|0?rn:_)>>2]|0;while(A|0)}S>0?(f[gn+(on<<2)>>2]=_,on=on+1|0,x=Pt,A=Ae):pn=19}else pn=19;if((pn|0)==19){pn=0;do if(m){if(A=m+8|0,f[A>>2]|0){pn=21;break e}if(m=E(1,12)|0,!m){pn=23;break e}f[A>>2]=m,x=m+4|0,I=m,A=Ae}else if(Ae){x=bt,I=Ae+8|0,A=_,m=d;break}else if(f[d>>2]|0){pn=27;break e}else{x=bt,I=d,A=_,m=d;break}while(0);if(f[I>>2]=_,f[x>>2]=_,I=hn+(Pt<<5)|0,H=f[_>>2]|0,H){for(J=hn+(Pt<<5)+8|0,W[J>>3]=17976931348623157e292,Ae=hn+(Pt<<5)+24|0,W[Ae>>3]=17976931348623157e292,W[I>>3]=-17976931348623157e292,we=hn+(Pt<<5)+16|0,W[we>>3]=-17976931348623157e292,Ye=17976931348623157e292,He=-17976931348623157e292,x=0,Re=H,O=17976931348623157e292,Be=17976931348623157e292,Je=-17976931348623157e292,D=-17976931348623157e292;S=+W[Re>>3],Oe=+W[Re+8>>3],Re=f[Re+16>>2]|0,Ee=(Re|0)==0,We=+W[(Ee?H:Re)+8>>3],S<O&&(W[J>>3]=S,O=S),Oe<Be&&(W[Ae>>3]=Oe,Be=Oe),S>Je?W[I>>3]=S:S=Je,Oe>D&&(W[we>>3]=Oe,D=Oe),Ye=Oe>0&Oe<Ye?Oe:Ye,He=Oe<0&Oe>He?Oe:He,x=x|+Me(+(Oe-We))>3.141592653589793,!Ee;)Je=S;x&&(W[we>>3]=He,W[Ae>>3]=Ye)}else f[I>>2]=0,f[I+4>>2]=0,f[I+8>>2]=0,f[I+12>>2]=0,f[I+16>>2]=0,f[I+20>>2]=0,f[I+24>>2]=0,f[I+28>>2]=0;x=Pt+1|0}if(rn=_+8|0,_=f[rn>>2]|0,f[rn>>2]=0,_)Pt=x,Ae=A;else{pn=45;break}}if((pn|0)==21)en(22765,22787,35,22799);else if((pn|0)==23)en(22819,22787,37,22799);else if((pn|0)==27)en(22862,22787,61,22885);else if((pn|0)==45){e:do if((on|0)>0){for(rn=(x|0)==0,dn=x<<2,un=(d|0)==0,ft=0,A=0;;){if(rt=f[gn+(ft<<2)>>2]|0,rn)pn=73;else{if(Pt=p(dn)|0,!Pt){pn=50;break}if(bt=p(dn)|0,!bt){pn=52;break}t:do if(un)m=0;else{for(x=0,m=0,I=d;_=hn+(x<<5)|0,E0(f[I>>2]|0,_,f[rt>>2]|0)|0?(f[Pt+(m<<2)>>2]=I,f[bt+(m<<2)>>2]=_,Ee=m+1|0):Ee=m,I=f[I+8>>2]|0,I;)x=x+1|0,m=Ee;if((Ee|0)>0)if(_=f[Pt>>2]|0,(Ee|0)==1)m=_;else for(we=0,Re=-1,m=_,Ae=_;;){for(H=f[Ae>>2]|0,_=0,I=0;x=f[f[Pt+(I<<2)>>2]>>2]|0,(x|0)==(H|0)?J=_:J=_+((E0(x,f[bt+(I<<2)>>2]|0,f[H>>2]|0)|0)&1)|0,I=I+1|0,(I|0)!=(Ee|0);)_=J;if(x=(J|0)>(Re|0),m=x?Ae:m,_=we+1|0,(_|0)==(Ee|0))break t;we=_,Re=x?J:Re,Ae=f[Pt+(_<<2)>>2]|0}else m=0}while(0);if(v(Pt),v(bt),m){if(x=m+4|0,_=f[x>>2]|0,_)m=_+8|0;else if(f[m>>2]|0){pn=70;break}f[m>>2]=rt,f[x>>2]=rt}else pn=73}if((pn|0)==73){if(pn=0,A=f[rt>>2]|0,A|0)do bt=A,A=f[A+16>>2]|0,v(bt);while(A|0);v(rt),A=1}if(ft=ft+1|0,(ft|0)>=(on|0)){jn=A;break e}}(pn|0)==50?en(23004,22787,249,23023):(pn|0)==52?en(23042,22787,252,23023):(pn|0)==70&&en(22862,22787,61,22885)}else jn=0;while(0);return v(gn),v(hn),pn=jn,pn|0}return 0}function E0(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0;if(!(dc(A,m)|0)||(A=Gn(A)|0,_=+W[m>>3],x=+W[m+8>>3],x=A&x<0?x+6.283185307179586:x,d=f[d>>2]|0,!d))return d=0,d|0;if(A){A=0,H=x,m=d;e:for(;;){for(;I=+W[m>>3],x=+W[m+8>>3],m=m+16|0,J=f[m>>2]|0,J=J|0?J:d,S=+W[J>>3],D=+W[J+8>>3],I>S?(O=I,I=D):(O=S,S=I,I=x,x=D),_=_==S|_==O?_+2220446049250313e-31:_,!!(_<S|_>O);)if(m=f[m>>2]|0,!m){m=22;break e}if(D=I<0?I+6.283185307179586:I,I=x<0?x+6.283185307179586:x,H=D==H|I==H?H+-2220446049250313e-31:H,O=D+(I-D)*((_-S)/(O-S)),(O<0?O+6.283185307179586:O)>H&&(A=A^1),m=f[m>>2]|0,!m){m=22;break}}if((m|0)==22)return A|0}else{A=0,H=x,m=d;e:for(;;){for(;I=+W[m>>3],x=+W[m+8>>3],m=m+16|0,J=f[m>>2]|0,J=J|0?J:d,S=+W[J>>3],D=+W[J+8>>3],I>S?(O=I,I=D):(O=S,S=I,I=x,x=D),_=_==S|_==O?_+2220446049250313e-31:_,!!(_<S|_>O);)if(m=f[m>>2]|0,!m){m=22;break e}if(H=I==H|x==H?H+-2220446049250313e-31:H,I+(x-I)*((_-S)/(O-S))>H&&(A=A^1),m=f[m>>2]|0,!m){m=22;break}}if((m|0)==22)return A|0}return 0}function Rs(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0;if(He=de,de=de+32|0,Ye=He+16|0,Je=He,S=le(d|0,A|0,52)|0,ge()|0,S=S&15,Re=le(m|0,_|0,52)|0,ge()|0,(S|0)!=(Re&15|0))return Ye=12,de=He,Ye|0;if(H=le(d|0,A|0,45)|0,ge()|0,H=H&127,J=le(m|0,_|0,45)|0,ge()|0,J=J&127,H>>>0>121|J>>>0>121)return Ye=5,de=He,Ye|0;if(Re=(H|0)!=(J|0),Re){if(D=al(H,J)|0,(D|0)==7)return Ye=1,de=He,Ye|0;O=al(J,H)|0,(O|0)==7?en(23066,23090,161,23100):(Ee=D,I=O)}else Ee=0,I=0;Ae=zn(H)|0,we=zn(J)|0,f[Ye>>2]=0,f[Ye+4>>2]=0,f[Ye+8>>2]=0,f[Ye+12>>2]=0;do if(Ee){if(J=f[4272+(H*28|0)+(Ee<<2)>>2]|0,D=(J|0)>0,we)if(D){H=0,O=m,D=_;do O=Wu(O,D)|0,D=ge()|0,I=Eo(I)|0,(I|0)==1&&(I=Eo(1)|0),H=H+1|0;while((H|0)!=(J|0));J=I,H=O,O=D}else J=I,H=m,O=_;else if(D){H=0,O=m,D=_;do O=x0(O,D)|0,D=ge()|0,I=Eo(I)|0,H=H+1|0;while((H|0)!=(J|0));J=I,H=O,O=D}else J=I,H=m,O=_;if(Ko(H,O,Ye)|0,Re||en(23115,23090,191,23100),D=(Ae|0)!=0,I=(we|0)!=0,D&I&&en(23142,23090,192,23100),D){if(I=Fi(d,A)|0,(I|0)==7){S=5;break}if(oe[21872+(I*7|0)+Ee>>0]|0){S=1;break}O=f[21040+(I*28|0)+(Ee<<2)>>2]|0,H=O}else if(I){if(I=Fi(H,O)|0,(I|0)==7){S=5;break}if(oe[21872+(I*7|0)+J>>0]|0){S=1;break}H=0,O=f[21040+(J*28|0)+(I<<2)>>2]|0}else H=0,O=0;if((H|O|0)<0)S=5;else{if((O|0)>0){D=Ye+4|0,I=0;do m0(D),I=I+1|0;while((I|0)!=(O|0))}if(f[Je>>2]=0,f[Je+4>>2]=0,f[Je+8>>2]=0,qo(Je,Ee),S|0)for(;br(S)|0?hl(Je):bo(Je),(S|0)>1;)S=S+-1|0;if((H|0)>0){S=0;do m0(Je),S=S+1|0;while((S|0)!=(H|0))}Be=Ye+4|0,$i(Be,Je,Be),oi(Be),Be=51}}else if(Ko(m,_,Ye)|0,(Ae|0)!=0&(we|0)!=0)if((J|0)!=(H|0)&&en(23173,23090,261,23100),I=Fi(d,A)|0,S=Fi(m,_)|0,(I|0)==7|(S|0)==7)S=5;else if(oe[21872+(I*7|0)+S>>0]|0)S=1;else if(I=f[21040+(I*28|0)+(S<<2)>>2]|0,(I|0)>0){D=Ye+4|0,S=0;do m0(D),S=S+1|0;while((S|0)!=(I|0));Be=51}else Be=51;else Be=51;while(0);return(Be|0)==51&&(S=Ye+4|0,f[x>>2]=f[S>>2],f[x+4>>2]=f[S+4>>2],f[x+8>>2]=f[S+8>>2],S=0),Ye=S,de=He,Ye|0}function Tc(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0;if(Be=de,de=de+48|0,H=Be+36|0,I=Be+24|0,D=Be+12|0,O=Be,x=le(d|0,A|0,52)|0,ge()|0,x=x&15,we=le(d|0,A|0,45)|0,ge()|0,we=we&127,we>>>0>121)return _=5,de=Be,_|0;if(J=zn(we)|0,ye(x|0,0,52)|0,Je=ge()|0|134225919,S=_,f[S>>2]=-1,f[S+4>>2]=Je,!x)return x=Ca(m)|0,(x|0)==7||(x=ol(we,x)|0,(x|0)==127)?(Je=1,de=Be,Je|0):(Re=ye(x|0,0,45)|0,Ee=ge()|0,we=_,Ee=f[we+4>>2]&-1040385|Ee,Je=_,f[Je>>2]=f[we>>2]|Re,f[Je+4>>2]=Ee,Je=0,de=Be,Je|0);for(f[H>>2]=f[m>>2],f[H+4>>2]=f[m+4>>2],f[H+8>>2]=f[m+8>>2],m=x;;){if(S=m,m=m+-1|0,f[I>>2]=f[H>>2],f[I+4>>2]=f[H+4>>2],f[I+8>>2]=f[H+8>>2],br(S)|0){if(x=p0(H)|0,x|0){m=13;break}f[D>>2]=f[H>>2],f[D+4>>2]=f[H+4>>2],f[D+8>>2]=f[H+8>>2],hl(D)}else{if(x=pc(H)|0,x|0){m=13;break}f[D>>2]=f[H>>2],f[D+4>>2]=f[H+4>>2],f[D+8>>2]=f[H+8>>2],bo(D)}if(Sa(I,D,O),oi(O),x=_,He=f[x>>2]|0,x=f[x+4>>2]|0,We=(15-S|0)*3|0,Ye=ye(7,0,We|0)|0,x=x&~(ge()|0),We=ye(Ca(O)|0,0,We|0)|0,x=ge()|0|x,Je=_,f[Je>>2]=We|He&~Ye,f[Je+4>>2]=x,(S|0)<=1){m=14;break}}e:do if((m|0)!=13&&(m|0)==14)if((f[H>>2]|0)<=1&&(f[H+4>>2]|0)<=1&&(f[H+8>>2]|0)<=1){m=Ca(H)|0,x=ol(we,m)|0,(x|0)==127?O=0:O=zn(x)|0;t:do if(m){if(J){if(x=Fi(d,A)|0,(x|0)==7){x=5;break e}if(S=f[21248+(x*28|0)+(m<<2)>>2]|0,(S|0)>0){x=m,m=0;do x=Zo(x)|0,m=m+1|0;while((m|0)!=(S|0))}else x=m;if((x|0)==1){x=9;break e}m=ol(we,x)|0,(m|0)==127&&en(23200,23090,411,23230),zn(m)|0?en(23245,23090,412,23230):(Ee=m,Re=S,Ae=x)}else Ee=x,Re=0,Ae=m;if(D=f[4272+(we*28|0)+(Ae<<2)>>2]|0,(D|0)<=-1&&en(23276,23090,419,23230),!O){if((Re|0)<0){x=5;break e}if(Re|0){S=_,x=0,m=f[S>>2]|0,S=f[S+4>>2]|0;do m=Ls(m,S)|0,S=ge()|0,We=_,f[We>>2]=m,f[We+4>>2]=S,x=x+1|0;while((x|0)<(Re|0))}if((D|0)<=0){x=Ee,m=58;break}for(S=_,x=0,m=f[S>>2]|0,S=f[S+4>>2]|0;;)if(m=Ls(m,S)|0,S=ge()|0,We=_,f[We>>2]=m,f[We+4>>2]=S,x=x+1|0,(x|0)==(D|0)){x=Ee,m=58;break t}}if(I=al(Ee,we)|0,(I|0)==7&&en(23066,23090,428,23230),x=_,m=f[x>>2]|0,x=f[x+4>>2]|0,(D|0)>0){S=0;do m=Ls(m,x)|0,x=ge()|0,We=_,f[We>>2]=m,f[We+4>>2]=x,S=S+1|0;while((S|0)!=(D|0))}if(x=Fi(m,x)|0,(x|0)==7&&en(23313,23090,440,23230),m=h0(Ee)|0,m=f[(m?21664:21456)+(I*28|0)+(x<<2)>>2]|0,(m|0)<0&&en(23313,23090,454,23230),!m)x=Ee,m=58;else{I=_,x=0,S=f[I>>2]|0,I=f[I+4>>2]|0;do S=vc(S,I)|0,I=ge()|0,We=_,f[We>>2]=S,f[We+4>>2]=I,x=x+1|0;while((x|0)<(m|0));x=Ee,m=58}}else if((J|0)!=0&(O|0)!=0){if(m=Fi(d,A)|0,S=_,S=Fi(f[S>>2]|0,f[S+4>>2]|0)|0,(m|0)==7|(S|0)==7){x=5;break e}if(S=f[21248+(m*28|0)+(S<<2)>>2]|0,(S|0)<0){x=5;break e}if(!S)m=59;else{D=_,m=0,I=f[D>>2]|0,D=f[D+4>>2]|0;do I=Ls(I,D)|0,D=ge()|0,We=_,f[We>>2]=I,f[We+4>>2]=D,m=m+1|0;while((m|0)<(S|0));m=58}}else m=58;while(0);if((m|0)==58&&O&&(m=59),(m|0)==59&&(We=_,(Fi(f[We>>2]|0,f[We+4>>2]|0)|0)==1)){x=9;break}We=_,Ye=f[We>>2]|0,We=f[We+4>>2]&-1040385,He=ye(x|0,0,45)|0,We=We|(ge()|0),x=_,f[x>>2]=Ye|He,f[x+4>>2]=We,x=0}else x=1;while(0);return We=x,de=Be,We|0}function j1(d,A,m,_,x,S){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0;var I=0,D=0;return D=de,de=de+16|0,I=D,x?d=15:(d=Rs(d,A,m,_,I)|0,d||(g0(I,S),d=0)),de=D,d|0}function Yu(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0;return I=de,de=de+16|0,S=I,_?m=15:(m=gc(m,S)|0,m||(m=Tc(d,A,S,x)|0)),de=I,m|0}function Sc(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0;return O=de,de=de+32|0,I=O+12|0,D=O,S=Rs(d,A,d,A,I)|0,S|0?(D=S,de=O,D|0):(d=Rs(d,A,m,_,D)|0,d|0?(D=d,de=O,D|0):(I=fl(I,D)|0,D=x,f[D>>2]=I,f[D+4>>2]=((I|0)<0)<<31>>31,D=0,de=O,D|0))}function Cc(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0;return O=de,de=de+32|0,I=O+12|0,D=O,S=Rs(d,A,d,A,I)|0,!S&&(S=Rs(d,A,m,_,D)|0,!S)?(_=fl(I,D)|0,_=P(_|0,((_|0)<0)<<31>>31|0,1,0)|0,I=ge()|0,D=x,f[D>>2]=_,f[D+4>>2]=I,D=0,de=O,D|0):(D=S,de=O,D|0)}function Pc(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0,bt=0,rt=0,ft=0;if(rt=de,de=de+48|0,I=rt+24|0,D=rt+12|0,bt=rt,S=Rs(d,A,d,A,I)|0,!S&&(S=Rs(d,A,m,_,D)|0,!S)){Oe=fl(I,D)|0,Pt=((Oe|0)<0)<<31>>31,f[I>>2]=0,f[I+4>>2]=0,f[I+8>>2]=0,f[D>>2]=0,f[D+4>>2]=0,f[D+8>>2]=0,Rs(d,A,d,A,I)|0&&en(23313,23090,691,23299),Rs(d,A,m,_,D)|0&&en(23313,23090,696,23299),_0(I),_0(D),Oe?(Ae=f[I>>2]|0,Ee=+(Oe|0),Ye=I+4|0,we=f[Ye>>2]|0,He=I+8|0,Re=f[He>>2]|0,We=I,_=Ae,S=we,m=Re,Be=+((f[D>>2]|0)-Ae|0)/Ee,Je=+((f[D+4>>2]|0)-we|0)/Ee,Ee=+((f[D+8>>2]|0)-Re|0)/Ee):(S=I+4|0,m=I+8|0,Ye=S,He=m,We=I,_=f[I>>2]|0,S=f[S>>2]|0,m=f[m>>2]|0,Be=0,Je=0,Ee=0),f[bt>>2]=_,Re=bt+4|0,f[Re>>2]=S,we=bt+8|0,f[we>>2]=m;e:do if((Oe|0)<0)S=0;else for(J=0,Ae=0,S=_;;){H=+(Ae>>>0)+4294967296*+(J|0),ft=Be*H+ +(S|0),O=Je*H+ +(f[Ye>>2]|0),H=Ee*H+ +(f[He>>2]|0),m=~~+Se(+ft),I=~~+Se(+O),S=~~+Se(+H),ft=+Me(+(+(m|0)-ft)),O=+Me(+(+(I|0)-O)),H=+Me(+(+(S|0)-H));do if(ft>O&ft>H)m=0-(I+S)|0,_=I;else if(D=0-m|0,O>H){_=D-S|0;break}else{_=I,S=D-I|0;break}while(0);if(f[bt>>2]=m,f[Re>>2]=_,f[we>>2]=S,Pa(bt),S=Tc(d,A,bt,x+(Ae<<3)|0)|0,S|0)break e;if(!((J|0)<(Pt|0)|(J|0)==(Pt|0)&Ae>>>0<Oe>>>0)){S=0;break e}S=P(Ae|0,J|0,1,0)|0,D=ge()|0,J=D,Ae=S,S=f[We>>2]|0}while(0);return bt=S,de=rt,bt|0}return bt=S,de=rt,bt|0}function zs(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0;if((m|0)==0&(_|0)==0)return x=0,S=1,Ut(x|0),S|0;S=d,x=A,d=1,A=0;do I=(m&1|0)==0&!0,d=se((I?1:S)|0,(I?0:x)|0,d|0,A|0)|0,A=ge()|0,m=ve(m|0,_|0,1)|0,_=ge()|0,S=se(S|0,x|0,S|0,x|0)|0,x=ge()|0;while(!((m|0)==0&(_|0)==0));return Ut(A|0),d|0}function pr(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0;if(!(dc(A,m)|0)||(A=Gn(A)|0,_=+W[m>>3],x=+W[m+8>>3],x=A&x<0?x+6.283185307179586:x,we=f[d>>2]|0,(we|0)<=0))return we=0,we|0;if(Ae=f[d+4>>2]|0,A){A=0,J=x,m=-1,d=0;e:for(;;){for(H=d;I=+W[Ae+(H<<4)>>3],x=+W[Ae+(H<<4)+8>>3],d=(m+2|0)%(we|0)|0,S=+W[Ae+(d<<4)>>3],D=+W[Ae+(d<<4)+8>>3],I>S?(O=I,I=D):(O=S,S=I,I=x,x=D),_=_==S|_==O?_+2220446049250313e-31:_,!!(_<S|_>O);)if(m=H+1|0,(m|0)>=(we|0)){m=22;break e}else d=H,H=m,m=d;if(D=I<0?I+6.283185307179586:I,I=x<0?x+6.283185307179586:x,J=D==J|I==J?J+-2220446049250313e-31:J,O=D+(I-D)*((_-S)/(O-S)),(O<0?O+6.283185307179586:O)>J&&(A=A^1),d=H+1|0,(d|0)>=(we|0)){m=22;break}else m=H}if((m|0)==22)return A|0}else{A=0,J=x,m=-1,d=0;e:for(;;){for(H=d;I=+W[Ae+(H<<4)>>3],x=+W[Ae+(H<<4)+8>>3],d=(m+2|0)%(we|0)|0,S=+W[Ae+(d<<4)>>3],D=+W[Ae+(d<<4)+8>>3],I>S?(O=I,I=D):(O=S,S=I,I=x,x=D),_=_==S|_==O?_+2220446049250313e-31:_,!!(_<S|_>O);)if(m=H+1|0,(m|0)>=(we|0)){m=22;break e}else d=H,H=m,m=d;if(J=I==J|x==J?J+-2220446049250313e-31:J,I+(x-I)*((_-S)/(O-S))>J&&(A=A^1),d=H+1|0,(d|0)>=(we|0)){m=22;break}else m=H}if((m|0)==22)return A|0}return 0}function Ks(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0;if(Ee=f[d>>2]|0,!Ee){f[A>>2]=0,f[A+4>>2]=0,f[A+8>>2]=0,f[A+12>>2]=0,f[A+16>>2]=0,f[A+20>>2]=0,f[A+24>>2]=0,f[A+28>>2]=0;return}if(Be=A+8|0,W[Be>>3]=17976931348623157e292,Je=A+24|0,W[Je>>3]=17976931348623157e292,W[A>>3]=-17976931348623157e292,Ye=A+16|0,W[Ye>>3]=-17976931348623157e292,!((Ee|0)<=0)){for(we=f[d+4>>2]|0,H=17976931348623157e292,J=-17976931348623157e292,Ae=0,d=-1,S=17976931348623157e292,I=17976931348623157e292,O=-17976931348623157e292,_=-17976931348623157e292,Re=0;m=+W[we+(Re<<4)>>3],D=+W[we+(Re<<4)+8>>3],d=d+2|0,x=+W[we+(((d|0)==(Ee|0)?0:d)<<4)+8>>3],m<S&&(W[Be>>3]=m,S=m),D<I&&(W[Je>>3]=D,I=D),m>O?W[A>>3]=m:m=O,D>_&&(W[Ye>>3]=D,_=D),H=D>0&D<H?D:H,J=D<0&D>J?D:J,Ae=Ae|+Me(+(D-x))>3.141592653589793,d=Re+1|0,(d|0)!=(Ee|0);)He=Re,O=m,Re=d,d=He;Ae&&(W[Ye>>3]=J,W[Je>>3]=H)}}function Ku(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0,bt=0,rt=0;if(Ee=f[d>>2]|0,Ee){if(Be=A+8|0,W[Be>>3]=17976931348623157e292,Je=A+24|0,W[Je>>3]=17976931348623157e292,W[A>>3]=-17976931348623157e292,Ye=A+16|0,W[Ye>>3]=-17976931348623157e292,(Ee|0)>0){for(x=f[d+4>>2]|0,we=17976931348623157e292,Re=-17976931348623157e292,_=0,m=-1,O=17976931348623157e292,H=17976931348623157e292,Ae=-17976931348623157e292,I=-17976931348623157e292,He=0;S=+W[x+(He<<4)>>3],J=+W[x+(He<<4)+8>>3],bt=m+2|0,D=+W[x+(((bt|0)==(Ee|0)?0:bt)<<4)+8>>3],S<O&&(W[Be>>3]=S,O=S),J<H&&(W[Je>>3]=J,H=J),S>Ae?W[A>>3]=S:S=Ae,J>I&&(W[Ye>>3]=J,I=J),we=J>0&J<we?J:we,Re=J<0&J>Re?J:Re,_=_|+Me(+(J-D))>3.141592653589793,m=He+1|0,(m|0)!=(Ee|0);)bt=He,Ae=S,He=m,m=bt;_&&(W[Ye>>3]=Re,W[Je>>3]=we)}}else f[A>>2]=0,f[A+4>>2]=0,f[A+8>>2]=0,f[A+12>>2]=0,f[A+16>>2]=0,f[A+20>>2]=0,f[A+24>>2]=0,f[A+28>>2]=0;if(bt=d+8|0,m=f[bt>>2]|0,!((m|0)<=0)){Pt=d+12|0,Oe=0;do if(x=f[Pt>>2]|0,_=Oe,Oe=Oe+1|0,Je=A+(Oe<<5)|0,Ye=f[x+(_<<3)>>2]|0,Ye){if(He=A+(Oe<<5)+8|0,W[He>>3]=17976931348623157e292,d=A+(Oe<<5)+24|0,W[d>>3]=17976931348623157e292,W[Je>>3]=-17976931348623157e292,We=A+(Oe<<5)+16|0,W[We>>3]=-17976931348623157e292,(Ye|0)>0){for(Ee=f[x+(_<<3)+4>>2]|0,we=17976931348623157e292,Re=-17976931348623157e292,x=0,_=-1,Be=0,O=17976931348623157e292,H=17976931348623157e292,J=-17976931348623157e292,I=-17976931348623157e292;S=+W[Ee+(Be<<4)>>3],Ae=+W[Ee+(Be<<4)+8>>3],_=_+2|0,D=+W[Ee+(((_|0)==(Ye|0)?0:_)<<4)+8>>3],S<O&&(W[He>>3]=S,O=S),Ae<H&&(W[d>>3]=Ae,H=Ae),S>J?W[Je>>3]=S:S=J,Ae>I&&(W[We>>3]=Ae,I=Ae),we=Ae>0&Ae<we?Ae:we,Re=Ae<0&Ae>Re?Ae:Re,x=x|+Me(+(Ae-D))>3.141592653589793,_=Be+1|0,(_|0)!=(Ye|0);)rt=Be,Be=_,J=S,_=rt;x&&(W[We>>3]=Re,W[d>>3]=we)}}else f[Je>>2]=0,f[Je+4>>2]=0,f[Je+8>>2]=0,f[Je+12>>2]=0,f[Je+16>>2]=0,f[Je+20>>2]=0,f[Je+24>>2]=0,f[Je+28>>2]=0,m=f[bt>>2]|0;while((Oe|0)<(m|0))}}function Fa(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if(!(pr(d,A,m)|0))return x=0,x|0;if(x=d+8|0,(f[x>>2]|0)<=0)return x=1,x|0;for(_=d+12|0,d=0;;){if(S=d,d=d+1|0,pr((f[_>>2]|0)+(S<<3)|0,A+(d<<5)|0,m)|0){d=0,_=6;break}if((d|0)>=(f[x>>2]|0)){d=1,_=6;break}}return(_|0)==6?d|0:0}function Mc(){return 8}function Tl(){return 16}function Ju(){return 168}function Zr(){return 8}function fi(){return 16}function Sl(){return 12}function T0(){return 8}function eh(d){return d=d|0,+(+((f[d>>2]|0)>>>0)+4294967296*+(f[d+4>>2]|0))}function th(d){d=d|0;var A=0,m=0;return m=+W[d>>3],A=+W[d+8>>3],+ +Ne(+(m*m+A*A))}function Ic(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0;H=+W[d>>3],O=+W[A>>3]-H,D=+W[d+8>>3],I=+W[A+8>>3]-D,Ae=+W[m>>3],S=+W[_>>3]-Ae,we=+W[m+8>>3],J=+W[_+8>>3]-we,S=(S*(D-we)-(H-Ae)*J)/(O*J-I*S),W[x>>3]=H+O*S,W[x+8>>3]=D+I*S}function nh(d,A){return d=d|0,A=A|0,+Me(+(+W[d>>3]-+W[A>>3]))<11920928955078125e-23?(A=+Me(+(+W[d+8>>3]-+W[A+8>>3]))<11920928955078125e-23,A|0):(A=0,A|0)}function ei(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;return x=+W[d>>3]-+W[A>>3],_=+W[d+8>>3]-+W[A+8>>3],m=+W[d+16>>3]-+W[A+16>>3],+(x*x+_*_+m*m)}function Cl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;m=+W[d>>3],_=+Ue(+m),m=+ct(+m),W[A+16>>3]=m,m=+W[d+8>>3],x=_*+Ue(+m),W[A>>3]=x,m=_*+ct(+m),W[A+8>>3]=m}function Ht(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if(S=de,de=de+16|0,x=S,_=Jn(d,A)|0,(m+-1|0)>>>0>5||(_=(_|0)!=0,(m|0)==1&_))return x=-1,de=S,x|0;do if(Kt(d,A,x)|0)_=-1;else if(_){_=((f[21936+(m<<2)>>2]|0)+5-(f[x>>2]|0)|0)%5|0;break}else{_=((f[21968+(m<<2)>>2]|0)+6-(f[x>>2]|0)|0)%6|0;break}while(0);return x=_,de=S,x|0}function Kt(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0,H=0;if(H=de,de=de+32|0,I=H+16|0,D=H,_=ds(d,A,I)|0,_|0)return m=_,de=H,m|0;S=ka(d,A)|0,O=Fi(d,A)|0,ku(S,D),_=U1(S,f[I>>2]|0)|0;e:do if(zn(S)|0){do switch(S|0){case 4:{d=0;break}case 14:{d=1;break}case 24:{d=2;break}case 38:{d=3;break}case 49:{d=4;break}case 58:{d=5;break}case 63:{d=6;break}case 72:{d=7;break}case 83:{d=8;break}case 97:{d=9;break}case 107:{d=10;break}case 117:{d=11;break}default:{_=1;break e}}while(0);if(x=f[22e3+(d*24|0)+8>>2]|0,A=f[22e3+(d*24|0)+16>>2]|0,d=f[I>>2]|0,(d|0)!=(f[D>>2]|0)&&(D=h0(S)|0,d=f[I>>2]|0,D|(d|0)==(A|0)&&(_=(_+1|0)%6|0)),(O|0)==3&(d|0)==(A|0)){_=(_+5|0)%6|0,x=22;break}(O|0)==5&(d|0)==(x|0)&&(_=(_+1|0)%6|0),x=22}else x=22;while(0);return(x|0)==22&&(f[m>>2]=_,_=0),m=_,de=H,m|0}function Ji(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0;if(We=de,de=de+32|0,He=We+24|0,Je=We+20|0,Ee=We+8|0,Re=We+16|0,we=We,O=(Jn(d,A)|0)==0,O=O?6:5,J=le(d|0,A|0,52)|0,ge()|0,J=J&15,O>>>0<=m>>>0)return _=2,de=We,_|0;Ae=(J|0)==0,!Ae&&(Be=ye(7,0,(J^15)*3|0)|0,(Be&d|0)==0&((ge()|0)&A|0)==0)?x=m:S=4;e:do if((S|0)==4){if(x=(Jn(d,A)|0)!=0,((x?4:5)|0)<(m|0)||Kt(d,A,He)|0||(S=(f[He>>2]|0)+m|0,x?x=22288+(((S|0)%5|0)<<2)|0:x=22320+(((S|0)%6|0)<<2)|0,Be=f[x>>2]|0,(Be|0)==7))return _=1,de=We,_|0;f[Je>>2]=0,x=Ie(d,A,Be,Je,Ee)|0;do if(!x){if(D=Ee,H=f[D>>2]|0,D=f[D+4>>2]|0,I=D>>>0<A>>>0|(D|0)==(A|0)&H>>>0<d>>>0,S=I?H:d,I=I?D:A,!Ae&&(Ae=ye(7,0,(J^15)*3|0)|0,(H&Ae|0)==0&(D&(ge()|0)|0)==0))x=m;else{if(D=(m+-1+O|0)%(O|0)|0,x=Jn(d,A)|0,(D|0)<0&&en(23313,23315,245,23324),O=(x|0)!=0,((O?4:5)|0)<(D|0)&&en(23313,23315,245,23324),Kt(d,A,He)|0&&en(23313,23315,245,23324),x=(f[He>>2]|0)+D|0,O?x=22288+(((x|0)%5|0)<<2)|0:x=22320+(((x|0)%6|0)<<2)|0,D=f[x>>2]|0,(D|0)==7&&en(23313,23315,245,23324),f[Re>>2]=0,x=Ie(d,A,D,Re,we)|0,x|0)break;H=we,O=f[H>>2]|0,H=f[H+4>>2]|0;do if(H>>>0<I>>>0|(H|0)==(I|0)&O>>>0<S>>>0){if(Jn(O,H)|0?S=Xe(O,H,d,A)|0:S=f[22384+((((f[Re>>2]|0)+(f[22352+(D<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,x=Jn(O,H)|0,(S+-1|0)>>>0>5){x=-1,S=O,I=H;break}if(x=(x|0)!=0,(S|0)==1&x){x=-1,S=O,I=H;break}do if(Kt(O,H,He)|0)x=-1;else if(x){x=((f[21936+(S<<2)>>2]|0)+5-(f[He>>2]|0)|0)%5|0;break}else{x=((f[21968+(S<<2)>>2]|0)+6-(f[He>>2]|0)|0)%6|0;break}while(0);S=O,I=H}else x=m;while(0);D=Ee,H=f[D>>2]|0,D=f[D+4>>2]|0}if((S|0)==(H|0)&(I|0)==(D|0)){if(O=(Jn(H,D)|0)!=0,O?d=Xe(H,D,d,A)|0:d=f[22384+((((f[Je>>2]|0)+(f[22352+(Be<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,x=Jn(H,D)|0,(d+-1|0)>>>0<=5&&(Ye=(x|0)!=0,!((d|0)==1&Ye)))do if(Kt(H,D,He)|0)x=-1;else if(Ye){x=((f[21936+(d<<2)>>2]|0)+5-(f[He>>2]|0)|0)%5|0;break}else{x=((f[21968+(d<<2)>>2]|0)+6-(f[He>>2]|0)|0)%6|0;break}while(0);else x=-1;x=x+1|0,x=(x|0)==6|O&(x|0)==5?0:x}A=I,d=S;break e}while(0);return _=x,de=We,_|0}while(0);return Ye=ye(x|0,0,56)|0,He=ge()|0|A&-2130706433|536870912,f[_>>2]=Ye|d,f[_+4>>2]=He,_=0,de=We,_|0}function kc(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;return S=(Jn(d,A)|0)==0,_=Ji(d,A,0,m)|0,x=(_|0)==0,S?!x||(_=Ji(d,A,1,m+8|0)|0,_|0)||(_=Ji(d,A,2,m+16|0)|0,_|0)||(_=Ji(d,A,3,m+24|0)|0,_|0)||(_=Ji(d,A,4,m+32|0)|0,_)?(S=_,S|0):Ji(d,A,5,m+40|0)|0:!x||(_=Ji(d,A,1,m+8|0)|0,_|0)||(_=Ji(d,A,2,m+16|0)|0,_|0)||(_=Ji(d,A,3,m+24|0)|0,_|0)||(_=Ji(d,A,4,m+32|0)|0,_|0)?(S=_,S|0):(S=m+40|0,f[S>>2]=0,f[S+4>>2]=0,S=0,S|0)}function Po(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0,D=0,O=0;return O=de,de=de+192|0,x=O,S=O+168|0,I=le(d|0,A|0,56)|0,ge()|0,I=I&7,D=A&-2130706433|134217728,_=ds(d,D,S)|0,_|0?(D=_,de=O,D|0):(A=le(d|0,A|0,52)|0,ge()|0,A=A&15,Jn(d,D)|0?To(S,A,I,1,x):_c(S,A,I,1,x),D=x+8|0,f[m>>2]=f[D>>2],f[m+4>>2]=f[D+4>>2],f[m+8>>2]=f[D+8>>2],f[m+12>>2]=f[D+12>>2],D=0,de=O,D|0)}function er(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return x=de,de=de+16|0,m=x,!(!0&(A&2013265920|0)==536870912)||(_=A&-2130706433|134217728,!(Qo(d,_)|0))?(_=0,de=x,_|0):(S=le(d|0,A|0,56)|0,ge()|0,S=(Ji(d,_,S&7,m)|0)==0,_=m,_=S&((f[_>>2]|0)==(d|0)?(f[_+4>>2]|0)==(A|0):0)&1,de=x,_|0)}function Js(d,A,m){d=d|0,A=A|0,m=m|0;var _=0;(A|0)>0?(_=E(A,4)|0,f[d>>2]=_,_||en(23337,23360,40,23374)):f[d>>2]=0,f[d+4>>2]=A,f[d+8>>2]=0,f[d+12>>2]=m}function ms(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0;x=d+4|0,S=d+12|0,I=d+8|0;e:for(;;){for(m=f[x>>2]|0,A=0;;){if((A|0)>=(m|0))break e;if(_=f[d>>2]|0,D=f[_+(A<<2)>>2]|0,!D)A=A+1|0;else break}A=_+(~~(+Me(+(+it(10,+ +(15-(f[S>>2]|0)|0))*(+W[D>>3]+ +W[D+8>>3])))%+(m|0))>>>0<<2)|0,m=f[A>>2]|0;t:do if(m|0){if(_=D+32|0,(m|0)==(D|0))f[A>>2]=f[_>>2];else{if(m=m+32|0,A=f[m>>2]|0,!A)break;for(;(A|0)!=(D|0);)if(m=A+32|0,A=f[m>>2]|0,!A)break t;f[m>>2]=f[_>>2]}v(D),f[I>>2]=(f[I>>2]|0)+-1}while(0)}v(f[d>>2]|0)}function Lc(d){d=d|0;var A=0,m=0,_=0;for(_=f[d+4>>2]|0,m=0;;){if((m|0)>=(_|0)){A=0,m=4;break}if(A=f[(f[d>>2]|0)+(m<<2)>>2]|0,!A)m=m+1|0;else{m=4;break}}return(m|0)==4?A|0:0}function eo(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;if(m=~~(+Me(+(+it(10,+ +(15-(f[d+12>>2]|0)|0))*(+W[A>>3]+ +W[A+8>>3])))%+(f[d+4>>2]|0))>>>0,m=(f[d>>2]|0)+(m<<2)|0,_=f[m>>2]|0,!_)return S=1,S|0;S=A+32|0;do if((_|0)!=(A|0)){if(m=f[_+32>>2]|0,!m)return S=1,S|0;for(x=m;;){if((x|0)==(A|0)){x=8;break}if(m=f[x+32>>2]|0,m)_=x,x=m;else{m=1,x=10;break}}if((x|0)==8){f[_+32>>2]=f[S>>2];break}else if((x|0)==10)return m|0}else f[m>>2]=f[S>>2];while(0);return v(A),S=d+8|0,f[S>>2]=(f[S>>2]|0)+-1,S=0,S|0}function wi(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0;S=p(40)|0,S||en(23390,23360,98,23403),f[S>>2]=f[A>>2],f[S+4>>2]=f[A+4>>2],f[S+8>>2]=f[A+8>>2],f[S+12>>2]=f[A+12>>2],x=S+16|0,f[x>>2]=f[m>>2],f[x+4>>2]=f[m+4>>2],f[x+8>>2]=f[m+8>>2],f[x+12>>2]=f[m+12>>2],f[S+32>>2]=0,x=~~(+Me(+(+it(10,+ +(15-(f[d+12>>2]|0)|0))*(+W[A>>3]+ +W[A+8>>3])))%+(f[d+4>>2]|0))>>>0,x=(f[d>>2]|0)+(x<<2)|0,_=f[x>>2]|0;do if(!_)f[x>>2]=S;else{for(;!(Ds(_,A)|0&&Ds(_+16|0,m)|0);)if(x=f[_+32>>2]|0,_=x|0?x:_,!(f[_+32>>2]|0)){I=10;break}if((I|0)==10){f[_+32>>2]=S;break}return v(S),I=_,I|0}while(0);return I=d+8|0,f[I>>2]=(f[I>>2]|0)+1,I=S,I|0}function zi(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;if(x=~~(+Me(+(+it(10,+ +(15-(f[d+12>>2]|0)|0))*(+W[A>>3]+ +W[A+8>>3])))%+(f[d+4>>2]|0))>>>0,x=f[(f[d>>2]|0)+(x<<2)>>2]|0,!x)return m=0,m|0;if(!m){for(d=x;;){if(Ds(d,A)|0){_=10;break}if(d=f[d+32>>2]|0,!d){d=0,_=10;break}}if((_|0)==10)return d|0}for(d=x;;){if(Ds(d,A)|0&&Ds(d+16|0,m)|0){_=10;break}if(d=f[d+32>>2]|0,!d){d=0,_=10;break}}return(_|0)==10?d|0:0}function Dc(d,A){d=d|0,A=A|0;var m=0;if(m=~~(+Me(+(+it(10,+ +(15-(f[d+12>>2]|0)|0))*(+W[A>>3]+ +W[A+8>>3])))%+(f[d+4>>2]|0))>>>0,d=f[(f[d>>2]|0)+(m<<2)>>2]|0,!d)return m=0,m|0;for(;;){if(Ds(d,A)|0){A=5;break}if(d=f[d+32>>2]|0,!d){d=0,A=5;break}}return(A|0)==5?d|0:0}function ea(){return 23424}function b(d){return d=+d,+ +tt(+d)}function l(d){return d=+d,~~+b(d)|0}function p(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0,Be=0,Je=0,Ye=0,He=0,We=0,Oe=0,Pt=0;Pt=de,de=de+16|0,we=Pt;do if(d>>>0<245){if(H=d>>>0<11?16:d+11&-8,d=H>>>3,Ae=f[5857]|0,m=Ae>>>d,m&3|0)return A=(m&1^1)+d|0,d=23468+(A<<1<<2)|0,m=d+8|0,_=f[m>>2]|0,x=_+8|0,S=f[x>>2]|0,(S|0)==(d|0)?f[5857]=Ae&~(1<<A):(f[S+12>>2]=d,f[m>>2]=S),Oe=A<<3,f[_+4>>2]=Oe|3,Oe=_+Oe+4|0,f[Oe>>2]=f[Oe>>2]|1,Oe=x,de=Pt,Oe|0;if(J=f[5859]|0,H>>>0>J>>>0){if(m|0)return A=2<<d,A=m<<d&(A|0-A),A=(A&0-A)+-1|0,D=A>>>12&16,A=A>>>D,m=A>>>5&8,A=A>>>m,S=A>>>2&4,A=A>>>S,d=A>>>1&2,A=A>>>d,_=A>>>1&1,_=(m|D|S|d|_)+(A>>>_)|0,A=23468+(_<<1<<2)|0,d=A+8|0,S=f[d>>2]|0,D=S+8|0,m=f[D>>2]|0,(m|0)==(A|0)?(d=Ae&~(1<<_),f[5857]=d):(f[m+12>>2]=A,f[d>>2]=m,d=Ae),Oe=_<<3,I=Oe-H|0,f[S+4>>2]=H|3,x=S+H|0,f[x+4>>2]=I|1,f[S+Oe>>2]=I,J|0&&(_=f[5862]|0,A=J>>>3,m=23468+(A<<1<<2)|0,A=1<<A,d&A?(d=m+8|0,A=f[d>>2]|0):(f[5857]=d|A,A=m,d=m+8|0),f[d>>2]=_,f[A+12>>2]=_,f[_+8>>2]=A,f[_+12>>2]=m),f[5859]=I,f[5862]=x,Oe=D,de=Pt,Oe|0;if(S=f[5858]|0,S){for(m=(S&0-S)+-1|0,x=m>>>12&16,m=m>>>x,_=m>>>5&8,m=m>>>_,I=m>>>2&4,m=m>>>I,D=m>>>1&2,m=m>>>D,O=m>>>1&1,O=f[23732+((_|x|I|D|O)+(m>>>O)<<2)>>2]|0,m=O,D=O,O=(f[O+4>>2]&-8)-H|0;d=f[m+16>>2]|0,!(!d&&(d=f[m+20>>2]|0,!d));)I=(f[d+4>>2]&-8)-H|0,x=I>>>0<O>>>0,m=d,D=x?d:D,O=x?I:O;if(I=D+H|0,I>>>0>D>>>0){x=f[D+24>>2]|0,A=f[D+12>>2]|0;do if((A|0)==(D|0)){if(d=D+20|0,A=f[d>>2]|0,!A&&(d=D+16|0,A=f[d>>2]|0,!A)){m=0;break}for(;;)if(_=A+20|0,m=f[_>>2]|0,m)A=m,d=_;else if(_=A+16|0,m=f[_>>2]|0,m)A=m,d=_;else break;f[d>>2]=0,m=A}else m=f[D+8>>2]|0,f[m+12>>2]=A,f[A+8>>2]=m,m=A;while(0);do if(x|0){if(A=f[D+28>>2]|0,d=23732+(A<<2)|0,(D|0)==(f[d>>2]|0)){if(f[d>>2]=m,!m){f[5858]=S&~(1<<A);break}}else if(Oe=x+16|0,f[((f[Oe>>2]|0)==(D|0)?Oe:x+20|0)>>2]=m,!m)break;f[m+24>>2]=x,A=f[D+16>>2]|0,A|0&&(f[m+16>>2]=A,f[A+24>>2]=m),A=f[D+20>>2]|0,A|0&&(f[m+20>>2]=A,f[A+24>>2]=m)}while(0);return O>>>0<16?(Oe=O+H|0,f[D+4>>2]=Oe|3,Oe=D+Oe+4|0,f[Oe>>2]=f[Oe>>2]|1):(f[D+4>>2]=H|3,f[I+4>>2]=O|1,f[I+O>>2]=O,J|0&&(_=f[5862]|0,A=J>>>3,m=23468+(A<<1<<2)|0,A=1<<A,A&Ae?(d=m+8|0,A=f[d>>2]|0):(f[5857]=A|Ae,A=m,d=m+8|0),f[d>>2]=_,f[A+12>>2]=_,f[_+8>>2]=A,f[_+12>>2]=m),f[5859]=O,f[5862]=I),Oe=D+8|0,de=Pt,Oe|0}else Ae=H}else Ae=H}else Ae=H}else if(d>>>0<=4294967231)if(d=d+11|0,H=d&-8,_=f[5858]|0,_){x=0-H|0,d=d>>>8,d?H>>>0>16777215?O=31:(Ae=(d+1048320|0)>>>16&8,Be=d<<Ae,D=(Be+520192|0)>>>16&4,Be=Be<<D,O=(Be+245760|0)>>>16&2,O=14-(D|Ae|O)+(Be<<O>>>15)|0,O=H>>>(O+7|0)&1|O<<1):O=0,m=f[23732+(O<<2)>>2]|0;e:do if(!m)m=0,d=0,Be=61;else for(d=0,D=H<<((O|0)==31?0:25-(O>>>1)|0),S=0;;){if(I=(f[m+4>>2]&-8)-H|0,I>>>0<x>>>0)if(I)d=m,x=I;else{d=m,x=0,Be=65;break e}if(Be=f[m+20>>2]|0,m=f[m+16+(D>>>31<<2)>>2]|0,S=(Be|0)==0|(Be|0)==(m|0)?S:Be,m)D=D<<1;else{m=S,Be=61;break}}while(0);if((Be|0)==61){if((m|0)==0&(d|0)==0){if(d=2<<O,d=(d|0-d)&_,!d){Ae=H;break}Ae=(d&0-d)+-1|0,I=Ae>>>12&16,Ae=Ae>>>I,S=Ae>>>5&8,Ae=Ae>>>S,D=Ae>>>2&4,Ae=Ae>>>D,O=Ae>>>1&2,Ae=Ae>>>O,m=Ae>>>1&1,d=0,m=f[23732+((S|I|D|O|m)+(Ae>>>m)<<2)>>2]|0}m?Be=65:(D=d,I=x)}if((Be|0)==65)for(S=m;;)if(Ae=(f[S+4>>2]&-8)-H|0,m=Ae>>>0<x>>>0,x=m?Ae:x,d=m?S:d,m=f[S+16>>2]|0,m||(m=f[S+20>>2]|0),m)S=m;else{D=d,I=x;break}if(D|0&&I>>>0<((f[5859]|0)-H|0)>>>0&&(J=D+H|0,J>>>0>D>>>0)){S=f[D+24>>2]|0,A=f[D+12>>2]|0;do if((A|0)==(D|0)){if(d=D+20|0,A=f[d>>2]|0,!A&&(d=D+16|0,A=f[d>>2]|0,!A)){A=0;break}for(;;)if(x=A+20|0,m=f[x>>2]|0,m)A=m,d=x;else if(x=A+16|0,m=f[x>>2]|0,m)A=m,d=x;else break;f[d>>2]=0}else Oe=f[D+8>>2]|0,f[Oe+12>>2]=A,f[A+8>>2]=Oe;while(0);do if(S){if(d=f[D+28>>2]|0,m=23732+(d<<2)|0,(D|0)==(f[m>>2]|0)){if(f[m>>2]=A,!A){_=_&~(1<<d),f[5858]=_;break}}else if(Oe=S+16|0,f[((f[Oe>>2]|0)==(D|0)?Oe:S+20|0)>>2]=A,!A)break;f[A+24>>2]=S,d=f[D+16>>2]|0,d|0&&(f[A+16>>2]=d,f[d+24>>2]=A),d=f[D+20>>2]|0,d&&(f[A+20>>2]=d,f[d+24>>2]=A)}while(0);e:do if(I>>>0<16)Oe=I+H|0,f[D+4>>2]=Oe|3,Oe=D+Oe+4|0,f[Oe>>2]=f[Oe>>2]|1;else{if(f[D+4>>2]=H|3,f[J+4>>2]=I|1,f[J+I>>2]=I,A=I>>>3,I>>>0<256){m=23468+(A<<1<<2)|0,d=f[5857]|0,A=1<<A,d&A?(d=m+8|0,A=f[d>>2]|0):(f[5857]=d|A,A=m,d=m+8|0),f[d>>2]=J,f[A+12>>2]=J,f[J+8>>2]=A,f[J+12>>2]=m;break}if(A=I>>>8,A?I>>>0>16777215?m=31:(We=(A+1048320|0)>>>16&8,Oe=A<<We,He=(Oe+520192|0)>>>16&4,Oe=Oe<<He,m=(Oe+245760|0)>>>16&2,m=14-(He|We|m)+(Oe<<m>>>15)|0,m=I>>>(m+7|0)&1|m<<1):m=0,A=23732+(m<<2)|0,f[J+28>>2]=m,d=J+16|0,f[d+4>>2]=0,f[d>>2]=0,d=1<<m,!(_&d)){f[5858]=_|d,f[A>>2]=J,f[J+24>>2]=A,f[J+12>>2]=J,f[J+8>>2]=J;break}A=f[A>>2]|0;t:do if((f[A+4>>2]&-8|0)!=(I|0)){for(_=I<<((m|0)==31?0:25-(m>>>1)|0);m=A+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(I|0)){A=d;break t}else _=_<<1,A=d;f[m>>2]=J,f[J+24>>2]=A,f[J+12>>2]=J,f[J+8>>2]=J;break e}while(0);We=A+8|0,Oe=f[We>>2]|0,f[Oe+12>>2]=J,f[We>>2]=J,f[J+8>>2]=Oe,f[J+12>>2]=A,f[J+24>>2]=0}while(0);return Oe=D+8|0,de=Pt,Oe|0}else Ae=H}else Ae=H;else Ae=-1;while(0);if(m=f[5859]|0,m>>>0>=Ae>>>0)return A=m-Ae|0,d=f[5862]|0,A>>>0>15?(Oe=d+Ae|0,f[5862]=Oe,f[5859]=A,f[Oe+4>>2]=A|1,f[d+m>>2]=A,f[d+4>>2]=Ae|3):(f[5859]=0,f[5862]=0,f[d+4>>2]=m|3,Oe=d+m+4|0,f[Oe>>2]=f[Oe>>2]|1),Oe=d+8|0,de=Pt,Oe|0;if(I=f[5860]|0,I>>>0>Ae>>>0)return He=I-Ae|0,f[5860]=He,Oe=f[5863]|0,We=Oe+Ae|0,f[5863]=We,f[We+4>>2]=He|1,f[Oe+4>>2]=Ae|3,Oe=Oe+8|0,de=Pt,Oe|0;if(f[5975]|0?d=f[5977]|0:(f[5977]=4096,f[5976]=4096,f[5978]=-1,f[5979]=-1,f[5980]=0,f[5968]=0,f[5975]=we&-16^1431655768,d=4096),D=Ae+48|0,O=Ae+47|0,S=d+O|0,x=0-d|0,H=S&x,H>>>0<=Ae>>>0||(d=f[5967]|0,d|0&&(J=f[5965]|0,we=J+H|0,we>>>0<=J>>>0|we>>>0>d>>>0)))return Oe=0,de=Pt,Oe|0;e:do if(f[5968]&4)A=0,Be=143;else{m=f[5863]|0;t:do if(m){for(_=23876;we=f[_>>2]|0,!(we>>>0<=m>>>0&&(we+(f[_+4>>2]|0)|0)>>>0>m>>>0);)if(d=f[_+8>>2]|0,d)_=d;else{Be=128;break t}if(A=S-I&x,A>>>0<2147483647)if(d=Ke(A|0)|0,(d|0)==((f[_>>2]|0)+(f[_+4>>2]|0)|0)){if((d|0)!=-1){I=A,S=d,Be=145;break e}}else _=d,Be=136;else A=0}else Be=128;while(0);do if((Be|0)==128)if(m=Ke(0)|0,(m|0)!=-1&&(A=m,Re=f[5976]|0,Ee=Re+-1|0,A=(Ee&A|0?(Ee+A&0-Re)-A|0:0)+H|0,Re=f[5965]|0,Ee=A+Re|0,A>>>0>Ae>>>0&A>>>0<2147483647)){if(we=f[5967]|0,we|0&&Ee>>>0<=Re>>>0|Ee>>>0>we>>>0){A=0;break}if(d=Ke(A|0)|0,(d|0)==(m|0)){I=A,S=m,Be=145;break e}else _=d,Be=136}else A=0;while(0);do if((Be|0)==136){if(m=0-A|0,!(D>>>0>A>>>0&(A>>>0<2147483647&(_|0)!=-1)))if((_|0)==-1){A=0;break}else{I=A,S=_,Be=145;break e}if(d=f[5977]|0,d=O-A+d&0-d,d>>>0>=2147483647){I=A,S=_,Be=145;break e}if((Ke(d|0)|0)==-1){Ke(m|0)|0,A=0;break}else{I=d+A|0,S=_,Be=145;break e}}while(0);f[5968]=f[5968]|4,Be=143}while(0);if((Be|0)==143&&H>>>0<2147483647&&(He=Ke(H|0)|0,Ee=Ke(0)|0,Je=Ee-He|0,Ye=Je>>>0>(Ae+40|0)>>>0,!((He|0)==-1|Ye^1|He>>>0<Ee>>>0&((He|0)!=-1&(Ee|0)!=-1)^1))&&(I=Ye?Je:A,S=He,Be=145),(Be|0)==145){A=(f[5965]|0)+I|0,f[5965]=A,A>>>0>(f[5966]|0)>>>0&&(f[5966]=A),O=f[5863]|0;e:do if(O){for(A=23876;;){if(d=f[A>>2]|0,m=f[A+4>>2]|0,(S|0)==(d+m|0)){Be=154;break}if(_=f[A+8>>2]|0,_)A=_;else break}if((Be|0)==154&&(We=A+4|0,(f[A+12>>2]&8|0)==0)&&S>>>0>O>>>0&d>>>0<=O>>>0){f[We>>2]=m+I,Oe=(f[5860]|0)+I|0,He=O+8|0,He=He&7|0?0-He&7:0,We=O+He|0,He=Oe-He|0,f[5863]=We,f[5860]=He,f[We+4>>2]=He|1,f[O+Oe+4>>2]=40,f[5864]=f[5979];break}for(S>>>0<(f[5861]|0)>>>0&&(f[5861]=S),m=S+I|0,A=23876;;){if((f[A>>2]|0)==(m|0)){Be=162;break}if(d=f[A+8>>2]|0,d)A=d;else break}if((Be|0)==162&&!(f[A+12>>2]&8|0)){f[A>>2]=S,J=A+4|0,f[J>>2]=(f[J>>2]|0)+I,J=S+8|0,J=S+(J&7|0?0-J&7:0)|0,A=m+8|0,A=m+(A&7|0?0-A&7:0)|0,H=J+Ae|0,D=A-J-Ae|0,f[J+4>>2]=Ae|3;t:do if((O|0)==(A|0))Oe=(f[5860]|0)+D|0,f[5860]=Oe,f[5863]=H,f[H+4>>2]=Oe|1;else{if((f[5862]|0)==(A|0)){Oe=(f[5859]|0)+D|0,f[5859]=Oe,f[5862]=H,f[H+4>>2]=Oe|1,f[H+Oe>>2]=Oe;break}if(d=f[A+4>>2]|0,(d&3|0)==1){I=d&-8,_=d>>>3;n:do if(d>>>0<256)if(d=f[A+8>>2]|0,m=f[A+12>>2]|0,(m|0)==(d|0)){f[5857]=f[5857]&~(1<<_);break}else{f[d+12>>2]=m,f[m+8>>2]=d;break}else{S=f[A+24>>2]|0,d=f[A+12>>2]|0;do if((d|0)==(A|0)){if(m=A+16|0,_=m+4|0,d=f[_>>2]|0,d)m=_;else if(d=f[m>>2]|0,!d){d=0;break}for(;;)if(x=d+20|0,_=f[x>>2]|0,_)d=_,m=x;else if(x=d+16|0,_=f[x>>2]|0,_)d=_,m=x;else break;f[m>>2]=0}else Oe=f[A+8>>2]|0,f[Oe+12>>2]=d,f[d+8>>2]=Oe;while(0);if(!S)break;m=f[A+28>>2]|0,_=23732+(m<<2)|0;do if((f[_>>2]|0)!=(A|0)){if(Oe=S+16|0,f[((f[Oe>>2]|0)==(A|0)?Oe:S+20|0)>>2]=d,!d)break n}else{if(f[_>>2]=d,d|0)break;f[5858]=f[5858]&~(1<<m);break n}while(0);if(f[d+24>>2]=S,m=A+16|0,_=f[m>>2]|0,_|0&&(f[d+16>>2]=_,f[_+24>>2]=d),m=f[m+4>>2]|0,!m)break;f[d+20>>2]=m,f[m+24>>2]=d}while(0);A=A+I|0,x=I+D|0}else x=D;if(A=A+4|0,f[A>>2]=f[A>>2]&-2,f[H+4>>2]=x|1,f[H+x>>2]=x,A=x>>>3,x>>>0<256){m=23468+(A<<1<<2)|0,d=f[5857]|0,A=1<<A,d&A?(d=m+8|0,A=f[d>>2]|0):(f[5857]=d|A,A=m,d=m+8|0),f[d>>2]=H,f[A+12>>2]=H,f[H+8>>2]=A,f[H+12>>2]=m;break}A=x>>>8;do if(!A)_=0;else{if(x>>>0>16777215){_=31;break}We=(A+1048320|0)>>>16&8,Oe=A<<We,He=(Oe+520192|0)>>>16&4,Oe=Oe<<He,_=(Oe+245760|0)>>>16&2,_=14-(He|We|_)+(Oe<<_>>>15)|0,_=x>>>(_+7|0)&1|_<<1}while(0);if(A=23732+(_<<2)|0,f[H+28>>2]=_,d=H+16|0,f[d+4>>2]=0,f[d>>2]=0,d=f[5858]|0,m=1<<_,!(d&m)){f[5858]=d|m,f[A>>2]=H,f[H+24>>2]=A,f[H+12>>2]=H,f[H+8>>2]=H;break}A=f[A>>2]|0;n:do if((f[A+4>>2]&-8|0)!=(x|0)){for(_=x<<((_|0)==31?0:25-(_>>>1)|0);m=A+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(x|0)){A=d;break n}else _=_<<1,A=d;f[m>>2]=H,f[H+24>>2]=A,f[H+12>>2]=H,f[H+8>>2]=H;break t}while(0);We=A+8|0,Oe=f[We>>2]|0,f[Oe+12>>2]=H,f[We>>2]=H,f[H+8>>2]=Oe,f[H+12>>2]=A,f[H+24>>2]=0}while(0);return Oe=J+8|0,de=Pt,Oe|0}for(A=23876;d=f[A>>2]|0,!(d>>>0<=O>>>0&&(Oe=d+(f[A+4>>2]|0)|0,Oe>>>0>O>>>0));)A=f[A+8>>2]|0;x=Oe+-47|0,d=x+8|0,d=x+(d&7|0?0-d&7:0)|0,x=O+16|0,d=d>>>0<x>>>0?O:d,A=d+8|0,m=I+-40|0,He=S+8|0,He=He&7|0?0-He&7:0,We=S+He|0,He=m-He|0,f[5863]=We,f[5860]=He,f[We+4>>2]=He|1,f[S+m+4>>2]=40,f[5864]=f[5979],m=d+4|0,f[m>>2]=27,f[A>>2]=f[5969],f[A+4>>2]=f[5970],f[A+8>>2]=f[5971],f[A+12>>2]=f[5972],f[5969]=S,f[5970]=I,f[5972]=0,f[5971]=A,A=d+24|0;do We=A,A=A+4|0,f[A>>2]=7;while((We+8|0)>>>0<Oe>>>0);if((d|0)!=(O|0)){if(S=d-O|0,f[m>>2]=f[m>>2]&-2,f[O+4>>2]=S|1,f[d>>2]=S,A=S>>>3,S>>>0<256){m=23468+(A<<1<<2)|0,d=f[5857]|0,A=1<<A,d&A?(d=m+8|0,A=f[d>>2]|0):(f[5857]=d|A,A=m,d=m+8|0),f[d>>2]=O,f[A+12>>2]=O,f[O+8>>2]=A,f[O+12>>2]=m;break}if(A=S>>>8,A?S>>>0>16777215?_=31:(We=(A+1048320|0)>>>16&8,Oe=A<<We,He=(Oe+520192|0)>>>16&4,Oe=Oe<<He,_=(Oe+245760|0)>>>16&2,_=14-(He|We|_)+(Oe<<_>>>15)|0,_=S>>>(_+7|0)&1|_<<1):_=0,m=23732+(_<<2)|0,f[O+28>>2]=_,f[O+20>>2]=0,f[x>>2]=0,A=f[5858]|0,d=1<<_,!(A&d)){f[5858]=A|d,f[m>>2]=O,f[O+24>>2]=m,f[O+12>>2]=O,f[O+8>>2]=O;break}A=f[m>>2]|0;t:do if((f[A+4>>2]&-8|0)!=(S|0)){for(_=S<<((_|0)==31?0:25-(_>>>1)|0);m=A+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(S|0)){A=d;break t}else _=_<<1,A=d;f[m>>2]=O,f[O+24>>2]=A,f[O+12>>2]=O,f[O+8>>2]=O;break e}while(0);We=A+8|0,Oe=f[We>>2]|0,f[Oe+12>>2]=O,f[We>>2]=O,f[O+8>>2]=Oe,f[O+12>>2]=A,f[O+24>>2]=0}}else Oe=f[5861]|0,(Oe|0)==0|S>>>0<Oe>>>0&&(f[5861]=S),f[5969]=S,f[5970]=I,f[5972]=0,f[5866]=f[5975],f[5865]=-1,f[5870]=23468,f[5869]=23468,f[5872]=23476,f[5871]=23476,f[5874]=23484,f[5873]=23484,f[5876]=23492,f[5875]=23492,f[5878]=23500,f[5877]=23500,f[5880]=23508,f[5879]=23508,f[5882]=23516,f[5881]=23516,f[5884]=23524,f[5883]=23524,f[5886]=23532,f[5885]=23532,f[5888]=23540,f[5887]=23540,f[5890]=23548,f[5889]=23548,f[5892]=23556,f[5891]=23556,f[5894]=23564,f[5893]=23564,f[5896]=23572,f[5895]=23572,f[5898]=23580,f[5897]=23580,f[5900]=23588,f[5899]=23588,f[5902]=23596,f[5901]=23596,f[5904]=23604,f[5903]=23604,f[5906]=23612,f[5905]=23612,f[5908]=23620,f[5907]=23620,f[5910]=23628,f[5909]=23628,f[5912]=23636,f[5911]=23636,f[5914]=23644,f[5913]=23644,f[5916]=23652,f[5915]=23652,f[5918]=23660,f[5917]=23660,f[5920]=23668,f[5919]=23668,f[5922]=23676,f[5921]=23676,f[5924]=23684,f[5923]=23684,f[5926]=23692,f[5925]=23692,f[5928]=23700,f[5927]=23700,f[5930]=23708,f[5929]=23708,f[5932]=23716,f[5931]=23716,Oe=I+-40|0,He=S+8|0,He=He&7|0?0-He&7:0,We=S+He|0,He=Oe-He|0,f[5863]=We,f[5860]=He,f[We+4>>2]=He|1,f[S+Oe+4>>2]=40,f[5864]=f[5979];while(0);if(A=f[5860]|0,A>>>0>Ae>>>0)return He=A-Ae|0,f[5860]=He,Oe=f[5863]|0,We=Oe+Ae|0,f[5863]=We,f[We+4>>2]=He|1,f[Oe+4>>2]=Ae|3,Oe=Oe+8|0,de=Pt,Oe|0}return Oe=ea()|0,f[Oe>>2]=12,Oe=0,de=Pt,Oe|0}function v(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,I=0,D=0,O=0;if(d){m=d+-8|0,x=f[5861]|0,d=f[d+-4>>2]|0,A=d&-8,O=m+A|0;do if(d&1)D=m,I=m;else{if(_=f[m>>2]|0,!(d&3)||(I=m+(0-_)|0,S=_+A|0,I>>>0<x>>>0))return;if((f[5862]|0)==(I|0)){if(d=O+4|0,A=f[d>>2]|0,(A&3|0)!=3){D=I,A=S;break}f[5859]=S,f[d>>2]=A&-2,f[I+4>>2]=S|1,f[I+S>>2]=S;return}if(m=_>>>3,_>>>0<256)if(d=f[I+8>>2]|0,A=f[I+12>>2]|0,(A|0)==(d|0)){f[5857]=f[5857]&~(1<<m),D=I,A=S;break}else{f[d+12>>2]=A,f[A+8>>2]=d,D=I,A=S;break}x=f[I+24>>2]|0,d=f[I+12>>2]|0;do if((d|0)==(I|0)){if(A=I+16|0,m=A+4|0,d=f[m>>2]|0,d)A=m;else if(d=f[A>>2]|0,!d){d=0;break}for(;;)if(_=d+20|0,m=f[_>>2]|0,m)d=m,A=_;else if(_=d+16|0,m=f[_>>2]|0,m)d=m,A=_;else break;f[A>>2]=0}else D=f[I+8>>2]|0,f[D+12>>2]=d,f[d+8>>2]=D;while(0);if(x){if(A=f[I+28>>2]|0,m=23732+(A<<2)|0,(f[m>>2]|0)==(I|0)){if(f[m>>2]=d,!d){f[5858]=f[5858]&~(1<<A),D=I,A=S;break}}else if(D=x+16|0,f[((f[D>>2]|0)==(I|0)?D:x+20|0)>>2]=d,!d){D=I,A=S;break}f[d+24>>2]=x,A=I+16|0,m=f[A>>2]|0,m|0&&(f[d+16>>2]=m,f[m+24>>2]=d),A=f[A+4>>2]|0,A?(f[d+20>>2]=A,f[A+24>>2]=d,D=I,A=S):(D=I,A=S)}else D=I,A=S}while(0);if(!(I>>>0>=O>>>0)&&(d=O+4|0,_=f[d>>2]|0,!!(_&1))){if(_&2)f[d>>2]=_&-2,f[D+4>>2]=A|1,f[I+A>>2]=A,x=A;else{if((f[5863]|0)==(O|0)){if(O=(f[5860]|0)+A|0,f[5860]=O,f[5863]=D,f[D+4>>2]=O|1,(D|0)!=(f[5862]|0))return;f[5862]=0,f[5859]=0;return}if((f[5862]|0)==(O|0)){O=(f[5859]|0)+A|0,f[5859]=O,f[5862]=I,f[D+4>>2]=O|1,f[I+O>>2]=O;return}x=(_&-8)+A|0,m=_>>>3;do if(_>>>0<256)if(A=f[O+8>>2]|0,d=f[O+12>>2]|0,(d|0)==(A|0)){f[5857]=f[5857]&~(1<<m);break}else{f[A+12>>2]=d,f[d+8>>2]=A;break}else{S=f[O+24>>2]|0,d=f[O+12>>2]|0;do if((d|0)==(O|0)){if(A=O+16|0,m=A+4|0,d=f[m>>2]|0,d)A=m;else if(d=f[A>>2]|0,!d){m=0;break}for(;;)if(_=d+20|0,m=f[_>>2]|0,m)d=m,A=_;else if(_=d+16|0,m=f[_>>2]|0,m)d=m,A=_;else break;f[A>>2]=0,m=d}else m=f[O+8>>2]|0,f[m+12>>2]=d,f[d+8>>2]=m,m=d;while(0);if(S|0){if(d=f[O+28>>2]|0,A=23732+(d<<2)|0,(f[A>>2]|0)==(O|0)){if(f[A>>2]=m,!m){f[5858]=f[5858]&~(1<<d);break}}else if(_=S+16|0,f[((f[_>>2]|0)==(O|0)?_:S+20|0)>>2]=m,!m)break;f[m+24>>2]=S,d=O+16|0,A=f[d>>2]|0,A|0&&(f[m+16>>2]=A,f[A+24>>2]=m),d=f[d+4>>2]|0,d|0&&(f[m+20>>2]=d,f[d+24>>2]=m)}}while(0);if(f[D+4>>2]=x|1,f[I+x>>2]=x,(D|0)==(f[5862]|0)){f[5859]=x;return}}if(d=x>>>3,x>>>0<256){m=23468+(d<<1<<2)|0,A=f[5857]|0,d=1<<d,A&d?(A=m+8|0,d=f[A>>2]|0):(f[5857]=A|d,d=m,A=m+8|0),f[A>>2]=D,f[d+12>>2]=D,f[D+8>>2]=d,f[D+12>>2]=m;return}d=x>>>8,d?x>>>0>16777215?_=31:(I=(d+1048320|0)>>>16&8,O=d<<I,S=(O+520192|0)>>>16&4,O=O<<S,_=(O+245760|0)>>>16&2,_=14-(S|I|_)+(O<<_>>>15)|0,_=x>>>(_+7|0)&1|_<<1):_=0,d=23732+(_<<2)|0,f[D+28>>2]=_,f[D+20>>2]=0,f[D+16>>2]=0,A=f[5858]|0,m=1<<_;e:do if(!(A&m))f[5858]=A|m,f[d>>2]=D,f[D+24>>2]=d,f[D+12>>2]=D,f[D+8>>2]=D;else{d=f[d>>2]|0;t:do if((f[d+4>>2]&-8|0)!=(x|0)){for(_=x<<((_|0)==31?0:25-(_>>>1)|0);m=d+16+(_>>>31<<2)|0,A=f[m>>2]|0,!!A;)if((f[A+4>>2]&-8|0)==(x|0)){d=A;break t}else _=_<<1,d=A;f[m>>2]=D,f[D+24>>2]=d,f[D+12>>2]=D,f[D+8>>2]=D;break e}while(0);I=d+8|0,O=f[I>>2]|0,f[O+12>>2]=D,f[I>>2]=D,f[D+8>>2]=O,f[D+12>>2]=d,f[D+24>>2]=0}while(0);if(O=(f[5865]|0)+-1|0,f[5865]=O,!(O|0)){for(d=23884;d=f[d>>2]|0,d;)d=d+8|0;f[5865]=-1}}}}function E(d,A){d=d|0,A=A|0;var m=0;return d?(m=Xt(A,d)|0,(A|d)>>>0>65535&&(m=((m>>>0)/(d>>>0)|0|0)==(A|0)?m:-1)):m=0,d=p(m)|0,!d||!(f[d+-4>>2]&3)||je(d|0,0,m|0)|0,d|0}function P(d,A,m,_){return d=d|0,A=A|0,m=m|0,_=_|0,m=d+m>>>0,Ut(A+_+(m>>>0<d>>>0|0)>>>0|0),m|0|0}function z(d,A,m,_){return d=d|0,A=A|0,m=m|0,_=_|0,_=A-_-(m>>>0>d>>>0|0)>>>0,Ut(_|0),d-m>>>0|0|0}function N(d){return d=d|0,(d?31-(Un(d^d-1)|0)|0:32)|0}function G(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,I=0,D=0,O=0,H=0,J=0,Ae=0,we=0,Re=0,Ee=0;if(J=d,O=A,H=O,I=m,we=_,D=we,!H)return S=(x|0)!=0,D?S?(f[x>>2]=d|0,f[x+4>>2]=A&0,we=0,x=0,Ut(we|0),x|0):(we=0,x=0,Ut(we|0),x|0):(S&&(f[x>>2]=(J>>>0)%(I>>>0),f[x+4>>2]=0),we=0,x=(J>>>0)/(I>>>0)>>>0,Ut(we|0),x|0);S=(D|0)==0;do if(I){if(!S){if(S=(Un(D|0)|0)-(Un(H|0)|0)|0,S>>>0<=31){Ae=S+1|0,D=31-S|0,A=S-31>>31,I=Ae,d=J>>>(Ae>>>0)&A|H<<D,A=H>>>(Ae>>>0)&A,S=0,D=J<<D;break}return x?(f[x>>2]=d|0,f[x+4>>2]=O|A&0,we=0,x=0,Ut(we|0),x|0):(we=0,x=0,Ut(we|0),x|0)}if(S=I-1|0,S&I|0){D=(Un(I|0)|0)+33-(Un(H|0)|0)|0,Ee=64-D|0,Ae=32-D|0,O=Ae>>31,Re=D-32|0,A=Re>>31,I=D,d=Ae-1>>31&H>>>(Re>>>0)|(H<<Ae|J>>>(D>>>0))&A,A=A&H>>>(D>>>0),S=J<<Ee&O,D=(H<<Ee|J>>>(Re>>>0))&O|J<<Ae&D-33>>31;break}return x|0&&(f[x>>2]=S&J,f[x+4>>2]=0),(I|0)==1?(Re=O|A&0,Ee=d|0|0,Ut(Re|0),Ee|0):(Ee=N(I|0)|0,Re=H>>>(Ee>>>0)|0,Ee=H<<32-Ee|J>>>(Ee>>>0)|0,Ut(Re|0),Ee|0)}else{if(S)return x|0&&(f[x>>2]=(H>>>0)%(I>>>0),f[x+4>>2]=0),Re=0,Ee=(H>>>0)/(I>>>0)>>>0,Ut(Re|0),Ee|0;if(!J)return x|0&&(f[x>>2]=0,f[x+4>>2]=(H>>>0)%(D>>>0)),Re=0,Ee=(H>>>0)/(D>>>0)>>>0,Ut(Re|0),Ee|0;if(S=D-1|0,!(S&D))return x|0&&(f[x>>2]=d|0,f[x+4>>2]=S&H|A&0),Re=0,Ee=H>>>((N(D|0)|0)>>>0),Ut(Re|0),Ee|0;if(S=(Un(D|0)|0)-(Un(H|0)|0)|0,S>>>0<=30){A=S+1|0,D=31-S|0,I=A,d=H<<D|J>>>(A>>>0),A=H>>>(A>>>0),S=0,D=J<<D;break}return x?(f[x>>2]=d|0,f[x+4>>2]=O|A&0,Re=0,Ee=0,Ut(Re|0),Ee|0):(Re=0,Ee=0,Ut(Re|0),Ee|0)}while(0);if(!I)H=D,O=0,D=0;else{Ae=m|0|0,J=we|_&0,H=P(Ae|0,J|0,-1,-1)|0,m=ge()|0,O=D,D=0;do _=O,O=S>>>31|O<<1,S=D|S<<1,_=d<<1|_>>>31|0,we=d>>>31|A<<1|0,z(H|0,m|0,_|0,we|0)|0,Ee=ge()|0,Re=Ee>>31|((Ee|0)<0?-1:0)<<1,D=Re&1,d=z(_|0,we|0,Re&Ae|0,(((Ee|0)<0?-1:0)>>31|((Ee|0)<0?-1:0)<<1)&J|0)|0,A=ge()|0,I=I-1|0;while(I|0);H=O,O=0}return I=0,x|0&&(f[x>>2]=d,f[x+4>>2]=A),Re=(S|0)>>>31|(H|I)<<1|(I<<1|S>>>31)&0|O,Ee=(S<<1|0)&-2|D,Ut(Re|0),Ee|0}function $(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0;return H=A>>31|((A|0)<0?-1:0)<<1,O=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,S=_>>31|((_|0)<0?-1:0)<<1,x=((_|0)<0?-1:0)>>31|((_|0)<0?-1:0)<<1,D=z(H^d|0,O^A|0,H|0,O|0)|0,I=ge()|0,d=S^H,A=x^O,z((G(D,I,z(S^m|0,x^_|0,S|0,x|0)|0,ge()|0,0)|0)^d|0,(ge()|0)^A|0,d|0,A|0)|0}function K(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return S=d&65535,x=A&65535,m=Xt(x,S)|0,_=d>>>16,d=(m>>>16)+(Xt(x,_)|0)|0,x=A>>>16,A=Xt(x,S)|0,Ut((d>>>16)+(Xt(x,_)|0)+(((d&65535)+A|0)>>>16)|0),d+A<<16|m&65535|0|0}function se(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0;return x=d,S=m,m=K(x,S)|0,d=ge()|0,Ut((Xt(A,S)|0)+(Xt(_,x)|0)+d|d&0|0),m|0|0|0}function ce(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,I=0,D=0,O=0,H=0;return x=de,de=de+16|0,D=x|0,I=A>>31|((A|0)<0?-1:0)<<1,S=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,H=_>>31|((_|0)<0?-1:0)<<1,O=((_|0)<0?-1:0)>>31|((_|0)<0?-1:0)<<1,d=z(I^d|0,S^A|0,I|0,S|0)|0,A=ge()|0,G(d,A,z(H^m|0,O^_|0,H|0,O|0)|0,ge()|0,D)|0,_=z(f[D>>2]^I|0,f[D+4>>2]^S|0,I|0,S|0)|0,m=ge()|0,de=x,Ut(m|0),_|0}function xe(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0;return S=de,de=de+16|0,x=S|0,G(d,A,m,_,x)|0,de=S,Ut(f[x+4>>2]|0),f[x>>2]|0|0}function ve(d,A,m){return d=d|0,A=A|0,m=m|0,(m|0)<32?(Ut(A>>m|0),d>>>m|(A&(1<<m)-1)<<32-m):(Ut(((A|0)<0?-1:0)|0),A>>m-32|0)}function le(d,A,m){return d=d|0,A=A|0,m=m|0,(m|0)<32?(Ut(A>>>m|0),d>>>m|(A&(1<<m)-1)<<32-m):(Ut(0),A>>>m-32|0)}function ye(d,A,m){return d=d|0,A=A|0,m=m|0,(m|0)<32?(Ut(A<<m|(d&(1<<m)-1<<32-m)>>>32-m|0),d<<m):(Ut(d<<m-32|0),0)}function ze(d,A){return d=+d,A=+A,d!=d?+A:A!=A?+d:+Mn(+d,+A)}function Ge(d,A){return d=+d,A=+A,d!=d?+A:A!=A?+d:+yn(+d,+A)}function Se(d){return d=+d,d>=0?+be(d+.5):+Wt(d-.5)}function Ze(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if((m|0)>=8192)return Wo(d|0,A|0,m|0)|0,d|0;if(S=d|0,x=d+m|0,(d&3)==(A&3)){for(;d&3;){if(!m)return S|0;oe[d>>0]=oe[A>>0]|0,d=d+1|0,A=A+1|0,m=m-1|0}for(m=x&-4|0,_=m-64|0;(d|0)<=(_|0);)f[d>>2]=f[A>>2],f[d+4>>2]=f[A+4>>2],f[d+8>>2]=f[A+8>>2],f[d+12>>2]=f[A+12>>2],f[d+16>>2]=f[A+16>>2],f[d+20>>2]=f[A+20>>2],f[d+24>>2]=f[A+24>>2],f[d+28>>2]=f[A+28>>2],f[d+32>>2]=f[A+32>>2],f[d+36>>2]=f[A+36>>2],f[d+40>>2]=f[A+40>>2],f[d+44>>2]=f[A+44>>2],f[d+48>>2]=f[A+48>>2],f[d+52>>2]=f[A+52>>2],f[d+56>>2]=f[A+56>>2],f[d+60>>2]=f[A+60>>2],d=d+64|0,A=A+64|0;for(;(d|0)<(m|0);)f[d>>2]=f[A>>2],d=d+4|0,A=A+4|0}else for(m=x-4|0;(d|0)<(m|0);)oe[d>>0]=oe[A>>0]|0,oe[d+1>>0]=oe[A+1>>0]|0,oe[d+2>>0]=oe[A+2>>0]|0,oe[d+3>>0]=oe[A+3>>0]|0,d=d+4|0,A=A+4|0;for(;(d|0)<(x|0);)oe[d>>0]=oe[A>>0]|0,d=d+1|0,A=A+1|0;return S|0}function je(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,I=0;if(S=d+m|0,A=A&255,(m|0)>=67){for(;d&3;)oe[d>>0]=A,d=d+1|0;for(_=S&-4|0,I=A|A<<8|A<<16|A<<24,x=_-64|0;(d|0)<=(x|0);)f[d>>2]=I,f[d+4>>2]=I,f[d+8>>2]=I,f[d+12>>2]=I,f[d+16>>2]=I,f[d+20>>2]=I,f[d+24>>2]=I,f[d+28>>2]=I,f[d+32>>2]=I,f[d+36>>2]=I,f[d+40>>2]=I,f[d+44>>2]=I,f[d+48>>2]=I,f[d+52>>2]=I,f[d+56>>2]=I,f[d+60>>2]=I,d=d+64|0;for(;(d|0)<(_|0);)f[d>>2]=I,d=d+4|0}for(;(d|0)<(S|0);)oe[d>>0]=A,d=d+1|0;return S-m|0}function tt(d){return d=+d,d>=0?+be(d+.5):+Wt(d-.5)}function Ke(d){d=d|0;var A=0,m=0,_=0;return _=Vn()|0,m=f[Ce>>2]|0,A=m+d|0,(d|0)>0&(A|0)<(m|0)|(A|0)<0?(wa(A|0)|0,Wi(12),-1):(A|0)>(_|0)&&!($o(A|0)|0)?(Wi(12),-1):(f[Ce>>2]=A,m|0)}return{___divdi3:$,___muldi3:se,___remdi3:ce,___uremdi3:xe,_areNeighborCells:Fu,_bitshift64Ashr:ve,_bitshift64Lshr:le,_bitshift64Shl:ye,_calloc:E,_cellAreaKm2:zt,_cellAreaM2:Xu,_cellAreaRads2:ps,_cellToBoundary:La,_cellToCenterChild:ju,_cellToChildPos:Da,_cellToChildren:v0,_cellToChildrenSize:_l,_cellToLatLng:Qs,_cellToLocalIj:j1,_cellToParent:gl,_cellToVertex:Ji,_cellToVertexes:kc,_cellsToDirectedEdge:Nu,_cellsToLinkedMultiPolygon:Mi,_childPosToCell:qu,_compactCells:yc,_destroyLinkedMultiPolygon:Qu,_directedEdgeToBoundary:Al,_directedEdgeToCells:Ma,_edgeLengthKm:Co,_edgeLengthM:bc,_edgeLengthRads:Jo,_emscripten_replace_memory:wo,_free:v,_getBaseCellNumber:ka,_getDirectedEdgeDestination:Xo,_getDirectedEdgeOrigin:y0,_getHexagonAreaAvgKm2:El,_getHexagonAreaAvgM2:wc,_getHexagonEdgeLengthAvgKm:V1,_getHexagonEdgeLengthAvgM:G1,_getIcosahedronFaces:xc,_getNumCells:Ba,_getPentagons:w0,_getRes0Cells:Ac,_getResolution:ml,_greatCircleDistanceKm:bl,_greatCircleDistanceM:So,_greatCircleDistanceRads:zr,_gridDisk:sl,_gridDiskDistances:ks,_gridDistance:Sc,_gridPathCells:Pc,_gridPathCellsSize:Cc,_gridRingUnsafe:pt,_i64Add:P,_i64Subtract:z,_isPentagon:Jn,_isResClassIII:yl,_isValidCell:Qo,_isValidDirectedEdge:Uu,_isValidVertex:er,_latLngToCell:xl,_llvm_maxnum_f64:ze,_llvm_minnum_f64:Ge,_llvm_round_f64:Se,_localIjToCell:Yu,_malloc:p,_maxFaceCount:wl,_maxGridDiskSize:rl,_maxPolygonToCellsSize:Nt,_memcpy:Ze,_memset:je,_originToDirectedEdges:ui,_pentagonCount:$u,_polygonToCells:pi,_readInt64AsDoubleFromPointer:eh,_res0CellCount:fc,_round:tt,_sbrk:Ke,_sizeOfCellBoundary:Ju,_sizeOfCoordIJ:T0,_sizeOfGeoLoop:Zr,_sizeOfGeoPolygon:fi,_sizeOfH3Index:Mc,_sizeOfLatLng:Tl,_sizeOfLinkedGeoPolygon:Sl,_uncompactCells:Hu,_uncompactCellsSize:Yo,_vertexToLatLng:Po,establishStackSpace:Ta,stackAlloc:fs,stackRestore:Ea,stackSave:ba}}(hs,cn,lt);e.___divdi3=At.___divdi3,e.___muldi3=At.___muldi3,e.___remdi3=At.___remdi3,e.___uremdi3=At.___uremdi3,e._areNeighborCells=At._areNeighborCells,e._bitshift64Ashr=At._bitshift64Ashr,e._bitshift64Lshr=At._bitshift64Lshr,e._bitshift64Shl=At._bitshift64Shl,e._calloc=At._calloc,e._cellAreaKm2=At._cellAreaKm2,e._cellAreaM2=At._cellAreaM2,e._cellAreaRads2=At._cellAreaRads2,e._cellToBoundary=At._cellToBoundary,e._cellToCenterChild=At._cellToCenterChild,e._cellToChildPos=At._cellToChildPos,e._cellToChildren=At._cellToChildren,e._cellToChildrenSize=At._cellToChildrenSize,e._cellToLatLng=At._cellToLatLng,e._cellToLocalIj=At._cellToLocalIj,e._cellToParent=At._cellToParent,e._cellToVertex=At._cellToVertex,e._cellToVertexes=At._cellToVertexes,e._cellsToDirectedEdge=At._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=At._cellsToLinkedMultiPolygon,e._childPosToCell=At._childPosToCell,e._compactCells=At._compactCells,e._destroyLinkedMultiPolygon=At._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=At._directedEdgeToBoundary,e._directedEdgeToCells=At._directedEdgeToCells,e._edgeLengthKm=At._edgeLengthKm,e._edgeLengthM=At._edgeLengthM,e._edgeLengthRads=At._edgeLengthRads;var Ri=e._emscripten_replace_memory=At._emscripten_replace_memory;e._free=At._free,e._getBaseCellNumber=At._getBaseCellNumber,e._getDirectedEdgeDestination=At._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=At._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=At._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=At._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=At._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=At._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=At._getIcosahedronFaces,e._getNumCells=At._getNumCells,e._getPentagons=At._getPentagons,e._getRes0Cells=At._getRes0Cells,e._getResolution=At._getResolution,e._greatCircleDistanceKm=At._greatCircleDistanceKm,e._greatCircleDistanceM=At._greatCircleDistanceM,e._greatCircleDistanceRads=At._greatCircleDistanceRads,e._gridDisk=At._gridDisk,e._gridDiskDistances=At._gridDiskDistances,e._gridDistance=At._gridDistance,e._gridPathCells=At._gridPathCells,e._gridPathCellsSize=At._gridPathCellsSize,e._gridRingUnsafe=At._gridRingUnsafe,e._i64Add=At._i64Add,e._i64Subtract=At._i64Subtract,e._isPentagon=At._isPentagon,e._isResClassIII=At._isResClassIII,e._isValidCell=At._isValidCell,e._isValidDirectedEdge=At._isValidDirectedEdge,e._isValidVertex=At._isValidVertex,e._latLngToCell=At._latLngToCell,e._llvm_maxnum_f64=At._llvm_maxnum_f64,e._llvm_minnum_f64=At._llvm_minnum_f64,e._llvm_round_f64=At._llvm_round_f64,e._localIjToCell=At._localIjToCell,e._malloc=At._malloc,e._maxFaceCount=At._maxFaceCount,e._maxGridDiskSize=At._maxGridDiskSize,e._maxPolygonToCellsSize=At._maxPolygonToCellsSize,e._memcpy=At._memcpy,e._memset=At._memset,e._originToDirectedEdges=At._originToDirectedEdges,e._pentagonCount=At._pentagonCount,e._polygonToCells=At._polygonToCells,e._readInt64AsDoubleFromPointer=At._readInt64AsDoubleFromPointer,e._res0CellCount=At._res0CellCount,e._round=At._round,e._sbrk=At._sbrk,e._sizeOfCellBoundary=At._sizeOfCellBoundary,e._sizeOfCoordIJ=At._sizeOfCoordIJ,e._sizeOfGeoLoop=At._sizeOfGeoLoop,e._sizeOfGeoPolygon=At._sizeOfGeoPolygon,e._sizeOfH3Index=At._sizeOfH3Index,e._sizeOfLatLng=At._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=At._sizeOfLinkedGeoPolygon,e._uncompactCells=At._uncompactCells,e._uncompactCellsSize=At._uncompactCellsSize,e._vertexToLatLng=At._vertexToLatLng,e.establishStackSpace=At.establishStackSpace;var qs=e.stackAlloc=At.stackAlloc,xi=e.stackRestore=At.stackRestore,Hi=e.stackSave=At.stackSave;if(e.asm=At,e.cwrap=re,e.setValue=U,e.getValue=q,Yn){vo(Yn)||(Yn=s(Yn));{kn();var Nn=function(Y){Y.byteLength&&(Y=new Uint8Array(Y)),ht.set(Y,L),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,fr()},Zs=function(){u(Yn,Nn,function(){throw"could not load memory initializer "+Yn})},Dr=Pi(Yn);if(Dr)Nn(Dr.buffer);else if(e.memoryInitializerRequest){var Rr=function(){var Y=e.memoryInitializerRequest,V=Y.response;if(Y.status!==200&&Y.status!==0){var X=Pi(e.memoryInitializerRequestURL);if(X)V=X.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+Y.status+", retrying "+Yn),Zs();return}}Nn(V)};e.memoryInitializerRequest.response?setTimeout(Rr,0):e.memoryInitializerRequest.addEventListener("load",Rr)}else Zs()}}var qr;hr=function Y(){qr||Is(),qr||(hr=Y)};function Is(Y){if(si>0||(On(),si>0))return;function V(){qr||(qr=!0,!te&&(vi(),mt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Yt()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),V()},1)):V()}e.run=Is;function or(Y){throw e.onAbort&&e.onAbort(Y),Y+="",a(Y),y(Y),te=!0,"abort("+Y+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=or,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Is(),t}(typeof go=="object"?go:{}),Dn="number",_n=Dn,If=Dn,wn=Dn,bn=Dn,ns=Dn,tn=Dn,hte=[["sizeOfH3Index",Dn],["sizeOfLatLng",Dn],["sizeOfCellBoundary",Dn],["sizeOfGeoLoop",Dn],["sizeOfGeoPolygon",Dn],["sizeOfLinkedGeoPolygon",Dn],["sizeOfCoordIJ",Dn],["readInt64AsDoubleFromPointer",Dn],["isValidCell",If,[wn,bn]],["latLngToCell",_n,[Dn,Dn,ns,tn]],["cellToLatLng",_n,[wn,bn,tn]],["cellToBoundary",_n,[wn,bn,tn]],["maxGridDiskSize",_n,[Dn,tn]],["gridDisk",_n,[wn,bn,Dn,tn]],["gridDiskDistances",_n,[wn,bn,Dn,tn,tn]],["gridRingUnsafe",_n,[wn,bn,Dn,tn]],["maxPolygonToCellsSize",_n,[tn,ns,Dn,tn]],["polygonToCells",_n,[tn,ns,Dn,tn]],["cellsToLinkedMultiPolygon",_n,[tn,Dn,tn]],["destroyLinkedMultiPolygon",null,[tn]],["compactCells",_n,[tn,tn,Dn,Dn]],["uncompactCells",_n,[tn,Dn,Dn,tn,Dn,ns]],["uncompactCellsSize",_n,[tn,Dn,Dn,ns,tn]],["isPentagon",If,[wn,bn]],["isResClassIII",If,[wn,bn]],["getBaseCellNumber",Dn,[wn,bn]],["getResolution",Dn,[wn,bn]],["maxFaceCount",_n,[wn,bn,tn]],["getIcosahedronFaces",_n,[wn,bn,tn]],["cellToParent",_n,[wn,bn,ns,tn]],["cellToChildren",_n,[wn,bn,ns,tn]],["cellToCenterChild",_n,[wn,bn,ns,tn]],["cellToChildrenSize",_n,[wn,bn,ns,tn]],["cellToChildPos",_n,[wn,bn,ns,tn]],["childPosToCell",_n,[Dn,Dn,wn,bn,ns,tn]],["areNeighborCells",_n,[wn,bn,wn,bn,tn]],["cellsToDirectedEdge",_n,[wn,bn,wn,bn,tn]],["getDirectedEdgeOrigin",_n,[wn,bn,tn]],["getDirectedEdgeDestination",_n,[wn,bn,tn]],["isValidDirectedEdge",If,[wn,bn]],["directedEdgeToCells",_n,[wn,bn,tn]],["originToDirectedEdges",_n,[wn,bn,tn]],["directedEdgeToBoundary",_n,[wn,bn,tn]],["gridDistance",_n,[wn,bn,wn,bn,tn]],["gridPathCells",_n,[wn,bn,wn,bn,tn]],["gridPathCellsSize",_n,[wn,bn,wn,bn,tn]],["cellToLocalIj",_n,[wn,bn,wn,bn,Dn,tn]],["localIjToCell",_n,[wn,bn,tn,Dn,tn]],["getHexagonAreaAvgM2",_n,[ns,tn]],["getHexagonAreaAvgKm2",_n,[ns,tn]],["getHexagonEdgeLengthAvgM",_n,[ns,tn]],["getHexagonEdgeLengthAvgKm",_n,[ns,tn]],["greatCircleDistanceM",Dn,[tn,tn]],["greatCircleDistanceKm",Dn,[tn,tn]],["greatCircleDistanceRads",Dn,[tn,tn]],["cellAreaM2",_n,[wn,bn,tn]],["cellAreaKm2",_n,[wn,bn,tn]],["cellAreaRads2",_n,[wn,bn,tn]],["edgeLengthM",_n,[wn,bn,tn]],["edgeLengthKm",_n,[wn,bn,tn]],["edgeLengthRads",_n,[wn,bn,tn]],["getNumCells",_n,[ns,tn]],["getRes0Cells",_n,[tn]],["res0CellCount",Dn],["getPentagons",_n,[Dn,tn]],["pentagonCount",Dn],["cellToVertex",_n,[wn,bn,Dn,tn]],["cellToVertexes",_n,[wn,bn,tn]],["vertexToLatLng",_n,[wn,bn,tn]],["isValidVertex",If,[wn,bn]]],fte=0,Ate=1,dte=2,pte=3,xP=4,mte=5,gte=6,_te=7,yte=8,vte=9,xte=10,wte=11,bte=12,Ete=13,Tte=14,Ste=15,Hr={};Hr[fte]="Success";Hr[Ate]="The operation failed but a more specific error is not available";Hr[dte]="Argument was outside of acceptable range";Hr[pte]="Latitude or longitude arguments were outside of acceptable range";Hr[xP]="Resolution argument was outside of acceptable range";Hr[mte]="Cell argument was not valid";Hr[gte]="Directed edge argument was not valid";Hr[_te]="Undirected edge argument was not valid";Hr[yte]="Vertex argument was not valid";Hr[vte]="Pentagon distortion was encountered";Hr[xte]="Duplicate input";Hr[wte]="Cell arguments were not neighbors";Hr[bte]="Cell arguments had incompatible resolutions";Hr[Ete]="Memory allocation failed";Hr[Tte]="Bounds of provided memory were insufficient";Hr[Ste]="Mode or flags argument was not valid";var wP=1e3,Cte=1001,Pte=1002,U3={};U3[wP]="Unknown unit";U3[Cte]="Array length out of bounds";U3[Pte]="Got unexpected null value for H3 index";var Mte="Unknown error";function bP(t,e,n){var i=n&&"value"in n,r=new Error((t[e]||Mte)+" (code: "+e+(i?", value: "+n.value:"")+")");return r.code=e,r}function EP(t,e){var n=arguments.length===2?{value:e}:{};return bP(Hr,t,n)}function Ite(t,e){var n=arguments.length===2?{value:e}:{};return bP(U3,t,n)}function n3(t){if(t!==0)throw EP(t)}var Ho={};hte.forEach(function(e){Ho[e[0]]=go.cwrap.apply(go,e)});var fw=16,T1=8;Ho.sizeOfH3Index();var kte=Ho.sizeOfLatLng(),Lte=Ho.sizeOfCellBoundary();Ho.sizeOfGeoPolygon();Ho.sizeOfGeoLoop();Ho.sizeOfLinkedGeoPolygon();Ho.sizeOfCoordIJ();var ic={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Dte(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw EP(xP,t);return t}var Rte=/[^0-9a-fA-F]/;function TP(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||Rte.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),fw),n=parseInt(t.substring(t.length-8),fw);return[n,e]}function zte(t,e){return e===void 0&&(e=0),go.getValue(t+T1*e,"double")}function i3(t){return Nte(go.getValue(t,"double"))}function SP(t){return[i3(t),i3(t+T1)]}function Bte(t){return[i3(t+T1),i3(t)]}function Ote(t,e,n){for(var i=go.getValue(t,"i32"),r=t+T1,s=[],u=e?Bte:SP,a=0;a<i*2;a+=2)s.push(u(r+T1*a));return n&&s.push(s[0]),s}function J8(t){var e=go._malloc(kte),n=TP(t),i=n[0],r=n[1];try{return n3(Ho.cellToLatLng(i,r,e)),SP(e)}finally{go._free(e)}}function Fte(t,e){var n=go._malloc(Lte),i=TP(t),r=i[0],s=i[1];try{return n3(Ho.cellToBoundary(r,s,n)),Ote(n,e,e)}finally{go._free(n)}}function s1(t,e){Dte(t);var n=go._malloc(T1);try{switch(e){case ic.m:n3(Ho.getHexagonEdgeLengthAvgM(t,n));break;case ic.km:n3(Ho.getHexagonEdgeLengthAvgKm(t,n));break;default:throw Ite(wP,e)}return zte(n)}finally{go._free(n)}}function Nte(t){return t*180/Math.PI}function Aw(t,e,n=1){const i=n,[r,s]=J8(t);return e.map(a=>{let y=el(s,a[0],i),w=el(r,a[1],i);return[y,w]})}function Ute(t,[e,n]){let i=Fte(t).map(u=>[u[1],u[0]]),r=Aw(t,i,n),s=Aw(t,i,e);return[r,s]}class po extends ur{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data,resRange:Object.keys(this.props.data).map(e=>parseInt(e))})}renderLayers(){const{hextiles:e}=this.state;if(!e)return;let n=[],i=e[this.props.curRes];return Object.keys(i).forEach(r=>{let s=i[r],u=Ute(r,[this.props.getValue?1-this.props.getValue({properties:s}):this.props.thicknessRange[0],this.props.thicknessRange[1]]);this.props.raised?n.push({polygon:u.map(a=>a.map(([y,w])=>[y,w,this.props.getElevation({properties:s})])),properties:s}):n.push({polygon:u,properties:s})}),[new J2({id:`${this.props.id}SolidHexTileLayer`,data:n,getPolygon:r=>r.polygon,filled:this.props.filled,wireframe:this.props.wireframe,extruded:this.props.extruded,pickable:this.props.pickable,getFillColor:this.props.getFillColor,getElevation:this.props.getElevation,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,opacity:this.props.opacity,updateTriggers:this.props.updateTriggers,extensions:this.props.extensions,transitions:this.props.transitions})]}}po.layerName="SolidHexTileLayer";po.defaultProps={...ur.defaultProps,...J2.defaultProps,thicknessRange:[.7,.9],resolution:0,resRange:[5,5],getValue:void 0};const Mu=10,Vg=il().domain(N6(Object.values(Object.values(G2).slice(-1)[0]).map(t=>t.UnmetDemandBaselineAverage))).range(D1(1,-.001,-1/Mu)),CP=il().domain(N6(Object.values(Object.values(G2).slice(-1)[0]).map(t=>t.DemandBaselineAverage))).range(D1(0,1.001,1/Mu)),Gg=oc().domain(N6(Object.values(Object.values(G2).slice(-1)[0]).map(t=>t.DemandBaselineAverage+t.UnmetDemandBaselineAverage))).range([0,1]).clamp(!0),PP=il().domain([-250,700]).range(D1(0,1.001,1/Mu)),S1=il().domain([-30,30]).range(D1(0,1.001,1/Mu)),eA=t=>ha({col:EF(PP(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),saturation:1.5}),C1=t=>[...ha({col:wF(S1(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),saturation:1}),Math.abs(S1(t)-.5)<1/Mu?0:255],iu=oc().domain([-150,0]).range([1,0]).clamp(!0),r3=oc().domain([0,150]).range([0,1]).clamp(!0),qa=vF().domain([new Date("10/31/1921"),new Date("9/30/2021")]).range([0,1199]).invert,Vte=oc().domain([7,10]).range([0,1]).clamp(!0),MP=t=>[...ha({col:ST(Vg(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),saturation:1}),Vg(t)<1/Mu?0:255],IP=t=>ha({col:SF(CP(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),saturation:1}),kP=t=>[...ha({col:ST(Gg(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),saturation:1}),Gg(t)<1/Mu?0:255],q4=MP(Vg.invertExtent(.5)[0]),Zh=ha({col:IP(CP.invertExtent(.5)[0])});kP(Gg.invert(.5));const dw=ha({col:eA(PP.invertExtent(.5)[0])}),Gte=C1(S1.invertExtent(il().domain([0,1]).range(S1.range())(.75))[0]),jte=C1(S1.invertExtent(il().domain([0,1]).range(S1.range())(.25))[1]),Hte={longitude:-121.046040643251,latitude:37.53320315272563,zoom:7.3252675985610685,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58},Wte={longitude:-120.799348991653,latitude:37.07909824584108,zoom:9.589607161282105,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new O1},pw={longitude:-121.134704643101,latitude:37.71392572292552,zoom:7.714668594935653,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new O1},$te={longitude:-121.724611542995,latitude:38.20436329728941,zoom:8.054386171593723,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new O1},qte={longitude:-121.816103974157,latitude:38.98693235425995,zoom:9.654348182289308,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new O1},Zte={longitude:-121.80183018585,latitude:38.26807071392864,zoom:9.572807132250027,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new O1},Xte={longitude:-120.732027389154,latitude:37.00972667884932,zoom:8.599616427840187,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new O1},Qte=new oC({color:[255,255,255],intensity:1.7}),Yte=new hX({timestamp:Date.UTC(2019,6,1,22),color:[255,255,255],intensity:.8}),Z4={0:"Settlement",1:"Exchange",2:"Project",3:"Non-Project"},ho={0:"bl_h000",1:"CS3_ALT3_2022med_L2020ADV",2:"LTO_BA_EXP1_2022MED"},LP={0:"Scenario 1",1:"Scenario 2",2:"Scenario 3"};function ln(t,e,n){return t>=e&&t<=n}const Kte=new k8({ambientLight:Qte,dirLight:Yte});class DP extends ur{renderLayers(){const{data:e,curRes:n,slide:i,transitioning:r}=this.props;return[new po({id:"AverageDemand",data:e,thicknessRange:[0,1],filled:!0,curRes:n,extruded:!0,getElevation:s=>!r&&(ln(i,9,9)&&s.properties.LandUse[0]==1||ln(i,10,10)&&s.properties.LandUse[0]==2||ln(i,11,11)&&s.properties.LandUse[0]==0)?2e3:0,raised:!1,getFillColor:s=>IP(s.properties.DemandBaselineAverage),visible:ln(i,6,11),opacity:i>=7?1:0,transitions:{opacity:250},pickable:!0}),new po({id:"AverageUnmetDemand",data:e,thicknessRange:[.5,.65],filled:!0,curRes:n,extruded:!0,getElevation:s=>!r&&(ln(i,9,9)&&s.properties.LandUse[0]==1||ln(i,10,10)&&s.properties.LandUse[0]==2||ln(i,11,11)&&s.properties.LandUse[0]==0)?2e3:0,raised:!1,getFillColor:s=>MP(s.properties.UnmetDemandBaselineAverage),visible:ln(i,6,11),opacity:i>=7?1:0,transitions:{opacity:250},pickable:!0})]}}DP.layerName="SlideAverages";class RP extends ur{renderLayers(){const{data:e,curRes:n,slide:i}=this.props;return[new po({id:"GroundwaterAgainLayer",data:e,thicknessRange:[0,1],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:r=>eA(r.properties.GroundwaterAverage),visible:ln(i,12,13),opacity:ln(i,13,13)?.2:0,transitions:{opacity:250},pickable:!0}),new po({id:"DeliveryWaterLayer",data:e,thicknessRange:[.5,.65],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:r=>kP(r.properties.DemandBaselineAverage+r.properties.UnmetDemandBaselineAverage),visible:ln(i,11,13),opacity:ln(i,12,13)?1:0,transitions:{opacity:250},pickable:!0})]}}RP.layerName="SlideDeliveries";const Jte=/^[og]\s*(.+)?/,ene=/^mtllib /,tne=/^usemtl /;class e7{constructor(e){let{index:n,name:i="",mtllib:r,smooth:s,groupStart:u}=e;this.index=n,this.name=i,this.mtllib=r,this.smooth=s,this.groupStart=u,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new e7({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class nne{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);const r=new e7({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:i!==void 0?i.smooth:this.smooth,groupStart:i!==void 0?i.groupEnd:0});return this.materials.push(r),r}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let i=this.materials.length-1;i>=0;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class ine{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new nne(e),this.object.fromDeclaration=n,i&&i.name&&typeof i.clone=="function"){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/3)*3}parseNormalIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/3)*3}parseUVIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/2)*2}addVertex(e,n,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addColor(e,n,i){const r=this.colors,s=this.object.geometry.colors;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addUV(e,n,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[n+0],r[n+1]),s.push(r[i+0],r[i+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,i,r,s,u,a,y,w){const M=this.vertices.length;let R=this.parseVertexIndex(e,M),L=this.parseVertexIndex(n,M),U=this.parseVertexIndex(i,M);if(this.addVertex(R,L,U),r!==void 0&&r!==""){const q=this.uvs.length;R=this.parseUVIndex(r,q),L=this.parseUVIndex(s,q),U=this.parseUVIndex(u,q),this.addUV(R,L,U)}if(a!==void 0&&a!==""){const q=this.normals.length;R=this.parseNormalIndex(a,q),L=a===y?R:this.parseNormalIndex(y,q),U=a===w?R:this.parseNormalIndex(w,q),this.addNormal(R,L,U)}this.colors.length>0&&this.addColor(R,L,U)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const i of e)this.addVertexPoint(this.parseVertexIndex(i,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(const s of e)this.addVertexLine(this.parseVertexIndex(s,i));for(const s of n)this.addUVLine(this.parseUVIndex(s,r))}}function rne(t){const e=new ine;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let i="",r="",s=0,u=[];const a=typeof"".trimLeft=="function";for(let M=0,R=n.length;M<R;M++)if(i=n[M],i=a?i.trimLeft():i.trim(),s=i.length,s!==0&&(r=i.charAt(0),r!=="#"))if(r==="v"){const L=i.split(/\s+/);switch(L[0]){case"v":e.vertices.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])),L.length>=7&&e.colors.push(parseFloat(L[4]),parseFloat(L[5]),parseFloat(L[6]));break;case"vn":e.normals.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3]));break;case"vt":e.uvs.push(parseFloat(L[1]),parseFloat(L[2]));break}}else if(r==="f"){const U=i.substr(1).trim().split(/\s+/),q=[];for(let pe=0,ne=U.length;pe<ne;pe++){const ie=U[pe];if(ie.length>0){const re=ie.split("/");q.push(re)}}const te=q[0];for(let pe=1,ne=q.length-1;pe<ne;pe++){const ie=q[pe],re=q[pe+1];e.addFace(te[0],ie[0],re[0],te[1],ie[1],re[1],te[2],ie[2],re[2])}}else if(r==="l"){const L=i.substring(1).trim().split(" ");let U;const q=[];if(i.indexOf("/")===-1)U=L;else{U=[];for(let te=0,pe=L.length;te<pe;te++){const ne=L[te].split("/");ne[0]!==""&&U.push(ne[0]),ne[1]!==""&&q.push(ne[1])}}e.addLineGeometry(U,q)}else if(r==="p"){const U=i.substr(1).trim().split(" ");e.addPointGeometry(U)}else if((u=Jte.exec(i))!==null){const L=(" "+u[0].substr(1).trim()).substr(1);e.startObject(L)}else if(tne.test(i))e.object.startMaterial(i.substring(7).trim(),e.materialLibraries);else if(ene.test(i))e.materialLibraries.push(i.substring(7).trim());else if(r==="s"){if(u=i.split(" "),u.length>1){const U=u[1].trim().toLowerCase();e.object.smooth=U!=="0"&&U!=="off"}else e.object.smooth=!0;const L=e.object.currentMaterial();L&&(L.smooth=e.object.smooth)}else{if(i==="\0")continue;throw new Error('Unexpected line: "'.concat(i,'"'))}e.finalize();const y=[],w=[];for(const M of e.objects){const{geometry:R}=M;if(R.vertices.length===0)continue;const L={header:{vertexCount:R.vertices.length/3},attributes:{}};switch(R.type){case"Points":L.mode=0;break;case"Line":L.mode=1;break;default:L.mode=4;break}L.attributes.POSITION={value:new Float32Array(R.vertices),size:3},R.normals.length>0&&(L.attributes.NORMAL={value:new Float32Array(R.normals),size:3}),R.colors.length>0&&(L.attributes.COLOR_0={value:new Float32Array(R.colors),size:3}),R.uvs.length>0&&(L.attributes.TEXCOORD_0={value:new Float32Array(R.uvs),size:2}),L.materials=[];for(const U of M.materials){const q={name:U.name,flatShading:!U.smooth};L.materials.push(q),w.push(q)}L.name=M.name,y.push(L)}return{meshes:y,materials:w}}function sne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const r in e)n=n||new Map,r!=="value"&&n.set(r,JSON.stringify(e[r]));const i=[];for(const r in t){const s=t[r],u=one(r,s);i.push(u)}return new qh(i,n)}function one(t,e){const n=new Map;for(const s in e)s!=="value"&&n.set(s,JSON.stringify(e[s]));const i=Xee(e.value);return!("size"in e)||e.size===1?new n2(t,i,!1,n):new n2(t,new Zee(e.size,new n2("value",i)),!1,n)}function mw(t,e){const{meshes:n}=rne(t),i=n.reduce((a,y)=>a+y.header.vertexCount,0),r=ane(n,i),s={vertexCount:i,boundingBox:fP(r)},u=sne(r,{mode:4,boundingBox:s.boundingBox});return{loaderData:{header:{}},schema:u,header:s,mode:4,attributes:r}}function ane(t,e){const n=new Float32Array(e*3);let i,r,s,u=0;for(const y of t){const{POSITION:w,NORMAL:M,COLOR_0:R,TEXCOORD_0:L}=y.attributes;n.set(w.value,u*3),M&&(i=i||new Float32Array(e*3),i.set(M.value,u*3)),R&&(r=r||new Float32Array(e*3),r.set(R.value,u*3)),L&&(s=s||new Float32Array(e*2),s.set(L.value,u*2)),u+=w.value.length/3}const a={};return a.POSITION={value:n,size:3},i&&(a.NORMAL={value:i,size:3}),r&&(a.COLOR_0={value:r,size:3}),s&&(a.TEXCOORD_0={value:s,size:2}),a}const lne="3.4.14",cne={name:"OBJ",id:"obj",module:"obj",version:lne,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:une,options:{obj:{}}};function une(t){return t[0]==="v"}const as={...cne,parse:async(t,e)=>mw(new TextDecoder().decode(t)),parseTextSync:(t,e)=>mw(t)},hne=il().domain([0,1]).range(D1(0,C3.length));class Ns extends ur{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data,resRange:Object.keys(this.props.data).map(e=>parseInt(e))})}renderLayers(){const{hextiles:e,resRange:n}=this.state;if(!e)return;let i=[],r=e[this.props.curRes];const s=s1(this.props.curRes,ic.km)/250*1.75;let u=s1(this.props.curRes,ic.km)/s1(5,ic.km);return Object.keys(r).forEach(a=>{let y=r[a];const[w,M]=J8(a),R=this.props.getValue?hne(this.props.getValue({properties:y})):1;for(let[L,U,q]of this.props.getValue?C3[R]:[[0,0,0]]){let[te,pe]=this.props.offset;i.push({position:[M+L*s+te*s,w+U*s+pe*s,this.props.getElevation({properties:y})+q*1e4],properties:y})}}),[new N1({id:`${this.props.id}IconHexTileLayer`,data:i,getPosition:a=>a.position,mesh:this.props.mesh,texture:this.props.texture,sizeScale:this.props.sizeScale*u,wireframe:this.props.wireframe,material:this.props.material,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,textureParameters:this.props.textureParameters,autoHighlight:this.props.autoHighlight,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,highlightColor:this.props.highlightColor,loaders:this.props.loaders,modelMatrix:this.props.modelMatrix,opacity:this.props.opacity,pickable:this.props.pickable,visible:this.props.visible,wrapLongitude:this.props.wrapLongitude,updateTriggers:this.props.updateTriggers,extensions:this.props.extensions,transitions:this.props.transitions})]}}Ns.layerName="IconHexTileLayer";Ns.defaultProps={...ur.defaultProps,...N1.defaultProps,thicknessRange:[.7,.9],resolution:0,resRange:[5,5],getValue:void 0,getElevation:()=>0,offset:[0,0]};class zP extends ur{renderLayers(){const{data:e,curRes:n,slide:i,counter:r}=this.props;return[new Ns({id:"DemandIcons",data:e,loaders:[as],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,curRes:n,getColor:s=>[255,130,35],getValue:s=>r3(s.properties.DemandBaseline[r]),sizeScale:3e3,visible:i==1,opacity:1,pickable:!0})]}}zP.layerName="SlideDemandIntro";const gw=il().domain([0,1]).range(D1(0,C3.length));class P1 extends ur{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data,resRange:Object.keys(this.props.data).map(e=>parseInt(e)),transitioning:!1,prevGetValueFn:null})}renderLayers(){if(!this.props.visible)return;let{hextiles:e,transitioning:n,prevGetValueFn:i,resRange:r}=this.state;if(i===null?this.setState(Object.assign(this.state,{prevGetValueFn:this.props.getValue})):i!==this.props.getValue&&!n&&(this.setState(Object.assign(this.state,{transitioning:!0})),n=!0,setTimeout(()=>{this.setState(Object.assign(this.state,{transitioning:!1,prevGetValueFn:this.props.getValue}))},300)),!e)return;let s=[],u=e[this.props.curRes];const a=s1(this.props.curRes,ic.km)/250*1.75;let y=s1(this.props.curRes,ic.km)/s1(5,ic.km);return Object.keys(u).forEach(w=>{let M=u[w];const[R,L]=J8(w),U=this.props.getValue?gw(this.props.getValue({properties:M})):1;for(let[q,te,pe]of this.props.getValue?n?$F[gw(i({properties:M}))][U]:C3[U]:[[0,0,0]]){let[ne,ie]=this.props.offset;s.push({position:[L+q*a+ne*a,R+te*a+ie*a,this.props.getElevation({properties:M})+pe*1e4],properties:M})}}),[new N1({id:`${this.props.id}AnimatedIconHexTileLayer`,data:s,getPosition:w=>w.position,mesh:this.props.mesh,texture:this.props.texture,sizeScale:this.props.sizeScale*y,wireframe:this.props.wireframe,material:this.props.material,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,textureParameters:this.props.textureParameters,autoHighlight:this.props.autoHighlight,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,highlightColor:this.props.highlightColor,loaders:this.props.loaders,modelMatrix:this.props.modelMatrix,opacity:this.props.opacity,pickable:this.props.pickable,visible:this.props.visible,wrapLongitude:this.props.wrapLongitude,updateTriggers:this.props.updateTriggers,extensions:this.props.extensions,transitions:this.props.transitions})]}}P1.layerName="AnimatedIconHexTileLayer";P1.defaultProps={...ur.defaultProps,...N1.defaultProps,thicknessRange:[.7,.9],resolution:0,getValue:void 0,getElevation:()=>0,offset:[0,0],transitions:{getPosition:{duration:300,easing:q_.overshoot(2)},getColor:{duration:300,easing:q_.overshoot(2)}}};class BP extends ur{renderLayers(){const{data:e,curRes:n,slide:i,counter:r}=this.props;return[new po({id:"GroundwaterLayer",data:e,thicknessRange:[0,1],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:s=>eA(s.properties.Groundwater[i<=2?r:i<=4?1026:1197]),visible:ln(i,1,6),opacity:i>=2?.2:0,transitions:{opacity:250},pickable:!0}),new P1({id:"UnmetDemandIcons1",data:e,loaders:[as],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,curRes:n,getColor:ln(i,2,3)?s=>[255,130,35]:s=>[255,130,35],getValue:i==2||i==5?s=>0:i==3?s=>r3(s.properties.DemandBaseline[1026]):s=>iu(s.properties.UnmetDemandBaseline[1026]),sizeScale:3e3,visible:ln(i,2,5),opacity:1,pickable:!0}),new P1({id:"UnmetDemandIcons2",data:e,loaders:[as],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,curRes:n,getColor:ln(i,4,5)?s=>[255,130,35]:s=>[255,130,35],getValue:i==4||i==7?s=>0:i==5?s=>r3(s.properties.DemandBaseline[1197]):s=>iu(s.properties.UnmetDemandBaseline[1197]),sizeScale:3e3,visible:ln(i,4,7),opacity:1,pickable:!0})]}}BP.layerName="SlideDemandVsUnmet";class OP extends ur{renderLayers(){const{data:e,curRes:n,slide:i,cycler:r}=this.props;return[new Ns({id:"ScenarioUnmetRandomized",data:e,loaders:[as],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,curRes:n,getColor:s=>[255,130,35],getValue:s=>iu(s.properties.UnmetDemand[ho[r%3]][Math.floor(r/3)*67%1199+1]),sizeScale:3e3,visible:ln(i,21,21),opacity:1,pickable:!0}),new po({id:"DifferenceLayerRandomized",data:e,thicknessRange:[.5,.65],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:s=>C1(s.properties.UnmetDemand[ho[r%3]][Math.floor(r/3)*67%1199+1]-s.properties.UnmetDemandBaseline[Math.floor(r/3)*67%1199+1]),visible:ln(i,20,21),opacity:ln(i,21,21)?1:0,transitions:{opacity:250},pickable:!0})]}}OP.layerName="SlideEndRandomized";class FP extends ur{renderLayers(){const{data:e,curRes:n,slide:i,transitioning:r}=this.props;return[new Ns({id:"SettlementIconsLayer",data:$l(e,s=>s.LandUse[0]==0),loaders:[as],mesh:"./src/assets/dam.obj",raised:!0,getElevation:s=>!r&&ln(i,11,11)?2e3:0,curRes:n,getColor:s=>[255,127,206],sizeScale:.8*500,visible:ln(i,9,13),opacity:1,pickable:!0}),new Ns({id:"ExhangeIconsLayer",data:$l(e,s=>s.LandUse[0]==1),loaders:[as],mesh:"./src/assets/cow.obj",raised:!0,getElevation:s=>!r&&ln(i,9,9)?2e3:0,curRes:n,getColor:s=>[255,127,206],sizeScale:.8*550,visible:ln(i,9,13),opacity:1,pickable:!0}),new Ns({id:"ProjectIconsLayer",data:$l(e,s=>s.LandUse[0]==2),loaders:[as],mesh:"./src/assets/project.obj",raised:!0,getElevation:s=>!r&&ln(i,10,10)?2e3:0,curRes:n,getColor:s=>[255,127,206],sizeScale:.8*180,visible:ln(i,9,13),opacity:1,pickable:!0}),new Ns({id:"NonProjectIconsLayer",data:$l(e,s=>s.LandUse[0]==3),loaders:[as],mesh:"./src/assets/nonproject.obj",raised:!0,getElevation:s=>0,curRes:n,getColor:s=>[255,127,206],sizeScale:.8*140,visible:ln(i,9,13),opacity:1,pickable:!0})]}}FP.layerName="SlideOwners";class NP extends ur{renderLayers(){const{data:e,curRes:n,slide:i,curScenario:r,cycler:s}=this.props;return[new po({id:"GroundwaterAgainTimed",data:e,thicknessRange:[0,1],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:u=>eA(u.properties.Groundwater[ln(i,13,19)?1026:i==20?1197:Math.floor(s/3)*67%1199+1]),visible:ln(i,13,21),opacity:ln(i,14,21)?.2:0,transitions:{opacity:250},pickable:!0}),new P1({id:"ScenarioUnmet",data:e,loaders:[as],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,curRes:n,getColor:u=>[255,130,35],getValue:i==13?u=>0:i==14?u=>iu(u.properties.UnmetDemandBaseline[1026]):u=>iu(u.properties.UnmetDemand[ho[r]][1026]),sizeScale:3e3,visible:ln(i,13,19),opacity:1,pickable:!0}),new po({id:"DifferenceLayer",data:e,thicknessRange:[.5,.65],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:u=>C1(u.properties.UnmetDemand[ho[r]][1026]-u.properties.UnmetDemandBaseline[1026]),visible:ln(i,15,19),opacity:ln(i,16,19)?1:0,transitions:{opacity:250},pickable:!0}),new P1({id:"ScenarioUnmet1197",data:e,loaders:[as],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,curRes:n,getColor:u=>[255,130,35],getValue:u=>iu(u.properties.UnmetDemand[ho[s%3]][1197]),sizeScale:3e3,visible:ln(i,20,20),opacity:1,pickable:!0}),new po({id:"DifferenceLayer1197",data:e,thicknessRange:[.5,.65],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:u=>C1(u.properties.UnmetDemand[ho[s%3]][1197]-u.properties.UnmetDemandBaseline[1197]),visible:ln(i,19,20),opacity:ln(i,20,20)?1:0,transitions:{opacity:250},pickable:!0})]}}NP.layerName="SlideScenarioExplanations";class UP extends ur{renderLayers(){return[new Y8({data:"https://services.arcgisonline.com/ArcGIS/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}.png",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:i,east:r,north:s}}=e.tile;return new O8(e,{data:null,image:e.data,bounds:[n,i,r,s]})}})]}}UP.layerName="SlideTerrain";class VP extends ur{renderLayers(){return[new UP(this.props),new zP(this.props),new BP(this.props),new DP(this.props),new FP(this.props),new RP(this.props),new NP(this.props),new OP(this.props)]}}VP.layerName="MartiniSlides";class GP extends ur{renderLayers(){const{data:e,curRes:n,slide:i,curScenario:r,speedyCounter:s,displayGW:u,displayDiff:a,displayUnmet:y,displayDemand:w,displayLandUse:M}=this.props,R=i>=22;return[new po({id:"GroundwaterEpilogue",data:e,thicknessRange:[0,1],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:L=>eA(L.properties.Groundwater[s]),visible:u&&R,opacity:.2,pickable:!0}),new po({id:"DifferenceEpilogue",data:e,thicknessRange:[.5,.65],filled:!0,curRes:n,extruded:!1,raised:!1,getFillColor:L=>C1(L.properties.UnmetDemand[ho[r]][s]-L.properties.UnmetDemandBaseline[s]),visible:a&&R,opacity:1,pickable:!0}),new Ns({id:"ScenarioUnmetEpilogue",data:e,loaders:[as],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,curRes:n,getColor:L=>[255,130,35],getValue:L=>iu(L.properties.UnmetDemand[ho[r]][s]),sizeScale:3e3,visible:y&&R,opacity:1,pickable:!0}),new Ns({id:"ScenarioDemandEpilogue",data:e,loaders:[as],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,curRes:n,getColor:L=>[255,130,35],getValue:L=>r3(L.properties.Demand[ho[r]][s]),sizeScale:3e3,visible:w&&R,opacity:1,pickable:!0}),new Ns({id:"SettlementIconsEpilogue",data:$l(e,L=>L.LandUse[0]==0),loaders:[as],mesh:"./src/assets/dam.obj",raised:!1,curRes:n,getColor:L=>[255,127,206],sizeScale:.8*500,visible:M&&R,opacity:1,pickable:!0}),new Ns({id:"ExhangeIconsEpilogue",data:$l(e,L=>L.LandUse[0]==1),loaders:[as],mesh:"./src/assets/cow.obj",raised:!1,curRes:n,getColor:L=>[255,127,206],sizeScale:.8*550,visible:M&&R,opacity:1,pickable:!0}),new Ns({id:"ProjectIconsEpilogue",data:$l(e,L=>L.LandUse[0]==2),loaders:[as],mesh:"./src/assets/project.obj",raised:!1,curRes:n,getColor:L=>[255,127,206],sizeScale:.8*180,visible:M&&R,opacity:1,pickable:!0}),new Ns({id:"NonProjectIconsEpilogue",data:$l(e,L=>L.LandUse[0]==3),loaders:[as],mesh:"./src/assets/nonproject.obj",raised:!1,curRes:n,getColor:L=>[255,127,206],sizeScale:.8*140,visible:M&&R,opacity:1,pickable:!0})]}}GP.layerName="SlideEpilogue";var jP={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(zI,function(){var n,i,r;function s(a,y){if(!n)n=y;else if(!i)i=y;else{var w="var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk);",M={};n(M),r=y(M),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}s(["exports"],function(a){var y=w;function w(c,o,h,g){this.cx=3*c,this.bx=3*(h-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(g-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=o,this.p2x=h,this.p2y=g}function M(c,o,h,g){const T=new y(c,o,h,g);return function(C){return T.solve(C)}}w.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,o){if(o===void 0&&(o=1e-6),c<0)return 0;if(c>1)return 1;for(var h=c,g=0;g<8;g++){var T=this.sampleCurveX(h)-c;if(Math.abs(T)<o)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=T/C}var k=0,B=1;for(h=c,g=0;g<20&&(T=this.sampleCurveX(h),!(Math.abs(T-c)<o));g++)c>T?k=h:B=h,h=.5*(B-k)+k;return h},solve:function(c,o){return this.sampleCurveY(this.solveCurveX(c,o))}};const R=M(.25,.1,.25,1);function L(c,o,h){return Math.min(h,Math.max(o,c))}function U(c,o,h){const g=h-o,T=((c-o)%g+g)%g+o;return T===o?h:T}function q(c,...o){for(const h of o)for(const g in h)c[g]=h[g];return c}let te=1;function pe(c,o){c.forEach(h=>{o[h]&&(o[h]=o[h].bind(o))})}function ne(c,o,h){const g={};for(const T in c)g[T]=o.call(h||this,c[T],T,c);return g}function ie(c,o,h){const g={};for(const T in c)o.call(h||this,c[T],T,c)&&(g[T]=c[T]);return g}function re(c){return Array.isArray(c)?c.map(re):typeof c=="object"&&c?ne(c,re):c}const _e={};function Te(c){_e[c]||(typeof console<"u"&&console.warn(c),_e[c]=!0)}function De(c,o,h){return(h.y-c.y)*(o.x-c.x)>(o.y-c.y)*(h.x-c.x)}function $e(c){let o=0;for(let h,g,T=0,C=c.length,k=C-1;T<C;k=T++)h=c[T],g=c[k],o+=(g.x-h.x)*(h.y+g.y);return o}function nt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ut(c){const o={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,g,T,C)=>{const k=T||C;return o[g]=!k||k.toLowerCase(),""}),o["max-age"]){const h=parseInt(o["max-age"],10);isNaN(h)?delete o["max-age"]:o["max-age"]=h}return o}let st,lt,Lt=null;function ht(c){if(Lt==null){const o=c.navigator?c.navigator.userAgent:null;Lt=!!c.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Lt}function Tt(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const Pn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(c){const o=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(c,o=0){const h=window.document.createElement("canvas"),g=h.getContext("2d");if(!g)throw new Error("failed to create canvas 2d context");return h.width=c.width,h.height=c.height,g.drawImage(c,0,0,c.width,c.height),g.getImageData(-o,-o,c.width+2*o,c.height+2*o)},resolveURL:c=>(st||(st=document.createElement("a")),st.href=c,st.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(lt==null&&(lt=matchMedia("(prefers-reduced-motion: reduce)")),lt.matches)}};var Ft=Zn;function Zn(c,o){this.x=c,this.y=o}Zn.prototype={clone:function(){return new Zn(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,o){return this.clone()._rotateAround(c,o)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var o=c.x-this.x,h=c.y-this.y;return o*o+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,o){return Math.atan2(this.x*o-this.y*c,this.x*c+this.y*o)},_matMult:function(c){var o=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=o,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var o=Math.cos(c),h=Math.sin(c),g=h*this.x+o*this.y;return this.x=o*this.x-h*this.y,this.y=g,this},_rotateAround:function(c,o){var h=Math.cos(c),g=Math.sin(c),T=o.y+g*(this.x-o.x)+h*(this.y-o.y);return this.x=o.x+h*(this.x-o.x)-g*(this.y-o.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Zn.convert=function(c){return c instanceof Zn?c:Array.isArray(c)?new Zn(c[0],c[1]):c};const yt={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Ot="mapbox-tiles";let Jt,In,Tn=500,Di=50;function di(){typeof caches>"u"||Jt||(Jt=caches.open(Ot))}let ii=1/0;const hi={supported:!1,testSupport:function(c){!mt&&vi&&(Yt?mn(c):On=c)}};let On,vi,mt=!1,Yt=!1;function mn(c){const o=c.createTexture();c.bindTexture(c.TEXTURE_2D,o);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,vi),c.isContextLost())return;hi.supported=!0}catch{}c.deleteTexture(o),mt=!0}typeof document<"u"&&(vi=document.createElement("img"),vi.onload=function(){On&&mn(On),On=null,Yt=!0},vi.onerror=function(){mt=!0,On=null},vi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const dt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(dt);class Fn extends Error{constructor(o,h,g,T){super(`AJAXError: ${h} (${o}): ${g}`),this.status=o,this.statusText=h,this.url=g,this.body=T}}const Rn=nt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function ri(c,o){const h=new AbortController,g=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Rn(),signal:h.signal});let T=!1,C=!1;return c.type==="json"&&g.headers.set("Accept","application/json"),((k,B,F)=>{if(C)return;const j=Date.now();fetch(g).then(Q=>Q.ok?((ee,ae,he)=>{(c.type==="arrayBuffer"?ee.arrayBuffer():c.type==="json"?ee.json():ee.text()).then(fe=>{C||(ae&&he&&function(Le,Pe,Ve){if(di(),!Jt)return;const Qe={status:Pe.status,statusText:Pe.statusText,headers:new Headers};Pe.headers.forEach((qe,at)=>Qe.headers.set(at,qe));const Fe=ut(Pe.headers.get("Cache-Control")||"");Fe["no-store"]||(Fe["max-age"]&&Qe.headers.set("Expires",new Date(Ve+1e3*Fe["max-age"]).toUTCString()),new Date(Qe.headers.get("Expires")).getTime()-Ve<42e4||function(qe,at){if(In===void 0)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?at(qe.body):qe.blob().then(at)}(Pe,qe=>{const at=new Response(qe,Qe);di(),Jt&&Jt.then(ot=>ot.put(function(Bt){const Gt=Bt.indexOf("?");return Gt<0?Bt:Bt.slice(0,Gt)}(Le.url),at)).catch(ot=>Te(ot.message))}))}(g,ae,he),T=!0,o(null,fe,ee.headers.get("Cache-Control"),ee.headers.get("Expires")))}).catch(fe=>{C||o(new Error(fe.message))})})(Q,null,j):Q.blob().then(ee=>o(new Fn(Q.status,Q.statusText,c.url,ee)))).catch(Q=>{Q.code!==20&&o(new Error(Q.message))})})(),{cancel:()=>{C=!0,T||h.abort()}}}const Qn=function(c,o){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){if(nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,o);if(!nt()){const g=c.url.substring(0,c.url.indexOf("://"));return(yt.REGISTERED_PROTOCOLS[g]||ri)(c,o)}}if(!(/^file:/.test(h=c.url)||/^file:/.test(Rn())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ri(c,o);if(nt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,o,void 0,!0)}var h;return function(g,T){const C=new XMLHttpRequest;C.open(g.method||"GET",g.url,!0),g.type==="arrayBuffer"&&(C.responseType="arraybuffer");for(const k in g.headers)C.setRequestHeader(k,g.headers[k]);return g.type==="json"&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials=g.credentials==="include",C.onerror=()=>{T(new Error(C.statusText))},C.onload=()=>{if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let k=C.response;if(g.type==="json")try{k=JSON.parse(C.response)}catch(B){return T(B)}T(null,k,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else{const k=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});T(new Fn(C.status,C.statusText,g.url,k))}},C.send(g.body),{cancel:()=>C.abort()}}(c,o)},si=function(c,o){return Qn(q(c,{type:"arrayBuffer"}),o)};function hr(c){const o=window.document.createElement("a");return o.href=c,o.protocol===window.document.location.protocol&&o.host===window.document.location.host}const kn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fr,Yn;fr=[],Yn=0;const Wr=function(c,o){if(hi.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Yn>=yt.MAX_PARALLEL_IMAGE_REQUESTS){const C={requestParameters:c,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return fr.push(C),C}Yn++;let h=!1;const g=()=>{if(!h)for(h=!0,Yn--;fr.length&&Yn<yt.MAX_PARALLEL_IMAGE_REQUESTS;){const C=fr.shift(),{requestParameters:k,callback:B,cancelled:F}=C;F||(C.cancel=Wr(k,B).cancel)}},T=si(c,(C,k,B,F)=>{g(),C?o(C):k&&function(j,Q){typeof createImageBitmap=="function"?function(ee,ae){const he=new Blob([new Uint8Array(ee)],{type:"image/png"});createImageBitmap(he).then(fe=>{ae(null,fe)}).catch(fe=>{ae(new Error(`Could not load image because of ${fe.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(j,Q):function(ee,ae){const he=new Image;he.onload=()=>{ae(null,he),URL.revokeObjectURL(he.src),he.onload=null,window.requestAnimationFrame(()=>{he.src=kn})},he.onerror=()=>ae(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const fe=new Blob([new Uint8Array(ee)],{type:"image/png"});he.src=ee.byteLength?URL.createObjectURL(fe):kn}(j,Q)}(k,(j,Q)=>{j!=null?o(j):Q!=null&&o(null,Q,{cacheControl:B,expires:F})})});return{cancel:()=>{T.cancel(),g()}}};function vo(c,o,h){h[c]&&h[c].indexOf(o)!==-1||(h[c]=h[c]||[],h[c].push(o))}function rr(c,o,h){if(h&&h[c]){const g=h[c].indexOf(o);g!==-1&&h[c].splice(g,1)}}class Lr{constructor(o,h={}){q(this,h),this.type=o}}class xo extends Lr{constructor(o,h={}){super("error",q({error:o},h))}}class $r{on(o,h){return this._listeners=this._listeners||{},vo(o,h,this._listeners),this}off(o,h){return rr(o,h,this._listeners),rr(o,h,this._oneTimeListeners),this}once(o,h){return this._oneTimeListeners=this._oneTimeListeners||{},vo(o,h,this._oneTimeListeners),this}fire(o,h){typeof o=="string"&&(o=new Lr(o,h||{}));const g=o.type;if(this.listens(g)){o.target=this;const T=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const B of T)B.call(this,o);const C=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const B of C)rr(g,B,this._oneTimeListeners),B.call(this,o);const k=this._eventedParent;k&&(q(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(o))}else o instanceof xo&&console.error(o.error);return this}listens(o){return this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o)}setEventedParent(o,h){return this._eventedParent=o,this._eventedParentData=h,this}}var et={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class xt{constructor(o,h,g,T){this.message=(o?`${o}: `:"")+g,T&&(this.identifier=T),h!=null&&h.__line__&&(this.line=h.__line__)}}function Ms(c){const o=c.value;return o?[new xt(c.key,o,"constants have been deprecated as of v8")]:[]}function sr(c,...o){for(const h of o)for(const g in h)c[g]=h[g];return c}function Sn(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function wr(c){if(Array.isArray(c))return c.map(wr);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const o={};for(const h in c)o[h]=wr(c[h]);return o}return Sn(c)}class Ar extends Error{constructor(o,h){super(h),this.message=h,this.key=o}}class dr{constructor(o,h=[]){this.parent=o,this.bindings={};for(const[g,T]of h)this.bindings[g]=T}concat(o){return new dr(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const us={kind:"null"},wt={kind:"number"},An={kind:"string"},fn={kind:"boolean"},Pi={kind:"color"},hs={kind:"object"},cn={kind:"value"},At={kind:"collator"},Ri={kind:"formatted"},qs={kind:"padding"},xi={kind:"resolvedImage"};function Hi(c,o){return{kind:"array",itemType:c,N:o}}function Nn(c){if(c.kind==="array"){const o=Nn(c.itemType);return typeof c.N=="number"?`array<${o}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${o}>`}return c.kind}const Zs=[us,wt,An,fn,Pi,Ri,hs,Hi(cn),qs,xi];function Dr(c,o){if(o.kind==="error")return null;if(c.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!Dr(c.itemType,o.itemType))&&(typeof c.N!="number"||c.N===o.N))return null}else{if(c.kind===o.kind)return null;if(c.kind==="value"){for(const h of Zs)if(!Dr(h,o))return null}}return`Expected ${Nn(c)} but found ${Nn(o)} instead.`}function Rr(c,o){return o.some(h=>h.kind===c.kind)}function qr(c,o){return o.some(h=>h==="null"?c===null:h==="array"?Array.isArray(c):h==="object"?c&&!Array.isArray(c)&&typeof c=="object":h===typeof c)}var Is,or={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Y(c){return(c=Math.round(c))<0?0:c>255?255:c}function V(c){return Y(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function X(c){return(o=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:o>1?1:o;var o}function oe(c,o,h){return h<0?h+=1:h>1&&(h-=1),6*h<1?c+(o-c)*h*6:2*h<1?o:3*h<2?c+(o-c)*(2/3-h)*6:c}try{Is={}.parseCSSColor=function(c){var o,h=c.replace(/ /g,"").toLowerCase();if(h in or)return or[h].slice();if(h[0]==="#")return h.length===4?(o=parseInt(h.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:h.length===7&&(o=parseInt(h.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var g=h.indexOf("("),T=h.indexOf(")");if(g!==-1&&T+1===h.length){var C=h.substr(0,g),k=h.substr(g+1,T-(g+1)).split(","),B=1;switch(C){case"rgba":if(k.length!==4)return null;B=X(k.pop());case"rgb":return k.length!==3?null:[V(k[0]),V(k[1]),V(k[2]),B];case"hsla":if(k.length!==4)return null;B=X(k.pop());case"hsl":if(k.length!==3)return null;var F=(parseFloat(k[0])%360+360)%360/360,j=X(k[1]),Q=X(k[2]),ee=Q<=.5?Q*(j+1):Q+j-Q*j,ae=2*Q-ee;return[Y(255*oe(ae,ee,F+1/3)),Y(255*oe(ae,ee,F)),Y(255*oe(ae,ee,F-1/3)),B];default:return null}}return null}}catch{}class f{constructor(o,h,g,T=1){this.r=o,this.g=h,this.b=g,this.a=T}static parse(o){if(!o)return;if(o instanceof f)return o;if(typeof o!="string")return;const h=Is(o);return h?new f(h[0]/255*h[3],h[1]/255*h[3],h[2]/255*h[3],h[3]):void 0}toString(){const[o,h,g,T]=this.toArray();return`rgba(${Math.round(o)},${Math.round(h)},${Math.round(g)},${T})`}toArray(){const{r:o,g:h,b:g,a:T}=this;return T===0?[0,0,0,0]:[255*o/T,255*h/T,255*g/T,T]}}f.black=new f(0,0,0,1),f.white=new f(1,1,1,1),f.transparent=new f(0,0,0,0),f.red=new f(1,0,0,1);class W{constructor(o,h,g){this.sensitivity=o?h?"variant":"case":h?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,h){return this.collator.compare(o,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ke{constructor(o,h,g,T,C){this.text=o,this.image=h,this.scale=g,this.fontStack=T,this.textColor=C}}class Ce{constructor(o){this.sections=o}static fromString(o){return new Ce([new ke(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||o.image&&o.image.name.length!==0)}static factory(o){return o instanceof Ce?o:Ce.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}}class be{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof be)return o;if(typeof o=="number")return new be([o,o,o,o]);if(Array.isArray(o)&&!(o.length<1||o.length>4)){for(const h of o)if(typeof h!="number")return;switch(o.length){case 1:o=[o[0],o[0],o[0],o[0]];break;case 2:o=[o[0],o[1],o[0],o[1]];break;case 3:o=[o[0],o[1],o[2],o[1]]}return new be(o)}}toString(){return JSON.stringify(this.values)}}class Me{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Me({name:o,available:!1}):null}}function Ne(c,o,h,g){return typeof c=="number"&&c>=0&&c<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof h=="number"&&h>=0&&h<=255?g===void 0||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[c,o,h,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[c,o,h,g]:[c,o,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function it(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof f||c instanceof W||c instanceof Ce||c instanceof be||c instanceof Me)return!0;if(Array.isArray(c)){for(const o of c)if(!it(o))return!1;return!0}if(typeof c=="object"){for(const o in c)if(!it(c[o]))return!1;return!0}return!1}function Ue(c){if(c===null)return us;if(typeof c=="string")return An;if(typeof c=="boolean")return fn;if(typeof c=="number")return wt;if(c instanceof f)return Pi;if(c instanceof W)return At;if(c instanceof Ce)return Ri;if(c instanceof be)return qs;if(c instanceof Me)return xi;if(Array.isArray(c)){const o=c.length;let h;for(const g of c){const T=Ue(g);if(h){if(h===T)continue;h=cn;break}h=T}return Hi(h||cn,o)}return hs}function ct(c){const o=typeof c;return c===null?"":o==="string"||o==="number"||o==="boolean"?String(c):c instanceof f||c instanceof Ce||c instanceof be||c instanceof Me?c.toString():JSON.stringify(c)}class It{constructor(o,h){this.type=o,this.value=h}static parse(o,h){if(o.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!it(o[1]))return h.error("invalid value");const g=o[1];let T=Ue(g);const C=h.expectedType;return T.kind!=="array"||T.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(T=C),new It(T,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class St{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Zt={string:An,number:wt,boolean:fn,object:hs};class Vt{constructor(o,h){this.type=o,this.args=h}static parse(o,h){if(o.length<2)return h.error("Expected at least one argument.");let g,T=1;const C=o[0];if(C==="array"){let B,F;if(o.length>2){const j=o[1];if(typeof j!="string"||!(j in Zt)||j==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);B=Zt[j],T++}else B=cn;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return h.error('The length argument to "array" must be a positive integer literal',2);F=o[2],T++}g=Hi(B,F)}else{if(!Zt[C])throw new Error(`Types doesn't contain name = ${C}`);g=Zt[C]}const k=[];for(;T<o.length;T++){const B=h.parse(o[T],T,cn);if(!B)return null;k.push(B)}return new Vt(g,k)}evaluate(o){for(let h=0;h<this.args.length;h++){const g=this.args[h].evaluate(o);if(!Dr(this.type,Ue(g)))return g;if(h===this.args.length-1)throw new St(`Expected value to be of type ${Nn(this.type)}, but found ${Nn(Ue(g))} instead.`)}throw new Error}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const sn={"to-boolean":fn,"to-color":Pi,"to-number":wt,"to-string":An};class Wt{constructor(o,h){this.type=o,this.args=h}static parse(o,h){if(o.length<2)return h.error("Expected at least one argument.");const g=o[0];if(!sn[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if((g==="to-boolean"||g==="to-string")&&o.length!==2)return h.error("Expected one argument.");const T=sn[g],C=[];for(let k=1;k<o.length;k++){const B=h.parse(o[k],k,cn);if(!B)return null;C.push(B)}return new Wt(T,C)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let h,g;for(const T of this.args){if(h=T.evaluate(o),g=null,h instanceof f)return h;if(typeof h=="string"){const C=o.parseColor(h);if(C)return C}else if(Array.isArray(h)&&(g=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Ne(h[0],h[1],h[2],h[3]),!g))return new f(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new St(g||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}if(this.type.kind==="padding"){let h;for(const g of this.args){h=g.evaluate(o);const T=be.parse(h);if(T)return T}throw new St(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}if(this.type.kind==="number"){let h=null;for(const g of this.args){if(h=g.evaluate(o),h===null)return 0;const T=Number(h);if(!isNaN(T))return T}throw new St(`Could not convert ${JSON.stringify(h)} to number.`)}return this.type.kind==="formatted"?Ce.fromString(ct(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?Me.fromString(ct(this.args[0].evaluate(o))):ct(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const Xt=["Unknown","Point","LineString","Polygon"];class yn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Xt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(o){let h=this._parseColorCache[o];return h||(h=this._parseColorCache[o]=f.parse(o)),h}}class Mn{constructor(o,h,g,T){this.name=o,this.type=h,this._evaluate=g,this.args=T}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}static parse(o,h){const g=o[0],T=Mn.definitions[g];if(!T)return h.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(T)?T[0]:T.type,k=Array.isArray(T)?[[T[1],T[2]]]:T.overloads,B=k.filter(([j])=>!Array.isArray(j)||j.length===o.length-1);let F=null;for(const[j,Q]of B){F=new pt(h.registry,h.path,null,h.scope);const ee=[];let ae=!1;for(let he=1;he<o.length;he++){const fe=o[he],Le=Array.isArray(j)?j[he-1]:j.type,Pe=F.parse(fe,1+ee.length,Le);if(!Pe){ae=!0;break}ee.push(Pe)}if(!ae)if(Array.isArray(j)&&j.length!==ee.length)F.error(`Expected ${j.length} arguments, but found ${ee.length} instead.`);else{for(let he=0;he<ee.length;he++){const fe=Array.isArray(j)?j[he]:j.type,Le=ee[he];F.concat(he+1).checkSubtype(fe,Le.type)}if(F.errors.length===0)return new Mn(g,C,Q,ee)}}if(B.length===1)h.errors.push(...F.errors);else{const j=(B.length?B:k).map(([ee])=>{return ae=ee,Array.isArray(ae)?`(${ae.map(Nn).join(", ")})`:`(${Nn(ae.type)}...)`;var ae}).join(" | "),Q=[];for(let ee=1;ee<o.length;ee++){const ae=h.parse(o[ee],1+Q.length);if(!ae)return null;Q.push(Nn(ae.type))}h.error(`Expected arguments of type ${j}, but found (${Q.join(", ")}) instead.`)}return null}static register(o,h){Mn.definitions=h;for(const g in h)o[g]=Mn}}class Un{constructor(o,h,g){this.type=At,this.locale=g,this.caseSensitive=o,this.diacriticSensitive=h}static parse(o,h){if(o.length!==2)return h.error("Expected one argument.");const g=o[1];if(typeof g!="object"||Array.isArray(g))return h.error("Collator options argument must be an object.");const T=h.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,fn);if(!T)return null;const C=h.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,fn);if(!C)return null;let k=null;return g.locale&&(k=h.parse(g.locale,1,An),!k)?null:new Un(T,C,k)}evaluate(o){return new W(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}}const Ut=8192;function ge(c,o){c[0]=Math.min(c[0],o[0]),c[1]=Math.min(c[1],o[1]),c[2]=Math.max(c[2],o[0]),c[3]=Math.max(c[3],o[1])}function en(c,o){return!(c[0]<=o[0]||c[2]>=o[2]||c[1]<=o[1]||c[3]>=o[3])}function Wi(c,o){const h=(180+c[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,T=Math.pow(2,o.z);return[Math.round(h*T*Ut),Math.round(g*T*Ut)]}function Vn(c,o,h){const g=c[0]-o[0],T=c[1]-o[1],C=c[0]-h[0],k=c[1]-h[1];return g*k-C*T==0&&g*C<=0&&T*k<=0}function Wo(c,o){let h=!1;for(let k=0,B=o.length;k<B;k++){const F=o[k];for(let j=0,Q=F.length;j<Q-1;j++){if(Vn(c,F[j],F[j+1]))return!1;(T=F[j])[1]>(g=c)[1]!=(C=F[j+1])[1]>g[1]&&g[0]<(C[0]-T[0])*(g[1]-T[1])/(C[1]-T[1])+T[0]&&(h=!h)}}var g,T,C;return h}function $o(c,o){for(let h=0;h<o.length;h++)if(Wo(c,o[h]))return!0;return!1}function wa(c,o,h,g){const T=g[0]-h[0],C=g[1]-h[1],k=(c[0]-h[0])*C-T*(c[1]-h[1]),B=(o[0]-h[0])*C-T*(o[1]-h[1]);return k>0&&B<0||k<0&&B>0}function de(c,o,h){for(const j of h)for(let Q=0;Q<j.length-1;++Q)if((B=[(k=j[Q+1])[0]-(C=j[Q])[0],k[1]-C[1]])[0]*(F=[(T=o)[0]-(g=c)[0],T[1]-g[1]])[1]-B[1]*F[0]!=0&&wa(g,T,C,k)&&wa(C,k,g,T))return!0;var g,T,C,k,B,F;return!1}function wo(c,o){for(let h=0;h<c.length;++h)if(!Wo(c[h],o))return!1;for(let h=0;h<c.length-1;++h)if(de(c[h],c[h+1],o))return!1;return!0}function fs(c,o){for(let h=0;h<o.length;h++)if(wo(c,o[h]))return!0;return!1}function ba(c,o,h){const g=[];for(let T=0;T<c.length;T++){const C=[];for(let k=0;k<c[T].length;k++){const B=Wi(c[T][k],h);ge(o,B),C.push(B)}g.push(C)}return g}function Ea(c,o,h){const g=[];for(let T=0;T<c.length;T++){const C=ba(c[T],o,h);g.push(C)}return g}function Ta(c,o,h,g){if(c[0]<h[0]||c[0]>h[2]){const T=.5*g;let C=c[0]-h[0]>T?-g:h[0]-c[0]>T?g:0;C===0&&(C=c[0]-h[2]>T?-g:h[2]-c[0]>T?g:0),c[0]+=C}ge(o,c)}function rl(c,o,h,g){const T=Math.pow(2,g.z)*Ut,C=[g.x*Ut,g.y*Ut],k=[];for(const B of c)for(const F of B){const j=[F.x+C[0],F.y+C[1]];Ta(j,o,h,T),k.push(j)}return k}function sl(c,o,h,g){const T=Math.pow(2,g.z)*Ut,C=[g.x*Ut,g.y*Ut],k=[];for(const F of c){const j=[];for(const Q of F){const ee=[Q.x+C[0],Q.y+C[1]];ge(o,ee),j.push(ee)}k.push(j)}if(o[2]-o[0]<=T/2){(B=o)[0]=B[1]=1/0,B[2]=B[3]=-1/0;for(const F of k)for(const j of F)Ta(j,o,h,T)}var B;return k}class ks{constructor(o,h){this.type=fn,this.geojson=o,this.geometries=h}static parse(o,h){if(o.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(it(o[1])){const g=o[1];if(g.type==="FeatureCollection")for(let T=0;T<g.features.length;++T){const C=g.features[T].geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new ks(g,g.features[T].geometry)}else if(g.type==="Feature"){const T=g.geometry.type;if(T==="Polygon"||T==="MultiPolygon")return new ks(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new ks(g,g)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(h,g){const T=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(g.type==="Polygon"){const B=ba(g.coordinates,C,k),F=rl(h.geometry(),T,C,k);if(!en(T,C))return!1;for(const j of F)if(!Wo(j,B))return!1}if(g.type==="MultiPolygon"){const B=Ea(g.coordinates,C,k),F=rl(h.geometry(),T,C,k);if(!en(T,C))return!1;for(const j of F)if(!$o(j,B))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(h,g){const T=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(g.type==="Polygon"){const B=ba(g.coordinates,C,k),F=sl(h.geometry(),T,C,k);if(!en(T,C))return!1;for(const j of F)if(!wo(j,B))return!1}if(g.type==="MultiPolygon"){const B=Ea(g.coordinates,C,k),F=sl(h.geometry(),T,C,k);if(!en(T,C))return!1;for(const j of F)if(!fs(j,B))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ue(c){if(c instanceof Mn&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof ks)return!1;let o=!0;return c.eachChild(h=>{o&&!ue(h)&&(o=!1)}),o}function me(c){if(c instanceof Mn&&c.name==="feature-state")return!1;let o=!0;return c.eachChild(h=>{o&&!me(h)&&(o=!1)}),o}function Ie(c,o){if(c instanceof Mn&&o.indexOf(c.name)>=0)return!1;let h=!0;return c.eachChild(g=>{h&&!Ie(g,o)&&(h=!1)}),h}class Xe{constructor(o,h){this.type=h.type,this.name=o,this.boundExpression=h}static parse(o,h){if(o.length!==2||typeof o[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const g=o[1];return h.scope.has(g)?new Xe(g,h.scope.get(g)):h.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}}class pt{constructor(o,h=[],g,T=new dr,C=[]){this.registry=o,this.path=h,this.key=h.map(k=>`[${k}]`).join(""),this.scope=T,this.errors=C,this.expectedType=g}parse(o,h,g,T,C={}){return h?this.concat(h,g,T)._parse(o,C):this._parse(o,C)}_parse(o,h){function g(T,C,k){return k==="assert"?new Vt(C,[T]):k==="coerce"?new Wt(C,[T]):T}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const T=o[0];if(typeof T!="string")return this.error(`Expression name must be a string, but found ${typeof T} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[T];if(C){let k=C.parse(o,this);if(!k)return null;if(this.expectedType){const B=this.expectedType,F=k.type;if(B.kind!=="string"&&B.kind!=="number"&&B.kind!=="boolean"&&B.kind!=="object"&&B.kind!=="array"||F.kind!=="value")if(B.kind!=="color"&&B.kind!=="formatted"&&B.kind!=="resolvedImage"||F.kind!=="value"&&F.kind!=="string")if(B.kind!=="padding"||F.kind!=="value"&&F.kind!=="number"&&F.kind!=="array"){if(this.checkSubtype(B,F))return null}else k=g(k,B,h.typeAnnotation||"coerce");else k=g(k,B,h.typeAnnotation||"coerce");else k=g(k,B,h.typeAnnotation||"assert")}if(!(k instanceof It)&&k.type.kind!=="resolvedImage"&&Nt(k)){const B=new yn;try{k=new It(k.type,k.evaluate(B))}catch(F){return this.error(F.message),null}}return k}return this.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,h,g){const T=typeof o=="number"?this.path.concat(o):this.path,C=g?this.scope.concat(g):this.scope;return new pt(this.registry,T,h||null,C,this.errors)}error(o,...h){const g=`${this.key}${h.map(T=>`[${T}]`).join("")}`;this.errors.push(new Ar(g,o))}checkSubtype(o,h){const g=Dr(o,h);return g&&this.error(g),g}}function Nt(c){if(c instanceof Xe)return Nt(c.boundExpression);if(c instanceof Mn&&c.name==="error"||c instanceof Un||c instanceof ks)return!1;const o=c instanceof Wt||c instanceof Vt;let h=!0;return c.eachChild(g=>{h=o?h&&Nt(g):h&&g instanceof It}),!!h&&ue(c)&&Ie(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function vn(c,o){const h=c.length-1;let g,T,C=0,k=h,B=0;for(;C<=k;)if(B=Math.floor((C+k)/2),g=c[B],T=c[B+1],g<=o){if(B===h||o<T)return B;C=B+1}else{if(!(g>o))throw new St("Input is not a number.");k=B-1}return 0}class pi{constructor(o,h,g){this.type=o,this.input=h,this.labels=[],this.outputs=[];for(const[T,C]of g)this.labels.push(T),this.outputs.push(C)}static parse(o,h){if(o.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return h.error("Expected an even number of arguments.");const g=h.parse(o[1],1,wt);if(!g)return null;const T=[];let C=null;h.expectedType&&h.expectedType.kind!=="value"&&(C=h.expectedType);for(let k=1;k<o.length;k+=2){const B=k===1?-1/0:o[k],F=o[k+1],j=k,Q=k+1;if(typeof B!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(T.length&&T[T.length-1][0]>=B)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const ee=h.parse(F,Q,C);if(!ee)return null;C=C||ee.type,T.push([B,ee])}return new pi(C,g,T)}evaluate(o){const h=this.labels,g=this.outputs;if(h.length===1)return g[0].evaluate(o);const T=this.input.evaluate(o);if(T<=h[0])return g[0].evaluate(o);const C=h.length;return T>=h[C-1]?g[C-1].evaluate(o):g[vn(h,T)].evaluate(o)}eachChild(o){o(this.input);for(const h of this.outputs)o(h)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function xn(c,o,h){return c*(1-h)+o*h}var Mi=Object.freeze({__proto__:null,number:xn,color:function(c,o,h){return new f(xn(c.r,o.r,h),xn(c.g,o.g,h),xn(c.b,o.b,h),xn(c.a,o.a,h))},array:function(c,o,h){return c.map((g,T)=>xn(g,o[T],h))},padding:function(c,o,h){const g=c.values,T=o.values;return new be([xn(g[0],T[0],h),xn(g[1],T[1],h),xn(g[2],T[2],h),xn(g[3],T[3],h)])}});const zn=.95047,h0=1.08883,f0=4/29,A0=6/29,ku=3*A0*A0,U1=Math.PI/180,Lu=180/Math.PI;function ol(c){return c>.008856451679035631?Math.pow(c,1/3):c/ku+f0}function al(c){return c>A0?c*c*c:ku*(c-f0)}function fc(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Ac(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Gn(c){const o=Ac(c.r),h=Ac(c.g),g=Ac(c.b),T=ol((.4124564*o+.3575761*h+.1804375*g)/zn),C=ol((.2126729*o+.7151522*h+.072175*g)/1);return{l:116*C-16,a:500*(T-C),b:200*(C-ol((.0193339*o+.119192*h+.9503041*g)/h0)),alpha:c.a}}function dc(c){let o=(c.l+16)/116,h=isNaN(c.a)?o:o+c.a/500,g=isNaN(c.b)?o:o-c.b/200;return o=1*al(o),h=zn*al(h),g=h0*al(g),new f(fc(3.2404542*h-1.5371385*o-.4985314*g),fc(-.969266*h+1.8760108*o+.041556*g),fc(.0556434*h-.2040259*o+1.0572252*g),c.alpha)}function Du(c,o,h){const g=o-c;return c+h*(g>180||g<-180?g-360*Math.round(g/360):g)}const ll={forward:Gn,reverse:dc,interpolate:function(c,o,h){return{l:xn(c.l,o.l,h),a:xn(c.a,o.a,h),b:xn(c.b,o.b,h),alpha:xn(c.alpha,o.alpha,h)}}},cl={forward:function(c){const{l:o,a:h,b:g}=Gn(c),T=Math.atan2(g,h)*Lu;return{h:T<0?T+360:T,c:Math.sqrt(h*h+g*g),l:o,alpha:c.a}},reverse:function(c){const o=c.h*U1,h=c.c;return dc({l:c.l,a:Math.cos(o)*h,b:Math.sin(o)*h,alpha:c.alpha})},interpolate:function(c,o,h){return{h:Du(c.h,o.h,h),c:xn(c.c,o.c,h),l:xn(c.l,o.l,h),alpha:xn(c.alpha,o.alpha,h)}}};var Ru=Object.freeze({__proto__:null,lab:ll,hcl:cl});class oi{constructor(o,h,g,T,C){this.type=o,this.operator=h,this.interpolation=g,this.input=T,this.labels=[],this.outputs=[];for(const[k,B]of C)this.labels.push(k),this.outputs.push(B)}static interpolationFactor(o,h,g,T){let C=0;if(o.name==="exponential")C=Xs(h,o.base,g,T);else if(o.name==="linear")C=Xs(h,1,g,T);else if(o.name==="cubic-bezier"){const k=o.controlPoints;C=new y(k[0],k[1],k[2],k[3]).solve(Xs(h,1,g,T))}return C}static parse(o,h){let[g,T,C,...k]=o;if(!Array.isArray(T)||T.length===0)return h.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){const j=T[1];if(typeof j!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:j}}else{if(T[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(T[0])}`,1,0);{const j=T.slice(1);if(j.length!==4||j.some(Q=>typeof Q!="number"||Q<0||Q>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:j}}}if(o.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(C=h.parse(C,2,wt),!C)return null;const B=[];let F=null;g==="interpolate-hcl"||g==="interpolate-lab"?F=Pi:h.expectedType&&h.expectedType.kind!=="value"&&(F=h.expectedType);for(let j=0;j<k.length;j+=2){const Q=k[j],ee=k[j+1],ae=j+3,he=j+4;if(typeof Q!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ae);if(B.length&&B[B.length-1][0]>=Q)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ae);const fe=h.parse(ee,he,F);if(!fe)return null;F=F||fe.type,B.push([Q,fe])}return F.kind==="number"||F.kind==="color"||F.kind==="padding"||F.kind==="array"&&F.itemType.kind==="number"&&typeof F.N=="number"?new oi(F,g,T,C,B):h.error(`Type ${Nn(F)} is not interpolatable.`)}evaluate(o){const h=this.labels,g=this.outputs;if(h.length===1)return g[0].evaluate(o);const T=this.input.evaluate(o);if(T<=h[0])return g[0].evaluate(o);const C=h.length;if(T>=h[C-1])return g[C-1].evaluate(o);const k=vn(h,T),B=oi.interpolationFactor(this.interpolation,T,h[k],h[k+1]),F=g[k].evaluate(o),j=g[k+1].evaluate(o);return this.operator==="interpolate"?Mi[this.type.kind.toLowerCase()](F,j,B):this.operator==="interpolate-hcl"?cl.reverse(cl.interpolate(cl.forward(F),cl.forward(j),B)):ll.reverse(ll.interpolate(ll.forward(F),ll.forward(j),B))}eachChild(o){o(this.input);for(const h of this.outputs)o(h)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function Xs(c,o,h,g){const T=g-h,C=c-h;return T===0?0:o===1?C/T:(Math.pow(o,C)-1)/(Math.pow(o,T)-1)}class $i{constructor(o,h){this.type=o,this.args=h}static parse(o,h){if(o.length<2)return h.error("Expectected at least one argument.");let g=null;const T=h.expectedType;T&&T.kind!=="value"&&(g=T);const C=[];for(const B of o.slice(1)){const F=h.parse(B,1+C.length,g,void 0,{typeAnnotation:"omit"});if(!F)return null;g=g||F.type,C.push(F)}if(!g)throw new Error("No output type");const k=T&&C.some(B=>Dr(T,B.type));return new $i(k?cn:g,C)}evaluate(o){let h,g=null,T=0;for(const C of this.args)if(T++,g=C.evaluate(o),g&&g instanceof Me&&!g.available&&(h||(h=g.name),g=null,T===this.args.length&&(g=h)),g!==null)break;return g}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}class Sa{constructor(o,h){this.type=h.type,this.bindings=[].concat(o),this.result=h}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const h of this.bindings)o(h[1]);o(this.result)}static parse(o,h){if(o.length<4)return h.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const g=[];for(let C=1;C<o.length-1;C+=2){const k=o[C];if(typeof k!="string")return h.error(`Expected string, but found ${typeof k} instead.`,C);if(/[^a-zA-Z0-9_]/.test(k))return h.error("Variable names must contain only alphanumeric characters or '_'.",C);const B=h.parse(o[C+1],C+1);if(!B)return null;g.push([k,B])}const T=h.parse(o[o.length-1],o.length-1,h.expectedType,g);return T?new Sa(g,T):null}outputDefined(){return this.result.outputDefined()}}class d0{constructor(o,h,g){this.type=o,this.index=h,this.input=g}static parse(o,h){if(o.length!==3)return h.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const g=h.parse(o[1],1,wt),T=h.parse(o[2],2,Hi(h.expectedType||cn));return g&&T?new d0(T.type.itemType,g,T):null}evaluate(o){const h=this.index.evaluate(o),g=this.input.evaluate(o);if(h<0)throw new St(`Array index out of bounds: ${h} < 0.`);if(h>=g.length)throw new St(`Array index out of bounds: ${h} > ${g.length-1}.`);if(h!==Math.floor(h))throw new St(`Array index must be an integer, but found ${h} instead.`);return g[h]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}}class Ca{constructor(o,h){this.type=fn,this.needle=o,this.haystack=h}static parse(o,h){if(o.length!==3)return h.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const g=h.parse(o[1],1,cn),T=h.parse(o[2],2,cn);return g&&T?Rr(g.type,[fn,An,wt,us,cn])?new Ca(g,T):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Nn(g.type)} instead`):null}evaluate(o){const h=this.needle.evaluate(o),g=this.haystack.evaluate(o);if(!g)return!1;if(!qr(h,["boolean","string","number","null"]))throw new St(`Expected first argument to be of type boolean, string, number or null, but found ${Nn(Ue(h))} instead.`);if(!qr(g,["string","array"]))throw new St(`Expected second argument to be of type array or string, but found ${Nn(Ue(g))} instead.`);return g.indexOf(h)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}}class p0{constructor(o,h,g){this.type=wt,this.needle=o,this.haystack=h,this.fromIndex=g}static parse(o,h){if(o.length<=2||o.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const g=h.parse(o[1],1,cn),T=h.parse(o[2],2,cn);if(!g||!T)return null;if(!Rr(g.type,[fn,An,wt,us,cn]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Nn(g.type)} instead`);if(o.length===4){const C=h.parse(o[3],3,wt);return C?new p0(g,T,C):null}return new p0(g,T)}evaluate(o){const h=this.needle.evaluate(o),g=this.haystack.evaluate(o);if(!qr(h,["boolean","string","number","null"]))throw new St(`Expected first argument to be of type boolean, string, number or null, but found ${Nn(Ue(h))} instead.`);if(!qr(g,["string","array"]))throw new St(`Expected second argument to be of type array or string, but found ${Nn(Ue(g))} instead.`);if(this.fromIndex){const T=this.fromIndex.evaluate(o);return g.indexOf(h,T)}return g.indexOf(h)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}}class pc{constructor(o,h,g,T,C,k){this.inputType=o,this.type=h,this.input=g,this.cases=T,this.outputs=C,this.otherwise=k}static parse(o,h){if(o.length<5)return h.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return h.error("Expected an even number of arguments.");let g,T;h.expectedType&&h.expectedType.kind!=="value"&&(T=h.expectedType);const C={},k=[];for(let j=2;j<o.length-1;j+=2){let Q=o[j];const ee=o[j+1];Array.isArray(Q)||(Q=[Q]);const ae=h.concat(j);if(Q.length===0)return ae.error("Expected at least one branch label.");for(const fe of Q){if(typeof fe!="number"&&typeof fe!="string")return ae.error("Branch labels must be numbers or strings.");if(typeof fe=="number"&&Math.abs(fe)>Number.MAX_SAFE_INTEGER)return ae.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof fe=="number"&&Math.floor(fe)!==fe)return ae.error("Numeric branch labels must be integer values.");if(g){if(ae.checkSubtype(g,Ue(fe)))return null}else g=Ue(fe);if(C[String(fe)]!==void 0)return ae.error("Branch labels must be unique.");C[String(fe)]=k.length}const he=h.parse(ee,j,T);if(!he)return null;T=T||he.type,k.push(he)}const B=h.parse(o[1],1,cn);if(!B)return null;const F=h.parse(o[o.length-1],o.length-1,T);return F?B.type.kind!=="value"&&h.concat(1).checkSubtype(g,B.type)?null:new pc(g,T,B,C,k,F):null}evaluate(o){const h=this.input.evaluate(o);return(Ue(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}}class mc{constructor(o,h,g){this.type=o,this.branches=h,this.otherwise=g}static parse(o,h){if(o.length<4)return h.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return h.error("Expected an odd number of arguments.");let g;h.expectedType&&h.expectedType.kind!=="value"&&(g=h.expectedType);const T=[];for(let k=1;k<o.length-1;k+=2){const B=h.parse(o[k],k,fn);if(!B)return null;const F=h.parse(o[k+1],k+1,g);if(!F)return null;T.push([B,F]),g=g||F.type}const C=h.parse(o[o.length-1],o.length-1,g);if(!C)return null;if(!g)throw new Error("Can't infer output type");return new mc(g,T,C)}evaluate(o){for(const[h,g]of this.branches)if(h.evaluate(o))return g.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[h,g]of this.branches)o(h),o(g);o(this.otherwise)}outputDefined(){return this.branches.every(([o,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class ul{constructor(o,h,g,T){this.type=o,this.input=h,this.beginIndex=g,this.endIndex=T}static parse(o,h){if(o.length<=2||o.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const g=h.parse(o[1],1,cn),T=h.parse(o[2],2,wt);if(!g||!T)return null;if(!Rr(g.type,[Hi(cn),An,cn]))return h.error(`Expected first argument to be of type array or string, but found ${Nn(g.type)} instead`);if(o.length===4){const C=h.parse(o[3],3,wt);return C?new ul(g.type,g,T,C):null}return new ul(g.type,g,T)}evaluate(o){const h=this.input.evaluate(o),g=this.beginIndex.evaluate(o);if(!qr(h,["string","array"]))throw new St(`Expected first argument to be of type array or string, but found ${Nn(Ue(h))} instead.`);if(this.endIndex){const T=this.endIndex.evaluate(o);return h.slice(g,T)}return h.slice(g)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}}function hl(c,o){return c==="=="||c==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function bo(c,o,h,g){return g.compare(o,h)===0}function qo(c,o,h){const g=c!=="=="&&c!=="!=";return class HP{constructor(C,k,B){this.type=fn,this.lhs=C,this.rhs=k,this.collator=B,this.hasUntypedArgument=C.type.kind==="value"||k.type.kind==="value"}static parse(C,k){if(C.length!==3&&C.length!==4)return k.error("Expected two or three arguments.");const B=C[0];let F=k.parse(C[1],1,cn);if(!F)return null;if(!hl(B,F.type))return k.concat(1).error(`"${B}" comparisons are not supported for type '${Nn(F.type)}'.`);let j=k.parse(C[2],2,cn);if(!j)return null;if(!hl(B,j.type))return k.concat(2).error(`"${B}" comparisons are not supported for type '${Nn(j.type)}'.`);if(F.type.kind!==j.type.kind&&F.type.kind!=="value"&&j.type.kind!=="value")return k.error(`Cannot compare types '${Nn(F.type)}' and '${Nn(j.type)}'.`);g&&(F.type.kind==="value"&&j.type.kind!=="value"?F=new Vt(j.type,[F]):F.type.kind!=="value"&&j.type.kind==="value"&&(j=new Vt(F.type,[j])));let Q=null;if(C.length===4){if(F.type.kind!=="string"&&j.type.kind!=="string"&&F.type.kind!=="value"&&j.type.kind!=="value")return k.error("Cannot use collator to compare non-string types.");if(Q=k.parse(C[3],3,At),!Q)return null}return new HP(F,j,Q)}evaluate(C){const k=this.lhs.evaluate(C),B=this.rhs.evaluate(C);if(g&&this.hasUntypedArgument){const F=Ue(k),j=Ue(B);if(F.kind!==j.kind||F.kind!=="string"&&F.kind!=="number")throw new St(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${F.kind}, ${j.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const F=Ue(k),j=Ue(B);if(F.kind!=="string"||j.kind!=="string")return o(C,k,B)}return this.collator?h(C,k,B,this.collator.evaluate(C)):o(C,k,B)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const zu=qo("==",function(c,o,h){return o===h},bo),m0=qo("!=",function(c,o,h){return o!==h},function(c,o,h,g){return!bo(0,o,h,g)}),Zo=qo("<",function(c,o,h){return o<h},function(c,o,h,g){return g.compare(o,h)<0}),Eo=qo(">",function(c,o,h){return o>h},function(c,o,h,g){return g.compare(o,h)>0}),Bu=qo("<=",function(c,o,h){return o<=h},function(c,o,h,g){return g.compare(o,h)<=0}),Ou=qo(">=",function(c,o,h){return o>=h},function(c,o,h,g){return g.compare(o,h)>=0});class fl{constructor(o,h,g,T,C){this.type=An,this.number=o,this.locale=h,this.currency=g,this.minFractionDigits=T,this.maxFractionDigits=C}static parse(o,h){if(o.length!==3)return h.error("Expected two arguments.");const g=h.parse(o[1],1,wt);if(!g)return null;const T=o[2];if(typeof T!="object"||Array.isArray(T))return h.error("NumberFormat options argument must be an object.");let C=null;if(T.locale&&(C=h.parse(T.locale,1,An),!C))return null;let k=null;if(T.currency&&(k=h.parse(T.currency,1,An),!k))return null;let B=null;if(T["min-fraction-digits"]&&(B=h.parse(T["min-fraction-digits"],1,wt),!B))return null;let F=null;return T["max-fraction-digits"]&&(F=h.parse(T["max-fraction-digits"],1,wt),!F)?null:new fl(g,C,k,B,F)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}}class g0{constructor(o){this.type=Ri,this.sections=o}static parse(o,h){if(o.length<2)return h.error("Expected at least one argument.");const g=o[1];if(!Array.isArray(g)&&typeof g=="object")return h.error("First argument must be an image or text section.");const T=[];let C=!1;for(let k=1;k<=o.length-1;++k){const B=o[k];if(C&&typeof B=="object"&&!Array.isArray(B)){C=!1;let F=null;if(B["font-scale"]&&(F=h.parse(B["font-scale"],1,wt),!F))return null;let j=null;if(B["text-font"]&&(j=h.parse(B["text-font"],1,Hi(An)),!j))return null;let Q=null;if(B["text-color"]&&(Q=h.parse(B["text-color"],1,Pi),!Q))return null;const ee=T[T.length-1];ee.scale=F,ee.font=j,ee.textColor=Q}else{const F=h.parse(o[k],1,cn);if(!F)return null;const j=F.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,T.push({content:F,scale:null,font:null,textColor:null})}}return new g0(T)}evaluate(o){return new Ce(this.sections.map(h=>{const g=h.content.evaluate(o);return Ue(g)===xi?new ke("",g,null,null,null):new ke(ct(g),null,h.scale?h.scale.evaluate(o):null,h.font?h.font.evaluate(o).join(","):null,h.textColor?h.textColor.evaluate(o):null)}))}eachChild(o){for(const h of this.sections)o(h.content),h.scale&&o(h.scale),h.font&&o(h.font),h.textColor&&o(h.textColor)}outputDefined(){return!1}}class gc{constructor(o){this.type=xi,this.input=o}static parse(o,h){if(o.length!==2)return h.error("Expected two arguments.");const g=h.parse(o[1],1,An);return g?new gc(g):h.error("No image name provided.")}evaluate(o){const h=this.input.evaluate(o),g=Me.fromString(h);return g&&o.availableImages&&(g.available=o.availableImages.indexOf(h)>-1),g}eachChild(o){o(this.input)}outputDefined(){return!1}}class _0{constructor(o){this.type=wt,this.input=o}static parse(o,h){if(o.length!==2)return h.error(`Expected 1 argument, but found ${o.length-1} instead.`);const g=h.parse(o[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Nn(g.type)} instead.`):new _0(g):null}evaluate(o){const h=this.input.evaluate(o);if(typeof h=="string"||Array.isArray(h))return h.length;throw new St(`Expected value to be of type string or array, but found ${Nn(Ue(h))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}}const Pa={"==":zu,"!=":m0,">":Eo,"<":Zo,">=":Ou,"<=":Bu,array:Vt,at:d0,boolean:Vt,case:mc,coalesce:$i,collator:Un,format:g0,image:gc,in:Ca,"index-of":p0,interpolate:oi,"interpolate-hcl":oi,"interpolate-lab":oi,length:_0,let:Sa,literal:It,match:pc,number:Vt,"number-format":fl,object:Vt,slice:ul,step:pi,string:Vt,"to-boolean":Wt,"to-color":Wt,"to-number":Wt,"to-string":Wt,var:Xe,within:ks};function Fu(c,[o,h,g,T]){o=o.evaluate(c),h=h.evaluate(c),g=g.evaluate(c);const C=T?T.evaluate(c):1,k=Ne(o,h,g,C);if(k)throw new St(k);return new f(o/255*C,h/255*C,g/255*C,C)}function Nu(c,o){return c in o}function y0(c,o){const h=o[c];return h===void 0?null:h}function Xo(c){return{type:c}}function Uu(c){return{result:"success",value:c}}function Ma(c){return{result:"error",value:c}}function ui(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function Al(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Ln(c){return!!c.expression&&c.expression.interpolated}function Wn(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function li(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Kn(c){return c}function dl(c,o){const h=o.type==="color",g=c.stops&&typeof c.stops[0][0]=="object",T=g||!(g||c.property!==void 0),C=c.type||(Ln(o)?"exponential":"interval");if(h||o.type==="padding"){const j=h?f.parse:be.parse;(c=sr({},c)).stops&&(c.stops=c.stops.map(Q=>[Q[0],j(Q[1])])),c.default=j(c.default?c.default:o.default)}if(c.colorSpace&&c.colorSpace!=="rgb"&&!Ru[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let k,B,F;if(C==="exponential")k=Gu;else if(C==="interval")k=Ia;else if(C==="categorical"){k=Vu,B=Object.create(null);for(const j of c.stops)B[j[0]]=j[1];F=typeof c.stops[0][0]}else{if(C!=="identity")throw new Error(`Unknown function type "${C}"`);k=_c}if(g){const j={},Q=[];for(let he=0;he<c.stops.length;he++){const fe=c.stops[he],Le=fe[0].zoom;j[Le]===void 0&&(j[Le]={zoom:Le,type:c.type,property:c.property,default:c.default,stops:[]},Q.push(Le)),j[Le].stops.push([fe[0].value,fe[1]])}const ee=[];for(const he of Q)ee.push([j[he].zoom,dl(j[he],o)]);const ae={name:"linear"};return{kind:"composite",interpolationType:ae,interpolationFactor:oi.interpolationFactor.bind(void 0,ae),zoomStops:ee.map(he=>he[0]),evaluate:({zoom:he},fe)=>Gu({stops:ee,base:c.base},o,he).evaluate(he,fe)}}if(T){const j=C==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:oi.interpolationFactor.bind(void 0,j),zoomStops:c.stops.map(Q=>Q[0]),evaluate:({zoom:Q})=>k(c,o,Q,B,F)}}return{kind:"source",evaluate(j,Q){const ee=Q&&Q.properties?Q.properties[c.property]:void 0;return ee===void 0?To(c.default,o.default):k(c,o,ee,B,F)}}}function To(c,o,h){return c!==void 0?c:o!==void 0?o:h!==void 0?h:void 0}function Vu(c,o,h,g,T){return To(typeof h===T?g[h]:void 0,c.default,o.default)}function Ia(c,o,h){if(Wn(h)!=="number")return To(c.default,o.default);const g=c.stops.length;if(g===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[g-1][0])return c.stops[g-1][1];const T=vn(c.stops.map(C=>C[0]),h);return c.stops[T][1]}function Gu(c,o,h){const g=c.base!==void 0?c.base:1;if(Wn(h)!=="number")return To(c.default,o.default);const T=c.stops.length;if(T===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[T-1][0])return c.stops[T-1][1];const C=vn(c.stops.map(Q=>Q[0]),h),k=function(Q,ee,ae,he){const fe=he-ae,Le=Q-ae;return fe===0?0:ee===1?Le/fe:(Math.pow(ee,Le)-1)/(Math.pow(ee,fe)-1)}(h,g,c.stops[C][0],c.stops[C+1][0]),B=c.stops[C][1],F=c.stops[C+1][1];let j=Mi[o.type]||Kn;if(c.colorSpace&&c.colorSpace!=="rgb"){const Q=Ru[c.colorSpace];j=(ee,ae)=>Q.reverse(Q.interpolate(Q.forward(ee),Q.forward(ae),k))}return typeof B.evaluate=="function"?{evaluate(...Q){const ee=B.evaluate.apply(void 0,Q),ae=F.evaluate.apply(void 0,Q);if(ee!==void 0&&ae!==void 0)return j(ee,ae,k)}}:j(B,F,k)}function _c(c,o,h){switch(o.type){case"color":h=f.parse(h);break;case"formatted":h=Ce.fromString(h.toString());break;case"resolvedImage":h=Me.fromString(h.toString());break;case"padding":h=be.parse(h);break;default:Wn(h)===o.type||o.type==="enum"&&o.values[h]||(h=void 0)}return To(h,c.default,o.default)}Mn.register(Pa,{error:[{kind:"error"},[An],(c,[o])=>{throw new St(o.evaluate(c))}],typeof:[An,[cn],(c,[o])=>Nn(Ue(o.evaluate(c)))],"to-rgba":[Hi(wt,4),[Pi],(c,[o])=>o.evaluate(c).toArray()],rgb:[Pi,[wt,wt,wt],Fu],rgba:[Pi,[wt,wt,wt,wt],Fu],has:{type:fn,overloads:[[[An],(c,[o])=>Nu(o.evaluate(c),c.properties())],[[An,hs],(c,[o,h])=>Nu(o.evaluate(c),h.evaluate(c))]]},get:{type:cn,overloads:[[[An],(c,[o])=>y0(o.evaluate(c),c.properties())],[[An,hs],(c,[o,h])=>y0(o.evaluate(c),h.evaluate(c))]]},"feature-state":[cn,[An],(c,[o])=>y0(o.evaluate(c),c.featureState||{})],properties:[hs,[],c=>c.properties()],"geometry-type":[An,[],c=>c.geometryType()],id:[cn,[],c=>c.id()],zoom:[wt,[],c=>c.globals.zoom],"heatmap-density":[wt,[],c=>c.globals.heatmapDensity||0],"line-progress":[wt,[],c=>c.globals.lineProgress||0],accumulated:[cn,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[wt,Xo(wt),(c,o)=>{let h=0;for(const g of o)h+=g.evaluate(c);return h}],"*":[wt,Xo(wt),(c,o)=>{let h=1;for(const g of o)h*=g.evaluate(c);return h}],"-":{type:wt,overloads:[[[wt,wt],(c,[o,h])=>o.evaluate(c)-h.evaluate(c)],[[wt],(c,[o])=>-o.evaluate(c)]]},"/":[wt,[wt,wt],(c,[o,h])=>o.evaluate(c)/h.evaluate(c)],"%":[wt,[wt,wt],(c,[o,h])=>o.evaluate(c)%h.evaluate(c)],ln2:[wt,[],()=>Math.LN2],pi:[wt,[],()=>Math.PI],e:[wt,[],()=>Math.E],"^":[wt,[wt,wt],(c,[o,h])=>Math.pow(o.evaluate(c),h.evaluate(c))],sqrt:[wt,[wt],(c,[o])=>Math.sqrt(o.evaluate(c))],log10:[wt,[wt],(c,[o])=>Math.log(o.evaluate(c))/Math.LN10],ln:[wt,[wt],(c,[o])=>Math.log(o.evaluate(c))],log2:[wt,[wt],(c,[o])=>Math.log(o.evaluate(c))/Math.LN2],sin:[wt,[wt],(c,[o])=>Math.sin(o.evaluate(c))],cos:[wt,[wt],(c,[o])=>Math.cos(o.evaluate(c))],tan:[wt,[wt],(c,[o])=>Math.tan(o.evaluate(c))],asin:[wt,[wt],(c,[o])=>Math.asin(o.evaluate(c))],acos:[wt,[wt],(c,[o])=>Math.acos(o.evaluate(c))],atan:[wt,[wt],(c,[o])=>Math.atan(o.evaluate(c))],min:[wt,Xo(wt),(c,o)=>Math.min(...o.map(h=>h.evaluate(c)))],max:[wt,Xo(wt),(c,o)=>Math.max(...o.map(h=>h.evaluate(c)))],abs:[wt,[wt],(c,[o])=>Math.abs(o.evaluate(c))],round:[wt,[wt],(c,[o])=>{const h=o.evaluate(c);return h<0?-Math.round(-h):Math.round(h)}],floor:[wt,[wt],(c,[o])=>Math.floor(o.evaluate(c))],ceil:[wt,[wt],(c,[o])=>Math.ceil(o.evaluate(c))],"filter-==":[fn,[An,cn],(c,[o,h])=>c.properties()[o.value]===h.value],"filter-id-==":[fn,[cn],(c,[o])=>c.id()===o.value],"filter-type-==":[fn,[An],(c,[o])=>c.geometryType()===o.value],"filter-<":[fn,[An,cn],(c,[o,h])=>{const g=c.properties()[o.value],T=h.value;return typeof g==typeof T&&g<T}],"filter-id-<":[fn,[cn],(c,[o])=>{const h=c.id(),g=o.value;return typeof h==typeof g&&h<g}],"filter->":[fn,[An,cn],(c,[o,h])=>{const g=c.properties()[o.value],T=h.value;return typeof g==typeof T&&g>T}],"filter-id->":[fn,[cn],(c,[o])=>{const h=c.id(),g=o.value;return typeof h==typeof g&&h>g}],"filter-<=":[fn,[An,cn],(c,[o,h])=>{const g=c.properties()[o.value],T=h.value;return typeof g==typeof T&&g<=T}],"filter-id-<=":[fn,[cn],(c,[o])=>{const h=c.id(),g=o.value;return typeof h==typeof g&&h<=g}],"filter->=":[fn,[An,cn],(c,[o,h])=>{const g=c.properties()[o.value],T=h.value;return typeof g==typeof T&&g>=T}],"filter-id->=":[fn,[cn],(c,[o])=>{const h=c.id(),g=o.value;return typeof h==typeof g&&h>=g}],"filter-has":[fn,[cn],(c,[o])=>o.value in c.properties()],"filter-has-id":[fn,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[fn,[Hi(An)],(c,[o])=>o.value.indexOf(c.geometryType())>=0],"filter-id-in":[fn,[Hi(cn)],(c,[o])=>o.value.indexOf(c.id())>=0],"filter-in-small":[fn,[An,Hi(cn)],(c,[o,h])=>h.value.indexOf(c.properties()[o.value])>=0],"filter-in-large":[fn,[An,Hi(cn)],(c,[o,h])=>function(g,T,C,k){for(;C<=k;){const B=C+k>>1;if(T[B]===g)return!0;T[B]>g?k=B-1:C=B+1}return!1}(c.properties()[o.value],h.value,0,h.value.length-1)],all:{type:fn,overloads:[[[fn,fn],(c,[o,h])=>o.evaluate(c)&&h.evaluate(c)],[Xo(fn),(c,o)=>{for(const h of o)if(!h.evaluate(c))return!1;return!0}]]},any:{type:fn,overloads:[[[fn,fn],(c,[o,h])=>o.evaluate(c)||h.evaluate(c)],[Xo(fn),(c,o)=>{for(const h of o)if(h.evaluate(c))return!0;return!1}]]},"!":[fn,[fn],(c,[o])=>!o.evaluate(c)],"is-supported-script":[fn,[An],(c,[o])=>{const h=c.globals&&c.globals.isSupportedScript;return!h||h(o.evaluate(c))}],upcase:[An,[An],(c,[o])=>o.evaluate(c).toUpperCase()],downcase:[An,[An],(c,[o])=>o.evaluate(c).toLowerCase()],concat:[An,Xo(cn),(c,o)=>o.map(h=>ct(h.evaluate(c))).join("")],"resolved-locale":[An,[At],(c,[o])=>o.evaluate(c).resolvedLocale()]});class pl{constructor(o,h){this.expression=o,this._warningHistory={},this._evaluator=new yn,this._defaultValue=h?function(g){return g.type==="color"&&li(g.default)?new f(0,0,0,0):g.type==="color"?f.parse(g.default)||null:g.type==="padding"?be.parse(g.default)||null:g.default===void 0?null:g.default}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(o,h,g,T,C,k){return this._evaluator.globals=o,this._evaluator.feature=h,this._evaluator.featureState=g,this._evaluator.canonical=T,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=k,this.expression.evaluate(this._evaluator)}evaluate(o,h,g,T,C,k){this._evaluator.globals=o,this._evaluator.feature=h||null,this._evaluator.featureState=g||null,this._evaluator.canonical=T,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=k||null;try{const B=this.expression.evaluate(this._evaluator);if(B==null||typeof B=="number"&&B!=B)return this._defaultValue;if(this._enumValues&&!(B in this._enumValues))throw new St(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(B)} instead.`);return B}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(B.message)),this._defaultValue}}}function ml(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Pa}function ka(c,o){const h=new pt(Pa,[],o?function(T){const C={color:Pi,string:An,number:wt,enum:An,boolean:fn,formatted:Ri,padding:qs,resolvedImage:xi};return T.type==="array"?Hi(C[T.value]||cn,T.length):C[T.type]}(o):void 0),g=h.parse(c,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?Uu(new pl(g,o)):Ma(h.errors)}class Qo{constructor(o,h){this.kind=o,this._styleExpression=h,this.isStateDependent=o!=="constant"&&!me(h.expression)}evaluateWithoutErrorHandling(o,h,g,T,C,k){return this._styleExpression.evaluateWithoutErrorHandling(o,h,g,T,C,k)}evaluate(o,h,g,T,C,k){return this._styleExpression.evaluate(o,h,g,T,C,k)}}class gl{constructor(o,h,g,T){this.kind=o,this.zoomStops=g,this._styleExpression=h,this.isStateDependent=o!=="camera"&&!me(h.expression),this.interpolationType=T}evaluateWithoutErrorHandling(o,h,g,T,C,k){return this._styleExpression.evaluateWithoutErrorHandling(o,h,g,T,C,k)}evaluate(o,h,g,T,C,k){return this._styleExpression.evaluate(o,h,g,T,C,k)}interpolationFactor(o,h,g){return this.interpolationType?oi.interpolationFactor(this.interpolationType,o,h,g):0}}function _l(c,o){const h=ka(c,o);if(h.result==="error")return h;const g=h.value.expression,T=ue(g);if(!T&&!ui(o))return Ma([new Ar("","data expressions not supported")]);const C=Ie(g,["zoom"]);if(!C&&!Al(o))return Ma([new Ar("","zoom expressions not supported")]);const k=v0(g);return k||C?k instanceof Ar?Ma([k]):k instanceof oi&&!Ln(o)?Ma([new Ar("",'"interpolate" expressions cannot be used with this property')]):Uu(k?new gl(T?"camera":"composite",h.value,k.labels,k instanceof oi?k.interpolation:void 0):new Qo(T?"constant":"source",h.value)):Ma([new Ar("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Jn{constructor(o,h){this._parameters=o,this._specification=h,sr(this,dl(this._parameters,this._specification))}static deserialize(o){return new Jn(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function v0(c){let o=null;if(c instanceof Sa)o=v0(c.result);else if(c instanceof $i){for(const h of c.args)if(o=v0(h),o)break}else(c instanceof pi||c instanceof oi)&&c.input instanceof Mn&&c.input.name==="zoom"&&(o=c);return o instanceof Ar||c.eachChild(h=>{const g=v0(h);g instanceof Ar?o=g:!o&&g?o=new Ar("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&g&&o!==g&&(o=new Ar("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}function As(c){const o=c.key,h=c.value,g=c.valueSpec||{},T=c.objectElementValidators||{},C=c.style,k=c.styleSpec;let B=[];const F=Wn(h);if(F!=="object")return[new xt(o,h,`object expected, ${F} found`)];for(const j in h){const Q=j.split(".")[0],ee=g[Q]||g["*"];let ae;if(T[Q])ae=T[Q];else if(g[Q])ae=zr;else if(T["*"])ae=T["*"];else{if(!g["*"]){B.push(new xt(o,h[j],`unknown property "${j}"`));continue}ae=zr}B=B.concat(ae({key:(o&&`${o}.`)+j,value:h[j],valueSpec:ee,style:C,styleSpec:k,object:h,objectKey:j},h))}for(const j in g)T[j]||g[j].required&&g[j].default===void 0&&h[j]===void 0&&B.push(new xt(o,h,`missing required property "${j}"`));return B}function ju(c){const o=c.value,h=c.valueSpec,g=c.style,T=c.styleSpec,C=c.key,k=c.arrayElementValidator||zr;if(Wn(o)!=="array")return[new xt(C,o,`array expected, ${Wn(o)} found`)];if(h.length&&o.length!==h.length)return[new xt(C,o,`array length ${h.length} expected, length ${o.length} found`)];if(h["min-length"]&&o.length<h["min-length"])return[new xt(C,o,`array length at least ${h["min-length"]} expected, length ${o.length} found`)];let B={type:h.value,values:h.values};T.$version<7&&(B.function=h.function),Wn(h.value)==="object"&&(B=h.value);let F=[];for(let j=0;j<o.length;j++)F=F.concat(k({array:o,arrayIndex:j,value:o[j],valueSpec:B,style:g,styleSpec:T,key:`${C}[${j}]`}));return F}function yc(c){const o=c.key,h=c.value,g=c.valueSpec;let T=Wn(h);return T==="number"&&h!=h&&(T="NaN"),T!=="number"?[new xt(o,h,`number expected, ${T} found`)]:"minimum"in g&&h<g.minimum?[new xt(o,h,`${h} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&h>g.maximum?[new xt(o,h,`${h} is greater than the maximum value ${g.maximum}`)]:[]}function Hu(c){const o=c.valueSpec,h=Sn(c.value.type);let g,T,C,k={};const B=h!=="categorical"&&c.value.property===void 0,F=!B,j=Wn(c.value.stops)==="array"&&Wn(c.value.stops[0])==="array"&&Wn(c.value.stops[0][0])==="object",Q=As({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(he){if(h==="identity")return[new xt(he.key,he.value,'identity function may not have a "stops" property')];let fe=[];const Le=he.value;return fe=fe.concat(ju({key:he.key,value:Le,valueSpec:he.valueSpec,style:he.style,styleSpec:he.styleSpec,arrayElementValidator:ee})),Wn(Le)==="array"&&Le.length===0&&fe.push(new xt(he.key,Le,"array must have at least one stop")),fe},default:function(he){return zr({key:he.key,value:he.value,valueSpec:o,style:he.style,styleSpec:he.styleSpec})}}});return h==="identity"&&B&&Q.push(new xt(c.key,c.value,'missing required property "property"')),h==="identity"||c.value.stops||Q.push(new xt(c.key,c.value,'missing required property "stops"')),h==="exponential"&&c.valueSpec.expression&&!Ln(c.valueSpec)&&Q.push(new xt(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(F&&!ui(c.valueSpec)?Q.push(new xt(c.key,c.value,"property functions not supported")):B&&!Al(c.valueSpec)&&Q.push(new xt(c.key,c.value,"zoom functions not supported"))),h!=="categorical"&&!j||c.value.property!==void 0||Q.push(new xt(c.key,c.value,'"property" property is required')),Q;function ee(he){let fe=[];const Le=he.value,Pe=he.key;if(Wn(Le)!=="array")return[new xt(Pe,Le,`array expected, ${Wn(Le)} found`)];if(Le.length!==2)return[new xt(Pe,Le,`array length 2 expected, length ${Le.length} found`)];if(j){if(Wn(Le[0])!=="object")return[new xt(Pe,Le,`object expected, ${Wn(Le[0])} found`)];if(Le[0].zoom===void 0)return[new xt(Pe,Le,"object stop key must have zoom")];if(Le[0].value===void 0)return[new xt(Pe,Le,"object stop key must have value")];if(C&&C>Sn(Le[0].zoom))return[new xt(Pe,Le[0].zoom,"stop zoom values must appear in ascending order")];Sn(Le[0].zoom)!==C&&(C=Sn(Le[0].zoom),T=void 0,k={}),fe=fe.concat(As({key:`${Pe}[0]`,value:Le[0],valueSpec:{zoom:{}},style:he.style,styleSpec:he.styleSpec,objectElementValidators:{zoom:yc,value:ae}}))}else fe=fe.concat(ae({key:`${Pe}[0]`,value:Le[0],valueSpec:{},style:he.style,styleSpec:he.styleSpec},Le));return ml(wr(Le[1]))?fe.concat([new xt(`${Pe}[1]`,Le[1],"expressions are not allowed in function stops.")]):fe.concat(zr({key:`${Pe}[1]`,value:Le[1],valueSpec:o,style:he.style,styleSpec:he.styleSpec}))}function ae(he,fe){const Le=Wn(he.value),Pe=Sn(he.value),Ve=he.value!==null?he.value:fe;if(g){if(Le!==g)return[new xt(he.key,Ve,`${Le} stop domain type must match previous stop domain type ${g}`)]}else g=Le;if(Le!=="number"&&Le!=="string"&&Le!=="boolean")return[new xt(he.key,Ve,"stop domain value must be a number, string, or boolean")];if(Le!=="number"&&h!=="categorical"){let Qe=`number expected, ${Le} found`;return ui(o)&&h===void 0&&(Qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new xt(he.key,Ve,Qe)]}return h!=="categorical"||Le!=="number"||isFinite(Pe)&&Math.floor(Pe)===Pe?h!=="categorical"&&Le==="number"&&T!==void 0&&Pe<T?[new xt(he.key,Ve,"stop domain values must appear in ascending order")]:(T=Pe,h==="categorical"&&Pe in k?[new xt(he.key,Ve,"stop domain values must be unique")]:(k[Pe]=!0,[])):[new xt(he.key,Ve,`integer expected, found ${Pe}`)]}}function Yo(c){const o=(c.expressionContext==="property"?_l:ka)(wr(c.value),c.valueSpec);if(o.result==="error")return o.value.map(g=>new xt(`${c.key}${g.key}`,c.value,g.message));const h=o.value.expression||o.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!h.outputDefined())return[new xt(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!me(h))return[new xt(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!me(h))return[new xt(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Ie(h,["zoom","feature-state"]))return[new xt(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!ue(h))return[new xt(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function yl(c){const o=c.key,h=c.value,g=c.valueSpec,T=[];return Array.isArray(g.values)?g.values.indexOf(Sn(h))===-1&&T.push(new xt(o,h,`expected one of [${g.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(g.values).indexOf(Sn(h))===-1&&T.push(new xt(o,h,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(h)} found`)),T}function Fi(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const o of c.slice(1))if(!Fi(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}const vc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ls(c){if(c==null)return{filter:()=>!0,needGeometry:!1};Fi(c)||(c=vl(c));const o=ka(c,vc);if(o.result==="error")throw new Error(o.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,g,T)=>o.value.evaluate(h,g,{},T),needGeometry:x0(c)}}function Wu(c,o){return c<o?-1:c>o?1:0}function x0(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let o=1;o<c.length;o++)if(x0(c[o]))return!0;return!1}function vl(c){if(!c)return!0;const o=c[0];return c.length<=1?o!=="any":o==="=="?br(c[1],c[2],"=="):o==="!="?ds(br(c[1],c[2],"==")):o==="<"||o===">"||o==="<="||o===">="?br(c[1],c[2],o):o==="any"?(h=c.slice(1),["any"].concat(h.map(vl))):o==="all"?["all"].concat(c.slice(1).map(vl)):o==="none"?["all"].concat(c.slice(1).map(vl).map(ds)):o==="in"?xl(c[1],c.slice(2)):o==="!in"?ds(xl(c[1],c.slice(2))):o==="has"?Ko(c[1]):o==="!has"?ds(Ko(c[1])):o!=="within"||c;var h}function br(c,o,h){switch(c){case"$type":return[`filter-type-${h}`,o];case"$id":return[`filter-id-${h}`,o];default:return[`filter-${h}`,c,o]}}function xl(c,o){if(o.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(h=>typeof h!=typeof o[0])?["filter-in-large",c,["literal",o.sort(Wu)]]:["filter-in-small",c,["literal",o]]}}function Ko(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function ds(c){return["!",c]}function Qs(c){return Fi(wr(c.value))?Yo(sr({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):La(c)}function La(c){const o=c.value,h=c.key;if(Wn(o)!=="array")return[new xt(h,o,`array expected, ${Wn(o)} found`)];const g=c.styleSpec;let T,C=[];if(o.length<1)return[new xt(h,o,"filter array must have at least 1 element")];switch(C=C.concat(yl({key:`${h}[0]`,value:o[0],valueSpec:g.filter_operator,style:c.style,styleSpec:c.styleSpec})),Sn(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&Sn(o[1])==="$type"&&C.push(new xt(h,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&C.push(new xt(h,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(T=Wn(o[1]),T!=="string"&&C.push(new xt(`${h}[1]`,o[1],`string expected, ${T} found`)));for(let k=2;k<o.length;k++)T=Wn(o[k]),Sn(o[1])==="$type"?C=C.concat(yl({key:`${h}[${k}]`,value:o[k],valueSpec:g.geometry_type,style:c.style,styleSpec:c.styleSpec})):T!=="string"&&T!=="number"&&T!=="boolean"&&C.push(new xt(`${h}[${k}]`,o[k],`string, number, or boolean expected, ${T} found`));break;case"any":case"all":case"none":for(let k=1;k<o.length;k++)C=C.concat(La({key:`${h}[${k}]`,value:o[k],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":T=Wn(o[1]),o.length!==2?C.push(new xt(h,o,`filter array for "${o[0]}" operator must have 2 elements`)):T!=="string"&&C.push(new xt(`${h}[1]`,o[1],`string expected, ${T} found`));break;case"within":T=Wn(o[1]),o.length!==2?C.push(new xt(h,o,`filter array for "${o[0]}" operator must have 2 elements`)):T!=="object"&&C.push(new xt(`${h}[1]`,o[1],`object expected, ${T} found`))}return C}function wl(c,o){const h=c.key,g=c.style,T=c.styleSpec,C=c.value,k=c.objectKey,B=T[`${o}_${c.layerType}`];if(!B)return[];const F=k.match(/^(.*)-transition$/);if(o==="paint"&&F&&B[F[1]]&&B[F[1]].transition)return zr({key:h,value:C,valueSpec:T.transition,style:g,styleSpec:T});const j=c.valueSpec||B[k];if(!j)return[new xt(h,C,`unknown property "${k}"`)];let Q;if(Wn(C)==="string"&&ui(j)&&!j.tokens&&(Q=/^{([^}]+)}$/.exec(C)))return[new xt(h,C,`"${k}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Q[1])} }\`.`)];const ee=[];return c.layerType==="symbol"&&(k==="text-field"&&g&&!g.glyphs&&ee.push(new xt(h,C,'use of "text-field" requires a style "glyphs" property')),k==="text-font"&&li(wr(C))&&Sn(C.type)==="identity"&&ee.push(new xt(h,C,'"text-font" does not support identity functions'))),ee.concat(zr({key:c.key,value:C,valueSpec:j,style:g,styleSpec:T,expressionContext:"property",propertyType:o,propertyKey:k}))}function xc(c){return wl(c,"paint")}function $u(c){return wl(c,"layout")}function w0(c){let o=[];const h=c.value,g=c.key,T=c.style,C=c.styleSpec;h.type||h.ref||o.push(new xt(g,h,'either "type" or "ref" is required'));let k=Sn(h.type);const B=Sn(h.ref);if(h.id){const F=Sn(h.id);for(let j=0;j<c.arrayIndex;j++){const Q=T.layers[j];Sn(Q.id)===F&&o.push(new xt(g,h.id,`duplicate layer id "${h.id}", previously used at line ${Q.id.__line__}`))}}if("ref"in h){let F;["type","source","source-layer","filter","layout"].forEach(j=>{j in h&&o.push(new xt(g,h[j],`"${j}" is prohibited for ref layers`))}),T.layers.forEach(j=>{Sn(j.id)===B&&(F=j)}),F?F.ref?o.push(new xt(g,h.ref,"ref cannot reference another ref layer")):k=Sn(F.type):o.push(new xt(g,h.ref,`ref layer "${B}" not found`))}else if(k!=="background")if(h.source){const F=T.sources&&T.sources[h.source],j=F&&Sn(F.type);F?j==="vector"&&k==="raster"?o.push(new xt(g,h.source,`layer "${h.id}" requires a raster source`)):j==="raster"&&k!=="raster"?o.push(new xt(g,h.source,`layer "${h.id}" requires a vector source`)):j!=="vector"||h["source-layer"]?j==="raster-dem"&&k!=="hillshade"?o.push(new xt(g,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!h.paint||!h.paint["line-gradient"]||j==="geojson"&&F.lineMetrics||o.push(new xt(g,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new xt(g,h,`layer "${h.id}" must specify a "source-layer"`)):o.push(new xt(g,h.source,`source "${h.source}" not found`))}else o.push(new xt(g,h,'missing required property "source"'));return o=o.concat(As({key:g,value:h,valueSpec:C.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>zr({key:`${g}.type`,value:h.type,valueSpec:C.layer.type,style:c.style,styleSpec:c.styleSpec,object:h,objectKey:"type"}),filter:Qs,layout:F=>As({layer:h,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":j=>$u(sr({layerType:k},j))}}),paint:F=>As({layer:h,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":j=>xc(sr({layerType:k},j))}})}})),o}function Da(c){const o=c.value,h=c.key,g=Wn(o);return g!=="string"?[new xt(h,o,`string expected, ${g} found`)]:[]}const qu={promoteId:function({key:c,value:o}){if(Wn(o)==="string")return Da({key:c,value:o});{const h=[];for(const g in o)h.push(...Da({key:`${c}.${g}`,value:o[g]}));return h}}};function Ra(c){const o=c.value,h=c.key,g=c.styleSpec,T=c.style;if(!o.type)return[new xt(h,o,'"type" is required')];const C=Sn(o.type);let k;switch(C){case"vector":case"raster":case"raster-dem":return k=As({key:h,value:o,valueSpec:g[`source_${C.replace("-","_")}`],style:c.style,styleSpec:g,objectElementValidators:qu}),k;case"geojson":if(k=As({key:h,value:o,valueSpec:g.source_geojson,style:T,styleSpec:g,objectElementValidators:qu}),o.cluster)for(const B in o.clusterProperties){const[F,j]=o.clusterProperties[B],Q=typeof F=="string"?[F,["accumulated"],["get",B]]:F;k.push(...Yo({key:`${h}.${B}.map`,value:j,expressionContext:"cluster-map"})),k.push(...Yo({key:`${h}.${B}.reduce`,value:Q,expressionContext:"cluster-reduce"}))}return k;case"video":return As({key:h,value:o,valueSpec:g.source_video,style:T,styleSpec:g});case"image":return As({key:h,value:o,valueSpec:g.source_image,style:T,styleSpec:g});case"canvas":return[new xt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return yl({key:`${h}.type`,value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:T,styleSpec:g})}}function za(c){const o=c.value,h=c.styleSpec,g=h.light,T=c.style;let C=[];const k=Wn(o);if(o===void 0)return C;if(k!=="object")return C=C.concat([new xt("light",o,`object expected, ${k} found`)]),C;for(const B in o){const F=B.match(/^(.*)-transition$/);C=C.concat(F&&g[F[1]]&&g[F[1]].transition?zr({key:B,value:o[B],valueSpec:h.transition,style:T,styleSpec:h}):g[B]?zr({key:B,value:o[B],valueSpec:g[B],style:T,styleSpec:h}):[new xt(B,o[B],`unknown property "${B}"`)])}return C}function Ki(c){const o=c.value,h=c.styleSpec,g=h.terrain,T=c.style;let C=[];const k=Wn(o);if(o===void 0)return C;if(k!=="object")return C=C.concat([new xt("terrain",o,`object expected, ${k} found`)]),C;for(const B in o)C=C.concat(g[B]?zr({key:B,value:o[B],valueSpec:g[B],style:T,styleSpec:h}):[new xt(B,o[B],`unknown property "${B}"`)]);return C}const Ds={"*":()=>[],array:ju,boolean:function(c){const o=c.value,h=c.key,g=Wn(o);return g!=="boolean"?[new xt(h,o,`boolean expected, ${g} found`)]:[]},number:yc,color:function(c){const o=c.key,h=c.value,g=Wn(h);return g!=="string"?[new xt(o,h,`color expected, ${g} found`)]:Is(h)===null?[new xt(o,h,`color expected, "${h}" found`)]:[]},constants:Ms,enum:yl,filter:Qs,function:Hu,layer:w0,object:As,source:Ra,light:za,terrain:Ki,string:Da,formatted:function(c){return Da(c).length===0?[]:Yo(c)},resolvedImage:function(c){return Da(c).length===0?[]:Yo(c)},padding:function(c){const o=c.key,h=c.value;if(Wn(h)==="array"){if(h.length<1||h.length>4)return[new xt(o,h,`padding requires 1 to 4 values; ${h.length} values found`)];const g={type:"number"};let T=[];for(let C=0;C<h.length;C++)T=T.concat(zr({key:`${o}[${C}]`,value:h[C],valueSpec:g}));return T}return yc({key:o,value:h,valueSpec:{}})}};function zr(c){const o=c.value,h=c.valueSpec,g=c.styleSpec;return h.expression&&li(Sn(o))?Hu(c):h.expression&&ml(wr(o))?Yo(c):h.type&&Ds[h.type]?Ds[h.type](c):As(sr({},c,{valueSpec:h.type?g[h.type]:h}))}function bl(c){const o=c.value,h=c.key,g=Da(c);return g.length||(o.indexOf("{fontstack}")===-1&&g.push(new xt(h,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&g.push(new xt(h,o,'"glyphs" url must include a "{range}" token'))),g}function So(c,o=et){let h=[];return h=h.concat(zr({key:"",value:c,valueSpec:o.$root,styleSpec:o,style:c,objectElementValidators:{glyphs:bl,"*":()=>[]}})),c.constants&&(h=h.concat(Ms({key:"constants",value:c.constants,style:c,styleSpec:o}))),Zu(h)}function Zu(c){return[].concat(c).sort((o,h)=>o.line-h.line)}function Ys(c){return function(...o){return Zu(c.apply(this,o))}}So.source=Ys(Ra),So.light=Ys(za),So.terrain=Ys(Ki),So.layer=Ys(w0),So.filter=Ys(Qs),So.paintProperty=Ys(xc),So.layoutProperty=Ys($u);const El=So,wc=El.light,V1=El.paintProperty,G1=El.layoutProperty;function Ba(c,o){let h=!1;if(o&&o.length)for(const g of o)c.fire(new xo(new Error(g.message))),h=!0;return h}class Oa{constructor(o,h,g){const T=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;const k=new Int32Array(this.arrayBuffer);o=k[0],this.d=(h=k[1])+2*(g=k[2]);for(let F=0;F<this.d*this.d;F++){const j=k[3+F],Q=k[3+F+1];T.push(j===Q?null:k.subarray(j,Q))}const B=k[3+T.length+1];this.keys=k.subarray(k[3+T.length],B),this.bboxes=k.subarray(B),this.insert=this._insertReadonly}else{this.d=h+2*g;for(let k=0;k<this.d*this.d;k++)T.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=o,this.padding=g,this.scale=h/o,this.uid=0;const C=g/h*o;this.min=-C,this.max=o+C}insert(o,h,g,T,C){this._forEachCell(h,g,T,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(o),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(T),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(o,h,g,T,C,k){this.cells[C].push(k)}query(o,h,g,T,C){const k=this.min,B=this.max;if(o<=k&&h<=k&&B<=g&&B<=T&&!C)return Array.prototype.slice.call(this.keys);{const F=[];return this._forEachCell(o,h,g,T,this._queryCell,F,{},C),F}}_queryCell(o,h,g,T,C,k,B,F){const j=this.cells[C];if(j!==null){const Q=this.keys,ee=this.bboxes;for(let ae=0;ae<j.length;ae++){const he=j[ae];if(B[he]===void 0){const fe=4*he;(F?F(ee[fe+0],ee[fe+1],ee[fe+2],ee[fe+3]):o<=ee[fe+2]&&h<=ee[fe+3]&&g>=ee[fe+0]&&T>=ee[fe+1])?(B[he]=!0,k.push(Q[he])):B[he]=!1}}}}_forEachCell(o,h,g,T,C,k,B,F){const j=this._convertToCellCoord(o),Q=this._convertToCellCoord(h),ee=this._convertToCellCoord(g),ae=this._convertToCellCoord(T);for(let he=j;he<=ee;he++)for(let fe=Q;fe<=ae;fe++){const Le=this.d*fe+he;if((!F||F(this._convertFromCellCoord(he),this._convertFromCellCoord(fe),this._convertFromCellCoord(he+1),this._convertFromCellCoord(fe+1)))&&C.call(this,o,h,g,T,Le,k,B,F))return}}_convertFromCellCoord(o){return(o-this.padding)/this.scale}_convertToCellCoord(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const o=this.cells,h=3+this.cells.length+1+1;let g=0;for(let k=0;k<this.cells.length;k++)g+=this.cells[k].length;const T=new Int32Array(h+g+this.keys.length+this.bboxes.length);T[0]=this.extent,T[1]=this.n,T[2]=this.padding;let C=h;for(let k=0;k<o.length;k++){const B=o[k];T[3+k]=C,T.set(B,C),C+=B.length}return T[3+o.length]=C,T.set(this.keys,C),C+=this.keys.length,T[3+o.length+1]=C,T.set(this.bboxes,C),C+=this.bboxes.length,T.buffer}static serialize(o,h){const g=o.toArrayBuffer();return h&&h.push(g),{buffer:g}}static deserialize(o){return new Oa(o.buffer)}}const ps={};function zt(c,o,h={}){if(ps[c])throw new Error(`${c} is already registered.`);Object.defineProperty(o,"_classRegistryKey",{value:c,writeable:!1}),ps[c]={klass:o,omit:h.omit||[],shallow:h.shallow||[]}}zt("Object",Object),zt("TransferableGridIndex",Oa),zt("Color",f),zt("Error",Error),zt("AJAXError",Fn),zt("ResolvedImage",Me),zt("StylePropertyFunction",Jn),zt("StyleExpression",pl,{omit:["_evaluator"]}),zt("ZoomDependentExpression",gl),zt("ZoomConstantExpression",Qo),zt("CompoundExpression",Mn,{omit:["_evaluate"]});for(const c in Pa)Pa[c]._classRegistryKey||zt(`Expression_${c}`,Pa[c]);function Xu(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Jo(c,o){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob)return c;if(Xu(c)||Tt(c))return o&&o.push(c),c;if(ArrayBuffer.isView(c)){const h=c;return o&&o.push(h.buffer),h}if(c instanceof ImageData)return o&&o.push(c.data.buffer),c;if(Array.isArray(c)){const h=[];for(const g of c)h.push(Jo(g,o));return h}if(typeof c=="object"){const h=c.constructor,g=h._classRegistryKey;if(!g)throw new Error("can't serialize object of unregistered class");if(!ps[g])throw new Error(`${g} is not registered.`);const T=h.serialize?h.serialize(c,o):{};if(h.serialize){if(o&&T===o[o.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in c){if(!c.hasOwnProperty(C)||ps[g].omit.indexOf(C)>=0)continue;const k=c[C];T[C]=ps[g].shallow.indexOf(C)>=0?k:Jo(k,o)}c instanceof Error&&(T.message=c.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return g!=="Object"&&(T.$name=g),T}throw new Error("can't serialize object of type "+typeof c)}function Co(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||Xu(c)||Tt(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(Co);if(typeof c=="object"){const o=c.$name||"Object";if(!ps[o])throw new Error(`can't deserialize unregistered class ${o}`);const{klass:h}=ps[o];if(!h)throw new Error(`can't deserialize unregistered class ${o}`);if(h.deserialize)return h.deserialize(c);const g=Object.create(h.prototype);for(const T of Object.keys(c)){if(T==="$name")continue;const C=c[T];g[T]=ps[o].shallow.indexOf(T)>=0?C:Co(C)}return g}throw new Error("can't deserialize object of type "+typeof c)}class bc{constructor(){this.first=!0}update(o,h){const g=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=h),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=g,!0))}}const kt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function b0(c){for(const o of c)if(E0(o.charCodeAt(0)))return!0;return!1}function Qu(c){for(const o of c)if(!Ec(o.charCodeAt(0)))return!1;return!0}function Ec(c){return!(kt.Arabic(c)||kt["Arabic Supplement"](c)||kt["Arabic Extended-A"](c)||kt["Arabic Presentation Forms-A"](c)||kt["Arabic Presentation Forms-B"](c))}function E0(c){return!(c!==746&&c!==747&&(c<4352||!(kt["Bopomofo Extended"](c)||kt.Bopomofo(c)||kt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||kt["CJK Compatibility Ideographs"](c)||kt["CJK Compatibility"](c)||kt["CJK Radicals Supplement"](c)||kt["CJK Strokes"](c)||!(!kt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||kt["CJK Unified Ideographs Extension A"](c)||kt["CJK Unified Ideographs"](c)||kt["Enclosed CJK Letters and Months"](c)||kt["Hangul Compatibility Jamo"](c)||kt["Hangul Jamo Extended-A"](c)||kt["Hangul Jamo Extended-B"](c)||kt["Hangul Jamo"](c)||kt["Hangul Syllables"](c)||kt.Hiragana(c)||kt["Ideographic Description Characters"](c)||kt.Kanbun(c)||kt["Kangxi Radicals"](c)||kt["Katakana Phonetic Extensions"](c)||kt.Katakana(c)&&c!==12540||!(!kt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!kt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||kt["Unified Canadian Aboriginal Syllabics"](c)||kt["Unified Canadian Aboriginal Syllabics Extended"](c)||kt["Vertical Forms"](c)||kt["Yijing Hexagram Symbols"](c)||kt["Yi Syllables"](c)||kt["Yi Radicals"](c))))}function Rs(c){return!(E0(c)||function(o){return!!(kt["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||kt["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||kt["Letterlike Symbols"](o)||kt["Number Forms"](o)||kt["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||kt["Control Pictures"](o)&&o!==9251||kt["Optical Character Recognition"](o)||kt["Enclosed Alphanumerics"](o)||kt["Geometric Shapes"](o)||kt["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||kt["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||kt["CJK Symbols and Punctuation"](o)||kt.Katakana(o)||kt["Private Use Area"](o)||kt["CJK Compatibility Forms"](o)||kt["Small Form Variants"](o)||kt["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(c))}function Tc(c){return c>=1424&&c<=2303||kt["Arabic Presentation Forms-A"](c)||kt["Arabic Presentation Forms-B"](c)}function j1(c,o){return!(!o&&Tc(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||kt.Khmer(c))}function Yu(c){for(const o of c)if(Tc(o.charCodeAt(0)))return!0;return!1}const Sc="deferred",Cc="loading",Pc="loaded";let zs=null,pr="unavailable",Ks=null;const Ku=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(pr="error"),zs&&zs(c)};function Fa(){Mc.fire(new Lr("pluginStateChange",{pluginStatus:pr,pluginURL:Ks}))}const Mc=new $r,Tl=function(){return pr},Ju=function(){if(pr!==Sc||!Ks)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");pr=Cc,Fa(),Ks&&si({url:Ks},c=>{c?Ku(c):(pr=Pc,Fa())})},Zr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>pr===Pc||Zr.applyArabicShaping!=null,isLoading:()=>pr===Cc,setState(c){if(!nt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");pr=c.pluginStatus,Ks=c.pluginURL},isParsed(){if(!nt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Zr.applyArabicShaping!=null&&Zr.processBidirectionalText!=null&&Zr.processStyledBidirectionalText!=null},getPluginURL(){if(!nt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ks}};class fi{constructor(o,h){this.zoom=o,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new bc,this.transition={})}isSupportedScript(o){return function(h,g){for(const T of h)if(!j1(T.charCodeAt(0),g))return!1;return!0}(o,Zr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const o=this.zoom,h=o-Math.floor(o),g=this.crossFadingFactor();return o>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*h}}}class Sl{constructor(o,h){this.property=o,this.value=h,this.expression=function(g,T){if(li(g))return new Jn(g,T);if(ml(g)){const C=_l(g,T);if(C.result==="error")throw new Error(C.value.map(k=>`${k.key}: ${k.message}`).join(", "));return C.value}{let C=g;return T.type==="color"&&typeof g=="string"?C=f.parse(g):T.type!=="padding"||typeof g!="number"&&!Array.isArray(g)||(C=be.parse(g)),{kind:"constant",evaluate:()=>C}}}(h===void 0?o.specification.default:h,o.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,h,g){return this.property.possiblyEvaluate(this,o,h,g)}}class T0{constructor(o){this.property=o,this.value=new Sl(o,void 0)}transitioned(o,h){return new th(this.property,this.value,h,q({},o.transition,this.transition),o.now)}untransitioned(){return new th(this.property,this.value,null,{},0)}}class eh{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return re(this._values[o].value.value)}setValue(o,h){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new T0(this._values[o].property)),this._values[o].value=new Sl(this._values[o].property,h===null?void 0:re(h))}getTransition(o){return re(this._values[o].transition)}setTransition(o,h){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new T0(this._values[o].property)),this._values[o].transition=re(h)||void 0}serialize(){const o={};for(const h of Object.keys(this._values)){const g=this.getValue(h);g!==void 0&&(o[h]=g);const T=this.getTransition(h);T!==void 0&&(o[`${h}-transition`]=T)}return o}transitioned(o,h){const g=new Ic(this._properties);for(const T of Object.keys(this._values))g._values[T]=this._values[T].transitioned(o,h._values[T]);return g}untransitioned(){const o=new Ic(this._properties);for(const h of Object.keys(this._values))o._values[h]=this._values[h].untransitioned();return o}}class th{constructor(o,h,g,T,C){this.property=o,this.value=h,this.begin=C+T.delay||0,this.end=this.begin+T.duration||0,o.specification.transition&&(T.delay||T.duration)&&(this.prior=g)}possiblyEvaluate(o,h,g){const T=o.now||0,C=this.value.possiblyEvaluate(o,h,g),k=this.prior;if(k){if(T>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(T<this.begin)return k.possiblyEvaluate(o,h,g);{const B=(T-this.begin)/(this.end-this.begin);return this.property.interpolate(k.possiblyEvaluate(o,h,g),C,function(F){if(F<=0)return 0;if(F>=1)return 1;const j=F*F,Q=j*F;return 4*(F<.5?Q:3*(F-j)+Q-.75)}(B))}}return C}}class Ic{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,h,g){const T=new Cl(this._properties);for(const C of Object.keys(this._values))T._values[C]=this._values[C].possiblyEvaluate(o,h,g);return T}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class nh{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return re(this._values[o].value)}setValue(o,h){this._values[o]=new Sl(this._values[o].property,h===null?void 0:re(h))}serialize(){const o={};for(const h of Object.keys(this._values)){const g=this.getValue(h);g!==void 0&&(o[h]=g)}return o}possiblyEvaluate(o,h,g){const T=new Cl(this._properties);for(const C of Object.keys(this._values))T._values[C]=this._values[C].possiblyEvaluate(o,h,g);return T}}class ei{constructor(o,h,g){this.property=o,this.value=h,this.parameters=g}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,h,g,T){return this.property.evaluate(this.value,this.parameters,o,h,g,T)}}class Cl{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class Ht{constructor(o){this.specification=o}possiblyEvaluate(o,h){if(o.isDataDriven())throw new Error("Value should not be data driven");return o.expression.evaluate(h)}interpolate(o,h,g){const T=Mi[this.specification.type];return T?T(o,h,g):o}}class Kt{constructor(o,h){this.specification=o,this.overrides=h}possiblyEvaluate(o,h,g,T){return new ei(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(h,null,{},g,T)}:o.expression,h)}interpolate(o,h,g){if(o.value.kind!=="constant"||h.value.kind!=="constant")return o;if(o.value.value===void 0||h.value.value===void 0)return new ei(this,{kind:"constant",value:void 0},o.parameters);const T=Mi[this.specification.type];return T?new ei(this,{kind:"constant",value:T(o.value.value,h.value.value,g)},o.parameters):o}evaluate(o,h,g,T,C,k){return o.kind==="constant"?o.value:o.evaluate(h,g,T,C,k)}}class Ji extends Kt{possiblyEvaluate(o,h,g,T){if(o.value===void 0)return new ei(this,{kind:"constant",value:void 0},h);if(o.expression.kind==="constant"){const C=o.expression.evaluate(h,null,{},g,T),k=o.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,B=this._calculate(k,k,k,h);return new ei(this,{kind:"constant",value:B},h)}if(o.expression.kind==="camera"){const C=this._calculate(o.expression.evaluate({zoom:h.zoom-1}),o.expression.evaluate({zoom:h.zoom}),o.expression.evaluate({zoom:h.zoom+1}),h);return new ei(this,{kind:"constant",value:C},h)}return new ei(this,o.expression,h)}evaluate(o,h,g,T,C,k){if(o.kind==="source"){const B=o.evaluate(h,g,T,C,k);return this._calculate(B,B,B,h)}return o.kind==="composite"?this._calculate(o.evaluate({zoom:Math.floor(h.zoom)-1},g,T),o.evaluate({zoom:Math.floor(h.zoom)},g,T),o.evaluate({zoom:Math.floor(h.zoom)+1},g,T),h):o.value}_calculate(o,h,g,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:o,to:h}:{from:g,to:h}}interpolate(o){return o}}class kc{constructor(o){this.specification=o}possiblyEvaluate(o,h,g,T){if(o.value!==void 0){if(o.expression.kind==="constant"){const C=o.expression.evaluate(h,null,{},g,T);return this._calculate(C,C,C,h)}return this._calculate(o.expression.evaluate(new fi(Math.floor(h.zoom-1),h)),o.expression.evaluate(new fi(Math.floor(h.zoom),h)),o.expression.evaluate(new fi(Math.floor(h.zoom+1),h)),h)}}_calculate(o,h,g,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:o,to:h}:{from:g,to:h}}interpolate(o){return o}}class Po{constructor(o){this.specification=o}possiblyEvaluate(o,h,g,T){return!!o.expression.evaluate(h,null,{},g,T)}interpolate(){return!1}}class er{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in o){const g=o[h];g.specification.overridable&&this.overridableProperties.push(h);const T=this.defaultPropertyValues[h]=new Sl(g,void 0),C=this.defaultTransitionablePropertyValues[h]=new T0(g);this.defaultTransitioningPropertyValues[h]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=T.possiblyEvaluate({})}}}zt("DataDrivenProperty",Kt),zt("DataConstantProperty",Ht),zt("CrossFadedDataDrivenProperty",Ji),zt("CrossFadedProperty",kc),zt("ColorRampProperty",Po);const Js="-transition";class ms extends $r{constructor(o,h){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1},o.type!=="custom"&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type!=="background"&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),h.layout&&(this._unevaluatedLayout=new nh(h.layout)),h.paint)){this._transitionablePaint=new eh(h.paint);for(const g in o.paint)this.setPaintProperty(g,o.paint[g],{validate:!1});for(const g in o.layout)this.setLayoutProperty(g,o.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Cl(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,h,g={}){h!=null&&this._validate(G1,`layers.${this.id}.layout.${o}`,o,h,g)||(o!=="visibility"?this._unevaluatedLayout.setValue(o,h):this.visibility=h)}getPaintProperty(o){return o.endsWith(Js)?this._transitionablePaint.getTransition(o.slice(0,-Js.length)):this._transitionablePaint.getValue(o)}setPaintProperty(o,h,g={}){if(h!=null&&this._validate(V1,`layers.${this.id}.paint.${o}`,o,h,g))return!1;if(o.endsWith(Js))return this._transitionablePaint.setTransition(o.slice(0,-Js.length),h||void 0),!1;{const T=this._transitionablePaint._values[o],C=T.property.specification["property-type"]==="cross-faded-data-driven",k=T.value.isDataDriven(),B=T.value;this._transitionablePaint.setValue(o,h),this._handleSpecialPaintPropertyUpdate(o);const F=this._transitionablePaint._values[o].value;return F.isDataDriven()||k||C||this._handleOverridablePaintPropertyUpdate(o,B,F)}}_handleSpecialPaintPropertyUpdate(o){}_handleOverridablePaintPropertyUpdate(o,h,g){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,h){o.getCrossfadeParameters&&(this._crossfadeParameters=o.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,h)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),ie(o,(h,g)=>!(h===void 0||g==="layout"&&!Object.keys(h).length||g==="paint"&&!Object.keys(h).length))}_validate(o,h,g,T,C={}){return(!C||C.validate!==!1)&&Ba(this,o.call(El,{key:h,layerType:this.type,objectKey:g,value:T,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const h=this.paint.get(o);if(h instanceof ei&&ui(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const Lc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class eo{constructor(o,h){this._structArray=o,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,h){return o._trim(),h&&(o.isTransferred=!0,h.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const h=Object.create(this.prototype);return h.arrayBuffer=o.arrayBuffer,h.length=o.length,h.capacity=o.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function zi(c,o=1){let h=0,g=0;return{members:c.map(T=>{const C=Lc[T.type].BYTES_PER_ELEMENT,k=h=Dc(h,Math.max(o,C)),B=T.components||1;return g=Math.max(g,C),h+=C*B,{name:T.name,type:T.type,components:B,offset:k}}),size:Dc(h,Math.max(g,o)),alignment:o}}function Dc(c,o){return Math.ceil(c/o)*o}class ea extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,h)}emplace(o,h,g){const T=2*o;return this.int16[T+0]=h,this.int16[T+1]=g,o}}ea.prototype.bytesPerElement=4,zt("StructArrayLayout2i4",ea);class b extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T){const C=this.length;return this.resize(C+1),this.emplace(C,o,h,g,T)}emplace(o,h,g,T,C){const k=4*o;return this.int16[k+0]=h,this.int16[k+1]=g,this.int16[k+2]=T,this.int16[k+3]=C,o}}b.prototype.bytesPerElement=8,zt("StructArrayLayout4i8",b);class l extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k){const B=this.length;return this.resize(B+1),this.emplace(B,o,h,g,T,C,k)}emplace(o,h,g,T,C,k,B){const F=6*o;return this.int16[F+0]=h,this.int16[F+1]=g,this.int16[F+2]=T,this.int16[F+3]=C,this.int16[F+4]=k,this.int16[F+5]=B,o}}l.prototype.bytesPerElement=12,zt("StructArrayLayout2i4i12",l);class p extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k){const B=this.length;return this.resize(B+1),this.emplace(B,o,h,g,T,C,k)}emplace(o,h,g,T,C,k,B){const F=4*o,j=8*o;return this.int16[F+0]=h,this.int16[F+1]=g,this.uint8[j+4]=T,this.uint8[j+5]=C,this.uint8[j+6]=k,this.uint8[j+7]=B,o}}p.prototype.bytesPerElement=8,zt("StructArrayLayout2i4ub8",p);class v extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,h)}emplace(o,h,g){const T=2*o;return this.float32[T+0]=h,this.float32[T+1]=g,o}}v.prototype.bytesPerElement=8,zt("StructArrayLayout2f8",v);class E extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j,Q){const ee=this.length;return this.resize(ee+1),this.emplace(ee,o,h,g,T,C,k,B,F,j,Q)}emplace(o,h,g,T,C,k,B,F,j,Q,ee){const ae=10*o;return this.uint16[ae+0]=h,this.uint16[ae+1]=g,this.uint16[ae+2]=T,this.uint16[ae+3]=C,this.uint16[ae+4]=k,this.uint16[ae+5]=B,this.uint16[ae+6]=F,this.uint16[ae+7]=j,this.uint16[ae+8]=Q,this.uint16[ae+9]=ee,o}}E.prototype.bytesPerElement=20,zt("StructArrayLayout10ui20",E);class P extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j,Q,ee,ae){const he=this.length;return this.resize(he+1),this.emplace(he,o,h,g,T,C,k,B,F,j,Q,ee,ae)}emplace(o,h,g,T,C,k,B,F,j,Q,ee,ae,he){const fe=12*o;return this.int16[fe+0]=h,this.int16[fe+1]=g,this.int16[fe+2]=T,this.int16[fe+3]=C,this.uint16[fe+4]=k,this.uint16[fe+5]=B,this.uint16[fe+6]=F,this.uint16[fe+7]=j,this.int16[fe+8]=Q,this.int16[fe+9]=ee,this.int16[fe+10]=ae,this.int16[fe+11]=he,o}}P.prototype.bytesPerElement=24,zt("StructArrayLayout4i4ui4i24",P);class z extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,o,h,g)}emplace(o,h,g,T){const C=3*o;return this.float32[C+0]=h,this.float32[C+1]=g,this.float32[C+2]=T,o}}z.prototype.bytesPerElement=12,zt("StructArrayLayout3f12",z);class N extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const h=this.length;return this.resize(h+1),this.emplace(h,o)}emplace(o,h){return this.uint32[1*o+0]=h,o}}N.prototype.bytesPerElement=4,zt("StructArrayLayout1ul4",N);class G extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j){const Q=this.length;return this.resize(Q+1),this.emplace(Q,o,h,g,T,C,k,B,F,j)}emplace(o,h,g,T,C,k,B,F,j,Q){const ee=10*o,ae=5*o;return this.int16[ee+0]=h,this.int16[ee+1]=g,this.int16[ee+2]=T,this.int16[ee+3]=C,this.int16[ee+4]=k,this.int16[ee+5]=B,this.uint32[ae+3]=F,this.uint16[ee+8]=j,this.uint16[ee+9]=Q,o}}G.prototype.bytesPerElement=20,zt("StructArrayLayout6i1ul2ui20",G);class $ extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k){const B=this.length;return this.resize(B+1),this.emplace(B,o,h,g,T,C,k)}emplace(o,h,g,T,C,k,B){const F=6*o;return this.int16[F+0]=h,this.int16[F+1]=g,this.int16[F+2]=T,this.int16[F+3]=C,this.int16[F+4]=k,this.int16[F+5]=B,o}}$.prototype.bytesPerElement=12,zt("StructArrayLayout2i2i2i12",$);class K extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C){const k=this.length;return this.resize(k+1),this.emplace(k,o,h,g,T,C)}emplace(o,h,g,T,C,k){const B=4*o,F=8*o;return this.float32[B+0]=h,this.float32[B+1]=g,this.float32[B+2]=T,this.int16[F+6]=C,this.int16[F+7]=k,o}}K.prototype.bytesPerElement=16,zt("StructArrayLayout2f1f2i16",K);class se extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g,T){const C=this.length;return this.resize(C+1),this.emplace(C,o,h,g,T)}emplace(o,h,g,T,C){const k=12*o,B=3*o;return this.uint8[k+0]=h,this.uint8[k+1]=g,this.float32[B+1]=T,this.float32[B+2]=C,o}}se.prototype.bytesPerElement=12,zt("StructArrayLayout2ub2f12",se);class ce extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,o,h,g)}emplace(o,h,g,T){const C=3*o;return this.uint16[C+0]=h,this.uint16[C+1]=g,this.uint16[C+2]=T,o}}ce.prototype.bytesPerElement=6,zt("StructArrayLayout3ui6",ce);class xe extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j,Q,ee,ae,he,fe,Le,Pe,Ve){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,o,h,g,T,C,k,B,F,j,Q,ee,ae,he,fe,Le,Pe,Ve)}emplace(o,h,g,T,C,k,B,F,j,Q,ee,ae,he,fe,Le,Pe,Ve,Qe){const Fe=24*o,qe=12*o,at=48*o;return this.int16[Fe+0]=h,this.int16[Fe+1]=g,this.uint16[Fe+2]=T,this.uint16[Fe+3]=C,this.uint32[qe+2]=k,this.uint32[qe+3]=B,this.uint32[qe+4]=F,this.uint16[Fe+10]=j,this.uint16[Fe+11]=Q,this.uint16[Fe+12]=ee,this.float32[qe+7]=ae,this.float32[qe+8]=he,this.uint8[at+36]=fe,this.uint8[at+37]=Le,this.uint8[at+38]=Pe,this.uint32[qe+10]=Ve,this.int16[Fe+22]=Qe,o}}xe.prototype.bytesPerElement=48,zt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",xe);class ve extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j,Q,ee,ae,he,fe,Le,Pe,Ve,Qe,Fe,qe,at,ot,Bt,Gt,Dt,Ct,Et,Rt){const Mt=this.length;return this.resize(Mt+1),this.emplace(Mt,o,h,g,T,C,k,B,F,j,Q,ee,ae,he,fe,Le,Pe,Ve,Qe,Fe,qe,at,ot,Bt,Gt,Dt,Ct,Et,Rt)}emplace(o,h,g,T,C,k,B,F,j,Q,ee,ae,he,fe,Le,Pe,Ve,Qe,Fe,qe,at,ot,Bt,Gt,Dt,Ct,Et,Rt,Mt){const gt=34*o,nn=17*o;return this.int16[gt+0]=h,this.int16[gt+1]=g,this.int16[gt+2]=T,this.int16[gt+3]=C,this.int16[gt+4]=k,this.int16[gt+5]=B,this.int16[gt+6]=F,this.int16[gt+7]=j,this.uint16[gt+8]=Q,this.uint16[gt+9]=ee,this.uint16[gt+10]=ae,this.uint16[gt+11]=he,this.uint16[gt+12]=fe,this.uint16[gt+13]=Le,this.uint16[gt+14]=Pe,this.uint16[gt+15]=Ve,this.uint16[gt+16]=Qe,this.uint16[gt+17]=Fe,this.uint16[gt+18]=qe,this.uint16[gt+19]=at,this.uint16[gt+20]=ot,this.uint16[gt+21]=Bt,this.uint16[gt+22]=Gt,this.uint32[nn+12]=Dt,this.float32[nn+13]=Ct,this.float32[nn+14]=Et,this.float32[nn+15]=Rt,this.float32[nn+16]=Mt,o}}ve.prototype.bytesPerElement=68,zt("StructArrayLayout8i15ui1ul4f68",ve);class le extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const h=this.length;return this.resize(h+1),this.emplace(h,o)}emplace(o,h){return this.float32[1*o+0]=h,o}}le.prototype.bytesPerElement=4,zt("StructArrayLayout1f4",le);class ye extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,o,h,g)}emplace(o,h,g,T){const C=3*o;return this.int16[C+0]=h,this.int16[C+1]=g,this.int16[C+2]=T,o}}ye.prototype.bytesPerElement=6,zt("StructArrayLayout3i6",ye);class ze extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,o,h,g)}emplace(o,h,g,T){const C=4*o;return this.uint32[2*o+0]=h,this.uint16[C+2]=g,this.uint16[C+3]=T,o}}ze.prototype.bytesPerElement=8,zt("StructArrayLayout1ul2ui8",ze);class Ge extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,h)}emplace(o,h,g){const T=2*o;return this.uint16[T+0]=h,this.uint16[T+1]=g,o}}Ge.prototype.bytesPerElement=4,zt("StructArrayLayout2ui4",Ge);class Se extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const h=this.length;return this.resize(h+1),this.emplace(h,o)}emplace(o,h){return this.uint16[1*o+0]=h,o}}Se.prototype.bytesPerElement=2,zt("StructArrayLayout1ui2",Se);class Ze extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g,T){const C=this.length;return this.resize(C+1),this.emplace(C,o,h,g,T)}emplace(o,h,g,T,C){const k=4*o;return this.float32[k+0]=h,this.float32[k+1]=g,this.float32[k+2]=T,this.float32[k+3]=C,o}}Ze.prototype.bytesPerElement=16,zt("StructArrayLayout4f16",Ze);class je extends eo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Ft(this.anchorPointX,this.anchorPointY)}}je.prototype.size=20;class tt extends G{get(o){return new je(this,o)}}zt("CollisionBoxArray",tt);class Ke extends eo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(o){this._structArray.uint8[this._pos1+37]=o}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(o){this._structArray.uint8[this._pos1+38]=o}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(o){this._structArray.uint32[this._pos4+10]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ke.prototype.size=48;class d extends xe{get(o){return new Ke(this,o)}}zt("PlacedSymbolArray",d);class A extends eo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(o){this._structArray.uint32[this._pos4+12]=o}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}A.prototype.size=68;class m extends ve{get(o){return new A(this,o)}}zt("SymbolInstanceArray",m);class _ extends le{getoffsetX(o){return this.float32[1*o+0]}}zt("GlyphOffsetArray",_);class x extends ye{getx(o){return this.int16[3*o+0]}gety(o){return this.int16[3*o+1]}gettileUnitDistanceFromAnchor(o){return this.int16[3*o+2]}}zt("SymbolLineVertexArray",x);class S extends eo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}S.prototype.size=8;class I extends ze{get(o){return new S(this,o)}}zt("FeatureIndexArray",I);class D extends ea{}class O extends ea{}class H extends ea{}class J extends l{}class Ae extends p{}class we extends v{}class Re extends E{}class Ee extends P{}class Be extends z{}class Je extends N{}class Ye extends ${}class He extends se{}class We extends ce{}class Oe extends Ge{}const Pt=zi([{name:"a_pos",components:2,type:"Int16"}],4),{members:bt}=Pt;class rt{constructor(o=[]){this.segments=o}prepareSegment(o,h,g,T){let C=this.segments[this.segments.length-1];return o>rt.MAX_VERTEX_ARRAY_LENGTH&&Te(`Max vertices per segment is ${rt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!C||C.vertexLength+o>rt.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==T)&&(C={vertexOffset:h.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},T!==void 0&&(C.sortKey=T),this.segments.push(C)),C}get(){return this.segments}destroy(){for(const o of this.segments)for(const h in o.vaos)o.vaos[h].destroy()}static simpleSegment(o,h,g,T){return new rt([{vertexOffset:o,primitiveOffset:h,vertexLength:g,primitiveLength:T,vaos:{},sortKey:0}])}}function ft(c,o){return 256*(c=L(Math.floor(c),0,255))+L(Math.floor(o),0,255)}rt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zt("SegmentVector",rt);const dn=zi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var un={exports:{}},rn={exports:{}};rn.exports=function(c,o){var h,g,T,C,k,B,F,j;for(g=c.length-(h=3&c.length),T=o,k=3432918353,B=461845907,j=0;j<g;)F=255&c.charCodeAt(j)|(255&c.charCodeAt(++j))<<8|(255&c.charCodeAt(++j))<<16|(255&c.charCodeAt(++j))<<24,++j,T=27492+(65535&(C=5*(65535&(T=(T^=F=(65535&(F=(F=(65535&F)*k+(((F>>>16)*k&65535)<<16)&4294967295)<<15|F>>>17))*B+(((F>>>16)*B&65535)<<16)&4294967295)<<13|T>>>19))+((5*(T>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(F=0,h){case 3:F^=(255&c.charCodeAt(j+2))<<16;case 2:F^=(255&c.charCodeAt(j+1))<<8;case 1:T^=F=(65535&(F=(F=(65535&(F^=255&c.charCodeAt(j)))*k+(((F>>>16)*k&65535)<<16)&4294967295)<<15|F>>>17))*B+(((F>>>16)*B&65535)<<16)&4294967295}return T^=c.length,T=2246822507*(65535&(T^=T>>>16))+((2246822507*(T>>>16)&65535)<<16)&4294967295,T=3266489909*(65535&(T^=T>>>13))+((3266489909*(T>>>16)&65535)<<16)&4294967295,(T^=T>>>16)>>>0};var on={exports:{}};on.exports=function(c,o){for(var h,g=c.length,T=o^g,C=0;g>=4;)h=1540483477*(65535&(h=255&c.charCodeAt(C)|(255&c.charCodeAt(++C))<<8|(255&c.charCodeAt(++C))<<16|(255&c.charCodeAt(++C))<<24))+((1540483477*(h>>>16)&65535)<<16),T=1540483477*(65535&T)+((1540483477*(T>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),g-=4,++C;switch(g){case 3:T^=(255&c.charCodeAt(C+2))<<16;case 2:T^=(255&c.charCodeAt(C+1))<<8;case 1:T=1540483477*(65535&(T^=255&c.charCodeAt(C)))+((1540483477*(T>>>16)&65535)<<16)}return T=1540483477*(65535&(T^=T>>>13))+((1540483477*(T>>>16)&65535)<<16),(T^=T>>>15)>>>0};var hn=rn.exports,gn=on.exports;un.exports=hn,un.exports.murmur3=hn,un.exports.murmur2=gn;class jn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,h,g,T){this.ids.push(pn(o)),this.positions.push(h,g,T)}getPositions(o){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=pn(o);let g=0,T=this.ids.length-1;for(;g<T;){const k=g+T>>1;this.ids[k]>=h?T=k:g=k+1}const C=[];for(;this.ids[g]===h;)C.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return C}static serialize(o,h){const g=new Float64Array(o.ids),T=new Uint32Array(o.positions);return ti(g,T,0,g.length-1),h&&h.push(g.buffer,T.buffer),{ids:g,positions:T}}static deserialize(o){const h=new jn;return h.ids=o.ids,h.positions=o.positions,h.indexed=!0,h}}function pn(c){const o=+c;return!isNaN(o)&&o<=Number.MAX_SAFE_INTEGER?o:un.exports(String(c))}function ti(c,o,h,g){for(;h<g;){const T=c[h+g>>1];let C=h-1,k=g+1;for(;;){do C++;while(c[C]<T);do k--;while(c[k]>T);if(C>=k)break;bi(c,C,k),bi(o,3*C,3*k),bi(o,3*C+1,3*k+1),bi(o,3*C+2,3*k+2)}k-h<g-k?(ti(c,o,h,k),h=k+1):(ti(c,o,k+1,g),g=k)}}function bi(c,o,h){const g=c[o];c[o]=c[h],c[h]=g}zt("FeaturePositionMap",jn);class Mo{constructor(o,h){this.gl=o.gl,this.location=h}}class Pl extends Mo{constructor(o,h){super(o,h),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class ih extends Mo{constructor(o,h){super(o,h),this.current=[0,0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3]))}}class t7 extends Mo{constructor(o,h){super(o,h),this.current=f.transparent}set(o){o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a))}}const $P=new Float32Array(16);function G3(c){return[ft(255*c.r,255*c.g),ft(255*c.b,255*c.a)]}class H1{constructor(o,h,g){this.value=o,this.uniformNames=h.map(T=>`u_${T}`),this.type=g}setUniform(o,h,g){o.set(g.constantOr(this.value))}getBinding(o,h,g){return this.type==="color"?new t7(o,h):new Pl(o,h)}}class rh{constructor(o,h){this.uniformNames=h.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(o,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=o.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=o.tlbr}setUniform(o,h,g,T){const C=T==="u_pattern_to"?this.patternTo:T==="u_pattern_from"?this.patternFrom:T==="u_pixel_ratio_to"?this.pixelRatioTo:T==="u_pixel_ratio_from"?this.pixelRatioFrom:null;C&&o.set(C)}getBinding(o,h,g){return g.substr(0,9)==="u_pattern"?new ih(o,h):new Pl(o,h)}}class Ml{constructor(o,h,g,T){this.expression=o,this.type=g,this.maxValue=0,this.paintVertexAttributes=h.map(C=>({name:`a_${C}`,type:"Float32",components:g==="color"?2:1,offset:0})),this.paintVertexArray=new T}populatePaintArray(o,h,g,T,C){const k=this.paintVertexArray.length,B=this.expression.evaluate(new fi(0),h,{},T,[],C);this.paintVertexArray.resize(o),this._setPaintValue(k,o,B)}updatePaintArray(o,h,g,T){const C=this.expression.evaluate({zoom:0},g,T);this._setPaintValue(o,h,C)}_setPaintValue(o,h,g){if(this.type==="color"){const T=G3(g);for(let C=o;C<h;C++)this.paintVertexArray.emplace(C,T[0],T[1])}else{for(let T=o;T<h;T++)this.paintVertexArray.emplace(T,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ta{constructor(o,h,g,T,C,k){this.expression=o,this.uniformNames=h.map(B=>`u_${B}_t`),this.type=g,this.useIntegerZoom=T,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=h.map(B=>({name:`a_${B}`,type:"Float32",components:g==="color"?4:2,offset:0})),this.paintVertexArray=new k}populatePaintArray(o,h,g,T,C){const k=this.expression.evaluate(new fi(this.zoom),h,{},T,[],C),B=this.expression.evaluate(new fi(this.zoom+1),h,{},T,[],C),F=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(F,o,k,B)}updatePaintArray(o,h,g,T){const C=this.expression.evaluate({zoom:this.zoom},g,T),k=this.expression.evaluate({zoom:this.zoom+1},g,T);this._setPaintValue(o,h,C,k)}_setPaintValue(o,h,g,T){if(this.type==="color"){const C=G3(g),k=G3(T);for(let B=o;B<h;B++)this.paintVertexArray.emplace(B,C[0],C[1],k[0],k[1])}else{for(let C=o;C<h;C++)this.paintVertexArray.emplace(C,g,T);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(T))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,h){const g=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,T=L(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);o.set(T)}getBinding(o,h,g){return new Pl(o,h)}}class S0{constructor(o,h,g,T,C,k){this.expression=o,this.type=h,this.useIntegerZoom=g,this.zoom=T,this.layerId=k,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(o,h,g){const T=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(o),this.zoomOutPaintVertexArray.resize(o),this._setPaintValues(T,o,h.patterns&&h.patterns[this.layerId],g)}updatePaintArray(o,h,g,T,C){this._setPaintValues(o,h,g.patterns&&g.patterns[this.layerId],C)}_setPaintValues(o,h,g,T){if(!T||!g)return;const{min:C,mid:k,max:B}=g,F=T[C],j=T[k],Q=T[B];if(F&&j&&Q)for(let ee=o;ee<h;ee++)this.zoomInPaintVertexArray.emplace(ee,j.tl[0],j.tl[1],j.br[0],j.br[1],F.tl[0],F.tl[1],F.br[0],F.br[1],j.pixelRatio,F.pixelRatio),this.zoomOutPaintVertexArray.emplace(ee,j.tl[0],j.tl[1],j.br[0],j.br[1],Q.tl[0],Q.tl[1],Q.br[0],Q.br[1],j.pixelRatio,Q.pixelRatio)}upload(o){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=o.createVertexBuffer(this.zoomInPaintVertexArray,dn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=o.createVertexBuffer(this.zoomOutPaintVertexArray,dn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class n7{constructor(o,h,g){this.binders={},this._buffers=[];const T=[];for(const C in o.paint._values){if(!g(C))continue;const k=o.paint.get(C);if(!(k instanceof ei&&ui(k.property.specification)))continue;const B=qP(C,o.type),F=k.value,j=k.property.specification.type,Q=k.property.useIntegerZoom,ee=k.property.specification["property-type"],ae=ee==="cross-faded"||ee==="cross-faded-data-driven";if(F.kind==="constant")this.binders[C]=ae?new rh(F.value,B):new H1(F.value,B,j),T.push(`/u_${C}`);else if(F.kind==="source"||ae){const he=i7(C,j,"source");this.binders[C]=ae?new S0(F,j,Q,h,he,o.id):new Ml(F,B,j,he),T.push(`/a_${C}`)}else{const he=i7(C,j,"composite");this.binders[C]=new ta(F,B,j,Q,h,he),T.push(`/z_${C}`)}}this.cacheKey=T.sort().join("")}getMaxValue(o){const h=this.binders[o];return h instanceof Ml||h instanceof ta?h.maxValue:0}populatePaintArrays(o,h,g,T,C){for(const k in this.binders){const B=this.binders[k];(B instanceof Ml||B instanceof ta||B instanceof S0)&&B.populatePaintArray(o,h,g,T,C)}}setConstantPatternPositions(o,h){for(const g in this.binders){const T=this.binders[g];T instanceof rh&&T.setConstantPatternPositions(o,h)}}updatePaintArrays(o,h,g,T,C){let k=!1;for(const B in o){const F=h.getPositions(B);for(const j of F){const Q=g.feature(j.index);for(const ee in this.binders){const ae=this.binders[ee];if((ae instanceof Ml||ae instanceof ta||ae instanceof S0)&&ae.expression.isStateDependent===!0){const he=T.paint.get(ee);ae.expression=he.value,ae.updatePaintArray(j.start,j.end,Q,o[B],C),k=!0}}}}return k}defines(){const o=[];for(const h in this.binders){const g=this.binders[h];(g instanceof H1||g instanceof rh)&&o.push(...g.uniformNames.map(T=>`#define HAS_UNIFORM_${T}`))}return o}getBinderAttributes(){const o=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof Ml||g instanceof ta)for(let T=0;T<g.paintVertexAttributes.length;T++)o.push(g.paintVertexAttributes[T].name);else if(g instanceof S0)for(let T=0;T<dn.members.length;T++)o.push(dn.members[T].name)}return o}getBinderUniforms(){const o=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof H1||g instanceof rh||g instanceof ta)for(const T of g.uniformNames)o.push(T)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o,h){const g=[];for(const T in this.binders){const C=this.binders[T];if(C instanceof H1||C instanceof rh||C instanceof ta){for(const k of C.uniformNames)if(h[k]){const B=C.getBinding(o,h[k],k);g.push({name:k,property:T,binding:B})}}}return g}setUniforms(o,h,g,T){for(const{name:C,property:k,binding:B}of h)this.binders[k].setUniform(B,T,g.get(k),C)}updatePaintBuffers(o){this._buffers=[];for(const h in this.binders){const g=this.binders[h];if(o&&g instanceof S0){const T=o.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;T&&this._buffers.push(T)}else(g instanceof Ml||g instanceof ta)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(o){for(const h in this.binders){const g=this.binders[h];(g instanceof Ml||g instanceof ta||g instanceof S0)&&g.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const h=this.binders[o];(h instanceof Ml||h instanceof ta||h instanceof S0)&&h.destroy()}}}class Rc{constructor(o,h,g=()=>!0){this.programConfigurations={};for(const T of o)this.programConfigurations[T.id]=new n7(T,h,g);this.needsUpload=!1,this._featureMap=new jn,this._bufferOffset=0}populatePaintArrays(o,h,g,T,C,k){for(const B in this.programConfigurations)this.programConfigurations[B].populatePaintArrays(o,h,T,C,k);h.id!==void 0&&this._featureMap.add(h.id,g,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,h,g,T){for(const C of g)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(o,this._featureMap,h,C,T)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}function qP(c,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${o}-`,"").replace(/-/g,"_")]}function i7(c,o,h){const g={color:{source:v,composite:Ze},number:{source:le,composite:v}},T=function(C){return{"line-pattern":{source:Re,composite:Re},"fill-pattern":{source:Re,composite:Re},"fill-extrusion-pattern":{source:Re,composite:Re}}[C]}(c);return T&&T[h]||g[o][h]}zt("ConstantBinder",H1),zt("CrossFadedConstantBinder",rh),zt("SourceExpressionBinder",Ml),zt("CrossFadedCompositeBinder",S0),zt("CompositeExpressionBinder",ta),zt("ProgramConfiguration",n7,{omit:["_buffers"]}),zt("ProgramConfigurationSet",Rc);var tr=8192;const j3=Math.pow(2,14)-1,r7=-j3-1;function zc(c){const o=tr/c.extent,h=c.loadGeometry();for(let g=0;g<h.length;g++){const T=h[g];for(let C=0;C<T.length;C++){const k=T[C],B=Math.round(k.x*o),F=Math.round(k.y*o);k.x=L(B,r7,j3),k.y=L(F,r7,j3),(B<k.x||B>k.x+1||F<k.y||F>k.y+1)&&Te("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Bc(c,o){return{type:c.type,id:c.id,properties:c.properties,geometry:o?zc(c):[]}}function nA(c,o,h,g,T){c.emplaceBack(2*o+(g+1)/2,2*h+(T+1)/2)}class H3{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(h=>h.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new O,this.indexArray=new We,this.segments=new rt,this.programConfigurations=new Rc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(o,h,g){const T=this.layers[0],C=[];let k=null,B=!1;T.type==="circle"&&(k=T.layout.get("circle-sort-key"),B=!k.isConstant());for(const{feature:F,id:j,index:Q,sourceLayerIndex:ee}of o){const ae=this.layers[0]._featureFilter.needGeometry,he=Bc(F,ae);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),he,g))continue;const fe=B?k.evaluate(he,{},g):void 0,Le={id:j,properties:F.properties,type:F.type,sourceLayerIndex:ee,index:Q,geometry:ae?he.geometry:zc(F),patterns:{},sortKey:fe};C.push(Le)}B&&C.sort((F,j)=>F.sortKey-j.sortKey);for(const F of C){const{geometry:j,index:Q,sourceLayerIndex:ee}=F,ae=o[Q].feature;this.addFeature(F,j,Q,g),h.featureIndex.insert(ae,j,Q,ee,this.index)}}update(o,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,h,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,bt),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,h,g,T){for(const C of h)for(const k of C){const B=k.x,F=k.y;if(B<0||B>=tr||F<0||F>=tr)continue;const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),Q=j.vertexLength;nA(this.layoutVertexArray,B,F,-1,-1),nA(this.layoutVertexArray,B,F,1,-1),nA(this.layoutVertexArray,B,F,1,1),nA(this.layoutVertexArray,B,F,-1,1),this.indexArray.emplaceBack(Q,Q+1,Q+2),this.indexArray.emplaceBack(Q,Q+3,Q+2),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,{},T)}}function s7(c,o){for(let h=0;h<c.length;h++)if(sh(o,c[h]))return!0;for(let h=0;h<o.length;h++)if(sh(c,o[h]))return!0;return!!W3(c,o)}function ZP(c,o,h){return!!sh(c,o)||!!$3(o,c,h)}function o7(c,o){if(c.length===1)return l7(o,c[0]);for(let h=0;h<o.length;h++){const g=o[h];for(let T=0;T<g.length;T++)if(sh(c,g[T]))return!0}for(let h=0;h<c.length;h++)if(l7(o,c[h]))return!0;for(let h=0;h<o.length;h++)if(W3(c,o[h]))return!0;return!1}function XP(c,o,h){if(c.length>1){if(W3(c,o))return!0;for(let g=0;g<o.length;g++)if($3(o[g],c,h))return!0}for(let g=0;g<c.length;g++)if($3(c[g],o,h))return!0;return!1}function W3(c,o){if(c.length===0||o.length===0)return!1;for(let h=0;h<c.length-1;h++){const g=c[h],T=c[h+1];for(let C=0;C<o.length-1;C++)if(QP(g,T,o[C],o[C+1]))return!0}return!1}function QP(c,o,h,g){return De(c,h,g)!==De(o,h,g)&&De(c,o,h)!==De(c,o,g)}function $3(c,o,h){const g=h*h;if(o.length===1)return c.distSqr(o[0])<g;for(let T=1;T<o.length;T++)if(a7(c,o[T-1],o[T])<g)return!0;return!1}function a7(c,o,h){const g=o.distSqr(h);if(g===0)return c.distSqr(o);const T=((c.x-o.x)*(h.x-o.x)+(c.y-o.y)*(h.y-o.y))/g;return c.distSqr(T<0?o:T>1?h:h.sub(o)._mult(T)._add(o))}function l7(c,o){let h,g,T,C=!1;for(let k=0;k<c.length;k++){h=c[k];for(let B=0,F=h.length-1;B<h.length;F=B++)g=h[B],T=h[F],g.y>o.y!=T.y>o.y&&o.x<(T.x-g.x)*(o.y-g.y)/(T.y-g.y)+g.x&&(C=!C)}return C}function sh(c,o){let h=!1;for(let g=0,T=c.length-1;g<c.length;T=g++){const C=c[g],k=c[T];C.y>o.y!=k.y>o.y&&o.x<(k.x-C.x)*(o.y-C.y)/(k.y-C.y)+C.x&&(h=!h)}return h}function YP(c,o,h){const g=h[0],T=h[2];if(c.x<g.x&&o.x<g.x||c.x>T.x&&o.x>T.x||c.y<g.y&&o.y<g.y||c.y>T.y&&o.y>T.y)return!1;const C=De(c,o,h[0]);return C!==De(c,o,h[1])||C!==De(c,o,h[2])||C!==De(c,o,h[3])}function W1(c,o,h){const g=o.paint.get(c).value;return g.kind==="constant"?g.value:h.programConfigurations.get(o.id).getMaxValue(c)}function iA(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function rA(c,o,h,g,T){if(!o[0]&&!o[1])return c;const C=Ft.convert(o)._mult(T);h==="viewport"&&C._rotate(-g);const k=[];for(let B=0;B<c.length;B++)k.push(c[B].sub(C));return k}zt("CircleBucket",H3,{omit:["layers"]});const KP=new er({"circle-sort-key":new Kt(et.layout_circle["circle-sort-key"])});var JP={paint:new er({"circle-radius":new Kt(et.paint_circle["circle-radius"]),"circle-color":new Kt(et.paint_circle["circle-color"]),"circle-blur":new Kt(et.paint_circle["circle-blur"]),"circle-opacity":new Kt(et.paint_circle["circle-opacity"]),"circle-translate":new Ht(et.paint_circle["circle-translate"]),"circle-translate-anchor":new Ht(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ht(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ht(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Kt(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Kt(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Kt(et.paint_circle["circle-stroke-opacity"])}),layout:KP},Xr=1e-6,Qr=typeof Float32Array<"u"?Float32Array:Array;function c7(){var c=new Qr(9);return Qr!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function q3(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function u7(c,o,h){var g=o[0],T=o[1],C=o[2],k=o[3],B=o[4],F=o[5],j=o[6],Q=o[7],ee=o[8],ae=o[9],he=o[10],fe=o[11],Le=o[12],Pe=o[13],Ve=o[14],Qe=o[15],Fe=h[0],qe=h[1],at=h[2],ot=h[3];return c[0]=Fe*g+qe*B+at*ee+ot*Le,c[1]=Fe*T+qe*F+at*ae+ot*Pe,c[2]=Fe*C+qe*j+at*he+ot*Ve,c[3]=Fe*k+qe*Q+at*fe+ot*Qe,c[4]=(Fe=h[4])*g+(qe=h[5])*B+(at=h[6])*ee+(ot=h[7])*Le,c[5]=Fe*T+qe*F+at*ae+ot*Pe,c[6]=Fe*C+qe*j+at*he+ot*Ve,c[7]=Fe*k+qe*Q+at*fe+ot*Qe,c[8]=(Fe=h[8])*g+(qe=h[9])*B+(at=h[10])*ee+(ot=h[11])*Le,c[9]=Fe*T+qe*F+at*ae+ot*Pe,c[10]=Fe*C+qe*j+at*he+ot*Ve,c[11]=Fe*k+qe*Q+at*fe+ot*Qe,c[12]=(Fe=h[12])*g+(qe=h[13])*B+(at=h[14])*ee+(ot=h[15])*Le,c[13]=Fe*T+qe*F+at*ae+ot*Pe,c[14]=Fe*C+qe*j+at*he+ot*Ve,c[15]=Fe*k+qe*Q+at*fe+ot*Qe,c}Math.hypot||(Math.hypot=function(){for(var c=0,o=arguments.length;o--;)c+=arguments[o]*arguments[o];return Math.sqrt(c)});var $1,eM=u7;function h7(){var c=new Qr(3);return Qr!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function f7(c,o,h){var g=new Qr(3);return g[0]=c,g[1]=o,g[2]=h,g}function sA(c,o,h){var g=o[0],T=o[1],C=o[2],k=o[3];return c[0]=h[0]*g+h[4]*T+h[8]*C+h[12]*k,c[1]=h[1]*g+h[5]*T+h[9]*C+h[13]*k,c[2]=h[2]*g+h[6]*T+h[10]*C+h[14]*k,c[3]=h[3]*g+h[7]*T+h[11]*C+h[15]*k,c}function A7(){var c=new Qr(4);return Qr!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function d7(c,o){const h=sA([],[c.x,c.y,0,1],o);return new Ft(h[0]/h[3],h[1]/h[3])}h7(),$1=new Qr(4),Qr!=Float32Array&&($1[0]=0,$1[1]=0,$1[2]=0,$1[3]=0),h7(),f7(1,0,0),f7(0,1,0),A7(),A7(),c7(),function(){var c;c=new Qr(2),Qr!=Float32Array&&(c[0]=0,c[1]=0)}();class p7 extends H3{}zt("HeatmapBucket",p7,{omit:["layers"]});var tM={paint:new er({"heatmap-radius":new Kt(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Kt(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ht(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Po(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ht(et.paint_heatmap["heatmap-opacity"])})};function Z3(c,{width:o,height:h},g,T){if(T){if(T instanceof Uint8ClampedArray)T=new Uint8Array(T.buffer);else if(T.length!==o*h*g)throw new RangeError(`mismatched image size. expected: ${T.length} but got: ${o*h*g}`)}else T=new Uint8Array(o*h*g);return c.width=o,c.height=h,c.data=T,c}function m7(c,{width:o,height:h},g){if(o===c.width&&h===c.height)return;const T=Z3({},{width:o,height:h},g);X3(c,T,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,o),height:Math.min(c.height,h)},g),c.width=o,c.height=h,c.data=T.data}function X3(c,o,h,g,T,C){if(T.width===0||T.height===0)return o;if(T.width>c.width||T.height>c.height||h.x>c.width-T.width||h.y>c.height-T.height)throw new RangeError("out of range source coordinates for image copy");if(T.width>o.width||T.height>o.height||g.x>o.width-T.width||g.y>o.height-T.height)throw new RangeError("out of range destination coordinates for image copy");const k=c.data,B=o.data;if(k===B)throw new Error("srcData equals dstData, so image is already copied");for(let F=0;F<T.height;F++){const j=((h.y+F)*c.width+h.x)*C,Q=((g.y+F)*o.width+g.x)*C;for(let ee=0;ee<T.width*C;ee++)B[Q+ee]=k[j+ee]}return o}class q1{constructor(o,h){Z3(this,o,1,h)}resize(o){m7(this,o,1)}clone(){return new q1({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,h,g,T,C){X3(o,h,g,T,C,1)}}class to{constructor(o,h){Z3(this,o,4,h)}resize(o){m7(this,o,4)}replace(o,h){h?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new to({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,h,g,T,C){X3(o,h,g,T,C,4)}}function g7(c){const o={},h=c.resolution||256,g=c.clips?c.clips.length:1,T=c.image||new to({width:h,height:g});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const C=(k,B,F)=>{o[c.evaluationKey]=F;const j=c.expression.evaluate(o);T.data[k+B+0]=Math.floor(255*j.r/j.a),T.data[k+B+1]=Math.floor(255*j.g/j.a),T.data[k+B+2]=Math.floor(255*j.b/j.a),T.data[k+B+3]=Math.floor(255*j.a)};if(c.clips)for(let k=0,B=0;k<g;++k,B+=4*h)for(let F=0,j=0;F<h;F++,j+=4){const Q=F/(h-1),{start:ee,end:ae}=c.clips[k];C(B,j,ee*(1-Q)+ae*Q)}else for(let k=0,B=0;k<h;k++,B+=4)C(0,B,k/(h-1));return T}zt("AlphaImage",q1),zt("RGBAImage",to);var nM={paint:new er({"hillshade-illumination-direction":new Ht(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ht(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ht(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ht(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ht(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ht(et.paint_hillshade["hillshade-accent-color"])})};const iM=zi([{name:"a_pos",components:2,type:"Int16"}],4),{members:rM}=iM;var oA={exports:{}};function aA(c,o,h){h=h||2;var g,T,C,k,B,F,j,Q=o&&o.length,ee=Q?o[0]*h:c.length,ae=_7(c,0,ee,h,!0),he=[];if(!ae||ae.next===ae.prev)return he;if(Q&&(ae=function(Le,Pe,Ve,Qe){var Fe,qe,at,ot=[];for(Fe=0,qe=Pe.length;Fe<qe;Fe++)(at=_7(Le,Pe[Fe]*Qe,Fe<qe-1?Pe[Fe+1]*Qe:Le.length,Qe,!1))===at.next&&(at.steiner=!0),ot.push(fM(at));for(ot.sort(cM),Fe=0;Fe<ot.length;Fe++)Ve=uM(ot[Fe],Ve);return Ve}(c,o,ae,h)),c.length>80*h){g=C=c[0],T=k=c[1];for(var fe=h;fe<ee;fe+=h)(B=c[fe])<g&&(g=B),(F=c[fe+1])<T&&(T=F),B>C&&(C=B),F>k&&(k=F);j=(j=Math.max(C-g,k-T))!==0?32767/j:0}return Z1(ae,he,h,g,T,j,0),he}function _7(c,o,h,g,T){var C,k;if(T===K3(c,o,h,g)>0)for(C=o;C<h;C+=g)k=x7(C,c[C],c[C+1],k);else for(C=h-g;C>=o;C-=g)k=x7(C,c[C],c[C+1],k);return k&&lA(k,k.next)&&(Q1(k),k=k.next),k}function Oc(c,o){if(!c)return c;o||(o=c);var h,g=c;do if(h=!1,g.steiner||!lA(g,g.next)&&Ni(g.prev,g,g.next)!==0)g=g.next;else{if(Q1(g),(g=o=g.prev)===g.next)break;h=!0}while(h||g!==o);return o}function Z1(c,o,h,g,T,C,k){if(c){!k&&C&&function(Q,ee,ae,he){var fe=Q;do fe.z===0&&(fe.z=Q3(fe.x,fe.y,ee,ae,he)),fe.prevZ=fe.prev,fe.nextZ=fe.next,fe=fe.next;while(fe!==Q);fe.prevZ.nextZ=null,fe.prevZ=null,function(Le){var Pe,Ve,Qe,Fe,qe,at,ot,Bt,Gt=1;do{for(Ve=Le,Le=null,qe=null,at=0;Ve;){for(at++,Qe=Ve,ot=0,Pe=0;Pe<Gt&&(ot++,Qe=Qe.nextZ);Pe++);for(Bt=Gt;ot>0||Bt>0&&Qe;)ot!==0&&(Bt===0||!Qe||Ve.z<=Qe.z)?(Fe=Ve,Ve=Ve.nextZ,ot--):(Fe=Qe,Qe=Qe.nextZ,Bt--),qe?qe.nextZ=Fe:Le=Fe,Fe.prevZ=qe,qe=Fe;Ve=Qe}qe.nextZ=null,Gt*=2}while(at>1)}(fe)}(c,g,T,C);for(var B,F,j=c;c.prev!==c.next;)if(B=c.prev,F=c.next,C?oM(c,g,T,C):sM(c))o.push(B.i/h|0),o.push(c.i/h|0),o.push(F.i/h|0),Q1(c),c=F.next,j=F.next;else if((c=F)===j){k?k===1?Z1(c=aM(Oc(c),o,h),o,h,g,T,C,2):k===2&&lM(c,o,h,g,T,C):Z1(Oc(c),o,h,g,T,C,1);break}}}function sM(c){var o=c.prev,h=c,g=c.next;if(Ni(o,h,g)>=0)return!1;for(var T=o.x,C=h.x,k=g.x,B=o.y,F=h.y,j=g.y,Q=T<C?T<k?T:k:C<k?C:k,ee=B<F?B<j?B:j:F<j?F:j,ae=T>C?T>k?T:k:C>k?C:k,he=B>F?B>j?B:j:F>j?F:j,fe=g.next;fe!==o;){if(fe.x>=Q&&fe.x<=ae&&fe.y>=ee&&fe.y<=he&&oh(T,B,C,F,k,j,fe.x,fe.y)&&Ni(fe.prev,fe,fe.next)>=0)return!1;fe=fe.next}return!0}function oM(c,o,h,g){var T=c.prev,C=c,k=c.next;if(Ni(T,C,k)>=0)return!1;for(var B=T.x,F=C.x,j=k.x,Q=T.y,ee=C.y,ae=k.y,he=B<F?B<j?B:j:F<j?F:j,fe=Q<ee?Q<ae?Q:ae:ee<ae?ee:ae,Le=B>F?B>j?B:j:F>j?F:j,Pe=Q>ee?Q>ae?Q:ae:ee>ae?ee:ae,Ve=Q3(he,fe,o,h,g),Qe=Q3(Le,Pe,o,h,g),Fe=c.prevZ,qe=c.nextZ;Fe&&Fe.z>=Ve&&qe&&qe.z<=Qe;){if(Fe.x>=he&&Fe.x<=Le&&Fe.y>=fe&&Fe.y<=Pe&&Fe!==T&&Fe!==k&&oh(B,Q,F,ee,j,ae,Fe.x,Fe.y)&&Ni(Fe.prev,Fe,Fe.next)>=0||(Fe=Fe.prevZ,qe.x>=he&&qe.x<=Le&&qe.y>=fe&&qe.y<=Pe&&qe!==T&&qe!==k&&oh(B,Q,F,ee,j,ae,qe.x,qe.y)&&Ni(qe.prev,qe,qe.next)>=0))return!1;qe=qe.nextZ}for(;Fe&&Fe.z>=Ve;){if(Fe.x>=he&&Fe.x<=Le&&Fe.y>=fe&&Fe.y<=Pe&&Fe!==T&&Fe!==k&&oh(B,Q,F,ee,j,ae,Fe.x,Fe.y)&&Ni(Fe.prev,Fe,Fe.next)>=0)return!1;Fe=Fe.prevZ}for(;qe&&qe.z<=Qe;){if(qe.x>=he&&qe.x<=Le&&qe.y>=fe&&qe.y<=Pe&&qe!==T&&qe!==k&&oh(B,Q,F,ee,j,ae,qe.x,qe.y)&&Ni(qe.prev,qe,qe.next)>=0)return!1;qe=qe.nextZ}return!0}function aM(c,o,h){var g=c;do{var T=g.prev,C=g.next.next;!lA(T,C)&&y7(T,g,g.next,C)&&X1(T,C)&&X1(C,T)&&(o.push(T.i/h|0),o.push(g.i/h|0),o.push(C.i/h|0),Q1(g),Q1(g.next),g=c=C),g=g.next}while(g!==c);return Oc(g)}function lM(c,o,h,g,T,C){var k=c;do{for(var B=k.next.next;B!==k.prev;){if(k.i!==B.i&&AM(k,B)){var F=v7(k,B);return k=Oc(k,k.next),F=Oc(F,F.next),Z1(k,o,h,g,T,C,0),void Z1(F,o,h,g,T,C,0)}B=B.next}k=k.next}while(k!==c)}function cM(c,o){return c.x-o.x}function uM(c,o){var h=function(T,C){var k,B=C,F=T.x,j=T.y,Q=-1/0;do{if(j<=B.y&&j>=B.next.y&&B.next.y!==B.y){var ee=B.x+(j-B.y)*(B.next.x-B.x)/(B.next.y-B.y);if(ee<=F&&ee>Q&&(Q=ee,k=B.x<B.next.x?B:B.next,ee===F))return k}B=B.next}while(B!==C);if(!k)return null;var ae,he=k,fe=k.x,Le=k.y,Pe=1/0;B=k;do F>=B.x&&B.x>=fe&&F!==B.x&&oh(j<Le?F:Q,j,fe,Le,j<Le?Q:F,j,B.x,B.y)&&(ae=Math.abs(j-B.y)/(F-B.x),X1(B,T)&&(ae<Pe||ae===Pe&&(B.x>k.x||B.x===k.x&&hM(k,B)))&&(k=B,Pe=ae)),B=B.next;while(B!==he);return k}(c,o);if(!h)return o;var g=v7(h,c);return Oc(g,g.next),Oc(h,h.next)}function hM(c,o){return Ni(c.prev,c,o.prev)<0&&Ni(o.next,c,c.next)<0}function Q3(c,o,h,g,T){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-h)*T|0)|c<<8))|c<<4))|c<<2))|c<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-g)*T|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function fM(c){var o=c,h=c;do(o.x<h.x||o.x===h.x&&o.y<h.y)&&(h=o),o=o.next;while(o!==c);return h}function oh(c,o,h,g,T,C,k,B){return(T-k)*(o-B)>=(c-k)*(C-B)&&(c-k)*(g-B)>=(h-k)*(o-B)&&(h-k)*(C-B)>=(T-k)*(g-B)}function AM(c,o){return c.next.i!==o.i&&c.prev.i!==o.i&&!function(h,g){var T=h;do{if(T.i!==h.i&&T.next.i!==h.i&&T.i!==g.i&&T.next.i!==g.i&&y7(T,T.next,h,g))return!0;T=T.next}while(T!==h);return!1}(c,o)&&(X1(c,o)&&X1(o,c)&&function(h,g){var T=h,C=!1,k=(h.x+g.x)/2,B=(h.y+g.y)/2;do T.y>B!=T.next.y>B&&T.next.y!==T.y&&k<(T.next.x-T.x)*(B-T.y)/(T.next.y-T.y)+T.x&&(C=!C),T=T.next;while(T!==h);return C}(c,o)&&(Ni(c.prev,c,o.prev)||Ni(c,o.prev,o))||lA(c,o)&&Ni(c.prev,c,c.next)>0&&Ni(o.prev,o,o.next)>0)}function Ni(c,o,h){return(o.y-c.y)*(h.x-o.x)-(o.x-c.x)*(h.y-o.y)}function lA(c,o){return c.x===o.x&&c.y===o.y}function y7(c,o,h,g){var T=uA(Ni(c,o,h)),C=uA(Ni(c,o,g)),k=uA(Ni(h,g,c)),B=uA(Ni(h,g,o));return T!==C&&k!==B||!(T!==0||!cA(c,h,o))||!(C!==0||!cA(c,g,o))||!(k!==0||!cA(h,c,g))||!(B!==0||!cA(h,o,g))}function cA(c,o,h){return o.x<=Math.max(c.x,h.x)&&o.x>=Math.min(c.x,h.x)&&o.y<=Math.max(c.y,h.y)&&o.y>=Math.min(c.y,h.y)}function uA(c){return c>0?1:c<0?-1:0}function X1(c,o){return Ni(c.prev,c,c.next)<0?Ni(c,o,c.next)>=0&&Ni(c,c.prev,o)>=0:Ni(c,o,c.prev)<0||Ni(c,c.next,o)<0}function v7(c,o){var h=new Y3(c.i,c.x,c.y),g=new Y3(o.i,o.x,o.y),T=c.next,C=o.prev;return c.next=o,o.prev=c,h.next=T,T.prev=h,g.next=h,h.prev=g,C.next=g,g.prev=C,g}function x7(c,o,h,g){var T=new Y3(c,o,h);return g?(T.next=g.next,T.prev=g,g.next.prev=T,g.next=T):(T.prev=T,T.next=T),T}function Q1(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Y3(c,o,h){this.i=c,this.x=o,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function K3(c,o,h,g){for(var T=0,C=o,k=h-g;C<h;C+=g)T+=(c[k]-c[C])*(c[C+1]+c[k+1]),k=C;return T}function dM(c,o,h,g,T){w7(c,o,h||0,g||c.length-1,T||pM)}function w7(c,o,h,g,T){for(;g>h;){if(g-h>600){var C=g-h+1,k=o-h+1,B=Math.log(C),F=.5*Math.exp(2*B/3),j=.5*Math.sqrt(B*F*(C-F)/C)*(k-C/2<0?-1:1);w7(c,o,Math.max(h,Math.floor(o-k*F/C+j)),Math.min(g,Math.floor(o+(C-k)*F/C+j)),T)}var Q=c[o],ee=h,ae=g;for(Y1(c,h,o),T(c[g],Q)>0&&Y1(c,h,g);ee<ae;){for(Y1(c,ee,ae),ee++,ae--;T(c[ee],Q)<0;)ee++;for(;T(c[ae],Q)>0;)ae--}T(c[h],Q)===0?Y1(c,h,ae):Y1(c,++ae,g),ae<=o&&(h=ae+1),o<=ae&&(g=ae-1)}}function Y1(c,o,h){var g=c[o];c[o]=c[h],c[h]=g}function pM(c,o){return c<o?-1:c>o?1:0}function J3(c,o){const h=c.length;if(h<=1)return[c];const g=[];let T,C;for(let k=0;k<h;k++){const B=$e(c[k]);B!==0&&(c[k].area=Math.abs(B),C===void 0&&(C=B<0),C===B<0?(T&&g.push(T),T=[c[k]]):T.push(c[k]))}if(T&&g.push(T),o>1)for(let k=0;k<g.length;k++)g[k].length<=o||(dM(g[k],o,1,g[k].length-1,mM),g[k]=g[k].slice(0,o));return g}function mM(c,o){return o.area-c.area}function em(c,o,h){const g=h.patternDependencies;let T=!1;for(const C of o){const k=C.paint.get(`${c}-pattern`);k.isConstant()||(T=!0);const B=k.constantOr(null);B&&(T=!0,g[B.to]=!0,g[B.from]=!0)}return T}function tm(c,o,h,g,T){const C=T.patternDependencies;for(const k of o){const B=k.paint.get(`${c}-pattern`).value;if(B.kind!=="constant"){let F=B.evaluate({zoom:g-1},h,{},T.availableImages),j=B.evaluate({zoom:g},h,{},T.availableImages),Q=B.evaluate({zoom:g+1},h,{},T.availableImages);F=F&&F.name?F.name:F,j=j&&j.name?j.name:j,Q=Q&&Q.name?Q.name:Q,C[F]=!0,C[j]=!0,C[Q]=!0,h.patterns[k.id]={min:F,mid:j,max:Q}}}return h}oA.exports=aA,oA.exports.default=aA,aA.deviation=function(c,o,h,g){var T=o&&o.length,C=Math.abs(K3(c,0,T?o[0]*h:c.length,h));if(T)for(var k=0,B=o.length;k<B;k++)C-=Math.abs(K3(c,o[k]*h,k<B-1?o[k+1]*h:c.length,h));var F=0;for(k=0;k<g.length;k+=3){var j=g[k]*h,Q=g[k+1]*h,ee=g[k+2]*h;F+=Math.abs((c[j]-c[ee])*(c[Q+1]-c[j+1])-(c[j]-c[Q])*(c[ee+1]-c[j+1]))}return C===0&&F===0?0:Math.abs((F-C)/C)},aA.flatten=function(c){for(var o=c[0][0].length,h={vertices:[],holes:[],dimensions:o},g=0,T=0;T<c.length;T++){for(var C=0;C<c[T].length;C++)for(var k=0;k<o;k++)h.vertices.push(c[T][C][k]);T>0&&h.holes.push(g+=c[T-1].length)}return h};class nm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(h=>h.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new H,this.indexArray=new We,this.indexArray2=new Oe,this.programConfigurations=new Rc(o.layers,o.zoom),this.segments=new rt,this.segments2=new rt,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(o,h,g){this.hasPattern=em("fill",this.layers,h);const T=this.layers[0].layout.get("fill-sort-key"),C=!T.isConstant(),k=[];for(const{feature:B,id:F,index:j,sourceLayerIndex:Q}of o){const ee=this.layers[0]._featureFilter.needGeometry,ae=Bc(B,ee);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),ae,g))continue;const he=C?T.evaluate(ae,{},g,h.availableImages):void 0,fe={id:F,properties:B.properties,type:B.type,sourceLayerIndex:Q,index:j,geometry:ee?ae.geometry:zc(B),patterns:{},sortKey:he};k.push(fe)}C&&k.sort((B,F)=>B.sortKey-F.sortKey);for(const B of k){const{geometry:F,index:j,sourceLayerIndex:Q}=B;if(this.hasPattern){const ee=tm("fill",this.layers,B,this.zoom,h);this.patternFeatures.push(ee)}else this.addFeature(B,F,j,g,{});h.featureIndex.insert(o[j].feature,F,j,Q,this.index)}}update(o,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,h,this.stateDependentLayers,g)}addFeatures(o,h,g){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,h,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,rM),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,h,g,T,C){for(const k of J3(h,500)){let B=0;for(const he of k)B+=he.length;const F=this.segments.prepareSegment(B,this.layoutVertexArray,this.indexArray),j=F.vertexLength,Q=[],ee=[];for(const he of k){if(he.length===0)continue;he!==k[0]&&ee.push(Q.length/2);const fe=this.segments2.prepareSegment(he.length,this.layoutVertexArray,this.indexArray2),Le=fe.vertexLength;this.layoutVertexArray.emplaceBack(he[0].x,he[0].y),this.indexArray2.emplaceBack(Le+he.length-1,Le),Q.push(he[0].x),Q.push(he[0].y);for(let Pe=1;Pe<he.length;Pe++)this.layoutVertexArray.emplaceBack(he[Pe].x,he[Pe].y),this.indexArray2.emplaceBack(Le+Pe-1,Le+Pe),Q.push(he[Pe].x),Q.push(he[Pe].y);fe.vertexLength+=he.length,fe.primitiveLength+=he.length}const ae=oA.exports(Q,ee);for(let he=0;he<ae.length;he+=3)this.indexArray.emplaceBack(j+ae[he],j+ae[he+1],j+ae[he+2]);F.vertexLength+=B,F.primitiveLength+=ae.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,C,T)}}zt("FillBucket",nm,{omit:["layers","patternFeatures"]});const gM=new er({"fill-sort-key":new Kt(et.layout_fill["fill-sort-key"])});var _M={paint:new er({"fill-antialias":new Ht(et.paint_fill["fill-antialias"]),"fill-opacity":new Kt(et.paint_fill["fill-opacity"]),"fill-color":new Kt(et.paint_fill["fill-color"]),"fill-outline-color":new Kt(et.paint_fill["fill-outline-color"]),"fill-translate":new Ht(et.paint_fill["fill-translate"]),"fill-translate-anchor":new Ht(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ji(et.paint_fill["fill-pattern"])}),layout:gM};const yM=zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),vM=zi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:xM}=yM;var C0={},wM=Ft,b7=ah;function ah(c,o,h,g,T){this.properties={},this.extent=h,this.type=0,this._pbf=c,this._geometry=-1,this._keys=g,this._values=T,c.readFields(bM,this,o)}function bM(c,o,h){c==1?o.id=h.readVarint():c==2?function(g,T){for(var C=g.readVarint()+g.pos;g.pos<C;){var k=T._keys[g.readVarint()],B=T._values[g.readVarint()];T.properties[k]=B}}(h,o):c==3?o.type=h.readVarint():c==4&&(o._geometry=h.pos)}function EM(c){for(var o,h,g=0,T=0,C=c.length,k=C-1;T<C;k=T++)g+=((h=c[k]).x-(o=c[T]).x)*(o.y+h.y);return g}ah.types=["Unknown","Point","LineString","Polygon"],ah.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var o,h=c.readVarint()+c.pos,g=1,T=0,C=0,k=0,B=[];c.pos<h;){if(T<=0){var F=c.readVarint();g=7&F,T=F>>3}if(T--,g===1||g===2)C+=c.readSVarint(),k+=c.readSVarint(),g===1&&(o&&B.push(o),o=[]),o.push(new wM(C,k));else{if(g!==7)throw new Error("unknown command "+g);o&&o.push(o[0].clone())}}return o&&B.push(o),B},ah.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var o=c.readVarint()+c.pos,h=1,g=0,T=0,C=0,k=1/0,B=-1/0,F=1/0,j=-1/0;c.pos<o;){if(g<=0){var Q=c.readVarint();h=7&Q,g=Q>>3}if(g--,h===1||h===2)(T+=c.readSVarint())<k&&(k=T),T>B&&(B=T),(C+=c.readSVarint())<F&&(F=C),C>j&&(j=C);else if(h!==7)throw new Error("unknown command "+h)}return[k,F,B,j]},ah.prototype.toGeoJSON=function(c,o,h){var g,T,C=this.extent*Math.pow(2,h),k=this.extent*c,B=this.extent*o,F=this.loadGeometry(),j=ah.types[this.type];function Q(he){for(var fe=0;fe<he.length;fe++){var Le=he[fe];he[fe]=[360*(Le.x+k)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(Le.y+B)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var ee=[];for(g=0;g<F.length;g++)ee[g]=F[g][0];Q(F=ee);break;case 2:for(g=0;g<F.length;g++)Q(F[g]);break;case 3:for(F=function(he){var fe=he.length;if(fe<=1)return[he];for(var Le,Pe,Ve=[],Qe=0;Qe<fe;Qe++){var Fe=EM(he[Qe]);Fe!==0&&(Pe===void 0&&(Pe=Fe<0),Pe===Fe<0?(Le&&Ve.push(Le),Le=[he[Qe]]):Le.push(he[Qe]))}return Le&&Ve.push(Le),Ve}(F),g=0;g<F.length;g++)for(T=0;T<F[g].length;T++)Q(F[g][T])}F.length===1?F=F[0]:j="Multi"+j;var ae={type:"Feature",geometry:{type:j,coordinates:F},properties:this.properties};return"id"in this&&(ae.id=this.id),ae};var TM=b7,E7=T7;function T7(c,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(SM,this,o),this.length=this._features.length}function SM(c,o,h){c===15?o.version=h.readVarint():c===1?o.name=h.readString():c===5?o.extent=h.readVarint():c===2?o._features.push(h.pos):c===3?o._keys.push(h.readString()):c===4&&o._values.push(function(g){for(var T=null,C=g.readVarint()+g.pos;g.pos<C;){var k=g.readVarint()>>3;T=k===1?g.readString():k===2?g.readFloat():k===3?g.readDouble():k===4?g.readVarint64():k===5?g.readVarint():k===6?g.readSVarint():k===7?g.readBoolean():null}return T}(h))}T7.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var o=this._pbf.readVarint()+this._pbf.pos;return new TM(this._pbf,o,this.extent,this._keys,this._values)};var CM=E7;function PM(c,o,h){if(c===3){var g=new CM(h,h.readVarint()+h.pos);g.length&&(o[g.name]=g)}}C0.VectorTile=function(c,o){this.layers=c.readFields(PM,{},o)},C0.VectorTileFeature=b7,C0.VectorTileLayer=E7;const MM=C0.VectorTileFeature.types,im=Math.pow(2,13);function K1(c,o,h,g,T,C,k,B){c.emplaceBack(o,h,2*Math.floor(g*im)+k,T*im*2,C*im*2,Math.round(B))}class rm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(h=>h.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new J,this.centroidVertexArray=new D,this.indexArray=new We,this.programConfigurations=new Rc(o.layers,o.zoom),this.segments=new rt,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(o,h,g){this.features=[],this.hasPattern=em("fill-extrusion",this.layers,h);for(const{feature:T,id:C,index:k,sourceLayerIndex:B}of o){const F=this.layers[0]._featureFilter.needGeometry,j=Bc(T,F);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),j,g))continue;const Q={id:C,sourceLayerIndex:B,index:k,geometry:F?j.geometry:zc(T),properties:T.properties,type:T.type,patterns:{}};this.hasPattern?this.features.push(tm("fill-extrusion",this.layers,Q,this.zoom,h)):this.addFeature(Q,Q.geometry,k,g,{}),h.featureIndex.insert(T,Q.geometry,k,B,this.index,!0)}}addFeatures(o,h,g){for(const T of this.features){const{geometry:C}=T;this.addFeature(T,C,T.index,h,g)}}update(o,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,h,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,xM),this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,vM.members,!0),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(o,h,g,T,C){const k={x:0,y:0,vertexCount:0};for(const B of J3(h,500)){let F=0;for(const fe of B)F+=fe.length;let j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const fe of B){if(fe.length===0||kM(fe))continue;let Le=0;for(let Pe=0;Pe<fe.length;Pe++){const Ve=fe[Pe];if(Pe>=1){const Qe=fe[Pe-1];if(!IM(Ve,Qe)){j.vertexLength+4>rt.MAX_VERTEX_ARRAY_LENGTH&&(j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Fe=Ve.sub(Qe)._perp()._unit(),qe=Qe.dist(Ve);Le+qe>32768&&(Le=0),K1(this.layoutVertexArray,Ve.x,Ve.y,Fe.x,Fe.y,0,0,Le),K1(this.layoutVertexArray,Ve.x,Ve.y,Fe.x,Fe.y,0,1,Le),k.x+=2*Ve.x,k.y+=2*Ve.y,k.vertexCount+=2,Le+=qe,K1(this.layoutVertexArray,Qe.x,Qe.y,Fe.x,Fe.y,0,0,Le),K1(this.layoutVertexArray,Qe.x,Qe.y,Fe.x,Fe.y,0,1,Le),k.x+=2*Qe.x,k.y+=2*Qe.y,k.vertexCount+=2;const at=j.vertexLength;this.indexArray.emplaceBack(at,at+2,at+1),this.indexArray.emplaceBack(at+1,at+2,at+3),j.vertexLength+=4,j.primitiveLength+=2}}}}if(j.vertexLength+F>rt.MAX_VERTEX_ARRAY_LENGTH&&(j=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray)),MM[o.type]!=="Polygon")continue;const Q=[],ee=[],ae=j.vertexLength;for(const fe of B)if(fe.length!==0){fe!==B[0]&&ee.push(Q.length/2);for(let Le=0;Le<fe.length;Le++){const Pe=fe[Le];K1(this.layoutVertexArray,Pe.x,Pe.y,0,0,1,1,0),k.x+=Pe.x,k.y+=Pe.y,k.vertexCount+=1,Q.push(Pe.x),Q.push(Pe.y)}}const he=oA.exports(Q,ee);for(let fe=0;fe<he.length;fe+=3)this.indexArray.emplaceBack(ae+he[fe],ae+he[fe+2],ae+he[fe+1]);j.primitiveLength+=he.length/3,j.vertexLength+=F}for(let B=0;B<k.vertexCount;B++)this.centroidVertexArray.emplaceBack(Math.floor(k.x/k.vertexCount),Math.floor(k.y/k.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,C,T)}}function IM(c,o){return c.x===o.x&&(c.x<0||c.x>tr)||c.y===o.y&&(c.y<0||c.y>tr)}function kM(c){return c.every(o=>o.x<0)||c.every(o=>o.x>tr)||c.every(o=>o.y<0)||c.every(o=>o.y>tr)}zt("FillExtrusionBucket",rm,{omit:["layers","features"]});var LM={paint:new er({"fill-extrusion-opacity":new Ht(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Kt(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ht(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ht(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ji(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Kt(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Kt(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ht(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function J1(c,o){return c.x*o.x+c.y*o.y}function S7(c,o){if(c.length===1){let h=0;const g=o[h++];let T;for(;!T||g.equals(T);)if(T=o[h++],!T)return 1/0;for(;h<o.length;h++){const C=o[h],k=c[0],B=T.sub(g),F=C.sub(g),j=k.sub(g),Q=J1(B,B),ee=J1(B,F),ae=J1(F,F),he=J1(j,B),fe=J1(j,F),Le=Q*ae-ee*ee,Pe=(ae*he-ee*fe)/Le,Ve=(Q*fe-ee*he)/Le,Qe=g.z*(1-Pe-Ve)+T.z*Pe+C.z*Ve;if(isFinite(Qe))return Qe}return 1/0}{let h=1/0;for(const g of o)h=Math.min(h,g.z);return h}}const DM=zi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:RM}=DM,zM=zi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:BM}=zM,OM=C0.VectorTileFeature.types,FM=Math.cos(Math.PI/180*37.5),C7=Math.pow(2,14)/.5;class sm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(h=>h.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new Ae,this.layoutVertexArray2=new we,this.indexArray=new We,this.programConfigurations=new Rc(o.layers,o.zoom),this.segments=new rt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(o,h,g){this.hasPattern=em("line",this.layers,h);const T=this.layers[0].layout.get("line-sort-key"),C=!T.isConstant(),k=[];for(const{feature:B,id:F,index:j,sourceLayerIndex:Q}of o){const ee=this.layers[0]._featureFilter.needGeometry,ae=Bc(B,ee);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),ae,g))continue;const he=C?T.evaluate(ae,{},g):void 0,fe={id:F,properties:B.properties,type:B.type,sourceLayerIndex:Q,index:j,geometry:ee?ae.geometry:zc(B),patterns:{},sortKey:he};k.push(fe)}C&&k.sort((B,F)=>B.sortKey-F.sortKey);for(const B of k){const{geometry:F,index:j,sourceLayerIndex:Q}=B;if(this.hasPattern){const ee=tm("line",this.layers,B,this.zoom,h);this.patternFeatures.push(ee)}else this.addFeature(B,F,j,g,{});h.featureIndex.insert(o[j].feature,F,j,Q,this.index)}}update(o,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,h,this.stateDependentLayers,g)}addFeatures(o,h,g){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,h,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,BM)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,RM),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,h,g,T,C){const k=this.layers[0].layout,B=k.get("line-join").evaluate(o,{}),F=k.get("line-cap"),j=k.get("line-miter-limit"),Q=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const ee of h)this.addLine(ee,o,B,F,j,Q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,C,T)}addLine(o,h,g,T,C,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ve=0;Ve<o.length-1;Ve++)this.totalDistance+=o[Ve].dist(o[Ve+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const B=OM[h.type]==="Polygon";let F=o.length;for(;F>=2&&o[F-1].equals(o[F-2]);)F--;let j=0;for(;j<F-1&&o[j].equals(o[j+1]);)j++;if(F<(B?3:2))return;g==="bevel"&&(C=1.05);const Q=this.overscaling<=16?122880/(512*this.overscaling):0,ee=this.segments.prepareSegment(10*F,this.layoutVertexArray,this.indexArray);let ae,he,fe,Le,Pe;this.e1=this.e2=-1,B&&(ae=o[F-2],Pe=o[j].sub(ae)._unit()._perp());for(let Ve=j;Ve<F;Ve++){if(fe=Ve===F-1?B?o[j+1]:void 0:o[Ve+1],fe&&o[Ve].equals(fe))continue;Pe&&(Le=Pe),ae&&(he=ae),ae=o[Ve],Pe=fe?fe.sub(ae)._unit()._perp():Le,Le=Le||Pe;let Qe=Le.add(Pe);Qe.x===0&&Qe.y===0||Qe._unit();const Fe=Le.x*Pe.x+Le.y*Pe.y,qe=Qe.x*Pe.x+Qe.y*Pe.y,at=qe!==0?1/qe:1/0,ot=2*Math.sqrt(2-2*qe),Bt=qe<FM&&he&&fe,Gt=Le.x*Pe.y-Le.y*Pe.x>0;if(Bt&&Ve>j){const Et=ae.dist(he);if(Et>2*Q){const Rt=ae.sub(ae.sub(he)._mult(Q/Et)._round());this.updateDistance(he,Rt),this.addCurrentVertex(Rt,Le,0,0,ee),he=Rt}}const Dt=he&&fe;let Ct=Dt?g:B?"butt":T;if(Dt&&Ct==="round"&&(at<k?Ct="miter":at<=2&&(Ct="fakeround")),Ct==="miter"&&at>C&&(Ct="bevel"),Ct==="bevel"&&(at>2&&(Ct="flipbevel"),at<C&&(Ct="miter")),he&&this.updateDistance(he,ae),Ct==="miter")Qe._mult(at),this.addCurrentVertex(ae,Qe,0,0,ee);else if(Ct==="flipbevel"){if(at>100)Qe=Pe.mult(-1);else{const Et=at*Le.add(Pe).mag()/Le.sub(Pe).mag();Qe._perp()._mult(Et*(Gt?-1:1))}this.addCurrentVertex(ae,Qe,0,0,ee),this.addCurrentVertex(ae,Qe.mult(-1),0,0,ee)}else if(Ct==="bevel"||Ct==="fakeround"){const Et=-Math.sqrt(at*at-1),Rt=Gt?Et:0,Mt=Gt?0:Et;if(he&&this.addCurrentVertex(ae,Le,Rt,Mt,ee),Ct==="fakeround"){const gt=Math.round(180*ot/Math.PI/20);for(let nn=1;nn<gt;nn++){let $t=nn/gt;if($t!==.5){const mi=$t-.5;$t+=$t*mi*($t-1)*((1.0904+Fe*(Fe*(3.55645-1.43519*Fe)-3.2452))*mi*mi+(.848013+Fe*(.215638*Fe-1.06021)))}const Cn=Pe.sub(Le)._mult($t)._add(Le)._unit()._mult(Gt?-1:1);this.addHalfVertex(ae,Cn.x,Cn.y,!1,Gt,0,ee)}}fe&&this.addCurrentVertex(ae,Pe,-Rt,-Mt,ee)}else if(Ct==="butt")this.addCurrentVertex(ae,Qe,0,0,ee);else if(Ct==="square"){const Et=he?1:-1;this.addCurrentVertex(ae,Qe,Et,Et,ee)}else Ct==="round"&&(he&&(this.addCurrentVertex(ae,Le,0,0,ee),this.addCurrentVertex(ae,Le,1,1,ee,!0)),fe&&(this.addCurrentVertex(ae,Pe,-1,-1,ee,!0),this.addCurrentVertex(ae,Pe,0,0,ee)));if(Bt&&Ve<F-1){const Et=ae.dist(fe);if(Et>2*Q){const Rt=ae.add(fe.sub(ae)._mult(Q/Et)._round());this.updateDistance(ae,Rt),this.addCurrentVertex(Rt,Pe,0,0,ee),ae=Rt}}}}addCurrentVertex(o,h,g,T,C,k=!1){const B=h.y*T-h.x,F=-h.y-h.x*T;this.addHalfVertex(o,h.x+h.y*g,h.y-h.x*g,k,!1,g,C),this.addHalfVertex(o,B,F,k,!0,-T,C),this.distance>C7/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(o,h,g,T,C,k))}addHalfVertex({x:o,y:h},g,T,C,k,B,F){const j=.5*(this.lineClips?this.scaledDistance*(C7-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(C?1:0),(h<<1)+(k?1:0),Math.round(63*g)+128,Math.round(63*T)+128,1+(B===0?0:B<0?-1:1)|(63&j)<<2,j>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Q=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Q),F.primitiveLength++),k?this.e2=Q:this.e1=Q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(o,h){this.distance+=o.dist(h),this.updateScaledDistance()}}zt("LineBucket",sm,{omit:["layers","patternFeatures"]});const NM=new er({"line-cap":new Ht(et.layout_line["line-cap"]),"line-join":new Kt(et.layout_line["line-join"]),"line-miter-limit":new Ht(et.layout_line["line-miter-limit"]),"line-round-limit":new Ht(et.layout_line["line-round-limit"]),"line-sort-key":new Kt(et.layout_line["line-sort-key"])});var P7={paint:new er({"line-opacity":new Kt(et.paint_line["line-opacity"]),"line-color":new Kt(et.paint_line["line-color"]),"line-translate":new Ht(et.paint_line["line-translate"]),"line-translate-anchor":new Ht(et.paint_line["line-translate-anchor"]),"line-width":new Kt(et.paint_line["line-width"]),"line-gap-width":new Kt(et.paint_line["line-gap-width"]),"line-offset":new Kt(et.paint_line["line-offset"]),"line-blur":new Kt(et.paint_line["line-blur"]),"line-dasharray":new kc(et.paint_line["line-dasharray"]),"line-pattern":new Ji(et.paint_line["line-pattern"]),"line-gradient":new Po(et.paint_line["line-gradient"])}),layout:NM};const M7=new class extends Kt{possiblyEvaluate(c,o){return o=new fi(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(c,o)}evaluate(c,o,h,g){return o=q({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(c,o,h,g)}}(P7.paint.properties["line-width"].specification);function I7(c,o){return o>0?o+2*c:c}M7.useIntegerZoom=!0;const UM=zi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),VM=zi([{name:"a_projected_pos",components:3,type:"Float32"}],4);zi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const GM=zi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);zi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const k7=zi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jM=zi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function HM(c,o,h){return c.sections.forEach(g=>{g.text=function(T,C,k){const B=C.layout.get("text-transform").evaluate(k,{});return B==="uppercase"?T=T.toLocaleUpperCase():B==="lowercase"&&(T=T.toLocaleLowerCase()),Zr.applyArabicShaping&&(T=Zr.applyArabicShaping(T)),T}(g.text,o,h)}),c}zi([{name:"triangle",components:3,type:"Uint16"}]),zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),zi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),zi([{type:"Float32",name:"offsetX"}]),zi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const ef={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var mr=24,om=ci,L7=function(c,o,h,g,T){var C,k,B=8*T-g-1,F=(1<<B)-1,j=F>>1,Q=-7,ee=h?T-1:0,ae=h?-1:1,he=c[o+ee];for(ee+=ae,C=he&(1<<-Q)-1,he>>=-Q,Q+=B;Q>0;C=256*C+c[o+ee],ee+=ae,Q-=8);for(k=C&(1<<-Q)-1,C>>=-Q,Q+=g;Q>0;k=256*k+c[o+ee],ee+=ae,Q-=8);if(C===0)C=1-j;else{if(C===F)return k?NaN:1/0*(he?-1:1);k+=Math.pow(2,g),C-=j}return(he?-1:1)*k*Math.pow(2,C-g)},D7=function(c,o,h,g,T,C){var k,B,F,j=8*C-T-1,Q=(1<<j)-1,ee=Q>>1,ae=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,he=g?0:C-1,fe=g?1:-1,Le=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(B=isNaN(o)?1:0,k=Q):(k=Math.floor(Math.log(o)/Math.LN2),o*(F=Math.pow(2,-k))<1&&(k--,F*=2),(o+=k+ee>=1?ae/F:ae*Math.pow(2,1-ee))*F>=2&&(k++,F/=2),k+ee>=Q?(B=0,k=Q):k+ee>=1?(B=(o*F-1)*Math.pow(2,T),k+=ee):(B=o*Math.pow(2,ee-1)*Math.pow(2,T),k=0));T>=8;c[h+he]=255&B,he+=fe,B/=256,T-=8);for(k=k<<T|B,j+=T;j>0;c[h+he]=255&k,he+=fe,k/=256,j-=8);c[h+he-fe]|=128*Le};function ci(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}ci.Varint=0,ci.Fixed64=1,ci.Bytes=2,ci.Fixed32=5;var P0,am=4294967296,R7=1/am,z7=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Il(c){return c.type===ci.Bytes?c.readVarint()+c.pos:c.pos+1}function lh(c,o,h){return h?4294967296*o+(c>>>0):4294967296*(o>>>0)+(c>>>0)}function B7(c,o,h){var g=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));h.realloc(g);for(var T=h.pos-1;T>=c;T--)h.buf[T+g]=h.buf[T]}function WM(c,o){for(var h=0;h<c.length;h++)o.writeVarint(c[h])}function $M(c,o){for(var h=0;h<c.length;h++)o.writeSVarint(c[h])}function qM(c,o){for(var h=0;h<c.length;h++)o.writeFloat(c[h])}function ZM(c,o){for(var h=0;h<c.length;h++)o.writeDouble(c[h])}function XM(c,o){for(var h=0;h<c.length;h++)o.writeBoolean(c[h])}function QM(c,o){for(var h=0;h<c.length;h++)o.writeFixed32(c[h])}function YM(c,o){for(var h=0;h<c.length;h++)o.writeSFixed32(c[h])}function KM(c,o){for(var h=0;h<c.length;h++)o.writeFixed64(c[h])}function JM(c,o){for(var h=0;h<c.length;h++)o.writeSFixed64(c[h])}function hA(c,o){return(c[o]|c[o+1]<<8|c[o+2]<<16)+16777216*c[o+3]}function ch(c,o,h){c[h]=o,c[h+1]=o>>>8,c[h+2]=o>>>16,c[h+3]=o>>>24}function O7(c,o){return(c[o]|c[o+1]<<8|c[o+2]<<16)+(c[o+3]<<24)}function eI(c,o,h){c===1&&h.readMessage(tI,o)}function tI(c,o,h){if(c===3){const{id:g,bitmap:T,width:C,height:k,left:B,top:F,advance:j}=h.readMessage(nI,{});o.push({id:g,bitmap:new q1({width:C+6,height:k+6},T),metrics:{width:C,height:k,left:B,top:F,advance:j}})}}function nI(c,o,h){c===1?o.id=h.readVarint():c===2?o.bitmap=h.readBytes():c===3?o.width=h.readVarint():c===4?o.height=h.readVarint():c===5?o.left=h.readSVarint():c===6?o.top=h.readSVarint():c===7&&(o.advance=h.readVarint())}function F7(c){let o=0,h=0;for(const k of c)o+=k.w*k.h,h=Math.max(h,k.w);c.sort((k,B)=>B.h-k.h);const g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),h),h:1/0}];let T=0,C=0;for(const k of c)for(let B=g.length-1;B>=0;B--){const F=g[B];if(!(k.w>F.w||k.h>F.h)){if(k.x=F.x,k.y=F.y,C=Math.max(C,k.y+k.h),T=Math.max(T,k.x+k.w),k.w===F.w&&k.h===F.h){const j=g.pop();B<g.length&&(g[B]=j)}else k.h===F.h?(F.x+=k.w,F.w-=k.w):k.w===F.w?(F.y+=k.h,F.h-=k.h):(g.push({x:F.x+k.w,y:F.y,w:F.w-k.w,h:k.h}),F.y+=k.h,F.h-=k.h);break}}return{w:T,h:C,fill:o/(T*C)||0}}ci.prototype={destroy:function(){this.buf=null},readFields:function(c,o,h){for(h=h||this.length;this.pos<h;){var g=this.readVarint(),T=g>>3,C=this.pos;this.type=7&g,c(T,o,this),this.pos===C&&this.skip(g)}return o},readMessage:function(c,o){return this.readFields(c,o,this.readVarint()+this.pos)},readFixed32:function(){var c=hA(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=O7(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=hA(this.buf,this.pos)+hA(this.buf,this.pos+4)*am;return this.pos+=8,c},readSFixed64:function(){var c=hA(this.buf,this.pos)+O7(this.buf,this.pos+4)*am;return this.pos+=8,c},readFloat:function(){var c=L7(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=L7(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var o,h,g=this.buf;return o=127&(h=g[this.pos++]),h<128?o:(o|=(127&(h=g[this.pos++]))<<7,h<128?o:(o|=(127&(h=g[this.pos++]))<<14,h<128?o:(o|=(127&(h=g[this.pos++]))<<21,h<128?o:function(T,C,k){var B,F,j=k.buf;if(B=(112&(F=j[k.pos++]))>>4,F<128||(B|=(127&(F=j[k.pos++]))<<3,F<128)||(B|=(127&(F=j[k.pos++]))<<10,F<128)||(B|=(127&(F=j[k.pos++]))<<17,F<128)||(B|=(127&(F=j[k.pos++]))<<24,F<128)||(B|=(1&(F=j[k.pos++]))<<31,F<128))return lh(T,B,C);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(h=g[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,o=this.pos;return this.pos=c,c-o>=12&&z7?function(h,g,T){return z7.decode(h.subarray(g,T))}(this.buf,o,c):function(h,g,T){for(var C="",k=g;k<T;){var B,F,j,Q=h[k],ee=null,ae=Q>239?4:Q>223?3:Q>191?2:1;if(k+ae>T)break;ae===1?Q<128&&(ee=Q):ae===2?(192&(B=h[k+1]))==128&&(ee=(31&Q)<<6|63&B)<=127&&(ee=null):ae===3?(F=h[k+2],(192&(B=h[k+1]))==128&&(192&F)==128&&((ee=(15&Q)<<12|(63&B)<<6|63&F)<=2047||ee>=55296&&ee<=57343)&&(ee=null)):ae===4&&(F=h[k+2],j=h[k+3],(192&(B=h[k+1]))==128&&(192&F)==128&&(192&j)==128&&((ee=(15&Q)<<18|(63&B)<<12|(63&F)<<6|63&j)<=65535||ee>=1114112)&&(ee=null)),ee===null?(ee=65533,ae=1):ee>65535&&(ee-=65536,C+=String.fromCharCode(ee>>>10&1023|55296),ee=56320|1023&ee),C+=String.fromCharCode(ee),k+=ae}return C}(this.buf,o,c)},readBytes:function(){var c=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,c);return this.pos=c,o},readPackedVarint:function(c,o){if(this.type!==ci.Bytes)return c.push(this.readVarint(o));var h=Il(this);for(c=c||[];this.pos<h;)c.push(this.readVarint(o));return c},readPackedSVarint:function(c){if(this.type!==ci.Bytes)return c.push(this.readSVarint());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==ci.Bytes)return c.push(this.readBoolean());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==ci.Bytes)return c.push(this.readFloat());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==ci.Bytes)return c.push(this.readDouble());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==ci.Bytes)return c.push(this.readFixed32());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==ci.Bytes)return c.push(this.readSFixed32());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==ci.Bytes)return c.push(this.readFixed64());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==ci.Bytes)return c.push(this.readSFixed64());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readSFixed64());return c},skip:function(c){var o=7&c;if(o===ci.Varint)for(;this.buf[this.pos++]>127;);else if(o===ci.Bytes)this.pos=this.readVarint()+this.pos;else if(o===ci.Fixed32)this.pos+=4;else{if(o!==ci.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(c,o){this.writeVarint(c<<3|o)},realloc:function(c){for(var o=this.length||16;o<this.pos+c;)o*=2;if(o!==this.length){var h=new Uint8Array(o);h.set(this.buf),this.buf=h,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),ch(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),ch(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),ch(this.buf,-1&c,this.pos),ch(this.buf,Math.floor(c*R7),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),ch(this.buf,-1&c,this.pos),ch(this.buf,Math.floor(c*R7),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(o,h){var g,T;if(o>=0?(g=o%4294967296|0,T=o/4294967296|0):(T=~(-o/4294967296),4294967295^(g=~(-o%4294967296))?g=g+1|0:(g=0,T=T+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(C,k,B){B.buf[B.pos++]=127&C|128,C>>>=7,B.buf[B.pos++]=127&C|128,C>>>=7,B.buf[B.pos++]=127&C|128,C>>>=7,B.buf[B.pos++]=127&C|128,B.buf[B.pos]=127&(C>>>=7)}(g,0,h),function(C,k){var B=(7&C)<<4;k.buf[k.pos++]|=B|((C>>>=3)?128:0),C&&(k.buf[k.pos++]=127&C|((C>>>=7)?128:0),C&&(k.buf[k.pos++]=127&C|((C>>>=7)?128:0),C&&(k.buf[k.pos++]=127&C|((C>>>=7)?128:0),C&&(k.buf[k.pos++]=127&C|((C>>>=7)?128:0),C&&(k.buf[k.pos++]=127&C)))))}(T,h)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var o=this.pos;this.pos=function(g,T,C){for(var k,B,F=0;F<T.length;F++){if((k=T.charCodeAt(F))>55295&&k<57344){if(!B){k>56319||F+1===T.length?(g[C++]=239,g[C++]=191,g[C++]=189):B=k;continue}if(k<56320){g[C++]=239,g[C++]=191,g[C++]=189,B=k;continue}k=B-55296<<10|k-56320|65536,B=null}else B&&(g[C++]=239,g[C++]=191,g[C++]=189,B=null);k<128?g[C++]=k:(k<2048?g[C++]=k>>6|192:(k<65536?g[C++]=k>>12|224:(g[C++]=k>>18|240,g[C++]=k>>12&63|128),g[C++]=k>>6&63|128),g[C++]=63&k|128)}return C}(this.buf,c,this.pos);var h=this.pos-o;h>=128&&B7(o,h,this),this.pos=o-1,this.writeVarint(h),this.pos+=h},writeFloat:function(c){this.realloc(4),D7(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),D7(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var o=c.length;this.writeVarint(o),this.realloc(o);for(var h=0;h<o;h++)this.buf[this.pos++]=c[h]},writeRawMessage:function(c,o){this.pos++;var h=this.pos;c(o,this);var g=this.pos-h;g>=128&&B7(h,g,this),this.pos=h-1,this.writeVarint(g),this.pos+=g},writeMessage:function(c,o,h){this.writeTag(c,ci.Bytes),this.writeRawMessage(o,h)},writePackedVarint:function(c,o){o.length&&this.writeMessage(c,WM,o)},writePackedSVarint:function(c,o){o.length&&this.writeMessage(c,$M,o)},writePackedBoolean:function(c,o){o.length&&this.writeMessage(c,XM,o)},writePackedFloat:function(c,o){o.length&&this.writeMessage(c,qM,o)},writePackedDouble:function(c,o){o.length&&this.writeMessage(c,ZM,o)},writePackedFixed32:function(c,o){o.length&&this.writeMessage(c,QM,o)},writePackedSFixed32:function(c,o){o.length&&this.writeMessage(c,YM,o)},writePackedFixed64:function(c,o){o.length&&this.writeMessage(c,KM,o)},writePackedSFixed64:function(c,o){o.length&&this.writeMessage(c,JM,o)},writeBytesField:function(c,o){this.writeTag(c,ci.Bytes),this.writeBytes(o)},writeFixed32Field:function(c,o){this.writeTag(c,ci.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(c,o){this.writeTag(c,ci.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(c,o){this.writeTag(c,ci.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(c,o){this.writeTag(c,ci.Fixed64),this.writeSFixed64(o)},writeVarintField:function(c,o){this.writeTag(c,ci.Varint),this.writeVarint(o)},writeSVarintField:function(c,o){this.writeTag(c,ci.Varint),this.writeSVarint(o)},writeStringField:function(c,o){this.writeTag(c,ci.Bytes),this.writeString(o)},writeFloatField:function(c,o){this.writeTag(c,ci.Fixed32),this.writeFloat(o)},writeDoubleField:function(c,o){this.writeTag(c,ci.Fixed64),this.writeDouble(o)},writeBooleanField:function(c,o){this.writeVarintField(c,!!o)}};class lm{constructor(o,{pixelRatio:h,version:g,stretchX:T,stretchY:C,content:k}){this.paddedRect=o,this.pixelRatio=h,this.stretchX=T,this.stretchY=C,this.content=k,this.version=g}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class N7{constructor(o,h){const g={},T={};this.haveRenderCallbacks=[];const C=[];this.addImages(o,g,C),this.addImages(h,T,C);const{w:k,h:B}=F7(C),F=new to({width:k||1,height:B||1});for(const j in o){const Q=o[j],ee=g[j].paddedRect;to.copy(Q.data,F,{x:0,y:0},{x:ee.x+1,y:ee.y+1},Q.data)}for(const j in h){const Q=h[j],ee=T[j].paddedRect,ae=ee.x+1,he=ee.y+1,fe=Q.data.width,Le=Q.data.height;to.copy(Q.data,F,{x:0,y:0},{x:ae,y:he},Q.data),to.copy(Q.data,F,{x:0,y:Le-1},{x:ae,y:he-1},{width:fe,height:1}),to.copy(Q.data,F,{x:0,y:0},{x:ae,y:he+Le},{width:fe,height:1}),to.copy(Q.data,F,{x:fe-1,y:0},{x:ae-1,y:he},{width:1,height:Le}),to.copy(Q.data,F,{x:0,y:0},{x:ae+fe,y:he},{width:1,height:Le})}this.image=F,this.iconPositions=g,this.patternPositions=T}addImages(o,h,g){for(const T in o){const C=o[T],k={x:0,y:0,w:C.data.width+2,h:C.data.height+2};g.push(k),h[T]=new lm(k,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(T)}}patchUpdatedImages(o,h){o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const g in o.updatedImages)this.patchUpdatedImage(this.iconPositions[g],o.getImage(g),h),this.patchUpdatedImage(this.patternPositions[g],o.getImage(g),h)}patchUpdatedImage(o,h,g){if(!o||!h||o.version===h.version)return;o.version=h.version;const[T,C]=o.tl;g.update(h.data,void 0,{x:T,y:C})}}zt("ImagePosition",lm),zt("ImageAtlas",N7),a.WritingMode=void 0,(P0=a.WritingMode||(a.WritingMode={}))[P0.none=0]="none",P0[P0.horizontal=1]="horizontal",P0[P0.vertical=2]="vertical",P0[P0.horizontalOnly=3]="horizontalOnly";const fA=-17;class tf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,h){const g=new tf;return g.scale=o||1,g.fontStack=h,g}static forImage(o){const h=new tf;return h.imageName=o,h}}class uh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,h){const g=new uh;for(let T=0;T<o.sections.length;T++){const C=o.sections[T];C.image?g.addImageSection(C):g.addTextSection(C,h)}return g}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(){this.text=function(o){let h="";for(let g=0;g<o.length;g++){const T=o.charCodeAt(g+1)||null,C=o.charCodeAt(g-1)||null;h+=T&&Rs(T)&&!ef[o[g+1]]||C&&Rs(C)&&!ef[o[g-1]]||!ef[o[g]]?o[g]:ef[o[g]]}return h}(this.text)}trim(){let o=0;for(let g=0;g<this.text.length&&dA[this.text.charCodeAt(g)];g++)o++;let h=this.text.length;for(let g=this.text.length-1;g>=0&&g>=o&&dA[this.text.charCodeAt(g)];g--)h--;this.text=this.text.substring(o,h),this.sectionIndex=this.sectionIndex.slice(o,h)}substring(o,h){const g=new uh;return g.text=this.text.substring(o,h),g.sectionIndex=this.sectionIndex.slice(o,h),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,h)=>Math.max(o,this.sections[h].scale),0)}addTextSection(o,h){this.text+=o.text,this.sections.push(tf.forText(o.scale,o.fontStack||h));const g=this.sections.length-1;for(let T=0;T<o.text.length;++T)this.sectionIndex.push(g)}addImageSection(o){const h=o.image?o.image.name:"";if(h.length===0)return void Te("Can't add FormattedSection with an empty image.");const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(tf.forImage(h)),this.sectionIndex.push(this.sections.length-1)):Te("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function AA(c,o,h,g,T,C,k,B,F,j,Q,ee,ae,he,fe,Le){const Pe=uh.fromFeature(c,T);let Ve;ee===a.WritingMode.vertical&&Pe.verticalizePunctuation();const{processBidirectionalText:Qe,processStyledBidirectionalText:Fe}=Zr;if(Qe&&Pe.sections.length===1){Ve=[];const ot=Qe(Pe.toString(),cm(Pe,j,C,o,g,he,fe));for(const Bt of ot){const Gt=new uh;Gt.text=Bt,Gt.sections=Pe.sections;for(let Dt=0;Dt<Bt.length;Dt++)Gt.sectionIndex.push(0);Ve.push(Gt)}}else if(Fe){Ve=[];const ot=Fe(Pe.text,Pe.sectionIndex,cm(Pe,j,C,o,g,he,fe));for(const Bt of ot){const Gt=new uh;Gt.text=Bt[0],Gt.sectionIndex=Bt[1],Gt.sections=Pe.sections,Ve.push(Gt)}}else Ve=function(ot,Bt){const Gt=[],Dt=ot.text;let Ct=0;for(const Et of Bt)Gt.push(ot.substring(Ct,Et)),Ct=Et;return Ct<Dt.length&&Gt.push(ot.substring(Ct,Dt.length)),Gt}(Pe,cm(Pe,j,C,o,g,he,fe));const qe=[],at={positionedLines:qe,text:Pe.toString(),top:Q[1],bottom:Q[1],left:Q[0],right:Q[0],writingMode:ee,iconsInText:!1,verticalizable:!1};return function(ot,Bt,Gt,Dt,Ct,Et,Rt,Mt,gt,nn,$t,Cn){let mi=0,_i=fA,nr=0,io=0;const Er=Mt==="right"?1:Mt==="left"?0:.5;let qi=0;for(const Zi of Ct){Zi.trim();const Sr=Zi.getMaxScale(),Or=(Sr-1)*mr,Yr={positionedGlyphs:[],lineOffset:0};ot.positionedLines[qi]=Yr;const _s=Yr.positionedGlyphs;let ys=0;if(!Zi.length()){_i+=Et,++qi;continue}for(let lr=0;lr<Zi.length();lr++){const Bn=Zi.getSection(lr),Bs=Zi.getSectionIndex(lr),Cr=Zi.getCharCode(lr);let Fr=0,Io=null,na=null,ia=null,Ll=mr;const ko=!(gt===a.WritingMode.horizontal||!$t&&!E0(Cr)||$t&&(dA[Cr]||(ar=Cr,kt.Arabic(ar)||kt["Arabic Supplement"](ar)||kt["Arabic Extended-A"](ar)||kt["Arabic Presentation Forms-A"](ar)||kt["Arabic Presentation Forms-B"](ar))));if(Bn.imageName){const ro=Dt[Bn.imageName];if(!ro)continue;ia=Bn.imageName,ot.iconsInText=ot.iconsInText||!0,na=ro.paddedRect;const vs=ro.displaySize;Bn.scale=Bn.scale*mr/Cn,Io={width:vs[0],height:vs[1],left:1,top:-3,advance:ko?vs[1]:vs[0]},Fr=Or+(mr-vs[1]*Bn.scale),Ll=Io.advance;const Dl=ko?vs[0]*Bn.scale-mr*Sr:vs[1]*Bn.scale-mr*Sr;Dl>0&&Dl>ys&&(ys=Dl)}else{const ro=Gt[Bn.fontStack],vs=ro&&ro[Cr];if(vs&&vs.rect)na=vs.rect,Io=vs.metrics;else{const Dl=Bt[Bn.fontStack],sf=Dl&&Dl[Cr];if(!sf)continue;Io=sf.metrics}Fr=(Sr-Bn.scale)*mr}ko?(ot.verticalizable=!0,_s.push({glyph:Cr,imageName:ia,x:mi,y:_i+Fr,vertical:ko,scale:Bn.scale,fontStack:Bn.fontStack,sectionIndex:Bs,metrics:Io,rect:na}),mi+=Ll*Bn.scale+nn):(_s.push({glyph:Cr,imageName:ia,x:mi,y:_i+Fr,vertical:ko,scale:Bn.scale,fontStack:Bn.fontStack,sectionIndex:Bs,metrics:Io,rect:na}),mi+=Io.advance*Bn.scale+nn)}_s.length!==0&&(nr=Math.max(mi-nn,nr),sI(_s,0,_s.length-1,Er,ys)),mi=0;const Ei=Et*Sr+ys;Yr.lineOffset=Math.max(ys,Or),_i+=Ei,io=Math.max(Ei,io),++qi}var ar;const Tr=_i-fA,{horizontalAlign:Br,verticalAlign:gs}=um(Rt);(function(Zi,Sr,Or,Yr,_s,ys,Ei,lr,Bn){const Bs=(Sr-Or)*_s;let Cr=0;Cr=ys!==Ei?-lr*Yr-fA:(-Yr*Bn+.5)*Ei;for(const Fr of Zi)for(const Io of Fr.positionedGlyphs)Io.x+=Bs,Io.y+=Cr})(ot.positionedLines,Er,Br,gs,nr,io,Et,Tr,Ct.length),ot.top+=-gs*Tr,ot.bottom=ot.top+Tr,ot.left+=-Br*nr,ot.right=ot.left+nr}(at,o,h,g,Ve,k,B,F,ee,j,ae,Le),!function(ot){for(const Bt of ot)if(Bt.positionedGlyphs.length!==0)return!1;return!0}(qe)&&at}const dA={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},iI={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function U7(c,o,h,g,T,C){if(o.imageName){const k=g[o.imageName];return k?k.displaySize[0]*o.scale*mr/C+T:0}{const k=h[o.fontStack],B=k&&k[c];return B?B.metrics.advance*o.scale+T:0}}function V7(c,o,h,g){const T=Math.pow(c-o,2);return g?c<o?T/2:2*T:T+Math.abs(h)*h}function rI(c,o,h){let g=0;return c===10&&(g-=1e4),h&&(g+=150),c!==40&&c!==65288||(g+=50),o!==41&&o!==65289||(g+=50),g}function G7(c,o,h,g,T,C){let k=null,B=V7(o,h,T,C);for(const F of g){const j=V7(o-F.x,h,T,C)+F.badness;j<=B&&(k=F,B=j)}return{index:c,x:o,priorBreak:k,badness:B}}function j7(c){return c?j7(c.priorBreak).concat(c.index):[]}function cm(c,o,h,g,T,C,k){if(C!=="point")return[];if(!c)return[];const B=[],F=function(ae,he,fe,Le,Pe,Ve){let Qe=0;for(let Fe=0;Fe<ae.length();Fe++){const qe=ae.getSection(Fe);Qe+=U7(ae.getCharCode(Fe),qe,Le,Pe,he,Ve)}return Qe/Math.max(1,Math.ceil(Qe/fe))}(c,o,h,g,T,k),j=c.text.indexOf("")>=0;let Q=0;for(let ae=0;ae<c.length();ae++){const he=c.getSection(ae),fe=c.getCharCode(ae);if(dA[fe]||(Q+=U7(fe,he,g,T,o,k)),ae<c.length()-1){const Le=!((ee=fe)<11904||!(kt["Bopomofo Extended"](ee)||kt.Bopomofo(ee)||kt["CJK Compatibility Forms"](ee)||kt["CJK Compatibility Ideographs"](ee)||kt["CJK Compatibility"](ee)||kt["CJK Radicals Supplement"](ee)||kt["CJK Strokes"](ee)||kt["CJK Symbols and Punctuation"](ee)||kt["CJK Unified Ideographs Extension A"](ee)||kt["CJK Unified Ideographs"](ee)||kt["Enclosed CJK Letters and Months"](ee)||kt["Halfwidth and Fullwidth Forms"](ee)||kt.Hiragana(ee)||kt["Ideographic Description Characters"](ee)||kt["Kangxi Radicals"](ee)||kt["Katakana Phonetic Extensions"](ee)||kt.Katakana(ee)||kt["Vertical Forms"](ee)||kt["Yi Radicals"](ee)||kt["Yi Syllables"](ee)));(iI[fe]||Le||he.imageName)&&B.push(G7(ae+1,Q,F,B,rI(fe,c.getCharCode(ae+1),Le&&j),!1))}}var ee;return j7(G7(c.length(),Q,F,B,0,!0))}function um(c){let o=.5,h=.5;switch(c){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:o,verticalAlign:h}}function sI(c,o,h,g,T){if(!g&&!T)return;const C=c[h],k=(c[h].x+C.metrics.advance*C.scale)*g;for(let B=o;B<=h;B++)c[B].x-=k,c[B].y+=T}function oI(c,o,h){const{horizontalAlign:g,verticalAlign:T}=um(h),C=o[0]-c.displaySize[0]*g,k=o[1]-c.displaySize[1]*T;return{image:c,top:k,bottom:k+c.displaySize[1],left:C,right:C+c.displaySize[0]}}function H7(c,o,h,g,T,C){const k=c.image;let B;if(k.content){const Pe=k.content,Ve=k.pixelRatio||1;B=[Pe[0]/Ve,Pe[1]/Ve,k.displaySize[0]-Pe[2]/Ve,k.displaySize[1]-Pe[3]/Ve]}const F=o.left*C,j=o.right*C;let Q,ee,ae,he;h==="width"||h==="both"?(he=T[0]+F-g[3],ee=T[0]+j+g[1]):(he=T[0]+(F+j-k.displaySize[0])/2,ee=he+k.displaySize[0]);const fe=o.top*C,Le=o.bottom*C;return h==="height"||h==="both"?(Q=T[1]+fe-g[0],ae=T[1]+Le+g[2]):(Q=T[1]+(fe+Le-k.displaySize[1])/2,ae=Q+k.displaySize[1]),{image:k,top:Q,right:ee,bottom:ae,left:he,collisionPadding:B}}const kl=128;function W7(c,o){const{expression:h}=o;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new fi(c+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:T}=h;let C=0;for(;C<g.length&&g[C]<=c;)C++;C=Math.max(0,C-1);let k=C;for(;k<g.length&&g[k]<c+1;)k++;k=Math.min(g.length-1,k);const B=g[C],F=g[k];return h.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:F,interpolationType:T}:{kind:"camera",minZoom:B,maxZoom:F,minSize:h.evaluate(new fi(B)),maxSize:h.evaluate(new fi(F)),interpolationType:T}}}class M0 extends Ft{constructor(o,h,g,T){super(o,h),this.angle=g,T!==void 0&&(this.segment=T)}clone(){return new M0(this.x,this.y,this.angle,this.segment)}}function $7(c,o,h,g,T){if(o.segment===void 0)return!0;let C=o,k=o.segment+1,B=0;for(;B>-h/2;){if(k--,k<0)return!1;B-=c[k].dist(C),C=c[k]}B+=c[k].dist(c[k+1]),k++;const F=[];let j=0;for(;B<h/2;){const Q=c[k],ee=c[k+1];if(!ee)return!1;let ae=c[k-1].angleTo(Q)-Q.angleTo(ee);for(ae=Math.abs((ae+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:B,angleDelta:ae}),j+=ae;B-F[0].distance>g;)j-=F.shift().angleDelta;if(j>T)return!1;k++,B+=Q.dist(ee)}return!0}function q7(c){let o=0;for(let h=0;h<c.length-1;h++)o+=c[h].dist(c[h+1]);return o}function Z7(c,o,h){return c?.6*o*h:0}function X7(c,o){return Math.max(c?c.right-c.left:0,o?o.right-o.left:0)}function aI(c,o,h,g,T,C){const k=Z7(h,T,C),B=X7(h,g)*C;let F=0;const j=q7(c)/2;for(let Q=0;Q<c.length-1;Q++){const ee=c[Q],ae=c[Q+1],he=ee.dist(ae);if(F+he>j){const fe=(j-F)/he,Le=xn(ee.x,ae.x,fe),Pe=xn(ee.y,ae.y,fe),Ve=new M0(Le,Pe,ae.angleTo(ee),Q);return Ve._round(),!k||$7(c,Ve,B,k,o)?Ve:void 0}F+=he}}function lI(c,o,h,g,T,C,k,B,F){const j=Z7(g,C,k),Q=X7(g,T),ee=Q*k,ae=c[0].x===0||c[0].x===F||c[0].y===0||c[0].y===F;return o-ee<o/4&&(o=ee+o/4),Q7(c,ae?o/2*B%o:(Q/2+2*C)*k*B%o,o,j,h,ee,ae,!1,F)}function Q7(c,o,h,g,T,C,k,B,F){const j=C/2,Q=q7(c);let ee=0,ae=o-h,he=[];for(let fe=0;fe<c.length-1;fe++){const Le=c[fe],Pe=c[fe+1],Ve=Le.dist(Pe),Qe=Pe.angleTo(Le);for(;ae+h<ee+Ve;){ae+=h;const Fe=(ae-ee)/Ve,qe=xn(Le.x,Pe.x,Fe),at=xn(Le.y,Pe.y,Fe);if(qe>=0&&qe<F&&at>=0&&at<F&&ae-j>=0&&ae+j<=Q){const ot=new M0(qe,at,Qe,fe);ot._round(),g&&!$7(c,ot,C,g,T)||he.push(ot)}}ee+=Ve}return B||he.length||k||(he=Q7(c,ee/2,h,g,T,C,k,!0,F)),he}function Y7(c,o,h,g,T){const C=[];for(let k=0;k<c.length;k++){const B=c[k];let F;for(let j=0;j<B.length-1;j++){let Q=B[j],ee=B[j+1];Q.x<o&&ee.x<o||(Q.x<o?Q=new Ft(o,Q.y+(o-Q.x)/(ee.x-Q.x)*(ee.y-Q.y))._round():ee.x<o&&(ee=new Ft(o,Q.y+(o-Q.x)/(ee.x-Q.x)*(ee.y-Q.y))._round()),Q.y<h&&ee.y<h||(Q.y<h?Q=new Ft(Q.x+(h-Q.y)/(ee.y-Q.y)*(ee.x-Q.x),h)._round():ee.y<h&&(ee=new Ft(Q.x+(h-Q.y)/(ee.y-Q.y)*(ee.x-Q.x),h)._round()),Q.x>=g&&ee.x>=g||(Q.x>=g?Q=new Ft(g,Q.y+(g-Q.x)/(ee.x-Q.x)*(ee.y-Q.y))._round():ee.x>=g&&(ee=new Ft(g,Q.y+(g-Q.x)/(ee.x-Q.x)*(ee.y-Q.y))._round()),Q.y>=T&&ee.y>=T||(Q.y>=T?Q=new Ft(Q.x+(T-Q.y)/(ee.y-Q.y)*(ee.x-Q.x),T)._round():ee.y>=T&&(ee=new Ft(Q.x+(T-Q.y)/(ee.y-Q.y)*(ee.x-Q.x),T)._round()),F&&Q.equals(F[F.length-1])||(F=[Q],C.push(F)),F.push(ee)))))}}return C}function K7(c,o,h,g){const T=[],C=c.image,k=C.pixelRatio,B=C.paddedRect.w-2,F=C.paddedRect.h-2,j=c.right-c.left,Q=c.bottom-c.top,ee=C.stretchX||[[0,B]],ae=C.stretchY||[[0,F]],he=(Et,Rt)=>Et+Rt[1]-Rt[0],fe=ee.reduce(he,0),Le=ae.reduce(he,0),Pe=B-fe,Ve=F-Le;let Qe=0,Fe=fe,qe=0,at=Le,ot=0,Bt=Pe,Gt=0,Dt=Ve;if(C.content&&g){const Et=C.content;Qe=pA(ee,0,Et[0]),qe=pA(ae,0,Et[1]),Fe=pA(ee,Et[0],Et[2]),at=pA(ae,Et[1],Et[3]),ot=Et[0]-Qe,Gt=Et[1]-qe,Bt=Et[2]-Et[0]-Fe,Dt=Et[3]-Et[1]-at}const Ct=(Et,Rt,Mt,gt)=>{const nn=mA(Et.stretch-Qe,Fe,j,c.left),$t=gA(Et.fixed-ot,Bt,Et.stretch,fe),Cn=mA(Rt.stretch-qe,at,Q,c.top),mi=gA(Rt.fixed-Gt,Dt,Rt.stretch,Le),_i=mA(Mt.stretch-Qe,Fe,j,c.left),nr=gA(Mt.fixed-ot,Bt,Mt.stretch,fe),io=mA(gt.stretch-qe,at,Q,c.top),Er=gA(gt.fixed-Gt,Dt,gt.stretch,Le),qi=new Ft(nn,Cn),ar=new Ft(_i,Cn),Tr=new Ft(_i,io),Br=new Ft(nn,io),gs=new Ft($t/k,mi/k),Zi=new Ft(nr/k,Er/k),Sr=o*Math.PI/180;if(Sr){const _s=Math.sin(Sr),ys=Math.cos(Sr),Ei=[ys,-_s,_s,ys];qi._matMult(Ei),ar._matMult(Ei),Br._matMult(Ei),Tr._matMult(Ei)}const Or=Et.stretch+Et.fixed,Yr=Rt.stretch+Rt.fixed;return{tl:qi,tr:ar,bl:Br,br:Tr,tex:{x:C.paddedRect.x+1+Or,y:C.paddedRect.y+1+Yr,w:Mt.stretch+Mt.fixed-Or,h:gt.stretch+gt.fixed-Yr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:gs,pixelOffsetBR:Zi,minFontScaleX:Bt/k/j,minFontScaleY:Dt/k/Q,isSDF:h}};if(g&&(C.stretchX||C.stretchY)){const Et=J7(ee,Pe,fe),Rt=J7(ae,Ve,Le);for(let Mt=0;Mt<Et.length-1;Mt++){const gt=Et[Mt],nn=Et[Mt+1];for(let $t=0;$t<Rt.length-1;$t++)T.push(Ct(gt,Rt[$t],nn,Rt[$t+1]))}}else T.push(Ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:F+1}));return T}function pA(c,o,h){let g=0;for(const T of c)g+=Math.max(o,Math.min(h,T[1]))-Math.max(o,Math.min(h,T[0]));return g}function J7(c,o,h){const g=[{fixed:-1,stretch:0}];for(const[T,C]of c){const k=g[g.length-1];g.push({fixed:T-k.stretch,stretch:k.stretch}),g.push({fixed:T-k.stretch,stretch:k.stretch+(C-T)})}return g.push({fixed:o+1,stretch:h}),g}function mA(c,o,h,g){return c/o*h+g}function gA(c,o,h,g){return c-o*h/g}zt("Anchor",M0);class _A{constructor(o,h,g,T,C,k,B,F,j,Q){if(this.boxStartIndex=o.length,j){let ee=k.top,ae=k.bottom;const he=k.collisionPadding;he&&(ee-=he[1],ae+=he[3]);let fe=ae-ee;fe>0&&(fe=Math.max(10,fe),this.circleDiameter=fe)}else{let ee=k.top*B-F[0],ae=k.bottom*B+F[2],he=k.left*B-F[3],fe=k.right*B+F[1];const Le=k.collisionPadding;if(Le&&(he-=Le[0]*B,ee-=Le[1]*B,fe+=Le[2]*B,ae+=Le[3]*B),Q){const Pe=new Ft(he,ee),Ve=new Ft(fe,ee),Qe=new Ft(he,ae),Fe=new Ft(fe,ae),qe=Q*Math.PI/180;Pe._rotate(qe),Ve._rotate(qe),Qe._rotate(qe),Fe._rotate(qe),he=Math.min(Pe.x,Ve.x,Qe.x,Fe.x),fe=Math.max(Pe.x,Ve.x,Qe.x,Fe.x),ee=Math.min(Pe.y,Ve.y,Qe.y,Fe.y),ae=Math.max(Pe.y,Ve.y,Qe.y,Fe.y)}o.emplaceBack(h.x,h.y,he,ee,fe,ae,g,T,C)}this.boxEndIndex=o.length}}class cI{constructor(o=[],h=uI){if(this.data=o,this.length=this.data.length,this.compare=h,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const o=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:h,compare:g}=this,T=h[o];for(;o>0;){const C=o-1>>1,k=h[C];if(g(T,k)>=0)break;h[o]=k,o=C}h[o]=T}_down(o){const{data:h,compare:g}=this,T=this.length>>1,C=h[o];for(;o<T;){let k=1+(o<<1),B=h[k];const F=k+1;if(F<this.length&&g(h[F],B)<0&&(k=F,B=h[F]),g(B,C)>=0)break;h[o]=B,o=k}h[o]=C}}function uI(c,o){return c<o?-1:c>o?1:0}function hI(c,o=1,h=!1){let g=1/0,T=1/0,C=-1/0,k=-1/0;const B=c[0];for(let he=0;he<B.length;he++){const fe=B[he];(!he||fe.x<g)&&(g=fe.x),(!he||fe.y<T)&&(T=fe.y),(!he||fe.x>C)&&(C=fe.x),(!he||fe.y>k)&&(k=fe.y)}const F=Math.min(C-g,k-T);let j=F/2;const Q=new cI([],fI);if(F===0)return new Ft(g,T);for(let he=g;he<C;he+=F)for(let fe=T;fe<k;fe+=F)Q.push(new hh(he+j,fe+j,j,c));let ee=function(he){let fe=0,Le=0,Pe=0;const Ve=he[0];for(let Qe=0,Fe=Ve.length,qe=Fe-1;Qe<Fe;qe=Qe++){const at=Ve[Qe],ot=Ve[qe],Bt=at.x*ot.y-ot.x*at.y;Le+=(at.x+ot.x)*Bt,Pe+=(at.y+ot.y)*Bt,fe+=3*Bt}return new hh(Le/fe,Pe/fe,0,he)}(c),ae=Q.length;for(;Q.length;){const he=Q.pop();(he.d>ee.d||!ee.d)&&(ee=he,h&&console.log("found best %d after %d probes",Math.round(1e4*he.d)/1e4,ae)),he.max-ee.d<=o||(j=he.h/2,Q.push(new hh(he.p.x-j,he.p.y-j,j,c)),Q.push(new hh(he.p.x+j,he.p.y-j,j,c)),Q.push(new hh(he.p.x-j,he.p.y+j,j,c)),Q.push(new hh(he.p.x+j,he.p.y+j,j,c)),ae+=4)}return h&&(console.log(`num probes: ${ae}`),console.log(`best distance: ${ee.d}`)),ee.p}function fI(c,o){return o.max-c.max}function hh(c,o,h,g){this.p=new Ft(c,o),this.h=h,this.d=function(T,C){let k=!1,B=1/0;for(let F=0;F<C.length;F++){const j=C[F];for(let Q=0,ee=j.length,ae=ee-1;Q<ee;ae=Q++){const he=j[Q],fe=j[ae];he.y>T.y!=fe.y>T.y&&T.x<(fe.x-he.x)*(T.y-he.y)/(fe.y-he.y)+he.x&&(k=!k),B=Math.min(B,a7(T,he,fe))}}return(k?1:-1)*Math.sqrt(B)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}const hm=Number.POSITIVE_INFINITY;function e9(c,o){return o[1]!==hm?function(h,g,T){let C=0,k=0;switch(g=Math.abs(g),T=Math.abs(T),h){case"top-right":case"top-left":case"top":k=T-7;break;case"bottom-right":case"bottom-left":case"bottom":k=7-T}switch(h){case"top-right":case"bottom-right":case"right":C=-g;break;case"top-left":case"bottom-left":case"left":C=g}return[C,k]}(c,o[0],o[1]):function(h,g){let T=0,C=0;g<0&&(g=0);const k=g/Math.sqrt(2);switch(h){case"top-right":case"top-left":C=k-7;break;case"bottom-right":case"bottom-left":C=7-k;break;case"bottom":C=7-g;break;case"top":C=g-7}switch(h){case"top-right":case"bottom-right":T=-k;break;case"top-left":case"bottom-left":T=k;break;case"left":T=g;break;case"right":T=-g}return[T,C]}(c,o[0])}function fm(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function AI(c,o,h,g,T,C,k,B,F,j,Q){let ee=C.textMaxSize.evaluate(o,{});ee===void 0&&(ee=k);const ae=c.layers[0].layout,he=ae.get("icon-offset").evaluate(o,{},Q),fe=n9(h.horizontal),Le=k/24,Pe=c.tilePixelRatio*Le,Ve=c.tilePixelRatio*ee/24,Qe=c.tilePixelRatio*B,Fe=c.tilePixelRatio*ae.get("symbol-spacing"),qe=ae.get("text-padding")*c.tilePixelRatio,at=function(gt,nn,$t,Cn=1){const mi=gt.get("icon-padding").evaluate(nn,{},$t),_i=mi&&mi.values;return[_i[0]*Cn,_i[1]*Cn,_i[2]*Cn,_i[3]*Cn]}(ae,o,Q,c.tilePixelRatio),ot=ae.get("text-max-angle")/180*Math.PI,Bt=ae.get("text-rotation-alignment")!=="viewport"&&ae.get("symbol-placement")!=="point",Gt=ae.get("icon-rotation-alignment")==="map"&&ae.get("symbol-placement")!=="point",Dt=ae.get("symbol-placement"),Ct=Fe/2,Et=ae.get("icon-text-fit");let Rt;g&&Et!=="none"&&(c.allowVerticalPlacement&&h.vertical&&(Rt=H7(g,h.vertical,Et,ae.get("icon-text-fit-padding"),he,Le)),fe&&(g=H7(g,fe,Et,ae.get("icon-text-fit-padding"),he,Le)));const Mt=(gt,nn)=>{nn.x<0||nn.x>=tr||nn.y<0||nn.y>=tr||function($t,Cn,mi,_i,nr,io,Er,qi,ar,Tr,Br,gs,Zi,Sr,Or,Yr,_s,ys,Ei,lr,Bn,Bs,Cr,Fr,Io){const na=$t.addToLineVertexArray(Cn,mi);let ia,Ll,ko,ro,vs=0,Dl=0,sf=0,_9=0,wm=-1,bm=-1;const Rl={};let y9=un.exports(""),Em=0,Tm=0;if(qi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Em,Tm]=qi.layout.get("text-offset").evaluate(Bn,{},Fr).map(xs=>xs*mr):(Em=qi.layout.get("text-radial-offset").evaluate(Bn,{},Fr)*mr,Tm=hm),$t.allowVerticalPlacement&&_i.vertical){const xs=qi.layout.get("text-rotate").evaluate(Bn,{},Fr)+90;ko=new _A(ar,Cn,Tr,Br,gs,_i.vertical,Zi,Sr,Or,xs),Er&&(ro=new _A(ar,Cn,Tr,Br,gs,Er,_s,ys,Or,xs))}if(nr){const xs=qi.layout.get("icon-rotate").evaluate(Bn,{}),Na=qi.layout.get("icon-text-fit")!=="none",of=K7(nr,xs,Cr,Na),af=Er?K7(Er,xs,Cr,Na):void 0;Ll=new _A(ar,Cn,Tr,Br,gs,nr,_s,ys,!1,xs),vs=4*of.length;const w9=$t.iconSizeData;let Nc=null;w9.kind==="source"?(Nc=[kl*qi.layout.get("icon-size").evaluate(Bn,{})],Nc[0]>I0&&Te(`${$t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):w9.kind==="composite"&&(Nc=[kl*Bs.compositeIconSizes[0].evaluate(Bn,{},Fr),kl*Bs.compositeIconSizes[1].evaluate(Bn,{},Fr)],(Nc[0]>I0||Nc[1]>I0)&&Te(`${$t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),$t.addSymbols($t.icon,of,Nc,lr,Ei,Bn,a.WritingMode.none,Cn,na.lineStartIndex,na.lineLength,-1,Fr),wm=$t.icon.placedSymbolArray.length-1,af&&(Dl=4*af.length,$t.addSymbols($t.icon,af,Nc,lr,Ei,Bn,a.WritingMode.vertical,Cn,na.lineStartIndex,na.lineLength,-1,Fr),bm=$t.icon.placedSymbolArray.length-1)}const v9=Object.keys(_i.horizontal);for(const xs of v9){const Na=_i.horizontal[xs];if(!ia){y9=un.exports(Na.text);const af=qi.layout.get("text-rotate").evaluate(Bn,{},Fr);ia=new _A(ar,Cn,Tr,Br,gs,Na,Zi,Sr,Or,af)}const of=Na.positionedLines.length===1;if(sf+=t9($t,Cn,Na,io,qi,Or,Bn,Yr,na,_i.vertical?a.WritingMode.horizontal:a.WritingMode.horizontalOnly,of?v9:[xs],Rl,wm,Bs,Fr),of)break}_i.vertical&&(_9+=t9($t,Cn,_i.vertical,io,qi,Or,Bn,Yr,na,a.WritingMode.vertical,["vertical"],Rl,bm,Bs,Fr));const SI=ia?ia.boxStartIndex:$t.collisionBoxArray.length,CI=ia?ia.boxEndIndex:$t.collisionBoxArray.length,PI=ko?ko.boxStartIndex:$t.collisionBoxArray.length,MI=ko?ko.boxEndIndex:$t.collisionBoxArray.length,II=Ll?Ll.boxStartIndex:$t.collisionBoxArray.length,kI=Ll?Ll.boxEndIndex:$t.collisionBoxArray.length,LI=ro?ro.boxStartIndex:$t.collisionBoxArray.length,DI=ro?ro.boxEndIndex:$t.collisionBoxArray.length;let ra=-1;const bA=(xs,Na)=>xs&&xs.circleDiameter?Math.max(xs.circleDiameter,Na):Na;ra=bA(ia,ra),ra=bA(ko,ra),ra=bA(Ll,ra),ra=bA(ro,ra);const x9=ra>-1?1:0;x9&&(ra*=Io/mr),$t.glyphOffsetArray.length>=fh.MAX_GLYPHS&&Te("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Bn.sortKey!==void 0&&$t.addToSortKeyRanges($t.symbolInstances.length,Bn.sortKey),$t.symbolInstances.emplaceBack(Cn.x,Cn.y,Rl.right>=0?Rl.right:-1,Rl.center>=0?Rl.center:-1,Rl.left>=0?Rl.left:-1,Rl.vertical||-1,wm,bm,y9,SI,CI,PI,MI,II,kI,LI,DI,Tr,sf,_9,vs,Dl,x9,0,Zi,Em,Tm,ra)}(c,nn,gt,h,g,T,Rt,c.layers[0],c.collisionBoxArray,o.index,o.sourceLayerIndex,c.index,Pe,[qe,qe,qe,qe],Bt,F,Qe,at,Gt,he,o,C,j,Q,k)};if(Dt==="line")for(const gt of Y7(o.geometry,0,0,tr,tr)){const nn=lI(gt,Fe,ot,h.vertical||fe,g,24,Ve,c.overscaling,tr);for(const $t of nn){const Cn=fe;Cn&&dI(c,Cn.text,Ct,$t)||Mt(gt,$t)}}else if(Dt==="line-center"){for(const gt of o.geometry)if(gt.length>1){const nn=aI(gt,ot,h.vertical||fe,g,24,Ve);nn&&Mt(gt,nn)}}else if(o.type==="Polygon")for(const gt of J3(o.geometry,0)){const nn=hI(gt,16);Mt(gt[0],new M0(nn.x,nn.y,0))}else if(o.type==="LineString")for(const gt of o.geometry)Mt(gt,new M0(gt[0].x,gt[0].y,0));else if(o.type==="Point")for(const gt of o.geometry)for(const nn of gt)Mt([nn],new M0(nn.x,nn.y,0))}const I0=32640;function t9(c,o,h,g,T,C,k,B,F,j,Q,ee,ae,he,fe){const Le=function(Qe,Fe,qe,at,ot,Bt,Gt,Dt){const Ct=at.layout.get("text-rotate").evaluate(Bt,{})*Math.PI/180,Et=[];for(const Rt of Fe.positionedLines)for(const Mt of Rt.positionedGlyphs){if(!Mt.rect)continue;const gt=Mt.rect||{};let nn=4,$t=!0,Cn=1,mi=0;const _i=(ot||Dt)&&Mt.vertical,nr=Mt.metrics.advance*Mt.scale/2;if(Dt&&Fe.verticalizable){const Ei=(Mt.scale-1)*mr,lr=(mr-Mt.metrics.width*Mt.scale)/2;mi=Rt.lineOffset/2-(Mt.imageName?-lr:Ei)}if(Mt.imageName){const Ei=Gt[Mt.imageName];$t=Ei.sdf,Cn=Ei.pixelRatio,nn=1/Cn}const io=ot?[Mt.x+nr,Mt.y]:[0,0];let Er=ot?[0,0]:[Mt.x+nr+qe[0],Mt.y+qe[1]-mi],qi=[0,0];_i&&(qi=Er,Er=[0,0]);const ar=(Mt.metrics.left-nn)*Mt.scale-nr+Er[0],Tr=(-Mt.metrics.top-nn)*Mt.scale+Er[1],Br=ar+gt.w*Mt.scale/Cn,gs=Tr+gt.h*Mt.scale/Cn,Zi=new Ft(ar,Tr),Sr=new Ft(Br,Tr),Or=new Ft(ar,gs),Yr=new Ft(Br,gs);if(_i){const Ei=new Ft(-nr,nr-fA),lr=-Math.PI/2,Bn=12-nr,Bs=new Ft(22-Bn,-(Mt.imageName?Bn:0)),Cr=new Ft(...qi);Zi._rotateAround(lr,Ei)._add(Bs)._add(Cr),Sr._rotateAround(lr,Ei)._add(Bs)._add(Cr),Or._rotateAround(lr,Ei)._add(Bs)._add(Cr),Yr._rotateAround(lr,Ei)._add(Bs)._add(Cr)}if(Ct){const Ei=Math.sin(Ct),lr=Math.cos(Ct),Bn=[lr,-Ei,Ei,lr];Zi._matMult(Bn),Sr._matMult(Bn),Or._matMult(Bn),Yr._matMult(Bn)}const _s=new Ft(0,0),ys=new Ft(0,0);Et.push({tl:Zi,tr:Sr,bl:Or,br:Yr,tex:gt,writingMode:Fe.writingMode,glyphOffset:io,sectionIndex:Mt.sectionIndex,isSDF:$t,pixelOffsetTL:_s,pixelOffsetBR:ys,minFontScaleX:0,minFontScaleY:0})}return Et}(0,h,B,T,C,k,g,c.allowVerticalPlacement),Pe=c.textSizeData;let Ve=null;Pe.kind==="source"?(Ve=[kl*T.layout.get("text-size").evaluate(k,{})],Ve[0]>I0&&Te(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Pe.kind==="composite"&&(Ve=[kl*he.compositeTextSizes[0].evaluate(k,{},fe),kl*he.compositeTextSizes[1].evaluate(k,{},fe)],(Ve[0]>I0||Ve[1]>I0)&&Te(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,Le,Ve,B,C,k,j,o,F.lineStartIndex,F.lineLength,ae,fe);for(const Qe of Q)ee[Qe]=c.text.placedSymbolArray.length-1;return 4*Le.length}function n9(c){for(const o in c)return c[o];return null}function dI(c,o,h,g){const T=c.compareText;if(o in T){const C=T[o];for(let k=C.length-1;k>=0;k--)if(g.dist(C[k])<h)return!0}else T[o]=[];return T[o].push(g),!1}const pI=C0.VectorTileFeature.types,mI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function yA(c,o,h,g,T,C,k,B,F,j,Q,ee,ae){const he=B?Math.min(I0,Math.round(B[0])):0,fe=B?Math.min(I0,Math.round(B[1])):0;c.emplaceBack(o,h,Math.round(32*g),Math.round(32*T),C,k,(he<<1)+(F?1:0),fe,16*j,16*Q,256*ee,256*ae)}function Am(c,o,h){c.emplaceBack(o.x,o.y,h),c.emplaceBack(o.x,o.y,h),c.emplaceBack(o.x,o.y,h),c.emplaceBack(o.x,o.y,h)}function gI(c){for(const o of c.sections)if(Yu(o.text))return!0;return!1}class dm{constructor(o){this.layoutVertexArray=new Ee,this.indexArray=new We,this.programConfigurations=o,this.segments=new rt,this.dynamicLayoutVertexArray=new Be,this.opacityVertexArray=new Je,this.placedSymbolArray=new d}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(o,h,g,T){this.isEmpty()||(g&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,UM.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,VM.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,mI,!0),this.opacityVertexBuffer.itemSize=1),(g||T)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}zt("SymbolBuffers",dm);class pm{constructor(o,h,g){this.layoutVertexArray=new o,this.layoutAttributes=h,this.indexArray=new g,this.segments=new rt,this.collisionVertexArray=new He}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,GM.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}zt("CollisionBuffers",pm);class fh{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(k=>k.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=q3([]),this.placementViewportMatrix=q3([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=W7(this.zoom,h["text-size"]),this.iconSizeData=W7(this.zoom,h["icon-size"]);const g=this.layers[0].layout,T=g.get("symbol-sort-key"),C=g.get("symbol-z-order");this.canOverlap=gm(g,"text-overlap","text-allow-overlap")!=="never"||gm(g,"icon-overlap","icon-allow-overlap")!=="never"||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!T.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(k=>a.WritingMode[k])),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.sourceID=o.sourceID}createArrays(){this.text=new dm(new Rc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new dm(new Rc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new _,this.lineVertexArray=new x,this.symbolInstances=new m}calculateGlyphDependencies(o,h,g,T,C){for(let k=0;k<o.length;k++)if(h[o.charCodeAt(k)]=!0,(g||T)&&C){const B=ef[o.charAt(k)];B&&(h[B.charCodeAt(0)]=!0)}}populate(o,h,g){const T=this.layers[0],C=T.layout,k=C.get("text-font"),B=C.get("text-field"),F=C.get("icon-image"),j=(B.value.kind!=="constant"||B.value.value instanceof Ce&&!B.value.value.isEmpty()||B.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),Q=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,ee=C.get("symbol-sort-key");if(this.features=[],!j&&!Q)return;const ae=h.iconDependencies,he=h.glyphDependencies,fe=h.availableImages,Le=new fi(this.zoom);for(const{feature:Pe,id:Ve,index:Qe,sourceLayerIndex:Fe}of o){const qe=T._featureFilter.needGeometry,at=Bc(Pe,qe);if(!T._featureFilter.filter(Le,at,g))continue;let ot,Bt;if(qe||(at.geometry=zc(Pe)),j){const Dt=T.getValueAndResolveTokens("text-field",at,g,fe),Ct=Ce.factory(Dt);gI(Ct)&&(this.hasRTLText=!0),(!this.hasRTLText||Tl()==="unavailable"||this.hasRTLText&&Zr.isParsed())&&(ot=HM(Ct,T,at))}if(Q){const Dt=T.getValueAndResolveTokens("icon-image",at,g,fe);Bt=Dt instanceof Me?Dt:Me.fromString(Dt)}if(!ot&&!Bt)continue;const Gt=this.sortFeaturesByKey?ee.evaluate(at,{},g):void 0;if(this.features.push({id:Ve,text:ot,icon:Bt,index:Qe,sourceLayerIndex:Fe,geometry:at.geometry,properties:Pe.properties,type:pI[Pe.type],sortKey:Gt}),Bt&&(ae[Bt.name]=!0),ot){const Dt=k.evaluate(at,{},g).join(","),Ct=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.WritingMode.vertical)>=0;for(const Et of ot.sections)if(Et.image)ae[Et.image.name]=!0;else{const Rt=b0(ot.toString()),Mt=Et.fontStack||Dt,gt=he[Mt]=he[Mt]||{};this.calculateGlyphDependencies(Et.text,gt,Ct,this.allowVerticalPlacement,Rt)}}}C.get("symbol-placement")==="line"&&(this.features=function(Pe){const Ve={},Qe={},Fe=[];let qe=0;function at(Dt){Fe.push(Pe[Dt]),qe++}function ot(Dt,Ct,Et){const Rt=Qe[Dt];return delete Qe[Dt],Qe[Ct]=Rt,Fe[Rt].geometry[0].pop(),Fe[Rt].geometry[0]=Fe[Rt].geometry[0].concat(Et[0]),Rt}function Bt(Dt,Ct,Et){const Rt=Ve[Ct];return delete Ve[Ct],Ve[Dt]=Rt,Fe[Rt].geometry[0].shift(),Fe[Rt].geometry[0]=Et[0].concat(Fe[Rt].geometry[0]),Rt}function Gt(Dt,Ct,Et){const Rt=Et?Ct[0][Ct[0].length-1]:Ct[0][0];return`${Dt}:${Rt.x}:${Rt.y}`}for(let Dt=0;Dt<Pe.length;Dt++){const Ct=Pe[Dt],Et=Ct.geometry,Rt=Ct.text?Ct.text.toString():null;if(!Rt){at(Dt);continue}const Mt=Gt(Rt,Et),gt=Gt(Rt,Et,!0);if(Mt in Qe&&gt in Ve&&Qe[Mt]!==Ve[gt]){const nn=Bt(Mt,gt,Et),$t=ot(Mt,gt,Fe[nn].geometry);delete Ve[Mt],delete Qe[gt],Qe[Gt(Rt,Fe[$t].geometry,!0)]=$t,Fe[nn].geometry=null}else Mt in Qe?ot(Mt,gt,Et):gt in Ve?Bt(Mt,gt,Et):(at(Dt),Ve[Mt]=qe-1,Qe[gt]=qe-1)}return Fe.filter(Dt=>Dt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Pe,Ve)=>Pe.sortKey-Ve.sortKey)}update(o,h,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,h,this.layers,g),this.icon.programConfigurations.updatePaintArrays(o,h,this.layers,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,h){const g=this.lineVertexArray.length;if(o.segment!==void 0){let T=o.dist(h[o.segment+1]),C=o.dist(h[o.segment]);const k={};for(let B=o.segment+1;B<h.length;B++)k[B]={x:h[B].x,y:h[B].y,tileUnitDistanceFromAnchor:T},B<h.length-1&&(T+=h[B+1].dist(h[B]));for(let B=o.segment||0;B>=0;B--)k[B]={x:h[B].x,y:h[B].y,tileUnitDistanceFromAnchor:C},B>0&&(C+=h[B-1].dist(h[B]));for(let B=0;B<h.length;B++){const F=k[B];this.lineVertexArray.emplaceBack(F.x,F.y,F.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(o,h,g,T,C,k,B,F,j,Q,ee,ae){const he=o.indexArray,fe=o.layoutVertexArray,Le=o.segments.prepareSegment(4*h.length,fe,he,this.canOverlap?k.sortKey:void 0),Pe=this.glyphOffsetArray.length,Ve=Le.vertexLength,Qe=this.allowVerticalPlacement&&B===a.WritingMode.vertical?Math.PI/2:0,Fe=k.text&&k.text.sections;for(let qe=0;qe<h.length;qe++){const{tl:at,tr:ot,bl:Bt,br:Gt,tex:Dt,pixelOffsetTL:Ct,pixelOffsetBR:Et,minFontScaleX:Rt,minFontScaleY:Mt,glyphOffset:gt,isSDF:nn,sectionIndex:$t}=h[qe],Cn=Le.vertexLength,mi=gt[1];yA(fe,F.x,F.y,at.x,mi+at.y,Dt.x,Dt.y,g,nn,Ct.x,Ct.y,Rt,Mt),yA(fe,F.x,F.y,ot.x,mi+ot.y,Dt.x+Dt.w,Dt.y,g,nn,Et.x,Ct.y,Rt,Mt),yA(fe,F.x,F.y,Bt.x,mi+Bt.y,Dt.x,Dt.y+Dt.h,g,nn,Ct.x,Et.y,Rt,Mt),yA(fe,F.x,F.y,Gt.x,mi+Gt.y,Dt.x+Dt.w,Dt.y+Dt.h,g,nn,Et.x,Et.y,Rt,Mt),Am(o.dynamicLayoutVertexArray,F,Qe),he.emplaceBack(Cn,Cn+1,Cn+2),he.emplaceBack(Cn+1,Cn+2,Cn+3),Le.vertexLength+=4,Le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(gt[0]),qe!==h.length-1&&$t===h[qe+1].sectionIndex||o.programConfigurations.populatePaintArrays(fe.length,k,k.index,{},ae,Fe&&Fe[$t])}o.placedSymbolArray.emplaceBack(F.x,F.y,Pe,this.glyphOffsetArray.length-Pe,Ve,j,Q,F.segment,g?g[0]:0,g?g[1]:0,T[0],T[1],B,0,!1,0,ee)}_addCollisionDebugVertex(o,h,g,T,C,k){return h.emplaceBack(0,0),o.emplaceBack(g.x,g.y,T,C,Math.round(k.x),Math.round(k.y))}addCollisionDebugVertices(o,h,g,T,C,k,B){const F=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),j=F.vertexLength,Q=C.layoutVertexArray,ee=C.collisionVertexArray,ae=B.anchorX,he=B.anchorY;this._addCollisionDebugVertex(Q,ee,k,ae,he,new Ft(o,h)),this._addCollisionDebugVertex(Q,ee,k,ae,he,new Ft(g,h)),this._addCollisionDebugVertex(Q,ee,k,ae,he,new Ft(g,T)),this._addCollisionDebugVertex(Q,ee,k,ae,he,new Ft(o,T)),F.vertexLength+=4;const fe=C.indexArray;fe.emplaceBack(j,j+1),fe.emplaceBack(j+1,j+2),fe.emplaceBack(j+2,j+3),fe.emplaceBack(j+3,j),F.primitiveLength+=4}addDebugCollisionBoxes(o,h,g,T){for(let C=o;C<h;C++){const k=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(k.x1,k.y1,k.x2,k.y2,T?this.textCollisionBox:this.iconCollisionBox,k.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pm(Ye,k7.members,Oe),this.iconCollisionBox=new pm(Ye,k7.members,Oe);for(let o=0;o<this.symbolInstances.length;o++){const h=this.symbolInstances.get(o);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(o,h,g,T,C,k,B,F,j){const Q={};for(let ee=h;ee<g;ee++){const ae=o.get(ee);Q.textBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},Q.textFeatureIndex=ae.featureIndex;break}for(let ee=T;ee<C;ee++){const ae=o.get(ee);Q.verticalTextBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},Q.verticalTextFeatureIndex=ae.featureIndex;break}for(let ee=k;ee<B;ee++){const ae=o.get(ee);Q.iconBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},Q.iconFeatureIndex=ae.featureIndex;break}for(let ee=F;ee<j;ee++){const ae=o.get(ee);Q.verticalIconBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},Q.verticalIconFeatureIndex=ae.featureIndex;break}return Q}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const g=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,h){const g=o.placedSymbolArray.get(h),T=g.vertexStartIndex+4*g.numGlyphs;for(let C=g.vertexStartIndex;C<T;C+=4)o.indexArray.emplaceBack(C,C+1,C+2),o.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(o),g=Math.cos(o),T=[],C=[],k=[];for(let B=0;B<this.symbolInstances.length;++B){k.push(B);const F=this.symbolInstances.get(B);T.push(0|Math.round(h*F.anchorX+g*F.anchorY)),C.push(F.featureIndex)}return k.sort((B,F)=>T[B]-T[F]||C[F]-C[B]),k}addToSortKeyRanges(o,h){const g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===h?g.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const g=this.symbolInstances.get(h);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((T,C,k)=>{T>=0&&k.indexOf(T)===C&&this.addIndicesForPlacedSymbol(this.text,T)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}zt("SymbolBucket",fh,{omit:["layers","collisionBoxArray","features","compareText"]}),fh.MAX_GLYPHS=65535,fh.addDynamicAttributes=Am;const _I=new er({"symbol-placement":new Ht(et.layout_symbol["symbol-placement"]),"symbol-spacing":new Ht(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ht(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Kt(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ht(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ht(et.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ht(et.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ht(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ht(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ht(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new Kt(et.layout_symbol["icon-size"]),"icon-text-fit":new Ht(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ht(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new Kt(et.layout_symbol["icon-image"]),"icon-rotate":new Kt(et.layout_symbol["icon-rotate"]),"icon-padding":new Kt(et.layout_symbol["icon-padding"]),"icon-keep-upright":new Ht(et.layout_symbol["icon-keep-upright"]),"icon-offset":new Kt(et.layout_symbol["icon-offset"]),"icon-anchor":new Kt(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ht(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ht(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ht(et.layout_symbol["text-rotation-alignment"]),"text-field":new Kt(et.layout_symbol["text-field"]),"text-font":new Kt(et.layout_symbol["text-font"]),"text-size":new Kt(et.layout_symbol["text-size"]),"text-max-width":new Kt(et.layout_symbol["text-max-width"]),"text-line-height":new Ht(et.layout_symbol["text-line-height"]),"text-letter-spacing":new Kt(et.layout_symbol["text-letter-spacing"]),"text-justify":new Kt(et.layout_symbol["text-justify"]),"text-radial-offset":new Kt(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ht(et.layout_symbol["text-variable-anchor"]),"text-anchor":new Kt(et.layout_symbol["text-anchor"]),"text-max-angle":new Ht(et.layout_symbol["text-max-angle"]),"text-writing-mode":new Ht(et.layout_symbol["text-writing-mode"]),"text-rotate":new Kt(et.layout_symbol["text-rotate"]),"text-padding":new Ht(et.layout_symbol["text-padding"]),"text-keep-upright":new Ht(et.layout_symbol["text-keep-upright"]),"text-transform":new Kt(et.layout_symbol["text-transform"]),"text-offset":new Kt(et.layout_symbol["text-offset"]),"text-allow-overlap":new Ht(et.layout_symbol["text-allow-overlap"]),"text-overlap":new Ht(et.layout_symbol["text-overlap"]),"text-ignore-placement":new Ht(et.layout_symbol["text-ignore-placement"]),"text-optional":new Ht(et.layout_symbol["text-optional"])});var mm={paint:new er({"icon-opacity":new Kt(et.paint_symbol["icon-opacity"]),"icon-color":new Kt(et.paint_symbol["icon-color"]),"icon-halo-color":new Kt(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new Kt(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Kt(et.paint_symbol["icon-halo-blur"]),"icon-translate":new Ht(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ht(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new Kt(et.paint_symbol["text-opacity"]),"text-color":new Kt(et.paint_symbol["text-color"],{runtimeType:Pi,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Kt(et.paint_symbol["text-halo-color"]),"text-halo-width":new Kt(et.paint_symbol["text-halo-width"]),"text-halo-blur":new Kt(et.paint_symbol["text-halo-blur"]),"text-translate":new Ht(et.paint_symbol["text-translate"]),"text-translate-anchor":new Ht(et.paint_symbol["text-translate-anchor"])}),layout:_I};class i9{constructor(o){if(o.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=o.property.overrides?o.property.overrides.runtimeType:us,this.defaultValue=o}evaluate(o){if(o.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(o.formattedSection))return h.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zt("FormatSectionOverride",i9,{omit:["defaultValue"]});class vA extends ms{constructor(o){super(o,mm)}recalculate(o,h){if(super.recalculate(o,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const g=this.layout.get("text-writing-mode");if(g){const T=[];for(const C of g)T.indexOf(C)<0&&T.push(C);this.layout._values["text-writing-mode"]=T}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(o,h,g,T){const C=this.layout.get(o).evaluate(h,{},g,T),k=this._unevaluatedLayout._values[o];return k.isDataDriven()||ml(k.value)||!C?C:function(B,F){return F.replace(/{([^{}]+)}/g,(j,Q)=>Q in B?String(B[Q]):"")}(h.properties,C)}createBucket(o){return new fh(o)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const o of mm.paint.overridableProperties){if(!vA.hasPaintOverride(this.layout,o))continue;const h=this.paint.get(o),g=new i9(h),T=new pl(g,h.property.specification);let C=null;C=h.value.kind==="constant"||h.value.kind==="source"?new Qo("source",T):new gl("composite",T,h.value.zoomStops),this.paint._values[o]=new ei(h.property,C,h.parameters)}}_handleOverridablePaintPropertyUpdate(o,h,g){return!(!this.layout||h.isDataDriven()||g.isDataDriven())&&vA.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,h){const g=o.get("text-field"),T=mm.paint.properties[h];let C=!1;const k=B=>{for(const F of B)if(T.overrides&&T.overrides.hasOverride(F))return void(C=!0)};if(g.value.kind==="constant"&&g.value.value instanceof Ce)k(g.value.value.sections);else if(g.value.kind==="source"){const B=j=>{C||(j instanceof It&&Ue(j.value)===Ri?k(j.value.sections):j instanceof g0?k(j.sections):j.eachChild(B))},F=g.value;F._styleExpression&&B(F._styleExpression.expression)}return C}}function gm(c,o,h){let g="never";const T=c.get(o);return T?g=T:c.get(h)&&(g="always"),g}var yI={paint:new er({"background-color":new Ht(et.paint_background["background-color"]),"background-pattern":new kc(et.paint_background["background-pattern"]),"background-opacity":new Ht(et.paint_background["background-opacity"])})},vI={paint:new er({"raster-opacity":new Ht(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ht(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ht(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ht(et.paint_raster["raster-brightness-max"]),"raster-saturation":new Ht(et.paint_raster["raster-saturation"]),"raster-contrast":new Ht(et.paint_raster["raster-contrast"]),"raster-resampling":new Ht(et.paint_raster["raster-resampling"]),"raster-fade-duration":new Ht(et.paint_raster["raster-fade-duration"])})};class xI extends ms{constructor(o){super(o,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=o}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const wI={circle:class extends ms{constructor(c){super(c,JP)}createBucket(c){return new H3(c)}queryRadius(c){const o=c;return W1("circle-radius",this,o)+W1("circle-stroke-width",this,o)+iA(this.paint.get("circle-translate"))}queryIntersectsFeature(c,o,h,g,T,C,k,B){const F=rA(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),C.angle,k),j=this.paint.get("circle-radius").evaluate(o,h)+this.paint.get("circle-stroke-width").evaluate(o,h),Q=this.paint.get("circle-pitch-alignment")==="map",ee=Q?F:function(he,fe){return he.map(Le=>d7(Le,fe))}(F,B),ae=Q?j*k:j;for(const he of g)for(const fe of he){const Le=Q?fe:d7(fe,B);let Pe=ae;const Ve=sA([],[fe.x,fe.y,0,1],B);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Pe*=Ve[3]/C.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Pe*=C.cameraToCenterDistance/Ve[3]),ZP(ee,Le,Pe))return!0}return!1}},heatmap:class extends ms{constructor(c){super(c,tM),this._updateColorRamp()}createBucket(c){return new p7(c)}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=g7({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends ms{constructor(c){super(c,nM)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends ms{constructor(c){super(c,_M)}recalculate(c,o){super.recalculate(c,o);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new nm(c)}queryRadius(){return iA(this.paint.get("fill-translate"))}queryIntersectsFeature(c,o,h,g,T,C,k){return o7(rA(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),C.angle,k),g)}isTileClipped(){return!0}},"fill-extrusion":class extends ms{constructor(c){super(c,LM)}createBucket(c){return new rm(c)}queryRadius(){return iA(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(c,o,h,g,T,C,k,B){const F=rA(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),C.angle,k),j=this.paint.get("fill-extrusion-height").evaluate(o,h),Q=this.paint.get("fill-extrusion-base").evaluate(o,h),ee=function(he,fe,Le,Pe){const Ve=[];for(const Qe of he){const Fe=[Qe.x,Qe.y,0,1];sA(Fe,Fe,fe),Ve.push(new Ft(Fe[0]/Fe[3],Fe[1]/Fe[3]))}return Ve}(F,B),ae=function(he,fe,Le,Pe){const Ve=[],Qe=[],Fe=Pe[8]*fe,qe=Pe[9]*fe,at=Pe[10]*fe,ot=Pe[11]*fe,Bt=Pe[8]*Le,Gt=Pe[9]*Le,Dt=Pe[10]*Le,Ct=Pe[11]*Le;for(const Et of he){const Rt=[],Mt=[];for(const gt of Et){const nn=gt.x,$t=gt.y,Cn=Pe[0]*nn+Pe[4]*$t+Pe[12],mi=Pe[1]*nn+Pe[5]*$t+Pe[13],_i=Pe[2]*nn+Pe[6]*$t+Pe[14],nr=Pe[3]*nn+Pe[7]*$t+Pe[15],io=_i+at,Er=nr+ot,qi=Cn+Bt,ar=mi+Gt,Tr=_i+Dt,Br=nr+Ct,gs=new Ft((Cn+Fe)/Er,(mi+qe)/Er);gs.z=io/Er,Rt.push(gs);const Zi=new Ft(qi/Br,ar/Br);Zi.z=Tr/Br,Mt.push(Zi)}Ve.push(Rt),Qe.push(Mt)}return[Ve,Qe]}(g,Q,j,B);return function(he,fe,Le){let Pe=1/0;o7(Le,fe)&&(Pe=S7(Le,fe[0]));for(let Ve=0;Ve<fe.length;Ve++){const Qe=fe[Ve],Fe=he[Ve];for(let qe=0;qe<Qe.length-1;qe++){const at=Qe[qe],ot=[at,Qe[qe+1],Fe[qe+1],Fe[qe],at];s7(Le,ot)&&(Pe=Math.min(Pe,S7(Le,ot)))}}return Pe!==1/0&&Pe}(ae[0],ae[1],ee)}},line:class extends ms{constructor(c){super(c,P7),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){c==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof pi,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,o){super.recalculate(c,o),this.paint._values["line-floorwidth"]=M7.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new sm(c)}queryRadius(c){const o=c,h=I7(W1("line-width",this,o),W1("line-gap-width",this,o)),g=W1("line-offset",this,o);return h/2+Math.abs(g)+iA(this.paint.get("line-translate"))}queryIntersectsFeature(c,o,h,g,T,C,k){const B=rA(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),C.angle,k),F=k/2*I7(this.paint.get("line-width").evaluate(o,h),this.paint.get("line-gap-width").evaluate(o,h)),j=this.paint.get("line-offset").evaluate(o,h);return j&&(g=function(Q,ee){const ae=[];for(let he=0;he<Q.length;he++){const fe=Q[he],Le=[];for(let Pe=0;Pe<fe.length;Pe++){const Ve=fe[Pe-1],Qe=fe[Pe],Fe=fe[Pe+1],qe=Pe===0?new Ft(0,0):Qe.sub(Ve)._unit()._perp(),at=Pe===fe.length-1?new Ft(0,0):Fe.sub(Qe)._unit()._perp(),ot=qe._add(at)._unit(),Bt=ot.x*at.x+ot.y*at.y;Bt!==0&&ot._mult(1/Bt),Le.push(ot._mult(ee)._add(Qe))}ae.push(Le)}return ae}(g,j*k)),function(Q,ee,ae){for(let he=0;he<ee.length;he++){const fe=ee[he];if(Q.length>=3){for(let Le=0;Le<fe.length;Le++)if(sh(Q,fe[Le]))return!0}if(XP(Q,fe,ae))return!0}return!1}(B,g,F)}isTileClipped(){return!0}},symbol:vA,background:class extends ms{constructor(c){super(c,yI)}},raster:class extends ms{constructor(c){super(c,vI)}}};class bI{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const r9=63710088e-1;class Bi{constructor(o,h){if(isNaN(o)||isNaN(h))throw new Error(`Invalid LngLat object: (${o}, ${h})`);if(this.lng=+o,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Bi(U(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const h=Math.PI/180,g=this.lat*h,T=o.lat*h,C=Math.sin(g)*Math.sin(T)+Math.cos(g)*Math.cos(T)*Math.cos((o.lng-this.lng)*h);return r9*Math.acos(Math.min(C,1))}toBounds(o=0){const h=360*o/40075017,g=h/Math.cos(Math.PI/180*this.lat);return new Fc(new Bi(this.lng-g,this.lat-h),new Bi(this.lng+g,this.lat+h))}static convert(o){if(o instanceof Bi)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new Bi(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new Bi(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Fc{constructor(o,h){o&&(h?this.setSouthWest(o).setNorthEast(h):o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof Bi?new Bi(o.lng,o.lat):Bi.convert(o),this}setSouthWest(o){return this._sw=o instanceof Bi?new Bi(o.lng,o.lat):Bi.convert(o),this}extend(o){const h=this._sw,g=this._ne;let T,C;if(o instanceof Bi)T=o,C=o;else{if(!(o instanceof Fc))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Fc.convert(o)):this.extend(Bi.convert(o)):this;if(T=o._sw,C=o._ne,!T||!C)return this}return h||g?(h.lng=Math.min(T.lng,h.lng),h.lat=Math.min(T.lat,h.lat),g.lng=Math.max(C.lng,g.lng),g.lat=Math.max(C.lat,g.lat)):(this._sw=new Bi(T.lng,T.lat),this._ne=new Bi(C.lng,C.lat)),this}getCenter(){return new Bi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Bi(this.getWest(),this.getNorth())}getSouthEast(){return new Bi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:h,lat:g}=Bi.convert(o);let T=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(T=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&T}static convert(o){return o instanceof Fc?o:o&&new Fc(o)}}const s9=2*Math.PI*r9;function o9(c){return s9*Math.cos(c*Math.PI/180)}function a9(c){return(180+c)/360}function l9(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function c9(c,o){return c/o9(o)}function _m(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class xA{constructor(o,h,g=0){this.x=+o,this.y=+h,this.z=+g}static fromLngLat(o,h=0){const g=Bi.convert(o);return new xA(a9(g.lng),l9(g.lat),c9(h,g.lat))}toLngLat(){return new Bi(360*this.x-180,_m(this.y))}toAltitude(){return this.z*o9(_m(this.y))}meterInMercatorCoordinateUnits(){return 1/s9*(o=_m(this.y),1/Math.cos(o*Math.PI/180));var o}}function u9(c,o,h){var g=2*Math.PI*6378137/256/Math.pow(2,h);return[c*g-2*Math.PI*6378137/2,o*g-2*Math.PI*6378137/2]}class ym{constructor(o,h,g){if(o<0||o>25||g<0||g>=Math.pow(2,o)||h<0||h>=Math.pow(2,o))throw new Error(`x=${h}, y=${g}, z=${o} outside of bounds. 0<=x<${Math.pow(2,o)}, 0<=y<${Math.pow(2,o)} 0<=z<=25 `);this.z=o,this.x=h,this.y=g,this.key=nf(0,o,o,h,g)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,h,g){const T=(k=this.y,B=this.z,F=u9(256*(C=this.x),256*(k=Math.pow(2,B)-k-1),B),j=u9(256*(C+1),256*(k+1),B),F[0]+","+F[1]+","+j[0]+","+j[1]);var C,k,B,F,j;const Q=function(ee,ae,he){let fe,Le="";for(let Pe=ee;Pe>0;Pe--)fe=1<<Pe-1,Le+=(ae&fe?1:0)+(he&fe?2:0);return Le}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(g==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,Q).replace(/{bbox-epsg-3857}/g,T)}isChildOf(o){const h=this.z-o.z;return h>0&&o.x===this.x>>h&&o.y===this.y>>h}getTilePoint(o){const h=Math.pow(2,this.z);return new Ft((o.x*h-this.x)*tr,(o.y*h-this.y)*tr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class h9{constructor(o,h){this.wrap=o,this.canonical=h,this.key=nf(o,h.z,h.z,h.x,h.y)}}class no{constructor(o,h,g,T,C){if(o<g)throw new Error(`overscaledZ should be >= z; overscaledZ = ${o}; z = ${g}`);this.overscaledZ=o,this.wrap=h,this.canonical=new ym(g,+T,+C),this.key=nf(h,o,g,T,C)}clone(){return new no(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-o;return o>this.canonical.z?new no(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new no(o,this.wrap,o,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(o,h){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-o;return o>this.canonical.z?nf(this.wrap*+h,o,this.canonical.z,this.canonical.x,this.canonical.y):nf(this.wrap*+h,o,o,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(o){if(o.wrap!==this.wrap)return!1;const h=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>h&&o.canonical.y===this.canonical.y>>h}children(o){if(this.overscaledZ>=o)return[new no(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,g=2*this.canonical.x,T=2*this.canonical.y;return[new no(h,this.wrap,h,g,T),new no(h,this.wrap,h,g+1,T),new no(h,this.wrap,h,g,T+1),new no(h,this.wrap,h,g+1,T+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new no(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new no(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new h9(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(o){return this.canonical.getTilePoint(new xA(o.x-this.wrap,o.y))}}function nf(c,o,h,g,T){(c*=2)<0&&(c=-1*c-1);const C=1<<h;return(C*C*c+C*T+g).toString(36)+h.toString(36)+o.toString(36)}zt("CanonicalTileID",ym),zt("OverscaledTileID",no,{omit:["posMatrix"]});class f9{constructor(o,h,g){if(this.uid=o,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(g&&g!=="mapbox"&&g!=="terrarium")return void Te(`"${g}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=h.height;const T=this.dim=h.height-2;this.data=new Uint32Array(h.data.buffer),this.encoding=g||"mapbox";for(let C=0;C<T;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(T,C)]=this.data[this._idx(T-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,T)]=this.data[this._idx(C,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<T;C++)for(let k=0;k<T;k++){const B=this.get(C,k);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(o,h){const g=new Uint8Array(this.data.buffer),T=4*this._idx(o,h);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(g[T],g[T+1],g[T+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(o,h){if(o<-1||o>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(o+1)}_unpackMapbox(o,h,g){return(256*o*256+256*h+g)/10-1e4}_unpackTerrarium(o,h,g){return 256*o+h+g/256-32768}getPixels(){return new to({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(o,h,g){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let T=h*this.dim,C=h*this.dim+this.dim,k=g*this.dim,B=g*this.dim+this.dim;switch(h){case-1:T=C-1;break;case 1:C=T+1}switch(g){case-1:k=B-1;break;case 1:B=k+1}const F=-h*this.dim,j=-g*this.dim;for(let Q=k;Q<B;Q++)for(let ee=T;ee<C;ee++)this.data[this._idx(ee,Q)]=o.data[this._idx(ee+F,Q+j)]}}zt("DEMData",f9);class A9{constructor(o){this._stringToNumber={},this._numberToString=[];for(let h=0;h<o.length;h++){const g=o[h];this._stringToNumber[g]=h,this._numberToString[h]=g}}encode(o){return this._stringToNumber[o]}decode(o){if(o>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${o} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[o]}}class d9{constructor(o,h,g,T,C){this.type="Feature",this._vectorTileFeature=o,o._z=h,o._x=g,o._y=T,this.properties=o.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(o[h]=this[h]);return o}}class p9{constructor(o,h){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Oa(tr,16,0),this.grid3D=new Oa(tr,16,0),this.featureIndexArray=new I,this.promoteId=h}insert(o,h,g,T,C,k){const B=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,T,C);const F=k?this.grid3D:this.grid;for(let j=0;j<h.length;j++){const Q=h[j],ee=[1/0,1/0,-1/0,-1/0];for(let ae=0;ae<Q.length;ae++){const he=Q[ae];ee[0]=Math.min(ee[0],he.x),ee[1]=Math.min(ee[1],he.y),ee[2]=Math.max(ee[2],he.x),ee[3]=Math.max(ee[3],he.y)}ee[0]<tr&&ee[1]<tr&&ee[2]>=0&&ee[3]>=0&&F.insert(B,ee[0],ee[1],ee[2],ee[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new C0.VectorTile(new om(this.rawTileData)).layers,this.sourceLayerCoder=new A9(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(o,h,g,T){this.loadVTLayers();const C=o.params||{},k=tr/o.tileSize/o.scale,B=Ls(C.filter),F=o.queryGeometry,j=o.queryPadding*k,Q=g9(F),ee=this.grid.query(Q.minX-j,Q.minY-j,Q.maxX+j,Q.maxY+j),ae=g9(o.cameraQueryGeometry),he=this.grid3D.query(ae.minX-j,ae.minY-j,ae.maxX+j,ae.maxY+j,(Pe,Ve,Qe,Fe)=>function(qe,at,ot,Bt,Gt){for(const Ct of qe)if(at<=Ct.x&&ot<=Ct.y&&Bt>=Ct.x&&Gt>=Ct.y)return!0;const Dt=[new Ft(at,ot),new Ft(at,Gt),new Ft(Bt,Gt),new Ft(Bt,ot)];if(qe.length>2){for(const Ct of Dt)if(sh(qe,Ct))return!0}for(let Ct=0;Ct<qe.length-1;Ct++)if(YP(qe[Ct],qe[Ct+1],Dt))return!0;return!1}(o.cameraQueryGeometry,Pe-j,Ve-j,Qe+j,Fe+j));for(const Pe of he)ee.push(Pe);ee.sort(EI);const fe={};let Le;for(let Pe=0;Pe<ee.length;Pe++){const Ve=ee[Pe];if(Ve===Le)continue;Le=Ve;const Qe=this.featureIndexArray.get(Ve);let Fe=null;this.loadMatchingFeature(fe,Qe.bucketIndex,Qe.sourceLayerIndex,Qe.featureIndex,B,C.layers,C.availableImages,h,g,T,(qe,at,ot)=>(Fe||(Fe=zc(qe)),at.queryIntersectsFeature(F,qe,ot,Fe,this.z,o.transform,k,o.pixelPosMatrix)))}return fe}loadMatchingFeature(o,h,g,T,C,k,B,F,j,Q,ee){const ae=this.bucketLayerIDs[h];if(k&&!function(Pe,Ve){for(let Qe=0;Qe<Pe.length;Qe++)if(Ve.indexOf(Pe[Qe])>=0)return!0;return!1}(k,ae))return;const he=this.sourceLayerCoder.decode(g),fe=this.vtLayers[he].feature(T);if(C.needGeometry){const Pe=Bc(fe,!0);if(!C.filter(new fi(this.tileID.overscaledZ),Pe,this.tileID.canonical))return}else if(!C.filter(new fi(this.tileID.overscaledZ),fe))return;const Le=this.getId(fe,he);for(let Pe=0;Pe<ae.length;Pe++){const Ve=ae[Pe];if(k&&k.indexOf(Ve)<0)continue;const Qe=F[Ve];if(!Qe)continue;let Fe={};Le&&Q&&(Fe=Q.getState(Qe.sourceLayer||"_geojsonTileLayer",Le));const qe=q({},j[Ve]);qe.paint=m9(qe.paint,Qe.paint,fe,Fe,B),qe.layout=m9(qe.layout,Qe.layout,fe,Fe,B);const at=!ee||ee(fe,Qe,Fe);if(!at)continue;const ot=new d9(fe,this.z,this.x,this.y,Le);ot.layer=qe;let Bt=o[Ve];Bt===void 0&&(Bt=o[Ve]=[]),Bt.push({featureIndex:T,feature:ot,intersectionZ:at})}}lookupSymbolFeatures(o,h,g,T,C,k,B,F){const j={};this.loadVTLayers();const Q=Ls(C);for(const ee of o)this.loadMatchingFeature(j,g,T,ee,Q,k,B,F,h);return j}hasLayer(o){for(const h of this.bucketLayerIDs)for(const g of h)if(o===g)return!0;return!1}getId(o,h){let g=o.id;return this.promoteId&&(g=o.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof g=="boolean"&&(g=Number(g))),g}}function m9(c,o,h,g,T){return ne(c,(C,k)=>{const B=o instanceof Cl?o.get(k):null;return B&&B.evaluate?B.evaluate(h,g,T):B})}function g9(c){let o=1/0,h=1/0,g=-1/0,T=-1/0;for(const C of c)o=Math.min(o,C.x),h=Math.min(h,C.y),g=Math.max(g,C.x),T=Math.max(T,C.y);return{minX:o,minY:h,maxX:g,maxY:T}}function EI(c,o){return o-c}var vm;zt("FeatureIndex",p9,{omit:["rawTileData","sourceLayerCoder"]}),a.PerformanceMarkers=void 0,(vm=a.PerformanceMarkers||(a.PerformanceMarkers={})).create="create",vm.load="load",vm.fullLoad="fullLoad";let wA=null,rf=[];const xm=1e3/30,TI={mark(c){performance.mark(c)},frame(c){const o=c;wA!=null&&rf.push(o-wA),wA=o},clearMetrics(){wA=null,rf=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const c in a.PerformanceMarkers)performance.clearMarks(a.PerformanceMarkers[c])},getPerformanceMetrics(){performance.measure("loadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.load),performance.measure("fullLoadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.fullLoad);const c=performance.getEntriesByName("loadTime")[0].duration,o=performance.getEntriesByName("fullLoadTime")[0].duration,h=rf.length,g=1/(rf.reduce((C,k)=>C+k,0)/h/1e3),T=rf.filter(C=>C>xm).reduce((C,k)=>C+(k-xm)/xm,0);return{loadTime:c,fullLoadTime:o,fps:g,percentDroppedFrames:T/(h+T)*100}}};a.AJAXError=Fn,a.ARRAY_TYPE=Qr,a.Actor=class{constructor(c,o,h){this.target=c,this.parent=o,this.mapId=h,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},pe(["receive","process"],this),this.invoker=new bI(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=nt()?c:window}send(c,o,h,g,T=!1){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(this.callbacks[C]=h);const k=ht(this.globalScope)?void 0:[];return this.target.postMessage({id:C,type:c,hasCallback:!!h,targetMapId:g,mustQueue:T,sourceMapId:this.mapId,data:Jo(o,k)},k),{cancel:()=>{h&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(c){const o=c.data,h=o.id;if(h&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){delete this.tasks[h];const g=this.cancelCallbacks[h];delete this.cancelCallbacks[h],g&&g()}else nt()||o.mustQueue?(this.tasks[h]=o,this.taskQueue.push(h),this.invoker.trigger()):this.processTask(h,o)}process(){if(!this.taskQueue.length)return;const c=this.taskQueue.shift(),o=this.tasks[c];delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(c,o)}processTask(c,o){if(o.type==="<response>"){const h=this.callbacks[c];delete this.callbacks[c],h&&(o.error?h(Co(o.error)):h(null,Co(o.data)))}else{let h=!1;const g=ht(this.globalScope)?void 0:[],T=o.hasCallback?(B,F)=>{h=!0,delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:B?Jo(B):null,data:Jo(F,g)},g)}:B=>{h=!0};let C=null;const k=Co(o.data);if(this.parent[o.type])C=this.parent[o.type](o.sourceMapId,k,T);else if(this.parent.getWorkerSource){const B=o.type.split(".");C=this.parent.getWorkerSource(o.sourceMapId,B[0],k.source)[B[1]](k,T)}else T(new Error(`Could not find function ${o.type}`));!h&&C&&C.cancel&&(this.cancelCallbacks[c]=C.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.AlphaImage=q1,a.CanonicalTileID=ym,a.CollisionBoxArray=tt,a.CollisionCircleLayoutArray=class extends K{},a.Color=f,a.DEMData=f9,a.DataConstantProperty=Ht,a.DictionaryCoder=A9,a.EXTENT=tr,a.ErrorEvent=xo,a.EvaluationParameters=fi,a.Event=Lr,a.Evented=$r,a.FeatureIndex=p9,a.FillBucket=nm,a.FillExtrusionBucket=rm,a.GeoJSONFeature=d9,a.ImageAtlas=N7,a.ImagePosition=lm,a.LineBucket=sm,a.LineStripIndexArray=class extends Se{},a.LngLat=Bi,a.LngLatBounds=Fc,a.MercatorCoordinate=xA,a.ONE_EM=mr,a.OverscaledTileID=no,a.PerformanceUtils=TI,a.PosArray=D,a.Properties=er,a.QuadTriangleArray=class extends ce{},a.RGBAImage=to,a.RasterBoundsArray=class extends b{},a.RequestPerformance=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},a.ResourceType=dt,a.SegmentVector=rt,a.SymbolBucket=fh,a.Transitionable=eh,a.TriangleIndexArray=We,a.Uniform1f=Pl,a.Uniform1i=class extends Mo{constructor(c,o){super(c,o),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},a.Uniform2f=class extends Mo{constructor(c,o){super(c,o),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},a.Uniform3f=class extends Mo{constructor(c,o){super(c,o),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},a.Uniform4f=ih,a.UniformColor=t7,a.UniformMatrix4f=class extends Mo{constructor(c,o){super(c,o),this.current=$P}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let o=1;o<16;o++)if(c[o]!==this.current[o]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},a.UnwrappedTileID=h9,a.ValidationError=xt,a.ZoomHistory=bc,a.add=function(c,o,h){return c[0]=o[0]+h[0],c[1]=o[1]+h[1],c[2]=o[2]+h[2],c},a.addDynamicAttributes=Am,a.asyncAll=function(c,o,h){if(!c.length)return h(null,[]);let g=c.length;const T=new Array(c.length);let C=null;c.forEach((k,B)=>{o(k,(F,j)=>{F&&(C=F),T[B]=j,--g==0&&h(C,T)})})},a.bezier=M,a.bindAll=pe,a.cacheEntryPossiblyAdded=function(c){ii++,ii>Di&&(c.getActor().send("enforceCacheSizeLimit",Tn),ii=0)},a.clamp=L,a.clearTileCache=function(c){const o=caches.delete(Ot);c&&o.catch(c).then(()=>c())},a.clipLine=Y7,a.clone=function(c){var o=new Qr(16);return o[0]=c[0],o[1]=c[1],o[2]=c[2],o[3]=c[3],o[4]=c[4],o[5]=c[5],o[6]=c[6],o[7]=c[7],o[8]=c[8],o[9]=c[9],o[10]=c[10],o[11]=c[11],o[12]=c[12],o[13]=c[13],o[14]=c[14],o[15]=c[15],o},a.clone$1=re,a.clone$2=function(c){var o=new Qr(3);return o[0]=c[0],o[1]=c[1],o[2]=c[2],o},a.collisionCircleLayout=jM,a.config=yt,a.copy=function(c,o){return c[0]=o[0],c[1]=o[1],c[2]=o[2],c[3]=o[3],c[4]=o[4],c[5]=o[5],c[6]=o[6],c[7]=o[7],c[8]=o[8],c[9]=o[9],c[10]=o[10],c[11]=o[11],c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15],c},a.create=function(){var c=new Qr(16);return Qr!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},a.create$1=c7,a.createExpression=ka,a.createFilter=Ls,a.createLayout=zi,a.createStyleLayer=function(c){return c.type==="custom"?new xI(c):new wI[c.type](c)},a.cross=function(c,o,h){var g=o[0],T=o[1],C=o[2],k=h[0],B=h[1],F=h[2];return c[0]=T*F-C*B,c[1]=C*k-g*F,c[2]=g*B-T*k,c},a.dot=function(c,o){return c[0]*o[0]+c[1]*o[1]+c[2]*o[2]},a.dot$1=function(c,o){return c[0]*o[0]+c[1]*o[1]+c[2]*o[2]+c[3]*o[3]},a.ease=R,a.emitValidationErrors=Ba,a.enforceCacheSizeLimit=function(c){di(),Jt&&Jt.then(o=>{o.keys().then(h=>{for(let g=0;g<h.length-c;g++)o.delete(h[g])})})},a.equals=function(c,o){var h=c[0],g=c[1],T=c[2],C=c[3],k=c[4],B=c[5],F=c[6],j=c[7],Q=c[8],ee=c[9],ae=c[10],he=c[11],fe=c[12],Le=c[13],Pe=c[14],Ve=c[15],Qe=o[0],Fe=o[1],qe=o[2],at=o[3],ot=o[4],Bt=o[5],Gt=o[6],Dt=o[7],Ct=o[8],Et=o[9],Rt=o[10],Mt=o[11],gt=o[12],nn=o[13],$t=o[14],Cn=o[15];return Math.abs(h-Qe)<=Xr*Math.max(1,Math.abs(h),Math.abs(Qe))&&Math.abs(g-Fe)<=Xr*Math.max(1,Math.abs(g),Math.abs(Fe))&&Math.abs(T-qe)<=Xr*Math.max(1,Math.abs(T),Math.abs(qe))&&Math.abs(C-at)<=Xr*Math.max(1,Math.abs(C),Math.abs(at))&&Math.abs(k-ot)<=Xr*Math.max(1,Math.abs(k),Math.abs(ot))&&Math.abs(B-Bt)<=Xr*Math.max(1,Math.abs(B),Math.abs(Bt))&&Math.abs(F-Gt)<=Xr*Math.max(1,Math.abs(F),Math.abs(Gt))&&Math.abs(j-Dt)<=Xr*Math.max(1,Math.abs(j),Math.abs(Dt))&&Math.abs(Q-Ct)<=Xr*Math.max(1,Math.abs(Q),Math.abs(Ct))&&Math.abs(ee-Et)<=Xr*Math.max(1,Math.abs(ee),Math.abs(Et))&&Math.abs(ae-Rt)<=Xr*Math.max(1,Math.abs(ae),Math.abs(Rt))&&Math.abs(he-Mt)<=Xr*Math.max(1,Math.abs(he),Math.abs(Mt))&&Math.abs(fe-gt)<=Xr*Math.max(1,Math.abs(fe),Math.abs(gt))&&Math.abs(Le-nn)<=Xr*Math.max(1,Math.abs(Le),Math.abs(nn))&&Math.abs(Pe-$t)<=Xr*Math.max(1,Math.abs(Pe),Math.abs($t))&&Math.abs(Ve-Cn)<=Xr*Math.max(1,Math.abs(Ve),Math.abs(Cn))},a.evaluateSizeForFeature=function(c,{uSize:o,uSizeT:h},{lowerSize:g,upperSize:T}){return c.kind==="source"?g/kl:c.kind==="composite"?xn(g/kl,T/kl,h):o},a.evaluateSizeForZoom=function(c,o){let h=0,g=0;if(c.kind==="constant")g=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:T,minZoom:C,maxZoom:k}=c,B=T?L(oi.interpolationFactor(T,o,C,k),0,1):0;c.kind==="camera"?g=xn(c.minSize,c.maxSize,B):h=B}return{uSizeT:h,uSize:g}},a.evaluateVariableOffset=e9,a.evented=Mc,a.exported=Pn,a.exported$1=hi,a.extend=q,a.filterObject=ie,a.fromRotation=function(c,o){var h=Math.sin(o),g=Math.cos(o);return c[0]=g,c[1]=h,c[2]=0,c[3]=-h,c[4]=g,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},a.fromScaling=function(c,o){return c[0]=o[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=o[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=o[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},a.getAnchorAlignment=um,a.getAnchorJustification=fm,a.getArrayBuffer=si,a.getImage=Wr,a.getJSON=function(c,o){return Qn(q(c,{type:"json"}),o)},a.getOverlapMode=gm,a.getRTLTextPluginStatus=Tl,a.getReferrer=Rn,a.getVideo=function(c,o){const h=window.document.createElement("video");h.muted=!0,h.onloadstart=function(){o(null,h)};for(let g=0;g<c.length;g++){const T=window.document.createElement("source");hr(c[g])||(h.crossOrigin="Anonymous"),T.src=c[g],h.appendChild(T)}return{cancel:()=>{}}},a.identity=q3,a.invert=function(c,o){var h=o[0],g=o[1],T=o[2],C=o[3],k=o[4],B=o[5],F=o[6],j=o[7],Q=o[8],ee=o[9],ae=o[10],he=o[11],fe=o[12],Le=o[13],Pe=o[14],Ve=o[15],Qe=h*B-g*k,Fe=h*F-T*k,qe=h*j-C*k,at=g*F-T*B,ot=g*j-C*B,Bt=T*j-C*F,Gt=Q*Le-ee*fe,Dt=Q*Pe-ae*fe,Ct=Q*Ve-he*fe,Et=ee*Pe-ae*Le,Rt=ee*Ve-he*Le,Mt=ae*Ve-he*Pe,gt=Qe*Mt-Fe*Rt+qe*Et+at*Ct-ot*Dt+Bt*Gt;return gt?(c[0]=(B*Mt-F*Rt+j*Et)*(gt=1/gt),c[1]=(T*Rt-g*Mt-C*Et)*gt,c[2]=(Le*Bt-Pe*ot+Ve*at)*gt,c[3]=(ae*ot-ee*Bt-he*at)*gt,c[4]=(F*Ct-k*Mt-j*Dt)*gt,c[5]=(h*Mt-T*Ct+C*Dt)*gt,c[6]=(Pe*qe-fe*Bt-Ve*Fe)*gt,c[7]=(Q*Bt-ae*qe+he*Fe)*gt,c[8]=(k*Rt-B*Ct+j*Gt)*gt,c[9]=(g*Ct-h*Rt-C*Gt)*gt,c[10]=(fe*ot-Le*qe+Ve*Qe)*gt,c[11]=(ee*qe-Q*ot-he*Qe)*gt,c[12]=(B*Dt-k*Et-F*Gt)*gt,c[13]=(h*Et-g*Dt+T*Gt)*gt,c[14]=(Le*Fe-fe*at-Pe*Qe)*gt,c[15]=(Q*at-ee*Fe+ae*Qe)*gt,c):null},a.isImageBitmap=Tt,a.isSafari=ht,a.isWorker=nt,a.keysDifference=function(c,o){const h=[];for(const g in c)g in o||h.push(g);return h},a.lazyLoadRTLTextPlugin=function(){Zr.isLoading()||Zr.isLoaded()||Tl()!=="deferred"||Ju()},a.makeRequest=Qn,a.mapObject=ne,a.mercatorXfromLng=a9,a.mercatorYfromLat=l9,a.mercatorZfromAltitude=c9,a.mul=eM,a.mul$1=function(c,o,h){return c[0]=o[0]*h[0],c[1]=o[1]*h[1],c[2]=o[2]*h[2],c[3]=o[3]*h[3],c},a.multiply=u7,a.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},a.normalize=function(c,o){var h=o[0],g=o[1],T=o[2],C=h*h+g*g+T*T;return C>0&&(C=1/Math.sqrt(C)),c[0]=o[0]*C,c[1]=o[1]*C,c[2]=o[2]*C,c},a.number=xn,a.ortho=function(c,o,h,g,T,C,k){var B=1/(o-h),F=1/(g-T),j=1/(C-k);return c[0]=-2*B,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*F,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*j,c[11]=0,c[12]=(o+h)*B,c[13]=(T+g)*F,c[14]=(k+C)*j,c[15]=1,c},a.parseCacheControl=ut,a.parseGlyphPbf=function(c){return new om(c).readFields(eI,[])},a.pbf=om,a.performSymbolLayout=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=tr/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const o=c.bucket.layers[0].layout,h=c.bucket.layers[0]._unevaluatedLayout._values,g={layoutIconSize:h["icon-size"].possiblyEvaluate(new fi(c.bucket.zoom+1),c.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new fi(c.bucket.zoom+1),c.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new fi(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:j}=c.bucket.textSizeData;g.compositeTextSizes=[h["text-size"].possiblyEvaluate(new fi(F),c.canonical),h["text-size"].possiblyEvaluate(new fi(j),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:j}=c.bucket.iconSizeData;g.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new fi(F),c.canonical),h["icon-size"].possiblyEvaluate(new fi(j),c.canonical)]}const T=o.get("text-line-height")*mr,C=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",k=o.get("text-keep-upright"),B=o.get("text-size");for(const F of c.bucket.features){const j=o.get("text-font").evaluate(F,{},c.canonical).join(","),Q=B.evaluate(F,{},c.canonical),ee=g.layoutTextSize.evaluate(F,{},c.canonical),ae=g.layoutIconSize.evaluate(F,{},c.canonical),he={horizontal:{},vertical:void 0},fe=F.text;let Le,Pe=[0,0];if(fe){const Fe=fe.toString(),qe=o.get("text-letter-spacing").evaluate(F,{},c.canonical)*mr,at=Qu(Fe)?qe:0,ot=o.get("text-anchor").evaluate(F,{},c.canonical),Bt=o.get("text-variable-anchor");if(!Bt){const Rt=o.get("text-radial-offset").evaluate(F,{},c.canonical);Pe=Rt?e9(ot,[Rt*mr,hm]):o.get("text-offset").evaluate(F,{},c.canonical).map(Mt=>Mt*mr)}let Gt=C?"center":o.get("text-justify").evaluate(F,{},c.canonical);const Dt=o.get("symbol-placement"),Ct=Dt==="point"?o.get("text-max-width").evaluate(F,{},c.canonical)*mr:0,Et=()=>{c.bucket.allowVerticalPlacement&&b0(Fe)&&(he.vertical=AA(fe,c.glyphMap,c.glyphPositions,c.imagePositions,j,Ct,T,ot,"left",at,Pe,a.WritingMode.vertical,!0,Dt,ee,Q))};if(!C&&Bt){const Rt=Gt==="auto"?Bt.map(gt=>fm(gt)):[Gt];let Mt=!1;for(let gt=0;gt<Rt.length;gt++){const nn=Rt[gt];if(!he.horizontal[nn])if(Mt)he.horizontal[nn]=he.horizontal[0];else{const $t=AA(fe,c.glyphMap,c.glyphPositions,c.imagePositions,j,Ct,T,"center",nn,at,Pe,a.WritingMode.horizontal,!1,Dt,ee,Q);$t&&(he.horizontal[nn]=$t,Mt=$t.positionedLines.length===1)}}Et()}else{Gt==="auto"&&(Gt=fm(ot));const Rt=AA(fe,c.glyphMap,c.glyphPositions,c.imagePositions,j,Ct,T,ot,Gt,at,Pe,a.WritingMode.horizontal,!1,Dt,ee,Q);Rt&&(he.horizontal[Gt]=Rt),Et(),b0(Fe)&&C&&k&&(he.vertical=AA(fe,c.glyphMap,c.glyphPositions,c.imagePositions,j,Ct,T,ot,Gt,at,Pe,a.WritingMode.vertical,!1,Dt,ee,Q))}}let Ve=!1;if(F.icon&&F.icon.name){const Fe=c.imageMap[F.icon.name];Fe&&(Le=oI(c.imagePositions[F.icon.name],o.get("icon-offset").evaluate(F,{},c.canonical),o.get("icon-anchor").evaluate(F,{},c.canonical)),Ve=!!Fe.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=Ve:c.bucket.sdfIcons!==Ve&&Te("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Fe.pixelRatio!==c.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const Qe=n9(he.horizontal)||he.vertical;c.bucket.iconsInText=!!Qe&&Qe.iconsInText,(Qe||Le)&&AI(c.bucket,F,he,Le,c.imageMap,g,ee,ae,Pe,Ve,c.canonical)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},a.perspective=function(c,o,h,g,T){var C,k=1/Math.tan(o/2);return c[0]=k/h,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=k,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,T!=null&&T!==1/0?(c[10]=(T+g)*(C=1/(g-T)),c[14]=2*T*g*C):(c[10]=-1,c[14]=-2*g),c},a.pick=function(c,o){const h={};for(let g=0;g<o.length;g++){const T=o[g];T in c&&(h[T]=c[T])}return h},a.plugin=Zr,a.pointGeometry=Ft,a.polygonIntersectsPolygon=s7,a.potpack=F7,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=zt,a.registerForPluginStateChange=function(c){return c({pluginStatus:pr,pluginURL:Ks}),Mc.on("pluginStateChange",c),c},a.renderColorRamp=g7,a.rotateX=function(c,o,h){var g=Math.sin(h),T=Math.cos(h),C=o[4],k=o[5],B=o[6],F=o[7],j=o[8],Q=o[9],ee=o[10],ae=o[11];return o!==c&&(c[0]=o[0],c[1]=o[1],c[2]=o[2],c[3]=o[3],c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15]),c[4]=C*T+j*g,c[5]=k*T+Q*g,c[6]=B*T+ee*g,c[7]=F*T+ae*g,c[8]=j*T-C*g,c[9]=Q*T-k*g,c[10]=ee*T-B*g,c[11]=ae*T-F*g,c},a.rotateZ=function(c,o,h){var g=Math.sin(h),T=Math.cos(h),C=o[0],k=o[1],B=o[2],F=o[3],j=o[4],Q=o[5],ee=o[6],ae=o[7];return o!==c&&(c[8]=o[8],c[9]=o[9],c[10]=o[10],c[11]=o[11],c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15]),c[0]=C*T+j*g,c[1]=k*T+Q*g,c[2]=B*T+ee*g,c[3]=F*T+ae*g,c[4]=j*T-C*g,c[5]=Q*T-k*g,c[6]=ee*T-B*g,c[7]=ae*T-F*g,c},a.scale=function(c,o,h){var g=h[0],T=h[1],C=h[2];return c[0]=o[0]*g,c[1]=o[1]*g,c[2]=o[2]*g,c[3]=o[3]*g,c[4]=o[4]*T,c[5]=o[5]*T,c[6]=o[6]*T,c[7]=o[7]*T,c[8]=o[8]*C,c[9]=o[9]*C,c[10]=o[10]*C,c[11]=o[11]*C,c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15],c},a.scale$1=function(c,o,h){return c[0]=o[0]*h,c[1]=o[1]*h,c[2]=o[2]*h,c},a.setCacheLimits=function(c,o){Tn=c,Di=o},a.setRTLTextPlugin=function(c,o,h=!1){if(pr===Sc||pr===Cc||pr===Pc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ks=Pn.resolveURL(c),pr=Sc,zs=o,Fa(),h||Ju()},a.spec=et,a.sphericalToCartesian=function([c,o,h]){return o+=90,o*=Math.PI/180,h*=Math.PI/180,{x:c*Math.cos(o)*Math.sin(h),y:c*Math.sin(o)*Math.sin(h),z:c*Math.cos(h)}},a.sqrLen=function(c){var o=c[0],h=c[1];return o*o+h*h},a.sub=function(c,o,h){return c[0]=o[0]-h[0],c[1]=o[1]-h[1],c[2]=o[2]-h[2],c},a.toEvaluationFeature=Bc,a.transformMat3=function(c,o,h){var g=o[0],T=o[1],C=o[2];return c[0]=g*h[0]+T*h[3]+C*h[6],c[1]=g*h[1]+T*h[4]+C*h[7],c[2]=g*h[2]+T*h[5]+C*h[8],c},a.transformMat4=sA,a.transformMat4$1=function(c,o,h){var g=o[0],T=o[1];return c[0]=h[0]*g+h[4]*T+h[12],c[1]=h[1]*g+h[5]*T+h[13],c},a.translate=function(c,o,h){var g,T,C,k,B,F,j,Q,ee,ae,he,fe,Le=h[0],Pe=h[1],Ve=h[2];return o===c?(c[12]=o[0]*Le+o[4]*Pe+o[8]*Ve+o[12],c[13]=o[1]*Le+o[5]*Pe+o[9]*Ve+o[13],c[14]=o[2]*Le+o[6]*Pe+o[10]*Ve+o[14],c[15]=o[3]*Le+o[7]*Pe+o[11]*Ve+o[15]):(T=o[1],C=o[2],k=o[3],B=o[4],F=o[5],j=o[6],Q=o[7],ee=o[8],ae=o[9],he=o[10],fe=o[11],c[0]=g=o[0],c[1]=T,c[2]=C,c[3]=k,c[4]=B,c[5]=F,c[6]=j,c[7]=Q,c[8]=ee,c[9]=ae,c[10]=he,c[11]=fe,c[12]=g*Le+B*Pe+ee*Ve+o[12],c[13]=T*Le+F*Pe+ae*Ve+o[13],c[14]=C*Le+j*Pe+he*Ve+o[14],c[15]=k*Le+Q*Pe+fe*Ve+o[15]),c},a.triggerPluginCompletionEvent=Ku,a.unicodeBlockLookup=kt,a.uniqueId=function(){return te++},a.validateCustomStyleLayer=function(c){const o=[],h=c.id;return h===void 0&&o.push({message:`layers.${h}: missing required property "id"`}),c.render===void 0&&o.push({message:`layers.${h}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&o.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),o},a.validateLight=wc,a.validateStyle=El,a.vectorTile=C0,a.warnOnce=Te,a.wrap=U}),s(["./shared"],function(a){function y(Y){const V=typeof Y;if(V==="number"||V==="boolean"||V==="string"||Y==null)return JSON.stringify(Y);if(Array.isArray(Y)){let f="[";for(const W of Y)f+=`${y(W)},`;return`${f}]`}const X=Object.keys(Y).sort();let oe="{";for(let f=0;f<X.length;f++)oe+=`${JSON.stringify(X[f])}:${y(Y[X[f]])},`;return`${oe}}`}function w(Y){let V="";for(const X of a.refProperties)V+=`/${y(Y[X])}`;return V}class M{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,X){for(const f of V){this._layerConfigs[f.id]=f;const W=this._layers[f.id]=a.createStyleLayer(f);W._featureFilter=a.createFilter(W.filter),this.keyCache[f.id]&&delete this.keyCache[f.id]}for(const f of X)delete this.keyCache[f],delete this._layerConfigs[f],delete this._layers[f];this.familiesBySource={};const oe=function(f,W){const ke={};for(let be=0;be<f.length;be++){const Me=W&&W[f[be].id]||w(f[be]);W&&(W[f[be].id]=Me);let Ne=ke[Me];Ne||(Ne=ke[Me]=[]),Ne.push(f[be])}const Ce=[];for(const be in ke)Ce.push(ke[be]);return Ce}(Object.values(this._layerConfigs),this.keyCache);for(const f of oe){const W=f.map(it=>this._layers[it.id]),ke=W[0];if(ke.visibility==="none")continue;const Ce=ke.source||"";let be=this.familiesBySource[Ce];be||(be=this.familiesBySource[Ce]={});const Me=ke.sourceLayer||"_geojsonTileLayer";let Ne=be[Me];Ne||(Ne=be[Me]=[]),Ne.push(W)}}}class R{constructor(V){const X={},oe=[];for(const Ce in V){const be=V[Ce],Me=X[Ce]={};for(const Ne in be){const it=be[+Ne];if(!it||it.bitmap.width===0||it.bitmap.height===0)continue;const Ue={x:0,y:0,w:it.bitmap.width+2,h:it.bitmap.height+2};oe.push(Ue),Me[Ne]={rect:Ue,metrics:it.metrics}}}const{w:f,h:W}=a.potpack(oe),ke=new a.AlphaImage({width:f||1,height:W||1});for(const Ce in V){const be=V[Ce];for(const Me in be){const Ne=be[+Me];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const it=X[Ce][Me].rect;a.AlphaImage.copy(Ne.bitmap,ke,{x:0,y:0},{x:it.x+1,y:it.y+1},Ne.bitmap)}}this.image=ke,this.positions=X}}a.register("GlyphAtlas",R);class L{constructor(V){this.tileID=new a.OverscaledTileID(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId}parse(V,X,oe,f,W){this.status="parsing",this.data=V,this.collisionBoxArray=new a.CollisionBoxArray;const ke=new a.DictionaryCoder(Object.keys(V.layers).sort()),Ce=new a.FeatureIndex(this.tileID,this.promoteId);Ce.bucketLayerIDs=[];const be={},Me={featureIndex:Ce,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:oe},Ne=X.familiesBySource[this.source];for(const Wt in Ne){const Xt=V.layers[Wt];if(!Xt)continue;Xt.version===1&&a.warnOnce(`Vector tile source "${this.source}" layer "${Wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const yn=ke.encode(Wt),Mn=[];for(let Un=0;Un<Xt.length;Un++){const Ut=Xt.feature(Un),ge=Ce.getId(Ut,Wt);Mn.push({feature:Ut,id:ge,index:Un,sourceLayerIndex:yn})}for(const Un of Ne[Wt]){const Ut=Un[0];Ut.source!==this.source&&a.warnOnce(`layer.source = ${Ut.source} does not equal this.source = ${this.source}`),Ut.minzoom&&this.zoom<Math.floor(Ut.minzoom)||Ut.maxzoom&&this.zoom>=Ut.maxzoom||Ut.visibility!=="none"&&(U(Un,this.zoom,oe),(be[Ut.id]=Ut.createBucket({index:Ce.bucketLayerIDs.length,layers:Un,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yn,sourceID:this.source})).populate(Mn,Me,this.tileID.canonical),Ce.bucketLayerIDs.push(Un.map(ge=>ge.id)))}}let it,Ue,ct,It;const St=a.mapObject(Me.glyphDependencies,Wt=>Object.keys(Wt).map(Number));Object.keys(St).length?f.send("getGlyphs",{uid:this.uid,stacks:St},(Wt,Xt)=>{it||(it=Wt,Ue=Xt,sn.call(this))}):Ue={};const Zt=Object.keys(Me.iconDependencies);Zt.length?f.send("getImages",{icons:Zt,source:this.source,tileID:this.tileID,type:"icons"},(Wt,Xt)=>{it||(it=Wt,ct=Xt,sn.call(this))}):ct={};const Vt=Object.keys(Me.patternDependencies);function sn(){if(it)return W(it);if(Ue&&ct&&It){const Wt=new R(Ue),Xt=new a.ImageAtlas(ct,It);for(const yn in be){const Mn=be[yn];Mn instanceof a.SymbolBucket?(U(Mn.layers,this.zoom,oe),a.performSymbolLayout({bucket:Mn,glyphMap:Ue,glyphPositions:Wt.positions,imageMap:ct,imagePositions:Xt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Mn.hasPattern&&(Mn instanceof a.LineBucket||Mn instanceof a.FillBucket||Mn instanceof a.FillExtrusionBucket)&&(U(Mn.layers,this.zoom,oe),Mn.addFeatures(Me,this.tileID.canonical,Xt.patternPositions))}this.status="done",W(null,{buckets:Object.values(be).filter(yn=>!yn.isEmpty()),featureIndex:Ce,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Wt.image,imageAtlas:Xt,glyphMap:this.returnDependencies?Ue:null,iconMap:this.returnDependencies?ct:null,glyphPositions:this.returnDependencies?Wt.positions:null})}}Vt.length?f.send("getImages",{icons:Vt,source:this.source,tileID:this.tileID,type:"patterns"},(Wt,Xt)=>{it||(it=Wt,It=Xt,sn.call(this))}):It={},sn.call(this)}}function U(Y,V,X){const oe=new a.EvaluationParameters(V);for(const f of Y)f.recalculate(oe,X)}function q(Y,V){const X=a.getArrayBuffer(Y.request,(oe,f,W,ke)=>{oe?V(oe):f&&V(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(f)),rawData:f,cacheControl:W,expires:ke})});return()=>{X.cancel(),V()}}class te{constructor(V,X,oe,f){this.actor=V,this.layerIndex=X,this.availableImages=oe,this.loadVectorData=f||q,this.loading={},this.loaded={}}loadTile(V,X){const oe=V.uid;this.loading||(this.loading={});const f=!!(V&&V.request&&V.request.collectResourceTiming)&&new a.RequestPerformance(V.request),W=this.loading[oe]=new L(V);W.abort=this.loadVectorData(V,(ke,Ce)=>{if(delete this.loading[oe],ke||!Ce)return W.status="done",this.loaded[oe]=W,X(ke);const be=Ce.rawData,Me={};Ce.expires&&(Me.expires=Ce.expires),Ce.cacheControl&&(Me.cacheControl=Ce.cacheControl);const Ne={};if(f){const it=f.finish();it&&(Ne.resourceTiming=JSON.parse(JSON.stringify(it)))}W.vectorTile=Ce.vectorTile,W.parse(Ce.vectorTile,this.layerIndex,this.availableImages,this.actor,(it,Ue)=>{if(it||!Ue)return X(it);X(null,a.extend({rawTileData:be.slice(0)},Ue,Me,Ne))}),this.loaded=this.loaded||{},this.loaded[oe]=W})}reloadTile(V,X){const oe=this.loaded,f=V.uid,W=this;if(oe&&oe[f]){const ke=oe[f];ke.showCollisionBoxes=V.showCollisionBoxes;const Ce=(be,Me)=>{const Ne=ke.reloadCallback;Ne&&(delete ke.reloadCallback,ke.parse(ke.vectorTile,W.layerIndex,this.availableImages,W.actor,Ne)),X(be,Me)};ke.status==="parsing"?ke.reloadCallback=Ce:ke.status==="done"&&(ke.vectorTile?ke.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,Ce):Ce())}}abortTile(V,X){const oe=this.loading,f=V.uid;oe&&oe[f]&&oe[f].abort&&(oe[f].abort(),delete oe[f]),X()}removeTile(V,X){const oe=this.loaded,f=V.uid;oe&&oe[f]&&delete oe[f],X()}}class pe{constructor(){this.loaded={}}loadTile(V,X){const{uid:oe,encoding:f,rawImageData:W}=V,ke=a.isImageBitmap(W)?this.getImageData(W):W,Ce=new a.DEMData(oe,ke,f);this.loaded=this.loaded||{},this.loaded[oe]=Ce,X(null,Ce)}getImageData(V){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(V.width,V.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=V.width,this.offscreenCanvas.height=V.height,this.offscreenCanvasContext.drawImage(V,0,0,V.width,V.height);const X=this.offscreenCanvasContext.getImageData(-1,-1,V.width+2,V.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:X.width,height:X.height},X.data)}removeTile(V){const X=this.loaded,oe=V.uid;X&&X[oe]&&delete X[oe]}}var ne=function Y(V,X){var oe,f=V&&V.type;if(f==="FeatureCollection")for(oe=0;oe<V.features.length;oe++)Y(V.features[oe],X);else if(f==="GeometryCollection")for(oe=0;oe<V.geometries.length;oe++)Y(V.geometries[oe],X);else if(f==="Feature")Y(V.geometry,X);else if(f==="Polygon")ie(V.coordinates,X);else if(f==="MultiPolygon")for(oe=0;oe<V.coordinates.length;oe++)ie(V.coordinates[oe],X);return V};function ie(Y,V){if(Y.length!==0){re(Y[0],V);for(var X=1;X<Y.length;X++)re(Y[X],!V)}}function re(Y,V){for(var X=0,oe=0,f=0,W=Y.length,ke=W-1;f<W;ke=f++){var Ce=(Y[f][0]-Y[ke][0])*(Y[ke][1]+Y[f][1]),be=X+Ce;oe+=Math.abs(X)>=Math.abs(Ce)?X-be+Ce:Ce-be+X,X=be}X+oe>=0!=!!V&&Y.reverse()}const _e=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Te{constructor(V){this._feature=V,this.extent=a.EXTENT,this.type=V.type,this.properties=V.tags,"id"in V&&!isNaN(V.id)&&(this.id=parseInt(V.id,10))}loadGeometry(){if(this._feature.type===1){const V=[];for(const X of this._feature.geometry)V.push([new a.pointGeometry(X[0],X[1])]);return V}{const V=[];for(const X of this._feature.geometry){const oe=[];for(const f of X)oe.push(new a.pointGeometry(f[0],f[1]));V.push(oe)}return V}}toGeoJSON(V,X,oe){return _e.call(this,V,X,oe)}}class De{constructor(V){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=V.length,this._features=V}feature(V){return new Te(this._features[V])}}var $e={exports:{}},nt=a.pointGeometry,ut=a.vectorTile.VectorTileFeature,st=lt;function lt(Y,V){this.options=V||{},this.features=Y,this.length=Y.length}function Lt(Y,V){this.id=typeof Y.id=="number"?Y.id:void 0,this.type=Y.type,this.rawGeometry=Y.type===1?[Y.geometry]:Y.geometry,this.properties=Y.tags,this.extent=V||4096}lt.prototype.feature=function(Y){return new Lt(this.features[Y],this.options.extent)},Lt.prototype.loadGeometry=function(){var Y=this.rawGeometry;this.geometry=[];for(var V=0;V<Y.length;V++){for(var X=Y[V],oe=[],f=0;f<X.length;f++)oe.push(new nt(X[f][0],X[f][1]));this.geometry.push(oe)}return this.geometry},Lt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Y=this.geometry,V=1/0,X=-1/0,oe=1/0,f=-1/0,W=0;W<Y.length;W++)for(var ke=Y[W],Ce=0;Ce<ke.length;Ce++){var be=ke[Ce];V=Math.min(V,be.x),X=Math.max(X,be.x),oe=Math.min(oe,be.y),f=Math.max(f,be.y)}return[V,oe,X,f]},Lt.prototype.toGeoJSON=ut.prototype.toGeoJSON;var ht=a.pbf,Tt=st;function Pn(Y){var V=new ht;return function(X,oe){for(var f in X.layers)oe.writeMessage(3,Ft,X.layers[f])}(Y,V),V.finish()}function Ft(Y,V){var X;V.writeVarintField(15,Y.version||1),V.writeStringField(1,Y.name||""),V.writeVarintField(5,Y.extent||4096);var oe={keys:[],values:[],keycache:{},valuecache:{}};for(X=0;X<Y.length;X++)oe.feature=Y.feature(X),V.writeMessage(2,Zn,oe);var f=oe.keys;for(X=0;X<f.length;X++)V.writeStringField(3,f[X]);var W=oe.values;for(X=0;X<W.length;X++)V.writeMessage(4,Tn,W[X])}function Zn(Y,V){var X=Y.feature;X.id!==void 0&&V.writeVarintField(1,X.id),V.writeMessage(2,yt,Y),V.writeVarintField(3,X.type),V.writeMessage(4,In,X)}function yt(Y,V){var X=Y.feature,oe=Y.keys,f=Y.values,W=Y.keycache,ke=Y.valuecache;for(var Ce in X.properties){var be=X.properties[Ce],Me=W[Ce];if(be!==null){Me===void 0&&(oe.push(Ce),W[Ce]=Me=oe.length-1),V.writeVarint(Me);var Ne=typeof be;Ne!=="string"&&Ne!=="boolean"&&Ne!=="number"&&(be=JSON.stringify(be));var it=Ne+":"+be,Ue=ke[it];Ue===void 0&&(f.push(be),ke[it]=Ue=f.length-1),V.writeVarint(Ue)}}}function Ot(Y,V){return(V<<3)+(7&Y)}function Jt(Y){return Y<<1^Y>>31}function In(Y,V){for(var X=Y.loadGeometry(),oe=Y.type,f=0,W=0,ke=X.length,Ce=0;Ce<ke;Ce++){var be=X[Ce],Me=1;oe===1&&(Me=be.length),V.writeVarint(Ot(1,Me));for(var Ne=oe===3?be.length-1:be.length,it=0;it<Ne;it++){it===1&&oe!==1&&V.writeVarint(Ot(2,Ne-1));var Ue=be[it].x-f,ct=be[it].y-W;V.writeVarint(Jt(Ue)),V.writeVarint(Jt(ct)),f+=Ue,W+=ct}oe===3&&V.writeVarint(Ot(7,1))}}function Tn(Y,V){var X=typeof Y;X==="string"?V.writeStringField(1,Y):X==="boolean"?V.writeBooleanField(7,Y):X==="number"&&(Y%1!=0?V.writeDoubleField(3,Y):Y<0?V.writeSVarintField(6,Y):V.writeVarintField(5,Y))}function Di(Y,V,X,oe,f,W){if(f-oe<=X)return;const ke=oe+f>>1;di(Y,V,ke,oe,f,W%2),Di(Y,V,X,oe,ke-1,W+1),Di(Y,V,X,ke+1,f,W+1)}function di(Y,V,X,oe,f,W){for(;f>oe;){if(f-oe>600){const Me=f-oe+1,Ne=X-oe+1,it=Math.log(Me),Ue=.5*Math.exp(2*it/3),ct=.5*Math.sqrt(it*Ue*(Me-Ue)/Me)*(Ne-Me/2<0?-1:1);di(Y,V,X,Math.max(oe,Math.floor(X-Ne*Ue/Me+ct)),Math.min(f,Math.floor(X+(Me-Ne)*Ue/Me+ct)),W)}const ke=V[2*X+W];let Ce=oe,be=f;for(ii(Y,V,oe,X),V[2*f+W]>ke&&ii(Y,V,oe,f);Ce<be;){for(ii(Y,V,Ce,be),Ce++,be--;V[2*Ce+W]<ke;)Ce++;for(;V[2*be+W]>ke;)be--}V[2*oe+W]===ke?ii(Y,V,oe,be):(be++,ii(Y,V,be,f)),be<=X&&(oe=be+1),X<=be&&(f=be-1)}}function ii(Y,V,X,oe){hi(Y,X,oe),hi(V,2*X,2*oe),hi(V,2*X+1,2*oe+1)}function hi(Y,V,X){const oe=Y[V];Y[V]=Y[X],Y[X]=oe}function On(Y,V,X,oe){const f=Y-X,W=V-oe;return f*f+W*W}$e.exports=Pn,$e.exports.fromVectorTileJs=Pn,$e.exports.fromGeojsonVt=function(Y,V){V=V||{};var X={};for(var oe in Y)X[oe]=new Tt(Y[oe].features,V),X[oe].name=oe,X[oe].version=V.version,X[oe].extent=V.extent;return Pn({layers:X})},$e.exports.GeoJSONWrapper=Tt;const vi=Y=>Y[0],mt=Y=>Y[1];class Yt{constructor(V,X=vi,oe=mt,f=64,W=Float64Array){this.nodeSize=f,this.points=V;const ke=V.length<65536?Uint16Array:Uint32Array,Ce=this.ids=new ke(V.length),be=this.coords=new W(2*V.length);for(let Me=0;Me<V.length;Me++)Ce[Me]=Me,be[2*Me]=X(V[Me]),be[2*Me+1]=oe(V[Me]);Di(Ce,be,f,0,Ce.length-1,0)}range(V,X,oe,f){return function(W,ke,Ce,be,Me,Ne,it){const Ue=[0,W.length-1,0],ct=[];let It,St;for(;Ue.length;){const Zt=Ue.pop(),Vt=Ue.pop(),sn=Ue.pop();if(Vt-sn<=it){for(let yn=sn;yn<=Vt;yn++)It=ke[2*yn],St=ke[2*yn+1],It>=Ce&&It<=Me&&St>=be&&St<=Ne&&ct.push(W[yn]);continue}const Wt=Math.floor((sn+Vt)/2);It=ke[2*Wt],St=ke[2*Wt+1],It>=Ce&&It<=Me&&St>=be&&St<=Ne&&ct.push(W[Wt]);const Xt=(Zt+1)%2;(Zt===0?Ce<=It:be<=St)&&(Ue.push(sn),Ue.push(Wt-1),Ue.push(Xt)),(Zt===0?Me>=It:Ne>=St)&&(Ue.push(Wt+1),Ue.push(Vt),Ue.push(Xt))}return ct}(this.ids,this.coords,V,X,oe,f,this.nodeSize)}within(V,X,oe){return function(f,W,ke,Ce,be,Me){const Ne=[0,f.length-1,0],it=[],Ue=be*be;for(;Ne.length;){const ct=Ne.pop(),It=Ne.pop(),St=Ne.pop();if(It-St<=Me){for(let Xt=St;Xt<=It;Xt++)On(W[2*Xt],W[2*Xt+1],ke,Ce)<=Ue&&it.push(f[Xt]);continue}const Zt=Math.floor((St+It)/2),Vt=W[2*Zt],sn=W[2*Zt+1];On(Vt,sn,ke,Ce)<=Ue&&it.push(f[Zt]);const Wt=(ct+1)%2;(ct===0?ke-be<=Vt:Ce-be<=sn)&&(Ne.push(St),Ne.push(Zt-1),Ne.push(Wt)),(ct===0?ke+be>=Vt:Ce+be>=sn)&&(Ne.push(Zt+1),Ne.push(It),Ne.push(Wt))}return it}(this.ids,this.coords,V,X,oe,this.nodeSize)}}const mn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Y=>Y},dt=Math.fround||(Fn=new Float32Array(1),Y=>(Fn[0]=+Y,Fn[0]));var Fn;class Rn{constructor(V){this.options=Wr(Object.create(mn),V),this.trees=new Array(this.options.maxZoom+1)}load(V){const{log:X,minZoom:oe,maxZoom:f,nodeSize:W}=this.options;X&&console.time("total time");const ke=`prepare ${V.length} points`;X&&console.time(ke),this.points=V;let Ce=[];for(let be=0;be<V.length;be++)V[be].geometry&&Ce.push(Qn(V[be],be));this.trees[f+1]=new Yt(Ce,vo,rr,W,Float32Array),X&&console.timeEnd(ke);for(let be=f;be>=oe;be--){const Me=+Date.now();Ce=this._cluster(Ce,be),this.trees[be]=new Yt(Ce,vo,rr,W,Float32Array),X&&console.log("z%d: %d clusters in %dms",be,Ce.length,+Date.now()-Me)}return X&&console.timeEnd("total time"),this}getClusters(V,X){let oe=((V[0]+180)%360+360)%360-180;const f=Math.max(-90,Math.min(90,V[1]));let W=V[2]===180?180:((V[2]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)oe=-180,W=180;else if(oe>W){const Ne=this.getClusters([oe,f,180,ke],X),it=this.getClusters([-180,f,W,ke],X);return Ne.concat(it)}const Ce=this.trees[this._limitZoom(X)],be=Ce.range(kn(oe),fr(ke),kn(W),fr(f)),Me=[];for(const Ne of be){const it=Ce.points[Ne];Me.push(it.numPoints?si(it):this.points[it.index])}return Me}getChildren(V){const X=this._getOriginId(V),oe=this._getOriginZoom(V),f="No cluster with the specified id.",W=this.trees[oe];if(!W)throw new Error(f);const ke=W.points[X];if(!ke)throw new Error(f);const Ce=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),be=W.within(ke.x,ke.y,Ce),Me=[];for(const Ne of be){const it=W.points[Ne];it.parentId===V&&Me.push(it.numPoints?si(it):this.points[it.index])}if(Me.length===0)throw new Error(f);return Me}getLeaves(V,X,oe){const f=[];return this._appendLeaves(f,V,X=X||10,oe=oe||0,0),f}getTile(V,X,oe){const f=this.trees[this._limitZoom(V)],W=Math.pow(2,V),{extent:ke,radius:Ce}=this.options,be=Ce/ke,Me=(oe-be)/W,Ne=(oe+1+be)/W,it={features:[]};return this._addTileFeatures(f.range((X-be)/W,Me,(X+1+be)/W,Ne),f.points,X,oe,W,it),X===0&&this._addTileFeatures(f.range(1-be/W,Me,1,Ne),f.points,W,oe,W,it),X===W-1&&this._addTileFeatures(f.range(0,Me,be/W,Ne),f.points,-1,oe,W,it),it.features.length?it:null}getClusterExpansionZoom(V){let X=this._getOriginZoom(V)-1;for(;X<=this.options.maxZoom;){const oe=this.getChildren(V);if(X++,oe.length!==1)break;V=oe[0].properties.cluster_id}return X}_appendLeaves(V,X,oe,f,W){const ke=this.getChildren(X);for(const Ce of ke){const be=Ce.properties;if(be&&be.cluster?W+be.point_count<=f?W+=be.point_count:W=this._appendLeaves(V,be.cluster_id,oe,f,W):W<f?W++:V.push(Ce),V.length===oe)break}return W}_addTileFeatures(V,X,oe,f,W,ke){for(const Ce of V){const be=X[Ce],Me=be.numPoints;let Ne,it,Ue;if(Me)Ne=hr(be),it=be.x,Ue=be.y;else{const St=this.points[be.index];Ne=St.properties,it=kn(St.geometry.coordinates[0]),Ue=fr(St.geometry.coordinates[1])}const ct={type:1,geometry:[[Math.round(this.options.extent*(it*W-oe)),Math.round(this.options.extent*(Ue*W-f))]],tags:Ne};let It;Me?It=be.id:this.options.generateId?It=be.index:this.points[be.index].id&&(It=this.points[be.index].id),It!==void 0&&(ct.id=It),ke.features.push(ct)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,X){const oe=[],{radius:f,extent:W,reduce:ke,minPoints:Ce}=this.options,be=f/(W*Math.pow(2,X));for(let Me=0;Me<V.length;Me++){const Ne=V[Me];if(Ne.zoom<=X)continue;Ne.zoom=X;const it=this.trees[X+1],Ue=it.within(Ne.x,Ne.y,be),ct=Ne.numPoints||1;let It=ct;for(const St of Ue){const Zt=it.points[St];Zt.zoom>X&&(It+=Zt.numPoints||1)}if(It>ct&&It>=Ce){let St=Ne.x*ct,Zt=Ne.y*ct,Vt=ke&&ct>1?this._map(Ne,!0):null;const sn=(Me<<5)+(X+1)+this.points.length;for(const Wt of Ue){const Xt=it.points[Wt];if(Xt.zoom<=X)continue;Xt.zoom=X;const yn=Xt.numPoints||1;St+=Xt.x*yn,Zt+=Xt.y*yn,Xt.parentId=sn,ke&&(Vt||(Vt=this._map(Ne,!0)),ke(Vt,this._map(Xt)))}Ne.parentId=sn,oe.push(ri(St/It,Zt/It,sn,It,Vt))}else if(oe.push(Ne),It>1)for(const St of Ue){const Zt=it.points[St];Zt.zoom<=X||(Zt.zoom=X,oe.push(Zt))}}return oe}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,X){if(V.numPoints)return X?Wr({},V.properties):V.properties;const oe=this.points[V.index].properties,f=this.options.map(oe);return X&&f===oe?Wr({},f):f}}function ri(Y,V,X,oe,f){return{x:dt(Y),y:dt(V),zoom:1/0,id:X,parentId:-1,numPoints:oe,properties:f}}function Qn(Y,V){const[X,oe]=Y.geometry.coordinates;return{x:dt(kn(X)),y:dt(fr(oe)),zoom:1/0,index:V,parentId:-1}}function si(Y){return{type:"Feature",id:Y.id,properties:hr(Y),geometry:{type:"Point",coordinates:[(V=Y.x,360*(V-.5)),Yn(Y.y)]}};var V}function hr(Y){const V=Y.numPoints,X=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V;return Wr(Wr({},Y.properties),{cluster:!0,cluster_id:Y.id,point_count:V,point_count_abbreviated:X})}function kn(Y){return Y/360+.5}function fr(Y){const V=Math.sin(Y*Math.PI/180),X=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return X<0?0:X>1?1:X}function Yn(Y){const V=(180-360*Y)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function Wr(Y,V){for(const X in V)Y[X]=V[X];return Y}function vo(Y){return Y.x}function rr(Y){return Y.y}function Lr(Y,V,X,oe){for(var f,W=oe,ke=X-V>>1,Ce=X-V,be=Y[V],Me=Y[V+1],Ne=Y[X],it=Y[X+1],Ue=V+3;Ue<X;Ue+=3){var ct=xo(Y[Ue],Y[Ue+1],be,Me,Ne,it);if(ct>W)f=Ue,W=ct;else if(ct===W){var It=Math.abs(Ue-ke);It<Ce&&(f=Ue,Ce=It)}}W>oe&&(f-V>3&&Lr(Y,V,f,oe),Y[f+2]=W,X-f>3&&Lr(Y,f,X,oe))}function xo(Y,V,X,oe,f,W){var ke=f-X,Ce=W-oe;if(ke!==0||Ce!==0){var be=((Y-X)*ke+(V-oe)*Ce)/(ke*ke+Ce*Ce);be>1?(X=f,oe=W):be>0&&(X+=ke*be,oe+=Ce*be)}return(ke=Y-X)*ke+(Ce=V-oe)*Ce}function $r(Y,V,X,oe){var f={id:Y===void 0?null:Y,type:V,geometry:X,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(W){var ke=W.geometry,Ce=W.type;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")et(W,ke);else if(Ce==="Polygon"||Ce==="MultiLineString")for(var be=0;be<ke.length;be++)et(W,ke[be]);else if(Ce==="MultiPolygon")for(be=0;be<ke.length;be++)for(var Me=0;Me<ke[be].length;Me++)et(W,ke[be][Me])}(f),f}function et(Y,V){for(var X=0;X<V.length;X+=3)Y.minX=Math.min(Y.minX,V[X]),Y.minY=Math.min(Y.minY,V[X+1]),Y.maxX=Math.max(Y.maxX,V[X]),Y.maxY=Math.max(Y.maxY,V[X+1])}function xt(Y,V,X,oe){if(V.geometry){var f=V.geometry.coordinates,W=V.geometry.type,ke=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2),Ce=[],be=V.id;if(X.promoteId?be=V.properties[X.promoteId]:X.generateId&&(be=oe||0),W==="Point")Ms(f,Ce);else if(W==="MultiPoint")for(var Me=0;Me<f.length;Me++)Ms(f[Me],Ce);else if(W==="LineString")sr(f,Ce,ke,!1);else if(W==="MultiLineString"){if(X.lineMetrics){for(Me=0;Me<f.length;Me++)sr(f[Me],Ce=[],ke,!1),Y.push($r(be,"LineString",Ce,V.properties));return}Sn(f,Ce,ke,!1)}else if(W==="Polygon")Sn(f,Ce,ke,!0);else{if(W!=="MultiPolygon"){if(W==="GeometryCollection"){for(Me=0;Me<V.geometry.geometries.length;Me++)xt(Y,{id:be,geometry:V.geometry.geometries[Me],properties:V.properties},X,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Me=0;Me<f.length;Me++){var Ne=[];Sn(f[Me],Ne,ke,!0),Ce.push(Ne)}}Y.push($r(be,W,Ce,V.properties))}}function Ms(Y,V){V.push(wr(Y[0])),V.push(Ar(Y[1])),V.push(0)}function sr(Y,V,X,oe){for(var f,W,ke=0,Ce=0;Ce<Y.length;Ce++){var be=wr(Y[Ce][0]),Me=Ar(Y[Ce][1]);V.push(be),V.push(Me),V.push(0),Ce>0&&(ke+=oe?(f*Me-be*W)/2:Math.sqrt(Math.pow(be-f,2)+Math.pow(Me-W,2))),f=be,W=Me}var Ne=V.length-3;V[2]=1,Lr(V,0,Ne,X),V[Ne+2]=1,V.size=Math.abs(ke),V.start=0,V.end=V.size}function Sn(Y,V,X,oe){for(var f=0;f<Y.length;f++){var W=[];sr(Y[f],W,X,oe),V.push(W)}}function wr(Y){return Y/360+.5}function Ar(Y){var V=Math.sin(Y*Math.PI/180),X=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return X<0?0:X>1?1:X}function dr(Y,V,X,oe,f,W,ke,Ce){if(oe/=V,W>=(X/=V)&&ke<oe)return Y;if(ke<X||W>=oe)return null;for(var be=[],Me=0;Me<Y.length;Me++){var Ne=Y[Me],it=Ne.geometry,Ue=Ne.type,ct=f===0?Ne.minX:Ne.minY,It=f===0?Ne.maxX:Ne.maxY;if(ct>=X&&It<oe)be.push(Ne);else if(!(It<X||ct>=oe)){var St=[];if(Ue==="Point"||Ue==="MultiPoint")us(it,St,X,oe,f);else if(Ue==="LineString")wt(it,St,X,oe,f,!1,Ce.lineMetrics);else if(Ue==="MultiLineString")fn(it,St,X,oe,f,!1);else if(Ue==="Polygon")fn(it,St,X,oe,f,!0);else if(Ue==="MultiPolygon")for(var Zt=0;Zt<it.length;Zt++){var Vt=[];fn(it[Zt],Vt,X,oe,f,!0),Vt.length&&St.push(Vt)}if(St.length){if(Ce.lineMetrics&&Ue==="LineString"){for(Zt=0;Zt<St.length;Zt++)be.push($r(Ne.id,Ue,St[Zt],Ne.tags));continue}Ue!=="LineString"&&Ue!=="MultiLineString"||(St.length===1?(Ue="LineString",St=St[0]):Ue="MultiLineString"),Ue!=="Point"&&Ue!=="MultiPoint"||(Ue=St.length===3?"Point":"MultiPoint"),be.push($r(Ne.id,Ue,St,Ne.tags))}}}return be.length?be:null}function us(Y,V,X,oe,f){for(var W=0;W<Y.length;W+=3){var ke=Y[W+f];ke>=X&&ke<=oe&&(V.push(Y[W]),V.push(Y[W+1]),V.push(Y[W+2]))}}function wt(Y,V,X,oe,f,W,ke){for(var Ce,be,Me=An(Y),Ne=f===0?hs:cn,it=Y.start,Ue=0;Ue<Y.length-3;Ue+=3){var ct=Y[Ue],It=Y[Ue+1],St=Y[Ue+2],Zt=Y[Ue+3],Vt=Y[Ue+4],sn=f===0?ct:It,Wt=f===0?Zt:Vt,Xt=!1;ke&&(Ce=Math.sqrt(Math.pow(ct-Zt,2)+Math.pow(It-Vt,2))),sn<X?Wt>X&&(be=Ne(Me,ct,It,Zt,Vt,X),ke&&(Me.start=it+Ce*be)):sn>oe?Wt<oe&&(be=Ne(Me,ct,It,Zt,Vt,oe),ke&&(Me.start=it+Ce*be)):Pi(Me,ct,It,St),Wt<X&&sn>=X&&(be=Ne(Me,ct,It,Zt,Vt,X),Xt=!0),Wt>oe&&sn<=oe&&(be=Ne(Me,ct,It,Zt,Vt,oe),Xt=!0),!W&&Xt&&(ke&&(Me.end=it+Ce*be),V.push(Me),Me=An(Y)),ke&&(it+=Ce)}var yn=Y.length-3;ct=Y[yn],It=Y[yn+1],St=Y[yn+2],(sn=f===0?ct:It)>=X&&sn<=oe&&Pi(Me,ct,It,St),yn=Me.length-3,W&&yn>=3&&(Me[yn]!==Me[0]||Me[yn+1]!==Me[1])&&Pi(Me,Me[0],Me[1],Me[2]),Me.length&&V.push(Me)}function An(Y){var V=[];return V.size=Y.size,V.start=Y.start,V.end=Y.end,V}function fn(Y,V,X,oe,f,W){for(var ke=0;ke<Y.length;ke++)wt(Y[ke],V,X,oe,f,W,!1)}function Pi(Y,V,X,oe){Y.push(V),Y.push(X),Y.push(oe)}function hs(Y,V,X,oe,f,W){var ke=(W-V)/(oe-V);return Y.push(W),Y.push(X+(f-X)*ke),Y.push(1),ke}function cn(Y,V,X,oe,f,W){var ke=(W-X)/(f-X);return Y.push(V+(oe-V)*ke),Y.push(W),Y.push(1),ke}function At(Y,V){for(var X=[],oe=0;oe<Y.length;oe++){var f,W=Y[oe],ke=W.type;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")f=Ri(W.geometry,V);else if(ke==="MultiLineString"||ke==="Polygon"){f=[];for(var Ce=0;Ce<W.geometry.length;Ce++)f.push(Ri(W.geometry[Ce],V))}else if(ke==="MultiPolygon")for(f=[],Ce=0;Ce<W.geometry.length;Ce++){for(var be=[],Me=0;Me<W.geometry[Ce].length;Me++)be.push(Ri(W.geometry[Ce][Me],V));f.push(be)}X.push($r(W.id,ke,f,W.tags))}return X}function Ri(Y,V){var X=[];X.size=Y.size,Y.start!==void 0&&(X.start=Y.start,X.end=Y.end);for(var oe=0;oe<Y.length;oe+=3)X.push(Y[oe]+V,Y[oe+1],Y[oe+2]);return X}function qs(Y,V){if(Y.transformed)return Y;var X,oe,f,W=1<<Y.z,ke=Y.x,Ce=Y.y;for(X=0;X<Y.features.length;X++){var be=Y.features[X],Me=be.geometry,Ne=be.type;if(be.geometry=[],Ne===1)for(oe=0;oe<Me.length;oe+=2)be.geometry.push(xi(Me[oe],Me[oe+1],V,W,ke,Ce));else for(oe=0;oe<Me.length;oe++){var it=[];for(f=0;f<Me[oe].length;f+=2)it.push(xi(Me[oe][f],Me[oe][f+1],V,W,ke,Ce));be.geometry.push(it)}}return Y.transformed=!0,Y}function xi(Y,V,X,oe,f,W){return[Math.round(X*(Y*oe-f)),Math.round(X*(V*oe-W))]}function Hi(Y,V,X,oe,f){for(var W=V===f.maxZoom?0:f.tolerance/((1<<V)*f.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:X,y:oe,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ce=0;Ce<Y.length;Ce++){ke.numFeatures++,Nn(ke,Y[Ce],W,f);var be=Y[Ce].minX,Me=Y[Ce].minY,Ne=Y[Ce].maxX,it=Y[Ce].maxY;be<ke.minX&&(ke.minX=be),Me<ke.minY&&(ke.minY=Me),Ne>ke.maxX&&(ke.maxX=Ne),it>ke.maxY&&(ke.maxY=it)}return ke}function Nn(Y,V,X,oe){var f=V.geometry,W=V.type,ke=[];if(W==="Point"||W==="MultiPoint")for(var Ce=0;Ce<f.length;Ce+=3)ke.push(f[Ce]),ke.push(f[Ce+1]),Y.numPoints++,Y.numSimplified++;else if(W==="LineString")Zs(ke,f,Y,X,!1,!1);else if(W==="MultiLineString"||W==="Polygon")for(Ce=0;Ce<f.length;Ce++)Zs(ke,f[Ce],Y,X,W==="Polygon",Ce===0);else if(W==="MultiPolygon")for(var be=0;be<f.length;be++){var Me=f[be];for(Ce=0;Ce<Me.length;Ce++)Zs(ke,Me[Ce],Y,X,!0,Ce===0)}if(ke.length){var Ne=V.tags||null;if(W==="LineString"&&oe.lineMetrics){for(var it in Ne={},V.tags)Ne[it]=V.tags[it];Ne.mapbox_clip_start=f.start/f.size,Ne.mapbox_clip_end=f.end/f.size}var Ue={geometry:ke,type:W==="Polygon"||W==="MultiPolygon"?3:W==="LineString"||W==="MultiLineString"?2:1,tags:Ne};V.id!==null&&(Ue.id=V.id),Y.features.push(Ue)}}function Zs(Y,V,X,oe,f,W){var ke=oe*oe;if(oe>0&&V.size<(f?ke:oe))X.numPoints+=V.length/3;else{for(var Ce=[],be=0;be<V.length;be+=3)(oe===0||V[be+2]>ke)&&(X.numSimplified++,Ce.push(V[be]),Ce.push(V[be+1])),X.numPoints++;f&&function(Me,Ne){for(var it=0,Ue=0,ct=Me.length,It=ct-2;Ue<ct;It=Ue,Ue+=2)it+=(Me[Ue]-Me[It])*(Me[Ue+1]+Me[It+1]);if(it>0===Ne)for(Ue=0,ct=Me.length;Ue<ct/2;Ue+=2){var St=Me[Ue],Zt=Me[Ue+1];Me[Ue]=Me[ct-2-Ue],Me[Ue+1]=Me[ct-1-Ue],Me[ct-2-Ue]=St,Me[ct-1-Ue]=Zt}}(Ce,W),Y.push(Ce)}}function Dr(Y,V){var X=(V=this.options=function(f,W){for(var ke in W)f[ke]=W[ke];return f}(Object.create(this.options),V)).debug;if(X&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");var oe=function(f,W){var ke=[];if(f.type==="FeatureCollection")for(var Ce=0;Ce<f.features.length;Ce++)xt(ke,f.features[Ce],W,Ce);else xt(ke,f.type==="Feature"?f:{geometry:f},W);return ke}(Y,V);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),oe=function(f,W){var ke=W.buffer/W.extent,Ce=f,be=dr(f,1,-1-ke,ke,0,-1,2,W),Me=dr(f,1,1-ke,2+ke,0,-1,2,W);return(be||Me)&&(Ce=dr(f,1,-ke,1+ke,0,-1,2,W)||[],be&&(Ce=At(be,1).concat(Ce)),Me&&(Ce=Ce.concat(At(Me,-1)))),Ce}(oe,V),oe.length&&this.splitTile(oe,0,0,0),X&&(oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Rr(Y,V,X){return 32*((1<<Y)*X+V)+Y}function qr(Y,V){const X=Y.tileID.canonical;if(!this._geoJSONIndex)return V(null,null);const oe=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!oe)return V(null,null);const f=new De(oe.features);let W=$e.exports(f);W.byteOffset===0&&W.byteLength===W.buffer.byteLength||(W=new Uint8Array(W)),V(null,{vectorTile:f,rawData:W.buffer})}Dr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Dr.prototype.splitTile=function(Y,V,X,oe,f,W,ke){for(var Ce=[Y,V,X,oe],be=this.options,Me=be.debug;Ce.length;){oe=Ce.pop(),X=Ce.pop(),V=Ce.pop(),Y=Ce.pop();var Ne=1<<V,it=Rr(V,X,oe),Ue=this.tiles[it];if(!Ue&&(Me>1&&console.time("creation"),Ue=this.tiles[it]=Hi(Y,V,X,oe,be),this.tileCoords.push({z:V,x:X,y:oe}),Me)){Me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,X,oe,Ue.numFeatures,Ue.numPoints,Ue.numSimplified),console.timeEnd("creation"));var ct="z"+V;this.stats[ct]=(this.stats[ct]||0)+1,this.total++}if(Ue.source=Y,f){if(V===be.maxZoom||V===f)continue;var It=1<<f-V;if(X!==Math.floor(W/It)||oe!==Math.floor(ke/It))continue}else if(V===be.indexMaxZoom||Ue.numPoints<=be.indexMaxPoints)continue;if(Ue.source=null,Y.length!==0){Me>1&&console.time("clipping");var St,Zt,Vt,sn,Wt,Xt,yn=.5*be.buffer/be.extent,Mn=.5-yn,Un=.5+yn,Ut=1+yn;St=Zt=Vt=sn=null,Wt=dr(Y,Ne,X-yn,X+Un,0,Ue.minX,Ue.maxX,be),Xt=dr(Y,Ne,X+Mn,X+Ut,0,Ue.minX,Ue.maxX,be),Y=null,Wt&&(St=dr(Wt,Ne,oe-yn,oe+Un,1,Ue.minY,Ue.maxY,be),Zt=dr(Wt,Ne,oe+Mn,oe+Ut,1,Ue.minY,Ue.maxY,be),Wt=null),Xt&&(Vt=dr(Xt,Ne,oe-yn,oe+Un,1,Ue.minY,Ue.maxY,be),sn=dr(Xt,Ne,oe+Mn,oe+Ut,1,Ue.minY,Ue.maxY,be),Xt=null),Me>1&&console.timeEnd("clipping"),Ce.push(St||[],V+1,2*X,2*oe),Ce.push(Zt||[],V+1,2*X,2*oe+1),Ce.push(Vt||[],V+1,2*X+1,2*oe),Ce.push(sn||[],V+1,2*X+1,2*oe+1)}}},Dr.prototype.getTile=function(Y,V,X){var oe=this.options,f=oe.extent,W=oe.debug;if(Y<0||Y>24)return null;var ke=1<<Y,Ce=Rr(Y,V=(V%ke+ke)%ke,X);if(this.tiles[Ce])return qs(this.tiles[Ce],f);W>1&&console.log("drilling down to z%d-%d-%d",Y,V,X);for(var be,Me=Y,Ne=V,it=X;!be&&Me>0;)Me--,Ne=Math.floor(Ne/2),it=Math.floor(it/2),be=this.tiles[Rr(Me,Ne,it)];return be&&be.source?(W>1&&console.log("found parent tile z%d-%d-%d",Me,Ne,it),W>1&&console.time("drilling down"),this.splitTile(be.source,Me,Ne,it,Y,V,X),W>1&&console.timeEnd("drilling down"),this.tiles[Ce]?qs(this.tiles[Ce],f):null):null};class Is extends te{constructor(V,X,oe,f){super(V,X,oe,qr),f&&(this.loadGeoJSON=f)}loadData(V,X){var oe;(oe=this._pendingRequest)===null||oe===void 0||oe.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const f=!!(V&&V.request&&V.request.collectResourceTiming)&&new a.RequestPerformance(V.request);this._pendingCallback=X,this._pendingRequest=this.loadGeoJSON(V,(W,ke)=>{if(delete this._pendingCallback,delete this._pendingRequest,W||!ke)return X(W);if(typeof ke!="object")return X(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));{ne(ke,!0);try{if(V.filter){const be=a.createExpression(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(be.result==="error")throw new Error(be.value.map(Ne=>`${Ne.key}: ${Ne.message}`).join(", "));ke={type:"FeatureCollection",features:ke.features.filter(Ne=>be.value.evaluate({zoom:0},Ne))}}this._geoJSONIndex=V.cluster?new Rn(function({superclusterOptions:be,clusterProperties:Me}){if(!Me||!be)return be;const Ne={},it={},Ue={accumulated:null,zoom:0},ct={properties:null},It=Object.keys(Me);for(const St of It){const[Zt,Vt]=Me[St],sn=a.createExpression(Vt),Wt=a.createExpression(typeof Zt=="string"?[Zt,["accumulated"],["get",St]]:Zt);Ne[St]=sn.value,it[St]=Wt.value}return be.map=St=>{ct.properties=St;const Zt={};for(const Vt of It)Zt[Vt]=Ne[Vt].evaluate(Ue,ct);return Zt},be.reduce=(St,Zt)=>{ct.properties=Zt;for(const Vt of It)Ue.accumulated=St[Vt],St[Vt]=it[Vt].evaluate(Ue,ct)},be}(V)).load(ke.features):function(be,Me){return new Dr(be,Me)}(ke,V.geojsonVtOptions)}catch(be){return X(be)}this.loaded={};const Ce={};if(f){const be=f.finish();be&&(Ce.resourceTiming={},Ce.resourceTiming[V.source]=JSON.parse(JSON.stringify(be)))}X(null,Ce)}})}reloadTile(V,X){const oe=this.loaded;return oe&&oe[V.uid]?super.reloadTile(V,X):this.loadTile(V,X)}loadGeoJSON(V,X){if(V.request)return a.getJSON(V.request,X);if(typeof V.data=="string")try{X(null,JSON.parse(V.data))}catch{X(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`))}else X(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(V,X){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),X()}getClusterExpansionZoom(V,X){try{X(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(oe){X(oe)}}getClusterChildren(V,X){try{X(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(oe){X(oe)}}getClusterLeaves(V,X){try{X(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(oe){X(oe)}}}class or{constructor(V){this.self=V,this.actor=new a.Actor(V,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:te,geojson:Is},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(X,oe)=>{if(this.workerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.workerSourceTypes[X]=oe},this.self.registerRTLTextPlugin=X=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=X.applyArabicShaping,a.plugin.processBidirectionalText=X.processBidirectionalText,a.plugin.processStyledBidirectionalText=X.processStyledBidirectionalText}}setReferrer(V,X){this.referrer=X}setImages(V,X,oe){this.availableImages[V]=X;for(const f in this.workerSources[V]){const W=this.workerSources[V][f];for(const ke in W)W[ke].availableImages=X}oe()}setLayers(V,X,oe){this.getLayerIndex(V).replace(X),oe()}updateLayers(V,X,oe){this.getLayerIndex(V).update(X.layers,X.removedIds),oe()}loadTile(V,X,oe){this.getWorkerSource(V,X.type,X.source).loadTile(X,oe)}loadDEMTile(V,X,oe){this.getDEMWorkerSource(V,X.source).loadTile(X,oe)}reloadTile(V,X,oe){this.getWorkerSource(V,X.type,X.source).reloadTile(X,oe)}abortTile(V,X,oe){this.getWorkerSource(V,X.type,X.source).abortTile(X,oe)}removeTile(V,X,oe){this.getWorkerSource(V,X.type,X.source).removeTile(X,oe)}removeDEMTile(V,X){this.getDEMWorkerSource(V,X.source).removeTile(X)}removeSource(V,X,oe){if(!this.workerSources[V]||!this.workerSources[V][X.type]||!this.workerSources[V][X.type][X.source])return;const f=this.workerSources[V][X.type][X.source];delete this.workerSources[V][X.type][X.source],f.removeSource!==void 0?f.removeSource(X,oe):oe()}loadWorkerSource(V,X,oe){try{this.self.importScripts(X.url),oe()}catch(f){oe(f.toString())}}syncRTLPluginState(V,X,oe){try{a.plugin.setState(X);const f=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&f!=null){this.self.importScripts(f);const W=a.plugin.isParsed();oe(W?void 0:new Error(`RTL Text Plugin failed to import scripts from ${f}`),W)}}catch(f){oe(f.toString())}}getAvailableImages(V){let X=this.availableImages[V];return X||(X=[]),X}getLayerIndex(V){let X=this.layerIndexes[V];return X||(X=this.layerIndexes[V]=new M),X}getWorkerSource(V,X,oe){if(this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][X]||(this.workerSources[V][X]={}),!this.workerSources[V][X][oe]){const f={send:(W,ke,Ce)=>{this.actor.send(W,ke,Ce,V)}};this.workerSources[V][X][oe]=new this.workerSourceTypes[X](f,this.getLayerIndex(V),this.getAvailableImages(V))}return this.workerSources[V][X][oe]}getDEMWorkerSource(V,X){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][X]||(this.demWorkerSources[V][X]=new pe),this.demWorkerSources[V][X]}enforceCacheSizeLimit(V,X){a.enforceCacheSizeLimit(X)}}return a.isWorker()&&(self.worker=new or(self)),or}),s(["./shared"],function(a){var y=w;function w(b){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,E,P=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(P);try{E=new Worker(z),v=!0}catch{v=!1}return E&&E.terminate(),URL.revokeObjectURL(z),v}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var v=document.createElement("canvas");v.width=v.height=1;var E=v.getContext("2d");if(!E)return!1;var P=E.getImageData(0,0,1,1);return P&&P.width===v.width}()?(M[p=l&&l.failIfMajorPerformanceCaveat]===void 0&&(M[p]=function(v){var E,P=function(z){var N=document.createElement("canvas"),G=Object.create(w.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=z,N.getContext("webgl",G)||N.getContext("experimental-webgl",G)}(v);if(!P)return!1;try{E=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!E||P.isContextLost())&&(P.shaderSource(E,"void main() {}"),P.compileShader(E),P.getShaderParameter(E,P.COMPILE_STATUS)===!0)}(p)),M[p]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var p}(b)}var M={};function R(b,l){if(Array.isArray(b)){if(!Array.isArray(l)||b.length!==l.length)return!1;for(let p=0;p<b.length;p++)if(!R(b[p],l[p]))return!1;return!0}if(typeof b=="object"&&b!==null&&l!==null){if(typeof l!="object"||Object.keys(b).length!==Object.keys(l).length)return!1;for(const p in b)if(!R(b[p],l[p]))return!1;return!0}return b===l}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class L{static testProp(l){if(!L.docStyle)return l[0];for(let p=0;p<l.length;p++)if(l[p]in L.docStyle)return l[p];return l[0]}static create(l,p,v){const E=window.document.createElement(l);return p!==void 0&&(E.className=p),v&&v.appendChild(E),E}static createNS(l,p){return window.document.createElementNS(l,p)}static disableDrag(){L.docStyle&&L.selectProp&&(L.userSelect=L.docStyle[L.selectProp],L.docStyle[L.selectProp]="none")}static enableDrag(){L.docStyle&&L.selectProp&&(L.docStyle[L.selectProp]=L.userSelect)}static setTransform(l,p){l.style[L.transformProp]=p}static addEventListener(l,p,v,E={}){l.addEventListener(p,v,"passive"in E?E:E.capture)}static removeEventListener(l,p,v,E={}){l.removeEventListener(p,v,"passive"in E?E:E.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",L.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",L.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",L.suppressClickInternal,!0)},0)}static mousePos(l,p){const v=l.getBoundingClientRect();return new a.pointGeometry(p.clientX-v.left-l.clientLeft,p.clientY-v.top-l.clientTop)}static touchPos(l,p){const v=l.getBoundingClientRect(),E=[];for(let P=0;P<p.length;P++)E.push(new a.pointGeometry(p[P].clientX-v.left-l.clientLeft,p[P].clientY-v.top-l.clientTop));return E}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}L.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,L.selectProp=L.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),L.transformProp=L.testProp(["transform","WebkitTransform"]);class U{constructor(l){this._transformRequestFn=l}transformRequest(l,p){return this._transformRequestFn&&this._transformRequestFn(l,p)||{url:l}}normalizeSpriteURL(l,p,v){const E=function(P){const z=P.match(q);if(!z)throw new Error(`Unable to parse URL "${P}"`);return{protocol:z[1],authority:z[2],path:z[3]||"/",params:z[4]?z[4].split("&"):[]}}(l);return E.path+=`${p}${v}`,function(P){const z=P.params.length?`?${P.params.join("&")}`:"";return`${P.protocol}://${P.authority}${P.path}${z}`}(E)}setTransformRequest(l){this._transformRequestFn=l}}const q=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class te{constructor(l,p,v,E){this.context=l,this.format=v,this.texture=l.gl.createTexture(),this.update(p,E)}update(l,p,v){const{width:E,height:P}=l,z=!(this.size&&this.size[0]===E&&this.size[1]===P||v),{context:N}=this,{gl:G}=N;if(this.useMipmap=!!(p&&p.useMipmap),G.bindTexture(G.TEXTURE_2D,this.texture),N.pixelStoreUnpackFlipY.set(!1),N.pixelStoreUnpack.set(1),N.pixelStoreUnpackPremultiplyAlpha.set(this.format===G.RGBA&&(!p||p.premultiply!==!1)),z)this.size=[E,P],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||a.isImageBitmap(l)?G.texImage2D(G.TEXTURE_2D,0,this.format,this.format,G.UNSIGNED_BYTE,l):G.texImage2D(G.TEXTURE_2D,0,this.format,E,P,0,this.format,G.UNSIGNED_BYTE,l.data);else{const{x:$,y:K}=v||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||a.isImageBitmap(l)?G.texSubImage2D(G.TEXTURE_2D,0,$,K,G.RGBA,G.UNSIGNED_BYTE,l):G.texSubImage2D(G.TEXTURE_2D,0,$,K,E,P,G.RGBA,G.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&G.generateMipmap(G.TEXTURE_2D)}bind(l,p,v){const{context:E}=this,{gl:P}=E;P.bindTexture(P.TEXTURE_2D,this.texture),v!==P.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=P.LINEAR),l!==this.filter&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,l),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,v||l),this.filter=l),p!==this.wrap&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,p),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,p),this.wrap=p)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function pe(b){const{userImage:l}=b;return!!(l&&l.render&&l.render())&&(b.data.replace(new Uint8Array(l.data.buffer)),!0)}class ne extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:p,callback:v}of this.requestors)this._notify(p,v);this.requestors=[]}}getImage(l){return this.images[l]}addImage(l,p){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,p)&&(this.images[l]=p)}_validate(l,p){let v=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),v=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),v=!1),this._validateContent(p.content,p)||(this.fire(new a.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),v=!1),v}_validateStretch(l,p){if(!l)return!0;let v=0;for(const E of l){if(E[0]<v||E[1]<E[0]||p<E[1])return!1;v=E[1]}return!0}_validateContent(l,p){return!(l&&(l.length!==4||l[0]<0||p.data.width<l[0]||l[1]<0||p.data.height<l[1]||l[2]<0||p.data.width<l[2]||l[3]<0||p.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,p){const v=this.images[l];if(v.data.width!==p.data.width||v.data.height!==p.data.height)throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${p.data.width}x${p.data.height}).`);p.version=v.version+1,this.images[l]=p,this.updatedImages[l]=!0}removeImage(l){const p=this.images[l];delete this.images[l],delete this.patterns[l],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,p){let v=!0;if(!this.isLoaded())for(const E of l)this.images[E]||(v=!1);this.isLoaded()||v?this._notify(l,p):this.requestors.push({ids:l,callback:p})}_notify(l,p){const v={};for(const E of l){this.images[E]||this.fire(new a.Event("styleimagemissing",{id:E}));const P=this.images[E];P?v[E]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:a.warnOnce(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,v)}getPixelSize(){const{width:l,height:p}=this.atlasImage;return{width:l,height:p}}getPattern(l){const p=this.patterns[l],v=this.getImage(l);if(!v)return null;if(p&&p.position.version===v.version)return p.position;if(p)p.position.version=v.version;else{const E={w:v.data.width+2,h:v.data.height+2,x:0,y:0},P=new a.ImagePosition(E,v);this.patterns[l]={bin:E,position:P}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const p=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new te(l,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const P in this.patterns)l.push(this.patterns[P].bin);const{w:p,h:v}=a.potpack(l),E=this.atlasImage;E.resize({width:p||1,height:v||1});for(const P in this.patterns){const{bin:z}=this.patterns[P],N=z.x+1,G=z.y+1,$=this.images[P].data,K=$.width,se=$.height;a.RGBAImage.copy($,E,{x:0,y:0},{x:N,y:G},{width:K,height:se}),a.RGBAImage.copy($,E,{x:0,y:se-1},{x:N,y:G-1},{width:K,height:1}),a.RGBAImage.copy($,E,{x:0,y:0},{x:N,y:G+se},{width:K,height:1}),a.RGBAImage.copy($,E,{x:K-1,y:0},{x:N-1,y:G},{width:1,height:se}),a.RGBAImage.copy($,E,{x:0,y:0},{x:N+K,y:G},{width:1,height:se})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const p of l){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const v=this.images[p];v||a.warnOnce(`Image with ID: "${p}" was not found`),pe(v)&&this.updateImage(p,v)}}}const ie=1e20;function re(b,l,p,v,E,P,z,N,G){for(let $=l;$<l+v;$++)_e(b,p*P+$,P,E,z,N,G);for(let $=p;$<p+E;$++)_e(b,$*P+l,1,v,z,N,G)}function _e(b,l,p,v,E,P,z){P[0]=0,z[0]=-ie,z[1]=ie,E[0]=b[l];for(let N=1,G=0,$=0;N<v;N++){E[N]=b[l+N*p];const K=N*N;do{const se=P[G];$=(E[N]-E[se]+K-se*se)/(N-se)/2}while($<=z[G]&&--G>-1);G++,P[G]=N,z[G]=$,z[G+1]=ie}for(let N=0,G=0;N<v;N++){for(;z[G+1]<N;)G++;const $=P[G],K=N-$;b[l+N*p]=E[$]+K*K}}class Te{constructor(l,p){this.requestManager=l,this.localIdeographFontFamily=p,this.entries={}}setURL(l){this.url=l}getGlyphs(l,p){const v=[];for(const E in l)for(const P of l[E])v.push({stack:E,id:P});a.asyncAll(v,({stack:E,id:P},z)=>{let N=this.entries[E];N||(N=this.entries[E]={glyphs:{},requests:{},ranges:{}});let G=N.glyphs[P];if(G!==void 0)return void z(null,{stack:E,id:P,glyph:G});if(G=this._tinySDF(N,E,P),G)return N.glyphs[P]=G,void z(null,{stack:E,id:P,glyph:G});const $=Math.floor(P/256);if(256*$>65535)return void z(new Error("glyphs > 65535 not supported"));if(N.ranges[$])return void z(null,{stack:E,id:P,glyph:G});let K=N.requests[$];K||(K=N.requests[$]=[],Te.loadGlyphRange(E,$,this.url,this.requestManager,(se,ce)=>{if(ce){for(const xe in ce)this._doesCharSupportLocalGlyph(+xe)||(N.glyphs[+xe]=ce[+xe]);N.ranges[$]=!0}for(const xe of K)xe(se,ce);delete N.requests[$]})),K.push((se,ce)=>{se?z(se):ce&&z(null,{stack:E,id:P,glyph:ce[P]||null})})},(E,P)=>{if(E)p(E);else if(P){const z={};for(const{stack:N,id:G,glyph:$}of P)(z[N]||(z[N]={}))[G]=$&&{id:$.id,bitmap:$.bitmap.clone(),metrics:$.metrics};p(null,z)}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(a.unicodeBlockLookup["CJK Unified Ideographs"](l)||a.unicodeBlockLookup["Hangul Syllables"](l)||a.unicodeBlockLookup.Hiragana(l)||a.unicodeBlockLookup.Katakana(l))}_tinySDF(l,p,v){const E=this.localIdeographFontFamily;if(!E||!this._doesCharSupportLocalGlyph(v))return;let P=l.tinySDF;if(!P){let N="400";/bold/i.test(p)?N="900":/medium/i.test(p)?N="500":/light/i.test(p)&&(N="200"),P=l.tinySDF=new Te.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:E,fontWeight:N})}const z=P.draw(String.fromCharCode(v));return{id:v,bitmap:new a.AlphaImage({width:z.width||30,height:z.height||30},z.data),metrics:{width:z.glyphWidth||24,height:z.glyphHeight||24,left:z.glyphLeft||0,top:z.glyphTop-27||-8,advance:z.glyphAdvance||24}}}}Te.loadGlyphRange=function(b,l,p,v,E){const P=256*l,z=P+255,N=v.transformRequest(p.replace("{fontstack}",b).replace("{range}",`${P}-${z}`),a.ResourceType.Glyphs);a.getArrayBuffer(N,(G,$)=>{if(G)E(G);else if($){const K={};for(const se of a.parseGlyphPbf($))K[se.id]=se;E(null,K)}})},Te.TinySDF=class{constructor({fontSize:b=24,buffer:l=3,radius:p=8,cutoff:v=.25,fontFamily:E="sans-serif",fontWeight:P="normal",fontStyle:z="normal"}={}){this.buffer=l,this.cutoff=v,this.radius=p;const N=this.size=b+4*l,G=this._createCanvas(N),$=this.ctx=G.getContext("2d",{willReadFrequently:!0});$.font=`${z} ${P} ${b}px ${E}`,$.textBaseline="alphabetic",$.textAlign="left",$.fillStyle="black",this.gridOuter=new Float64Array(N*N),this.gridInner=new Float64Array(N*N),this.f=new Float64Array(N),this.z=new Float64Array(N+1),this.v=new Uint16Array(N)}_createCanvas(b){const l=document.createElement("canvas");return l.width=l.height=b,l}draw(b){const{width:l,actualBoundingBoxAscent:p,actualBoundingBoxDescent:v,actualBoundingBoxLeft:E,actualBoundingBoxRight:P}=this.ctx.measureText(b),z=Math.ceil(p),N=Math.min(this.size-this.buffer,Math.ceil(P-E)),G=Math.min(this.size-this.buffer,z+Math.ceil(v)),$=N+2*this.buffer,K=G+2*this.buffer,se=Math.max($*K,0),ce=new Uint8ClampedArray(se),xe={data:ce,width:$,height:K,glyphWidth:N,glyphHeight:G,glyphTop:z,glyphLeft:0,glyphAdvance:l};if(N===0||G===0)return xe;const{ctx:ve,buffer:le,gridInner:ye,gridOuter:ze}=this;ve.clearRect(le,le,N,G),ve.fillText(b,le,le+z);const Ge=ve.getImageData(le,le,N,G);ze.fill(ie,0,se),ye.fill(0,0,se);for(let Se=0;Se<G;Se++)for(let Ze=0;Ze<N;Ze++){const je=Ge.data[4*(Se*N+Ze)+3]/255;if(je===0)continue;const tt=(Se+le)*$+Ze+le;if(je===1)ze[tt]=0,ye[tt]=ie;else{const Ke=.5-je;ze[tt]=Ke>0?Ke*Ke:0,ye[tt]=Ke<0?Ke*Ke:0}}re(ze,0,0,$,K,$,this.f,this.v,this.z),re(ye,le,le,N,G,$,this.f,this.v,this.z);for(let Se=0;Se<se;Se++){const Ze=Math.sqrt(ze[Se])-Math.sqrt(ye[Se]);ce[Se]=Math.round(255-255*(Ze/this.radius+this.cutoff))}return xe}};const De=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(b,l){return a.sphericalToCartesian(b.expression.evaluate(l))}interpolate(b,l,p){return{x:a.number(b.x,l.x,p),y:a.number(b.y,l.y,p),z:a.number(b.z,l.z,p)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),$e="-transition";class nt extends a.Evented{constructor(l){super(),this._transitionable=new a.Transitionable(De),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,p={}){if(!this._validate(a.validateLight,l,p))for(const v in l){const E=l[v];v.endsWith($e)?this._transitionable.setTransition(v.slice(0,-$e.length),E):this._transitionable.setValue(v,E)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,v){return(!v||v.validate!==!1)&&a.emitValidationErrors(this,l.call(a.validateStyle,a.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class ut{constructor(l,p){this.width=l,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,p){const v=l.join(",")+String(p);return this.dashEntry[v]||(this.dashEntry[v]=this.addDash(l,p)),this.dashEntry[v]}getDashRanges(l,p,v){const E=[];let P=l.length%2==1?-l[l.length-1]*v:0,z=l[0]*v,N=!0;E.push({left:P,right:z,isDash:N,zeroLength:l[0]===0});let G=l[0];for(let $=1;$<l.length;$++){N=!N;const K=l[$];P=G*v,G+=K,z=G*v,E.push({left:P,right:z,isDash:N,zeroLength:K===0})}return E}addRoundDash(l,p,v){const E=p/2;for(let P=-v;P<=v;P++){const z=this.width*(this.nextRow+v+P);let N=0,G=l[N];for(let $=0;$<this.width;$++){$/G.right>1&&(G=l[++N]);const K=Math.abs($-G.left),se=Math.abs($-G.right),ce=Math.min(K,se);let xe;const ve=P/v*(E+1);if(G.isDash){const le=E-Math.abs(ve);xe=Math.sqrt(ce*ce+le*le)}else xe=E-Math.sqrt(ce*ce+ve*ve);this.data[z+$]=Math.max(0,Math.min(255,xe+128))}}}addRegularDash(l){for(let N=l.length-1;N>=0;--N){const G=l[N],$=l[N+1];G.zeroLength?l.splice(N,1):$&&$.isDash===G.isDash&&($.left=G.left,l.splice(N,1))}const p=l[0],v=l[l.length-1];p.isDash===v.isDash&&(p.left=v.left-this.width,v.right=p.right+this.width);const E=this.width*this.nextRow;let P=0,z=l[P];for(let N=0;N<this.width;N++){N/z.right>1&&(z=l[++P]);const G=Math.abs(N-z.left),$=Math.abs(N-z.right),K=Math.min(G,$);this.data[E+N]=Math.max(0,Math.min(255,(z.isDash?K:-K)+128))}}addDash(l,p){const v=p?7:0,E=2*v+1;if(this.nextRow+E>this.height)return a.warnOnce("LineAtlas out of space"),null;let P=0;for(let N=0;N<l.length;N++)P+=l[N];if(P!==0){const N=this.width/P,G=this.getDashRanges(l,this.width,N);p?this.addRoundDash(G,N,v):this.addRegularDash(G)}const z={y:(this.nextRow+v+.5)/this.height,height:2*v/this.height,width:P};return this.nextRow+=E,this.dirty=!0,z}bind(l){const p=l.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))}}class st{constructor(l,p){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const v=this.workerPool.acquire(this.id);for(let E=0;E<v.length;E++){const P=new st.Actor(v[E],p,this.id);P.name=`Worker ${E}`,this.actors.push(P)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,p,v){a.asyncAll(this.actors,(E,P)=>{E.send(l,p,P)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function lt(b,l,p){const v=function(E,P){if(E)return p(E);if(P){const z=a.pick(a.extend(P,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(z.vectorLayers=P.vector_layers,z.vectorLayerIds=z.vectorLayers.map(N=>N.id)),p(null,z)}};return b.url?a.getJSON(l.transformRequest(b.url,a.ResourceType.Source),v):a.exported.frame(()=>v(null,b))}st.Actor=a.Actor;class Lt{constructor(l,p,v){this.bounds=a.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=p||0,this.maxzoom=v||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const p=Math.pow(2,l.z),v=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*p),E=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*p),P=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*p),z=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*p);return l.x>=v&&l.x<P&&l.y>=E&&l.y<z}}class ht extends a.Evented{constructor(l,p,v,E){if(super(),this.id=l,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(p,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(E)}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=lt(this._options,this.map._requestManager,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l?this.fire(new a.ErrorEvent(l)):p&&(a.extend(this,p),p.bounds&&(this.tileBounds=new Lt(p.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(l,p){const v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),E={request:this.map._requestManager.transformRequest(v,a.ResourceType.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function P(z,N){return delete l.request,l.aborted?p(null):z&&z.status!==404?p(z):(N&&N.resourceTiming&&(l.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&l.setExpiryData(N),l.loadVectorData(N,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}E.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired"?l.state==="loading"?l.reloadCallback=p:l.request=l.actor.send("reloadTile",E,P.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",E,P.bind(this)))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Tt extends a.Evented{constructor(l,p,v,E){super(),this.id=l,this.dispatcher=v,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},p),a.extend(this,a.pick(p,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=lt(this._options,this.map._requestManager,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new a.ErrorEvent(l)):p&&(a.extend(this,p),p.bounds&&(this.tileBounds=new Lt(p.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,p){const v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.request=a.getImage(this.map._requestManager.transformRequest(v,a.ResourceType.Tile),(E,P,z)=>{if(delete l.request,l.aborted)l.state="unloaded",p(null);else if(E)l.state="errored",p(E);else if(P){this.map._refreshExpiredTiles&&l.setExpiryData(z);const N=this.map.painter.context,G=N.gl;l.texture=this.map.painter.getTileTexture(P.width),l.texture?l.texture.update(P,{useMipmap:!0}):(l.texture=new te(N,P,G.RGBA,{useMipmap:!0}),l.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),N.extTextureFilterAnisotropic&&G.texParameterf(G.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax)),l.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),p(null)}})}abortTile(l,p){l.request&&(l.request.cancel(),delete l.request),p()}unloadTile(l,p){l.texture&&this.map.painter.saveTileTexture(l.texture),p()}hasTransition(){return!1}}let Pn;class Ft extends Tt{constructor(l,p,v,E){super(l,p,v,E),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(l,p){const v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function E(P,z){P&&(l.state="errored",p(P)),z&&(l.dem=z,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded",p(null))}l.request=a.getImage(this.map._requestManager.transformRequest(v,a.ResourceType.Tile),function(P,z){if(delete l.request,l.aborted)l.state="unloaded",p(null);else if(P)l.state="errored",p(P);else if(z){this.map._refreshExpiredTiles&&l.setExpiryData(z),delete z.cacheControl,delete z.expires;const N=a.isImageBitmap(z)&&(Pn==null&&(Pn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Pn)?z:a.exported.getImageData(z,1),G={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:N,encoding:this.encoding};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",G,E.bind(this)))}}.bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)}_getNeighboringTiles(l){const p=l.canonical,v=Math.pow(2,p.z),E=(p.x-1+v)%v,P=p.x===0?l.wrap-1:l.wrap,z=(p.x+1+v)%v,N=p.x+1===v?l.wrap+1:l.wrap,G={};return G[new a.OverscaledTileID(l.overscaledZ,P,p.z,E,p.y).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,N,p.z,z,p.y).key]={backfilled:!1},p.y>0&&(G[new a.OverscaledTileID(l.overscaledZ,P,p.z,E,p.y-1).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,l.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,N,p.z,z,p.y-1).key]={backfilled:!1}),p.y+1<v&&(G[new a.OverscaledTileID(l.overscaledZ,P,p.z,E,p.y+1).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,l.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,N,p.z,z,p.y+1).key]={backfilled:!1}),G}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})}}class Zn extends a.Evented{constructor(l,p,v,E){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=v.getActor(),this.setEventedParent(E),this._data=p.data,this._options=a.extend({},p),this._collectResourceTiming=p.collectResourceTiming,p.maxzoom!==void 0&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId;const P=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:(p.buffer!==void 0?p.buffer:128)*P,tolerance:(p.tolerance!==void 0?p.tolerance:.375)*P,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:p.clusterMaxZoom!==void 0?p.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,p.clusterMinPoints||2),extent:a.EXTENT,radius:(p.clusterRadius||50)*P,log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData("content"),this}getClusterExpansionZoom(l,p){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},p),this}getClusterChildren(l,p){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},p),this}getClusterLeaves(l,p,v,E){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:p,offset:v},E),this}_updateWorkerData(l){const p=a.extend({},this.workerOptions),v=this._data;typeof v=="string"?(p.request=this.map._requestManager.transformRequest(a.exported.resolveURL(v),a.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(v),this._pendingLoads++,this.fire(new a.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,p,(E,P)=>{if(this._pendingLoads--,this._removed||P&&P.abandoned)return void this.fire(new a.Event("dataabort",{dataType:"source",sourceDataType:l}));let z=null;if(P&&P.resourceTiming&&P.resourceTiming[this.id]&&(z=P.resourceTiming[this.id].slice(0)),E)return void this.fire(new a.ErrorEvent(E));const N={dataType:"source",sourceDataType:l};this._collectResourceTiming&&z&&z.length>0&&a.extend(N,{resourceTiming:z}),this.fire(new a.Event("data",N))})}loaded(){return this._pendingLoads===0}loadTile(l,p){const v=l.actor?"reloadTile":"loadTile";l.actor=this.actor;const E={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.request=this.actor.send(v,E,(P,z)=>(delete l.request,l.unloadVectorData(),l.aborted?p(null):P?p(P):(l.loadVectorData(z,this.map.painter,v==="reloadTile"),p(null))))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var yt=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ot extends a.Evented{constructor(l,p,v,E){super(),this.id=l,this.dispatcher=v,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=p}load(l,p){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(v,E)=>{this._loaded=!0,v?this.fire(new a.ErrorEvent(v)):E&&(this.image=E,l&&(this.coordinates=l),p&&p(),this._finishLoading())})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}setCoordinates(l){this.coordinates=l;const p=l.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(E){let P=1/0,z=1/0,N=-1/0,G=-1/0;for(const ce of E)P=Math.min(P,ce.x),z=Math.min(z,ce.y),N=Math.max(N,ce.x),G=Math.max(G,ce.y);const $=Math.max(N-P,G-z),K=Math.max(0,Math.floor(-Math.log($)/Math.LN2)),se=Math.pow(2,K);return new a.CanonicalTileID(K,Math.floor((P+N)/2*se),Math.floor((z+G)/2*se))}(p),this.minzoom=this.maxzoom=this.tileID.z;const v=p.map(E=>this.tileID.getTilePoint(E)._round());return this._boundsArray=new a.RasterBoundsArray,this._boundsArray.emplaceBack(v[0].x,v[0].y,0,0),this._boundsArray.emplaceBack(v[1].x,v[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(v[3].x,v[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(v[2].x,v[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,p=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new te(l,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));for(const v in this.tiles){const E=this.tiles[v];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}loadTile(l,p){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},p(null)):(l.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Jt extends Ot{constructor(l,p,v,E){super(l,p,v,E),this.roundZoom=!0,this.type="video",this.options=p}load(){this._loaded=!1;const l=this.options;this.urls=[];for(const p of l.urls)this.urls.push(this.map._requestManager.transformRequest(p,a.ResourceType.Source).url);a.getVideo(this.urls,(p,v)=>{this._loaded=!0,p?this.fire(new a.ErrorEvent(p)):v&&(this.video=v,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const p=this.video.seekable;l<p.start(0)||l>p.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${p.start(0)} and ${p.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,p=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new te(l,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));for(const v in this.tiles){const E=this.tiles[v];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class In extends Ot{constructor(l,p,v,E){super(l,p,v,E),p.coordinates?Array.isArray(p.coordinates)&&p.coordinates.length===4&&!p.coordinates.some(P=>!Array.isArray(P)||P.length!==2||P.some(z=>typeof z!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'missing required property "coordinates"'))),p.animate&&typeof p.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),p.canvas?typeof p.canvas=="string"||p.canvas instanceof HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'missing required property "canvas"'))),this.options=p,this.animate=p.animate===void 0||p.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const p=this.map.painter.context,v=p.gl;this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new te(p,this.canvas,v.RGBA,{premultiply:!0});for(const E in this.tiles){const P=this.tiles[E];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const Tn={vector:ht,raster:Tt,"raster-dem":Ft,geojson:Zn,video:Jt,image:Ot,canvas:In};function Di(b,l){const p=a.create();return a.translate(p,p,[1,1,0]),a.scale(p,p,[.5*b.width,.5*b.height,1]),a.multiply(p,p,b.calculatePosMatrix(l.toUnwrapped()))}function di(b,l,p,v,E,P){const z=function(se,ce,xe){if(se)for(const ve of se){const le=ce[ve];if(le&&le.source===xe&&le.type==="fill-extrusion")return!0}else for(const ve in ce){const le=ce[ve];if(le.source===xe&&le.type==="fill-extrusion")return!0}return!1}(E&&E.layers,l,b.id),N=P.maxPitchScaleFactor(),G=b.tilesIn(v,N,z);G.sort(ii);const $=[];for(const se of G)$.push({wrappedTileID:se.tileID.wrapped().key,queryResults:se.tile.queryRenderedFeatures(l,p,b._state,se.queryGeometry,se.cameraQueryGeometry,se.scale,E,P,N,Di(b.transform,se.tileID))});const K=function(se){const ce={},xe={};for(const ve of se){const le=ve.queryResults,ye=ve.wrappedTileID,ze=xe[ye]=xe[ye]||{};for(const Ge in le){const Se=le[Ge],Ze=ze[Ge]=ze[Ge]||{},je=ce[Ge]=ce[Ge]||[];for(const tt of Se)Ze[tt.featureIndex]||(Ze[tt.featureIndex]=!0,je.push(tt))}}return ce}($);for(const se in K)K[se].forEach(ce=>{const xe=ce.feature,ve=b.getFeatureState(xe.layer["source-layer"],xe.id);xe.source=xe.layer.source,xe.layer["source-layer"]&&(xe.sourceLayer=xe.layer["source-layer"]),xe.state=ve});return K}function ii(b,l){const p=b.tileID,v=l.tileID;return p.overscaledZ-v.overscaledZ||p.canonical.y-v.canonical.y||p.wrap-v.wrap||p.canonical.x-v.canonical.x}class hi{constructor(l,p){this.tileID=l,this.uid=a.uniqueId(),this.uses=0,this.tileSize=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const p=l+this.timeAdded;p<a.exported.now()||this.fadeEndTime&&p<this.fadeEndTime||(this.fadeEndTime=p)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.textures.forEach(p=>l.saveTileTexture(p)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(l,p,v){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(E,P){const z={};if(!P)return z;for(const N of E){const G=N.layerIds.map($=>P.getLayer($)).filter(Boolean);if(G.length!==0){N.layers=G,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map($=>G.filter(K=>K.id===$)[0]));for(const $ of G)z[$.id]=N}}return z}(l.buckets,p.style),this.hasSymbolBuckets=!1;for(const E in this.buckets){const P=this.buckets[E];if(P instanceof a.SymbolBucket){if(this.hasSymbolBuckets=!0,!v)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const E in this.buckets){const P=this.buckets[E];if(P instanceof a.SymbolBucket&&P.hasRTLText){this.hasRTLText=!0,a.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const E in this.buckets){const P=this.buckets[E];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(E).queryRadius(P))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new a.CollisionBoxArray}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const v in this.buckets){const E=this.buckets[v];E.uploadPending()&&E.upload(l)}const p=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new te(l,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new te(l,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,p,v,E,P,z,N,G,$,K){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:E,cameraQueryGeometry:P,scale:z,tileSize:this.tileSize,pixelPosMatrix:K,transform:G,params:N,queryPadding:this.queryPadding*$},l,p,v):{}}querySourceFeatures(l,p){const v=this.latestFeatureIndex;if(!v||!v.rawTileData)return;const E=v.loadVTLayers(),P=p?p.sourceLayer:"",z=E._geojsonTileLayer||E[P];if(!z)return;const N=a.createFilter(p&&p.filter),{z:G,x:$,y:K}=this.tileID.canonical,se={z:G,x:$,y:K};for(let ce=0;ce<z.length;ce++){const xe=z.feature(ce);if(N.needGeometry){const ye=a.toEvaluationFeature(xe,!0);if(!N.filter(new a.EvaluationParameters(this.tileID.overscaledZ),ye,this.tileID.canonical))continue}else if(!N.filter(new a.EvaluationParameters(this.tileID.overscaledZ),xe))continue;const ve=v.getId(xe,P),le=new a.GeoJSONFeature(xe,G,$,K,ve);le.tile=se,l.push(le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const p=this.expirationTime;if(l.cacheControl){const v=a.parseCacheControl(l.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const v=Date.now();let E=!1;if(this.expirationTime>v)E=!1;else if(p)if(this.expirationTime<p)E=!0;else{const P=this.expirationTime-p;P?this.expirationTime=v+Math.max(P,3e4):E=!0}else E=!0;E?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,p){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const v=this.latestFeatureIndex.loadVTLayers();for(const E in this.buckets){if(!p.style.hasLayer(E))continue;const P=this.buckets[E],z=P.layers[0].sourceLayer||"_geojsonTileLayer",N=v[z],G=l[z];if(!N||!G||Object.keys(G).length===0)continue;P.update(G,N,this.imageAtlas&&this.imageAtlas.patternPositions||{});const $=p&&p.style&&p.style.getLayer(E);$&&(this.queryPadding=Math.max(this.queryPadding,$.queryRadius(P)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=a.exported.now()+l}setDependencies(l,p){const v={};for(const E of p)v[E]=!0;this.dependencies[l]=v}hasDependency(l,p){for(const v of l){const E=this.dependencies[v];if(E){for(const P of p)if(E[P])return!0}}return!1}}class On{constructor(l,p){this.max=l,this.onRemove=p,this.reset()}reset(){for(const l in this.data)for(const p of this.data[l])p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value);return this.data={},this.order=[],this}add(l,p,v){const E=l.wrapped().key;this.data[E]===void 0&&(this.data[E]=[]);const P={value:p,timeout:void 0};if(v!==void 0&&(P.timeout=setTimeout(()=>{this.remove(l,P)},v)),this.data[E].push(P),this.order.push(E),this.order.length>this.max){const z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const p=this.data[l].shift();return p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),p.value}getByKey(l){const p=this.data[l];return p?p[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,p){if(!this.has(l))return this;const v=l.wrapped().key,E=p===void 0?0:this.data[v].indexOf(p),P=this.data[v][E];return this.data[v].splice(E,1),P.timeout&&clearTimeout(P.timeout),this.data[v].length===0&&delete this.data[v],this.onRemove(P.value),this.order.splice(this.order.indexOf(v),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}filter(l){const p=[];for(const v in this.data)for(const E of this.data[v])l(E.value)||p.push(E);for(const v of p)this.remove(v.value.tileID,v)}}class vi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,p,v){const E=String(p);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][E]=this.stateChanges[l][E]||{},a.extend(this.stateChanges[l][E],v),this.deletedStates[l]===null){this.deletedStates[l]={};for(const P in this.state[l])P!==E&&(this.deletedStates[l][P]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][E]===null){this.deletedStates[l][E]={};for(const P in this.state[l][E])v[P]||(this.deletedStates[l][E][P]=null)}else for(const P in v)this.deletedStates[l]&&this.deletedStates[l][E]&&this.deletedStates[l][E][P]===null&&delete this.deletedStates[l][E][P]}removeFeatureState(l,p,v){if(this.deletedStates[l]===null)return;const E=String(p);if(this.deletedStates[l]=this.deletedStates[l]||{},v&&p!==void 0)this.deletedStates[l][E]!==null&&(this.deletedStates[l][E]=this.deletedStates[l][E]||{},this.deletedStates[l][E][v]=null);else if(p!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][E])for(v in this.deletedStates[l][E]={},this.stateChanges[l][E])this.deletedStates[l][E][v]=null;else this.deletedStates[l][E]=null;else this.deletedStates[l]=null}getState(l,p){const v=String(p),E=a.extend({},(this.state[l]||{})[v],(this.stateChanges[l]||{})[v]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const P=this.deletedStates[l][p];if(P===null)return{};for(const z in P)delete E[z]}return E}initializeTileState(l,p){l.setFeatureState(this.state,p)}coalesceChanges(l,p){const v={};for(const E in this.stateChanges){this.state[E]=this.state[E]||{};const P={};for(const z in this.stateChanges[E])this.state[E][z]||(this.state[E][z]={}),a.extend(this.state[E][z],this.stateChanges[E][z]),P[z]=this.state[E][z];v[E]=P}for(const E in this.deletedStates){this.state[E]=this.state[E]||{};const P={};if(this.deletedStates[E]===null)for(const z in this.state[E])P[z]={},this.state[E][z]={};else for(const z in this.deletedStates[E]){if(this.deletedStates[E][z]===null)this.state[E][z]={};else for(const N of Object.keys(this.deletedStates[E][z]))delete this.state[E][z][N];P[z]=this.state[E][z]}v[E]=v[E]||{},a.extend(v[E],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(const E in l)l[E].setFeatureState(v,p)}}class mt extends a.Evented{constructor(l,p,v){super(),this.id=l,this.dispatcher=v,this.on("data",E=>{E.dataType==="source"&&E.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&E.dataType==="source"&&E.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(E,P,z,N){const G=new Tn[P.type](E,P,z,N);if(G.id!==E)throw new Error(`Expected Source id to be ${E} instead of ${G.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],G),G}(l,p,v,this),this._tiles={},this._cache=new On(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new vi}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const l in this._tiles){const p=this._tiles[l];if(p.state!=="loaded"&&p.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,p){return this._source.loadTile(l,p)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l,()=>{})}_abortTile(l){this._source.abortTile&&this._source.abortTile(l,()=>{}),this._source.fire(new a.Event("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const p in this._tiles){const v=this._tiles[p];v.upload(l),v.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Yt).map(l=>l.key)}getRenderableIds(l){const p=[];for(const v in this._tiles)this._isIdRenderable(v,l)&&p.push(this._tiles[v]);return l?p.sort((v,E)=>{const P=v.tileID,z=E.tileID,N=new a.pointGeometry(P.canonical.x,P.canonical.y)._rotate(this.transform.angle),G=new a.pointGeometry(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return P.overscaledZ-z.overscaledZ||G.y-N.y||G.x-N.x}).map(v=>v.tileID.key):p.map(v=>v.tileID).sort(Yt).map(v=>v.key)}hasRenderableParent(l){const p=this.findLoadedParent(l,0);return!!p&&this._isIdRenderable(p.tileID.key)}_isIdRenderable(l,p){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(p||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,p){const v=this._tiles[l];v&&(v.state!=="loading"&&(v.state=p),this._loadTile(v,this._tileLoaded.bind(this,v,l,p)))}_tileLoaded(l,p,v,E){if(E)return l.state="errored",void(E.status!==404?this._source.fire(new a.ErrorEvent(E,{tile:l})):this.update(this.transform,this.terrain));l.timeAdded=a.exported.now(),v==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(p,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new a.Event("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const p=this.getRenderableIds();for(let E=0;E<p.length;E++){const P=p[E];if(l.neighboringTiles&&l.neighboringTiles[P]){const z=this.getTileByID(P);v(l,z),v(z,l)}}function v(E,P){E.needsHillshadePrepare=!0,E.needsTerrainPrepare=!0;let z=P.tileID.canonical.x-E.tileID.canonical.x;const N=P.tileID.canonical.y-E.tileID.canonical.y,G=Math.pow(2,E.tileID.canonical.z),$=P.tileID.key;z===0&&N===0||Math.abs(N)>1||(Math.abs(z)>1&&(Math.abs(z+G)===1?z+=G:Math.abs(z-G)===1&&(z-=G)),P.dem&&E.dem&&(E.dem.backfillBorder(P.dem,z,N),E.neighboringTiles&&E.neighboringTiles[$]&&(E.neighboringTiles[$].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,p,v,E){for(const P in this._tiles){let z=this._tiles[P];if(E[P]||!z.hasData()||z.tileID.overscaledZ<=p||z.tileID.overscaledZ>v)continue;let N=z.tileID;for(;z&&z.tileID.overscaledZ>p+1;){const $=z.tileID.scaledTo(z.tileID.overscaledZ-1);z=this._tiles[$.key],z&&z.hasData()&&(N=$)}let G=N;for(;G.overscaledZ>p;)if(G=G.scaledTo(G.overscaledZ-1),l[G.key]){E[N.key]=N;break}}}findLoadedParent(l,p){if(l.key in this._loadedParentTiles){const v=this._loadedParentTiles[l.key];return v&&v.tileID.overscaledZ>=p?v:null}for(let v=l.overscaledZ-1;v>=p;v--){const E=l.scaledTo(v),P=this._getLoadedTile(E);if(P)return P}}_getLoadedTile(l){const p=this._tiles[l.key];return p&&p.hasData()?p:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const p=Math.ceil(l.width/this._source.tileSize)+1,v=Math.ceil(l.height/this._source.tileSize)+1,E=Math.floor(p*v*5),P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(P)}handleWrapJump(l){const p=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,p){const v={};for(const E in this._tiles){const P=this._tiles[E];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+p),v[P.tileID.key]=P}this._tiles=v;for(const E in this._timers)clearTimeout(this._timers[E]),delete this._timers[E];for(const E in this._tiles)this._setTileReloadTimer(E,this._tiles[E])}}update(l,p){if(this.transform=l,this.terrain=p,!this._sourceLoaded||this._paused)return;let v;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?v=l.getVisibleUnwrappedCoordinates(this._source.tileID).map($=>new a.OverscaledTileID($.canonical.z,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y)):(v=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:p}),this._source.hasTile&&(v=v.filter($=>this._source.hasTile($)))):v=[];const E=l.coveringZoomLevel(this._source),P=Math.max(E-mt.maxOverzooming,this._source.minzoom),z=Math.max(E+mt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const $={};for(const K of v)if(K.canonical.z>this._source.minzoom){const se=K.scaledTo(K.canonical.z-1);$[se.key]=se;const ce=K.scaledTo(Math.max(this._source.minzoom,Math.min(K.canonical.z,5)));$[ce.key]=ce}v=v.concat(Object.values($))}const N=this._updateRetainedTiles(v,E);if(mn(this._source.type)){const $={},K={},se=Object.keys(N);for(const ce of se){const xe=N[ce],ve=this._tiles[ce];if(!ve||ve.fadeEndTime&&ve.fadeEndTime<=a.exported.now())continue;const le=this.findLoadedParent(xe,P);le&&(this._addTile(le.tileID),$[le.tileID.key]=le.tileID),K[ce]=xe}this._retainLoadedChildren(K,E,z,N);for(const ce in $)N[ce]||(this._coveredTiles[ce]=!0,N[ce]=$[ce]);if(p){const ce={},xe={};for(const ve of v)this._tiles[ve.key].hasData()?ce[ve.key]=ve:xe[ve.key]=ve;for(const ve in xe){const le=xe[ve].children(this._source.maxzoom);this._tiles[le[0].key]&&this._tiles[le[1].key]&&this._tiles[le[2].key]&&this._tiles[le[3].key]&&(ce[le[0].key]=N[le[0].key]=le[0],ce[le[1].key]=N[le[1].key]=le[1],ce[le[2].key]=N[le[2].key]=le[2],ce[le[3].key]=N[le[3].key]=le[3],delete xe[ve])}for(const ve in xe){const le=this.findLoadedParent(xe[ve],this._source.minzoom);if(le){ce[le.tileID.key]=N[le.tileID.key]=le.tileID;for(const ye in ce)ce[ye].isChildOf(le.tileID)&&delete ce[ye]}}for(const ve in this._tiles)ce[ve]||(this._coveredTiles[ve]=!0)}}for(const $ in N)this._tiles[$].clearFadeHold();const G=a.keysDifference(this._tiles,N);for(const $ of G){const K=this._tiles[$];K.hasSymbolBuckets&&!K.holdingForFade()?K.setHoldDuration(this.map._fadeDuration):K.hasSymbolBuckets&&!K.symbolFadeFinished()||this._removeTile($)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,p){const v={},E={},P=Math.max(p-mt.maxOverzooming,this._source.minzoom),z=Math.max(p+mt.maxUnderzooming,this._source.minzoom),N={};for(const G of l){const $=this._addTile(G);v[G.key]=G,$.hasData()||p<this._source.maxzoom&&(N[G.key]=G)}this._retainLoadedChildren(N,p,z,v);for(const G of l){let $=this._tiles[G.key];if($.hasData())continue;if(p+1>this._source.maxzoom){const se=G.children(this._source.maxzoom)[0],ce=this.getTile(se);if(ce&&ce.hasData()){v[se.key]=se;continue}}else{const se=G.children(this._source.maxzoom);if(v[se[0].key]&&v[se[1].key]&&v[se[2].key]&&v[se[3].key])continue}let K=$.wasRequested();for(let se=G.overscaledZ-1;se>=P;--se){const ce=G.scaledTo(se);if(E[ce.key]||(E[ce.key]=!0,$=this.getTile(ce),!$&&K&&($=this._addTile(ce)),$&&(v[ce.key]=ce,K=$.wasRequested(),$.hasData())))break}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const p=[];let v,E=this._tiles[l].tileID;for(;E.overscaledZ>0;){if(E.key in this._loadedParentTiles){v=this._loadedParentTiles[E.key];break}p.push(E.key);const P=E.scaledTo(E.overscaledZ-1);if(v=this._getLoadedTile(P),v)break;E=P}for(const P of p)this._loadedParentTiles[P]=v}}_addTile(l){let p=this._tiles[l.key];if(p)return p;p=this._cache.getAndRemove(l),p&&(this._setTileReloadTimer(l.key,p),p.tileID=l,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,p)));const v=p;return p||(p=new hi(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(p,this._tileLoaded.bind(this,p,l.key,p.state))),p.uses++,this._tiles[l.key]=p,v||this._source.fire(new a.Event("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p}_setTileReloadTimer(l,p){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const v=p.getExpiryTimeout();v&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},v))}_removeTile(l){const p=this._tiles[l];p&&(p.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),p.uses>0||(p.hasData()&&p.state!=="reloading"?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,p,v){const E=[],P=this.transform;if(!P)return E;const z=v?P.getCameraQueryGeometry(l):l,N=l.map(ve=>P.pointCoordinate(ve,this.terrain)),G=z.map(ve=>P.pointCoordinate(ve,this.terrain)),$=this.getIds();let K=1/0,se=1/0,ce=-1/0,xe=-1/0;for(const ve of G)K=Math.min(K,ve.x),se=Math.min(se,ve.y),ce=Math.max(ce,ve.x),xe=Math.max(xe,ve.y);for(let ve=0;ve<$.length;ve++){const le=this._tiles[$[ve]];if(le.holdingForFade())continue;const ye=le.tileID,ze=Math.pow(2,P.zoom-le.tileID.overscaledZ),Ge=p*le.queryPadding*a.EXTENT/le.tileSize/ze,Se=[ye.getTilePoint(new a.MercatorCoordinate(K,se)),ye.getTilePoint(new a.MercatorCoordinate(ce,xe))];if(Se[0].x-Ge<a.EXTENT&&Se[0].y-Ge<a.EXTENT&&Se[1].x+Ge>=0&&Se[1].y+Ge>=0){const Ze=N.map(tt=>ye.getTilePoint(tt)),je=G.map(tt=>ye.getTilePoint(tt));E.push({tile:le,tileID:ye,queryGeometry:Ze,cameraQueryGeometry:je,scale:ze})}}return E}getVisibleCoordinates(l){const p=this.getRenderableIds(l).map(v=>this._tiles[v].tileID);for(const v of p)v.posMatrix=this.transform.calculatePosMatrix(v.toUnwrapped());return p}hasTransition(){if(this._source.hasTransition())return!0;if(mn(this._source.type))for(const l in this._tiles){const p=this._tiles[l];if(p.fadeEndTime!==void 0&&p.fadeEndTime>=a.exported.now())return!0}return!1}setFeatureState(l,p,v){this._state.updateState(l=l||"_geojsonTileLayer",p,v)}removeFeatureState(l,p,v){this._state.removeFeatureState(l=l||"_geojsonTileLayer",p,v)}getFeatureState(l,p){return this._state.getState(l=l||"_geojsonTileLayer",p)}setDependencies(l,p,v){const E=this._tiles[l];E&&E.setDependencies(p,v)}reloadTilesForDependencies(l,p){for(const v in this._tiles)this._tiles[v].hasDependency(l,p)&&this._reloadTile(v,"reloading");this._cache.filter(v=>!v.hasDependency(l,p))}}function Yt(b,l){const p=Math.abs(2*b.wrap)-+(b.wrap<0),v=Math.abs(2*l.wrap)-+(l.wrap<0);return b.overscaledZ-l.overscaledZ||v-p||l.canonical.y-b.canonical.y||l.canonical.x-b.canonical.x}function mn(b){return b==="raster"||b==="image"||b==="video"}mt.maxOverzooming=10,mt.maxUnderzooming=3;const dt="mapboxgl_preloaded_worker_pool";class Fn{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Fn.workerCount;)this.workers.push(new Worker(ea.workerUrl));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[dt]}numActive(){return Object.keys(this.active).length}}const Rn=Math.floor(a.exported.hardwareConcurrency/2);let ri;function Qn(){return ri||(ri=new Fn),ri}function si(b,l){const p={};for(const v in b)v!=="ref"&&(p[v]=b[v]);return a.refProperties.forEach(v=>{v in l&&(p[v]=l[v])}),p}function hr(b){b=b.slice();const l=Object.create(null);for(let p=0;p<b.length;p++)l[b[p].id]=b[p];for(let p=0;p<b.length;p++)"ref"in b[p]&&(b[p]=si(b[p],l[b[p].ref]));return b}Fn.workerCount=Math.max(Math.min(Rn,6),1);const kn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function fr(b,l,p){p.push({command:kn.addSource,args:[b,l[b]]})}function Yn(b,l,p){l.push({command:kn.removeSource,args:[b]}),p[b]=!0}function Wr(b,l,p,v){Yn(b,p,v),fr(b,l,p)}function vo(b,l,p){let v;for(v in b[p])if(Object.prototype.hasOwnProperty.call(b[p],v)&&v!=="data"&&!R(b[p][v],l[p][v]))return!1;for(v in l[p])if(Object.prototype.hasOwnProperty.call(l[p],v)&&v!=="data"&&!R(b[p][v],l[p][v]))return!1;return!0}function rr(b,l,p,v,E,P){let z;for(z in l=l||{},b=b||{})Object.prototype.hasOwnProperty.call(b,z)&&(R(b[z],l[z])||p.push({command:P,args:[v,z,l[z],E]}));for(z in l)Object.prototype.hasOwnProperty.call(l,z)&&!Object.prototype.hasOwnProperty.call(b,z)&&(R(b[z],l[z])||p.push({command:P,args:[v,z,l[z],E]}))}function Lr(b){return b.id}function xo(b,l){return b[l.id]=l,b}class $r{constructor(l,p){this.reset(l,p)}reset(l,p){this.points=l||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=a.clamp(l,0,1);let p=1,v=this._distances[p];const E=l*this.paddedLength+this.padding;for(;v<E&&p<this._distances.length;)v=this._distances[++p];const P=p-1,z=this._distances[P],N=v-z,G=N>0?(E-z)/N:0;return this.points[P].mult(1-G).add(this.points[p].mult(G))}}function et(b,l){let p=!0;return b==="always"||b!=="never"&&l!=="never"||(p=!1),p}class xt{constructor(l,p,v){const E=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(l/v),this.yCellCount=Math.ceil(p/v);for(let z=0;z<this.xCellCount*this.yCellCount;z++)E.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=p,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,p,v,E,P){this._forEachCell(p,v,E,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(E),this.bboxes.push(P)}insertCircle(l,p,v,E){this._forEachCell(p-E,v-E,p+E,v+E,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(p),this.circles.push(v),this.circles.push(E)}_insertBoxCell(l,p,v,E,P,z){this.boxCells[P].push(z)}_insertCircleCell(l,p,v,E,P,z){this.circleCells[P].push(z)}_query(l,p,v,E,P,z,N){if(v<0||l>this.width||E<0||p>this.height)return[];const G=[];if(l<=0&&p<=0&&this.width<=v&&this.height<=E){if(P)return[{key:null,x1:l,y1:p,x2:v,y2:E}];for(let $=0;$<this.boxKeys.length;$++)G.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(let $=0;$<this.circleKeys.length;$++){const K=this.circles[3*$],se=this.circles[3*$+1],ce=this.circles[3*$+2];G.push({key:this.circleKeys[$],x1:K-ce,y1:se-ce,x2:K+ce,y2:se+ce})}}else this._forEachCell(l,p,v,E,this._queryCell,G,{hitTest:P,overlapMode:z,seenUids:{box:{},circle:{}}},N);return G}query(l,p,v,E){return this._query(l,p,v,E,!1,null)}hitTest(l,p,v,E,P,z){return this._query(l,p,v,E,!0,P,z).length>0}hitTestCircle(l,p,v,E,P){const z=l-v,N=l+v,G=p-v,$=p+v;if(N<0||z>this.width||$<0||G>this.height)return!1;const K=[];return this._forEachCell(z,G,N,$,this._queryCellCircle,K,{hitTest:!0,overlapMode:E,circle:{x:l,y:p,radius:v},seenUids:{box:{},circle:{}}},P),K.length>0}_queryCell(l,p,v,E,P,z,N,G){const{seenUids:$,hitTest:K,overlapMode:se}=N,ce=this.boxCells[P];if(ce!==null){const ve=this.bboxes;for(const le of ce)if(!$.box[le]){$.box[le]=!0;const ye=4*le,ze=this.boxKeys[le];if(l<=ve[ye+2]&&p<=ve[ye+3]&&v>=ve[ye+0]&&E>=ve[ye+1]&&(!G||G(ze))&&(!K||!et(se,ze.overlapMode))&&(z.push({key:ze,x1:ve[ye],y1:ve[ye+1],x2:ve[ye+2],y2:ve[ye+3]}),K))return!0}}const xe=this.circleCells[P];if(xe!==null){const ve=this.circles;for(const le of xe)if(!$.circle[le]){$.circle[le]=!0;const ye=3*le,ze=this.circleKeys[le];if(this._circleAndRectCollide(ve[ye],ve[ye+1],ve[ye+2],l,p,v,E)&&(!G||G(ze))&&(!K||!et(se,ze.overlapMode))){const Ge=ve[ye],Se=ve[ye+1],Ze=ve[ye+2];if(z.push({key:ze,x1:Ge-Ze,y1:Se-Ze,x2:Ge+Ze,y2:Se+Ze}),K)return!0}}}return!1}_queryCellCircle(l,p,v,E,P,z,N,G){const{circle:$,seenUids:K,overlapMode:se}=N,ce=this.boxCells[P];if(ce!==null){const ve=this.bboxes;for(const le of ce)if(!K.box[le]){K.box[le]=!0;const ye=4*le,ze=this.boxKeys[le];if(this._circleAndRectCollide($.x,$.y,$.radius,ve[ye+0],ve[ye+1],ve[ye+2],ve[ye+3])&&(!G||G(ze))&&!et(se,ze.overlapMode))return z.push(!0),!0}}const xe=this.circleCells[P];if(xe!==null){const ve=this.circles;for(const le of xe)if(!K.circle[le]){K.circle[le]=!0;const ye=3*le,ze=this.circleKeys[le];if(this._circlesCollide(ve[ye],ve[ye+1],ve[ye+2],$.x,$.y,$.radius)&&(!G||G(ze))&&!et(se,ze.overlapMode))return z.push(!0),!0}}}_forEachCell(l,p,v,E,P,z,N,G){const $=this._convertToXCellCoord(l),K=this._convertToYCellCoord(p),se=this._convertToXCellCoord(v),ce=this._convertToYCellCoord(E);for(let xe=$;xe<=se;xe++)for(let ve=K;ve<=ce;ve++)if(P.call(this,l,p,v,E,this.xCellCount*ve+xe,z,N,G))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,p,v,E,P,z){const N=E-l,G=P-p,$=v+z;return $*$>N*N+G*G}_circleAndRectCollide(l,p,v,E,P,z,N){const G=(z-E)/2,$=Math.abs(l-(E+G));if($>G+v)return!1;const K=(N-P)/2,se=Math.abs(p-(P+K));if(se>K+v)return!1;if($<=G||se<=K)return!0;const ce=$-G,xe=se-K;return ce*ce+xe*xe<=v*v}}function Ms(b,l,p,v,E){const P=a.create();return l?(a.scale(P,P,[1/E,1/E,1]),p||a.rotateZ(P,P,v.angle)):a.multiply(P,v.labelPlaneMatrix,b),P}function sr(b,l,p,v,E){if(l){const P=a.clone(b);return a.scale(P,P,[E,E,1]),p||a.rotateZ(P,P,-v.angle),P}return v.glCoordMatrix}function Sn(b,l,p){let v;p?(v=[b.x,b.y,p(b.x,b.y),1],a.transformMat4(v,v,l)):(v=[b.x,b.y,0,1],At(v,v,l));const E=v[3];return{point:new a.pointGeometry(v[0]/E,v[1]/E),signedDistanceFromCamera:E}}function wr(b,l){return .5+b/l*.5}function Ar(b,l){const p=b[0]/b[3],v=b[1]/b[3];return p>=-l[0]&&p<=l[0]&&v>=-l[1]&&v<=l[1]}function dr(b,l,p,v,E,P,z,N,G,$){const K=v?b.textSizeData:b.iconSizeData,se=a.evaluateSizeForZoom(K,p.transform.zoom),ce=[256/p.width*2+1,256/p.height*2+1],xe=v?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;xe.clear();const ve=b.lineVertexArray,le=v?b.text.placedSymbolArray:b.icon.placedSymbolArray,ye=p.transform.width/p.transform.height;let ze=!1;for(let Ge=0;Ge<le.length;Ge++){const Se=le.get(Ge);if(Se.hidden||Se.writingMode===a.WritingMode.vertical&&!ze){cn(Se.numGlyphs,xe);continue}let Ze;if(ze=!1,$?(Ze=[Se.anchorX,Se.anchorY,$(Se.anchorX,Se.anchorY),1],a.transformMat4(Ze,Ze,l)):(Ze=[Se.anchorX,Se.anchorY,0,1],At(Ze,Ze,l)),!Ar(Ze,ce)){cn(Se.numGlyphs,xe);continue}const je=wr(p.transform.cameraToCenterDistance,Ze[3]),tt=a.evaluateSizeForFeature(K,se,Se),Ke=z?tt/je:tt*je,d=new a.pointGeometry(Se.anchorX,Se.anchorY),A=Sn(d,E,$).point,m={},_=An(Se,Ke,!1,N,l,E,P,b.glyphOffsetArray,ve,xe,A,d,m,ye,G,$);ze=_.useVertical,(_.notEnoughRoom||ze||_.needsFlipping&&An(Se,Ke,!0,N,l,E,P,b.glyphOffsetArray,ve,xe,A,d,m,ye,G,$).notEnoughRoom)&&cn(Se.numGlyphs,xe)}v?b.text.dynamicLayoutVertexBuffer.updateData(xe):b.icon.dynamicLayoutVertexBuffer.updateData(xe)}function us(b,l,p,v,E,P,z,N,G,$,K,se,ce){const xe=N.glyphStartIndex+N.numGlyphs,ve=N.lineStartIndex,le=N.lineStartIndex+N.lineLength,ye=l.getoffsetX(N.glyphStartIndex),ze=l.getoffsetX(xe-1),Ge=Pi(b*ye,p,v,E,P,z,N.segment,ve,le,G,$,K,se,ce);if(!Ge)return null;const Se=Pi(b*ze,p,v,E,P,z,N.segment,ve,le,G,$,K,se,ce);return Se?{first:Ge,last:Se}:null}function wt(b,l,p,v){return b===a.WritingMode.horizontal&&Math.abs(p.y-l.y)>Math.abs(p.x-l.x)*v?{useVertical:!0}:(b===a.WritingMode.vertical?l.y<p.y:l.x>p.x)?{needsFlipping:!0}:null}function An(b,l,p,v,E,P,z,N,G,$,K,se,ce,xe,ve,le){const ye=l/24,ze=b.lineOffsetX*ye,Ge=b.lineOffsetY*ye;let Se;if(b.numGlyphs>1){const Ze=b.glyphStartIndex+b.numGlyphs,je=b.lineStartIndex,tt=b.lineStartIndex+b.lineLength,Ke=us(ye,N,ze,Ge,p,K,se,b,G,P,ce,ve,le);if(!Ke)return{notEnoughRoom:!0};const d=Sn(Ke.first.point,z,le).point,A=Sn(Ke.last.point,z,le).point;if(v&&!p){const m=wt(b.writingMode,d,A,xe);if(m)return m}Se=[Ke.first];for(let m=b.glyphStartIndex+1;m<Ze-1;m++)Se.push(Pi(ye*N.getoffsetX(m),ze,Ge,p,K,se,b.segment,je,tt,G,P,ce,ve,le));Se.push(Ke.last)}else{if(v&&!p){const je=Sn(se,E,le).point,tt=b.lineStartIndex+b.segment+1,Ke=new a.pointGeometry(G.getx(tt),G.gety(tt)),d=Sn(Ke,E,le),A=d.signedDistanceFromCamera>0?d.point:fn(se,Ke,je,1,E,le),m=wt(b.writingMode,je,A,xe);if(m)return m}const Ze=Pi(ye*N.getoffsetX(b.glyphStartIndex),ze,Ge,p,K,se,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,G,P,ce,ve,le);if(!Ze)return{notEnoughRoom:!0};Se=[Ze]}for(const Ze of Se)a.addDynamicAttributes($,Ze.point,Ze.angle);return{}}function fn(b,l,p,v,E,P){const z=Sn(b.add(b.sub(l)._unit()),E,P).point,N=p.sub(z);return p.add(N._mult(v/N.mag()))}function Pi(b,l,p,v,E,P,z,N,G,$,K,se,ce,xe){const ve=v?b-l:b+l;let le=ve>0?1:-1,ye=0;v&&(le*=-1,ye=Math.PI),le<0&&(ye+=Math.PI);let ze=le>0?N+z:N+z+1,Ge=E,Se=E,Ze=0,je=0;const tt=Math.abs(ve),Ke=[];for(;Ze+je<=tt;){if(ze+=le,ze<N||ze>=G)return null;if(Se=Ge,Ke.push(Ge),Ge=se[ze],Ge===void 0){const x=new a.pointGeometry($.getx(ze),$.gety(ze)),S=Sn(x,K,xe);if(S.signedDistanceFromCamera>0)Ge=se[ze]=S.point;else{const I=ze-le;Ge=fn(Ze===0?P:new a.pointGeometry($.getx(I),$.gety(I)),x,Se,tt-Ze+1,K,xe)}}Ze+=je,je=Se.dist(Ge)}const d=(tt-Ze)/je,A=Ge.sub(Se),m=A.mult(d)._add(Se);m._add(A._unit()._perp()._mult(p*le));const _=ye+Math.atan2(Ge.y-Se.y,Ge.x-Se.x);return Ke.push(m),{point:m,angle:ce?_:0,path:Ke}}const hs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function cn(b,l){for(let p=0;p<b;p++){const v=l.length;l.resize(v+4),l.float32.set(hs,3*v)}}function At(b,l,p){const v=l[0],E=l[1];return b[0]=p[0]*v+p[4]*E+p[12],b[1]=p[1]*v+p[5]*E+p[13],b[3]=p[3]*v+p[7]*E+p[15],b}const Ri=100;class qs{constructor(l,p=new xt(l.width+200,l.height+200,25),v=new xt(l.width+200,l.height+200,25)){this.transform=l,this.grid=p,this.ignoredGrid=v,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Ri,this.screenBottomBoundary=l.height+Ri,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,p,v,E,P,z){const N=this.projectAndGetPerspectiveRatio(E,l.anchorPointX,l.anchorPointY,z),G=v*N.perspectiveRatio,$=l.x1*G+N.point.x,K=l.y1*G+N.point.y,se=l.x2*G+N.point.x,ce=l.y2*G+N.point.y;return!this.isInsideGrid($,K,se,ce)||p!=="always"&&this.grid.hitTest($,K,se,ce,p,P)||N.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[$,K,se,ce],offscreen:this.isOffscreen($,K,se,ce)}}placeCollisionCircles(l,p,v,E,P,z,N,G,$,K,se,ce,xe,ve){const le=[],ye=new a.pointGeometry(p.anchorX,p.anchorY),ze=Sn(ye,z,ve),Ge=wr(this.transform.cameraToCenterDistance,ze.signedDistanceFromCamera),Se=(K?P/Ge:P*Ge)/a.ONE_EM,Ze=Sn(ye,N,ve).point,je=us(Se,E,p.lineOffsetX*Se,p.lineOffsetY*Se,!1,Ze,ye,p,v,N,{},!1,ve);let tt=!1,Ke=!1,d=!0;if(je){const A=.5*ce*Ge+xe,m=new a.pointGeometry(-100,-100),_=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),x=new $r,S=je.first,I=je.last;let D=[];for(let J=S.path.length-1;J>=1;J--)D.push(S.path[J]);for(let J=1;J<I.path.length;J++)D.push(I.path[J]);const O=2.5*A;if(G){const J=D.map(Ae=>Sn(Ae,G,ve));D=J.some(Ae=>Ae.signedDistanceFromCamera<=0)?[]:J.map(Ae=>Ae.point)}let H=[];if(D.length>0){const J=D[0].clone(),Ae=D[0].clone();for(let we=1;we<D.length;we++)J.x=Math.min(J.x,D[we].x),J.y=Math.min(J.y,D[we].y),Ae.x=Math.max(Ae.x,D[we].x),Ae.y=Math.max(Ae.y,D[we].y);H=J.x>=m.x&&Ae.x<=_.x&&J.y>=m.y&&Ae.y<=_.y?[D]:Ae.x<m.x||J.x>_.x||Ae.y<m.y||J.y>_.y?[]:a.clipLine([D],m.x,m.y,_.x,_.y)}for(const J of H){x.reset(J,.25*A);let Ae=0;Ae=x.length<=.5*A?1:Math.ceil(x.paddedLength/O)+1;for(let we=0;we<Ae;we++){const Re=we/Math.max(Ae-1,1),Ee=x.lerp(Re),Be=Ee.x+Ri,Je=Ee.y+Ri;le.push(Be,Je,A,0);const Ye=Be-A,He=Je-A,We=Be+A,Oe=Je+A;if(d=d&&this.isOffscreen(Ye,He,We,Oe),Ke=Ke||this.isInsideGrid(Ye,He,We,Oe),l!=="always"&&this.grid.hitTestCircle(Be,Je,A,l,se)&&(tt=!0,!$))return{circles:[],offscreen:!1,collisionDetected:tt}}}}return{circles:!$&&tt||!Ke||Ge<this.perspectiveRatioCutoff?[]:le,offscreen:d,collisionDetected:tt}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[];let v=1/0,E=1/0,P=-1/0,z=-1/0;for(const K of l){const se=new a.pointGeometry(K.x+Ri,K.y+Ri);v=Math.min(v,se.x),E=Math.min(E,se.y),P=Math.max(P,se.x),z=Math.max(z,se.y),p.push(se)}const N=this.grid.query(v,E,P,z).concat(this.ignoredGrid.query(v,E,P,z)),G={},$={};for(const K of N){const se=K.key;if(G[se.bucketInstanceId]===void 0&&(G[se.bucketInstanceId]={}),G[se.bucketInstanceId][se.featureIndex])continue;const ce=[new a.pointGeometry(K.x1,K.y1),new a.pointGeometry(K.x2,K.y1),new a.pointGeometry(K.x2,K.y2),new a.pointGeometry(K.x1,K.y2)];a.polygonIntersectsPolygon(p,ce)&&(G[se.bucketInstanceId][se.featureIndex]=!0,$[se.bucketInstanceId]===void 0&&($[se.bucketInstanceId]=[]),$[se.bucketInstanceId].push(se.featureIndex))}return $}insertCollisionBox(l,p,v,E,P,z){(v?this.ignoredGrid:this.grid).insert({bucketInstanceId:E,featureIndex:P,collisionGroupID:z,overlapMode:p},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,p,v,E,P,z){const N=v?this.ignoredGrid:this.grid,G={bucketInstanceId:E,featureIndex:P,collisionGroupID:z,overlapMode:p};for(let $=0;$<l.length;$+=4)N.insertCircle(G,l[$],l[$+1],l[$+2])}projectAndGetPerspectiveRatio(l,p,v,E){let P;return E?(P=[p,v,E(p,v),1],a.transformMat4(P,P,l)):(P=[p,v,0,1],At(P,P,l)),{point:new a.pointGeometry((P[0]/P[3]+1)/2*this.transform.width+Ri,(-P[1]/P[3]+1)/2*this.transform.height+Ri),perspectiveRatio:.5+this.transform.cameraToCenterDistance/P[3]*.5}}isOffscreen(l,p,v,E){return v<Ri||l>=this.screenRightBoundary||E<Ri||p>this.screenBottomBoundary}isInsideGrid(l,p,v,E){return v>=0&&l<this.gridRightBoundary&&E>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const l=a.identity([]);return a.translate(l,l,[-100,-100,0]),l}}function xi(b,l,p){return l*(a.EXTENT/(b.tileSize*Math.pow(2,p-b.tileID.overscaledZ)))}class Hi{constructor(l,p,v,E){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?p:-p))):E&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class Nn{constructor(l,p,v,E,P){this.text=new Hi(l?l.text:null,p,v,P),this.icon=new Hi(l?l.icon:null,p,E,P)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Zs{constructor(l,p,v){this.text=l,this.icon=p,this.skipFade=v}}class Dr{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Rr{constructor(l,p,v,E,P){this.bucketInstanceId=l,this.featureIndex=p,this.sourceLayerIndex=v,this.bucketIndex=E,this.tileID=P}}class qr{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const p=++this.maxGroupID;this.collisionGroups[l]={ID:p,predicate:v=>v.collisionGroupID===p}}return this.collisionGroups[l]}}function Is(b,l,p,v,E){const{horizontalAlign:P,verticalAlign:z}=a.getAnchorAlignment(b),N=-(P-.5)*l,G=-(z-.5)*p,$=a.evaluateVariableOffset(b,v);return new a.pointGeometry(N+$[0]*E,G+$[1]*E)}function or(b,l,p,v,E,P){const{x1:z,x2:N,y1:G,y2:$,anchorPointX:K,anchorPointY:se}=b,ce=new a.pointGeometry(l,p);return v&&ce._rotate(E?P:-P),{x1:z+ce.x,y1:G+ce.y,x2:N+ce.x,y2:$+ce.y,anchorPointX:K,anchorPointY:se}}class Y{constructor(l,p,v,E,P){this.transform=l.clone(),this.terrain=p,this.collisionIndex=new qs(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new qr(E),this.collisionCircleArrays={},this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,p,v,E){const P=v.getBucket(p),z=v.latestFeatureIndex;if(!P||!z||p.id!==P.layerIds[0])return;const N=v.collisionBoxArray,G=P.layers[0].layout,$=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),K=v.tileSize/a.EXTENT,se=this.transform.calculatePosMatrix(v.tileID.toUnwrapped()),ce=G.get("text-pitch-alignment")==="map",xe=G.get("text-rotation-alignment")==="map",ve=xi(v,1,this.transform.zoom),le=Ms(se,ce,xe,this.transform,ve);let ye=null;if(ce){const Ge=sr(se,ce,xe,this.transform,ve);ye=a.multiply([],this.transform.labelPlaneMatrix,Ge)}this.retainedQueryData[P.bucketInstanceId]=new Rr(P.bucketInstanceId,z,P.sourceLayerIndex,P.index,v.tileID);const ze={bucket:P,layout:G,posMatrix:se,textLabelPlaneMatrix:le,labelToScreenMatrix:ye,scale:$,textPixelRatio:K,holdingForFade:v.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(P.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(E)for(const Ge of P.sortKeyRanges){const{sortKey:Se,symbolInstanceStart:Ze,symbolInstanceEnd:je}=Ge;l.push({sortKey:Se,symbolInstanceStart:Ze,symbolInstanceEnd:je,parameters:ze})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:ze})}attemptAnchorPlacement(l,p,v,E,P,z,N,G,$,K,se,ce,xe,ve,le,ye){const ze=[ce.textOffset0,ce.textOffset1],Ge=Is(l,v,E,ze,P),Se=this.collisionIndex.placeCollisionBox(or(p,Ge.x,Ge.y,z,N,this.transform.angle),se,G,$,K.predicate,ye);if((!le||this.collisionIndex.placeCollisionBox(or(le,Ge.x,Ge.y,z,N,this.transform.angle),se,G,$,K.predicate,ye).box.length!==0)&&Se.box.length>0){let Ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(Ze=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ce.crossTileID]={textOffset:ze,width:v,height:E,anchor:l,textBoxScale:P,prevAnchor:Ze},this.markUsedJustification(xe,l,ce,ve),xe.allowVerticalPlacement&&(this.markUsedOrientation(xe,ve,ce),this.placedOrientations[ce.crossTileID]=ve),{shift:Ge,placedGlyphBoxes:Se}}}placeLayerBucketPart(l,p,v){const{bucket:E,layout:P,posMatrix:z,textLabelPlaneMatrix:N,labelToScreenMatrix:G,textPixelRatio:$,holdingForFade:K,collisionBoxArray:se,partiallyEvaluatedTextSize:ce,collisionGroup:xe}=l.parameters,ve=P.get("text-optional"),le=P.get("icon-optional"),ye=a.getOverlapMode(P,"text-overlap","text-allow-overlap"),ze=ye==="always",Ge=a.getOverlapMode(P,"icon-overlap","icon-allow-overlap"),Se=Ge==="always",Ze=P.get("text-rotation-alignment")==="map",je=P.get("text-pitch-alignment")==="map",tt=P.get("icon-text-fit")!=="none",Ke=P.get("symbol-z-order")==="viewport-y",d=ze&&(Se||!E.hasIconData()||le),A=Se&&(ze||!E.hasTextData()||ve);!E.collisionArrays&&se&&E.deserializeCollisionBoxes(se);const m=(_,x)=>{if(p[_.crossTileID])return;if(K)return void(this.placements[_.crossTileID]=new Zs(!1,!1,!1));let S=!1,I=!1,D=!0,O=null,H={box:null,offscreen:null},J={box:null,offscreen:null},Ae=null,we=null,Re=null,Ee=0,Be=0,Je=0;x.textFeatureIndex?Ee=x.textFeatureIndex:_.useRuntimeCollisionCircles&&(Ee=_.featureIndex),x.verticalTextFeatureIndex&&(Be=x.verticalTextFeatureIndex);const Ye=this.retainedQueryData[E.bucketInstanceId].tileID,He=this.terrain?(bt,rt)=>this.terrain.getElevation(Ye,bt,rt):null;for(const bt of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const rt=x[bt];rt&&(rt.elevation=He?He(rt.anchorPointX,rt.anchorPointY):0)}const We=x.textBox;if(We){const bt=ft=>{let dn=a.WritingMode.horizontal;if(E.allowVerticalPlacement&&!ft&&this.prevPlacement){const un=this.prevPlacement.placedOrientations[_.crossTileID];un&&(this.placedOrientations[_.crossTileID]=un,dn=un,this.markUsedOrientation(E,dn,_))}return dn},rt=(ft,dn)=>{if(E.allowVerticalPlacement&&_.numVerticalGlyphVertices>0&&x.verticalTextBox){for(const un of E.writingModes)if(un===a.WritingMode.vertical?(H=dn(),J=H):H=ft(),H&&H.box&&H.box.length)break}else H=ft()};if(P.get("text-variable-anchor")){let ft=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[_.crossTileID]){const rn=this.prevPlacement.variableOffsets[_.crossTileID];ft.indexOf(rn.anchor)>0&&(ft=ft.filter(on=>on!==rn.anchor),ft.unshift(rn.anchor))}const dn=(rn,on,hn)=>{const gn=rn.x2-rn.x1,jn=rn.y2-rn.y1,pn=_.textBoxScale,ti=tt&&Ge==="never"?on:null;let bi={box:[],offscreen:!1};const Mo=ye!=="never"?2*ft.length:ft.length;for(let Pl=0;Pl<Mo;++Pl){const ih=this.attemptAnchorPlacement(ft[Pl%ft.length],rn,gn,jn,pn,Ze,je,$,z,xe,Pl>=ft.length?ye:"never",_,E,hn,ti,He);if(ih&&(bi=ih.placedGlyphBoxes,bi&&bi.box&&bi.box.length)){S=!0,O=ih.shift;break}}return bi};rt(()=>dn(We,x.iconBox,a.WritingMode.horizontal),()=>{const rn=x.verticalTextBox;return E.allowVerticalPlacement&&!(H&&H.box&&H.box.length)&&_.numVerticalGlyphVertices>0&&rn?dn(rn,x.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),H&&(S=H.box,D=H.offscreen);const un=bt(H&&H.box);if(!S&&this.prevPlacement){const rn=this.prevPlacement.variableOffsets[_.crossTileID];rn&&(this.variableOffsets[_.crossTileID]=rn,this.markUsedJustification(E,rn.anchor,_,un))}}else{const ft=(dn,un)=>{const rn=this.collisionIndex.placeCollisionBox(dn,ye,$,z,xe.predicate,He);return rn&&rn.box&&rn.box.length&&(this.markUsedOrientation(E,un,_),this.placedOrientations[_.crossTileID]=un),rn};rt(()=>ft(We,a.WritingMode.horizontal),()=>{const dn=x.verticalTextBox;return E.allowVerticalPlacement&&_.numVerticalGlyphVertices>0&&dn?ft(dn,a.WritingMode.vertical):{box:null,offscreen:null}}),bt(H&&H.box&&H.box.length)}}if(Ae=H,S=Ae&&Ae.box&&Ae.box.length>0,D=Ae&&Ae.offscreen,_.useRuntimeCollisionCircles){const bt=E.text.placedSymbolArray.get(_.centerJustifiedTextSymbolIndex),rt=a.evaluateSizeForFeature(E.textSizeData,ce,bt),ft=P.get("text-padding");we=this.collisionIndex.placeCollisionCircles(ye,bt,E.lineVertexArray,E.glyphOffsetArray,rt,z,N,G,v,je,xe.predicate,_.collisionCircleDiameter,ft,He),we.circles.length&&we.collisionDetected&&!v&&a.warnOnce("Collisions detected, but collision boxes are not shown"),S=ze||we.circles.length>0&&!we.collisionDetected,D=D&&we.offscreen}if(x.iconFeatureIndex&&(Je=x.iconFeatureIndex),x.iconBox){const bt=rt=>{const ft=tt&&O?or(rt,O.x,O.y,Ze,je,this.transform.angle):rt;return this.collisionIndex.placeCollisionBox(ft,Ge,$,z,xe.predicate,He)};J&&J.box&&J.box.length&&x.verticalIconBox?(Re=bt(x.verticalIconBox),I=Re.box.length>0):(Re=bt(x.iconBox),I=Re.box.length>0),D=D&&Re.offscreen}const Oe=ve||_.numHorizontalGlyphVertices===0&&_.numVerticalGlyphVertices===0,Pt=le||_.numIconVertices===0;if(Oe||Pt?Pt?Oe||(I=I&&S):S=I&&S:I=S=I&&S,S&&Ae&&Ae.box&&this.collisionIndex.insertCollisionBox(Ae.box,ye,P.get("text-ignore-placement"),E.bucketInstanceId,J&&J.box&&Be?Be:Ee,xe.ID),I&&Re&&this.collisionIndex.insertCollisionBox(Re.box,Ge,P.get("icon-ignore-placement"),E.bucketInstanceId,Je,xe.ID),we&&(S&&this.collisionIndex.insertCollisionCircles(we.circles,ye,P.get("text-ignore-placement"),E.bucketInstanceId,Ee,xe.ID),v)){const bt=E.bucketInstanceId;let rt=this.collisionCircleArrays[bt];rt===void 0&&(rt=this.collisionCircleArrays[bt]=new Dr);for(let ft=0;ft<we.circles.length;ft+=4)rt.circles.push(we.circles[ft+0]),rt.circles.push(we.circles[ft+1]),rt.circles.push(we.circles[ft+2]),rt.circles.push(we.collisionDetected?1:0)}if(_.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(E.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[_.crossTileID]=new Zs(S||d,I||A,D||E.justReloaded),p[_.crossTileID]=!0};if(Ke){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const _=E.getSortedSymbolIndexes(this.transform.angle);for(let x=_.length-1;x>=0;--x){const S=_[x];m(E.symbolInstances.get(S),E.collisionArrays[S])}}else for(let _=l.symbolInstanceStart;_<l.symbolInstanceEnd;_++)m(E.symbolInstances.get(_),E.collisionArrays[_]);if(v&&E.bucketInstanceId in this.collisionCircleArrays){const _=this.collisionCircleArrays[E.bucketInstanceId];a.invert(_.invProjMatrix,z),_.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(l,p,v,E){let P;P=E===a.WritingMode.vertical?v.verticalPlacedTextSymbolIndex:{left:v.leftJustifiedTextSymbolIndex,center:v.centerJustifiedTextSymbolIndex,right:v.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(p)];const z=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex,v.verticalPlacedTextSymbolIndex];for(const N of z)N>=0&&(l.text.placedSymbolArray.get(N).crossTileID=P>=0&&N!==P?0:v.crossTileID)}markUsedOrientation(l,p,v){const E=p===a.WritingMode.horizontal||p===a.WritingMode.horizontalOnly?p:0,P=p===a.WritingMode.vertical?p:0,z=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex];for(const N of z)l.text.placedSymbolArray.get(N).placedOrientation=E;v.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(v.verticalPlacedTextSymbolIndex).placedOrientation=P)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let v=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const E=p?p.symbolFadeChange(l):1,P=p?p.opacities:{},z=p?p.variableOffsets:{},N=p?p.placedOrientations:{};for(const G in this.placements){const $=this.placements[G],K=P[G];K?(this.opacities[G]=new Nn(K,E,$.text,$.icon),v=v||$.text!==K.text.placed||$.icon!==K.icon.placed):(this.opacities[G]=new Nn(null,E,$.text,$.icon,$.skipFade),v=v||$.text||$.icon)}for(const G in P){const $=P[G];if(!this.opacities[G]){const K=new Nn($,E,!1,!1);K.isHidden()||(this.opacities[G]=K,v=v||$.text.placed||$.icon.placed)}}for(const G in z)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=z[G]);for(const G in N)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=N[G]);if(p&&p.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");v?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:l)}updateLayerOpacities(l,p){const v={};for(const E of p){const P=E.getBucket(l);P&&E.latestFeatureIndex&&l.id===P.layerIds[0]&&this.updateBucketOpacities(P,v,E.collisionBoxArray)}}updateBucketOpacities(l,p,v){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const E=l.layers[0].layout,P=new Nn(null,0,!1,!1,!0),z=E.get("text-allow-overlap"),N=E.get("icon-allow-overlap"),G=E.get("text-variable-anchor"),$=E.get("text-rotation-alignment")==="map",K=E.get("text-pitch-alignment")==="map",se=E.get("icon-text-fit")!=="none",ce=new Nn(null,0,z&&(N||!l.hasIconData()||E.get("icon-optional")),N&&(z||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&v&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(v);const xe=(ve,le,ye)=>{for(let ze=0;ze<le/4;ze++)ve.opacityVertexArray.emplaceBack(ye)};for(let ve=0;ve<l.symbolInstances.length;ve++){const le=l.symbolInstances.get(ve),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:ze,crossTileID:Ge}=le;let Se=this.opacities[Ge];p[Ge]?Se=P:Se||(Se=ce,this.opacities[Ge]=Se),p[Ge]=!0;const Ze=le.numIconVertices>0,je=this.placedOrientations[le.crossTileID],tt=je===a.WritingMode.vertical,Ke=je===a.WritingMode.horizontal||je===a.WritingMode.horizontalOnly;if(ye>0||ze>0){const d=Me(Se.text);xe(l.text,ye,tt?Ne:d),xe(l.text,ze,Ke?Ne:d);const A=Se.text.isHidden();[le.rightJustifiedTextSymbolIndex,le.centerJustifiedTextSymbolIndex,le.leftJustifiedTextSymbolIndex].forEach(x=>{x>=0&&(l.text.placedSymbolArray.get(x).hidden=A||tt?1:0)}),le.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(le.verticalPlacedTextSymbolIndex).hidden=A||Ke?1:0);const m=this.variableOffsets[le.crossTileID];m&&this.markUsedJustification(l,m.anchor,le,je);const _=this.placedOrientations[le.crossTileID];_&&(this.markUsedJustification(l,"left",le,_),this.markUsedOrientation(l,_,le))}if(Ze){const d=Me(Se.icon),A=!(se&&le.verticalPlacedIconSymbolIndex&&tt);le.placedIconSymbolIndex>=0&&(xe(l.icon,le.numIconVertices,A?d:Ne),l.icon.placedSymbolArray.get(le.placedIconSymbolIndex).hidden=Se.icon.isHidden()),le.verticalPlacedIconSymbolIndex>=0&&(xe(l.icon,le.numVerticalIconVertices,A?Ne:d),l.icon.placedSymbolArray.get(le.verticalPlacedIconSymbolIndex).hidden=Se.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const d=l.collisionArrays[ve];if(d){let A=new a.pointGeometry(0,0);if(d.textBox||d.verticalTextBox){let _=!0;if(G){const x=this.variableOffsets[Ge];x?(A=Is(x.anchor,x.width,x.height,x.textOffset,x.textBoxScale),$&&A._rotate(K?this.transform.angle:-this.transform.angle)):_=!1}d.textBox&&V(l.textCollisionBox.collisionVertexArray,Se.text.placed,!_||tt,A.x,A.y),d.verticalTextBox&&V(l.textCollisionBox.collisionVertexArray,Se.text.placed,!_||Ke,A.x,A.y)}const m=!!(!Ke&&d.verticalIconBox);d.iconBox&&V(l.iconCollisionBox.collisionVertexArray,Se.icon.placed,m,se?A.x:0,se?A.y:0),d.verticalIconBox&&V(l.iconCollisionBox.collisionVertexArray,Se.icon.placed,!m,se?A.x:0,se?A.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const ve=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=ve.invProjMatrix,l.placementViewportMatrix=ve.viewportMatrix,l.collisionCircleArray=ve.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,p){const v=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*v>l}setStale(){this.stale=!0}}function V(b,l,p,v,E){b.emplaceBack(l?1:0,p?1:0,v||0,E||0),b.emplaceBack(l?1:0,p?1:0,v||0,E||0),b.emplaceBack(l?1:0,p?1:0,v||0,E||0),b.emplaceBack(l?1:0,p?1:0,v||0,E||0)}const X=Math.pow(2,25),oe=Math.pow(2,24),f=Math.pow(2,17),W=Math.pow(2,16),ke=Math.pow(2,9),Ce=Math.pow(2,8),be=Math.pow(2,1);function Me(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const l=b.placed?1:0,p=Math.floor(127*b.opacity);return p*X+l*oe+p*f+l*W+p*ke+l*Ce+p*be+l}const Ne=0;class it{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,p,v,E,P){const z=this._bucketParts;for(;this._currentTileIndex<l.length;)if(p.getBucketParts(z,E,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort((N,G)=>N.sortKey-G.sortKey));this._currentPartIndex<z.length;)if(p.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,v),this._currentPartIndex++,P())return!0;return!1}}class Ue{constructor(l,p,v,E,P,z,N,G){this.placement=new Y(l,p,z,N,G),this._currentPlacementIndex=v.length-1,this._forceFullPlacement=E,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(l,p,v){const E=a.exported.now(),P=()=>{const z=a.exported.now()-E;return!this._forceFullPlacement&&z>2};for(;this._currentPlacementIndex>=0;){const z=p[l[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=N)&&(!z.maxzoom||z.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new it(z)),this._inProgressLayer.continuePlacement(v[z.source],this.placement,this._showCollisionBoxes,z,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const ct=512/a.EXTENT/2;class It{constructor(l,p,v){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=v;for(let E=0;E<p.length;E++){const P=p.get(E),z=P.key;this.indexedSymbolInstances[z]||(this.indexedSymbolInstances[z]=[]),this.indexedSymbolInstances[z].push({crossTileID:P.crossTileID,coord:this.getScaledCoordinates(P,l)})}}getScaledCoordinates(l,p){const v=ct/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*a.EXTENT+l.anchorX)*v),y:Math.floor((p.canonical.y*a.EXTENT+l.anchorY)*v)}}findMatches(l,p,v){const E=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z);for(let P=0;P<l.length;P++){const z=l.get(P);if(z.crossTileID)continue;const N=this.indexedSymbolInstances[z.key];if(!N)continue;const G=this.getScaledCoordinates(z,p);for(const $ of N)if(Math.abs($.coord.x-G.x)<=E&&Math.abs($.coord.y-G.y)<=E&&!v[$.crossTileID]){v[$.crossTileID]=!0,z.crossTileID=$.crossTileID;break}}}}class St{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Zt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const p=Math.round((l-this.lng)/360);if(p!==0)for(const v in this.indexes){const E=this.indexes[v],P={};for(const z in E){const N=E[z];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+p),P[N.tileID.key]=N}this.indexes[v]=P}this.lng=l}addBucket(l,p,v){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let P=0;P<p.symbolInstances.length;P++)p.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const E=this.usedCrossTileIDs[l.overscaledZ];for(const P in this.indexes){const z=this.indexes[P];if(Number(P)>l.overscaledZ)for(const N in z){const G=z[N];G.tileID.isChildOf(l)&&G.findMatches(p.symbolInstances,l,E)}else{const N=z[l.scaledTo(Number(P)).key];N&&N.findMatches(p.symbolInstances,l,E)}}for(let P=0;P<p.symbolInstances.length;P++){const z=p.symbolInstances.get(P);z.crossTileID||(z.crossTileID=v.generate(),E[z.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new It(l,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(l,p){for(const v in p.indexedSymbolInstances)for(const E of p.indexedSymbolInstances[v])delete this.usedCrossTileIDs[l][E.crossTileID]}removeStaleBuckets(l){let p=!1;for(const v in this.indexes){const E=this.indexes[v];for(const P in E)l[E[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,E[P]),delete E[P],p=!0)}return p}}class Vt{constructor(){this.layerIndexes={},this.crossTileIDs=new St,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,p,v){let E=this.layerIndexes[l.id];E===void 0&&(E=this.layerIndexes[l.id]=new Zt);let P=!1;const z={};E.handleWrapJump(v);for(const N of p){const G=N.getBucket(l);G&&l.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(N.tileID,G,this.crossTileIDs)&&(P=!0),z[G.bucketInstanceId]=!0)}return E.removeStaleBuckets(z)&&(P=!0),P}pruneUnusedLayers(l){const p={};l.forEach(v=>{p[v]=!0});for(const v in this.layerIndexes)p[v]||delete this.layerIndexes[v]}}var sn=a.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Wt extends a.Evented{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=l._cache.max,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const l in this._tiles){const p=this._tiles[l];p.textures.forEach(v=>v.destroy()),p.textures=[]}}update(l,p){this.sourceCache.update(l,p),this._renderableTilesKeys=[];for(const v of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:p}))this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.posMatrix=new Float64Array(16),a.ortho(v.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),this._tiles[v.key]=new hi(v,this.tileSize))}removeOutdated(l){const p={};this.renderHistory=this.renderHistory.filter((v,E)=>this.renderHistory.indexOf(v)===E).slice(0,this.renderHistorySize);for(const v of this._renderableTilesKeys)p[v]=!0;for(const v of this.renderHistory)p[v]=!0;for(const v in this._tiles)p[v]||(this._tiles[v].clearTextures(l),delete this._tiles[v])}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const p={};for(const v of this._renderableTilesKeys){const E=this._tiles[v].tileID;if(E.canonical.equals(l.canonical)){const P=l.clone();P.posMatrix=new Float64Array(16),a.ortho(P.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),p[v]=P}else if(E.canonical.isChildOf(l.canonical)){const P=l.clone();P.posMatrix=new Float64Array(16);const z=E.canonical.z-l.canonical.z,N=E.canonical.x-(E.canonical.x>>z<<z),G=E.canonical.y-(E.canonical.y>>z<<z),$=a.EXTENT>>z;a.ortho(P.posMatrix,0,$,0,$,0,1),a.translate(P.posMatrix,P.posMatrix,[-N*$,-G*$,0]),p[v]=P}else if(l.canonical.isChildOf(E.canonical)){const P=l.clone();P.posMatrix=new Float64Array(16);const z=l.canonical.z-E.canonical.z,N=l.canonical.x-(l.canonical.x>>z<<z),G=l.canonical.y-(l.canonical.y>>z<<z),$=a.EXTENT>>z;a.ortho(P.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),a.translate(P.posMatrix,P.posMatrix,[N*$,G*$,0]),a.scale(P.posMatrix,P.posMatrix,[1/2**z,1/2**z,0]),p[v]=P}}return p}getSourceTile(l,p){const v=this.sourceCache._source;let E=l.overscaledZ-this.deltaZoom;if(E>v.maxzoom&&(E=v.maxzoom),E<v.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(E).key);let P=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!P||!P.dem)&&p)for(;E>=v.minzoom&&(!P||!P.dem);)P=this.sourceCache.getTileByID(l.scaledTo(E--).key);return P}tilesAfterTime(l=Date.now()){return Object.values(this._tiles).filter(p=>p.timeLoaded>=l)}}class Xt{constructor(l,p,v){this.style=l,this.sourceCache=new Wt(p),this.options=v,this.exaggeration=typeof v.exaggeration=="number"?v.exaggeration:1,this.elevationOffset=typeof v.elevationOffset=="number"?v.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(l,p,v,E=a.EXTENT){if(!(p>=0&&p<E&&v>=0&&v<E))return this.elevationOffset;let P=0;const z=this.getTerrainData(l);if(z.tile&&z.tile.dem){const N=a.transformMat4$1([],[p/E*a.EXTENT,v/E*a.EXTENT],z.u_terrain_matrix),G=[N[0]*z.tile.dem.dim,N[1]*z.tile.dem.dim],$=[Math.floor(G[0]),Math.floor(G[1])],K=z.tile.dem.get($[0],$[1]),se=z.tile.dem.get($[0],$[1]+1),ce=z.tile.dem.get($[0]+1,$[1]),xe=z.tile.dem.get($[0]+1,$[1]+1);P=a.number(a.number(K,se,G[0]-$[0]),a.number(ce,xe,G[0]-$[0]),G[1]-$[1])}return P}rememberForRerender(l,p){for(const v in this.sourceCache._tiles){const E=this.sourceCache._tiles[v];(E.tileID.equals(p)||E.tileID.isChildOf(p))&&(l===this.sourceCache.sourceCache.id&&(E.timeLoaded=Date.now()),this._rerender[l]=this._rerender[l]||{},this._rerender[l][E.tileID.key]=!0)}}needsRerender(l,p){return this._rerender[l]&&this._rerender[l][p.key]}clearRerenderCache(){this._rerender={}}getElevation(l,p,v,E=a.EXTENT){return(this.getDEMElevation(l,p,v,E)+this.elevationOffset)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const E=this.style.map.painter.context,P=new a.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new te(E,P,E.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new te(E,new a.RGBAImage({width:1,height:1}),E.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(E.gl.NEAREST,E.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.identity([])}const p=this.sourceCache.getSourceTile(l,!0);if(p&&p.dem&&(!p.demTexture||p.needsTerrainPrepare)){const E=this.style.map.painter.context;p.demTexture=this.style.map.painter.getTileTexture(p.dem.stride),p.demTexture?p.demTexture.update(p.dem.getPixels(),{premultiply:!1}):p.demTexture=new te(E,p.dem.getPixels(),E.gl.RGBA,{premultiply:!1}),p.demTexture.bind(E.gl.NEAREST,E.gl.CLAMP_TO_EDGE),p.needsTerrainPrepare=!1}const v=p&&p+p.tileID.key+l.key;if(v&&!this._demMatrixCache[v]){const E=this.sourceCache.sourceCache._source.maxzoom;let P=l.canonical.z-p.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=E?P=l.canonical.z-E:a.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const z=l.canonical.x-(l.canonical.x>>P<<P),N=l.canonical.y-(l.canonical.y>>P<<P),G=a.fromScaling(new Float64Array(16),[1/(a.EXTENT<<P),1/(a.EXTENT<<P),0]);a.translate(G,G,[z*a.EXTENT,N*a.EXTENT,0]),this._demMatrixCache[l.key]={matrix:G,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:p&&p.dem&&p.dem.dim||1,u_terrain_matrix:v?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:p&&p.dem&&p.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(p&&p.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:p}}getRTTFramebuffer(){const l=this.style.map.painter;if(!this._rttFramebuffer){const p=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=l.context.createFramebuffer(p,p,!0),this._rttFramebuffer.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,p,p))}return this._rttFramebuffer}getFramebuffer(l){const p=this.style.map.painter,v=p.width/devicePixelRatio,E=p.height/devicePixelRatio;return!this._fbo||this._fbo.width===v&&this._fbo.height===E||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new te(p.context,{width:v,height:E,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new te(p.context,{width:v,height:E,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=p.context.createFramebuffer(v,E,!0),this._fbo.depthAttachment.set(p.context.createRenderbuffer(p.context.gl.DEPTH_COMPONENT16,v,E))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const p=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let P=0,z=0;P<this._coordsTextureSize;P++)for(let N=0;N<this._coordsTextureSize;N++,z+=4)p[z+0]=255&N,p[z+1]=255&P,p[z+2]=N>>8<<4|P>>8,p[z+3]=0;const v=new a.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(p.buffer)),E=new te(l,v,l.gl.RGBA,{premultiply:!1});return E.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=E,E}pointCoordinate(l){const p=new Uint8Array(4),v=this.style.map.painter,E=v.context,P=E.gl;E.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),P.readPixels(l.x,v.height/devicePixelRatio-l.y-1,1,1,P.RGBA,P.UNSIGNED_BYTE,p),E.bindFramebuffer.set(null);const z=p[0]+(p[2]>>4<<8),N=p[1]+((15&p[2])<<8),G=this.coordsIndex[255-p[3]],$=G&&this.sourceCache.getTileByID(G);if(!$)return null;const K=this._coordsTextureSize,se=(1<<$.tileID.canonical.z)*K;return new a.MercatorCoordinate(($.tileID.canonical.x*K+z)/se,($.tileID.canonical.y*K+N)/se,this.getElevation($.tileID,z,N,K))}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.style.map.painter.context,p=new a.PosArray,v=new a.TriangleIndexArray,E=this.meshSize,P=a.EXTENT/E,z=E*E;for(let N=0;N<=E;N++)for(let G=0;G<=E;G++)p.emplaceBack(G*P,N*P);for(let N=0;N<z;N+=E+1)for(let G=0;G<E;G++)v.emplaceBack(G+N,E+G+N+1,E+G+N+2),v.emplaceBack(G+N,E+G+N+2,G+N+1);return this._mesh={indexBuffer:l.createIndexBuffer(v),vertexBuffer:l.createVertexBuffer(p,sn.members),segments:a.SegmentVector.simpleSegment(0,0,p.length,v.length)},this._mesh}getMinMaxElevation(l){const p=this.getTerrainData(l).tile,v={minElevation:null,maxElevation:null};return p&&p.dem&&(v.minElevation=(p.dem.min+this.elevationOffset)*this.exaggeration,v.maxElevation=(p.dem.max+this.elevationOffset)*this.exaggeration),v}}const yn=(b,l)=>a.emitValidationErrors(b,l&&l.filter(p=>p.identifier!=="source.canvas")),Mn=a.pick(kn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Un=a.pick(kn,["setCenter","setZoom","setBearing","setPitch"]),Ut=function(){const b={},l=a.spec.$version;for(const p in a.spec.$root){const v=a.spec.$root[p];if(v.required){let E=null;E=p==="version"?l:v.type==="array"?[]:{},E!=null&&(b[p]=E)}}return b}();class ge extends a.Evented{constructor(l,p={}){super(),this.map=l,this.dispatcher=new st(Qn(),this),this.imageManager=new ne,this.imageManager.setEventedParent(this),this.glyphManager=new Te(l._requestManager,p.localIdeographFontFamily),this.lineAtlas=new ut(256,512),this.crossTileSymbolIndex=new Vt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const v=this;this._rtlTextPluginCallback=ge.registerForPluginStateChange(E=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},(P,z)=>{if(a.triggerPluginCompletionEvent(P),z&&z.every(N=>N))for(const N in v.sourceCaches)v.sourceCaches[N].reload()})}),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const P=this.sourceCaches[E.sourceId];if(!P)return;const z=P.getSource();if(z&&z.vectorLayerIds)for(const N in this._layers){const G=this._layers[N];G.source===z.id&&this._validateLayer(G)}})}loadURL(l,p={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const v=typeof p.validate!="boolean"||p.validate,E=this.map._requestManager.transformRequest(l,a.ResourceType.Style);this._request=a.getJSON(E,(P,z)=>{this._request=null,P?this.fire(new a.ErrorEvent(P)):z&&this._load(z,v)})}loadJSON(l,p={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(l,p.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Ut,!1)}_load(l,p){if(p&&yn(this,a.validateStyle(l)))return;this._loaded=!0,this.stylesheet=l;for(const E in l.sources)this.addSource(E,l.sources[E],{validate:!1});l.sprite?this._loadSprite(l.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(l.glyphs);const v=hr(this.stylesheet.layers);this._order=v.map(E=>E.id),this._layers={},this._serializedLayers={};for(let E of v)E=a.createStyleLayer(E),E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new nt(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}_loadSprite(l){this._spriteRequest=function(p,v,E,P){let z,N,G;const $=E>1?"@2x":"";let K=a.getJSON(v.transformRequest(v.normalizeSpriteURL(p,$,".json"),a.ResourceType.SpriteJSON),(xe,ve)=>{K=null,G||(G=xe,z=ve,ce())}),se=a.getImage(v.transformRequest(v.normalizeSpriteURL(p,$,".png"),a.ResourceType.SpriteImage),(xe,ve)=>{se=null,G||(G=xe,N=ve,ce())});function ce(){if(G)P(G);else if(z&&N){const xe=a.exported.getImageData(N),ve={};for(const le in z){const{width:ye,height:ze,x:Ge,y:Se,sdf:Ze,pixelRatio:je,stretchX:tt,stretchY:Ke,content:d}=z[le],A=new a.RGBAImage({width:ye,height:ze});a.RGBAImage.copy(xe,A,{x:Ge,y:Se},{x:0,y:0},{width:ye,height:ze}),ve[le]={data:A,pixelRatio:je,sdf:Ze,stretchX:tt,stretchY:Ke,content:d}}P(null,ve)}}return{cancel(){K&&(K.cancel(),K=null),se&&(se.cancel(),se=null)}}}(l,this.map._requestManager,this.map.getPixelRatio(),(p,v)=>{if(this._spriteRequest=null,p)this.fire(new a.ErrorEvent(p));else if(v)for(const E in v)this.imageManager.addImage(E,v[E]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(l){const p=this.sourceCaches[l.source];if(!p)return;const v=l.sourceLayer;if(!v)return;const E=p.getSource();(E.type==="geojson"||E.vectorLayerIds&&E.vectorLayerIds.indexOf(v)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${v}" does not exist on source "${E.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const p=[];for(const v of l){const E=this._layers[v];E.type!=="custom"&&p.push(E.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const p=this._changed;if(this._changed){const E=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(E.length||P.length)&&this._updateWorkerLayers(E,P);for(const z in this._updatedSources){const N=this._updatedSources[z];if(N==="reload")this._reloadSource(z);else{if(N!=="clear")throw new Error(`Invalid action ${N}`);this._clearSource(z)}}this._updateTilesForChangedImages();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}const v={};for(const E in this.sourceCaches){const P=this.sourceCaches[E];v[E]=P.used,P.used=!1}for(const E of this._order){const P=this._layers[E];P.recalculate(l,this._availableImages),!P.isHidden(l.zoom)&&P.source&&(this.sourceCaches[P.source].used=!0)}for(const E in v){const P=this.sourceCaches[E];v[E]!==P.used&&P.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E}))}this.light.recalculate(l),this.z=l.zoom,p&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(l){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),l){const p=this.sourceCaches[l.source];if(!p)throw new Error(`cannot load terrain, because there exists no source with ID: ${l.source}`);this.terrain=new Xt(this,p,l),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=v=>{v.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=v=>{v.tile&&(v.sourceId===l.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(v.sourceId,v.tile.tileID)):v.source.type==="geojson"&&this.terrain.rememberForRerender(v.sourceId,v.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new a.Event("terrain",{terrain:l}))}setState(l){if(this._checkLoaded(),yn(this,a.validateStyle(l)))return!1;(l=a.clone$1(l)).layers=hr(l.layers);const p=function(E,P){if(!E)return[{command:kn.setStyle,args:[P]}];let z=[];try{if(!R(E.version,P.version))return[{command:kn.setStyle,args:[P]}];R(E.center,P.center)||z.push({command:kn.setCenter,args:[P.center]}),R(E.zoom,P.zoom)||z.push({command:kn.setZoom,args:[P.zoom]}),R(E.bearing,P.bearing)||z.push({command:kn.setBearing,args:[P.bearing]}),R(E.pitch,P.pitch)||z.push({command:kn.setPitch,args:[P.pitch]}),R(E.sprite,P.sprite)||z.push({command:kn.setSprite,args:[P.sprite]}),R(E.glyphs,P.glyphs)||z.push({command:kn.setGlyphs,args:[P.glyphs]}),R(E.transition,P.transition)||z.push({command:kn.setTransition,args:[P.transition]}),R(E.light,P.light)||z.push({command:kn.setLight,args:[P.light]});const N={},G=[];(function(K,se,ce,xe){let ve;for(ve in se=se||{},K=K||{})Object.prototype.hasOwnProperty.call(K,ve)&&(Object.prototype.hasOwnProperty.call(se,ve)||Yn(ve,ce,xe));for(ve in se)Object.prototype.hasOwnProperty.call(se,ve)&&(Object.prototype.hasOwnProperty.call(K,ve)?R(K[ve],se[ve])||(K[ve].type==="geojson"&&se[ve].type==="geojson"&&vo(K,se,ve)?ce.push({command:kn.setGeoJSONSourceData,args:[ve,se[ve].data]}):Wr(ve,se,ce,xe)):fr(ve,se,ce))})(E.sources,P.sources,G,N);const $=[];E.layers&&E.layers.forEach(K=>{N[K.source]?z.push({command:kn.removeLayer,args:[K.id]}):$.push(K)}),z=z.concat(G),function(K,se,ce){se=se||[];const xe=(K=K||[]).map(Lr),ve=se.map(Lr),le=K.reduce(xo,{}),ye=se.reduce(xo,{}),ze=xe.slice(),Ge=Object.create(null);let Se,Ze,je,tt,Ke,d,A;for(Se=0,Ze=0;Se<xe.length;Se++)je=xe[Se],Object.prototype.hasOwnProperty.call(ye,je)?Ze++:(ce.push({command:kn.removeLayer,args:[je]}),ze.splice(ze.indexOf(je,Ze),1));for(Se=0,Ze=0;Se<ve.length;Se++)je=ve[ve.length-1-Se],ze[ze.length-1-Se]!==je&&(Object.prototype.hasOwnProperty.call(le,je)?(ce.push({command:kn.removeLayer,args:[je]}),ze.splice(ze.lastIndexOf(je,ze.length-Ze),1)):Ze++,d=ze[ze.length-Se],ce.push({command:kn.addLayer,args:[ye[je],d]}),ze.splice(ze.length-Se,0,je),Ge[je]=!0);for(Se=0;Se<ve.length;Se++)if(je=ve[Se],tt=le[je],Ke=ye[je],!Ge[je]&&!R(tt,Ke))if(R(tt.source,Ke.source)&&R(tt["source-layer"],Ke["source-layer"])&&R(tt.type,Ke.type)){for(A in rr(tt.layout,Ke.layout,ce,je,null,kn.setLayoutProperty),rr(tt.paint,Ke.paint,ce,je,null,kn.setPaintProperty),R(tt.filter,Ke.filter)||ce.push({command:kn.setFilter,args:[je,Ke.filter]}),R(tt.minzoom,Ke.minzoom)&&R(tt.maxzoom,Ke.maxzoom)||ce.push({command:kn.setLayerZoomRange,args:[je,Ke.minzoom,Ke.maxzoom]}),tt)Object.prototype.hasOwnProperty.call(tt,A)&&A!=="layout"&&A!=="paint"&&A!=="filter"&&A!=="metadata"&&A!=="minzoom"&&A!=="maxzoom"&&(A.indexOf("paint.")===0?rr(tt[A],Ke[A],ce,je,A.slice(6),kn.setPaintProperty):R(tt[A],Ke[A])||ce.push({command:kn.setLayerProperty,args:[je,A,Ke[A]]}));for(A in Ke)Object.prototype.hasOwnProperty.call(Ke,A)&&!Object.prototype.hasOwnProperty.call(tt,A)&&A!=="layout"&&A!=="paint"&&A!=="filter"&&A!=="metadata"&&A!=="minzoom"&&A!=="maxzoom"&&(A.indexOf("paint.")===0?rr(tt[A],Ke[A],ce,je,A.slice(6),kn.setPaintProperty):R(tt[A],Ke[A])||ce.push({command:kn.setLayerProperty,args:[je,A,Ke[A]]}))}else ce.push({command:kn.removeLayer,args:[je]}),d=ze[ze.lastIndexOf(je)+1],ce.push({command:kn.addLayer,args:[Ke,d]})}($,P.layers,z)}catch(N){console.warn("Unable to compute style diff:",N),z=[{command:kn.setStyle,args:[P]}]}return z}(this.serialize(),l).filter(E=>!(E.command in Un));if(p.length===0)return!1;const v=p.filter(E=>!(E.command in Mn));if(v.length>0)throw new Error(`Unimplemented: ${v.map(E=>E.command).join(", ")}.`);return p.forEach(E=>{E.command!=="setTransition"&&this[E.command].apply(this,E.args)}),this.stylesheet=l,!0}addImage(l,p){if(this.getImage(l))return this.fire(new a.ErrorEvent(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,p),this._afterImageUpdated(l)}updateImage(l,p){this.imageManager.updateImage(l,p)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new a.ErrorEvent(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,p,v={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(a.validateStyle.source,`sources.${l}`,p,null,v))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const E=this.sourceCaches[l]=new mt(l,p,this.dispatcher);E.style=this,E.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:E.serialize(),sourceId:l})),E.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===l)return this.fire(new a.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${v}" is using it.`)));const p=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],p.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),p.setEventedParent(null),p.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,p){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const v=this.sourceCaches[l].getSource();if(v.type!=="geojson")throw new Error(`geojsonSource.type is ${v.type}, which is !== 'geojson`);v.setData(p),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,p,v={}){this._checkLoaded();const E=l.id;if(this.getLayer(E))return void this.fire(new a.ErrorEvent(new Error(`Layer "${E}" already exists on this map.`)));let P;if(l.type==="custom"){if(yn(this,a.validateCustomStyleLayer(l)))return;P=a.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(E,l.source),l=a.clone$1(l),l=a.extend(l,{source:E})),this._validate(a.validateStyle.layer,`layers.${E}`,l,{arrayIndex:-1},v))return;P=a.createStyleLayer(l),this._validateLayer(P),P.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[P.id]=P.serialize()}const z=p?this._order.indexOf(p):this._order.length;if(p&&z===-1)this.fire(new a.ErrorEvent(new Error(`Cannot add layer "${E}" before non-existing layer "${p}".`)));else{if(this._order.splice(z,0,E),this._layerOrderChanged=!0,this._layers[E]=P,this._removedLayers[E]&&P.source&&P.type!=="custom"){const N=this._removedLayers[E];delete this._removedLayers[E],N.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",this.sourceCaches[P.source].pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map)}}moveLayer(l,p){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new a.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===p)return;const v=this._order.indexOf(l);this._order.splice(v,1);const E=p?this._order.indexOf(p):this._order.length;p&&E===-1?this.fire(new a.ErrorEvent(new Error(`Cannot move layer "${l}" before non-existing layer "${p}".`))):(this._order.splice(E,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const p=this._layers[l];if(!p)return void this.fire(new a.ErrorEvent(new Error(`Cannot remove non-existing layer "${l}".`)));p.setEventedParent(null);const v=this._order.indexOf(l);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=p,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],p.onRemove&&p.onRemove(this.map)}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,p,v){this._checkLoaded();const E=this.getLayer(l);E?E.minzoom===p&&E.maxzoom===v||(p!=null&&(E.minzoom=p),v!=null&&(E.maxzoom=v),this._updateLayer(E)):this.fire(new a.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,p,v={}){this._checkLoaded();const E=this.getLayer(l);if(E){if(!R(E.filter,p))return p==null?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(a.validateStyle.filter,`layers.${E.id}.filter`,p,null,v)||(E.filter=a.clone$1(p),this._updateLayer(E)))}else this.fire(new a.ErrorEvent(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return a.clone$1(this.getLayer(l).filter)}setLayoutProperty(l,p,v,E={}){this._checkLoaded();const P=this.getLayer(l);P?R(P.getLayoutProperty(p),v)||(P.setLayoutProperty(p,v,E),this._updateLayer(P)):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,p){const v=this.getLayer(l);if(v)return v.getLayoutProperty(p);this.fire(new a.ErrorEvent(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,p,v,E={}){this._checkLoaded();const P=this.getLayer(l);P?R(P.getPaintProperty(p),v)||(P.setPaintProperty(p,v,E)&&this._updateLayer(P),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,p){return this.getLayer(l).getPaintProperty(p)}setFeatureState(l,p){this._checkLoaded();const v=l.source,E=l.sourceLayer,P=this.sourceCaches[v];if(P===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const z=P.getSource().type;z==="geojson"&&E?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||E?(l.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),P.setFeatureState(E,l.id,p)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,p){this._checkLoaded();const v=l.source,E=this.sourceCaches[v];if(E===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const P=E.getSource().type,z=P==="vector"?l.sourceLayer:void 0;P!=="vector"||z?p&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):E.removeFeatureState(z,l.id,p):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const p=l.source,v=l.sourceLayer,E=this.sourceCaches[p];if(E!==void 0)return E.getSource().type!=="vector"||v?(l.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),E.getFeatureState(v,l.id)):void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,l=>l.serialize()),layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(l){const p=z=>this._layers[z].type==="fill-extrusion",v={},E=[];for(let z=this._order.length-1;z>=0;z--){const N=this._order[z];if(p(N)){v[N]=z;for(const G of l){const $=G[N];if($)for(const K of $)E.push(K)}}}E.sort((z,N)=>N.intersectionZ-z.intersectionZ);const P=[];for(let z=this._order.length-1;z>=0;z--){const N=this._order[z];if(p(N))for(let G=E.length-1;G>=0;G--){const $=E[G].feature;if(v[$.layer.id]<z)break;P.push($),E.pop()}else for(const G of l){const $=G[N];if($)for(const K of $)P.push(K.feature)}}return P}queryRenderedFeatures(l,p,v){p&&p.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",p.filter,null,p);const E={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of p.layers){const N=this._layers[z];if(!N)return this.fire(new a.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];E[N.source]=!0}}const P=[];p.availableImages=this._availableImages;for(const z in this.sourceCaches)p.layers&&!E[z]||P.push(di(this.sourceCaches[z],this._layers,this._serializedLayers,l,p,v));return this.placement&&P.push(function(z,N,G,$,K,se,ce){const xe={},ve=se.queryRenderedSymbols($),le=[];for(const ye of Object.keys(ve).map(Number))le.push(ce[ye]);le.sort(ii);for(const ye of le){const ze=ye.featureIndex.lookupSymbolFeatures(ve[ye.bucketInstanceId],N,ye.bucketIndex,ye.sourceLayerIndex,K.filter,K.layers,K.availableImages,z);for(const Ge in ze){const Se=xe[Ge]=xe[Ge]||[],Ze=ze[Ge];Ze.sort((je,tt)=>{const Ke=ye.featureSortOrder;if(Ke){const d=Ke.indexOf(je.featureIndex);return Ke.indexOf(tt.featureIndex)-d}return tt.featureIndex-je.featureIndex});for(const je of Ze)Se.push(je)}}for(const ye in xe)xe[ye].forEach(ze=>{const Ge=ze.feature,Se=G[z[ye].source].getFeatureState(Ge.layer["source-layer"],Ge.id);Ge.source=Ge.layer.source,Ge.layer["source-layer"]&&(Ge.sourceLayer=Ge.layer["source-layer"]),Ge.state=Se});return xe}(this._layers,this._serializedLayers,this.sourceCaches,l,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(l,p){p&&p.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",p.filter,null,p);const v=this.sourceCaches[l];return v?function(E,P){const z=E.getRenderableIds().map($=>E.getTileByID($)),N=[],G={};for(let $=0;$<z.length;$++){const K=z[$],se=K.tileID.canonical.key;G[se]||(G[se]=!0,K.querySourceFeatures(N,P))}return N}(v,p):[]}addSourceType(l,p,v){return ge.getSourceType(l)?v(new Error(`A source type called "${l}" already exists.`)):(ge.setSourceType(l,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:p.workerSourceURL},v):v(null,null))}getLight(){return this.light.getLight()}setLight(l,p={}){this._checkLoaded();const v=this.light.getLight();let E=!1;for(const z in l)if(!R(l[z],v[z])){E=!0;break}if(!E)return;const P={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,p),this.light.updateTransitions(P)}_validate(l,p,v,E,P={}){return(!P||P.validate!==!1)&&yn(this,l.call(a.validateStyle,a.extend({key:p,style:this.serialize(),value:v,styleSpec:a.spec},E)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const p=this.sourceCaches[l];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const p in this.sourceCaches)this.sourceCaches[p].update(l,this.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,p,v,E,P=!1){let z=!1,N=!1;const G={};for(const $ of this._order){const K=this._layers[$];if(K.type!=="symbol")continue;if(!G[K.source]){const ce=this.sourceCaches[K.source];G[K.source]=ce.getRenderableIds(!0).map(xe=>ce.getTileByID(xe)).sort((xe,ve)=>ve.tileID.overscaledZ-xe.tileID.overscaledZ||(xe.tileID.isLessThan(ve.tileID)?-1:1))}const se=this.crossTileSymbolIndex.addLayer(K,G[K.source],l.center.lng);z=z||se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((P=P||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),l.zoom))&&(this.pauseablePlacement=new Ue(l,this.terrain,this._order,P,p,v,E,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,G),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),N=!0),z&&this.pauseablePlacement.placement.setStale()),N||z)for(const $ of this._order){const K=this._layers[$];K.type==="symbol"&&this.placement.updateLayerOpacities(K,G[K.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,p,v){this.imageManager.getImages(p.icons,v),this._updateTilesForChangedImages();const E=this.sourceCaches[p.source];E&&E.setDependencies(p.tileID.key,p.type,p.icons)}getGlyphs(l,p,v){this.glyphManager.getGlyphs(p.stacks,v)}getResource(l,p,v){return a.makeRequest(p,v)}}ge.getSourceType=function(b){return Tn[b]},ge.setSourceType=function(b,l){Tn[b]=l},ge.registerForPluginStateChange=a.registerForPluginStateChange;var en="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Wi={prelude:Vn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Vn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Vn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Vn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Vn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Vn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Vn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Vn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Vn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Vn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Vn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Vn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Vn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Vn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Vn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Vn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Vn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Vn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Vn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Vn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Vn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Vn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Vn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Vn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Vn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Vn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",en),terrainDepth:Vn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",en),terrainCoords:Vn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",en)};function Vn(b,l){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=l.match(/attribute ([\w]+) ([\w]+)/g),E=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=P?P.concat(E):E,N={};return{fragmentSource:b=b.replace(p,(G,$,K,se,ce)=>(N[ce]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
varying ${K} ${se} ${ce};
#else
uniform ${K} ${se} u_${ce};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ce}
    ${K} ${se} ${ce} = u_${ce};
#endif
`)),vertexSource:l=l.replace(p,(G,$,K,se,ce)=>{const xe=se==="float"?"vec2":"vec4",ve=ce.match(/color/)?"color":xe;return N[ce]?$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${K} ${xe} a_${ce};
varying ${K} ${se} ${ce};
#else
uniform ${K} ${se} u_${ce};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = a_${ce};
#else
    ${K} ${se} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = unpack_mix_${ve}(a_${ce}, u_${ce}_t);
#else
    ${K} ${se} ${ce} = u_${ce};
#endif
`:$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${K} ${xe} a_${ce};
#else
uniform ${K} ${se} u_${ce};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${K} ${se} ${ce} = a_${ce};
#else
    ${K} ${se} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${K} ${se} ${ce} = unpack_mix_${ve}(a_${ce}, u_${ce}_t);
#else
    ${K} ${se} ${ce} = u_${ce};
#endif
`}),staticAttributes:v,staticUniforms:z}}class Wo{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,p,v,E,P,z,N,G,$){this.context=l;let K=this.boundPaintVertexBuffers.length!==E.length;for(let se=0;!K&&se<E.length;se++)this.boundPaintVertexBuffers[se]!==E[se]&&(K=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===v&&!K&&this.boundIndexBuffer===P&&this.boundVertexOffset===z&&this.boundDynamicVertexBuffer===N&&this.boundDynamicVertexBuffer2===G&&this.boundDynamicVertexBuffer3===$?(l.bindVertexArrayOES.set(this.vao),N&&N.bind(),P&&P.dynamicDraw&&P.bind(),G&&G.bind(),$&&$.bind()):this.freshBind(p,v,E,P,z,N,G,$)}freshBind(l,p,v,E,P,z,N,G){let $;const K=l.numAttributes,se=this.context,ce=se.gl;if(se.extVertexArrayObject)this.vao&&this.destroy(),this.vao=se.extVertexArrayObject.createVertexArrayOES(),se.bindVertexArrayOES.set(this.vao),$=0,this.boundProgram=l,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=E,this.boundVertexOffset=P,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=N,this.boundDynamicVertexBuffer3=G;else{$=se.currentNumAttributes||0;for(let xe=K;xe<$;xe++)ce.disableVertexAttribArray(xe)}p.enableAttributes(ce,l);for(const xe of v)xe.enableAttributes(ce,l);z&&z.enableAttributes(ce,l),N&&N.enableAttributes(ce,l),G&&G.enableAttributes(ce,l),p.bind(),p.setVertexAttribPointers(ce,l,P);for(const xe of v)xe.bind(),xe.setVertexAttribPointers(ce,l,P);z&&(z.bind(),z.setVertexAttribPointers(ce,l,P)),E&&E.bind(),N&&(N.bind(),N.setVertexAttribPointers(ce,l,P)),G&&(G.bind(),G.setVertexAttribPointers(ce,l,P)),se.currentNumAttributes=K}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function $o(b){const l=[];for(let p=0;p<b.length;p++){if(b[p]===null)continue;const v=b[p].split(" ");l.push(v.pop())}return l}class wa{constructor(l,p,v,E,P,z,N){const G=l.gl;this.program=G.createProgram();const $=$o(v.staticAttributes),K=E?E.getBinderAttributes():[],se=$.concat(K),ce=Wi.prelude.staticUniforms?$o(Wi.prelude.staticUniforms):[],xe=v.staticUniforms?$o(v.staticUniforms):[],ve=E?E.getBinderUniforms():[],le=ce.concat(xe).concat(ve),ye=[];for(const Ke of le)ye.indexOf(Ke)<0&&ye.push(Ke);const ze=E?E.defines():[];z&&ze.push("#define OVERDRAW_INSPECTOR;"),N&&ze.push("#define TERRAIN3D;");const Ge=ze.concat(Wi.prelude.fragmentSource,v.fragmentSource).join(`
`),Se=ze.concat(Wi.prelude.vertexSource,v.vertexSource).join(`
`),Ze=G.createShader(G.FRAGMENT_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);G.shaderSource(Ze,Ge),G.compileShader(Ze),G.attachShader(this.program,Ze);const je=G.createShader(G.VERTEX_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);G.shaderSource(je,Se),G.compileShader(je),G.attachShader(this.program,je),this.attributes={};const tt={};this.numAttributes=se.length;for(let Ke=0;Ke<this.numAttributes;Ke++)se[Ke]&&(G.bindAttribLocation(this.program,Ke,se[Ke]),this.attributes[se[Ke]]=Ke);G.linkProgram(this.program),G.deleteShader(je),G.deleteShader(Ze);for(let Ke=0;Ke<ye.length;Ke++){const d=ye[Ke];if(d&&!tt[d]){const A=G.getUniformLocation(this.program,d);A&&(tt[d]=A)}}this.fixedUniforms=P(l,tt),this.terrainUniforms=((Ke,d)=>({u_depth:new a.Uniform1i(Ke,d.u_depth),u_terrain:new a.Uniform1i(Ke,d.u_terrain),u_terrain_dim:new a.Uniform1f(Ke,d.u_terrain_dim),u_terrain_matrix:new a.UniformMatrix4f(Ke,d.u_terrain_matrix),u_terrain_unpack:new a.Uniform4f(Ke,d.u_terrain_unpack),u_terrain_offset:new a.Uniform1f(Ke,d.u_terrain_offset),u_terrain_exaggeration:new a.Uniform1f(Ke,d.u_terrain_exaggeration)}))(l,tt),this.binderUniforms=E?E.getUniforms(l,tt):[]}draw(l,p,v,E,P,z,N,G,$,K,se,ce,xe,ve,le,ye,ze,Ge){const Se=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(v),l.setStencilMode(E),l.setColorMode(P),l.setCullFace(z),G){l.activeTexture.set(Se.TEXTURE2),Se.bindTexture(Se.TEXTURE_2D,G.depthTexture),l.activeTexture.set(Se.TEXTURE3),Se.bindTexture(Se.TEXTURE_2D,G.texture);for(const je in this.terrainUniforms)this.terrainUniforms[je].set(G[je])}for(const je in this.fixedUniforms)this.fixedUniforms[je].set(N[je]);le&&le.setUniforms(l,this.binderUniforms,xe,{zoom:ve});let Ze=0;switch(p){case Se.LINES:Ze=2;break;case Se.TRIANGLES:Ze=3;break;case Se.LINE_STRIP:Ze=1}for(const je of ce.get()){const tt=je.vaos||(je.vaos={});(tt[$]||(tt[$]=new Wo)).bind(l,this,K,le?le.getPaintVertexBuffers():[],se,je.vertexOffset,ye,ze,Ge),Se.drawElements(p,je.primitiveLength*Ze,Se.UNSIGNED_SHORT,je.primitiveOffset*Ze*2)}}}function de(b,l,p){const v=1/xi(p,1,l.transform.tileZoom),E=Math.pow(2,p.tileID.overscaledZ),P=p.tileSize*Math.pow(2,l.transform.tileZoom)/E,z=P*(p.tileID.canonical.x+p.tileID.wrap*E),N=P*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[v,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[z>>16,N>>16],u_pixel_coord_lower:[65535&z,65535&N]}}const wo=(b,l,p,v)=>{const E=l.style.light,P=E.properties.get("position"),z=[P.x,P.y,P.z],N=a.create$1();E.properties.get("anchor")==="viewport"&&a.fromRotation(N,-l.transform.angle),a.transformMat3(z,z,N);const G=E.properties.get("color");return{u_matrix:b,u_lightpos:z,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[G.r,G.g,G.b],u_vertical_gradient:+p,u_opacity:v}},fs=(b,l,p,v,E,P,z)=>a.extend(wo(b,l,p,v),de(P,l,z),{u_height_factor:-Math.pow(2,E.overscaledZ)/z.tileSize/8}),ba=b=>({u_matrix:b}),Ea=(b,l,p,v)=>a.extend(ba(b),de(p,l,v)),Ta=(b,l)=>({u_matrix:b,u_world:l}),rl=(b,l,p,v,E)=>a.extend(Ea(b,l,p,v),{u_world:E}),sl=(b,l,p,v)=>{const E=b.transform;let P,z;if(v.paint.get("circle-pitch-alignment")==="map"){const N=xi(p,1,E.zoom);P=!0,z=[N,N]}else P=!1,z=E.pixelsToGLUnits;return{u_camera_to_center_distance:E.cameraToCenterDistance,u_scale_with_map:+(v.paint.get("circle-pitch-scale")==="map"),u_matrix:b.translatePosMatrix(l.posMatrix,p,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_pitch_with_map:+P,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:z}},ks=(b,l,p)=>{const v=xi(p,1,l.zoom),E=Math.pow(2,l.zoom-p.tileID.overscaledZ),P=p.tileID.overscaleFactor();return{u_matrix:b,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:v,u_extrude_scale:[l.pixelsToGLUnits[0]/(v*E),l.pixelsToGLUnits[1]/(v*E)],u_overscale_factor:P}},ue=(b,l,p=1)=>({u_matrix:b,u_color:l,u_overlay:0,u_overlay_scale:p}),me=b=>({u_matrix:b}),Ie=(b,l,p,v)=>({u_matrix:b,u_extrude_scale:xi(l,1,p),u_intensity:v});function Xe(b,l){const p=Math.pow(2,l.canonical.z),v=l.canonical.y;return[new a.MercatorCoordinate(0,v/p).toLngLat().lat,new a.MercatorCoordinate(0,(v+1)/p).toLngLat().lat]}const pt=(b,l,p,v)=>{const E=b.transform;return{u_matrix:Mi(b,l,p,v),u_ratio:1/xi(l,1,E.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Nt=(b,l,p,v,E)=>a.extend(pt(b,l,p,E),{u_image:0,u_image_height:v}),vn=(b,l,p,v,E)=>{const P=b.transform,z=xn(l,P);return{u_matrix:Mi(b,l,p,E),u_texsize:l.imageAtlasTexture.size,u_ratio:1/xi(l,1,P.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[z,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},pi=(b,l,p,v,E,P)=>{const z=b.lineAtlas,N=xn(l,b.transform),G=p.layout.get("line-cap")==="round",$=z.getDash(v.from,G),K=z.getDash(v.to,G),se=$.width*E.fromScale,ce=K.width*E.toScale;return a.extend(pt(b,l,p,P),{u_patternscale_a:[N/se,-$.height/2],u_patternscale_b:[N/ce,-K.height/2],u_sdfgamma:z.width/(256*Math.min(se,ce)*b.pixelRatio)/2,u_image:0,u_tex_y_a:$.y,u_tex_y_b:K.y,u_mix:E.t})};function xn(b,l){return 1/xi(b,1,l.tileZoom)}function Mi(b,l,p,v){return b.translatePosMatrix(v?v.posMatrix:l.tileID.posMatrix,l,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}const zn=(b,l,p,v,E)=>{return{u_matrix:b,u_tl_parent:l,u_scale_parent:p,u_buffer_scale:1,u_fade_t:v.mix,u_opacity:v.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(z=E.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(P=E.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:h0(E.paint.get("raster-hue-rotate"))};var P,z};function h0(b){b*=Math.PI/180;const l=Math.sin(b),p=Math.cos(b);return[(2*p+1)/3,(-Math.sqrt(3)*l-p+1)/3,(Math.sqrt(3)*l-p+1)/3]}const f0=(b,l,p,v,E,P,z,N,G,$)=>{const K=E.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:K.width/K.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:z,u_coord_matrix:N,u_is_text:+G,u_pitch_with_map:+v,u_texsize:$,u_texture:0}},A0=(b,l,p,v,E,P,z,N,G,$,K)=>{const se=E.transform;return a.extend(f0(b,l,p,v,E,P,z,N,G,$),{u_gamma_scale:v?Math.cos(se._pitch)*se.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:+K})},ku=(b,l,p,v,E,P,z,N,G,$)=>a.extend(A0(b,l,p,v,E,P,z,N,!0,G,!0),{u_texsize_icon:$,u_texture_icon:1}),U1=(b,l,p)=>({u_matrix:b,u_opacity:l,u_color:p}),Lu=(b,l,p,v,E,P)=>a.extend(function(z,N,G,$){const K=G.imageManager.getPattern(z.from.toString()),se=G.imageManager.getPattern(z.to.toString()),{width:ce,height:xe}=G.imageManager.getPixelSize(),ve=Math.pow(2,$.tileID.overscaledZ),le=$.tileSize*Math.pow(2,G.transform.tileZoom)/ve,ye=le*($.tileID.canonical.x+$.tileID.wrap*ve),ze=le*$.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:K.tl,u_pattern_br_a:K.br,u_pattern_tl_b:se.tl,u_pattern_br_b:se.br,u_texsize:[ce,xe],u_mix:N.t,u_pattern_size_a:K.displaySize,u_pattern_size_b:se.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/xi($,1,G.transform.tileZoom),u_pixel_coord_upper:[ye>>16,ze>>16],u_pixel_coord_lower:[65535&ye,65535&ze]}}(v,P,p,E),{u_matrix:b,u_opacity:l}),ol={fillExtrusion:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_lightpos:new a.Uniform3f(b,l.u_lightpos),u_lightintensity:new a.Uniform1f(b,l.u_lightintensity),u_lightcolor:new a.Uniform3f(b,l.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,l.u_vertical_gradient),u_opacity:new a.Uniform1f(b,l.u_opacity)}),fillExtrusionPattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_lightpos:new a.Uniform3f(b,l.u_lightpos),u_lightintensity:new a.Uniform1f(b,l.u_lightintensity),u_lightcolor:new a.Uniform3f(b,l.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,l.u_vertical_gradient),u_height_factor:new a.Uniform1f(b,l.u_height_factor),u_image:new a.Uniform1i(b,l.u_image),u_texsize:new a.Uniform2f(b,l.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,l.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,l.u_scale),u_fade:new a.Uniform1f(b,l.u_fade),u_opacity:new a.Uniform1f(b,l.u_opacity)}),fill:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),fillPattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_image:new a.Uniform1i(b,l.u_image),u_texsize:new a.Uniform2f(b,l.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,l.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,l.u_scale),u_fade:new a.Uniform1f(b,l.u_fade)}),fillOutline:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_world:new a.Uniform2f(b,l.u_world)}),fillOutlinePattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_world:new a.Uniform2f(b,l.u_world),u_image:new a.Uniform1i(b,l.u_image),u_texsize:new a.Uniform2f(b,l.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,l.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,l.u_scale),u_fade:new a.Uniform1f(b,l.u_fade)}),circle:(b,l)=>({u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(b,l.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(b,l.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(b,l.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),collisionBox:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(b,l.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(b,l.u_extrude_scale),u_overscale_factor:new a.Uniform1f(b,l.u_overscale_factor)}),collisionCircle:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_inv_matrix:new a.UniformMatrix4f(b,l.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(b,l.u_viewport_size)}),debug:(b,l)=>({u_color:new a.UniformColor(b,l.u_color),u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_overlay:new a.Uniform1i(b,l.u_overlay),u_overlay_scale:new a.Uniform1f(b,l.u_overlay_scale)}),clippingMask:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),heatmap:(b,l)=>({u_extrude_scale:new a.Uniform1f(b,l.u_extrude_scale),u_intensity:new a.Uniform1f(b,l.u_intensity),u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),heatmapTexture:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_world:new a.Uniform2f(b,l.u_world),u_image:new a.Uniform1i(b,l.u_image),u_color_ramp:new a.Uniform1i(b,l.u_color_ramp),u_opacity:new a.Uniform1f(b,l.u_opacity)}),hillshade:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_image:new a.Uniform1i(b,l.u_image),u_latrange:new a.Uniform2f(b,l.u_latrange),u_light:new a.Uniform2f(b,l.u_light),u_shadow:new a.UniformColor(b,l.u_shadow),u_highlight:new a.UniformColor(b,l.u_highlight),u_accent:new a.UniformColor(b,l.u_accent)}),hillshadePrepare:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_image:new a.Uniform1i(b,l.u_image),u_dimension:new a.Uniform2f(b,l.u_dimension),u_zoom:new a.Uniform1f(b,l.u_zoom),u_unpack:new a.Uniform4f(b,l.u_unpack)}),line:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_ratio:new a.Uniform1f(b,l.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,l.u_units_to_pixels)}),lineGradient:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_ratio:new a.Uniform1f(b,l.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,l.u_units_to_pixels),u_image:new a.Uniform1i(b,l.u_image),u_image_height:new a.Uniform1f(b,l.u_image_height)}),linePattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_texsize:new a.Uniform2f(b,l.u_texsize),u_ratio:new a.Uniform1f(b,l.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_image:new a.Uniform1i(b,l.u_image),u_units_to_pixels:new a.Uniform2f(b,l.u_units_to_pixels),u_scale:new a.Uniform3f(b,l.u_scale),u_fade:new a.Uniform1f(b,l.u_fade)}),lineSDF:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_ratio:new a.Uniform1f(b,l.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,l.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(b,l.u_patternscale_a),u_patternscale_b:new a.Uniform2f(b,l.u_patternscale_b),u_sdfgamma:new a.Uniform1f(b,l.u_sdfgamma),u_image:new a.Uniform1i(b,l.u_image),u_tex_y_a:new a.Uniform1f(b,l.u_tex_y_a),u_tex_y_b:new a.Uniform1f(b,l.u_tex_y_b),u_mix:new a.Uniform1f(b,l.u_mix)}),raster:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_tl_parent:new a.Uniform2f(b,l.u_tl_parent),u_scale_parent:new a.Uniform1f(b,l.u_scale_parent),u_buffer_scale:new a.Uniform1f(b,l.u_buffer_scale),u_fade_t:new a.Uniform1f(b,l.u_fade_t),u_opacity:new a.Uniform1f(b,l.u_opacity),u_image0:new a.Uniform1i(b,l.u_image0),u_image1:new a.Uniform1i(b,l.u_image1),u_brightness_low:new a.Uniform1f(b,l.u_brightness_low),u_brightness_high:new a.Uniform1f(b,l.u_brightness_high),u_saturation_factor:new a.Uniform1f(b,l.u_saturation_factor),u_contrast_factor:new a.Uniform1f(b,l.u_contrast_factor),u_spin_weights:new a.Uniform3f(b,l.u_spin_weights)}),symbolIcon:(b,l)=>({u_is_size_zoom_constant:new a.Uniform1i(b,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,l.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,l.u_size_t),u_size:new a.Uniform1f(b,l.u_size),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,l.u_pitch),u_rotate_symbol:new a.Uniform1i(b,l.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,l.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,l.u_fade_change),u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,l.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,l.u_coord_matrix),u_is_text:new a.Uniform1i(b,l.u_is_text),u_pitch_with_map:new a.Uniform1i(b,l.u_pitch_with_map),u_texsize:new a.Uniform2f(b,l.u_texsize),u_texture:new a.Uniform1i(b,l.u_texture)}),symbolSDF:(b,l)=>({u_is_size_zoom_constant:new a.Uniform1i(b,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,l.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,l.u_size_t),u_size:new a.Uniform1f(b,l.u_size),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,l.u_pitch),u_rotate_symbol:new a.Uniform1i(b,l.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,l.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,l.u_fade_change),u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,l.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,l.u_coord_matrix),u_is_text:new a.Uniform1i(b,l.u_is_text),u_pitch_with_map:new a.Uniform1i(b,l.u_pitch_with_map),u_texsize:new a.Uniform2f(b,l.u_texsize),u_texture:new a.Uniform1i(b,l.u_texture),u_gamma_scale:new a.Uniform1f(b,l.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(b,l.u_is_halo)}),symbolTextAndIcon:(b,l)=>({u_is_size_zoom_constant:new a.Uniform1i(b,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,l.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,l.u_size_t),u_size:new a.Uniform1f(b,l.u_size),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,l.u_pitch),u_rotate_symbol:new a.Uniform1i(b,l.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,l.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,l.u_fade_change),u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,l.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,l.u_coord_matrix),u_is_text:new a.Uniform1i(b,l.u_is_text),u_pitch_with_map:new a.Uniform1i(b,l.u_pitch_with_map),u_texsize:new a.Uniform2f(b,l.u_texsize),u_texsize_icon:new a.Uniform2f(b,l.u_texsize_icon),u_texture:new a.Uniform1i(b,l.u_texture),u_texture_icon:new a.Uniform1i(b,l.u_texture_icon),u_gamma_scale:new a.Uniform1f(b,l.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(b,l.u_is_halo)}),background:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_opacity:new a.Uniform1f(b,l.u_opacity),u_color:new a.UniformColor(b,l.u_color)}),backgroundPattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_opacity:new a.Uniform1f(b,l.u_opacity),u_image:new a.Uniform1i(b,l.u_image),u_pattern_tl_a:new a.Uniform2f(b,l.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(b,l.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(b,l.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(b,l.u_pattern_br_b),u_texsize:new a.Uniform2f(b,l.u_texsize),u_mix:new a.Uniform1f(b,l.u_mix),u_pattern_size_a:new a.Uniform2f(b,l.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(b,l.u_pattern_size_b),u_scale_a:new a.Uniform1f(b,l.u_scale_a),u_scale_b:new a.Uniform1f(b,l.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(b,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,l.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(b,l.u_tile_units_to_pixels)}),terrain:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_texture:new a.Uniform1i(b,l.u_texture)}),terrainDepth:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),terrainCoords:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_texture:new a.Uniform1i(b,l.u_texture),u_terrain_coords_id:new a.Uniform1f(b,l.u_terrain_coords_id)})};class al{constructor(l,p,v){this.context=l;const E=l.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const p=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const fc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ac{constructor(l,p,v,E){this.length=p.length,this.attributes=v,this.itemSize=p.bytesPerElement,this.dynamicDraw=E,this.context=l;const P=l.gl;this.buffer=P.createBuffer(),l.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,p){for(let v=0;v<this.attributes.length;v++){const E=p.attributes[this.attributes[v].name];E!==void 0&&l.enableVertexAttribArray(E)}}setVertexAttribPointers(l,p,v){for(let E=0;E<this.attributes.length;E++){const P=this.attributes[E],z=p.attributes[P.name];z!==void 0&&l.vertexAttribPointer(z,P.components,l[fc[P.type]],!1,this.itemSize,P.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Gn{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class dc extends Gn{getDefault(){return a.Color.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Du extends Gn{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class ll extends Gn{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class cl extends Gn{getDefault(){return[!0,!0,!0,!0]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ru extends Gn{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class oi extends Gn{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class Xs extends Gn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const p=this.current;(l.func!==p.func||l.ref!==p.ref||l.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class $i extends Gn{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Sa extends Gn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=l,this.dirty=!1}}class d0 extends Gn{getDefault(){return[0,1]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class Ca extends Gn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=l,this.dirty=!1}}class p0 extends Gn{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class pc extends Gn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.BLEND):p.disable(p.BLEND),this.current=l,this.dirty=!1}}class mc extends Gn{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class ul extends Gn{getDefault(){return a.Color.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class hl extends Gn{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class bo extends Gn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=l,this.dirty=!1}}class qo extends Gn{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class zu extends Gn{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class m0 extends Gn{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class Zo extends Gn{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Eo extends Gn{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Bu extends Gn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Ou extends Gn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class fl extends Gn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class g0 extends Gn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class gc extends Gn{getDefault(){return null}set(l){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class _0 extends Gn{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class Pa extends Gn{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Fu extends Gn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Nu extends Gn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class y0 extends Gn{constructor(l,p){super(l),this.context=l,this.parent=p}getDefault(){return null}}class Xo extends y0{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Uu extends y0{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Ma{constructor(l,p,v,E){this.context=l,this.width=p,this.height=v;const P=l.gl,z=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new Xo(l,z),E&&(this.depthAttachment=new Uu(l,z)),P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,p=this.colorAttachment.get();if(p&&l.deleteTexture(p),this.depthAttachment){const v=this.depthAttachment.get();v&&l.deleteRenderbuffer(v)}l.deleteFramebuffer(this.framebuffer)}}class ui{constructor(l,p,v){this.blendFunction=l,this.blendColor=p,this.mask=v}}ui.Replace=[1,0],ui.disabled=new ui(ui.Replace,a.Color.transparent,[!1,!1,!1,!1]),ui.unblended=new ui(ui.Replace,a.Color.transparent,[!0,!0,!0,!0]),ui.alphaBlended=new ui([1,771],a.Color.transparent,[!0,!0,!0,!0]);class Al{constructor(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new dc(this),this.clearDepth=new Du(this),this.clearStencil=new ll(this),this.colorMask=new cl(this),this.depthMask=new Ru(this),this.stencilMask=new oi(this),this.stencilFunc=new Xs(this),this.stencilOp=new $i(this),this.stencilTest=new Sa(this),this.depthRange=new d0(this),this.depthTest=new Ca(this),this.depthFunc=new p0(this),this.blend=new pc(this),this.blendFunc=new mc(this),this.blendColor=new ul(this),this.blendEquation=new hl(this),this.cullFace=new bo(this),this.cullFaceSide=new qo(this),this.frontFace=new zu(this),this.program=new m0(this),this.activeTexture=new Zo(this),this.viewport=new Eo(this),this.bindFramebuffer=new Bu(this),this.bindRenderbuffer=new Ou(this),this.bindTexture=new fl(this),this.bindVertexBuffer=new g0(this),this.bindElementBuffer=new gc(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new _0(this),this.pixelStoreUnpack=new Pa(this),this.pixelStoreUnpackPremultiplyAlpha=new Fu(this),this.pixelStoreUnpackFlipY=new Nu(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,p){return new al(this,l,p)}createVertexBuffer(l,p,v){return new Ac(this,l,p,v)}createRenderbuffer(l,p,v){const E=this.gl,P=E.createRenderbuffer();return this.bindRenderbuffer.set(P),E.renderbufferStorage(E.RENDERBUFFER,l,p,v),this.bindRenderbuffer.set(null),P}createFramebuffer(l,p,v){return new Ma(this,l,p,v)}clear({color:l,depth:p}){const v=this.gl;let E=0;l&&(E|=v.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(E|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),v.clear(E)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){R(l.blendFunction,ui.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Ln{constructor(l,p,v){this.func=l,this.mask=p,this.range=v}}Ln.ReadOnly=!1,Ln.ReadWrite=!0,Ln.disabled=new Ln(519,Ln.ReadOnly,[0,1]);const Wn=7680;class li{constructor(l,p,v,E,P,z){this.test=l,this.ref=p,this.mask=v,this.fail=E,this.depthFail=P,this.pass=z}}li.disabled=new li({func:519,mask:0},0,0,Wn,Wn,Wn);class Kn{constructor(l,p,v){this.enable=l,this.mode=p,this.frontFace=v}}let dl;function To(b,l,p,v,E,P,z){const N=b.context,G=N.gl,$=b.useProgram("collisionBox"),K=[];let se=0,ce=0;for(let Se=0;Se<v.length;Se++){const Ze=v[Se],je=l.getTile(Ze),tt=je.getBucket(p);if(!tt)continue;let Ke=Ze.posMatrix;E[0]===0&&E[1]===0||(Ke=b.translatePosMatrix(Ze.posMatrix,je,E,P));const d=z?tt.textCollisionBox:tt.iconCollisionBox,A=tt.collisionCircleArray;if(A.length>0){const m=a.create(),_=Ke;a.mul(m,tt.placementInvProjMatrix,b.transform.glCoordMatrix),a.mul(m,m,tt.placementViewportMatrix),K.push({circleArray:A,circleOffset:ce,transform:_,invTransform:m,coord:Ze}),se+=A.length/4,ce=se}d&&$.draw(N,G.LINES,Ln.disabled,li.disabled,b.colorModeForRenderPass(),Kn.disabled,ks(Ke,b.transform,je),b.style.terrain&&b.style.terrain.getTerrainData(Ze),p.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,null,b.transform.zoom,null,null,d.collisionVertexBuffer)}if(!z||!K.length)return;const xe=b.useProgram("collisionCircle"),ve=new a.CollisionCircleLayoutArray;ve.resize(4*se),ve._trim();let le=0;for(const Se of K)for(let Ze=0;Ze<Se.circleArray.length/4;Ze++){const je=4*Ze,tt=Se.circleArray[je+0],Ke=Se.circleArray[je+1],d=Se.circleArray[je+2],A=Se.circleArray[je+3];ve.emplace(le++,tt,Ke,d,A,0),ve.emplace(le++,tt,Ke,d,A,1),ve.emplace(le++,tt,Ke,d,A,2),ve.emplace(le++,tt,Ke,d,A,3)}(!dl||dl.length<2*se)&&(dl=function(Se){const Ze=2*Se,je=new a.QuadTriangleArray;je.resize(Ze),je._trim();for(let tt=0;tt<Ze;tt++){const Ke=6*tt;je.uint16[Ke+0]=4*tt+0,je.uint16[Ke+1]=4*tt+1,je.uint16[Ke+2]=4*tt+2,je.uint16[Ke+3]=4*tt+2,je.uint16[Ke+4]=4*tt+3,je.uint16[Ke+5]=4*tt+0}return je}(se));const ye=N.createIndexBuffer(dl,!0),ze=N.createVertexBuffer(ve,a.collisionCircleLayout.members,!0);for(const Se of K){const Ze={u_matrix:Se.transform,u_inv_matrix:Se.invTransform,u_camera_to_center_distance:(Ge=b.transform).cameraToCenterDistance,u_viewport_size:[Ge.width,Ge.height]};xe.draw(N,G.TRIANGLES,Ln.disabled,li.disabled,b.colorModeForRenderPass(),Kn.disabled,Ze,b.style.terrain&&b.style.terrain.getTerrainData(Se.coord),p.id,ze,ye,a.SegmentVector.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,b.transform.zoom,null,null,null)}var Ge;ze.destroy(),ye.destroy()}Kn.disabled=new Kn(!1,1029,2305),Kn.backCCW=new Kn(!0,1029,2305);const Vu=a.identity(new Float32Array(16));function Ia(b,l,p,v,E,P){const{horizontalAlign:z,verticalAlign:N}=a.getAnchorAlignment(b),G=-(z-.5)*l,$=-(N-.5)*p,K=a.evaluateVariableOffset(b,v);return new a.pointGeometry((G/E+K[0])*P,($/E+K[1])*P)}function Gu(b,l,p,v,E,P,z,N,G,$,K){const se=b.text.placedSymbolArray,ce=b.text.dynamicLayoutVertexArray,xe=b.icon.dynamicLayoutVertexArray,ve={};ce.clear();for(let le=0;le<se.length;le++){const ye=se.get(le),ze=b.allowVerticalPlacement&&!ye.placedOrientation,Ge=ye.hidden||!ye.crossTileID||ze?null:v[ye.crossTileID];if(Ge){const Se=new a.pointGeometry(ye.anchorX,ye.anchorY),Ze=Sn(Se,p?z:P,K),je=wr(E.cameraToCenterDistance,Ze.signedDistanceFromCamera);let tt=a.evaluateSizeForFeature(b.textSizeData,G,ye)*je/a.ONE_EM;p&&(tt*=b.tilePixelRatio/N);const{width:Ke,height:d,anchor:A,textOffset:m,textBoxScale:_}=Ge,x=Ia(A,Ke,d,m,_,tt),S=p?Sn(Se.add(x),P,K).point:Ze.point.add(l?x.rotate(-E.angle):x),I=b.allowVerticalPlacement&&ye.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let D=0;D<ye.numGlyphs;D++)a.addDynamicAttributes(ce,S,I);$&&ye.associatedIconIndex>=0&&(ve[ye.associatedIconIndex]={shiftedAnchor:S,angle:I})}else cn(ye.numGlyphs,ce)}if($){xe.clear();const le=b.icon.placedSymbolArray;for(let ye=0;ye<le.length;ye++){const ze=le.get(ye);if(ze.hidden)cn(ze.numGlyphs,xe);else{const Ge=ve[ye];if(Ge)for(let Se=0;Se<ze.numGlyphs;Se++)a.addDynamicAttributes(xe,Ge.shiftedAnchor,Ge.angle);else cn(ze.numGlyphs,xe)}}b.icon.dynamicLayoutVertexBuffer.updateData(xe)}b.text.dynamicLayoutVertexBuffer.updateData(ce)}function _c(b,l,p){return p.iconsInText&&l?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function pl(b,l,p,v,E,P,z,N,G,$,K,se){const ce=b.context,xe=ce.gl,ve=b.transform,le=N==="map",ye=G==="map",ze=N!=="viewport"&&p.layout.get("symbol-placement")!=="point",Ge=le&&!ye&&!ze,Se=!p.layout.get("symbol-sort-key").isConstant();let Ze=!1;const je=b.depthModeForSublayer(0,Ln.ReadOnly),tt=p.layout.get("text-variable-anchor"),Ke=[];for(const d of v){const A=l.getTile(d),m=A.getBucket(p);if(!m)continue;const _=E?m.text:m.icon;if(!_||!_.segments.get().length)continue;const x=_.programConfigurations.get(p.id),S=E||m.sdfIcons,I=E?m.textSizeData:m.iconSizeData,D=ye||ve.pitch!==0,O=b.useProgram(_c(S,E,m),x),H=a.evaluateSizeForZoom(I,ve.zoom),J=b.style.terrain&&b.style.terrain.getTerrainData(d);let Ae,we,Re,Ee,Be=[0,0],Je=null;if(E){if(we=A.glyphAtlasTexture,Re=xe.LINEAR,Ae=A.glyphAtlasTexture.size,m.iconsInText){Be=A.imageAtlasTexture.size,Je=A.imageAtlasTexture;const on=I.kind==="composite"||I.kind==="camera";Ee=D||b.options.rotating||b.options.zooming||on?xe.LINEAR:xe.NEAREST}}else{const on=p.layout.get("icon-size").constantOr(0)!==1||m.iconsNeedLinear;we=A.imageAtlasTexture,Re=S||b.options.rotating||b.options.zooming||on||D?xe.LINEAR:xe.NEAREST,Ae=A.imageAtlasTexture.size}const Ye=xi(A,1,b.transform.zoom),He=Ms(d.posMatrix,ye,le,b.transform,Ye),We=sr(d.posMatrix,ye,le,b.transform,Ye),Oe=tt&&m.hasTextData(),Pt=p.layout.get("icon-text-fit")!=="none"&&Oe&&m.hasIconData();if(ze){const on=b.style.terrain?(gn,jn)=>b.style.terrain.getElevation(d,gn,jn):null,hn=p.layout.get("text-rotation-alignment")==="map";dr(m,d.posMatrix,b,E,He,We,ye,$,hn,on)}const bt=b.translatePosMatrix(d.posMatrix,A,P,z),rt=ze||E&&tt||Pt?Vu:He,ft=b.translatePosMatrix(We,A,P,z,!0),dn=S&&p.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let un;un=S?m.iconsInText?ku(I.kind,H,Ge,ye,b,bt,rt,ft,Ae,Be):A0(I.kind,H,Ge,ye,b,bt,rt,ft,E,Ae,!0):f0(I.kind,H,Ge,ye,b,bt,rt,ft,E,Ae);const rn={program:O,buffers:_,uniformValues:un,atlasTexture:we,atlasTextureIcon:Je,atlasInterpolation:Re,atlasInterpolationIcon:Ee,isSDF:S,hasHalo:dn};if(Se&&m.canOverlap){Ze=!0;const on=_.segments.get();for(const hn of on)Ke.push({segments:new a.SegmentVector([hn]),sortKey:hn.sortKey,state:rn,terrainData:J})}else Ke.push({segments:_.segments,sortKey:0,state:rn,terrainData:J})}Ze&&Ke.sort((d,A)=>d.sortKey-A.sortKey);for(const d of Ke){const A=d.state;if(ce.activeTexture.set(xe.TEXTURE0),A.atlasTexture.bind(A.atlasInterpolation,xe.CLAMP_TO_EDGE),A.atlasTextureIcon&&(ce.activeTexture.set(xe.TEXTURE1),A.atlasTextureIcon&&A.atlasTextureIcon.bind(A.atlasInterpolationIcon,xe.CLAMP_TO_EDGE)),A.isSDF){const m=A.uniformValues;A.hasHalo&&(m.u_is_halo=1,ml(A.buffers,d.segments,p,b,A.program,je,K,se,m,d.terrainData)),m.u_is_halo=0}ml(A.buffers,d.segments,p,b,A.program,je,K,se,A.uniformValues,d.terrainData)}}function ml(b,l,p,v,E,P,z,N,G,$){const K=v.context;E.draw(K,K.gl.TRIANGLES,P,z,N,Kn.disabled,G,$,p.id,b.layoutVertexBuffer,b.indexBuffer,l,p.paint,v.transform.zoom,b.programConfigurations.get(p.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function ka(b,l,p,v,E,P,z){const N=b.context.gl,G=p.paint.get("fill-pattern"),$=G&&G.constantOr(1),K=p.getCrossfadeParameters();let se,ce,xe,ve,le;z?(ce=$&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",se=N.LINES):(ce=$?"fillPattern":"fill",se=N.TRIANGLES);for(const ye of v){const ze=l.getTile(ye);if($&&!ze.patternsLoaded())continue;const Ge=ze.getBucket(p);if(!Ge)continue;const Se=Ge.programConfigurations.get(p.id),Ze=b.useProgram(ce,Se),je=b.style.terrain&&b.style.terrain.getTerrainData(ye);$&&(b.context.activeTexture.set(N.TEXTURE0),ze.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Se.updatePaintBuffers(K));const tt=G.constantOr(null);if(tt&&ze.imageAtlas){const A=ze.imageAtlas,m=A.patternPositions[tt.to.toString()],_=A.patternPositions[tt.from.toString()];m&&_&&Se.setConstantPatternPositions(m,_)}const Ke=je?ye:null,d=b.translatePosMatrix(Ke?Ke.posMatrix:ye.posMatrix,ze,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(z){ve=Ge.indexBuffer2,le=Ge.segments2;const A=[N.drawingBufferWidth,N.drawingBufferHeight];xe=ce==="fillOutlinePattern"&&$?rl(d,b,K,ze,A):Ta(d,A)}else ve=Ge.indexBuffer,le=Ge.segments,xe=$?Ea(d,b,K,ze):ba(d);Ze.draw(b.context,se,E,b.stencilModeForClipping(ye),P,Kn.disabled,xe,je,p.id,Ge.layoutVertexBuffer,ve,le,p.paint,b.transform.zoom,Se)}}function Qo(b,l,p,v,E,P,z){const N=b.context,G=N.gl,$=p.paint.get("fill-extrusion-pattern"),K=$.constantOr(1),se=p.getCrossfadeParameters(),ce=p.paint.get("fill-extrusion-opacity");for(const xe of v){const ve=l.getTile(xe),le=ve.getBucket(p);if(!le)continue;const ye=b.style.terrain&&b.style.terrain.getTerrainData(xe),ze=le.programConfigurations.get(p.id),Ge=b.useProgram(K?"fillExtrusionPattern":"fillExtrusion",ze);K&&(b.context.activeTexture.set(G.TEXTURE0),ve.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),ze.updatePaintBuffers(se));const Se=$.constantOr(null);if(Se&&ve.imageAtlas){const Ke=ve.imageAtlas,d=Ke.patternPositions[Se.to.toString()],A=Ke.patternPositions[Se.from.toString()];d&&A&&ze.setConstantPatternPositions(d,A)}const Ze=b.translatePosMatrix(xe.posMatrix,ve,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),je=p.paint.get("fill-extrusion-vertical-gradient"),tt=K?fs(Ze,b,je,ce,xe,se,ve):wo(Ze,b,je,ce);Ge.draw(N,N.gl.TRIANGLES,E,P,z,Kn.backCCW,tt,ye,p.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,p.paint,b.transform.zoom,ze,b.style.terrain&&le.centroidVertexBuffer)}}function gl(b,l,p,v,E,P,z){const N=b.context,G=N.gl,$=p.fbo;if(!$)return;const K=b.useProgram("hillshade"),se=b.style.terrain&&b.style.terrain.getTerrainData(l);N.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,$.colorAttachment.get()),K.draw(N,G.TRIANGLES,E,P,z,Kn.disabled,((ce,xe,ve,le)=>{const ye=ve.paint.get("hillshade-shadow-color"),ze=ve.paint.get("hillshade-highlight-color"),Ge=ve.paint.get("hillshade-accent-color");let Se=ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);ve.paint.get("hillshade-illumination-anchor")==="viewport"&&(Se-=ce.transform.angle);const Ze=!ce.options.moving;return{u_matrix:le?le.posMatrix:ce.transform.calculatePosMatrix(xe.tileID.toUnwrapped(),Ze),u_image:0,u_latrange:Xe(0,xe.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),Se],u_shadow:ye,u_highlight:ze,u_accent:Ge}})(b,p,v,se?l:null),se,v.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}function _l(b,l,p,v,E,P){const z=b.context,N=z.gl,G=l.dem;if(G&&G.data){const $=G.dim,K=G.stride,se=G.getPixels();if(z.activeTexture.set(N.TEXTURE1),z.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||b.getTileTexture(K),l.demTexture){const xe=l.demTexture;xe.update(se,{premultiply:!1}),xe.bind(N.NEAREST,N.CLAMP_TO_EDGE)}else l.demTexture=new te(z,se,N.RGBA,{premultiply:!1}),l.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);z.activeTexture.set(N.TEXTURE0);let ce=l.fbo;if(!ce){const xe=new te(z,{width:$,height:$,data:null},N.RGBA);xe.bind(N.LINEAR,N.CLAMP_TO_EDGE),ce=l.fbo=z.createFramebuffer($,$,!0),ce.colorAttachment.set(xe.texture)}z.bindFramebuffer.set(ce.framebuffer),z.viewport.set([0,0,$,$]),b.useProgram("hillshadePrepare").draw(z,N.TRIANGLES,v,E,P,Kn.disabled,((xe,ve)=>{const le=ve.stride,ye=a.create();return a.ortho(ye,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(ye,ye,[0,-a.EXTENT,0]),{u_matrix:ye,u_image:1,u_dimension:[le,le],u_zoom:xe.overscaledZ,u_unpack:ve.getUnpackVector()}})(l.tileID,G),null,p.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function Jn(b,l,p,v,E,P){const z=v.paint.get("raster-fade-duration");if(!P&&z>0){const N=a.exported.now(),G=(N-b.timeAdded)/z,$=l?(N-l.timeAdded)/z:-1,K=p.getSource(),se=E.coveringZoomLevel({tileSize:K.tileSize,roundZoom:K.roundZoom}),ce=!l||Math.abs(l.tileID.overscaledZ-se)>Math.abs(b.tileID.overscaledZ-se),xe=ce&&b.refreshedUponExpiration?1:a.clamp(ce?G:1-$,0,1);return b.refreshedUponExpiration&&G>=1&&(b.refreshedUponExpiration=!1),l?{opacity:1,mix:1-xe}:{opacity:xe,mix:0}}return{opacity:1,mix:0}}const v0=new a.Color(1,0,0,1),As=new a.Color(0,1,0,1),ju=new a.Color(0,0,1,1),yc=new a.Color(1,0,1,1),Hu=new a.Color(0,1,1,1);function Yo(b,l,p,v){Fi(b,0,l+p/2,b.transform.width,p,v)}function yl(b,l,p,v){Fi(b,l-p/2,0,p,b.transform.height,v)}function Fi(b,l,p,v,E,P){const z=b.context,N=z.gl;N.enable(N.SCISSOR_TEST),N.scissor(l*b.pixelRatio,p*b.pixelRatio,v*b.pixelRatio,E*b.pixelRatio),z.clear({color:P}),N.disable(N.SCISSOR_TEST)}function vc(b,l,p){const v=b.context,E=v.gl,P=p.posMatrix,z=b.useProgram("debug"),N=Ln.disabled,G=li.disabled,$=b.colorModeForRenderPass(),K="$debug",se=b.style.terrain&&b.style.terrain.getTerrainData(p);v.activeTexture.set(E.TEXTURE0),b.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE);const ce=l.getTileByID(p.key).latestRawTileData,xe=Math.floor((ce&&ce.byteLength||0)/1024),ve=l.getTile(p).tileSize,le=512/Math.min(ve,512)*(p.overscaledZ/b.transform.zoom)*.5;let ye=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(ye+=` => ${p.overscaledZ}`),function(ze,Ge){ze.initDebugOverlayCanvas();const Se=ze.debugOverlayCanvas,Ze=ze.context.gl,je=ze.debugOverlayCanvas.getContext("2d");je.clearRect(0,0,Se.width,Se.height),je.shadowColor="white",je.shadowBlur=2,je.lineWidth=1.5,je.strokeStyle="white",je.textBaseline="top",je.font="bold 36px Open Sans, sans-serif",je.fillText(Ge,5,5),je.strokeText(Ge,5,5),ze.debugOverlayTexture.update(Se),ze.debugOverlayTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE)}(b,`${ye} ${xe}kB`),z.draw(v,E.TRIANGLES,N,G,ui.alphaBlended,Kn.disabled,ue(P,a.Color.transparent,le),null,K,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),z.draw(v,E.LINE_STRIP,N,G,$,Kn.disabled,ue(P,a.Color.red),se,K,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function Ls(b,l,p){const v=b.context,E=v.gl,P=b.colorModeForRenderPass(),z=new Ln(E.LEQUAL,Ln.ReadWrite,b.depthRangeFor3D),N=b.useProgram("terrain"),G=l.getTerrainMesh(),$=l.getTerrainData(p.tileID);v.bindFramebuffer.set(null),v.viewport.set([0,0,b.width,b.height]),v.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,l.getRTTFramebuffer().colorAttachment.get());const K=b.transform.calculatePosMatrix(p.tileID.toUnwrapped());N.draw(v,E.TRIANGLES,z,li.disabled,P,Kn.backCCW,{u_matrix:K,u_texture:0},$,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}function Wu(b,l,p,v){const E=b.context,P=p.tileSize*l.qualityFactor;p.textures[v]||(p.textures[v]=b.getTileTexture(P)||new te(E,{width:P,height:P,data:null},E.gl.RGBA),p.textures[v].bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),v===0&&l.sourceCache.renderHistory.unshift(p.tileID.key));const z=l.getRTTFramebuffer();z.colorAttachment.set(p.textures[v].texture),E.bindFramebuffer.set(z.framebuffer),E.viewport.set([0,0,P,P])}class x0{constructor(l){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=l,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=l.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const l=this.painter.style,p=l.terrain;for(const v in l.sourceCaches){this._coordsDescendingInv[v]={};const E=l.sourceCaches[v].getVisibleCoordinates();for(const P of E){const z=p.sourceCache.getTerrainCoords(P);for(const N in z)this._coordsDescendingInv[v][N]||(this._coordsDescendingInv[v][N]=[]),this._coordsDescendingInv[v][N].push(z[N])}}for(const v of l._order){const E=l._layers[v],P=E.source;if(this._renderToTexture[E.type]&&!this._coordsDescendingInvStr[P]){this._coordsDescendingInvStr[P]={};for(const z in this._coordsDescendingInv[P])this._coordsDescendingInvStr[P][z]=this._coordsDescendingInv[P][z].map(N=>N.key).sort().join()}}return this._renderableTiles.forEach(v=>{for(const E in this._coordsDescendingInvStr){const P=this._coordsDescendingInvStr[E][v.tileID.key];P&&P!==v.textureCoords[E]&&v.clearTextures(this.painter),p.needsRerender(E,v.tileID)&&v.clearTextures(this.painter)}this._rerender[v.tileID.key]=!v.textures.length}),p.clearRerenderCache(),p.sourceCache.removeOutdated(this.painter),this}renderLayer(l){const p=l.type,v=this.painter,E=v.style._order,P=v.currentLayer,z=P+1===E.length;if(this._renderToTexture[p]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=p,this._stacks[this._stacks.length-1].push(E[P]),!z))return!0;if(this._renderToTexture[this._prevType]||p==="hillshade"||this._renderToTexture[p]&&z){this._prevType=p;const N=this._stacks.length-1,G=this._stacks[N]||[];for(const $ of this._renderableTiles){if(Wu(v,v.style.terrain,$,N),this._rerender[$.tileID.key]){v.context.clear({color:a.Color.transparent});for(let K=0;K<G.length;K++){const se=v.style._layers[G[K]],ce=se.source?this._coordsDescendingInv[se.source][$.tileID.key]:[$.tileID];v._renderTileClippingMasks(se,ce),v.renderLayer(v,v.style.sourceCaches[se.source],se,ce),se.source&&($.textureCoords[se.source]=this._coordsDescendingInvStr[se.source][$.tileID.key])}}Ls(v,v.style.terrain,$)}if(p==="hillshade"){this._stacks.push([E[P]]);for(const $ of this._renderableTiles){const K=this._coordsDescendingInv[l.source][$.tileID.key];Wu(v,v.style.terrain,$,this._stacks.length-1),v.context.clear({color:a.Color.transparent}),v._renderTileClippingMasks(l,K),v.renderLayer(v,v.style.sourceCaches[l.source],l,K),Ls(v,v.style.terrain,$)}return!0}return this._renderToTexture[p]}return!1}}const vl={symbol:function(b,l,p,v,E){if(b.renderPass!=="translucent")return;const P=li.disabled,z=b.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(N,G,$,K,se,ce,xe){const ve=G.transform,le=se==="map",ye=ce==="map";for(const ze of N){const Ge=K.getTile(ze),Se=Ge.getBucket($);if(!Se||!Se.text||!Se.text.segments.get().length)continue;const Ze=a.evaluateSizeForZoom(Se.textSizeData,ve.zoom),je=xi(Ge,1,G.transform.zoom),tt=Ms(ze.posMatrix,ye,le,G.transform,je),Ke=$.layout.get("icon-text-fit")!=="none"&&Se.hasIconData();if(Ze){const d=Math.pow(2,ve.zoom-Ge.tileID.overscaledZ);Gu(Se,le,ye,xe,ve,tt,ze.posMatrix,d,Ze,Ke,G.style.terrain?(A,m)=>G.style.terrain.getElevation(ze,A,m):null)}}}(v,b,p,l,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),E),p.paint.get("icon-opacity").constantOr(1)!==0&&pl(b,l,p,v,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),P,z),p.paint.get("text-opacity").constantOr(1)!==0&&pl(b,l,p,v,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),P,z),l.map.showCollisionBoxes&&(To(b,l,p,v,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),To(b,l,p,v,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(b,l,p,v){if(b.renderPass!=="translucent")return;const E=p.paint.get("circle-opacity"),P=p.paint.get("circle-stroke-width"),z=p.paint.get("circle-stroke-opacity"),N=!p.layout.get("circle-sort-key").isConstant();if(E.constantOr(1)===0&&(P.constantOr(1)===0||z.constantOr(1)===0))return;const G=b.context,$=G.gl,K=b.depthModeForSublayer(0,Ln.ReadOnly),se=li.disabled,ce=b.colorModeForRenderPass(),xe=[];for(let ve=0;ve<v.length;ve++){const le=v[ve],ye=l.getTile(le),ze=ye.getBucket(p);if(!ze)continue;const Ge=ze.programConfigurations.get(p.id),Se=b.useProgram("circle",Ge),Ze=ze.layoutVertexBuffer,je=ze.indexBuffer,tt=b.style.terrain&&b.style.terrain.getTerrainData(le),Ke={programConfiguration:Ge,program:Se,layoutVertexBuffer:Ze,indexBuffer:je,uniformValues:sl(b,le,ye,p),terrainData:tt};if(N){const d=ze.segments.get();for(const A of d)xe.push({segments:new a.SegmentVector([A]),sortKey:A.sortKey,state:Ke})}else xe.push({segments:ze.segments,sortKey:0,state:Ke})}N&&xe.sort((ve,le)=>ve.sortKey-le.sortKey);for(const ve of xe){const{programConfiguration:le,program:ye,layoutVertexBuffer:ze,indexBuffer:Ge,uniformValues:Se,terrainData:Ze}=ve.state;ye.draw(G,$.TRIANGLES,K,se,ce,Kn.disabled,Se,Ze,p.id,ze,Ge,ve.segments,p.paint,b.transform.zoom,le)}},heatmap:function(b,l,p,v){if(p.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const E=b.context,P=E.gl,z=li.disabled,N=new ui([P.ONE,P.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(G,$,K){const se=G.gl;G.activeTexture.set(se.TEXTURE1),G.viewport.set([0,0,$.width/4,$.height/4]);let ce=K.heatmapFbo;if(ce)se.bindTexture(se.TEXTURE_2D,ce.colorAttachment.get()),G.bindFramebuffer.set(ce.framebuffer);else{const xe=se.createTexture();se.bindTexture(se.TEXTURE_2D,xe),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),ce=K.heatmapFbo=G.createFramebuffer($.width/4,$.height/4,!1),function(ve,le,ye,ze){const Ge=ve.gl;Ge.texImage2D(Ge.TEXTURE_2D,0,Ge.RGBA,le.width/4,le.height/4,0,Ge.RGBA,ve.extRenderToTextureHalfFloat?ve.extTextureHalfFloat.HALF_FLOAT_OES:Ge.UNSIGNED_BYTE,null),ze.colorAttachment.set(ye)}(G,$,xe,ce)}})(E,b,p),E.clear({color:a.Color.transparent});for(let G=0;G<v.length;G++){const $=v[G];if(l.hasRenderableParent($))continue;const K=l.getTile($),se=K.getBucket(p);if(!se)continue;const ce=se.programConfigurations.get(p.id),xe=b.useProgram("heatmap",ce),{zoom:ve}=b.transform;xe.draw(E,P.TRIANGLES,Ln.disabled,z,N,Kn.disabled,Ie($.posMatrix,K,ve,p.paint.get("heatmap-intensity")),null,p.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,p.paint,b.transform.zoom,ce)}E.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(E,P){const z=E.context,N=z.gl,G=P.heatmapFbo;if(!G)return;z.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,G.colorAttachment.get()),z.activeTexture.set(N.TEXTURE1);let $=P.colorRampTexture;$||($=P.colorRampTexture=new te(z,P.colorRamp,N.RGBA)),$.bind(N.LINEAR,N.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(z,N.TRIANGLES,Ln.disabled,li.disabled,E.colorModeForRenderPass(),Kn.disabled,((K,se,ce,xe)=>{const ve=a.create();a.ortho(ve,0,K.width,K.height,0,0,1);const le=K.context.gl;return{u_matrix:ve,u_world:[le.drawingBufferWidth,le.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:se.paint.get("heatmap-opacity")}})(E,P),null,P.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,P.paint,E.transform.zoom)}(b,p))},line:function(b,l,p,v){if(b.renderPass!=="translucent")return;const E=p.paint.get("line-opacity"),P=p.paint.get("line-width");if(E.constantOr(1)===0||P.constantOr(1)===0)return;const z=b.depthModeForSublayer(0,Ln.ReadOnly),N=b.colorModeForRenderPass(),G=p.paint.get("line-dasharray"),$=p.paint.get("line-pattern"),K=$.constantOr(1),se=p.paint.get("line-gradient"),ce=p.getCrossfadeParameters(),xe=K?"linePattern":G?"lineSDF":se?"lineGradient":"line",ve=b.context,le=ve.gl;let ye=!0;for(const ze of v){const Ge=l.getTile(ze);if(K&&!Ge.patternsLoaded())continue;const Se=Ge.getBucket(p);if(!Se)continue;const Ze=Se.programConfigurations.get(p.id),je=b.context.program.get(),tt=b.useProgram(xe,Ze),Ke=ye||tt.program!==je,d=b.style.terrain&&b.style.terrain.getTerrainData(ze),A=$.constantOr(null);if(A&&Ge.imageAtlas){const x=Ge.imageAtlas,S=x.patternPositions[A.to.toString()],I=x.patternPositions[A.from.toString()];S&&I&&Ze.setConstantPatternPositions(S,I)}const m=d?ze:null,_=K?vn(b,Ge,p,ce,m):G?pi(b,Ge,p,G,ce,m):se?Nt(b,Ge,p,Se.lineClipsArray.length,m):pt(b,Ge,p,m);if(K)ve.activeTexture.set(le.TEXTURE0),Ge.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),Ze.updatePaintBuffers(ce);else if(G&&(Ke||b.lineAtlas.dirty))ve.activeTexture.set(le.TEXTURE0),b.lineAtlas.bind(ve);else if(se){const x=Se.gradients[p.id];let S=x.texture;if(p.gradientVersion!==x.version){let I=256;if(p.stepInterpolant){const D=l.getSource().maxzoom,O=ze.canonical.z===D?Math.ceil(1<<b.transform.maxZoom-ze.canonical.z):1;I=a.clamp(a.nextPowerOfTwo(Se.maxLineLength/a.EXTENT*1024*O),256,ve.maxTextureSize)}x.gradient=a.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:I,image:x.gradient||void 0,clips:Se.lineClipsArray}),x.texture?x.texture.update(x.gradient):x.texture=new te(ve,x.gradient,le.RGBA),x.version=p.gradientVersion,S=x.texture}ve.activeTexture.set(le.TEXTURE0),S.bind(p.stepInterpolant?le.NEAREST:le.LINEAR,le.CLAMP_TO_EDGE)}tt.draw(ve,le.TRIANGLES,z,b.stencilModeForClipping(ze),N,Kn.disabled,_,d,p.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,p.paint,b.transform.zoom,Ze,Se.layoutVertexBuffer2),ye=!1}},fill:function(b,l,p,v){const E=p.paint.get("fill-color"),P=p.paint.get("fill-opacity");if(P.constantOr(1)===0)return;const z=b.colorModeForRenderPass(),N=p.paint.get("fill-pattern"),G=b.opaquePassEnabledForLayer()&&!N.constantOr(1)&&E.constantOr(a.Color.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===G){const $=b.depthModeForSublayer(1,b.renderPass==="opaque"?Ln.ReadWrite:Ln.ReadOnly);ka(b,l,p,v,$,z,!1)}if(b.renderPass==="translucent"&&p.paint.get("fill-antialias")){const $=b.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,Ln.ReadOnly);ka(b,l,p,v,$,z,!0)}},"fill-extrusion":function(b,l,p,v){const E=p.paint.get("fill-extrusion-opacity");if(E!==0&&b.renderPass==="translucent"){const P=new Ln(b.context.gl.LEQUAL,Ln.ReadWrite,b.depthRangeFor3D);if(E!==1||p.paint.get("fill-extrusion-pattern").constantOr(1))Qo(b,l,p,v,P,li.disabled,ui.disabled),Qo(b,l,p,v,P,b.stencilModeFor3D(),b.colorModeForRenderPass());else{const z=b.colorModeForRenderPass();Qo(b,l,p,v,P,li.disabled,z)}}},hillshade:function(b,l,p,v){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const E=b.context,P=b.depthModeForSublayer(0,Ln.ReadOnly),z=b.colorModeForRenderPass(),[N,G]=b.renderPass==="translucent"?b.stencilConfigForOverlap(v):[{},v];for(const $ of G){const K=l.getTile($);K.needsHillshadePrepare!==void 0&&K.needsHillshadePrepare&&b.renderPass==="offscreen"?_l(b,K,p,P,li.disabled,z):b.renderPass==="translucent"&&gl(b,$,K,p,P,N[$.overscaledZ],z)}E.viewport.set([0,0,b.width,b.height])},raster:function(b,l,p,v){if(b.renderPass!=="translucent"||p.paint.get("raster-opacity")===0||!v.length)return;const E=b.context,P=E.gl,z=l.getSource(),N=b.useProgram("raster"),G=b.colorModeForRenderPass(),[$,K]=z instanceof Ot?[{},v]:b.stencilConfigForOverlap(v),se=K[K.length-1].overscaledZ,ce=!b.options.moving;for(const xe of K){const ve=b.depthModeForSublayer(xe.overscaledZ-se,p.paint.get("raster-opacity")===1?Ln.ReadWrite:Ln.ReadOnly,P.LESS),le=l.getTile(xe);le.registerFadeDuration(p.paint.get("raster-fade-duration"));const ye=l.findLoadedParent(xe,0),ze=Jn(le,ye,l,p,b.transform,b.style.terrain);let Ge,Se;const Ze=p.paint.get("raster-resampling")==="nearest"?P.NEAREST:P.LINEAR;E.activeTexture.set(P.TEXTURE0),le.texture.bind(Ze,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(P.TEXTURE1),ye?(ye.texture.bind(Ze,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),Ge=Math.pow(2,ye.tileID.overscaledZ-le.tileID.overscaledZ),Se=[le.tileID.canonical.x*Ge%1,le.tileID.canonical.y*Ge%1]):le.texture.bind(Ze,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST);const je=b.style.terrain&&b.style.terrain.getTerrainData(xe),tt=je?xe:null,Ke=tt?tt.posMatrix:b.transform.calculatePosMatrix(xe.toUnwrapped(),ce),d=zn(Ke,Se||[0,0],Ge||1,ze,p);z instanceof Ot?N.draw(E,P.TRIANGLES,ve,li.disabled,G,Kn.disabled,d,je,p.id,z.boundsBuffer,b.quadTriangleIndexBuffer,z.boundsSegments):N.draw(E,P.TRIANGLES,ve,$[xe.overscaledZ],G,Kn.disabled,d,je,p.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}},background:function(b,l,p,v){const E=p.paint.get("background-color"),P=p.paint.get("background-opacity");if(P===0)return;const z=b.context,N=z.gl,G=b.transform,$=G.tileSize,K=p.paint.get("background-pattern");if(b.isPatternMissing(K))return;const se=!K&&E.a===1&&P===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==se)return;const ce=li.disabled,xe=b.depthModeForSublayer(0,se==="opaque"?Ln.ReadWrite:Ln.ReadOnly),ve=b.colorModeForRenderPass(),le=b.useProgram(K?"backgroundPattern":"background"),ye=v||G.coveringTiles({tileSize:$,terrain:b.style.terrain});K&&(z.activeTexture.set(N.TEXTURE0),b.imageManager.bind(b.context));const ze=p.getCrossfadeParameters();for(const Ge of ye){const Se=v?Ge.posMatrix:b.transform.calculatePosMatrix(Ge.toUnwrapped()),Ze=K?Lu(Se,P,b,K,{tileID:Ge,tileSize:$},ze):U1(Se,P,E),je=b.style.terrain&&b.style.terrain.getTerrainData(Ge);le.draw(z,N.TRIANGLES,xe,ce,ve,Kn.disabled,Ze,je,p.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}},debug:function(b,l,p){for(let v=0;v<p.length;v++)vc(b,l,p[v])},custom:function(b,l,p){const v=b.context,E=p.implementation;if(b.renderPass==="offscreen"){const P=E.prerender;P&&(b.setCustomLayerDefaults(),v.setColorMode(b.colorModeForRenderPass()),P.call(E,v.gl,b.transform.customLayerMatrix()),v.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),v.setColorMode(b.colorModeForRenderPass()),v.setStencilMode(li.disabled);const P=E.renderingMode==="3d"?new Ln(b.context.gl.LEQUAL,Ln.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,Ln.ReadOnly);v.setDepthMode(P),E.render(v.gl,b.transform.customLayerMatrix()),v.setDirty(),b.setBaseState(),v.bindFramebuffer.set(null)}}};class br{constructor(l,p){this.context=new Al(l),this.transform=p,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.create(),renderTime:0},this.setup(),this.numSublayers=mt.maxUnderzooming+mt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Vt,this.gpuTimers={}}resize(l,p,v){if(this.width=l*v,this.height=p*v,this.pixelRatio=v,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const E of this.style._order)this.style._layers[E].resize()}setup(){const l=this.context,p=new a.PosArray;p.emplaceBack(0,0),p.emplaceBack(a.EXTENT,0),p.emplaceBack(0,a.EXTENT),p.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(p,sn.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const v=new a.PosArray;v.emplaceBack(0,0),v.emplaceBack(a.EXTENT,0),v.emplaceBack(0,a.EXTENT),v.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=l.createVertexBuffer(v,sn.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const E=new a.RasterBoundsArray;E.emplaceBack(0,0,0,0),E.emplaceBack(a.EXTENT,0,a.EXTENT,0),E.emplaceBack(0,a.EXTENT,0,a.EXTENT),E.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(E,yt.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const P=new a.PosArray;P.emplaceBack(0,0),P.emplaceBack(1,0),P.emplaceBack(0,1),P.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(P,sn.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const z=new a.LineStripIndexArray;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(z);const N=new a.TriangleIndexArray;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(N),this.emptyTexture=new te(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);const G=this.context.gl;this.stencilClearMode=new li({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO)}clearStencil(){const l=this.context,p=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const v=a.create();a.ortho(v,0,this.width,this.height,0,0,1),a.scale(v,v,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,p.TRIANGLES,Ln.disabled,this.stencilClearMode,ui.disabled,Kn.disabled,me(v),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,p){if(this.currentStencilSource===l.source||!l.isTileClipped()||!p||!p.length)return;this.currentStencilSource=l.source;const v=this.context,E=v.gl;this.nextStencilID+p.length>256&&this.clearStencil(),v.setColorMode(ui.disabled),v.setDepthMode(Ln.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of p){const N=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,G=this.style.terrain&&this.style.terrain.getTerrainData(z);P.draw(v,E.TRIANGLES,Ln.disabled,new li({func:E.ALWAYS,mask:0},N,255,E.KEEP,E.KEEP,E.REPLACE),ui.disabled,Kn.disabled,me(z.posMatrix),G,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,p=this.context.gl;return new li({func:p.NOTEQUAL,mask:255},l,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(l){const p=this.context.gl;return new li({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(l){const p=this.context.gl,v=l.sort((z,N)=>N.overscaledZ-z.overscaledZ),E=v[v.length-1].overscaledZ,P=v[0].overscaledZ-E+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const z={};for(let N=0;N<P;N++)z[N+E]=new li({func:p.GEQUAL,mask:255},N+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=P,[z,v]}return[{[E]:li.disabled},v]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new ui([l.CONSTANT_COLOR,l.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ui.unblended:ui.alphaBlended}depthModeForSublayer(l,p,v){if(!this.opaquePassEnabledForLayer())return Ln.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Ln(v||this.context.gl.LEQUAL,p,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,p){this.style=l,this.options=p,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const v=this.style._order,E=this.style.sourceCaches,P=this.style.terrain&&new x0(this);for(const $ in E){const K=E[$];K.used&&K.prepare(this.context)}const z={},N={},G={};for(const $ in E){const K=E[$];z[$]=K.getVisibleCoordinates(),N[$]=z[$].slice().reverse(),G[$]=K.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<v.length;$++)if(this.style._layers[v[$]].is3D()){this.opaquePassCutoff=$;break}if(P){this.opaquePassCutoff=0;const $=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||$.length)&&(a.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(K,se){const ce=K.context,xe=ce.gl,ve=ui.unblended,le=new Ln(xe.LEQUAL,Ln.ReadWrite,[0,1]),ye=se.getTerrainMesh(),ze=se.sourceCache.getRenderableTiles(),Ge=K.useProgram("terrainDepth");ce.bindFramebuffer.set(se.getFramebuffer("depth").framebuffer),ce.viewport.set([0,0,K.width/devicePixelRatio,K.height/devicePixelRatio]),ce.clear({color:a.Color.transparent,depth:1});for(const Se of ze){const Ze=se.getTerrainData(Se.tileID),je=K.transform.calculatePosMatrix(Se.tileID.toUnwrapped());Ge.draw(ce,xe.TRIANGLES,le,li.disabled,ve,Kn.backCCW,{u_matrix:je},Ze,"terrain",ye.vertexBuffer,ye.indexBuffer,ye.segments)}ce.bindFramebuffer.set(null),ce.viewport.set([0,0,K.width,K.height])}(this,this.style.terrain),function(K,se){const ce=K.context,xe=ce.gl,ve=ui.unblended,le=new Ln(xe.LEQUAL,Ln.ReadWrite,[0,1]),ye=se.getTerrainMesh(),ze=se.getCoordsTexture(),Ge=se.sourceCache.getRenderableTiles(),Se=K.useProgram("terrainCoords");ce.bindFramebuffer.set(se.getFramebuffer("coords").framebuffer),ce.viewport.set([0,0,K.width/devicePixelRatio,K.height/devicePixelRatio]),ce.clear({color:a.Color.transparent,depth:1}),se.coordsIndex=[];for(const Ze of Ge){const je=se.getTerrainData(Ze.tileID);ce.activeTexture.set(xe.TEXTURE0),xe.bindTexture(xe.TEXTURE_2D,ze.texture);const tt=K.transform.calculatePosMatrix(Ze.tileID.toUnwrapped());Se.draw(ce,xe.TRIANGLES,le,li.disabled,ve,Kn.backCCW,{u_matrix:tt,u_terrain_coords_id:(255-se.coordsIndex.length)/255,u_texture:0},je,"terrain",ye.vertexBuffer,ye.indexBuffer,ye.segments),se.coordsIndex.push(Ze.tileID.key)}ce.bindFramebuffer.set(null),ce.viewport.set([0,0,K.width,K.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const $ of v){const K=this.style._layers[$];if(!K.hasOffscreenPass()||K.isHidden(this.transform.zoom))continue;const se=N[K.source];(K.type==="custom"||se.length)&&this.renderLayer(this,E[K.source],K,se)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!P)for(this.renderPass="opaque",this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const $=this.style._layers[v[this.currentLayer]],K=E[$.source],se=z[$.source];this._renderTileClippingMasks($,se),this.renderLayer(this,K,$,se)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const $=this.style._layers[v[this.currentLayer]],K=E[$.source];if(P&&P.renderLayer($))continue;const se=($.type==="symbol"?G:N)[$.source];this._renderTileClippingMasks($,z[$.source]),this.renderLayer(this,K,$,se)}if(this.options.showTileBoundaries){let $,K;Object.values(this.style._layers).forEach(se=>{se.source&&!se.isHidden(this.transform.zoom)&&(se.source!==(K&&K.id)&&(K=this.style.sourceCaches[se.source]),(!$||$.getSource().maxzoom<K.getSource().maxzoom)&&($=K))}),$&&vl.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const K=$.transform.padding;Yo($,$.transform.height-(K.top||0),3,v0),Yo($,K.bottom||0,3,As),yl($,K.left||0,3,ju),yl($,$.transform.width-(K.right||0),3,yc);const se=$.transform.centerPoint;(function(ce,xe,ve,le){Fi(ce,xe-1,ve-10,2,20,le),Fi(ce,xe-10,ve-1,20,2,le)})($,se.x,$.transform.height-se.y,Hu)}(this),this.context.setDefault()}renderLayer(l,p,v,E){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="custom"||(E||[]).length)&&(this.id=v.id,this.gpuTimingStart(v),vl[v.type](l,p,v,E,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let v=this.gpuTimers[l.id];v||(v=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),v.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,v.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}queryGpuTimers(l){const p={};for(const v in l){const E=l[v],P=this.context.extTimerQuery,z=P.getQueryObjectEXT(E.query,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(E.query),p[v]=z}return p}translatePosMatrix(l,p,v,E,P){if(!v[0]&&!v[1])return l;const z=P?E==="map"?this.transform.angle:0:E==="viewport"?-this.transform.angle:0;if(z){const $=Math.sin(z),K=Math.cos(z);v=[v[0]*K-v[1]*$,v[0]*$+v[1]*K]}const N=[P?v[0]:xi(p,v[0],this.transform.zoom),P?v[1]:xi(p,v[1],this.transform.zoom),0],G=new Float32Array(16);return a.translate(G,l,N),G}saveTileTexture(l){const p=this._tileTextures[l.size[0]];p?p.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const p=this._tileTextures[l];return p&&p.length>0?p.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const p=this.imageManager.getPattern(l.from.toString()),v=this.imageManager.getPattern(l.to.toString());return!p||!v}useProgram(l,p){this.cache=this.cache||{};const v=l+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[v]||(this.cache[v]=new wa(this.context,l,Wi[l],p,ol[l],this._showOverdrawInspector,this.style.terrain)),this.cache[v]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new te(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class xl{constructor(l,p){this.points=l,this.planes=p}static fromInvProjectionMatrix(l,p,v){const E=Math.pow(2,v),P=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const G=1/(N=a.transformMat4([],N,l))[3]/p*E;return a.mul$1(N,N,[G,G,1/N[3],G])}),z=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const G=a.sub([],P[N[0]],P[N[1]]),$=a.sub([],P[N[2]],P[N[1]]),K=a.normalize([],a.cross([],G,$)),se=-a.dot(K,P[N[1]]);return K.concat(se)});return new xl(P,z)}}class Ko{constructor(l,p){this.min=l,this.max=p,this.center=a.scale$1([],a.add([],this.min,this.max),.5)}quadrant(l){const p=[l%2==0,l<2],v=a.clone$2(this.min),E=a.clone$2(this.max);for(let P=0;P<p.length;P++)v[P]=p[P]?this.min[P]:this.center[P],E[P]=p[P]?this.center[P]:this.max[P];return E[2]=this.max[2],new Ko(v,E)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const p=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let v=!0;for(let E=0;E<l.planes.length;E++){const P=l.planes[E];let z=0;for(let N=0;N<p.length;N++)a.dot$1(P,p[N])>=0&&z++;if(z===0)return 0;z!==p.length&&(v=!1)}if(v)return 2;for(let E=0;E<3;E++){let P=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(let N=0;N<l.points.length;N++){const G=l.points[N][E]-this.min[E];P=Math.min(P,G),z=Math.max(z,G)}if(z<0||P>this.max[E]-this.min[E])return 0}return 1}}class ds{constructor(l=0,p=0,v=0,E=0){if(isNaN(l)||l<0||isNaN(p)||p<0||isNaN(v)||v<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=p,this.left=v,this.right=E}interpolate(l,p,v){return p.top!=null&&l.top!=null&&(this.top=a.number(l.top,p.top,v)),p.bottom!=null&&l.bottom!=null&&(this.bottom=a.number(l.bottom,p.bottom,v)),p.left!=null&&l.left!=null&&(this.left=a.number(l.left,p.left,v)),p.right!=null&&l.right!=null&&(this.right=a.number(l.right,p.right,v)),this}getCenter(l,p){const v=a.clamp((this.left+l-this.right)/2,0,l),E=a.clamp((this.top+p-this.bottom)/2,0,p);return new a.pointGeometry(v,E)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new ds(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Qs{constructor(l,p,v,E,P){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=P===void 0||!!P,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=v??0,this._maxPitch=E??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ds,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const l=new Qs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l._elevation=this._elevation,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const p=-a.wrap(l,-180,180)*Math.PI/180;var v;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(v=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v),function(E,P,z){var N=P[0],G=P[1],$=P[2],K=P[3],se=Math.sin(z),ce=Math.cos(z);E[0]=N*ce+$*se,E[1]=G*ce+K*se,E[2]=N*-se+$*ce,E[3]=G*-se+K*ce}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const p=a.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const p=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,p,v){this._unmodified=!1,this._edgeInsets.interpolate(l,p,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const p=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(l){const p=[new a.UnwrappedTileID(0,l)];if(this._renderWorldCopies){const v=this.pointCoordinate(new a.pointGeometry(0,0)),E=this.pointCoordinate(new a.pointGeometry(this.width,0)),P=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),z=this.pointCoordinate(new a.pointGeometry(0,this.height)),N=Math.floor(Math.min(v.x,E.x,P.x,z.x)),G=Math.floor(Math.max(v.x,E.x,P.x,z.x)),$=1;for(let K=N-$;K<=G+$;K++)K!==0&&p.push(new a.UnwrappedTileID(K,l))}return p}coveringTiles(l){var p,v;let E=this.coveringZoomLevel(l);const P=E;if(l.minzoom!==void 0&&E<l.minzoom)return[];l.maxzoom!==void 0&&E>l.maxzoom&&(E=l.maxzoom);const z=this.pointCoordinate(this.getCameraPoint()),N=a.MercatorCoordinate.fromLngLat(this.center),G=Math.pow(2,E),$=[G*z.x,G*z.y,0],K=[G*N.x,G*N.y,0],se=xl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,E);let ce=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ce=E);const xe=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,ve=Se=>({aabb:new Ko([Se*G,0,0],[(Se+1)*G,G,0]),zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),le=[],ye=[],ze=E,Ge=l.reparseOverscaled?P:E;if(this._renderWorldCopies)for(let Se=1;Se<=3;Se++)le.push(ve(-Se)),le.push(ve(Se));for(le.push(ve(0));le.length>0;){const Se=le.pop(),Ze=Se.x,je=Se.y;let tt=Se.fullyVisible;if(!tt){const x=Se.aabb.intersects(se);if(x===0)continue;tt=x===2}const Ke=l.terrain?$:K,d=Se.aabb.distanceX(Ke),A=Se.aabb.distanceY(Ke),m=Math.max(Math.abs(d),Math.abs(A)),_=xe+(1<<ze-Se.zoom)-2;if(Se.zoom===ze||m>_&&Se.zoom>=ce){const x=ze-Se.zoom,S=$[0]-.5-(Ze<<x),I=$[1]-.5-(je<<x);ye.push({tileID:new a.OverscaledTileID(Se.zoom===ze?Ge:Se.zoom,Se.wrap,Se.zoom,Ze,je),distanceSq:a.sqrLen([K[0]-.5-Ze,K[1]-.5-je]),tileDistanceToCamera:Math.sqrt(S*S+I*I)})}else for(let x=0;x<4;x++){const S=(Ze<<1)+x%2,I=(je<<1)+(x>>1),D=Se.zoom+1;let O=Se.aabb.quadrant(x);if(l.terrain){const H=new a.OverscaledTileID(D,Se.wrap,D,S,I),J=l.terrain.getMinMaxElevation(H),Ae=(p=J.minElevation)!==null&&p!==void 0?p:this.elevation,we=(v=J.maxElevation)!==null&&v!==void 0?v:this.elevation;O=new Ko([O.min[0],O.min[1],Ae],[O.max[0],O.max[1],we])}le.push({aabb:O,zoom:D,x:S,y:I,wrap:Se.wrap,fullyVisible:tt})}}return ye.sort((Se,Ze)=>Se.distanceSq-Ze.distanceSq).map(Se=>Se.tileID)}resize(l,p){this.width=l,this.height=p,this.pixelsToGLUnits=[2/l,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const p=a.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.pointGeometry(a.mercatorXfromLng(l.lng)*this.worldSize,a.mercatorYfromLat(p)*this.worldSize)}unproject(l){return new a.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(l){this.freezeElevation||(this.elevation=l?this.getElevation(this._center,l):0)}getElevation(l,p){const v=a.MercatorCoordinate.fromLngLat(l),E=(1<<this.tileZoom)*a.EXTENT,P=v.x*E,z=v.y*E,N=Math.floor(P/a.EXTENT),G=Math.floor(z/a.EXTENT),$=new a.OverscaledTileID(this.tileZoom,0,this.tileZoom,N,G);return p.getElevation($,P%a.EXTENT,z%a.EXTENT,a.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const p=this.pointLocation(this.centerPoint,l),v=this.getElevation(p,l);if(!(this.elevation-v))return;const E=this.getCameraPosition(),P=a.MercatorCoordinate.fromLngLat(E.lngLat,E.altitude),z=a.MercatorCoordinate.fromLngLat(p,v),N=P.x-z.x,G=P.y-z.y,$=P.z-z.z,K=Math.sqrt(N*N+G*G+$*$),se=this.scaleZoom(this.cameraToCenterDistance/K/this.tileSize);this._elevation=v,this._center=p,this.zoom=se}setLocationAtPoint(l,p){const v=this.pointCoordinate(p),E=this.pointCoordinate(this.centerPoint),P=this.locationCoordinate(l),z=new a.MercatorCoordinate(P.x-(v.x-E.x),P.y-(v.y-E.y));this.center=this.coordinateLocation(z),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,p){return p?this.coordinatePoint(this.locationCoordinate(l),this.getElevation(l,p),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,p){return this.coordinateLocation(this.pointCoordinate(l,p))}locationCoordinate(l){return a.MercatorCoordinate.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,p){if(p){const ce=p.pointCoordinate(l);if(ce!=null)return ce}const v=[l.x,l.y,0,1],E=[l.x,l.y,1,1];a.transformMat4(v,v,this.pixelMatrixInverse),a.transformMat4(E,E,this.pixelMatrixInverse);const P=v[3],z=E[3],N=v[1]/P,G=E[1]/z,$=v[2]/P,K=E[2]/z,se=$===K?0:(0-$)/(K-$);return new a.MercatorCoordinate(a.number(v[0]/P,E[0]/z,se)/this.worldSize,a.number(N,G,se)/this.worldSize)}coordinatePoint(l,p=0,v=this.pixelMatrix){const E=[l.x*this.worldSize,l.y*this.worldSize,p,1];return a.transformMat4(E,E,v),new a.pointGeometry(E[0]/E[3],E[1]/E[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new a.LngLatBounds().extend(this.pointLocation(new a.pointGeometry(0,l))).extend(this.pointLocation(new a.pointGeometry(this.width,l))).extend(this.pointLocation(new a.pointGeometry(this.width,this.height))).extend(this.pointLocation(new a.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(l,p=!1){const v=l.key,E=p?this._alignedPosMatrixCache:this._posMatrixCache;if(E[v])return E[v];const P=l.canonical,z=this.worldSize/this.zoomScale(P.z),N=P.x+Math.pow(2,P.z)*l.wrap,G=a.identity(new Float64Array(16));return a.translate(G,G,[N*z,P.y*z,0]),a.scale(G,G,[z/a.EXTENT,z/a.EXTENT,1]),a.multiply(G,p?this.alignedProjMatrix:this.projMatrix,G),E[v]=new Float32Array(G),E[v]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let l,p,v,E,P=-90,z=90,N=-180,G=180;const $=this.size,K=this._unmodified;if(this.latRange){const xe=this.latRange;P=a.mercatorYfromLat(xe[1])*this.worldSize,z=a.mercatorYfromLat(xe[0])*this.worldSize,l=z-P<$.y?$.y/(z-P):0}if(this.lngRange){const xe=this.lngRange;N=a.wrap(a.mercatorXfromLng(xe[0])*this.worldSize,0,this.worldSize),G=a.wrap(a.mercatorXfromLng(xe[1])*this.worldSize,0,this.worldSize),G<N&&(G+=this.worldSize),p=G-N<$.x?$.x/(G-N):0}const se=this.point,ce=Math.max(p||0,l||0);if(ce)return this.center=this.unproject(new a.pointGeometry(p?(G+N)/2:se.x,l?(z+P)/2:se.y)),this.zoom+=this.scaleZoom(ce),this._unmodified=K,void(this._constraining=!1);if(this.latRange){const xe=se.y,ve=$.y/2;xe-ve<P&&(E=P+ve),xe+ve>z&&(E=z-ve)}if(this.lngRange){const xe=(N+G)/2,ve=a.wrap(se.x,xe-this.worldSize/2,xe+this.worldSize/2),le=$.x/2;ve-le<N&&(v=N+le),ve+le>G&&(v=G-le)}v===void 0&&E===void 0||(this.center=this.unproject(new a.pointGeometry(v!==void 0?v:se.x,E!==void 0?E:se.y)).wrap()),this._unmodified=K,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,p=this.point.x,v=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let E=a.identity(new Float64Array(16));a.scale(E,E,[this.width/2,-this.height/2,1]),a.translate(E,E,[1,-1,0]),this.labelPlaneMatrix=E,E=a.identity(new Float64Array(16)),a.scale(E,E,[1,-1,1]),a.translate(E,E,[-1,-1,0]),a.scale(E,E,[2/this.width,2/this.height,1]),this.glCoordMatrix=E,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const P=Math.PI/2+this._pitch,z=this._fov*(.5+l.y/this.height),N=Math.sin(z)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-P-z,.01,Math.PI-.01)),G=this.getHorizon(),$=2*Math.atan(G/this.cameraToCenterDistance)*(.5+l.y/(2*G)),K=Math.sin($)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-P-$,.01,Math.PI-.01)),se=Math.cos(Math.PI/2-this._pitch)*N+this.cameraToSeaLevelDistance,ce=Math.cos(Math.PI/2-this._pitch)*K+this.cameraToSeaLevelDistance,xe=1.01*Math.min(se,ce),ve=this.height/50;E=new Float64Array(16),a.perspective(E,this._fov,this.width/this.height,ve,xe),E[8]=2*-l.x/this.width,E[9]=2*l.y/this.height,a.scale(E,E,[1,-1,1]),a.translate(E,E,[0,0,-this.cameraToCenterDistance]),a.rotateX(E,E,this._pitch),a.rotateZ(E,E,this.angle),a.translate(E,E,[-p,-v,0]),this.mercatorMatrix=a.scale([],E,[this.worldSize,this.worldSize,this.worldSize]),a.scale(E,E,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,E),a.translate(E,E,[0,0,-this.elevation]),this.projMatrix=E,this.invProjMatrix=a.invert([],E),this.pixelMatrix3D=a.multiply(new Float64Array(16),this.labelPlaneMatrix,E);const le=this.width%2/2,ye=this.height%2/2,ze=Math.cos(this.angle),Ge=Math.sin(this.angle),Se=p-Math.round(p)+ze*le+Ge*ye,Ze=v-Math.round(v)+ze*ye+Ge*le,je=new Float64Array(E);if(a.translate(je,je,[Se>.5?Se-1:Se,Ze>.5?Ze-1:Ze,0]),this.alignedProjMatrix=je,E=a.invert(new Float64Array(16),this.pixelMatrix),!E)throw new Error("failed to invert matrix");this.pixelMatrixInverse=E,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new a.pointGeometry(0,0)),p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return a.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,l))}getCameraQueryGeometry(l){const p=this.getCameraPoint();if(l.length===1)return[l[0],p];{let v=p.x,E=p.y,P=p.x,z=p.y;for(const N of l)v=Math.min(v,N.x),E=Math.min(E,N.y),P=Math.max(P,N.x),z=Math.max(z,N.y);return[new a.pointGeometry(v,E),new a.pointGeometry(P,E),new a.pointGeometry(P,z),new a.pointGeometry(v,z),new a.pointGeometry(v,E)]}}}class La{constructor(l){this._hashName=l&&encodeURIComponent(l),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(p,v){let E=!1,P=null;const z=()=>{P=null,E&&(p(),P=setTimeout(z,300),E=!1)};return()=>(E=!0,P||z(),P)}(this._updateHashUnthrottled.bind(this))}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){const p=this._map.getCenter(),v=Math.round(100*this._map.getZoom())/100,E=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,E),z=Math.round(p.lng*P)/P,N=Math.round(p.lat*P)/P,G=this._map.getBearing(),$=this._map.getPitch();let K="";if(K+=l?`/${z}/${N}/${v}`:`${v}/${N}/${z}`,(G||$)&&(K+="/"+Math.round(10*G)/10),$&&(K+=`/${Math.round($)}`),this._hashName){const se=this._hashName;let ce=!1;const xe=window.location.hash.slice(1).split("&").map(ve=>{const le=ve.split("=")[0];return le===se?(ce=!0,`${le}=${K}`):ve}).filter(ve=>ve);return ce||xe.push(`${se}=${K}`),`#${xe.join("&")}`}return`#${K}`}_getCurrentHash(){const l=window.location.hash.replace("#","");if(this._hashName){let p;return l.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(p=v)}),(p&&p[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,l)}catch{}}}const wl={linearity:.3,easing:a.bezier(0,0,.3,1)},xc=a.extend({deceleration:2500,maxSpeed:1400},wl),$u=a.extend({deceleration:20,maxSpeed:1400},wl),w0=a.extend({deceleration:1e3,maxSpeed:360},wl),Da=a.extend({deceleration:1e3,maxSpeed:90},wl);class qu{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,p=a.exported.now();for(;l.length>0&&p-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const p={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)p.zoom+=P.zoomDelta||0,p.bearing+=P.bearingDelta||0,p.pitch+=P.pitchDelta||0,P.panDelta&&p.pan._add(P.panDelta),P.around&&(p.around=P.around),P.pinchAround&&(p.pinchAround=P.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(p.pan.mag()){const P=za(p.pan.mag(),v,a.extend({},xc,l||{}));E.offset=p.pan.mult(P.amount/p.pan.mag()),E.center=this._map.transform.center,Ra(E,P)}if(p.zoom){const P=za(p.zoom,v,$u);E.zoom=this._map.transform.zoom+P.amount,Ra(E,P)}if(p.bearing){const P=za(p.bearing,v,w0);E.bearing=this._map.transform.bearing+a.clamp(P.amount,-179,179),Ra(E,P)}if(p.pitch){const P=za(p.pitch,v,Da);E.pitch=this._map.transform.pitch+P.amount,Ra(E,P)}if(E.zoom||E.bearing){const P=p.pinchAround===void 0?p.around:p.pinchAround;E.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),a.extend(E,{noMoveStart:!0})}}function Ra(b,l){(!b.duration||b.duration<l.duration)&&(b.duration=l.duration,b.easing=l.easing)}function za(b,l,p){const{maxSpeed:v,linearity:E,deceleration:P}=p,z=a.clamp(b*E/(l/1e3),-v,v),N=Math.abs(z)/(P*E);return{easing:p.easing,duration:1e3*N,amount:z*(N/2)}}class Ki extends a.Event{constructor(l,p,v,E={}){const P=L.mousePos(p.getCanvasContainer(),v),z=p.unproject(P);super(l,a.extend({point:P,lngLat:z,originalEvent:v},E)),this._defaultPrevented=!1,this.target=p}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ds extends a.Event{constructor(l,p,v){const E=l==="touchend"?v.changedTouches:v.touches,P=L.touchPos(p.getCanvasContainer(),E),z=P.map(G=>p.unproject(G)),N=P.reduce((G,$,K,se)=>G.add($.div(se.length)),new a.pointGeometry(0,0));super(l,{points:P,point:N,lngLats:z,lngLat:p.unproject(N),originalEvent:v}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class zr extends a.Event{constructor(l,p,v){super(l,{originalEvent:v}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class bl{constructor(l,p){this._map=l,this._clickTolerance=p.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new zr(l.type,this._map,l))}mousedown(l,p){return this._mousedownPos=p,this._firePreventable(new Ki(l.type,this._map,l))}mouseup(l){this._map.fire(new Ki(l.type,this._map,l))}click(l,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new Ki(l.type,this._map,l))}dblclick(l){return this._firePreventable(new Ki(l.type,this._map,l))}mouseover(l){this._map.fire(new Ki(l.type,this._map,l))}mouseout(l){this._map.fire(new Ki(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Ds(l.type,this._map,l))}touchmove(l){this._map.fire(new Ds(l.type,this._map,l))}touchend(l){this._map.fire(new Ds(l.type,this._map,l))}touchcancel(l){this._map.fire(new Ds(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class So{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new Ki(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ki("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new Ki(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zu{constructor(l,p){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,p){this.isEnabled()&&l.shiftKey&&l.button===0&&(L.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(l,p){if(!this._active)return;const v=p;if(this._lastPos.equals(v)||!this._box&&v.dist(this._startPos)<this._clickTolerance)return;const E=this._startPos;this._lastPos=v,this._box||(this._box=L.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const P=Math.min(E.x,v.x),z=Math.max(E.x,v.x),N=Math.min(E.y,v.y),G=Math.max(E.y,v.y);L.setTransform(this._box,`translate(${P}px,${N}px)`),this._box.style.width=z-P+"px",this._box.style.height=G-N+"px"}mouseupWindow(l,p){if(!this._active||l.button!==0)return;const v=this._startPos,E=p;if(this.reset(),L.suppressClick(),v.x!==E.x||v.y!==E.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:P=>P.fitScreenCoordinates(v,E,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,p){return this._map.fire(new a.Event(l,{originalEvent:p}))}}function Ys(b,l){if(b.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${l.length}`);const p={};for(let v=0;v<b.length;v++)p[b[v].identifier]=l[v];return p}class El{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,p,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),v.length===this.numTouches&&(this.centroid=function(E){const P=new a.pointGeometry(0,0);for(const z of E)P._add(z);return P.div(E.length)}(p),this.touches=Ys(v,p)))}touchmove(l,p,v){if(this.aborted||!this.centroid)return;const E=Ys(v,p);for(const P in this.touches){const z=this.touches[P],N=E[P];(!N||N.dist(z)>30)&&(this.aborted=!0)}}touchend(l,p,v){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const E=!this.aborted&&this.centroid;if(this.reset(),E)return E}}}class wc{constructor(l){this.singleTap=new El(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,p,v){this.singleTap.touchstart(l,p,v)}touchmove(l,p,v){this.singleTap.touchmove(l,p,v)}touchend(l,p,v){const E=this.singleTap.touchend(l,p,v);if(E){const P=l.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(E)<30;if(P&&z||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=E,this.count===this.numTaps)return this.reset(),E}}}class V1{constructor(){this._zoomIn=new wc({numTouches:1,numTaps:2}),this._zoomOut=new wc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,p,v){this._zoomIn.touchstart(l,p,v),this._zoomOut.touchstart(l,p,v)}touchmove(l,p,v){this._zoomIn.touchmove(l,p,v),this._zoomOut.touchmove(l,p,v)}touchend(l,p,v){const E=this._zoomIn.touchend(l,p,v),P=this._zoomOut.touchend(l,p,v);return E?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:z.getZoom()+1,around:z.unproject(E)},{originalEvent:l})}):P?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:z.getZoom()-1,around:z.unproject(P)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const G1={0:1,2:2};class Ba{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(l,p){return!1}_move(l,p){return{}}mousedown(l,p){if(this._lastPoint)return;const v=L.mouseButton(l);this._correctButton(l,v)&&(this._lastPoint=p,this._eventButton=v)}mousemoveWindow(l,p){const v=this._lastPoint;if(v){if(l.preventDefault(),function(E,P){const z=G1[P];return E.buttons===void 0||(E.buttons&z)!==z}(l,this._eventButton))this.reset();else if(this._moved||!(p.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(v,p)}}mouseupWindow(l){this._lastPoint&&L.mouseButton(l)===this._eventButton&&(this._moved&&L.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oa extends Ba{mousedown(l,p){super.mousedown(l,p),this._lastPoint&&(this._active=!0)}_correctButton(l,p){return p===0&&!l.ctrlKey}_move(l,p){return{around:p,panDelta:p.sub(l)}}}class ps extends Ba{_correctButton(l,p){return p===0&&l.ctrlKey||p===2}_move(l,p){const v=.8*(p.x-l.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(l){l.preventDefault()}}class zt extends Ba{_correctButton(l,p){return p===0&&l.ctrlKey||p===2}_move(l,p){const v=-.5*(p.y-l.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(l){l.preventDefault()}}class Xu{constructor(l,p){this._minTouches=l.cooperativeGestures?2:1,this._clickTolerance=l.clickTolerance||1,this._map=p,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(l,p,v){return this._calculateTransform(l,p,v)}touchmove(l,p,v){if(this._map._cooperativeGestures&&(this._minTouches===2&&v.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(l,!1,v.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(v.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,p,v)}touchend(l,p,v){this._calculateTransform(l,p,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,p,v){v.length>0&&(this._active=!0);const E=Ys(v,p),P=new a.pointGeometry(0,0),z=new a.pointGeometry(0,0);let N=0;for(const $ in E){const K=E[$],se=this._touches[$];se&&(P._add(K),z._add(K.sub(se)),N++,E[$]=K)}if(this._touches=E,N<this._minTouches||!z.mag())return;const G=z.div(N);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(N),panDelta:G}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(l){}_move(l,p,v){return{}}touchstart(l,p,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([p[0],p[1]]))}touchmove(l,p,v){if(!this._firstTwoTouches)return;l.preventDefault();const[E,P]=this._firstTwoTouches,z=Co(v,p,E),N=Co(v,p,P);if(!z||!N)return;const G=this._aroundCenter?null:z.add(N).div(2);return this._move([z,N],G,l)}touchend(l,p,v){if(!this._firstTwoTouches)return;const[E,P]=this._firstTwoTouches,z=Co(v,p,E),N=Co(v,p,P);z&&N||(this._active&&L.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Co(b,l,p){for(let v=0;v<b.length;v++)if(b[v].identifier===p)return l[v]}function bc(b,l){return Math.log(b/l)/Math.LN2}class kt extends Jo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,p){const v=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(bc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bc(this._distance,v),pinchAround:p}}}function b0(b,l){return 180*b.angleWith(l)/Math.PI}class Qu extends Jo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,p){const v=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:b0(this._vector,v),pinchAround:p}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const p=25/(Math.PI*this._minDiameter)*360,v=b0(l,this._startVector);return Math.abs(v)<p}}function Ec(b){return Math.abs(b.y)>Math.abs(b.x)}class E0 extends Jo{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,p,v){super.touchstart(l,p,v),this._currentTouchCount=v.length}_start(l){this._lastPoints=l,Ec(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,p,v){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const E=l[0].sub(this._lastPoints[0]),P=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(E,P,v.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(E.y+P.y)/2*-.5}):void 0}gestureBeginsVertically(l,p,v){if(this._valid!==void 0)return this._valid;const E=l.mag()>=2,P=p.mag()>=2;if(!E&&!P)return;if(!E||!P)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;const z=l.y>0==p.y>0;return Ec(l)&&Ec(p)&&z}}const Rs={panStep:100,bearingStep:15,pitchStep:10};class Tc{constructor(){const l=Rs;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let p=0,v=0,E=0,P=0,z=0;switch(l.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:l.shiftKey?v=-1:(l.preventDefault(),P=-1);break;case 39:l.shiftKey?v=1:(l.preventDefault(),P=1);break;case 38:l.shiftKey?E=1:(l.preventDefault(),z=-1);break;case 40:l.shiftKey?E=-1:(l.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(v=0,E=0),{cameraAnimation:N=>{const G=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:j1,zoom:p?Math.round(G)+p*(l.shiftKey?2:1):G,bearing:N.getBearing()+v*this._bearingStep,pitch:N.getPitch()+E*this._pitchStep,offset:[-P*this._panStep,-z*this._panStep],center:N.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function j1(b){return b*(2-b)}const Yu=4.000244140625;class Sc{constructor(l,p){this._map=l,this._el=l.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;l.preventDefault()}let p=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const v=a.exported.now(),E=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,p!==0&&p%Yu==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":E>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(E*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),l.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=l,this._delta-=p,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=L.mousePos(this._el,l);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;if(this._delta!==0){const N=this._type==="wheel"&&Math.abs(this._delta)>Yu?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&G!==0&&(G=1/G);const $=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom($*G))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,v=this._startZoom,E=this._easing;let P,z=!1;if(this._type==="wheel"&&v&&E){const N=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),G=E(N);P=a.number(v,p,G),N<1?this._frameId||(this._frameId=!0):z=!0}else P=p,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:P-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let p=a.ease;if(this._prevEase){const v=this._prevEase,E=(a.exported.now()-v.start)/v.duration,P=v.easing(E+.01)-v.easing(E),z=.27/Math.sqrt(P*P+1e-4)*.01,N=Math.sqrt(.0729-z*z);p=a.bezier(z,N,.25,1)}return this._prevEase={start:a.exported.now(),duration:l,easing:p},p}reset(){this._active=!1}}class Cc{constructor(l,p){this._clickZoom=l,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Pc{constructor(){this.reset()}reset(){this._active=!1}dblclick(l,p){return l.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(l.shiftKey?-1:1),around:v.unproject(p)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zs{constructor(){this._tap=new wc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(l,p,v){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=p[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(l,p,v))}touchmove(l,p,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const E=p[0],P=E.y-this._swipePoint.y;return this._swipePoint=E,l.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(l,p,v)}touchend(l,p,v){this._tapTime?this._swipePoint&&v.length===0&&this.reset():this._tap.touchend(l,p,v)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pr{constructor(l,p,v){this._el=l,this._mousePan=p,this._touchPan=v}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ks{constructor(l,p,v){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=p,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ku{constructor(l,p,v,E){this._el=l,this._touchZoom=p,this._touchRotate=v,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Fa=b=>b.zoom||b.drag||b.pitch||b.rotate;class Mc extends a.Event{}function Tl(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class Ju{constructor(l,p){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qu(l),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),a.bindAll(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(const[E,P,z]of this._listeners)L.addEventListener(E,P,E===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[l,p,v]of this._listeners)L.removeEventListener(l,p,l===document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(l){const p=this._map,v=p.getCanvasContainer();this._add("mapEvent",new bl(p,l));const E=p.boxZoom=new Zu(p,l);this._add("boxZoom",E);const P=new V1,z=new Pc;p.doubleClickZoom=new Cc(z,P),this._add("tapZoom",P),this._add("clickZoom",z);const N=new zs;this._add("tapDragZoom",N);const G=p.touchPitch=new E0(p);this._add("touchPitch",G);const $=new ps(l),K=new zt(l);p.dragRotate=new Ks(l,$,K),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",K,["mouseRotate"]);const se=new Oa(l),ce=new Xu(l,p);p.dragPan=new pr(v,se,ce),this._add("mousePan",se),this._add("touchPan",ce,["touchZoom","touchRotate"]);const xe=new Qu,ve=new kt;p.touchZoomRotate=new Ku(v,ve,xe,N),this._add("touchRotate",xe,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]);const le=p.scrollZoom=new Sc(p,this);this._add("scrollZoom",le,["mousePan"]);const ye=p.keyboard=new Tc;this._add("keyboard",ye),this._add("blockableMapEvent",new So(p));for(const ze of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[ze]&&p[ze].enable(l[ze])}_add(l,p,v){this._handlers.push({handlerName:l,handler:p,allowed:v}),this._handlersById[l]=p}stop(l){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fa(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,p,v){for(const E in l)if(E!==v&&(!p||p.indexOf(E)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const p=[];for(const v of l)this._el.contains(v.target)&&p.push(v);return p}handleEvent(l,p){if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const v=l.type==="renderFrame"?void 0:l,E={needsRenderFrame:!1},P={},z={},N=l.touches,G=N?this._getMapTouches(N):void 0,$=G?L.touchPos(this._el,G):L.mousePos(this._el,l);for(const{handlerName:ce,handler:xe,allowed:ve}of this._handlers){if(!xe.isEnabled())continue;let le;this._blockedByActive(z,ve,ce)?xe.reset():xe[p||l.type]&&(le=xe[p||l.type](l,$,G),this.mergeHandlerResult(E,P,le,ce,v),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||xe.isActive())&&(z[ce]=xe)}const K={};for(const ce in this._previousActiveHandlers)z[ce]||(K[ce]=v);this._previousActiveHandlers=z,(Object.keys(K).length||Tl(E))&&(this._changes.push([E,P,K]),this._triggerRenderFrame()),(Object.keys(z).length||Tl(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:se}=E;se&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],se(this._map))}mergeHandlerResult(l,p,v,E,P){if(!v)return;a.extend(l,v);const z={handlerName:E,originalEvent:v.originalEvent||P};v.zoomDelta!==void 0&&(p.zoom=z),v.panDelta!==void 0&&(p.drag=z),v.pitchDelta!==void 0&&(p.pitch=z),v.bearingDelta!==void 0&&(p.rotate=z)}_applyChanges(){const l={},p={},v={};for(const[E,P,z]of this._changes)E.panDelta&&(l.panDelta=(l.panDelta||new a.pointGeometry(0,0))._add(E.panDelta)),E.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+E.pitchDelta),E.around!==void 0&&(l.around=E.around),E.pinchAround!==void 0&&(l.pinchAround=E.pinchAround),E.noInertia&&(l.noInertia=E.noInertia),a.extend(p,P),a.extend(v,z);this._updateMapTransform(l,p,v),this._changes=[]}_updateMapTransform(l,p,v){const E=this._map,P=E.transform,z=E.style&&E.style.terrain;if(!(Tl(l)||z&&this._drag))return this._fireEvents(p,v,!0);let{panDelta:N,zoomDelta:G,bearingDelta:$,pitchDelta:K,around:se,pinchAround:ce}=l;ce!==void 0&&(se=ce),E._stop(!0),se=se||E.transform.centerPoint;const xe=P.pointLocation(N?se.sub(N):se);$&&(P.bearing+=$),K&&(P.pitch+=K),G&&(P.zoom+=G),z?p.drag&&!this._drag?(this._drag={center:P.centerPoint,lngLat:P.pointLocation(se),point:se,handlerName:p.drag.handlerName},E.fire(new a.Event("freezeElevation",{freeze:!0}))):this._drag&&v[this._drag.handlerName]?(E.fire(new a.Event("freezeElevation",{freeze:!1})),this._drag=null):p.drag&&this._drag&&(P.center=P.pointLocation(P.centerPoint.sub(N))):P.setLocationAtPoint(xe,se),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(p,v,!0)}_fireEvents(l,p,v){const E=Fa(this._eventsInProgress),P=Fa(l),z={};for(const K in l){const{originalEvent:se}=l[K];this._eventsInProgress[K]||(z[`${K}start`]=se),this._eventsInProgress[K]=l[K]}!E&&P&&this._fireEvent("movestart",P.originalEvent);for(const K in z)this._fireEvent(K,z[K]);P&&this._fireEvent("move",P.originalEvent);for(const K in l){const{originalEvent:se}=l[K];this._fireEvent(K,se)}const N={};let G;for(const K in this._eventsInProgress){const{handlerName:se,originalEvent:ce}=this._eventsInProgress[K];this._handlersById[se].isActive()||(delete this._eventsInProgress[K],G=p[se]||ce,N[`${K}end`]=G)}for(const K in N)this._fireEvent(K,N[K]);const $=Fa(this._eventsInProgress);if(v&&(E||P)&&!$){this._updatingCamera=!0;const K=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),se=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;K?(se(K.bearing||this._map.getBearing())&&(K.bearing=0),this._map.easeTo(K,{originalEvent:G})):(this._map.fire(new a.Event("moveend",{originalEvent:G})),se(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,p){this._map.fire(new a.Event(l,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new Mc("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Zr={extend:(b,...l)=>a.extend(b,...l),run(b){b()},logToElement(b,l=!1,p="log"){const v=window.document.getElementById(p);v&&(l&&(v.innerHTML=""),v.innerHTML+=`<br>${b}`)}};class fi extends a.Evented{constructor(l,p){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=p.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,p){return this.jumpTo({center:l},p)}panBy(l,p,v){return l=a.pointGeometry.convert(l).mult(-1),this.panTo(this.transform.center,a.extend({offset:l},p),v)}panTo(l,p,v){return this.easeTo(a.extend({center:l},p),v)}getZoom(){return this.transform.zoom}setZoom(l,p){return this.jumpTo({zoom:l},p),this}zoomTo(l,p,v){return this.easeTo(a.extend({zoom:l},p),v)}zoomIn(l,p){return this.zoomTo(this.getZoom()+1,l,p),this}zoomOut(l,p){return this.zoomTo(this.getZoom()-1,l,p),this}getBearing(){return this.transform.bearing}setBearing(l,p){return this.jumpTo({bearing:l},p),this}getPadding(){return this.transform.padding}setPadding(l,p){return this.jumpTo({padding:l},p),this}rotateTo(l,p,v){return this.easeTo(a.extend({bearing:l},p),v)}resetNorth(l,p){return this.rotateTo(0,a.extend({duration:1e3},l),p),this}resetNorthPitch(l,p){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},l),p),this}snapToNorth(l,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,p):this}getPitch(){return this.transform.pitch}setPitch(l,p){return this.jumpTo({pitch:l},p),this}cameraForBounds(l,p){l=a.LngLatBounds.convert(l);const v=p&&p.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),v,p)}_cameraForBoxAndBearing(l,p,v,E){const P={top:0,bottom:0,right:0,left:0};if(typeof(E=a.extend({padding:P,offset:[0,0],maxZoom:this.transform.maxZoom},E)).padding=="number"){const je=E.padding;E.padding={top:je,bottom:je,right:je,left:je}}E.padding=a.extend(P,E.padding);const z=this.transform,N=z.padding,G=z.project(a.LngLat.convert(l)),$=z.project(a.LngLat.convert(p)),K=G.rotate(-v*Math.PI/180),se=$.rotate(-v*Math.PI/180),ce=new a.pointGeometry(Math.max(K.x,se.x),Math.max(K.y,se.y)),xe=new a.pointGeometry(Math.min(K.x,se.x),Math.min(K.y,se.y)),ve=ce.sub(xe),le=(z.width-(N.left+N.right+E.padding.left+E.padding.right))/ve.x,ye=(z.height-(N.top+N.bottom+E.padding.top+E.padding.bottom))/ve.y;if(ye<0||le<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ze=Math.min(z.scaleZoom(z.scale*Math.min(le,ye)),E.maxZoom),Ge=a.pointGeometry.convert(E.offset),Se=new a.pointGeometry((E.padding.left-E.padding.right)/2,(E.padding.top-E.padding.bottom)/2).rotate(v*Math.PI/180),Ze=Ge.add(Se).mult(z.scale/z.zoomScale(ze));return{center:z.unproject(G.add($).div(2).sub(Ze)),zoom:ze,bearing:v}}fitBounds(l,p,v){return this._fitInternal(this.cameraForBounds(l,p),p,v)}fitScreenCoordinates(l,p,v,E,P){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(l)),this.transform.pointLocation(a.pointGeometry.convert(p)),v,E),E,P)}_fitInternal(l,p,v){return l?(delete(p=a.extend(l,p)).padding,p.linear?this.easeTo(p,v):this.flyTo(p,v)):this}jumpTo(l,p){this.stop();const v=this.transform;let E=!1,P=!1,z=!1;return"zoom"in l&&v.zoom!==+l.zoom&&(E=!0,v.zoom=+l.zoom),l.center!==void 0&&(v.center=a.LngLat.convert(l.center)),"bearing"in l&&v.bearing!==+l.bearing&&(P=!0,v.bearing=+l.bearing),"pitch"in l&&v.pitch!==+l.pitch&&(z=!0,v.pitch=+l.pitch),l.padding==null||v.isPaddingEqual(l.padding)||(v.padding=l.padding),this.fire(new a.Event("movestart",p)).fire(new a.Event("move",p)),E&&this.fire(new a.Event("zoomstart",p)).fire(new a.Event("zoom",p)).fire(new a.Event("zoomend",p)),P&&this.fire(new a.Event("rotatestart",p)).fire(new a.Event("rotate",p)).fire(new a.Event("rotateend",p)),z&&this.fire(new a.Event("pitchstart",p)).fire(new a.Event("pitch",p)).fire(new a.Event("pitchend",p)),this.fire(new a.Event("moveend",p))}calculateCameraOptionsFromTo(l,p,v,E=0){const P=a.MercatorCoordinate.fromLngLat(l,p),z=a.MercatorCoordinate.fromLngLat(v,E),N=z.x-P.x,G=z.y-P.y,$=z.z-P.z,K=Math.hypot(N,G,$);if(K===0)throw new Error("Can't calculate camera options with same From and To");const se=Math.hypot(N,G),ce=this.transform.scaleZoom(this.transform.cameraToCenterDistance/K/this.transform.tileSize),xe=180*Math.atan2(N,-G)/Math.PI;let ve=180*Math.acos(se/K)/Math.PI;return ve=$<0?90-ve:90+ve,{center:z.toLngLat(),zoom:ce,pitch:ve,bearing:xe}}easeTo(l,p){this._stop(!1,l.easeId),((l=a.extend({offset:[0,0],duration:500,easing:a.ease},l)).animate===!1||!l.essential&&a.exported.prefersReducedMotion)&&(l.duration=0);const v=this.transform,E=this.getZoom(),P=this.getBearing(),z=this.getPitch(),N=this.getPadding(),G="zoom"in l?+l.zoom:E,$="bearing"in l?this._normalizeBearing(l.bearing,P):P,K="pitch"in l?+l.pitch:z,se="padding"in l?l.padding:v.padding,ce=a.pointGeometry.convert(l.offset);let xe=v.centerPoint.add(ce);const ve=v.pointLocation(xe),le=a.LngLat.convert(l.center||ve);this._normalizeCenter(le);const ye=v.project(ve),ze=v.project(le).sub(ye),Ge=v.zoomScale(G-E);let Se,Ze;l.around&&(Se=a.LngLat.convert(l.around),Ze=v.locationPoint(Se));const je={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||G!==E,this._rotating=this._rotating||P!==$,this._pitching=this._pitching||K!==z,this._padding=!v.isPaddingEqual(se),this._easeId=l.easeId,this._prepareEase(p,l.noMoveStart,je),this._ease(tt=>{if(this._zooming&&(v.zoom=a.number(E,G,tt)),this._rotating&&(v.bearing=a.number(P,$,tt)),this._pitching&&(v.pitch=a.number(z,K,tt)),this._padding&&(v.interpolatePadding(N,se,tt),xe=v.centerPoint.add(ce)),Se)v.setLocationAtPoint(Se,Ze);else{const Ke=v.zoomScale(v.zoom-E),d=G>E?Math.min(2,Ge):Math.max(.5,Ge),A=Math.pow(d,1-tt),m=v.unproject(ye.add(ze.mult(tt*A)).mult(Ke));v.setLocationAtPoint(v.renderWorldCopies?m.wrap():m,xe)}this._fireMoveEvents(p)},tt=>{this._afterEase(p,tt)},l),this}_prepareEase(l,p,v={}){this._moving=!0,this.fire(new a.Event("freezeElevation",{freeze:!0})),p||v.moving||this.fire(new a.Event("movestart",l)),this._zooming&&!v.zooming&&this.fire(new a.Event("zoomstart",l)),this._rotating&&!v.rotating&&this.fire(new a.Event("rotatestart",l)),this._pitching&&!v.pitching&&this.fire(new a.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new a.Event("move",l)),this._zooming&&this.fire(new a.Event("zoom",l)),this._rotating&&this.fire(new a.Event("rotate",l)),this._pitching&&this.fire(new a.Event("pitch",l))}_afterEase(l,p){if(this._easeId&&p&&this._easeId===p)return;delete this._easeId,this.fire(new a.Event("freezeElevation",{freeze:!1}));const v=this._zooming,E=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new a.Event("zoomend",l)),E&&this.fire(new a.Event("rotateend",l)),P&&this.fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l))}flyTo(l,p){if(!l.essential&&a.exported.prefersReducedMotion){const D=a.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(D,p)}this.stop(),l=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},l);const v=this.transform,E=this.getZoom(),P=this.getBearing(),z=this.getPitch(),N=this.getPadding(),G="zoom"in l?a.clamp(+l.zoom,v.minZoom,v.maxZoom):E,$="bearing"in l?this._normalizeBearing(l.bearing,P):P,K="pitch"in l?+l.pitch:z,se="padding"in l?l.padding:v.padding,ce=v.zoomScale(G-E),xe=a.pointGeometry.convert(l.offset);let ve=v.centerPoint.add(xe);const le=v.pointLocation(ve),ye=a.LngLat.convert(l.center||le);this._normalizeCenter(ye);const ze=v.project(le),Ge=v.project(ye).sub(ze);let Se=l.curve;const Ze=Math.max(v.width,v.height),je=Ze/ce,tt=Ge.mag();if("minZoom"in l){const D=a.clamp(Math.min(l.minZoom,E,G),v.minZoom,v.maxZoom),O=Ze/v.zoomScale(D-E);Se=Math.sqrt(O/tt*2)}const Ke=Se*Se;function d(D){const O=(je*je-Ze*Ze+(D?-1:1)*Ke*Ke*tt*tt)/(2*(D?je:Ze)*Ke*tt);return Math.log(Math.sqrt(O*O+1)-O)}function A(D){return(Math.exp(D)-Math.exp(-D))/2}function m(D){return(Math.exp(D)+Math.exp(-D))/2}const _=d(0);let x=function(D){return m(_)/m(_+Se*D)},S=function(D){return Ze*((m(_)*(A(O=_+Se*D)/m(O))-A(_))/Ke)/tt;var O},I=(d(1)-_)/Se;if(Math.abs(tt)<1e-6||!isFinite(I)){if(Math.abs(Ze-je)<1e-6)return this.easeTo(l,p);const D=je<Ze?-1:1;I=Math.abs(Math.log(je/Ze))/Se,S=function(){return 0},x=function(O){return Math.exp(D*Se*O)}}return l.duration="duration"in l?+l.duration:1e3*I/("screenSpeed"in l?+l.screenSpeed/Se:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=P!==$,this._pitching=K!==z,this._padding=!v.isPaddingEqual(se),this._prepareEase(p,!1),this._ease(D=>{const O=D*I,H=1/x(O);v.zoom=D===1?G:E+v.scaleZoom(H),this._rotating&&(v.bearing=a.number(P,$,D)),this._pitching&&(v.pitch=a.number(z,K,D)),this._padding&&(v.interpolatePadding(N,se,D),ve=v.centerPoint.add(xe));const J=D===1?ye:v.unproject(ze.add(Ge.mult(S(O))).mult(H));v.setLocationAtPoint(v.renderWorldCopies?J.wrap():J,ve),this._fireMoveEvents(p)},()=>this._afterEase(p),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,p)}if(!l){const v=this.handlers;v&&v.stop(!1)}return this}_ease(l,p,v){v.animate===!1||v.duration===0?(l(1),p()):(this._easeStart=a.exported.now(),this._easeOptions=v,this._onEaseFrame=l,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,p){l=a.wrap(l,-180,180);const v=Math.abs(l-p);return Math.abs(l-360-p)<v&&(l-=360),Math.abs(l+360-p)<v&&(l+=360),l}_normalizeCenter(l){const p=this.transform;if(!p.renderWorldCopies||p.lngRange)return;const v=l.lng-p.center.lng;l.lng+=v>180?-360:v<-180?360:0}}class Sl{constructor(l={}){this.options=l,a.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options&&this.options.compact,this._container=L.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,p){const v=this._map._getUIString(`AttributionControl.${p}`);l.title=v,l.setAttribute("aria-label",v)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(E=>typeof E!="string"?"":E)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}const p=this._map.style.sourceCaches;for(const E in p){const P=p[E];if(P.used||P.usedForTerrain){const z=P.getSource();z.attribution&&l.indexOf(z.attribution)<0&&l.push(z.attribution)}}l=l.filter(E=>String(E).trim()),l.sort((E,P)=>E.length-P.length),l=l.filter((E,P)=>{for(let z=P+1;z<l.length;z++)if(l[z].indexOf(E)>=0)return!1;return!0});const v=l.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,l.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class T0{constructor(l={}){this.options=l,a.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=L.create("div","maplibregl-ctrl mapboxgl-ctrl");const p=L.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){L.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const l=this._container.children;if(l.length){const p=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact","mapboxgl-compact"):p.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class eh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const p=++this._id;return this._queue.push({callback:l,id:p,cancelled:!1}),p}remove(l){const p=this._currentlyRunning,v=p?this._queue.concat(p):this._queue;for(const E of v)if(E.id===l)return void(E.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const p=this._currentlyRunning=this._queue;this._queue=[];for(const v of p)if(!v.cancelled&&(v.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const th={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Ic={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},nh={showCompass:!0,showZoom:!0,visualizePitch:!1};class ei{constructor(l,p,v=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new ps({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,v&&(this.mousePitch=new zt({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),L.addEventListener(p,"mousedown",this.mousedown),L.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(p,"touchmove",this.touchmove),L.addEventListener(p,"touchend",this.touchend),L.addEventListener(p,"touchcancel",this.reset)}down(l,p){this.mouseRotate.mousedown(l,p),this.mousePitch&&this.mousePitch.mousedown(l,p),L.disableDrag()}move(l,p){const v=this.map,E=this.mouseRotate.mousemoveWindow(l,p);if(E&&E.bearingDelta&&v.setBearing(v.getBearing()+E.bearingDelta),this.mousePitch){const P=this.mousePitch.mousemoveWindow(l,p);P&&P.pitchDelta&&v.setPitch(v.getPitch()+P.pitchDelta)}}off(){const l=this.element;L.removeEventListener(l,"mousedown",this.mousedown),L.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(l,"touchmove",this.touchmove),L.removeEventListener(l,"touchend",this.touchend),L.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){L.enableDrag(),L.removeEventListener(window,"mousemove",this.mousemove),L.removeEventListener(window,"mouseup",this.mouseup)}mousedown(l){this.down(a.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),L.mousePos(this.element,l)),L.addEventListener(window,"mousemove",this.mousemove),L.addEventListener(window,"mouseup",this.mouseup)}mousemove(l){this.move(l,L.mousePos(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Cl(b,l,p){if(b=new a.LngLat(b.lng,b.lat),l){const v=new a.LngLat(b.lng-360,b.lat),E=new a.LngLat(b.lng+360,b.lat),P=p.locationPoint(b).distSqr(l);p.locationPoint(v).distSqr(l)<P?b=v:p.locationPoint(E).distSqr(l)<P&&(b=E)}for(;Math.abs(b.lng-p.center.lng)>180;){const v=p.locationPoint(b);if(v.x>=0&&v.y>=0&&v.x<=p.width&&v.y<=p.height)break;b.lng>p.center.lng?b.lng-=360:b.lng+=360}return b}const Ht={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Kt(b,l,p){const v=b.classList;for(const E in Ht)v.remove(`maplibregl-${p}-anchor-${E}`,`mapboxgl-${p}-anchor-${E}`);v.add(`maplibregl-${p}-anchor-${l}`,`mapboxgl-${p}-anchor-${l}`)}class Ji extends a.Evented{constructor(l,p){if(super(),(l instanceof HTMLElement||p)&&(l=a.extend({element:l},p)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=a.pointGeometry.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div"),this._element.setAttribute("aria-label","Map marker");const v=L.createNS("http://www.w3.org/2000/svg","svg"),E=41,P=27;v.setAttributeNS(null,"display","block"),v.setAttributeNS(null,"height",`${E}px`),v.setAttributeNS(null,"width",`${P}px`),v.setAttributeNS(null,"viewBox",`0 0 ${P} ${E}`);const z=L.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"stroke","none"),z.setAttributeNS(null,"stroke-width","1"),z.setAttributeNS(null,"fill","none"),z.setAttributeNS(null,"fill-rule","evenodd");const N=L.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill-rule","nonzero");const G=L.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(3.0, 29.0)"),G.setAttributeNS(null,"fill","#000000");const $=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ge of $){const Se=L.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",Ge.rx),Se.setAttributeNS(null,"ry",Ge.ry),G.appendChild(Se)}const K=L.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"fill",this._color);const se=L.createNS("http://www.w3.org/2000/svg","path");se.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),K.appendChild(se);const ce=L.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"opacity","0.25"),ce.setAttributeNS(null,"fill","#000000");const xe=L.createNS("http://www.w3.org/2000/svg","path");xe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ce.appendChild(xe);const ve=L.createNS("http://www.w3.org/2000/svg","g");ve.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ve.setAttributeNS(null,"fill","#FFFFFF");const le=L.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ye=L.createNS("http://www.w3.org/2000/svg","circle");ye.setAttributeNS(null,"fill","#000000"),ye.setAttributeNS(null,"opacity","0.25"),ye.setAttributeNS(null,"cx","5.5"),ye.setAttributeNS(null,"cy","5.5"),ye.setAttributeNS(null,"r","5.4999962");const ze=L.createNS("http://www.w3.org/2000/svg","circle");ze.setAttributeNS(null,"fill","#FFFFFF"),ze.setAttributeNS(null,"cx","5.5"),ze.setAttributeNS(null,"cy","5.5"),ze.setAttributeNS(null,"r","5.4999962"),le.appendChild(ye),le.appendChild(ze),N.appendChild(G),N.appendChild(K),N.appendChild(ce),N.appendChild(ve),N.appendChild(le),v.appendChild(N),v.setAttributeNS(null,"height",E*this._scale+"px"),v.setAttributeNS(null,"width",P*this._scale+"px"),this._element.appendChild(v),this._offset=a.pointGeometry.convert(l&&l.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()}),Kt(this._element,this._anchor,"marker"),this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=a.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const E=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[E,-1*(38.1-13.5+E)],"bottom-right":[-E,-1*(38.1-13.5+E)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(l){const p=l.code,v=l.charCode||l.keyCode;p!=="Space"&&p!=="Enter"&&v!==32&&v!==13||this.togglePopup()}_onMapClick(l){const p=l.originalEvent.target,v=this._element;this._popup&&(p===v||v.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this}_update(l){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Cl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),l&&l.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,`${Ht[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${p}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const E=this._map.unproject(this._pos),P=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=E.distanceTo(this._lngLat)>20*P?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(l){return this._offset=a.pointGeometry.convert(l),this._update(),this}_onMove(l){if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const kc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Po,er=0,Js=!1;const ms={maxWidth:100,unit:"metric"};function Lc(b,l,p){const v=p&&p.maxWidth||100,E=b._container.clientHeight/2,P=b.unproject([0,E]),z=b.unproject([v,E]),N=P.distanceTo(z);if(p&&p.unit==="imperial"){const G=3.2808*N;G>5280?eo(l,v,G/5280,b._getUIString("ScaleControl.Miles")):eo(l,v,G,b._getUIString("ScaleControl.Feet"))}else p&&p.unit==="nautical"?eo(l,v,N/1852,b._getUIString("ScaleControl.NauticalMiles")):N>=1e3?eo(l,v,N/1e3,b._getUIString("ScaleControl.Kilometers")):eo(l,v,N,b._getUIString("ScaleControl.Meters"))}function eo(b,l,p,v){const E=function(P){const z=Math.pow(10,`${Math.floor(P)}`.length-1);let N=P/z;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(G){const $=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10));return Math.round(G*$)/$}(N),z*N}(p);b.style.width=l*(E/p)+"px",b.innerHTML=`${E}&nbsp;${v}`}const wi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},zi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Dc(b){if(b){if(typeof b=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(b,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,b),"top-left":new a.pointGeometry(l,l),"top-right":new a.pointGeometry(-l,l),bottom:new a.pointGeometry(0,-b),"bottom-left":new a.pointGeometry(l,-l),"bottom-right":new a.pointGeometry(-l,-l),left:new a.pointGeometry(b,0),right:new a.pointGeometry(-b,0)}}if(b instanceof a.pointGeometry||Array.isArray(b)){const l=a.pointGeometry.convert(b);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:a.pointGeometry.convert(b.center||[0,0]),top:a.pointGeometry.convert(b.top||[0,0]),"top-left":a.pointGeometry.convert(b["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(b["top-right"]||[0,0]),bottom:a.pointGeometry.convert(b.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(b["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(b["bottom-right"]||[0,0]),left:a.pointGeometry.convert(b.left||[0,0]),right:a.pointGeometry.convert(b.right||[0,0])}}return Dc(new a.pointGeometry(0,0))}const ea={supported:y,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends fi{constructor(b){var l;if(a.PerformanceUtils.mark(a.PerformanceMarkers.create),(b=a.extend({},Ic,b)).minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Qs(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies),{bearingSnap:b.bearingSnap}),this._interactive=b.interactive,this._cooperativeGestures=b.cooperativeGestures,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=b.collectResourceTiming,this._renderTaskQueue=new eh,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},th,b.locale),this._clickTolerance=b.clickTolerance,this._pixelRatio=(l=b.pixelRatio)!==null&&l!==void 0?l:devicePixelRatio,this._requestManager=new U(b.transformRequest),typeof b.container=="string"){if(this._container=document.getElementById(b.container),!this._container)throw new Error(`Container '${b.container}' not found.`)}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Ju(this,b),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=b.hash&&new La(typeof b.hash=="string"&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,a.extend({},b.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=b.localIdeographFontFamily,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new Sl({customAttribution:b.customAttribution})),b.maplibreLogo&&this.addControl(new T0,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",p=>{this._update(p.dataType==="style"),this.fire(new a.Event(`${p.dataType}data`,p))}),this.on("dataloading",p=>{this.fire(new a.Event(`${p.dataType}dataloading`,p))}),this.on("dataabort",p=>{this.fire(new a.Event("sourcedataabort",p))})}_getMapId(){return this._mapId}addControl(b,l){if(l===void 0&&(l=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=b.onAdd(this);this._controls.push(b);const v=this._controlPositions[l];return l.indexOf("bottom")!==-1?v.insertBefore(p,v.firstChild):v.appendChild(p),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(b);return l>-1&&this._controls.splice(l,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,l,p,v){return v==null&&this.style.terrain&&(v=this.transform.getElevation(p,this.style.terrain)),super.calculateCameraOptionsFromTo(b,l,p,v)}resize(b){const l=this._containerDimensions(),p=l[0],v=l[1];this._resizeCanvas(p,v,this.getPixelRatio()),this.transform.resize(p,v),this.painter.resize(p,v,this.getPixelRatio());const E=!this._moving;return E&&(this.stop(),this.fire(new a.Event("movestart",b)).fire(new a.Event("move",b))),this.fire(new a.Event("resize",b)),E&&this.fire(new a.Event("moveend",b)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(b){const[l,p]=this._containerDimensions();this._pixelRatio=b,this._resizeCanvas(l,p,b),this.painter.resize(l,p,b)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(a.LngLatBounds.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this._update()}project(b){return this.transform.locationPoint(a.LngLat.convert(b),this.style&&this.style.terrain)}unproject(b){return this.transform.pointLocation(a.pointGeometry.convert(b),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(b,l,p){if(b==="mouseenter"||b==="mouseover"){let v=!1;return{layer:l,listener:p,delegates:{mousemove:P=>{const z=this.getLayer(l)?this.queryRenderedFeatures(P.point,{layers:[l]}):[];z.length?v||(v=!0,p.call(this,new Ki(b,this,P.originalEvent,{features:z}))):v=!1},mouseout:()=>{v=!1}}}}if(b==="mouseleave"||b==="mouseout"){let v=!1;return{layer:l,listener:p,delegates:{mousemove:z=>{(this.getLayer(l)?this.queryRenderedFeatures(z.point,{layers:[l]}):[]).length?v=!0:v&&(v=!1,p.call(this,new Ki(b,this,z.originalEvent)))},mouseout:z=>{v&&(v=!1,p.call(this,new Ki(b,this,z.originalEvent)))}}}}{const v=E=>{const P=this.getLayer(l)?this.queryRenderedFeatures(E.point,{layers:[l]}):[];P.length&&(E.features=P,p.call(this,E),delete E.features)};return{layer:l,listener:p,delegates:{[b]:v}}}}on(b,l,p){if(p===void 0)return super.on(b,l);const v=this._createDelegatedListener(b,l,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(v);for(const E in v.delegates)this.on(E,v.delegates[E]);return this}once(b,l,p){if(p===void 0)return super.once(b,l);const v=this._createDelegatedListener(b,l,p);for(const E in v.delegates)this.once(E,v.delegates[E]);return this}off(b,l,p){return p===void 0?super.off(b,l):(this._delegatedListeners&&this._delegatedListeners[b]&&(v=>{const E=this._delegatedListeners[b];for(let P=0;P<E.length;P++){const z=E[P];if(z.layer===l&&z.listener===p){for(const N in z.delegates)this.off(N,z.delegates[N]);return E.splice(P,1),this}}})(),this)}queryRenderedFeatures(b,l){if(!this.style)return[];let p;if(l!==void 0||b===void 0||b instanceof a.pointGeometry||Array.isArray(b)||(l=b,b=void 0),l=l||{},(b=b||[[0,0],[this.transform.width,this.transform.height]])instanceof a.pointGeometry||typeof b[0]=="number")p=[a.pointGeometry.convert(b)];else{const v=a.pointGeometry.convert(b[0]),E=a.pointGeometry.convert(b[1]);p=[v,new a.pointGeometry(E.x,v.y),E,new a.pointGeometry(v.x,E.y),v]}return this.style.queryRenderedFeatures(p,l,this.transform)}querySourceFeatures(b,l){return this.style.querySourceFeatures(b,l)}setStyle(b,l){return(l=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(b,l))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const l=this._locale[b];if(l==null)throw new Error(`Missing UI string '${b}'`);return l}_updateStyle(b,l){return this.style&&(this.style.setEventedParent(null),this.style._remove()),b?(this.style=new ge(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b):this.style.loadJSON(b),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ge(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,l){if(typeof b=="string"){const p=this._requestManager.transformRequest(b,a.ResourceType.Style);a.getJSON(p,(v,E)=>{v?this.fire(new a.ErrorEvent(v)):E&&this._updateDiff(E,l)})}else typeof b=="object"&&this._updateDiff(b,l)}_updateDiff(b,l){try{this.style.setState(b)&&this._update(!0)}catch(p){a.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(b,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(b,l){return this._lazyInitEmptyStyle(),this.style.addSource(b,l),this._update(!0)}isSourceLoaded(b){const l=this.style&&this.style.sourceCaches[b];if(l!==void 0)return l.loaded();this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){return this.style.setTerrain(b),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const l in b){const p=b[l]._tiles;for(const v in p){const E=p[v];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}addSourceType(b,l,p){return this._lazyInitEmptyStyle(),this.style.addSourceType(b,l,p)}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}addImage(b,l,{pixelRatio:p=1,sdf:v=!1,stretchX:E,stretchY:P,content:z}={}){if(this._lazyInitEmptyStyle(),l instanceof HTMLImageElement||a.isImageBitmap(l)){const{width:N,height:G,data:$}=a.exported.getImageData(l);this.style.addImage(b,{data:new a.RGBAImage({width:N,height:G},$),pixelRatio:p,stretchX:E,stretchY:P,content:z,sdf:v,version:0})}else{if(l.width===void 0||l.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:G,data:$}=l,K=l;this.style.addImage(b,{data:new a.RGBAImage({width:N,height:G},new Uint8Array($)),pixelRatio:p,stretchX:E,stretchY:P,content:z,sdf:v,version:0,userImage:K}),K.onAdd&&K.onAdd(this,b)}}}updateImage(b,l){const p=this.style.getImage(b);if(!p)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=l instanceof HTMLImageElement||a.isImageBitmap(l)?a.exported.getImageData(l):l,{width:E,height:P,data:z}=v;if(E===void 0||P===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(E!==p.data.width||P!==p.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const N=!(l instanceof HTMLImageElement||a.isImageBitmap(l));p.data.replace(z,N),this.style.updateImage(b,p)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b,l){a.getImage(this._requestManager.transformRequest(b,a.ResourceType.Image),l)}listImages(){return this.style.listImages()}addLayer(b,l){return this._lazyInitEmptyStyle(),this.style.addLayer(b,l),this._update(!0)}moveLayer(b,l){return this.style.moveLayer(b,l),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}setLayerZoomRange(b,l,p){return this.style.setLayerZoomRange(b,l,p),this._update(!0)}setFilter(b,l,p={}){return this.style.setFilter(b,l,p),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,l,p,v={}){return this.style.setPaintProperty(b,l,p,v),this._update(!0)}getPaintProperty(b,l){return this.style.getPaintProperty(b,l)}setLayoutProperty(b,l,p,v={}){return this.style.setLayoutProperty(b,l,p,v),this._update(!0)}getLayoutProperty(b,l){return this.style.getLayoutProperty(b,l)}setLight(b,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,l),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(b,l){return this.style.setFeatureState(b,l),this._update()}removeFeatureState(b,l){return this.style.removeFeatureState(b,l),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,l=0;return this._container&&(b=this._container.clientWidth||400,l=this._container.clientHeight||300),[b,l]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map","mapboxgl-map");const l=this._canvasContainer=L.create("div","maplibregl-canvas-container mapboxgl-canvas-container",b);this._interactive&&l.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=L.create("canvas","maplibregl-canvas mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const p=this._containerDimensions();this._resizeCanvas(p[0],p[1],this.getPixelRatio());const v=this._controlContainer=L.create("div","maplibregl-control-container mapboxgl-control-container",b),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{E[P]=L.create("div",`maplibregl-ctrl-${P} mapboxgl-ctrl-${P}`,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const b=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=L.create("div","maplibregl-cooperative-gesture-screen",b);let l="Control",p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",l="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${p}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",v=>{v.key===l&&(this._metaPress=!0)}),document.addEventListener("keyup",v=>{v.key===l&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",v=>{this._onCooperativeGesture(v,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(b,l,p){this._canvas.width=p*b,this._canvas.height=p*l,this._canvas.style.width=`${b}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const b=a.extend({},y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl",b)||this._canvas.getContext("experimental-webgl",b);l?(this.painter=new br(l,this.transform),a.exported$1.testSupport(l)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:b}))}_contextRestored(b){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:b}))}_onMapScroll(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(b,l,p){return!l&&p<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){let l,p=0;const v=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(l=v.createQueryEXT(),v.beginQueryEXT(v.TIME_ELAPSED_EXT,l),p=a.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let E=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,N=a.exported.now();this.style.zoomHistory.update(z,N);const G=new a.EvaluationParameters(z,{now:N,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=G.crossFadingFactor();$===1&&$===this._crossFadingFactor||(E=!0,this._crossFadingFactor=$),this.style.update(G)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.load),this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||E)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const z=a.exported.now()-p;v.endQueryEXT(v.TIME_ELAPSED_EXT,l),setTimeout(()=>{const N=v.getQueryObjectEXT(l,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(l),this.fire(new a.Event("gpu-timing-frame",{cpuTime:z,gpuTime:N}))},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(z);this.fire(new a.Event("gpu-timing-layer",{layerTimes:N}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty;return P||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),L.remove(this._canvasContainer),L.remove(this._controlContainer),this._cooperativeGestures&&L.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),a.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.exported.frame(b=>{a.PerformanceUtils.frame(b),this._frame=null,this._render(b)}))}_onWindowOnline(){this._update()}_onWindowResize(b){this._trackResize&&this.resize({originalEvent:b})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}_setCacheLimits(b,l){a.setCacheLimits(b,l)}get version(){return"2.4.0"}},NavigationControl:class{constructor(b){this.options=a.extend({},nh,b),this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const b=this._map.getZoom(),l=b===this._map.getMaxZoom(),p=b===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const b=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=b}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ei(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,l){const p=L.create("button",b,this._container);return p.type="button",p.addEventListener("click",l),p}_setButtonTitle(b,l){const p=this._map._getUIString(`NavigationControl.${l}`);b.title=p,b.setAttribute("aria-label",p)}},GeolocateControl:class extends a.Evented{constructor(b){super(),this.options=a.extend({},kc,b),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(b){var l;return this._map=b,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Po!==void 0?l(Po):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(p=>{Po=p.state!=="denied",l(Po)}):(Po=!!window.navigator.geolocation,l(Po)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,er=0,Js=!1}_isOutOfMapMaxBounds(b){const l=this._map.getMaxBounds(),p=b.coords;return l&&(p.longitude<l.getWest()||p.longitude>l.getEast()||p.latitude<l.getSouth()||p.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(b),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",b)),this._finish()}}_updateCamera(b){const l=new a.LngLat(b.coords.longitude,b.coords.latitude),p=b.coords.accuracy,v=this._map.getBearing(),E=a.extend({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(p),E,{geolocateSource:!0})}_updateMarker(b){if(b){const l=new a.LngLat(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const b=this._map._container.clientHeight/2,l=this._map.unproject([0,b]),p=this._map.unproject([1,b]),v=l.distanceTo(p),E=Math.ceil(2*this._accuracy/v);this._circleElement.style.width=`${E}px`,this._circleElement.style.height=`${E}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(b){if(this._map){if(this.options.trackUserLocation)if(b.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(b.code===3&&Js)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",b)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(b){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=L.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",b===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ji(this._dotElement),this._circleElement=L.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ji({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":er--,Js=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),er++,er>1?(b={maximumAge:6e5,timeout:0},Js=!0):(b=this.options.positionOptions,Js=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Sl,LogoControl:T0,ScaleControl:class{constructor(b){this.options=a.extend({},ms,b),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Lc(this._map,this._container,this.options)}onAdd(b){return this._map=b,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(b){this.options.unit=b,Lc(this._map,this._container,this.options)}},FullscreenControl:class{constructor(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){L.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const b=this._fullscreenButton=L.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(b){this.options=b,a.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(b){return this._map=b,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=L.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){L.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends a.Evented{constructor(b){super(),this.options=a.extend(Object.create(wi),b),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const l=document.createDocumentFragment(),p=document.createElement("body");let v;for(p.innerHTML=b;v=p.firstChild,v;)l.appendChild(v);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){this._container&&this._container.classList.add(b)}removeClassName(b){this._container&&this._container.classList.remove(b)}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}_createCloseButton(){this.options.closeButton&&(this._closeButton=L.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(b){this._update(b.point)}_onMouseMove(b){this._update(b.point)}_onDrag(b){this._update(b.point)}_update(b){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=L.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=L.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(P=>this._container.classList.add(P)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Cl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!b))return;const l=this._pos=this._trackPointer&&b?b:this._map.project(this._lngLat);let p=this.options.anchor;const v=Dc(this.options.offset);if(!p){const P=this._container.offsetWidth,z=this._container.offsetHeight;let N;N=l.y+v.bottom.y<z?["top"]:l.y>this._map.transform.height-z?["bottom"]:[],l.x<P/2?N.push("left"):l.x>this._map.transform.width-P/2&&N.push("right"),p=N.length===0?"bottom":N.join("-")}const E=l.add(v[p]).round();L.setTransform(this._container,`${Ht[p]} translate(${E.x}px,${E.y}px)`),Kt(this._container,p,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(zi);b&&b.focus()}_onClose(){this.remove()}},Marker:Ji,Style:ge,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,AJAXError:a.AJAXError,config:a.config,CanvasSource:In,GeoJSONSource:Zn,ImageSource:Ot,RasterDEMTileSource:Ft,RasterTileSource:Tt,VectorTileSource:ht,VideoSource:Jt,prewarm:function(){Qn().acquire(dt)},clearPrewarmedResources:function(){const b=ri;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(dt),ri=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Fn.workerCount},set workerCount(b){Fn.workerCount=b},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){a.config.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage(b){a.clearTileCache(b)},workerUrl:"",addProtocol(b,l){a.config.REGISTERED_PROTOCOLS[b]=l},removeProtocol(b){delete a.config.REGISTERED_PROTOCOLS[b]}};return Zr.extend(ea,{isSafari:a.isSafari,getPerformanceMetrics:a.PerformanceUtils.getPerformanceMetrics}),ea});var u=r;return u})})(jP);var fne=jP.exports;const Ane=s3(fne),dne="modulepreload",pne=function(t){return"/"+t},_w={},mne=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=pne(s),s in _w)return;_w[s]=!0;const u=s.endsWith(".css"),a=u?'[rel="stylesheet"]':"";if(!!i)for(let M=r.length-1;M>=0;M--){const R=r[M];if(R.href===s&&(!u||R.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const w=document.createElement("link");if(w.rel=u?"stylesheet":dne,u||(w.as="script",w.crossOrigin=""),w.href=s,document.head.appendChild(w),u)return new Promise((M,R)=>{w.addEventListener("load",M),w.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=s,window.dispatchEvent(u),!u.defaultPrevented)throw s})},gne=_t.createContext(null);function _ne(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===s}function Vl(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Vl(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const r of n)if(!e.hasOwnProperty(r)||!Vl(t[r],e[r]))return!1;return!0}return!1}function yne(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function yw(t,e){if(!t.getProjection)return;const n=t.getProjection(),i=e.getProjection();Vl(n,i)||e.setProjection(n)}function vw(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function xw(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const r=t.center;t.center=new r.constructor(n.longitude,n.latitude),i=i||r!==t.center}if("zoom"in n){const r=t.zoom;t.zoom=n.zoom,i=i||r!==t.zoom}if("bearing"in n){const r=t.bearing;t.bearing=n.bearing,i=i||r!==t.bearing}if("pitch"in n){const r=t.pitch;t.pitch=n.pitch,i=i||r!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const vne=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ww(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const i of t.layers)e[i.id]=i;const n=t.layers.map(i=>{let r=null;"interactive"in i&&(r=Object.assign({},i),delete r.interactive);const s=e[i.ref];if(s){r=r||Object.assign({},i),delete r.ref;for(const u of vne)u in s&&(r[u]=s[u])}return r||i});return{...t,layers:n}}const bw={version:8,sources:{},layers:[]},Ew={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},X4={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Tw={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},xne=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],wne=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class M1{constructor(e,n,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const s=this.props[Tw[r.type]];s?s(r):r.type==="error"&&console.error(r.error)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const s=this.props[Ew[r.type]];s&&(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"&&(r.features=this._hoveredFeatures||this._queryRenderedFeatures(r.point)),s(r),delete r.features)},this._onCameraEvent=r=>{if(!this._internalUpdate){const s=this.props[X4[r.type]];s&&s(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=n,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const i=this._updateSettings(e,n);i&&this._createShadowTransform(this._map);const r=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(i||r||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const i=M1.savedMaps.pop();if(!i)return null;const r=i.map,s=r.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);r._container=n;const u=r._resizeObserver;u&&(u.disconnect(),u.observe(n)),i.setProps({...e,styleDiffing:!1}),r.resize();const{initialViewState:a}=e;return a&&(a.bounds?r.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):i._updateViewState(a,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),i}_initialize(e){const{props:n}=this,{mapStyle:i=bw}=n,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||bne()||null,container:e,style:ww(i)},s=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const M=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=M,n.gl)}const u=new this._MapClass(r);s.padding&&u.setPadding(s.padding),n.cursor&&(u.getCanvas().style.cursor=n.cursor),this._createShadowTransform(u);const a=u._render;u._render=M=>{this._inRender=!0,a.call(u,M),this._inRender=!1};const y=u._renderTaskQueue.run;u._renderTaskQueue.run=M=>{y.call(u._renderTaskQueue,M),this._onBeforeRepaint()},u.on("render",()=>this._onAfterRepaint());const w=u.fire;u.fire=this._fireEvent.bind(this,w),u.on("resize",()=>{this._renderTransform.resize(u.transform.width,u.transform.height)}),u.on("styledata",()=>{this._updateStyleComponents(this.props,{}),yw(u.transform,this._renderTransform)}),u.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const M in Ew)u.on(M,this._onPointerEvent);for(const M in X4)u.on(M,this._onCameraEvent);for(const M in Tw)u.on(M,this._onEvent);this._map=u}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),M1.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=yne(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const i=this._map;if(n.width!==i.transform.width||n.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const i=this._map,r=this._renderTransform,{zoom:s,pitch:u,bearing:a}=r,y=i.isMoving();y&&(r.cameraElevationReference="sea");const w=xw(r,{...vw(i.transform),...e});if(y&&(r.cameraElevationReference="ground"),w&&n){const M=this._deferredEvents;M.move=!0,M.zoom||(M.zoom=s!==r.zoom),M.rotate||(M.rotate=a!==r.bearing),M.pitch||(M.pitch=u!==r.pitch)}return y||xw(i.transform,e),w}_updateSettings(e,n){const i=this._map;let r=!1;for(const s of xne)if(s in e&&!Vl(e[s],n[s])){r=!0;const u=i[`set${s[0].toUpperCase()}${s.slice(1)}`];u?.call(i,e[s])}return r}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:i=bw,styleDiffing:r=!0}=e,s={diff:r};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(ww(i),s),!0}return!1}_updateStyleComponents(e,n){const i=this._map;let r=!1;return i.isStyleLoaded()&&("light"in e&&i.setLight&&!Vl(e.light,n.light)&&(r=!0,i.setLight(e.light)),"fog"in e&&i.setFog&&!Vl(e.fog,n.fog)&&(r=!0,i.setFog(e.fog)),"terrain"in e&&i.setTerrain&&!Vl(e.terrain,n.terrain)&&(!e.terrain||i.getSource(e.terrain.source))&&(r=!0,i.setTerrain(e.terrain))),r}_updateHandlers(e,n){var i,r;const s=this._map;let u=!1;for(const a of wne){const y=(i=e[a])!==null&&i!==void 0?i:!0,w=(r=n[a])!==null&&r!==void 0?r:!0;Vl(y,w)||(u=!0,y?s[a].enable(y):s[a].disable())}return u}_queryRenderedFeatures(e){const n=this._map,i=n.transform,{interactiveLayerIds:r=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=i}}_updateHover(e){var n;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const s=e.type,u=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),y=a.length>0;!y&&u&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,y&&!u&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,i){const r=this._map,s=r.transform,u=typeof n=="string"?n:n.type;return u==="move"&&this._updateViewState(this.props,!1),u in X4&&(typeof n=="object"&&(n.viewState=vw(s)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,n,i),r.transform=s,r):(e.call(r,n,i),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{yw(this._renderTransform,n),e.transform=n}}}M1.savedMaps=[];function bne(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const Ene=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Tne(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>{const r=e.transform;e.transform=t.transform;const s=e.project(i);return e.transform=r,s},unproject:i=>{const r=e.transform;e.transform=t.transform;const s=e.unproject(i);return e.transform=r,s},queryTerrainElevation:(i,r)=>{const s=e.transform;e.transform=t.transform;const u=e.queryTerrainElevation(i,r);return e.transform=s,u},queryRenderedFeatures:(i,r)=>{const s=e.transform;e.transform=t.transform;const u=e.queryRenderedFeatures(i,r);return e.transform=s,u}};for(const i of Sne(e))!(i in n)&&!Ene.includes(i)&&(n[i]=e[i].bind(e));return n}function Sne(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))i[0]!=="_"&&typeof t[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}const Cne=typeof document<"u"?_t.useLayoutEffect:_t.useEffect,Pne=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Mne(t,e){for(const i of Pne)i in e&&(t[i]=e[i]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,i=>{i&&console.error(i)},!1)}const V3=_t.createContext(null);function Ine(t,e,n){const i=_t.useContext(gne),[r,s]=_t.useState(null),u=_t.useRef(),{current:a}=_t.useRef({mapLib:null,map:null});_t.useEffect(()=>{const M=t.mapLib;let R=!0,L;return Promise.resolve(M||n).then(U=>{if(!R)return;if(!U)throw new Error("Invalid mapLib");const q="Map"in U?U:U.default;if(!q.Map)throw new Error("Invalid mapLib");if(Mne(q,t),!q.supported||q.supported(t))t.reuseMaps&&(L=M1.reuse(t,u.current)),L||(L=new M1(q.Map,t,u.current)),a.map=Tne(L),a.mapLib=q,s(L),i?.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(U=>{const{onError:q}=t;q?q({type:"error",target:null,originalEvent:null,error:U}):console.error(U)}),()=>{R=!1,L&&(i?.onMapUnmount(t.id),t.reuseMaps?L.recycle():L.destroy())}},[]),Cne(()=>{r&&r.setProps(t)}),_t.useImperativeHandle(e,()=>a.map,[r]);const y=_t.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),w={height:"100%"};return _t.createElement("div",{id:t.id,ref:u,style:y},r&&_t.createElement(V3.Provider,{value:a},_t.createElement("div",{"mapboxgl-children":"",style:w},t.children)))}const kne=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Iu(t,e){if(!t||!e)return;const n=t.style;for(const i in e){const r=e[i];Number.isFinite(r)&&!kne.test(i)?n[i]=`${r}px`:n[i]=r}}function Lne(t,e){const{map:n,mapLib:i}=_t.useContext(V3),r=_t.useRef({props:t});r.current.props=t;const s=_t.useMemo(()=>{let te=!1;_t.Children.forEach(t.children,ie=>{ie&&(te=!0)});const pe={...t,element:te?document.createElement("div"):null},ne=new i.Marker(pe);return ne.setLngLat([t.longitude,t.latitude]),ne.getElement().addEventListener("click",ie=>{var re,_e;(_e=(re=r.current.props).onClick)===null||_e===void 0||_e.call(re,{type:"click",target:ne,originalEvent:ie})}),ne.on("dragstart",ie=>{var re,_e;const Te=ie;Te.lngLat=s.getLngLat(),(_e=(re=r.current.props).onDragStart)===null||_e===void 0||_e.call(re,Te)}),ne.on("drag",ie=>{var re,_e;const Te=ie;Te.lngLat=s.getLngLat(),(_e=(re=r.current.props).onDrag)===null||_e===void 0||_e.call(re,Te)}),ne.on("dragend",ie=>{var re,_e;const Te=ie;Te.lngLat=s.getLngLat(),(_e=(re=r.current.props).onDragEnd)===null||_e===void 0||_e.call(re,Te)}),ne},[]);_t.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:u,latitude:a,offset:y,style:w,draggable:M=!1,popup:R=null,rotation:L=0,rotationAlignment:U="auto",pitchAlignment:q="auto"}=t;return _t.useEffect(()=>{Iu(s.getElement(),w)},[w]),_t.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==u||s.getLngLat().lat!==a)&&s.setLngLat([u,a]),y&&!_ne(s.getOffset(),y)&&s.setOffset(y),s.isDraggable()!==M&&s.setDraggable(M),s.getRotation()!==L&&s.setRotation(L),s.getRotationAlignment()!==U&&s.setRotationAlignment(U),s.getPitchAlignment()!==q&&s.setPitchAlignment(q),s.getPopup()!==R&&s.setPopup(R),O6.createPortal(t.children,s.getElement())}_t.memo(_t.forwardRef(Lne));function Sw(t){return new Set(t?t.trim().split(/\s+/):[])}function Dne(t,e){const{map:n,mapLib:i}=_t.useContext(V3),r=_t.useMemo(()=>document.createElement("div"),[]),s=_t.useRef({props:t});s.current.props=t;const u=_t.useMemo(()=>{const a={...t},y=new i.Popup(a);return y.setLngLat([t.longitude,t.latitude]),y.once("open",w=>{var M,R;(R=(M=s.current.props).onOpen)===null||R===void 0||R.call(M,w)}),y},[]);if(_t.useEffect(()=>{const a=y=>{var w,M;(M=(w=s.current.props).onClose)===null||M===void 0||M.call(w,y)};return u.on("close",a),u.setDOMContent(r).addTo(n.getMap()),()=>{u.off("close",a),u.isOpen()&&u.remove()}},[]),_t.useEffect(()=>{Iu(u.getElement(),t.style)},[t.style]),_t.useImperativeHandle(e,()=>u,[]),u.isOpen()&&((u.getLngLat().lng!==t.longitude||u.getLngLat().lat!==t.latitude)&&u.setLngLat([t.longitude,t.latitude]),t.offset&&!Vl(u.options.offset,t.offset)&&u.setOffset(t.offset),(u.options.anchor!==t.anchor||u.options.maxWidth!==t.maxWidth)&&(u.options.anchor=t.anchor,u.setMaxWidth(t.maxWidth)),u.options.className!==t.className)){const a=Sw(u.options.className),y=Sw(t.className);for(const w of a)y.has(w)||u.removeClassName(w);for(const w of y)a.has(w)||u.addClassName(w);u.options.className=t.className}return O6.createPortal(t.children,r)}_t.memo(_t.forwardRef(Dne));function tA(t,e,n,i){const r=_t.useContext(V3),s=_t.useMemo(()=>t(r),[]);return _t.useEffect(()=>{const u=i||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,y=typeof n=="function"?n:typeof e=="function"?e:null,{map:w}=r;return w.hasControl(s)||(w.addControl(s,u?.position),a&&a(r)),()=>{y&&y(r),w.hasControl(s)&&w.removeControl(s)}},[]),s}function Rne(t){const e=tA(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return _t.useEffect(()=>{Iu(e._container,t.style)},[t.style]),null}_t.memo(Rne);function zne(t){const e=tA(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return _t.useEffect(()=>{Iu(e._controlContainer,t.style)},[t.style]),null}_t.memo(zne);function Bne(t,e){const n=_t.useRef({props:t}),i=tA(({mapLib:r})=>{const s=new r.GeolocateControl(t),u=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||u(a)},s.on("geolocate",a=>{var y,w;(w=(y=n.current.props).onGeolocate)===null||w===void 0||w.call(y,a)}),s.on("error",a=>{var y,w;(w=(y=n.current.props).onError)===null||w===void 0||w.call(y,a)}),s.on("outofmaxbounds",a=>{var y,w;(w=(y=n.current.props).onOutOfMaxBounds)===null||w===void 0||w.call(y,a)}),s.on("trackuserlocationstart",a=>{var y,w;(w=(y=n.current.props).onTrackUserLocationStart)===null||w===void 0||w.call(y,a)}),s.on("trackuserlocationend",a=>{var y,w;(w=(y=n.current.props).onTrackUserLocationEnd)===null||w===void 0||w.call(y,a)}),s},{position:t.position});return n.current.props=t,_t.useImperativeHandle(e,()=>i,[]),_t.useEffect(()=>{Iu(i._container,t.style)},[t.style]),null}_t.memo(_t.forwardRef(Bne));function One(t){const e=tA(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return _t.useEffect(()=>{Iu(e._container,t.style)},[t.style]),null}_t.memo(One);function Fne(t){const e=tA(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=_t.useRef(t),i=n.current;n.current=t;const{style:r}=t;return t.maxWidth!==void 0&&t.maxWidth!==i.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==i.unit&&e.setUnit(t.unit),_t.useEffect(()=>{Iu(e._container,r)},[r]),null}_t.memo(Fne);const Nne=mne(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),Une=(()=>_t.forwardRef(function(e,n){return Ine(e,n,Nne)}))(),Vne=8,Gne="Positron",jne={},Hne={carto:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"}},Wne="https://tiles.basemaps.cartocdn.com/gl/positron-gl-style/sprite",$ne="https://tiles.basemaps.cartocdn.com/fonts/{fontstack}/{range}.pbf",qne=[{id:"waterway_label",type:"symbol",source:"carto","source-layer":"waterway",filter:["all",["has","name"],["==","class","river"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-placement":"line","symbol-spacing":100,"symbol-avoid-edges":!1,"text-size":27,"text-padding":2,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-offset":[0,-.2],"text-letter-spacing":0,"text-keep-upright":!0},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"watername_ocean",type:"symbol",source:"carto","source-layer":"water_name",minzoom:0,maxzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","ocean"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_sea",type:"symbol",source:"carto","source-layer":"water_name",minzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","sea"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_lake",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","Point"],["==","class","lake"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"point","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto"},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"watername_lake_line",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","LineString"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"line","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-spacing":350,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-line-height":1.2},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"place_city_r6",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",6]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,12],[9,13],[10,14],[13,17],[14,20]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_r5",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",0],["<=","rank",5]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,14],[10,16],[13,19],[14,22]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",["!has","capital"],["!in","class","country","state"],[">=","rank",0],["<=","rank",7]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_capital_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",[">","capital",0]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"poi_stadium",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["in","class","stadium","cemetery","attraction"],["<=","rank",3]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"poi_park",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["==","class","park"]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"roadname_minor",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:16,filter:["all",["in","class","minor","service"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":9,"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_sec",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:15,filter:["all",["in","class","secondary","tertiary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,9],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_pri",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:14,filter:["all",["in","class","primary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[14,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_major",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:13,filter:["all",["in","class","trunk","motorway"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[13,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}}],Zne="voyager",Xne="Carto",Qne={version:Vne,name:Gne,metadata:jne,sources:Hne,sprite:Wne,glyphs:$ne,layers:qne,id:Zne,owner:Xne},Yne=Object.keys(G2).map(t=>parseInt(t));function Kne({layers:t,setCurRes:e,curViewState:n,getTooltip:i}){return En.createElement(ute,{onViewStateChange:({viewState:r})=>{e(il().domain([0,1]).range(Yne)(Vte(r.zoom)))},layers:t,effects:[Kte],initialViewState:n,controller:!0,getTooltip:i},En.createElement(Une,{reuseMaps:!0,mapLib:Ane,mapStyle:Qne,preventStyleDiffing:!0}))}const WP={0:"This is Californias <b>Central Valley</b>, home to over 7 million people and 18% of Californias total population. (2020 US Census)",1:"We have lots of demand that tends to cycle through highs and lows depending on the time of the year, peaking at around July. Each drop that you see represents a unit of <b>demand</b> for water.",2:"However, our groundwater supply stays consistent throughout the year, and usually cannot keep up during peak demands.",3:"This leads to unmet demand. For example, take May 2007. This is the demand of that month.",4:"As you can see, not everyone will get their demand. Notice anything?",5:"Lets try another timestep. This is water demand from July 2021.",6:"This is unmet demand.",7:`This is the average over 100 years. We can see that the areas of <b style="color: rgb(${q4});">unmet demand</b> does not necessarily correspond with areas of <b style="color: rgb(${Zh});">demand</b>.`,8:"If we take a closer look at this region, we can investigate what might have contributed to this inequity.",9:`If we overlay the map with land holders, we can see that exchange holders, symbolized with cows, are the ones predominantly demanding high amounts of <b style="color: rgb(${Zh});">demand</b>. However, they arent suffering from as high <b style="color: rgb(${q4});">unmet demand</b>. In fact, they seem to be doing quite well.`,10:`What we should expect is more of the following. Here, a patch of land held by project holders are symbolized with a paper scroll. This area contends with high levels of <b style="color: rgb(${q4});">unmet demand</b>; this is expected, since it has high levels of <b style="color: rgb(${Zh});">demand</b>.`,11:`On the other hand, settlement holders are similar to exchange holders in that they also historically have <b style="color: rgb(${Zh});">high demand</b>, but get special treatment as well.`,12:"In fact, we can see on average, settlement and exchange land holders get higher water supply rates because they are higher priority; this is how they are able to maintain low average levels of unmet demand even though they have high average levels of demand.",13:"And this does not necessarily correspond to groundwater supply.",14:"Thus, we can see that due to certain government policies, certain regions get higher priority and access to water supply, even if their demand largely outweigh surrounding regions. The question is, is this the only option?",15:"Certainly not. That is where CalSim comes in, a simulation program that plays out the what-if scenarios. Imagine an alternate universe where government policies were different; well call this Scenario 1. Let us revisit the first time step from earlier, May 2007.",16:`This time, the rings indicate regions that are doing <b style="color: rgb(${Gte});">better</b> or <b style="color: rgb(${jte});">worse</b> than real-life, or historical, baselines.`,17:"Notice that now in this region, unmet demand is now more equal across regions, at the cost of some regions doing better than historical levels and other regions doing worse than historical levels.",18:"What about another alternate scenario, Scenario 2? We can see that this scenario favors less equal distribution of unmet demand at the tradeoff of keeping levels closer to baseline historical level.",19:"Scenario 3 is somewhere in between.",20:"Heres a timestep with more dramatic differences between scenarios, July 2021.",21:"As you may have noticed, rarely is there a situation where everyone wins. Tradeoffs must be made between regions, if not between months, and who and when to save water. With climate change and increasing population in the Central Valley, these choices become all the more pertinent. Which scenario is best? That choice is up to <b>you</b>.<br/><i>Data from James Gilbert (NOAA)</i>"},Jne=Object.values(WP).length;function eie({slide:t,transitioning:e}){if(!(e||t>=22))return En.createElement("div",{className:"cardContainer"},En.createElement("p",{className:"cardP",dangerouslySetInnerHTML:{__html:WP[t%Jne]}}))}const tie=[-6.1795967885680545,-2.74068993617841,-.7818130172957225,-2.025945041302708,-.18570206401474082,-1.5072469465725338,-12.963296848037203,-15.525215279409002,-19.452466414571056,-23.575180023928628,-18.33541536637407,-10.668586595666818,-4.064098395020311,-1.8591447518930817,-.6164796929841818,-2.328627801425199,-1.04858956791722,-4.2089464332153605,-7.975190426458526,-16.64793622538284,-16.70911768884974,-22.255249068465815,-18.349991367992995,-7.590369355546259,-5.431816941979197,-3.0543942667140263,-1.0977725983523345,-2.4927046405987463,-1.7941288292605633,-4.540602204238128,-20.09304877749699,-23.272142866405414,-24.724693747133813,-27.238008018795874,-21.95314745956582,-11.509922710777635,-3.4445972832353453,-2.5132096799604184,-.8437164307822946,-2.8356895955622745,-1.0873190616797863,-2.75072016673305,-11.332369640572818,-13.016670933655183,-20.21925925305027,-24.13234011030728,-18.332081938995618,-8.439729854646925,-5.816042345466243,-2.7698899203817264,-1.0394764160665577,-2.3789728403971764,-.699103036336698,-4.5018646937787095,-9.10407077029478,-18.70942164328822,-23.49481107911643,-25.777856169310674,-19.88332043235565,-10.096548283520487,-5.203303502411558,-1.668212772420784,-.9457217020927369,-2.481438615312462,-.4799292129915347,-2.1100360819161335,-12.274940733043026,-17.394344733571515,-18.578726735053195,-23.948069978781724,-18.65644588353055,-9.380256694418279,-3.9503644042768475,-2.336577777415818,-.7825939279842343,-2.8143541843189075,-1.2361942677858988,-3.1278035186711697,-15.253424046425403,-19.372120090242536,-21.307808725067705,-24.068678794077766,-20.20165973620545,-10.637134242202432,-6.427343978480874,-1.7243324449098714,-.7883620526997088,-2.542315567153562,-1.277623992866032,-3.6467031953365865,-15.662240871339675,-21.088624232392238,-18.921311084893745,-26.657495913468114,-22.561804186351658,-11.643155489085766,-7.460076575003645,-3.550988477584742,-1.1588717036305138,-2.027891335006261,-1.0188100710040429,-2.876704947499099,-15.18673776537887,-16.921700626330853,-22.91445313145012,-25.72960543146255,-20.34261188648174,-9.160206411833373,-6.303524575679716,-2.8240882678636345,-1.300347314200392,-2.0162291770957057,-1.1107174456612716,-4.825456348575722,-20.026770898515473,-20.66638851928845,-22.048890213733397,-31.560268442677327,-25.350872831175177,-12.038772678824495,-7.264561185435756,-2.4799223418202665,-.7510225287777859,-2.604999326697283,-.620525089720037,-3.428128401150883,-14.717088262594851,-17.442063637636466,-22.843481577475895,-25.890287177448183,-21.304387612629185,-12.118864520815267,-7.373863299014655,-3.499801933772607,-1.1062695193703427,-1.9303267161543987,-1.482699642309893,-3.4904730121297933,-18.395405196118283,-16.46695543525729,-22.36919821018006,-30.055744508657934,-23.57382634803674,-11.37755390123606,-6.830628627729941,-3.6938509577916667,-.9064121323585169,-2.755303667346682,-.9699480213291808,-5.0947998758038,-19.854628487400444,-20.330006699730024,-21.607363290559626,-28.711824776159165,-24.00504231258545,-12.303786819470824,-6.41059877599799,-2.073025305672112,-.8542416260834403,-2.04628745910725,-.977462292005509,-1.1902933425380817,-6.983904739705557,-18.595684280139675,-22.25838613470556,-24.23782469031429,-20.75818419799641,-10.912919580273773,-4.889063379936425,-2.6886681898982623,-1.0887124656250995,-2.5322326683458045,-.33195100033154296,-2.1603498354894644,-12.732734244024837,-17.147648766401517,-18.594332838494495,-23.95833289024715,-20.42718675173729,-10.54672262411126,-5.579436470124167,-3.3670213070380117,-.8801690751561058,-2.1581730979918254,-.42252028598889213,-.7803511088976779,-12.475793737588928,-18.940376596230486,-18.880859709339685,-24.169349262771068,-20.683042427649077,-10.401971156879304,-5.442518763558868,-2.8222329625347844,-.8929194431099478,-2.1277574243463264,-.247667960664832,-.5523907739526576,-9.147889120347925,-17.30030868764833,-19.49368315248442,-22.610124629857122,-18.636664402696663,-9.072304237417018,-4.082856848408974,-3.010641614972163,-.9676789191265738,-2.4812255779964647,-1.1632830744387352,-3.651865873893966,-18.325967971030213,-18.298317484246898,-22.19220121007997,-25.558540476066888,-21.23116516144342,-9.100304390314236,-5.9453571681021975,-3.3799620708427236,-1.2417817193457281,-1.4033694645370443,-.2677909508682667,-1.6832104828984378,-13.184125228900442,-18.50151345316918,-22.127984714797037,-23.503171080703716,-19.427280112249235,-9.298232752964896,-4.789585762556959,-3.0895877000918914,-.7610904910087719,-2.043102589169982,-.10865234098532103,-.959880521199622,-5.9682064098049885,-15.404208044060141,-17.872861500740935,-22.488046555948245,-16.851806084414605,-9.10977032939218,-4.22786868835911,-2.761495688008086,-.719803138164379,-2.1631024125422504,-.6696734744501408,-2.3517838196336536,-7.633160902943327,-13.647093673396343,-19.638170052934523,-23.39939269593963,-18.93867728073727,-9.686189310151313,-5.992475174414384,-2.6966616358468074,-.887753949777013,-2.223032341013827,-1.0657730940092132,-.9585637403358891,-12.758729056112859,-18.701249972097244,-18.490054996387638,-22.86063767609289,-18.80366147580871,-10.871813562213054,-5.972317348192701,-3.0262299370928374,-.9651674941610283,-2.3570883365583453,-.5442744866944589,-3.449370967664504,-12.173204810852024,-17.151276043053088,-17.875618067807704,-22.896207927292433,-20.253214640949906,-11.357687006865731,-5.517971304425901,-1.7303331200482899,-.7964065560156354,-2.878499685643728,-.7683896294773568,-1.656516224651939,-15.67539591625622,-15.700685858062819,-19.536405678823037,-25.118157836435138,-19.86483108811524,-10.583167692714918,-3.1370778580073293,-2.2545516913380346,-.7170095604800993,-2.757259721575085,-.8216389771034907,-2.8782418433327024,-16.13370345404446,-16.31078193396884,-19.849676649073658,-23.223934405804016,-20.134678962764834,-10.5405735006886,-5.612613263028453,-1.7924080359981003,-.7668871623088236,-2.797492710040286,-1.2723822160024127,-3.7597806998227745,-17.16520759441341,-19.91213411197488,-19.492910537253152,-23.745326551822373,-19.223512961628668,-11.466568234694325,-3.610404384906405,-2.7197913646046,-1.0346764546383147,-3.084082253442141,-1.8417433999965365,-3.7282706818989335,-9.246335361890383,-12.960703711411384,-18.752727634483765,-23.283073668232827,-19.25323666896647,-10.30628913686904,-5.745443387906452,-3.1849627432795904,-.9993309162158587,-2.6391244356312367,-1.3677072291831651,-2.056818515453768,-18.540344304823687,-16.977149278070616,-22.29777974648696,-24.94938319772981,-19.032416881577422,-10.950436704783426,-6.9715459410667995,-2.9393238456567516,-1.057693176476435,-2.014299556819264,-1.175605549041718,-2.900218799282745,-15.690648668192713,-18.995747579716976,-20.821983398261096,-25.11169533100527,-20.704098113655256,-9.666849618874739,-3.8236780724931823,-2.100000860666511,-.7195786295821935,-2.396597658615997,-.810117353801596,-3.413934143236141,-13.976081246385748,-17.40594173700334,-20.363332031217823,-23.56459863402372,-19.568498398665923,-10.874496599420917,-4.679434354723177,-2.308615410003443,-.7014812200694779,-1.6730651639490304,-.7485470986151529,-.8725489467138814,-10.221306380911047,-17.764750125111206,-16.56758697710979,-22.697630762768494,-19.04769655069582,-9.927964880566782,-6.658946871295272,-2.368330417195727,-.6246685519843607,-2.6383394677892964,-1.4602752913852517,-3.692282190641183,-10.965998008115609,-14.689949055283027,-17.217440296970853,-24.330446887872807,-17.884050909974974,-10.359707599297126,-6.098008777519426,-2.421199937237742,-1.061625072236721,-2.3827204952843943,-1.131571279592712,-2.1989244213173817,-14.29558003145955,-18.99974880819148,-18.933313047876045,-24.24668162264503,-17.641064540696114,-10.066980869094925,-6.553150774253684,-2.423170431901872,-.8189186227017436,-1.8215314584533484,-.8863988086900573,-4.0888609603912265,-11.652748667986083,-16.683306255853683,-20.07490699846736,-23.14299638313245,-20.88234994614944,-10.651748407125208,-6.545751705213646,-2.6280105006780334,-.6431845315213414,-1.800081321140168,-.8698543796498692,-3.608876141894117,-10.935739741638942,-14.676387103141789,-19.44757902629813,-22.398414724008326,-17.820395099767662,-9.299188253342187,-4.393896562901599,-3.3096944747742896,-1.1912707767118973,-2.19958061447099,-1.0290326655364963,-3.696883703300191,-14.35728183027381,-12.840543138455393,-21.13566322984228,-23.892973047489804,-18.975361093343984,-8.512354461876852,-3.525324990976492,-2.9350079622937244,-.9206667556533582,-2.029131706972648,-.259243889879562,-.5065048824860041,-5.895554947088231,-15.416388887389271,-17.109896127151117,-21.631325461138196,-19.32664855199863,-9.600172405268502,-6.514092817547672,-3.2027894718585794,-1.1748147920291432,-2.1191237173335424,-.6341340453673528,-4.238697570737674,-16.694368241814317,-18.63646737382283,-21.90086953577223,-25.42958851378954,-19.515519447352297,-6.003973389805771,-6.881736780903278,-3.4290883081976675,-1.2348139847410406,-2.3191099634358503,-.6449229371659656,-3.8008041662774925,-14.395719814661522,-18.47178887029837,-23.60584306885149,-26.01469889907678,-20.749022383745935,-11.177453568846957,-6.547789345827946,-1.79696025190667,-1.0164610776077827,-2.1738566222252858,-1.4168642925525081,-3.4070457219848054,-16.684604334662954,-17.08139739030518,-23.47114241542194,-27.439970200983254,-21.039113646163717,-10.752625083257092,-7.130478984521748,-2.0642923723753177,-.906692660304387,-2.469840891229575,-.26352128928830315,-2.2357499788484594,-15.62163321094136,-17.74151373592608,-20.965279814953377,-24.51709835487236,-19.394128488536335,-10.6559313440156,-3.8137932531432894,-3.1773212689881203,-1.0114167849154292,-2.569949285303723,-.7160287600621096,-1.8583521707943091,-6.881723094769083,-14.955149333968285,-18.332713254797437,-21.926085599706386,-18.200019595041738,-9.236259991660267,-3.4758174115162954,-1.9301250954101563,-.9324660579639342,-2.4614358480559266,-1.7846612584485981,-4.692151678211272,-16.830088257038398,-17.43348586488174,-18.658372135046722,-23.84320066650761,-19.329080221480577,-9.703279638090951,-4.179063427600699,-2.0745302019434426,-.6828851750451805,-2.520139499790634,-1.232568772586328,-3.1123129486997163,-8.356811351539942,-17.614947179869866,-17.91192167455511,-22.091031288387907,-16.53358198701324,-9.148488176914514,-6.485310047747085,-1.124924218322211,-.668660683976725,-2.564104146468765,-.9140656277250205,-4.015310280680082,-16.103040428808146,-18.840963396617365,-20.600680627219923,-22.463709084626988,-19.971109611464225,-10.167729292794059,-6.76950090436838,-2.192930375954893,-.7327083455812232,-1.8258681802974916,-1.0798158137662626,-1.7546173376587861,-4.643152877191304,-16.416854258408826,-15.851231039481188,-23.016010187037484,-19.651078019631075,-9.593037999892651,-5.901823275829563,-2.4649693101685957,-.9405959273207031,-2.447549308937944,-1.1486705267439974,-3.330263245109542,-17.105924519266736,-17.99067453406316,-21.464799636837153,-23.72217585151361,-17.087424236988895,-10.32380403975084,-4.983140274143808,-1.7950078590661964,-.7014092129920689,-1.099645032889398,-.018511839115764428,-2.100011717946749,-9.927969785659293,-17.578605857354585,-16.788562720992836,-22.1361320565524,-19.403353402811888,-9.29487962978919,-4.382849075554422,-2.628199004799844,-.9179650296494932,-1.73969347525463,-1.0795399141849205,-2.374044281724527,-14.937965378530645,-18.835382967493864,-19.027759281339232,-23.638132230301256,-19.333359589648275,-10.438732131408807,-5.421632892581787,-1.315222539999328,-.6263759525152724,-2.720030863968866,-1.22918946259428,-3.39807077791164,-14.03540860540736,-13.834234800635059,-18.996376045696767,-23.143980362073354,-19.318558545844763,-9.996535821064098,-5.988052034253673,-2.7164761705675073,-.8600265149485071,-2.7498364785451974,-1.772166013664966,-5.596559319161642,-15.848549131790987,-18.78216479229076,-20.77512261999267,-24.117862295163608,-19.16884499602125,-8.524007141853636,-3.6395407374606585,-.956400964054924,-.6811482095704862,-1.8434846427521971,-.04038649813532185,-1.1327293172106452,-12.911571386131277,-18.776518217805638,-20.04376592057577,-22.413357692348754,-18.232498350202036,-9.172111996437808,-3.55411132347123,-2.1501495552722627,-.7163856995389744,-2.2131818540435364,-1.1096526494585952,-1.4180506014109304,-11.866705472824753,-17.91201339222596,-18.957258217657813,-19.369336490267063,-18.29481198484832,-10.546515063001067,-4.690463199973298,-2.799944882977747,-.8172533320609587,-2.825470041813578,-.703680205128536,-1.3064571526495876,-11.768495930219782,-17.972088790742923,-19.218601900754564,-20.793119696584316,-16.23963529204772,-10.04375381391723,-3.2020941175109225,-3.020857007987761,-1.0919729130029483,-2.988398257070915,-1.473097466965759,-7.782221614964485,-16.06743665673008,-20.76428211010842,-21.42392499146906,-23.97725135107611,-14.546321397844071,-7.679450606107072,-6.284038475010361,-2.705479288127253,-1.2076294893075794,-2.5846767826076977,-1.6134101200653148,-6.283221101707219,-22.217358469026436,-15.536291639524437,-24.868692721663663,-29.0042177565911,-22.964338252460706,-10.918733857020136,-7.698313495135951,-3.214116759870294,-.9787819456082261,-1.6132595838581583,-.19910188935606754,-.6691548686749791,-5.8117684483722245,-17.45786031450988,-19.126965959394667,-22.244715511036258,-18.221298472347076,-7.449445145689366,-6.84904752263295,-2.0217624040396496,-1.026064891433833,-1.8298746640114905,-.3216989926398218,-1.3728804993649022,-12.652441915792418,-17.573086886307237,-20.602809516873414,-21.873944636105538,-17.452987572843917,-10.234235550272496,-3.9980413519597118,-2.470803649407527,-.8896046774907855,-1.776323832178309,-.395962584018116,-1.8190195418246224,-12.240719465807105,-15.210544052803424,-16.80979557433778,-20.5276385888199,-17.075662841100083,-9.1639500477815,-6.144587468557605,-3.1734676317465804,-1.0395237089719755,-1.9836089775210837,-1.2190323904372693,-1.2829899539962757,-14.478241007132445,-18.030996485230446,-21.909170719711515,-24.164190894795507,-19.138643752624144,-9.683042546219559,-3.5304586912689384,-1.477721783090231,-.7653481504713766,-2.1707887584702537,-.7361244545005791,-.5889878648927955,-6.98432141544737,-17.15390289853309,-15.498713378148372,-20.524164607164064,-16.942047074135605,-5.933143189869601,-2.897130986558016,-1.4264559596609818,-.6586211281927978,-1.3848563755656498,-.023064209783243646,-.4600704421159648,-5.529987760458664,-15.396855772143928,-17.718415618169136,-19.899123701511773,-16.44754831741032,-6.909105207189631,-4.74255318273654,-1.4736234767759022,-.5998327756703784,-2.8544648866493194,-1.0093650538519607,-3.8128237088179735,-14.605981180169264,-18.919912972344385,-19.506584289624673,-23.225803857112936,-18.33734983897651,-10.461649022784954,-3.791405533569422,-1.5674399261991177,-.7324141802940697,-2.657658755746242,-1.3702597956926519,-2.7882123751380914,-16.934181001676013,-18.756914043145738,-21.388640211207868,-23.98593023394952,-18.308960263615628,-7.95663710539055,-5.2543532675121165,-1.4653583790896632,-.7546457292413499,-2.560865439455902,-.33092497599314663,-.9367594081020569,-12.262961316051628,-17.13431753773467,-19.728447464734376,-21.727334464288653,-18.747361959156354,-6.893752825201545,-6.1942849395419675,-3.2426005157509943,-1.071152351880117,-2.3995090019238656,-.7513679176865264,-1.862329450424267,-17.6437016285071,-19.04426789756114,-21.37560190827738,-21.606335815389155,-19.07819018520041,-10.760723895464691,-5.405712996151806,-2.726236253379763,-.7792092548619559,-2.2407730973240896,-1.431680154134853,-5.304648258856078,-13.135622211734377,-17.590499700479768,-20.45782178392532,-26.533367560952538,-20.621331692279107,-11.460968785983315,-7.415709108188298,-2.5201958954114576,-.9276308530368435,-2.879435400790552,-1.4702357662685501,-3.1297675220272225,-18.10168959137202,-19.186117381728007,-21.769350396233932,-25.904689474834907,-19.973053479569145,-6.220627591313095,-4.6105326745026876,-3.0333235371043994,-1.3996297750817175,-2.383103511058715,-1.1854833018098403,-5.664062395472064,-18.394699107587183,-13.342782076536594,-22.782793504597887,-26.539072924059614,-20.780970321147425,-11.138549190023232,-7.541492367551319,-3.2517725484112736,-1.3409317513856485,-3.2199862947506044,-1.7498135490390876,-1.0020806111667955,-17.011282062394056,-20.05006852356837,-22.379124176134585,-27.90218908459937,-21.403251450020644,-13.307639820141839,-6.635307709233659,-3.460377753359005,-1.1527631547274868,-2.638559560200563,-.8418461870992842,-2.224790318566403,-16.942429676121076,-22.465357845354934,-21.104737657192825,-23.789437570750657,-22.26864206288548,-11.975949794247343,-4.904363410043745,-3.388636462758785,-.8270191512674996,-1.2991656628371464,-.09691509187266177,-1.2036705456478558,-11.409758986482665,-14.681164622998566,-16.58040233495453,-21.7711484660577,-17.98435374872377,-10.324444401684143,-5.601026114904318,-2.6557331943313645,-.8814666212643483,-2.4452308119198696,-.6990426028498808,-4.240321255297284,-13.879285011222505,-14.635841128979008,-21.9443672624063,-24.85766849165264,-20.60087213500707,-10.652261988417006,-5.7853318190944645,-2.2792948387405776,-.9571765817808889,-.969267156412406,-.7352854630697357,-.5213166962593342,-9.407240815962304,-12.061285104509443,-15.424107108458145,-20.50884195493617,-17.76837389604061,-9.438106811058445,-6.375474014716435,-3.2622941989361327,-.8284878239632654,-2.1625393795410184,-.35348431325139573,-1.7788193269659653,-11.643541772450055,-13.230608236155653,-18.892899291948265,-22.714181304591985,-18.58846117735927,-9.49530139282606,-3.362596126760254,-1.9116220526499548,-.6112666195459109,-1.4260879808400762,-.646567452946567,-3.7202485344398286,-13.371131019769509,-18.10715277666809,-18.009926551820087,-21.52032320200424,-17.257216775886892,-9.799771307770502,-5.296136955655938,-1.6389412392514453,-.7003790107227043,-1.5291284281016393,-.006051135983727867,-1.020457589713509,-7.117033275179669,-5.64122502786545,-14.195955089620899,-20.70527931488056,-17.975305637329864,-8.368099472957315,-4.645812757505568,-2.3979647588344197,-.998406626237546,-2.2674116320277427,-.6789383664604446,-2.545854348392712,-12.766966025472701,-17.025039141844584,-17.949234932251063,-20.771754505331316,-16.535593674585204,-9.994470478926642,-6.481181537617408,-2.803074853981013,-1.1735772688537471,-1.930594134784145,-.4922754159454375,-2.331924094381456,-12.198188481730517,-15.423725454961001,-19.02521457370971,-21.074109629429724,-18.00837292886293,-8.816046225740179,-2.268509456872279,-2.8383522098431926,-1.0910881130656864,-1.987072595761451,-.5857717239452378,-2.5792098206464913,-13.28787714290309,-20.572694213223357,-20.84541109364806,-21.894679113006337,-18.73537435815435,-9.737751320155759,-5.9052109010894895,-2.0291480161908173,-.6732274863062283,-2.5349231199544273,-1.4928680022381573,-3.3903749870397397,-16.1419377101607,-16.60010220586663,-20.536084987653624,-23.241972155064875,-18.787452324266713,-10.63578697105549,-6.628588839386815,-2.1255697955991932,-.6795031489691512,-2.6481876278844663,-.9692787176085648,-2.9990540820084526,-9.513213653374661,-14.9737868483899,-20.125794996006313,-23.811040676656,-17.095241298853693,-10.48488644140573,-7.083236298015181,-2.618010870248309,-.7542455825869467,-2.4939117830754833,-.4698765527026194,-3.763202575505848,-16.48627846785236,-18.312843257342358,-20.395666484690235,-22.38297204672673,-18.632103175620678,-9.93730840016869,-1.9290688833463376,-2.2094577579247114,-.6442047159088691,-1.7644619174508351,-.060794940534856456,-1.331220953859309,-10.331019320662984,-11.91601998892862,-16.230183868146963,-22.63608979799512,-18.600209529568854,-9.092732473749242,-5.855189799580316,-2.992224254968076,-.8008045776849531,-1.952642192958818,-.9155575978542032,-.8218374342232492,-6.087703874423201,-14.695005236405011,-19.359061024750716,-22.715657482847398,-17.42287277741507,-9.529960982113549,-5.604100556603128,-2.68486967259213,-.94960216282484,-2.8423459591769853,-1.1768914997624993,-5.096045541793443,-15.940197447795803,-18.859744607271566,-20.947140514576716,-22.660472537503203,-18.98026376249402,-8.886190819334875,-4.824040315621285,-3.0411942457547263,-.984994703662926,-1.5812195203807173,-.6339076900908927,-3.921366977328213,-17.01809388160119,-18.968168868018942,-21.869524238894073,-24.21992359838067,-20.429117179676492,-11.300085580416038,-6.420119165611007,-2.6789682043612566,-.9884439499578938,-2.494646755778863,-.7379152241664932,-3.3890191832079943,-16.340594026275035,-18.08955099860044,-19.401205598484996,-24.65326365569975,-20.28602836025661,-11.14285383185015,-3.1112399367989965,-3.086664187845293,-.9312181145526686,-1.7524298308807058,-.36126017496366264,-2.43403228926218,-7.651360468561986,-13.900171948430547,-18.59106936040809,-22.091543153512816,-17.60783484454473,-9.5613750045129,-3.9090322970468407,-2.0959609547874987,-.6325507273062707,-2.3159226798910284,-.335925269562561,-.6997752537366073,-12.248091801436056,-12.282444417139162,-12.526906748104977,-20.163577985149548,-17.380799275743655,-9.874082237034028,-4.179652967841068,-2.5476493978523496,-1.1850758293700225,-2.6128308962241196,-1.8944117107342235,-3.2301823984426883,-11.894811757261232,-18.918413757668397,-19.52426361332796,-22.498032315072642,-19.689769558893506,-10.735152164843846,-5.748434098411331,-2.4809252628064473,-.6825774887612729,-2.66213677267912,-1.4734707770525726,-4.67556460551144,-16.81446561998889,-19.13546580806478,-21.30783837491818,-24.73876110258318,-19.351777317064272,-9.480576031124395,-6.8572567880854685,-2.95783981135277,-1.285734856433423,-3.0099431048756955,-1.3301177691381312,-4.640832662238776,-18.17998409631841,-22.553684697525895,-25.052596002210905,-27.218304715249886,-21.68573392379193,-11.450830788295045,-7.8096150731263165,-2.5957559258663085,-.7493715294097866,-3.1378278932960684,-1.3899077835634368,-5.725954591788577,-16.575524704373898,-20.953853660607265,-25.702817571593926,-26.986745523872187,-22.184703285603895,-12.361467160608953,-7.456526774377296,-2.1224717971368965,-.890905647073468,-1.6419938410561234,-.5050438765304314,-.815087285771821,-9.765585347268539,-17.013117142971655,-21.29527922364608,-23.964220358461134,-19.69263493948021,-10.800017953835358,-2.9868418335529263,-2.621377394377524,-.7257833962905781,-1.1090832215116835,-.024440417583161646,-1.271232854181221,-6.2201198694618105,-16.801908524617126,-17.88258001313181,-22.241208530735285,-17.709114847815954,-9.150093866551856,-6.080112231857481,-2.6570688562036957,-1.00003143468928,-2.0534024212789,-1.1768084114763233,-1.2428862794254751,-9.416810087674035,-16.87411567305781,-19.68581192288803,-22.584293332029663,-18.364728986025217,-10.17790346346448,-6.198984335806303,-1.9446623685936082,-.7034748435814534,-2.178234859070873,-.028282609980758475,-.9072505031115516,-10.975320574132807,-9.556358961311426,-18.585189785633528,-20.887914735305777,-17.212692368251385,-8.850062902211564,-6.272785782215765,-2.9614760705665732,-.6142878857136121,-2.637518928142307,-1.2942139007115574,-2.1211786178581806,-11.228055984444099,-17.368945414236904,-20.438665158483463,-23.409398019645828,-19.31829927025021,-10.648164212148181,-7.29946474770521,-3.035274493770477,-.9174026633391232,-1.9324306049349889,-1.1618810359150826,-2.999808542747449,-16.957886805455722,-22.13132188081427,-24.24458948795144,-27.058712417029092,-21.622184435130492,-11.863882659305313],nie=[-6.465259378334524,-2.892687501765461,-.8052262863042114,-1.4722744813519135,-.15312121233544718,-.5783911504131445,-5.727146256805646,-17.066453480215028,-18.697183148732737,-21.742979156134975,-17.79159500541937,-7.262227221474988,-6.718131169196498,-2.0214324601517073,-1.0096436260006931,-1.8297592540537044,-.32090331785221904,-1.3296960875430215,-12.647826601924463,-17.507734305549207,-20.62416525880035,-21.895042954522847,-17.449774853634732,-10.234356216293632,-4.629115104484466,-3.015859467598566,-.964380474392353,-1.5779166364187103,-.6211232803848441,-3.767367684259204,-16.488173822555968,-18.294347159575647,-21.032382177692647,-23.27309126074473,-19.646843748497684,-10.743112992312632,-4.940615945881442,-2.651605136666454,-1.0571648622573333,-2.4992695364691966,-.321294013593245,-2.2233541453816614,-12.69455334701702,-17.02367058301704,-18.484516967345698,-23.81656621974684,-20.18613685701093,-10.45251567010904,-6.734659031032449,-2.9217132154941,-1.0364866997581001,-2.0168459402490275,-1.1616735502235884,-2.8100125802456875,-15.658037453180919,-18.906119827163796,-20.257613712984067,-24.82116029067958,-20.496059936446546,-9.483979521338787,-5.9624633622408805,-2.0383325503517766,-.6727473065237007,-2.546550164761891,-1.493838897892944,-3.36618574602056,-16.03139186691383,-16.477265378713003,-20.437338079342663,-23.385024628466518,-18.824330012540297,-10.593454496915912,-6.610544293466015,-2.1206899709587397,-.6736713469777075,-2.6361973390093714,-.9492624211593,-3.000208358684891,-9.510883374944672,-14.97134195890856,-20.09346894510816,-23.72592355121565,-17.031136283252376,-10.467647196578856,-6.433087707648496,-3.2386573086893784,-1.0882262358001695,-2.013216093584812,-1.3090326843150333,-1.3341219132442532,-14.52857241216132,-18.14262388956908,-22.177254506605646,-24.446220539592492,-19.343559227727784,-9.775006107869215,-5.613534602595714,-2.818538976441391,-.8833603806634528,-2.1250304888142413,-.25215244782262314,-.5570566627554389,-9.133143338348484,-17.29954802580783,-19.505814572169406,-22.625258801612883,-18.64921704324376,-9.079056225175949,-5.391228180010761,-3.109927389509591,-.9481398468933964,-2.6042346994762853,-1.2588941917749312,-1.9753439288648444,-18.004956699474256,-16.482252613280362,-21.438272337702838,-23.941378803017837,-18.303058997464976,-10.522470127470525,-6.753039885984286,-2.913822312031625,-1.029905805600515,-2.005688714739353,-1.1383529751027694,-2.8284466596321285,-15.673744196401003,-19.006170861802484,-20.38658772013341,-24.98100654052566,-20.69546812390478,-9.590608509510554,-6.85010044860903,-2.9391776066598143,-1.0538763559557285,-2.0312757480119155,-1.1946410498853437,-2.8120783326822436,-15.640295856966503,-18.936317821929624,-20.70582475656796,-25.03310597696754,-20.640017996883508,-9.632759475667202,-5.963608796211727,-2.0389329093537993,-.6735107138986249,-2.547756102271145,-1.4968776321107817,-3.369016504341905,-16.032114208834077,-16.478962351851834,-20.451468143213685,-23.435653468420035,-18.86152263941261,-10.594647691510266,-6.339479653512973,-1.7774636391093204,-.9648832202292006,-2.140686859296698,-1.3229557679834394,-3.352324293371543,-16.254384191811354,-16.653630840122116,-22.670164937990357,-26.590628697787384,-20.32947368548744,-10.318504192893142,-5.958151645956583,-2.800732050014816,-1.0616750875929366,-2.4022629534889655,-.7164798895754085,-4.668435053459836,-9.447166127748742,-19.39952586858146,-24.481444738563837,-26.912959083798295,-20.727809999078367,-10.642892618697442,-5.797866818609044,-1.7434917206461302,-.8097262173494306,-2.9186314596635565,-.8110127452799077,-1.7180577971863475,-15.822930081851135,-15.852318677698035,-19.665054123148888,-25.256239022285566,-19.78179699755193,-10.629938876388977,-4.239090409818752,-1.8734061823743706,-.6316954117009574,-2.3597715630134117,-1.1242696120010462,-4.283461790184576,-8.056467959865124,-16.76077927020323,-17.113059295243314,-22.446975649227223,-18.31447634706378,-7.618665134721774,-5.44168970020774,-3.0562007929479758,-1.0994886566868587,-2.494112016660923,-1.7963931915286506,-4.552221531909897,-20.09059533372504,-23.275411841573597,-24.804106733482183,-27.26701709257859,-21.990536257103397,-11.523433250345494,-7.7425433043100655,-3.70574540952375,-1.191572704138872,-2.1316086980247397,-1.1107361325945895,-2.8798019723826145,-15.769847888803058,-17.609035812744107,-23.841788469117127,-26.895457347550057,-21.187736804162576,-9.602183081787897,-6.552510577029016,-2.8718454533701374,-1.3616710493603161,-2.0412210371607107,-1.1534584098014329,-4.932775022153484,-20.210690898993942,-21.15331141500045,-23.038664299176,-33.197384129351946,-26.507613292893026,-12.703528641212143,-3.984979944783568,-2.5527736849101115,-.8771477391691566,-2.859144119583985,-1.1511040993891237,-3.22728223599037,-11.730569740357977,-13.740074617453049,-21.34843046565116,-25.417132768001455,-19.265919462768625,-8.922538402870137,-6.695088425287546,-2.3398975574362124,-.7000899162405694,-2.453268948384992,-.5177954650705333,-3.149940002190541,-14.006902981836417,-16.442395505797236,-21.95396376945521,-24.9675396691627,-20.871908676989396,-11.61105734882683,-6.604676574875132,-1.9965227477943386,-.749577190538696,-2.217089183539954,-.03763796461527405,-.8965087181592323,-11.066826044997653,-9.569526800587097,-18.634721961937686,-20.9342714094718,-17.267524851505904,-8.862392308275794,-6.8254524010374205,-2.019785087666069,-1.0080892136308255,-1.828945847726603,-.3209486532752312,-1.3876778963896432,-12.710747418223049,-17.5195124075119,-20.640156614281647,-21.912794708824734,-17.463412216712605,-10.238839434908192,-3.998183734310073,-2.4702697190078067,-.8887938662369793,-1.77594367885392,-.39529717753111937,-1.8154664874745496,-12.244745075816377,-15.220600997937108,-16.82126978857957,-20.540758347369014,-17.086423227339967,-9.174590436528817,-6.632854839203798,-3.194622354377197,-1.1778288889988286,-2.1200719124877514,-.6349353972915295,-4.25266336747397,-16.729577777128164,-18.657415103119188,-21.88225581118876,-25.900787635803628,-19.503869529430602,-6.004970509547872,-5.7479581431413305,-3.186759474257699,-.9866517133520091,-2.6384739473239276,-1.3356229411884835,-2.074239893649554,-18.337197383886792,-16.692466814751896,-21.742204414302062,-24.42755114693029,-18.64221440202635,-10.6887863150358,-4.433786082460511,-1.8836270947896145,-.643678289963644,-2.378276487946133,-1.1601226944678145,-4.292819893060535,-8.142700101624454,-17.045618461314543,-17.2232170124855,-22.860218234783698,-18.657682526170294,-7.782157442192363,-5.3268298176366375,-3.3556981983122305,-.8707529508082631,-2.153058925477507,-.42469119638668995,-.8378636693488418,-12.44297480868386,-18.700852741864715,-18.733058400324417,-24.51401938234914,-20.60317749467174,-10.324054666861112,-6.188579279335688,-1.9680723105831839,-.7239898125304836,-2.1945297019478156,-.032003026457042685,-.8772435926502553,-10.958474219270599,-9.561520652648746,-18.61836494297764,-20.917472925195153,-17.228904421723453,-8.857231823817957,-5.761433821691946,-2.668194218780871,-.8279701106129201,-2.7110505845368675,-1.6637943993650888,-5.519837373591459,-15.911311781292294,-18.83667315600355,-20.871999784582332,-23.66561369250256,-19.074258167942713,-8.571917265806041,-6.713739051785964,-2.145672197141271,-.6803393084393096,-2.67748538901804,-.9754791957497551,-2.9788849047805486,-9.481018871555765,-14.909224835651335,-20.043388638736477,-23.712514475593643,-17.043271402359263,-10.436526031658605,-3.8189391288666963,-1.570625434593762,-.7397826087181252,-2.6763127015759864,-1.411723517792266,-2.793836335339111,-16.988547696123124,-18.839753243007035,-21.497012944261524,-24.2028394787937,-18.42488046327453,-8.005474944522806,-6.883430229535528,-2.9494125819213224,-1.0516389339347059,-2.0296408441648963,-1.1686299076820408,-2.8515080796306975,-15.859272576028362,-19.10991607880572,-20.95766845662876,-25.25397619503074,-20.817821767292827,-9.713759430632482,-7.097172924471279,-3.458474511665394,-1.0756952404594138,-1.9988508046055193,-.9719636093556008,-2.737185351686474,-14.663303541128036,-16.255420103657183,-21.851377922357912,-24.69473623879096,-19.456537492260455,-8.73528234192143,-5.323720829354839,-2.710286854184264,-.7642946525522389,-2.229011536638375,-1.4158894274686373,-5.272937524243749,-13.012843545829334,-17.187940993329654,-20.04353300132347,-26.123819532784598,-20.267798460924542,-11.344191949807488,-5.5766215974819024,-2.7537824675944007,-.7964244184747705,-2.2504387841110987,-1.4996784630544757,-5.598704602932039,-13.820286298742193,-18.593237000381926,-21.530045581168444,-28.00995162060225,-22.10902496250631,-12.44917780787451,-5.197973700674779,-3.3284145198665747,-.8063846121500291,-1.245949444655325,-.08906775617231555,-1.279824312571881,-11.219843982793318,-14.37991284629504,-16.22176948909207,-21.28990916955042,-17.566142310085475,-10.061875229448745,-3.5827457803033393,-1.9349623104145337,-.9379481833583498,-2.471852608891785,-1.8021220154145472,-4.664833523011978,-16.786370218257186,-17.34705367039548,-18.545946252420308,-23.66007298740104,-19.207902663842038,-9.653518423755305,-3.56356097571048,-1.4962577851255812,-.786762979687821,-2.1886537008967393,-.7603940581196774,-.5990485196504879,-7.017779445827962,-17.23364525459719,-15.577714243123006,-20.63045317553953,-17.024673618232647,-5.959098077042041,-3.2394076941875016,-2.882200308724719,-.8805764570663495,-2.012564873118409,-.2303263783466039,-.5043230128774112,-5.873469872209318,-15.382003621876644,-17.07198560852437,-21.584526397486645,-19.263488535066433,-9.583252898169231,-2.088095319920446,-2.8103141016752686,-1.0590257415048268,-1.9800031001750473,-.5617032043491107,-2.4947585932060066,-13.20701485923989,-20.412033408268503,-20.64636352110056,-21.68267755524576,-18.558101242112727,-9.663885937503427,-3.51508681164063,-1.4763573815075213,-.7637555277769179,-2.1684238225811523,-.7333635933070155,-.5864924885774635,-6.982502323643013,-17.153985013757747,-15.49879284536205,-20.524164606466957,-16.942018786528386,-5.933143190167283,-2.8971309863441115,-1.4264559594954431,-.6586211281260724,-1.384947093939191,-.023064248111667452,-.4601817543428594,-5.533741918049988,-15.417884973035155,-17.743258354536117,-19.92424176321126,-16.466208170708864,-6.9207493366344135,-5.708905219147445,-2.644622942415223,-.9960452430338212,-2.0515987096061665,-1.1768130780733204,-1.2560120701564625,-9.425182009422796,-16.94070923708739,-19.726748223610503,-22.645928940366673,-18.016577865960535,-10.142638430199108,-3.553818241270977,-2.698133899456127,-.9946245599611592,-3.0612747550970902,-1.7907515383686994,-3.708954827700211,-9.208908673501229,-12.890011283842908,-18.635524336498424,-22.919683550898778,-19.054379021404966,-10.164341082180284,-5.6434156220135945,-3.180823730389206,-.997478098835977,-2.6407168616284253,-1.3693195619924863,-2.02976313530353,-18.25922406480482,-16.709523485553024,-21.9507085037682,-24.55222549948434,-18.75573706111032,-10.764502357653255,-6.078057706121148,-2.772848650542273,-1.2312799003548802,-1.9873188292266801,-1.060990576759294,-4.701415501188982,-19.086826883184585,-19.681637740774775,-21.009730295429986,-30.04750165205875,-24.18658261852199,-11.362306955520653,-6.153801952504095,-2.328234998715657,-1.032572586575966,-.9801476470860515,-.7761570857076423,-.5199421750791143,-9.414471588731928,-12.043216937968147,-15.40404309883213,-20.487914781724008,-17.740366942730553,-9.425523624487697,-5.135135736226639,-2.618336259482297,-.8573808164026325,-2.4335425643361757,-.6712757689967234,-4.009324118010521,-13.599473353339095,-14.274643598323557,-21.36149516737631,-24.251695021337568,-20.158625539193253,-10.472255638950326,-6.750033424293765,-3.0417734701482195,-.8543410290072099,-1.5609651539868503,-.1802990919813251,-.6070361317720627,-5.7562449810091945,-17.11383779152793,-18.75710666850643,-21.81288337312394,-17.84563945701048,-7.282372633381147,-6.050477612368889,-2.4768877099551796,-.9461038711114788,-2.465215007757495,-1.1681554309715043,-3.376197424809874,-17.198014833756385,-18.06612753604913,-21.47134288757333,-23.820234307380556,-16.972075778591424,-10.355685100398153,-4.379741838910329,-1.884411286202933,-.6293616025200167,-2.376431047748543,-1.1304928408767452,-4.300407771110451,-8.135058576839093,-17.029195918263547,-17.068123374693503,-22.733302060052296,-18.572507018124092,-7.742787166074125,-6.055264604399783,-1.731259026761218,-.7726097126506062,-1.5119190392244,-.4237208102676398,-.708158149755152,-9.324864040599591,-16.157967633948363,-20.130302294786887,-22.686919870679056,-18.77843796627775,-10.153456757570465,-6.729968054553368,-2.19005938146087,-.7189599495027149,-1.8235966389181542,-1.0583995121251335,-1.763308800297306,-4.643152877159417,-16.40326742070387,-15.853985100147785,-23.01919732302089,-19.622008912463173,-9.578729051487452,-5.901741506668651,-2.464889845943927,-.9405138142146972,-2.4476292672226663,-1.1487571832749843,-3.3954004737605734,-17.255821340521074,-18.160189348411755,-21.689962329419693,-23.968789928664695,-17.06420771285506,-10.414662192034061,-6.892250804671391,-2.5012721545213172,-.8725034020681397,-2.8596223303575865,-1.3770034870460977,-2.9503046607097123,-17.04575045310965,-18.064237312774317,-20.482368336797165,-24.88672367824767,-18.823001489190112,-5.701771130351515,-4.271285521155788,-2.961904717227627,-1.2874332937905943,-2.3650705098830938,-1.1019149404437452,-5.0525910136822985,-18.226103492390802,-13.202806365826785,-22.582999588001016,-26.332473129548244,-20.639945623235768,-11.080365345356627,-7.518935483987178,-3.2483465147012094,-1.3438070166383005,-3.2226384231529823,-1.7628945537030378,-1.0135563983946672,-16.949358529012514,-19.95043591217499,-22.290336126011777,-27.75748900833814,-21.284154826971648,-13.244233527217514,-8.54550447250038,-3.259827856780363,-1.0098505838003669,-2.0665168627374833,-1.357900519187303,-3.364070922529489,-17.53639031679653,-22.933954788500994,-25.107526112925363,-28.04614148390959,-22.469233718130052,-12.370549769624215,-3.659545688626151,-2.5912314394725713,-.881995844048722,-2.917630135550774,-1.14406065867185,-2.92804790587341,-11.435130159701602,-13.289525112318476,-20.63178649191109,-24.726239438829936,-18.709315994800136,-8.628665642280978,-6.900686166039321,-2.084027733189779,-.9027634262709892,-2.4859228735055807,-.26527778962978166,-2.0657745821466316,-15.304142751148978,-17.210693376170198,-20.55766241258143,-23.810926266857933,-18.818449737461638,-10.30409736039116,-6.419457882420013,-1.7221336999458594,-.7863611593646664,-2.5401162935522614,-1.2755827021651958,-3.6411569471643546,-15.675892092083082,-21.064478074034614,-18.884855027981555,-26.57648407381981,-23.216136274377828,-11.780234252799083,-6.029370313363363,-2.3126544796523625,-1.0011072619527472,-.9465154361744902,-.7282758131297659,-.5234762100849694,-9.419195683900389,-12.077220502975393,-15.447151178700336,-20.573076591908507,-17.81263716213362,-9.448000814616199,-6.049558264310236,-2.9617497322284505,-.6142744305884846,-2.6491376279959487,-1.3018154497202692,-2.1185306527421863,-11.224990744740428,-17.35453010256031,-20.34563215691061,-23.121980576806095,-19.21333697633613,-10.602132883708862,-5.706914905442026,-1.9508219123716268,-.7879414557503631,-1.918862695525411,-.8490519416694258,-1.1219918837834317,-6.645839620988883,-17.53057827008143,-21.052438566949295,-22.9606627637953,-19.402113844142935,-10.267766260710342,-6.645826031839583,-3.402953454682646,-1.0290578544134044,-1.9742848752367332,-.9103796007855154,-2.696624589710856,-14.630368001331474,-16.180448652779162,-21.87844001752029,-24.58133064219265,-19.3262898475581,-8.686828053097381,-3.8170888263331215,-2.102401138246913,-.7215274838351272,-2.397274455758133,-.8091199158520808,-3.477522759031397,-14.058510211125528,-17.533225441528526,-20.509330252201,-23.74002155847043,-19.578501406998658,-10.945735887267404,-4.397582188194302,-2.627700625734699,-1.2448108110724827,-2.6784983000745544,-2.0228537698336044,-3.3584734953212103,-12.522148999005356,-19.645472694781724,-20.64532211732314,-23.349775848583732,-20.4610319304456,-11.151444129587173,-6.275000588855617,-2.6492487362678427,-.9611763733164709,-2.474088224350388,-.7237703871518152,-3.3399221899002396,-15.884979924858202,-17.584559478343078,-18.85246801539829,-23.948948742158397,-19.688901084162758,-10.782344326507125,-3.879894700450777,-2.1213347983131308,-.7330200561989298,-2.411831097018635,-.8172394760738356,-3.4515352814619185,-14.019967659101532,-17.47727649757117,-20.45799281926028,-23.664562238082265,-19.52411360944992,-10.91831287481297,-6.753492426223286,-2.184969230912352,-.7196246698014702,-1.8168394878694853,-1.0527835965116275,-1.7588218741249124,-4.638751701212669,-16.378404222413593,-15.829130714960801,-23.020849321430596,-19.625289355256683,-9.573224497265386,-3.436968578357684,-1.5611081367168815,-.7253728466367654,-2.647700513215914,-1.33015590392551,-2.7277920071897195,-16.912025086674014,-18.72800270697148,-21.34764122539639,-24.334676653870282,-18.354357444168496,-7.939708037133208,-6.573138582320759,-2.923138580607772,-.8302455334806759,-1.488085360040382,-.1599865457850939,-.5902065442307921,-5.710322816931369,-17.014190028172617,-18.630949160253905,-21.673333692968484,-17.734011182843336,-7.23795165569514,-2.089182620164731,-2.790270782937282,-1.0597880192165767,-1.9803826470792811,-.562148691592812,-2.496767213764534,-13.247710160031426,-20.456110326537097,-20.689549665494418,-21.69238563851099,-18.585735626233355,-9.717511654910714,-5.578481149989258,-2.805219201834967,-.8743484351337546,-2.111512341475386,-.24617498960252127,-.5540842969987779,-9.163045263254329,-17.317641720459452,-19.515262126188034,-22.624655076407628,-18.667612905190026,-9.080296856263212,-5.9797712274299775,-2.6534090497834164,-1.001735703883566,-2.0550193616962584,-1.1787500673404685,-1.2660671947015945,-9.485407362095685,-17.062244623245146,-19.863207858551213,-22.79316826639488,-18.128798564483155,-10.20756222560497,-6.771206395253692,-3.0503528112881857,-1.170685244461818,-3.0157987593952877,-1.5098381760811979,-.9348395273729169,-15.844511541698699,-18.32624922095244,-20.508402924766138,-25.64488790220734,-19.661294511172834,-12.10203885195595,-7.500081843404319,-3.1247042203781774,-1.1646662818933657,-2.162214926744695,-1.3598082640549813,-2.9286631863126695,-16.221798802476933,-19.873875044390335,-21.431575213408927,-26.142031136857124,-21.549872716682376,-10.136314694345343,-3.902920958165009,-2.146432920253241,-.7557496781385079,-2.423532520693945,-.8205383535910962,-3.4674252699490737,-14.031434261368464,-17.502089015027583,-20.471245255547682,-23.68336872910104,-19.536436425191543,-10.932441233012085,-6.906332040778409,-3.361199219069207,-.8549802247033345,-2.200777264450215,-.37792136832014384,-1.8389885888030595,-11.734834443710527,-13.243076661115936,-19.0174711744363,-22.85767789286738,-18.70243387078396,-9.548051479038193,-3.392022597356958,-1.9213991165497333,-.6160784292408595,-1.4347405555902006,-.6590419110845344,-3.7937660569728573,-13.473698866866735,-18.2664956762072,-18.18609707268695,-21.73032485127312,-17.417061326567367,-9.878990111779153,-5.96252670529803,-2.7300152531064694,-.8439682625664682,-2.7638474011721375,-1.747804294740228,-5.704442472734754,-16.126187328002008,-18.950325380723495,-21.009867720079907,-24.359095496308683,-19.19027703446111,-8.61679631238627,-4.961805737511718,-2.6829585126458197,-1.0774044283671012,-2.559032674150206,-.3506797970577472,-2.159980250256736,-12.626561482533646,-16.86658685266174,-18.327126541573776,-23.633781549894078,-20.03811952352175,-10.38838565789327,-4.309704320556099,-1.8618839541494274,-.620862168594243,-2.338069611145708,-1.087117791572841,-4.288561729252566,-8.040296422368796,-16.743871572848693,-16.7927542101063,-22.38408750489626,-18.39458169015714,-7.57245917683285,-6.530855679027895,-3.013163753035973,-1.1508409891760232,-2.9776300463384406,-1.4607844658535618,-.9123694162781595,-15.570918273870669,-17.984090307329684,-20.141334323844372,-25.053747194465004,-19.211407530349547,-11.843182854056254,-5.942833320934495,-2.0491532877124277,-.8408766877180727,-2.0248546665234763,-.9373692239792258,-1.1324453845765388,-6.73995013188028,-17.468058966877834,-20.96260760570583,-22.879379496059094,-19.327575978029525,-10.2220877231905,-5.638563534025319,-2.0240301455663907,-.6611271349806223,-2.522515752998552,-1.436534338024904,-3.3132485156863996,-16.03673467462334,-16.48582521495047,-20.47252945496909,-23.15675742708891,-18.87307348576735,-10.596563470456204,-4.874502895966566,-2.6402243784000983,-1.042480341438297,-2.4990697744435733,-.3218200890896933,-2.1621311901883753,-12.671574369592781,-16.920840966253493,-18.386605221229562,-23.696316939008607,-20.089496185258675,-10.410725182606429,-5.4706931745092895,-3.3505932015287887,-.8686122724882999,-2.151214933943369,-.42253937657228924,-.7732191612905676,-12.362001405049671,-18.419663444564737,-18.402477091047686,-23.640950627297297,-20.181305215245487,-10.154764562623235,-5.354665732117687,-2.7938893427386153,-.8651634803765506,-2.107344703744371,-.24071056018638143,-.5565180762534312,-9.154542430601303,-17.325796049673517,-19.522552264684876,-22.637925522837953,-18.67742379801182,-9.082766400093242,-4.800421706166012,-2.4124395283053706,-1.0101060759190013,-2.28045153481213,-.6892348515899754,-2.534092450791846,-12.7132561226755,-16.932013780468147,-17.82449393141601,-20.6607229187233,-16.44830864412329,-9.947360353844708,-3.416296089628003,-2.8984408239884583,-.8833087156593383,-2.0027630169300683,-.22640240581449167,-.513670133813388,-5.89488208236875,-15.450443683568562,-17.151406990609157,-21.666456698541833,-19.37278171449548,-9.635231098849586,-5.622648308750676,-2.6823438616031283,-.8273388141434577,-2.7137346710858243,-1.6617880749810585,-5.5313244180335115,-15.945355799718524,-18.859462804790617,-20.834773975139232,-23.553852730000422,-18.96047587981112,-8.508201158110493,-5.289798342978254,-2.7307769461836178,-.7631098252270243,-2.2580923835408053,-1.444444569703978,-5.219063053404126,-12.890725561112047,-17.01437511909057,-19.741538736198088,-25.743111214812174,-19.99250843753344,-11.1904147325866,-5.419358922149879,-1.6600323853741519,-.9498748435271269,-2.475728331322535,-.47835397937932106,-2.1843058629227747,-12.321004158933281,-17.437030540725953,-18.612217418850683,-23.97068163541296,-18.65537379713868,-9.38157706085843,-5.351156715836278,-1.3189117972488837,-.6365765877910221,-2.7448058067449077,-1.2689601086782538,-3.3819042014700513,-14.013458187299156,-13.82428879999643,-18.98635980795312,-23.154433078686246,-19.31845067094379,-10.002900242206792,-6.755765487241093,-1.1328635292283786,-.6817340656143704,-2.590800272097561,-.9582232985366119,-4.080902409911285,-16.131473934091183,-18.89222736150649,-20.56521232769062,-22.532667909498617,-20.035235706065606,-10.217314932188385,-5.361321738531962,-1.504938544573918,-.6277801447534453,-2.9373933923754416,-1.1042124396030253,-3.8566455567567663,-14.606144454720303,-18.93333461325323,-19.540939897038083,-23.284411913051844,-18.38328860322197,-10.48187820578918,-3.5133451422971635,-1.9187738233633822,-.6153940289255021,-1.4307711670153327,-.6607734350736847,-3.771443637559324,-13.359683518252147,-18.094259746061542,-17.994821321896453,-21.505417052469625,-17.260241769404217,-9.783116658142513],iie=[-.28566258976648584,-.15199756558705438,-.02341326900849085,.5536705599507913,.03258085167929372,.9288557961593887,7.236150591231557,-1.5412382008060317,.7552832658382254,1.8322008677936807,.5438203609546954,3.406359374191849,-2.654032774176198,-.1622877082586206,-.3931639330165138,.4988685473715022,.7276862500650024,2.879250345672337,-4.672636175465958,-.8597980801662731,-3.915047569950582,.36020611394288726,.9002165143581454,-2.6439868607473898,.8027018374947512,.03853479911546427,.133392123959981,.9147880041800339,1.1730055488757198,.773234519978925,3.6048749549410166,4.977795706829762,3.6923115694411885,3.964916758051212,2.306303711068135,.7668097184650083,-1.4960186626460934,-.13839545670603257,-.21344843147503903,.3364200590930765,.7660250480865433,.5273660213513901,-1.3621837064441376,-4.006999649361832,1.734742285704566,.3157738905603927,-1.8540549180153374,-2.0127858154621396,-.9186166855662183,-.15182329511238954,.0029897163084539125,.36212690014814747,-.46257051388688875,1.6918521135330167,-6.553966682886131,-.19669818387557603,3.2371973661323,.95669587863111,-.6127395040909084,.6125687621817293,-.7591598598293615,-.3701197779309942,.2729743955690418,-.06511154944943291,-1.0139096849014062,-1.2561496641044185,-3.756451133870827,.9170793548584728,-1.858611344289471,.5630453503152274,-.1678841290098063,-1.2131978024976406,-2.660179889189152,.21588780645708364,.10892258100652781,.1781568453095428,.286931846626599,.12759515998627377,5.742540671480757,4.40077813133398,1.214339779959506,.3427552428620502,3.1705234529531237,.1694870456235693,-.005743729167621189,-1.5143248637795208,-.2998641831004621,.5290994735687538,-.031408691449000756,2.3125812820923413,1.133668459178374,2.946000342823189,-3.2559434217118506,2.2112753738755693,3.218244958623855,1.8681493812165637,1.8465419724079286,.7324495011433519,.2755113229670665,-.09713915380798883,.7666576231814194,2.3196482847436535,6.0535944270304025,-.3778473994770143,3.408638559280768,3.10434662984966,1.693394843238008,.08115018665744007,.9122963956689703,-.2858391216459624,.3522074673069927,-.5880055223805796,-.1481767461136569,2.8501124197108867,2.021814199041179,4.184135906008106,.6106178760305622,7.618889639659596,7.047813833710233,1.5163025513539756,.5115212994514395,-.4338999702113596,-.2788832768227309,.5993106119579222,-.5178278853827296,.5996817415187475,-.9566559338062501,-1.564107224166108,2.4568938573425263,.9092806369225199,.6089194887244211,2.5282560113046992,.5237628504055956,.5606243271127944,.05239316341461444,-.10094903185752363,.28805859242455295,.6783946794475614,2.755109339151751,-2.4693623866723544,1.6633734536121185,5.02263853169044,2.933808351153317,1.744794425568865,.8670198315182122,1.6549180484378643,.23290141845989454,.20754756507553662,-.5269296107816,1.7257833714618915,3.822514278566346,3.8510443478781995,1.1558951473459853,5.276171307739199,5.143519673172859,1.7091391279605292,.07111912248502193,.29556166656280125,-.1106415941457614,-.09439940018943767,-.34549347597792407,-2.162030950833471,-9.270479452105816,1.9420534400175191,-.41177880328491434,-2.352804007472958,.4287105125090195,.5944153873805911,-1.0690882660201482,-.11206386011654543,.027037378032163436,.1299697148568379,-.3845288892438661,-2.508085217970371,3.285568116276063,-2.2518771021799178,-5.887111900069375,-2.954626193551022,-.3006232473410383,-.09616999458618113,-.21843034848488524,1.623529586391892,.07044285780667454,-.7604583616717339,-.38849245929101583,-.9377066882886699,-3.347136344262199,3.088057918532448,-.784194413809272,-1.0868897595145133,.9012454300970767,-.22796771950966965,1.203428353740131,.9488267801604087,.2612240314089868,-.2320141386670913,-.8766016513362145,-3.7310710162319216,1.091421160482816,.5395294174450626,2.380623857241136,.163148980629892,.3221880556329013,1.4536391026952276,-1.3588328517987858,-.0455591779758182,-.1318097375602831,-.012886438664458075,-.6331101170899126,-.9003556580159404,-1.7646273626948616,-4.977094357326718,-2.611905523402153,-1.7084766165116143,-.7593710956599752,-2.4231288600312393,-1.797186136207853,-.32578333868102344,.0502090152068522,-.7282392334876981,-.8429451817263239,-1.1965914894841774,-2.585722659902587,.8924776404250228,-1.7138037543200186,-3.3922862668462015,-1.760456691913192,-.3039503288229483,-1.762924814472065,.21774224672174508,-.6005805583515421,.0018815520092697897,-1.044806068816112,-3.9728945009538634,-14.242484489188952,-5.74910337094033,-5.165802798435074,-10.709337573403653,-9.655807208478327,-3.5937583118199474,.2428887435755397,.2087220030979769,-.1573446010047755,-.6960417070417297,-.4814306249389848,-.8754984163567061,-4.097408837414673,-.09298094405669846,-1.710260412716648,-2.017740072061805,-.32724218203130906,.763650907281187,-.7026132508731833,.3567640784105891,.18766403353644484,-.23023660737117652,.5479776289386766,-2.19137626185464,-1.2481739257235431,2.2588544663000154,-3.463908773067612,-2.106901993069827,-2.0682472011806907,-.7392437866137791,-.6323592266824236,1.029707189298503,.21559030362233322,.13999915301838667,.5066365220791839,2.5528622495052793,1.1063787658543789,7.5817492424660315,-.7591038941300611,1.96193651782055,2.9856897894440158,2.4952946985899436,-1.3074810966115398,-.2894519676177791,-.21168265761519203,1.04955383791714,.44744097620212486,.26883832826229215,2.9646484980331365,-1.818826549449085,-1.1037509354585662,3.2053631276104144,2.40141887140266,.3443282578067151,-.8611058763027434,-.21571802766977521,-.17178430575687756,.9813160427211609,.42634179957237145,1.0627753558581619,3.8889583782281187,1.0901809360316912,3.028406860494179,2.6831760584349627,3.0482557354248767,1.3659830641598187,-1.020241576175371,-1.4022143183791123,-.4109417266900079,.6774207975525373,.6374468187108842,-.49288266765118627,.43562981728519995,1.2547190088556532,-2.3893452739355636,-2.1554610839812955,-.28035656780194,5.461597725146487,-2.1375537582349344,-.4669681096530901,.048024741286305114,.44560830611821406,.5061204588080523,1.6540307882493894,-9.090862021996426,-3.7317631033404624,-2.9894767798182813,-1.1444774786974168,.6110222669400979,-.38249717816678835,1.3116573054459366,1.3013356484899736,.35565262625221755,.26084794768510544,.2075845347153469,-2.2360013776067804,10.397644203199262,-.06846918324394773,5.074562734001501,2.0891649629460836,.374734355407085,3.16827926259113,1.6447161234301935,-.41637435265549355,.1869402256681726,-.13875936865824065,.7509143526550277,2.062355129933904,3.2476738595088306,.29489483785229886,2.0889249979367217,.5976759486560592,.10092061898341155,-.6572050479863912,-2.364901206842511,.13192855008333576,-.004411182948291135,.20206795666818275,.7781143273445548,2.5366905505858854,3.0176070271151767,7.844421084354548,1.7449670882401354,2.6471257088286126,2.3395939769424348,2.017264775602917,-1.08199946696877,-.3595788087774275,-.12648889054344112,-1.0379854205878416,-.9152473007499391,-4.647288426877586,-5.690005400381247,-1.07192303089232,-4.304412807472557,-.9679829297340172,-.02656161724677359,1.356047614760735,-.05479218049068577,.22265822005445027,-.05567075645495116,-.03914592122873952,.4847960956355008,.7133972858606346,1.4849791365598413,-.21927578036828155,-2.8259483417656446,.6179324122790985,.8407795076156798,-.0768184323614856,2.279069648652677,.8505745026439819,.32184246351859647,-.2935922062915955,-.2801522381995595,-.5949119140217308,-2.6929676646635565,.1599955651844448,-2.5636998963855153,.043842143851294244,-.7838159225784256,2.0615059245721383,-.33027945528183633,-.5262421500194612,-.2327203112329658,-.2081093857115485,-.28223109899198295,1.2373528807605256,-4.206523908042324,-2.426609822952101,-.8827614581613944,-2.110979811898235,.06452817885661281,.9379889764927232,-.5514212192576211,-.8304640109873739,-.4325107089380732,-.1987694834653506,-.10210922970573173,.8716907902076412,-3.727563799489121,-1.5790330005154225,-2.4037988960597425,-2.296321514782686,-1.6361423924928042,.5639059114207494,-.9298242664532305,.5994076205900329,.42697612415966146,-.02943092216737271,-.386856761932142,-1.576053820943557,1.3444382844444844,-4.347397854874239,1.0921302285187466,-2.23084648529474,-1.2924373675805674,-2.831837487930609,-2.051296606505417,.18122549469932792,.12424233717858946,-.22130707713844472,-1.2404345731749176,-5.09219972044602,-7.924731351653943,-3.176848112992737,-4.42014945401738,-6.378626159464025,-2.782376410507656,-2.8490054026060387,1.3161191168728812,-.12562504800798688,.36843017987911164,.8731742726782141,.5450662891950381,2.958873258165785,5.474524259020948,4.256554527527888,5.679100046680209,4.139679344239227,1.949377137266821,-4.057901839642996,3.2989910005999237,1.4941259977831318,.2968658013826868,-.1527426454559315,-1.1571990782485861,-.8640293567344856,-2.3906504035956777,1.1247351999028774,5.0598968164311895,2.354625911675783,1.5411197199038937,1.523935145091633,2.984228370117483,.30070246678108564,.2296980979199633,-.014797078671447635,.6564702344328277,2.807997202334322,9.666824888834984,-.15224786429198753,7.893428172298897,6.8095170254437125,4.014440027931042,4.7935270062150535,3.891071290334252,-.8179079363494032,.026116203238042306,.4572760181111643,.03319491094169846,1.731426965971052,9.74816333873208,2.3595101140494665,3.8932942064289953,2.932571957385756,.13063995347000606,1.0726784458463652,1.7256979332228386,.36700716731284727,-.047608956589396574,.5899461851286848,.15432555571299753,-.6364064224116932,-6.325291764470742,-5.456884074300188,-2.313650266303113,.24340804446060518,-.35808164707095075,-.42762594584315555,-.03926940012433356,.45376771390263515,.16871053018701876,.29301202547477806,1.0512976651415793,4.105659189633805,9.847585933395465,.27950085112402906,3.159579289684703,3.319036060040696,2.387061434952187,3.770136447923671,1.281932441256585,.6480742424479988,.02426404691910531,1.1351924058514398,1.2095045244746638,2.6521311943568486,2.823069433489971,2.1970622068347017,.16866332001892656,2.1667895251765823,.06737381630442627,2.2277388402800877,.7764048285995948,-1.5196987240930069,-.32738455905709274,.5125054368625986,-.26274745034829894,2.7592982105236232,6.677858419385305,1.900254159529992,.8739324036095026,-.18221985573965066,1.9545317455036024,.025090862594932584,3.2156826630973905,-.5052035235012311,-.2619162143799346,-1.2354065747996048,-.7109357246024388,-1.9543374900414232,-4.5657557963099435,3.5268429745658945,-2.7842932970172347,.09632663613878717,.5966989982262126,-.5713030822876537,.25840765381598474,-.7158544202206224,-.05688217151527787,-.19316755269047803,-.22064903524848928,1.3005001098060034,-1.1532995455380302,1.2811510485101378,-.485908866931133,-.8300496479706418,-1.6683128241214276,-.44069831790246244,-1.0949174319773547,-.9778407914760768,-.5298706873628117,-.8876737963372824,-1.0424787376435316,-2.601403783242246,-9.15885709752531,-2.103031883420119,-4.221167574437198,-7.911369595506339,-4.783229215710076,-2.067427325731497,-1.7709528769496785,.2999640060841819,-.11460755692647273,.7595458281685763,.3033828284772761,1.8541021066454177,5.523493789798685,6.7921660295256565,3.623716182507065,3.150217448577221,1.5929926469176552,1.0132085069210737,.28649715635514966,-1.3031137194829767,-.23100486388735608,.28648829963269673,.5579136935975619,-.6112533400988611,.43593525206830236,-.440408797688575,-2.365119121679552,-1.1077146592643667,-.840066993348522,-.475719817886186,-.7619813900400773,-.3252972995807185,.005685485941298859,1.18887132455835,1.5918669216836434,4.989523187389549,10.092304150781837,1.668327000762881,2.0180159514862543,2.3049789220396364,1.323205539010775,1.2416345084724512,-2.4109368749082267,-1.5204867459002593,-.2649556615409905,-.6217303650053011,-1.1277689328361815,-2.243468107599234,-4.286443447625099,.7103906817564895,-1.4275769669976304,-1.406876615031856,1.260422571610587,-1.1835731039604103,-.8256305154390882,.26573826906933207,.08702409701895986,-.16324919370500388,-.020840191418150893,-2.8823571696995254,3.731646895985653,.8828174739623937,1.8891348429642676,-3.3639655697853086,-.27769503327573575,2.8037278969269237,-1.3648014044264778,1.0686858562165285,.04464361941035213,1.3135510025891874,.2799593948608964,.5982990028944326,2.4436318896202303,1.8141211567945172,-.9117003940323526,-1.8938001740947428,-2.538802674230044,-.10970294365325503,-3.527873937042435,.8307976265268945,.3730129635002287,1.1648016181527618,.41469795484062316,6.018912814667171,11.424283779570676,4.361014689404451,5.569939891321192,.958054028055158,-5.075687514619125,-1.8992784453803797,.3822969683416926,.2405894421833248,.2671156750928865,.13704751538503357,.46465293679033015,2.8878206279466467,4.961537128505316,-2.623897708887362,3.178730392243876,5.035427827926451,5.900130539605663,.5040716649860414,.8060626904645564,.7128446053489772,.10627854354008667,-1.2463627464994291,-1.1779015976900278,-2.2811497920347374,-11.233982004737435,-.6063769982644212,-1.3554023774025237,-2.642008167211463,-.6017030168430634,1.747674015337841,2.577762001477188,-.9401423131879817,-.2613684023567599,-.5351958458716012,-.7802159478039217,-3.679710514317414,-5.573661576598365,4.370280520480482,-1.9801900711275866,-4.458528493442739,-3.186958050391791,-.846129795084157,-3.520894132027477,-.7775428652936722,-.45420233914751273,-1.446314590974669,-1.366931969684918,.8054631434299535,-4.7086390632054025,-4.73989185937157,-5.480540551673888,-7.2298504195182085,-4.208491985871562,-4.0802834794359795,-2.4009170039428094,-.08636022503377265,.029673125171609405,-.08290788521640073,-.13886812875003332,-2.081080968533214,-3.058149309664061,-4.902958303270531,-3.1983553932139386,-3.8819505891140227,-3.330589965505899,-2.68750722340467,-.12908699735721607,-1.1135096563823441,-.11664769357734688,-.7468413770805221,-.40793620417127247,-2.339060040980614,-4.450808744254205,3.8643777862146362,-5.133073113762737,-4.202074831665854,-1.767268920664524,-2.695522452411382,-4.0035551794813165,-.6575717735288026,-.24414229807819174,-1.1010664979399223,-.24221357984653785,-1.6057041400306693,-9.7741549906903,-1.8138376040262847,-2.8392467944122166,-3.9118025653461332,-2.370901420051311,-3.3949921532015233,-1.6769046996834742,-.24851022316994942,-.18652838369428681,.3143485930970573,-.26621764831324196,.17166676165361824,-1.0699109119138308,-2.1445651016902265,.621729261643132,-3.350680216707051,-4.878786435401313,-1.3185852300140892,-2.237964779793938,-.7452145534532476,-.2686930816586796,1.7111433195717551,.6419839825628848,2.26473616505312,7.514985317775693,6.679693540170412,5.94148903250758,3.412853642041138,.4963231014820144,-1.4913637092256067,-.7952049967981086,-1.4963913531387842,.14037129865286743,-.0882721885400375,-.9708904737271209,-1.1817712446401285,1.0379705713112286,-.2202125648256669,-.6171846921762851,-1.3946461125173968,-.46597501717974454,-3.7083800585073194,.4873700340999259,1.2917786033793615,.2832108961297554,.48064630639845074,-.0976840239829019,.7403375666408383,10.997862007518222,1.5136896274796563,.3231633413281845,-1.3543269484060878,-.32392365894255465,.4929576347543315,-1.240113035687768,-.6767172013028827,-.2498485995514511,.26648822208735146,.5213005533493409,2.6080236691452234,-1.4947457895970646,1.4100510477005963,-1.4206182335949251,1.9520369187597995,1.2950418447209862,2.7741407328858902,3.5986202818551765,.41779475716454,.20610336920171862,.4821609450324224,.6611158504164681,-.347755237004189,4.043179380246491,1.652891940199479,1.2600201440328964,2.1646679163644222,.3945520725704444,-4.725108295954291,.21295048630838537,.4056229113697016,.15481896400923142,-.2953947890158391,-.8373704680237664,2.3055889001508425,5.872550108581872,-6.302690618245088,2.1374713872748643,3.1892970754756855,.31993839070182706,-.012894939563877253,1.2664917786956973,.6025238121434332,.37975537806917986,.7458980704002101,1.0260431618872703,-2.3378415787334466,1.12630213753586,2.465509045225273,3.526656160736275,3.9532403424409805,1.7143503658578785,2.5252954936347094,2.7554130087828836,1.3390429550458753,.4197430985285594,.22672846318193182,.02460671102544835,-1.2267449628955138,2.922462017019537,4.9880813477836865,.6467448379323957,.12487533266834121,2.7445284534355046,1.057636919434379,-1.8491290161795193,1.2036672318464319,.10739448146603295,-.5176738250323414,-.9558685046389667,-.555151328477059,6.771007285269972,-1.697239599415047,.7512716199937037,-1.2497008553729325,-1.6409356065330032,.7512199044187555,2.164057536546608,1.0946250576144836,.15609377462758656,-.20246970129605787,-.6311133010756272,1.512529248107554,-3.0327400754515397,-4.092161577992516,.5967260370099908,.5229918377822886,2.246514690838591,2.7125539512838404,-.7878067632263104,-.6438437418671978,.12693104830021348,-.5188182036279776,.5752989172846419,-.06888984797145882,3.6969179990309358,-4.952904923663175,-3.2068420517957628,-1.1644917380323707,.034362713197302004,2.2001551553633276,4.286291394551697,.47202341599884723,-.231300195253309,.18215673246173408,-.20866437834141704,-.7179478867985729,-1.604168387581377,-7.225502090381509,-1.7966503735461905,1.021795666081102,.002725551125982291,-.22221026208471797,-2.215885023228995,-.893597149185022,-.2630818155878439,-.6854243606353124,.40039246334404655,3.166164237441061,4.208085756515162,.7895110562086426,-1.50533557436798,-1.1043318744034216,-1.4103961293030824,.71947445150728,-.6836342717740425,-1.0144678105319684,-.30135669316086294,-.5258909335946194,-1.1726989313567424,-.2456096049880823,-2.3683740869160133,-11.421019595379674,-5.667252768930212,-2.087888951514298,-.1534929271533339,-1.83946275264766,-2.1253936377481315,-.6523880524537745,-.17227861822427556,-.7483871273675381,-.8308998096207528,1.6110148210197976,-3.0775455162259906,-1.3012100791078391,-2.559167992515165,-4.873133396875959,-3.125700836587629,-2.1075683730292933,-1.018900305786943,-.3216293663971673,.008910986960381125,-.2316207919605516,-.8675328481095479,-.5967390919312099,-4.023610320746462,-4.450149589429382,-2.406360639699252,-5.067921507427434,-3.541499787819435,-1.3202684686051225,-1.6344115012927494,.6919192895899516,.33533843492718096,-.4364599249324907,-.2347666296458604,-.8882154493025822,-.7435571184653834,3.0706051981958105,.37416583810027493,-1.7886896160947106,-.8010620670372093,-1.194689912856326,-1.0011211396889317,-1.332051202878397,-.18175273839710399,.3341458555042068,1.1149466339180139,1.5513863982366818,4.407103266450122,3.3570255447507207,1.5186138132173397,.3842942621976496,.08501845348277585,1.0877354920172604,3.236566242029837,.20417067904945455,.06342471972829634,1.2134470722942596,.3102368065240313,-.7947119749644118,-3.960485213492011,-3.292708827817335,1.9396979233193672,2.080715825382752,-.3218200277136303,.6058963296265841,1.1207095927171504,-.11200438285815886,-.08972267997952021,-.26993561809666533,-1.2779277420376116,-1.9412398972289011,.36009113985036717,-.6374821233811274,-.6142012353896253,-1.9761234495819653,-.5581738588403804,1.3205120877823928,-3.032736854165365,-.4735007547211238,-.4331997124582317,-.7945707566993717,-.2898848565228909,-.8287592963974363,-2.2955421618707157,-4.950566863733113,-2.0969426734269097,-.9976917518989384,-1.4379099939529145,-1.295653184144037,1.545485479024218,1.1303403008186474,.17994240909071085,-.38542741818688836,-.17156019371863782,-3.466724295029315,-1.9525925479455655,-2.048866336443724,2.566306814644463,.3315699779510551,-.9717089127421956,1.9575018052806832,-.926755122424774,-.3282940804438316,-.20123882635118132,-.13528408716145088,-.28389296609106107,4.183676125515299,.36927917392519033,.8756542999418666,.805806190732271,-2.393274656961759,-.23114376785538052,-2.9569920347213543,-1.118793005313231,.992040958042287,.14411801594485316,-.4436351461427551,-.3034615338883328,2.7889215927516875,10.278143749720849,1.5001099011410688,.9069166331882189,1.3405441023215605,1.1015412016469297,1.0779978572255564,.7815556315856782,.6549380587948629,.32731681497727205,-.027868997219691886,-.6986191138584078,.07577066752159206,.3038593516517035,1.6037257836499594,-1.07132385648413,1.496506228610837,1.4129548744892855,.5462903613939608,-1.763262959167577,.4464398094451894,-.11126222688562644,-.7466399435628619,.03944008587396952,.2719010990738039,-5.020213901030787,-3.0206690178229354,.20446413917849177,-1.6047737854958495,-2.4816613407140258,-.849350178093532,-1.561660877462428,-1.2546322467412867,-.23606154518202505,.16470774594764945,-.0866141070097281,-.07344390755395969,-.11390960361362584,-6.137219027425607,-5.875570342942724,-3.4773726421477384,-2.800505939501746,-.28068232558920714,-1.175012764276608,-.24623994488627832,.3199123489934724,.5054861924797504,1.6537011505478418,2.673664322189246,2.7402693266598592,1.5926177079949524,.0017113486431430288,-.13989320776525105,1.0123457608817146,1.6523857647505646,.9480123922453189,.06848573450106804,-.3275285871577315,.38168523786699543,.7842359254625936,2.1414721547195876,4.101209497313389,2.203452027596743,3.4833444435021397,4.078038183859778,2.9034686729409755,-.4667843227203208,3.4409606984574794,.05939898736431805,.40242614077408134,1.00718008794562,1.1037153633236412,4.127162528425398,12.28510201394965,7.103241013957366,7.9011890116016055,5.551848016707992,2.312952209296513,1.8155996894454645,2.1869667643756476,-.08658793573681778,-.07796728473366783,.424093222210239,-.271880291417626,.19463017375507502,.6301689046553685,2.0943908558166764,4.868043596454705,3.4328927938717766,3.2242274057927554,3.8532660024984833,2.166728431399018,-.6083051490467155,.12779582184644475,-.6160985424846769,-.9394006931735441,-4.403975767632304,-3.125140213843522,-.0012579761189345257,1.553740487447978,-1.7788908563510883,-.2998734980532272,-.39039677875122963,-2.4325170885969634,.9613450090033726,-.22409144723654748,-1.3666451098108496,-.45391356179615966,-.913073008741553,-6.10088428947143,-.6351220161088175,-.7296374057188528,-1.7294731046777971,-.9462589493228004,-.23148319430657172,.7289555160212132,1.3381570589548069,.36345484689826163,-.6914033854660115,-.09215169720193331,-2.139017922044578,-4.5966480996251216,3.0498268730613813,.6994521149348931,-.5701397466566274,-.9537216849185682,.17500322125767628,-.5567811514347909,.8117988393652336,.021740777967079277,-.41256541302668365,-.9299406885558531,-3.17365190679974,-5.156153359958292,-9.335868400195007,-1.9800225420571094,-1.6447531741928472,-2.8225433378142064,-1.3672520299768,.9114640436838267,1.4565375259926552,-.013492259039830853,-.29987446423314357,.19000146110852745,-1.7354669388985873,-3.378088470276222,-1.5643891990162972,.8977252614453305,.12498610659411005,.9350106670282224,.1662860063589994,3.7861196054080466,1.1165006704071079,.3020086344136199,.5016594379196552,.5011076008413967,-.771635094811879,3.598203287203561,4.037062134752723,6.249768166054901,5.5532953645594105,4.361942665726316,2.0807660011627602],rie=[10.738043677986466,4.573162790875471,1.8474602324099307,3.066196995582262,.3569663870381231,2.566613401176826,22.422500418825965,29.733742054068436,36.897330467857984,43.45624111278399,33.29429690360909,19.66490337780872,7.533961581362516,3.387576028337058,1.5506673328826095,3.447097709458617,1.8210129727340085,6.651608141946243,13.160550521071784,30.987821147837266,32.10655364966504,41.50349044133422,33.12314374480881,14.141956172257775,10.051976577184641,5.068274714831645,2.4758319347997526,3.6776535942355495,2.9212909134775202,7.024101679760495,29.894162985729977,35.70790238638533,38.268910743721115,41.85516559165757,33.07743110494231,17.591145198263295,5.0443444990608555,3.61546039193561,1.5535899395410837,3.820437184052889,1.5059391439412988,4.155345980112216,18.048716696068706,23.311678562157553,36.605805777581125,42.9564991038764,31.747016418090727,14.676714174769774,10.31346130304193,4.581854673399172,2.2619742564422576,3.491689857386686,1.1687462763501129,6.753965362716781,13.20428049450379,32.29959214423227,40.918336389621835,44.5717461937455,33.63432062531396,17.247979060195178,8.665463153683278,3.0685773589266114,2.1049972408792255,3.567077094137196,.7847842179318552,3.3802901965117087,19.937418229446795,31.288679656363804,34.89395050543345,43.53558738514793,33.04103280496397,16.722237231280296,7.198956612666731,3.9392796950297924,1.8831172772839533,4.106223611044033,2.0526119444479383,4.667830624923259,24.154987927809223,34.28575616453526,38.18831966637157,42.713899756990315,35.04311347714135,18.61504925736444,11.175719329413772,3.2053286798047447,1.8531987157276872,3.688057574678137,2.0484977582556136,5.3969644684886005,23.476031740107956,33.99874053261087,31.22567118094068,43.0031907116297,35.6749645763593,18.436400567065046,12.02075661924394,5.550193353608921,2.244237833289043,2.9137911908407097,1.5186733234325376,4.230580026643776,23.17312847690815,28.623719480726308,38.57448301108575,43.056499769196265,33.1925177295531,15.112228992967223,10.529505124318648,4.611826844178395,2.629574142706294,2.970991011203966,1.7107845537430437,7.053021086819451,28.174723100020547,30.82320883221607,33.17968836905789,46.47786558863444,36.59729230786723,17.40155104873017,10.723996227093112,3.619759074890588,1.5945432184374628,3.532276686563998,.8677311377181832,4.870689316914542,22.38112599857208,28.404369517700513,37.942608277974195,41.99399364997257,33.98826213605374,19.524959134938914,11.856104553436143,5.325699033140503,2.2021241077419784,2.7090095686184545,2.0795320337917986,4.998775901243355,27.82010056450263,26.311763531262827,35.64649044596076,45.193365082112045,35.011368272756584,17.41367980724137,10.40234759726436,5.570958001784723,1.8606635368369582,3.7567023818615066,1.3904072649762023,7.237521561002866,28.923621546399794,31.626571624950028,33.37596836297922,42.47612701916743,34.96805884460076,18.550930345749435,9.432958754966572,3.2518082780012993,1.8227312357113366,2.834440997107122,1.3560902362974816,1.8486304084949516,10.60486459192835,32.39236427798812,39.49653781397556,42.21931555538827,34.74589884110406,18.50485996061547,8.66477668396578,4.434652138222447,2.2991990533545623,3.66503124836453,.5464134251279126,3.3462934962137947,20.703290744581967,30.514188496198717,33.84910267763323,42.909693196575525,35.26930863608236,18.370217354473404,10.030661175445381,5.504230008104057,2.0205342921147964,3.173116749555086,.7426497076890934,1.380822434069851,20.08527130649064,33.96124135173743,34.62184938038158,43.13744264612839,35.41858288735428,18.21800818465382,9.663558608329923,4.573936192689223,2.0605166876817926,3.1529774388899114,.4312594457062394,1.0278905442842854,16.40833256113343,32.93366376612099,37.49112613775624,42.49597210239503,34.17415325232956,16.928219375034235,7.711175865141706,5.053456672298917,2.2493518076280017,3.696695519664965,2.0111125122013718,6.094552179393792,29.76982948145021,31.290929651917747,38.397378405218184,43.62317520020738,35.44500393957989,15.672797376386434,10.255657836277358,5.436046943001271,2.578663910791458,2.130612957245916,.4537742807932182,2.725233058913707,21.656219757717597,32.76033051351881,40.40009631811326,42.063933084351746,33.91494109815457,16.248465292470613,8.597725593657296,5.003082225155779,1.7653172615528958,2.9832163017999096,.20533886140769864,1.7092811918199653,10.765881708079236,29.03301479199409,34.840455972412435,42.66439572981825,31.43529630059693,17.272217931391864,8.11625577880297,4.658447191272281,1.7612809058219032,3.276179762287307,1.2459581876548156,4.063539355853831,12.065728285384512,25.880595351623196,37.44037674072754,43.47656194061117,34.47093597141503,17.954902311860298,11.067143938843412,4.467756965679912,2.0863013123605265,3.296814124348974,1.826269782685203,2.021593260260906,20.44531387376739,34.03257001626389,34.53566230225354,41.85344023037935,33.42215558056139,19.176590015615997,10.660690177949656,5.013063586623905,2.22514860613322,3.4935874828471247,.9717978053658058,5.385430717062962,19.155617175450644,29.942624882949087,32.215884537915244,40.65252763431586,34.78005983130811,19.46319612574586,9.436313232697724,3.1475159363092295,1.8455459258687419,4.168097762957995,1.2790021970815566,2.852082608739197,25.947176461801124,28.387246275385042,35.724483334751675,44.54559272836708,34.284426743593706,18.717303502348848,5.662797497071499,3.8268336449507205,1.7265943922055356,4.032512294278391,1.4292382622608268,4.412906569051125,26.618799434983465,29.58676075165988,36.0900328321527,41.57040260147636,34.94786514361852,18.278043383866226,9.992960049725985,3.3158712451653023,1.8409658994801035,4.098904064740345,2.143506139034889,5.619518641931294,27.46077788006002,34.05915233642693,33.822932290314526,41.09952783281252,32.505819516548385,19.427261803496076,5.984612799912657,4.455062152539334,2.2518586966585388,4.414521534603889,2.828372367878801,5.813746725898796,13.635187167398584,22.880458206378545,34.091905247991086,41.33132123588448,33.22795420312874,17.747938133092735,9.991753140733039,5.158767276832909,2.1699932301669826,3.8236296006538653,2.1813352373363304,3.2178509043668146,29.08544315934444,29.122340888527667,38.50759094882325,42.6640121234586,31.84980088369526,18.32790407690667,11.80946718664379,4.831937352781882,2.2739998816417515,2.9609534345058615,1.8415654996857769,4.216225085471314,24.96856101455329,33.142671664380586,36.54658982695707,43.92343810097479,35.32055354049083,16.709860158690738,6.392868731845633,3.6432148186347035,1.6965890371638,3.4500002649362154,1.3170693406440364,5.049905674179993,22.507149987710363,30.709653238589325,37.24999193829454,42.30683214504522,34.00011123455452,18.92367910169378,7.887994578713109,3.9320862857574084,1.7090785694175883,2.5062933649700154,1.2819655636759952,1.5877366792379086,18.178010949336358,33.28448441795332,31.678312673905083,42.1811119709549,34.50352861638824,18.34860744195834,12.092254679227711,4.108535773842121,1.538783461982417,3.887095284890308,2.461122437982105,5.682992067455651,17.582380168628557,26.608006265409266,31.850447231173256,44.0299598024168,31.472275922206062,18.41933829427892,10.758504669378443,4.109064709912856,2.4114365767592765,3.5077383771777453,1.90839115561099,3.3848305928294873,22.425502093434414,33.653716716344334,34.22321801616019,43.050493804133424,30.517856627531852,17.58682724928766,11.494850979266195,4.042610424393376,1.8936704964755824,2.7642368693494834,1.430442256465423,6.156764537322067,17.88998239378424,29.93850678924541,35.97640626183285,40.72106319821167,35.736436918083356,18.37276662438654,11.334586580801162,4.357018203214477,1.524825445407108,2.663614768950993,1.411588297654379,5.784106885947475,18.52161146062428,27.76957623461454,36.931696234913524,41.47708758869049,32.409800273906896,16.920995209039127,8.047694211274715,5.469949612013804,2.682787723034793,3.2750672786327004,1.7608422498176002,5.917177238203159,23.101876729905786,23.417655657320644,38.757244857960316,42.99798582092698,33.32847794649326,14.749422256431327,5.957425218905746,4.8614808761438955,2.0548785340293447,3.02426968674633,.44817084729809187,.9330468849061645,10.687325941353926,29.513627346811067,33.22483599849803,40.813916788833865,35.543840747564815,18.18861188370473,12.248886374526146,5.343017916950534,2.670248406719313,3.2178728966763934,1.161189008945449,6.607955664463354,26.72980493841571,32.7191872583476,38.76394832282076,44.75603774360629,33.495909764456776,10.394533547648386,11.999482186907157,5.539383425061187,2.6266987266277435,3.352256071631856,1.1039287871916457,5.588982025549599,22.173164676958677,31.073809456351007,40.43059315860459,44.17890413952847,34.38288197787685,18.675598995686645,11.031829194389642,3.2303779204698917,2.1664955912115222,3.1281053838354738,2.087605526245803,4.967656818222485,25.06408467551659,28.543023294759518,38.46251652400716,44.62500855629084,33.39472610844875,17.01861463312808,11.487190904657655,3.632960572552396,1.999391104758977,3.6323069252758846,.42642827009786805,3.2502810942052007,25.47074332374212,31.005693204282245,36.931257021751144,42.46924746786548,32.862298370637546,17.82603119456849,5.992126110837323,5.081554454511195,2.2060474152502465,3.7096123185748526,1.1487573888703997,2.9883518405581184,10.842436278023117,27.86817357355284,34.68539960002878,40.41789591351543,32.87930450852451,16.975174470993345,6.5389687277524775,3.4241707462371007,2.1829584598857488,3.6619513890081175,2.9513541464671196,7.172884325142562,27.18837764675706,30.20455874698774,32.54992768168207,41.40096922156487,32.89979541816193,16.63574297127747,7.298156431110755,3.558479279000582,1.675986301347596,3.62991612655546,2.031019341711058,4.939230658185551,14.010527689500377,32.946865856474176,34.10876494841074,41.068141982506965,29.91764950700123,16.94383997872892,11.942000041721116,2.4379682726200764,1.6933051591376893,3.8106669191633573,1.597391733654793,5.886016064591681,25.70240342000377,33.49968036086859,36.73427961470962,39.96098225046069,34.446570569640876,17.70073352734551,11.85033752465379,3.6897920586550983,1.7479768168761824,2.7243539456742947,1.7474905942898349,2.9538055137424366,7.495703871456528,31.9140955545621,30.54184685858726,43.5582790116353,36.3524137806118,18.44763525913035,11.184549364501738,4.245792864755459,2.2211929486144313,3.6101391445151303,1.9975785162032835,5.185733548323152,27.50873434754319,31.867325857382593,38.19994730996505,42.21410246498752,29.131435898534377,17.99133084731935,8.807644718864795,3.2845280410299806,1.6903575945768352,1.790870601744318,.062441820700333196,3.453110722586303,17.638870306429858,33.556886688128365,32.67511089933033,41.81272586180382,35.61587954415788,17.60361523424863,8.248785641512432,4.523460546539433,2.1022228056165444,2.6399795069558105,1.8617080786586904,3.803377233451714,24.277842727178076,33.63155344229772,34.915085038092435,42.75782676344567,34.009261529321826,18.35081564230837,9.593633846176488,2.6566619959493676,1.596310620562725,4.019017686731216,2.0648842559753167,5.034464807744462,22.902695804516757,25.193374486577948,34.752155851618845,41.870028809940266,33.95983411222908,17.58441146958736,10.602545810426435,4.497940456795887,1.935856457852908,4.000987852609974,2.802377221785262,8.772896065035605,25.416075852872066,33.10358389666243,37.3375335868877,41.9726297504455,33.00149429467247,14.871963195303772,6.230221196984792,2.177204564149958,1.688946323599673,2.740166873333132,.10974618562170133,1.864564545311963,22.39345845167539,34.51664520500604,37.78637799974603,41.50277469549748,32.86553182090629,16.621741786136916,6.567293309578705,3.6541528133778276,1.737437948080409,3.294210158369989,1.895810756783375,2.5587358832038976,19.88460260787214,33.15535300938751,36.2446023378167,36.122539280070015,33.29711056181808,19.249669113990326,8.765750647973492,4.687509738736944,1.953041195656554,4.1973536200385695,1.2630927644833947,2.248880787629327,19.52025969607888,33.205346888798225,36.752289033458695,39.04845369547357,29.760401150873687,18.373507578314864,5.951089887575717,5.020797136513342,2.5062664357409794,4.445122412024365,2.5693588835965855,13.148626779454737,25.599501845433085,35.09499568638413,36.37629124571908,40.46681394412217,24.21065501054382,13.339159248429185,10.753790888705007,4.475170995121601,2.4995137594457155,3.7081069211205238,2.47300524070575,9.487266868270815,31.389559601820075,23.133911647389546,36.839846659530984,42.03053478757354,32.649263118037176,15.405519996734913,11.081975936019717,4.407168866845204,1.6333850045251843,2.269937834325381,.2983106102821045,1.1106681275250656,10.67331920654115,32.99756863121351,36.306519965150365,41.4327300945805,33.22476491421422,14.08385279815983,12.54038083152308,3.67816896032867,2.3546931046417106,2.840941486119447,.616331548862511,2.304879058224421,20.881613258095868,32.266451470265366,38.49491192416674,40.49849783880881,31.458839870041096,18.505083550443572,7.196417448468178,4.141987066080274,2.067332855876396,2.726746402267376,.6972570560898417,3.2411640358908254,20.98865939873964,29.033616925672654,32.556451099460666,38.904382450029665,31.606420394719777,17.12991775333911,11.326162858549445,5.280956323577788,2.363522818353818,2.982505499112782,2.1097212940050687,2.286978166502126,23.58674433792655,31.9633349202803,39.4130162354421,43.11395015561659,33.38436324918099,16.840685594547736,6.052201413821684,2.89179267653675,1.821271938909677,3.212140719203139,1.2799149574246624,1.2229230715236177,12.237461590623074,33.70409153788144,31.449145116361617,39.766598069438665,32.1924246513998,11.677007017991786,5.539352085943082,2.8807124370294597,1.7312041636276112,2.2546293993620634,.09991187652445284,.817582460104762,10.153379895220656,30.35063500406965,34.94936085589267,38.641492551583646,31.29158260639996,14.173531052425043,9.529454919943092,2.8758727084925457,1.5263858378061161,4.38878956731281,1.9131246406279032,5.914750296521521,23.766442961144495,34.29424155122113,35.95394730366164,42.21757050363935,32.39598074457734,18.418942762188763,6.644363672347458,2.917160482582685,1.798256467212977,3.8966240976156996,2.2902875604723514,4.236392088589184,27.375213609411286,32.879046391381586,37.96577600201962,42.306103132676405,31.530903320440967,13.666262093936957,9.285858875815833,2.872697933634124,1.7976886327538684,3.7122665406261377,.5611135427209262,1.6719698418242277,20.873619591042488,31.674920082925862,36.72015292405791,39.86811102713999,33.47328466155659,12.46423003507517,11.16546225776516,5.356703902720401,2.4151714027252313,3.565071098007166,1.361514793642497,2.9723991273710366,28.290687172944388,32.97637664964542,37.25218504145036,37.728680970925545,32.35338474781599,18.138765834681507,9.439511436680942,4.459982284223848,1.7963420343224592,3.2719248940490853,2.252012340851531,8.207434445692861,19.678965658221347,28.56317673236804,33.63269802453607,43.06087116379107,32.73451859118566,18.38675915417851,11.955986846706562,4.080287556573152,2.0100346974160384,4.095439031073853,2.190231633167082,4.413521816099529,26.498611264055352,31.153932869338878,34.77747985715958,41.67309590357161,31.398926164538842,9.514235397679784,7.1684950520713375,4.843130264487757,2.658705380778677,3.4553601851996283,1.762635299982852,7.374915784174613,26.925591047568066,21.104969168602825,36.19778558956243,41.520945665914454,31.84915494061017,17.225957942757947,11.78476325453898,4.966565893840724,2.537126662431226,4.368613457873107,2.4352080127791815,1.5378548480901335,23.675332277988474,29.625110699342173,33.36290557935618,41.41183059327702,31.154214016498344,19.145083809117956,9.658310340747374,5.143022240453164,2.173195442466786,3.5641224605092976,1.1260573886371545,2.980576998529559,25.332959105355567,35.644655674240525,33.66519717175156,38.03246906458369,34.4283867703003,18.509028662884113,7.485411781247758,4.784479374996522,1.4860135301305735,1.9220298342398603,.17424155440833014,1.991041119715656,19.5107144221881,26.46805483438103,31.05679450481517,39.56184691528479,31.769341223536458,18.3622768754128,9.831594406223159,4.512274596478163,2.059740860144145,3.668123669325488,1.2549669688865641,6.4735849826880605,22.054764144137437,25.296144459261676,36.95406951487048,41.63549198963446,33.744377419058075,17.647833761095853,9.682516815206029,3.721691730254827,2.041372532860333,1.475426540682359,1.1441740957821371,.9609927748823635,17.42881156939425,23.87570814935875,30.447719447156217,39.380746664200764,33.27407283840477,18.28663495987792,12.209092996921157,5.5241958658946535,1.971026541596967,3.295549796255984,.6938046305102884,3.288652855705718,19.51348496636689,24.2531364369824,36.39585488117813,42.703098190549994,34.05541142223453,17.4480511220739,6.524268903318088,3.5435666656235183,1.6034788188086995,2.252677121926296,1.1369182697876865,5.946993640788973,22.784386205936375,33.12117317865682,33.54739152000708,39.69333877660558,30.61010641072201,17.3733678984226,9.417567999005502,3.115060856255294,1.7807103976589749,2.3627193856246285,.02557623510483612,1.8368047411129622,13.46491673689168,12.515042792385447,29.022779375452206,40.42391085279433,34.21222868540259,16.560811582418374,9.251565310991827,4.1929016412426705,2.3561988434276184,3.507207041728425,1.33829040068645,4.019822838021375,21.005161659220548,31.351433198554982,34.137970073473205,38.75134749125058,30.03417545469573,18.05699467403467,11.616582948016276,4.66600357012841,2.6666241051794395,2.931888589226368,.892355064362221,3.75027010591409,20.005150605262635,28.128148401548586,35.696476205351026,38.856243064220465,32.20757658886586,15.958301519285182,4.299952773628952,4.7341533469911035,2.4791468713545455,3.0235036282357366,1.0910378918870711,4.27627688475656,21.237603527732084,36.328666373143854,37.11984384203146,39.18795114098239,32.623524264613394,17.001782381003093,10.29240576582174,3.5322904768846,1.6083797816010037,3.6771100469374343,2.374452923940923,5.2609031576811205,26.080660474843626,29.12915152576923,36.793810667134075,41.24817600513194,32.48539100182074,18.438061212094993,11.65151163941511,3.7276481560323007,1.6236303920886184,3.8260375664538904,1.6114648377784897,4.647967575518048,14.533496965720916,27.182915637986653,37.07016900362627,42.889584973617026,29.956349313392565,18.420492165621663,12.534766187043717,4.348066701010071,1.7614175833434316,3.6564172200621843,.8205008300059895,5.777934820258415,26.931584207659746,32.64064582843329,36.73390626733841,40.16557229861273,32.15464019038169,17.38861290164952,3.7887901902002943,3.832275872271966,1.6283927939478893,2.6837964455255934,.18756859262444656,2.263499314356143,18.533877342383736,23.358644403498673,31.52412900586439,42.73132330042183,34.23111652236413,16.92401828784934,10.719703765579396,4.9956833232602715,1.9049805292639002,2.9984490270234505,1.6184821931090219,1.7463713657700348,10.003826302648593,28.60971294649531,37.40641528367354,42.75261073824125,32.27053416076819,17.943821364305265,10.72084769181853,4.4751946019376385,2.198532000097325,4.266002539303926,2.0948953879295686,8.218286439814815,25.609033931982,33.05476027489865,36.98346644980967,39.979538957581596,32.67778058342132,15.471214141867756,8.415356568245244,5.024993121167589,2.174589904979542,2.4084946420617244,1.0897294063486629,5.980029638487173,26.380663630969238,32.01966224549688,36.96153238638612,40.68095103331104,33.36252406169553,18.366876936681372,10.56833738947232,4.397108495055231,2.11238497515229,3.625800914102983,1.1722069631351355,5.037300145067397,25.172764494847303,30.270523814845745,33.144644089022066,41.415655108270215,33.107237493383515,18.097130069749138,5.225207656741379,4.96197752172794,2.0146403190430258,2.5959564426895465,.6009173744640447,3.8917919730068165,12.7212577841089,26.064322900108003,35.16381522111186,40.638598591094116,31.650576338810605,17.35430919585124,6.864579498375279,3.730650228133123,1.5932181591055317,3.4942432554277,.642398959187125,1.290124167448581,21.790881639422487,23.968615710943354,25.209506470197933,38.759027716303876,32.47823589033335,18.603286554450143,7.735957438672926,4.405867233662547,2.701918353483895,3.909698416431442,3.2197408507357164,5.187121937247414,18.89740156344899,33.54251027937374,35.25512267238066,39.89509636256852,34.05120918921976,18.68817929904784,10.015815473033285,4.1469494392770425,1.6585263491747773,3.932322986163404,2.430370769428867,7.126788857983838,26.009431020124502,31.994643186621534,35.34277734046137,41.39229568341923,31.579387142510143,15.429275178979681,11.441745750551739,4.747018898363287,2.603207244012067,4.3266465099859515,2.08758563766763,6.439519903889923,25.402571004792783,33.894721589182794,37.76697692034764,40.63786674698872,31.61227063968402,16.514271176849995,11.219114789470359,3.6699300663488144,1.5811879646392837,4.201904837265585,1.7838879523795126,7.4211582280120405,23.256895521017032,30.887374056696906,37.67909790468468,39.29979244173828,31.629334067548434,17.551476543336303,10.838075594021152,2.901193481776517,1.5553637765410806,2.1722604471510207,.695730484668289,1.232924523888437,16.55635671398906,29.27773032117818,37.032503732049236,41.174474610829684,32.77024011274121,17.95908300946313,5.096841543657178,4.373018103989495,1.7389787011759306,1.810092358280849,.07943776786482776,2.1132113131514347,11.578015778236825,32.07620300865218,33.38743151417765,42.074176473000975,32.80149640137697,17.119406976968072,11.230182605805789,4.438977139454255,2.3336009701993614,3.135580804629443,1.9704530765150228,2.090139350256325,15.060281338242545,30.892561808000785,36.281292213947715,41.333503455989685,31.973053134864184,17.987803116599718,11.009378852495294,3.560979622967306,1.7802560028704875,3.2978527933475643,.10430121851359805,1.5539264991417492,19.74077148484785,18.689276201935105,36.10176332546105,39.74731042305091,31.96919837266322,16.447520758865007,11.623571244930314,5.023989571683968,1.578416294235892,3.946978959685913,2.177004211876072,3.3455778822156836,18.285748050424267,29.9749444525683,35.85487916106321,40.457546147632755,32.584850030331296,17.97171729961007,12.361893131235915,4.91598302444709,2.0345091159531115,2.934501743071446,1.7629307689736962,4.355430098688431,25.205986070495705,34.450777309320245,37.86445949062097,41.957156395335176,32.93711384381775,18.257783963338436],sie=[.6312089057765664,.20186931520809412,.06607897573323818,-.7962591614232871,-.058655776676987785,-1.4559452736405434,-11.749181212032683,3.2464683002425994,-.5908105027270636,-2.023511018065737,-.08656578943336199,-5.581050579874036,4.999907173765551,.2905929318281547,.8040257716885235,-.6061562234536945,-1.2046814238352255,-4.346741646372554,7.721038289451858,1.2613905707668018,6.36949424108471,-1.005036818136477,-1.647846644772429,4.372719840026044,-1.636629484252866,-.04328515929874599,-.3012439626719308,-1.2691589523823446,-1.831562854398259,-1.045954666134204,-3.513499354913389,-3.6703805195826034,-1.325921442372758,-1.1943843315550255,.30258309420102864,.7851835344798364,3.6204321846565195,.819191746325195,.7456091135756165,-.15540593570342204,-.9595257218723139,-.8085449352829404,2.654362508248728,7.202267142897231,-2.757034494138361,-.04719724930051862,3.503772063626965,3.693348691004828,1.4899030364191461,.2500597746404542,.01200804922548732,-.5307364228048793,.6727889456169572,-2.5378615622113747,11.764134824038937,.8600092318523836,-4.3899324830512905,-.6485809938797051,1.7041092171722132,-.5382109208542842,1.6268759342574943,.46371311803670007,-.4966174594386974,.11003295288455452,1.5896229540025033,1.8806129614525604,6.143242244638177,-2.159528129889523,1.8998601628724234,-2.287411379077736,-.572725250451919,1.7254321330973919,4.452555026353636,-.2116315387511637,-.25948688521094776,-.2801860447289808,-.4411471085704943,-.019989980312990666,-9.62158385216886,-7.117795738068421,-1.1183529061337163,.17545266120556713,-5.086929717041007,-.204161889884121,.15037625054726989,2.075607742859685,.510303311302105,-.7055520758343249,.061202025826135834,-3.1100563159192123,.11060668189784569,-2.03554836360364,8.187134896289981,.13157666672096985,-2.3081053773344853,-1.6040451395499664,-2.3617613462401006,-.976273183142179,-.1837299230612856,.23918624819725817,-1.0874138776237436,-3.202705352691056,-6.7648508746639955,4.309845225158837,-1.0834934223923227,-.5813644789475196,.9638396289370491,1.8159328377480548,-.5424457599667039,.5469280712973105,-.4595890085783304,.8526385892096283,.4705281597285046,-3.8351701824784628,.9246832249975199,-1.7008679428251388,5.327902579676158,-3.83442162107567,-4.747491427054863,.9263530266800339,1.0854709596761765,1.2121782780535109,.6794566631159205,-.5713232519821897,.9738344214176597,-.6546255612459194,2.5872412154671727,4.755174900456479,-1.3963278716182899,1.9077252451754163,1.3319990958424668,-2.8152213777836814,-.0527333195700872,-.49378309480934746,.07185934149300537,.2519438659633601,-.23799484173575006,-.78267210073794,-2.8399490215735925,6.830735622151722,.8998667639256579,-1.2701998822461433,.3270615697295072,-.7119676866870138,-.1154221463684482,-2.0386675248214328,-.25228375539643055,-.07959233483975481,.9839999069581609,-1.9766218289708213,-2.8552914217515504,-2.511293613105759,3.417837176508305,-1.2484075235093837,-2.499755812278069,-.10326323340111643,1.6046071499505776,-.02143035775323302,.34376399745658054,.29366438666283656,.7315144540568841,3.1188722284731916,14.447106109425464,-3.849477459076811,-1.0151956551178034,2.405392640444114,-1.3513975727738436,-1.4863519265860299,1.6540827896523669,.14718359155812846,-.0372443649817855,-.17334139100894633,.6223096256907629,3.407630465639238,-7.4990333552713055,1.7853609179630452,7.069168235048785,1.661982791411517,-1.6350417746737702,-1.1308869843431264,-.5980536238265481,-2.3567140717445842,-.1749883663077214,.994981013498424,.536347002482365,1.4712377606593952,5.861871179093145,-5.574029183584801,1.1025819291143928,1.4298699014278244,-1.1164159229382524,.5089634022896087,-2.1296120392924336,-1.1863601642940151,-.5098493547691786,.29412027061816204,1.3897448734186613,5.62371759742762,-3.247782038167956,-1.92905401424127,-5.3845724875936956,-.97257471469188,-1.051009507716628,-2.7862632026480365,2.3455946702253763,.014818042487884328,.22648012726705335,-.019041925420184912,.910178417193474,.9293663772433018,.12412922948491287,4.416730174258035,-.12878709356401896,-1.7885731893973726,-2.3849383496619754,1.9272701708525384,1.4628155384589716,-.297136409564641,-.3347406016186646,.7831782334686177,1.0647636206461017,1.5053469679881692,1.52724030083236,-4.136611033108453,-1.8063804187828207,1.0136747543117859,-.70509251853698,-1.1436791659336143,1.9366427454427098,-.3912553810815895,.8642568813442113,-.01222529052021157,1.5054456922887367,5.345263270732146,17.42581428213325,1.790231323983461,-1.660718886775945,3.8135404634724512,5.1620518388126175,.12935623971702556,-3.0716951216442028,-1.0429854861884447,-.28314790208531926,.3475303242922351,.2599884887800203,.09180662416979879,5.990507560375016,-2.568916790447033,-.8345709620799505,-.5200628369499882,-2.7076224707611085,-3.2781881361517238,-.34243153635915785,-.5406057541713868,-.4917580935852867,.23546256229141288,-.9583480585482669,2.8503822658816946,1.9486123607606562,-5.626702075922362,3.4093064978838092,.16370060595915628,.550559749494493,.3494199752519444,.3486886746852026,-1.4520839638615992,-.4448926032527248,-.1957346893756865,-.8674965877285913,-3.8315042179310987,.5851543098177653,-11.245953050289849,3.885878788655883,-.9052172098059771,-2.794031889253058,-3.0078261912699458,3.1040675992487863,.5306530238559802,.5091471787023923,-1.327156276953082,-.6626706481827704,-.5472035505546776,-5.075753639378391,3.861994484233847,2.7516076644198466,-4.04709488878052,-2.825586874159208,-.21221995022704992,1.5336199514890392,.3151534212063999,.3407384637020782,-1.305765892328888,-.7319811934394339,-1.1717792139813177,-5.6406647715967235,-.5531934787436324,-3.5172851659089237,-2.68391798818727,-3.341513380578421,-1.148158975580582,2.2558962913134217,2.0271378354818306,.8292706951089147,-.881031168207607,-.9823208303618622,.9883721484487442,-.7310267929993984,-1.3400229080926385,4.940928402482713,3.656409847731918,.9900149861785816,-9.028525528248847,4.00711407583499,.7036962298039514,-.08187129189643959,-.5908919341902986,-.6470533298373495,-2.5958958215578076,15.464219157619477,6.241882683012383,4.396792900505707,1.3121227316742115,-1.378153322316282,.570651340554886,-2.4577915595225184,-1.771191248437708,-.6193258972543736,-.37653189114579305,-.3603222647235599,3.430085221977857,-15.928605891618602,1.8822688633520612,-6.385226826421772,-1.1605216810577297,1.2904382110990638,-4.193245397624038,-1.7788060115643003,.6722926551691847,-.25346558938670255,.21216331509639264,-1.098915792180136,-2.836040883832493,-4.873306104192138,.8185696868952801,-1.9247404486411082,-.765020152102292,.11613498315613806,1.508148024109741,4.6107439045795,-.08223519587239878,.08366696571669822,-.1521474714647681,-1.2127681220408553,-3.495979175048136,-2.7663785024420076,-12.020377035514294,-1.1301161363949197,-2.5595217205352414,-2.0309128606747096,-2.4761583426283917,2.719726719353287,.5658541711307982,.22677788839564242,1.4946944877830606,1.5204116580549611,7.184789152937164,7.226280148492754,-.1988975746849301,5.658788215581062,-.22966496128125136,-1.4849670230895773,-3.4706889785459896,-.4470299999181936,-.38088761756350126,.08483728919365377,-.06105771857524878,-.8497288505491685,-1.0350823160665494,-3.048883202393482,.5749093740804297,5.20112196768438,-1.1403748261257314,-1.531063171336222,-.008362896056257398,-4.11414099677818,-1.1919042271755094,-.6131801095031014,.3888857203213312,.38189640487488685,.8513463914051235,4.949425229009118,-.7749731146065126,3.7421263719531117,-.7240849418089567,1.012685485957888,-3.9271063153514176,.31448577714869896,.789298734334102,.3803077505014209,.1967165652323251,.411085973665119,-1.9407650606807731,7.078307604043719,3.220946201279227,.5697508622614549,3.201867261358023,-.41629215035058875,-1.6630776354173198,.6797090011992738,1.1931265539918756,.7193613884800483,.2501764217635393,.10706309223176007,-1.5535268590456075,4.651517018055498,.8385903024814467,1.6427867773149047,1.6005202499728195,.7827174551766654,-1.8087662154937887,1.3918172249916394,-1.0099673279348242,-.8864456886558401,-.003142384725297751,.4911701131535231,2.2860304828706575,-3.4229110732815204,5.145521074845749,-5.124546832813241,.0628853418271826,-.611122965525797,3.6373368975724945,3.4820862173606337,-.4014985920649203,-.25853649965038267,.2476552071610782,1.8038415156730312,7.270160836167632,8.999278169002412,-.9652420728518951,.4078620266490704,2.225788306744751,-2.8264857665973677,.20759705869087247,-4.485466580277761,-.1785172949865718,-.9129234141814606,-1.2958430622495678,-.9869474545081005,-4.616923664747264,-7.2191100925452645,-6.264817092712865,-7.720916891397754,-5.194224701523457,-1.7265963569680816,7.977151430395062,-5.460519654163148,-2.115212678846838,-.4437425887422176,.3096953171680706,1.8474170220444321,1.5809472917240583,5.000190141093199,-.8692507087847292,-7.8957892089225234,-2.797829350040215,-1.4999853211646688,-2.0314218230199708,-4.979627780318095,-.3385852438137725,-.3452236522627241,.08403533528795751,-.8076905687456272,-3.7447887588374664,-12.823730179476598,5.160896150810782,-7.013572967553852,-4.8395255243961985,-1.2189484134559339,-5.337584112731347,-5.532305078176254,1.2285092406330838,.05547835872320811,-.6080372385362635,.02174257719945577,-2.31723420930486,-14.776772427198722,-1.4765918204421038,-3.691141291165643,-1.6553306796102827,2.681542378235005,.37183973380273505,-1.692173337079889,-.34740110742227764,.2730994562434589,-.6861086902730671,-.057719496968379684,1.287925044962922,10.385978167218079,8.460492799402923,2.4344442421553327,-1.229944771403375,-.27307280070918616,.0349827932585709,-.4856310780478498,-.5323780695809864,-.3616865209369459,-.4498106698846782,-1.6714391905786847,-5.949961253866482,-14.94794470943793,3.499532791345911,-1.1170194271385376,-1.6343711521681772,-.707370767907644,-4.958735952722191,-1.758804345401761,-.6777668421294984,.055217862190873976,-1.3752867272458407,-1.9311074652360678,-4.121655189258597,-3.8572089962254026,-2.580348207172153,.8578525743333243,-2.40800046646078,1.3575940545899405,-2.770369153911376,-.7177581491271229,2.0009978869506573,.6402801163768651,-.6750861143151827,.37303756775804175,-3.7959733340604607,-10.64891367673563,-2.6075020048663036,-.45357453578596646,1.3718601012037877,-2.490558898086019,.27767241582608443,-5.865842656495564,.7652395548064977,.5038353188960948,1.6901675890156571,1.0807464184166393,2.859941212315739,6.143749144050972,-9.033637348080177,3.5332245149994805,-2.246835558127246,-3.1244595761631517,-.6996971260791207,-1.1927962237033949,.9129744119309318,-.051199718375332604,.2134904558984547,.18375672893903075,-1.9679185641904315,1.5906188344737986,-2.7614712628115394,.28867423360680644,.4292573733503537,2.7344567364520973,.3365410769169076,1.7218379018630943,1.3272948742809634,.9392071921066708,1.1801204095353766,1.6483359158128863,3.599910364323936,10.53591395125277,-2.7336185139737648,.5203781985980881,4.642843663796722,.9815016268278584,-.19322013010195854,1.1544038456002,-1.1413378283012852,-.32741200027415013,-1.1645529661108802,-.7175294009804756,-2.8423844584617357,-6.857471286014517,-9.766587601324854,-4.4812221492104864,-3.3770800985286686,-.7523841811243789,-.07362556688603816,.2379605600295233,1.8556126003635944,.4634302396033023,-.3508940175125778,-.8099172871215076,1.4389986663009766,-.8594124922098842,.08906073822735246,2.2017806665675104,-.2346829746494193,-.21557567296364297,.0544019093706865,.7658998850865162,.2768974924754326,-.02239298368231069,-1.7310500184510043,-2.5040666146648523,-7.662262201977864,-14.738034278866019,-.1062087876507671,-1.0312721575145418,-.520139732625386,.20600820504583123,-.7881856382517424,4.954251773478496,2.0685815636767755,.532235668786392,.8699722712051945,1.887789426302003,3.3208789263283927,5.1294421545773945,-2.649629415182802,.413091620020388,.690446724930847,-3.74908213994672,1.3693965159159889,.9665403377629068,-.2665767849826243,-.18677061516779195,.15288755113807467,-.07487152953884099,4.089200243140784,-6.724052084906609,-2.1675318619706245,-4.138048687654047,5.400858107633228,-.156871467023786,-5.11501043470762,2.3617510375011137,-1.425086819949389,-.11302183782593332,-1.8559656422920374,-.5673622629098343,-1.0160021452802466,-2.973655258772693,-3.927840011555898,.2798432822402513,2.145590069988541,2.9926974993350104,-.41457471011897207,5.8991539793518015,-1.3310130203768031,-.7582957124908344,-1.7207684664606497,-.8219012848218563,-10.19482126572559,-18.10379797403778,-3.1809001317438277,-5.848882246082821,3.112453073867999,12.141758772074478,5.108476011088391,.4252640302921623,-.2293781305436578,-.2783208109346115,-.09796777658219336,-.47542670575891943,-4.301940339310547,-3.8812485645287786,8.732979140253088,1.3594303805423174,.1828565478452689,-3.518346658653958,2.576632607618545,.8738085651794695,-.3269011302207345,.3766282941412608,1.8255011968738704,1.8917995058464434,3.302853688884648,15.825292056141851,-1.826612757638381,-1.5125057163083875,.24036580840159055,-1.8419711716148544,-4.573201611389879,-5.371885779478963,1.1649613041834934,.3040122761756634,.6144186987798771,1.1463037511199021,5.070036725656488,6.0439777912378565,-11.1709903890141,-2.3150267097719803,1.0430072758893192,.39031507119459236,-1.2791256079884892,4.582326173590343,.824578827883129,.4697938064401785,1.6418670555879058,1.7379509312625099,-1.7033299821381385,2.698848953019326,.5760046253027401,.8063677966167482,2.4871286240530552,-.4683307921309537,2.005178336834183,1.0348639616370006,-.3651704285772466,-.3290719990232163,-.04800375599011009,-.34693347553324455,2.067346929711128,1.6327781878799943,2.487067161978009,-1.53025993369246,-1.1573849463160137,-.4477127117985417,1.407440215469373,-1.0079452119440873,.7236571451534518,-.34315255739813916,.4115693673764137,.2259635552114806,2.9324847911689926,5.818774255136444,-10.392412976705243,5.1749900549937315,3.189901034222483,-.445408235000379,2.999707157716731,5.947838818755275,.7522481354413669,.2681869410536504,1.3776775260789276,.32651639361815116,2.432673961158615,15.317323876639081,.6550201368164781,1.963533121076318,3.827689598352458,1.5541066927678098,3.6524754526498238,1.6462475224171704,.32945597142002525,.32681118804630344,-.7007319924441775,.13536317948713886,-.5175212859224023,-.30184317769628566,-.29550101689188324,-4.741991739760765,.7856202096520346,3.2789838300392424,.017457804156050343,3.03412959230048,.7265624403206173,.24323058157167146,-2.421197556770775,-1.1459983263362092,-3.2754209963881222,-9.954933222487936,-9.003436588442352,-7.518223219152993,-2.906502953298443,1.7257971848896037,4.610843044102179,2.337653383609629,2.1512770589115875,-.21927233842432262,.23471241884807564,1.615847562369861,1.6754097610511909,-2.5878715429189376,-1.716734515111735,-.8834900609942001,.5894351198792618,-.8711881201899525,5.498127010366844,-1.519090543501311,-1.9422954228644194,-.592440167064558,-.7306301009159764,-.005370889739294624,-1.1238681564811768,-17.685921711267444,-.5842904066842585,2.2439343953573614,4.5105172258567405,2.374230715241791,.3659212961139532,2.5748116306393496,1.0901718912854208,.4478546835389827,-.35813370333456124,-.7333566943614459,-3.9768544187909822,3.494162820458415,.06054274804242251,4.961017874794271,-.004371392776036291,.4579991378979534,-3.2819730276415444,-5.562138475320881,-.4370727381233281,-.31344566051099154,-.6454387660261697,-.8731622926282376,.6360026301419303,-3.99177660451319,-.4447277489672477,2.4902953247582587,.633066521801498,2.6180263652568274,9.409174725163629,.5672984073715879,-.4372977892939059,.043115883353783455,.45433823123137385,1.4569441974939656,-2.1881105996773154,-8.02818948351017,12.43754111136338,-.9602952370260751,-1.6258493029052847,2.2020542492229085,1.4526271267717779,-1.2164258648517932,-.5694573989546728,-.42474168732916096,-.7428125436838283,-1.2630010496129367,3.499429027327629,1.4857258662710455,.6306245766863797,-.2016061749468505,.02417688981273624,1.9530001194708004,-1.0479654884106053,-3.264468097779048,-1.4998074220033304,-.4766064055617339,-.1141221954616365,.19100941087837586,2.068696454863794,-2.814767425635519,-4.935084212192655,3.58468688840829,4.253933525346069,-.4283744491712993,.40508604560494116,4.364891844580448,-1.0946901910144269,.2619610813419547,.8023241113238593,1.5732371121733773,.9627643940134761,-12.015010550792718,5.429508226402829,-.529385505178966,4.017420102705121,4.583072559081961,.08535838410479381,-3.18550315187222,-1.5951141137408162,-.2614843928879766,.2285004281735975,1.0353205915993067,-2.237320835704625,5.334598658662154,7.582721836122769,1.0114497680438062,.6703244820927613,-2.229926163555751,-3.981658599265937,1.6866568096885244,1.0533213764211309,-.1278407357320891,.7945112934766122,-.8458634854210024,.14967535278284527,-6.75549236260104,9.121860482540185,5.858800517974764,2.072030733848762,-.04930792429265554,-4.19594396604914,-7.909140223163728,-.7900425188057316,.5081203298967346,-.27204616795419057,.3972332401910547,.9876240298153147,1.7149294788742973,12.055779395511351,.7423523821607589,-3.5151470484379845,-1.4318871555344292,-.43789385782196905,3.134789572823895,1.030369527036122,.4570378690167607,.9003003171116735,-.7056588239788925,-4.919130146621422,-6.376147318835493,-.17073625576374654,3.9435018776435453,2.781688517369292,3.5461634183970294,-.44524660473375866,1.8066496323266727,1.3238992853872031,.552866275898793,.772861419223555,1.9448400357759772,.25320540142413195,1.5884729639794637,18.377006233128714,7.276050450438689,.908708522453703,-2.239869488360563,1.4175086494063716,2.5337497657267574,.773798252331386,.18108647534901093,.8614064161268611,1.097317697257088,-2.4819937318634366,2.67009948704594,-1.7263983409098724,-.7595839013678587,2.6401394239256883,1.1038961756714005,1.0780916425410825,.18610083985932985,.16576376813937455,-.3927546829533425,.029064845355447563,.9489857550783996,.465954979501278,4.963410408547646,5.014523262300207,.8501136207485045,5.067195039712879,3.112976949713159,.7435026200943943,2.0938955977566907,-1.090938528541277,-.7825578344494988,.4264966368119404,.22603144865177188,.7728350532586141,1.2804545566996883,-5.619284765698914,.14816415670112223,3.098167710188921,1.3762584221164877,1.9122183692146835,1.9165425967867282,1.9918574454501343,.3626240466850247,-.3815602507467525,-1.6806567461579698,-1.972250302016178,-6.55889766479368,-4.88663087852247,-.4157034019809831,1.4339563793966654,1.570020420855513,-.9900100907117674,-5.130092766269947,-.18408149035281754,-.020151573451939804,-1.5733604444709806,-.47454656806675627,1.2987426058616978,8.264197484982555,5.955924569810132,-3.523298348863288,-3.1968491198848925,.6532447095697491,-1.0473737770597682,-1.927209863804521,.14984037820159582,.17441900896795617,.34457063269090255,1.9817320815494759,2.991212720218955,-1.5156754490730033,.4450628901562778,.6033640358297261,1.8067641048177288,.8466264638239926,-2.5167459421137237,4.87591898759573,.6023596884608182,.6707854881012654,.9812348028238724,.35884482944453894,1.082691411207672,2.1692543063216863,7.139346993575607,2.3082357705805445,.17807557445058383,1.0197523212867026,1.4460828783915791,-3.18581411940602,-1.6081072948650696,-.35431319635128533,.4486486824846317,.2024893136712314,4.901564760574633,3.1530109650773603,2.3781082009216163,-5.28405116127183,-1.2491202958403178,.8526095838445946,-3.8018651919190227,1.058677420750974,.4915610622961259,.33881935147301273,.10261091855136564,.3408792256158662,-6.680372296904158,-1.9213042775505522,-3.429474883327243,-3.6047257974143028,1.412363173978741,-1.5233511781307325,3.6640401557340425,1.2304655512592222,-1.6105846413115992,-.3518586693188758,.4259463550294681,.266366276815427,-4.131440642288406,-15.775840322379167,.3725862414462265,2.5348311877628547,1.5585025542392834,1.365302325139056,.14747459745619157,-.27597326706301956,-.8648180180919222,-.5040051937117683,.05130913291876686,1.2022173865314782,.22360301289686624,.9078959792376475,-1.1552425678572307,3.6676634056044075,-.18792986938029296,-.6218464917944638,.3505392946285476,3.4429624708431796,-.5273253834671516,.2845587340736659,1.0690748056599277,-.054503952395060284,-.5448542801995089,7.982032959263634,4.449865594430717,-1.3147125425508441,2.2500524288738513,3.6187322982811754,1.0159081597319037,3.160441516133191,1.7735797798179354,.4273161331495223,-.3211265058254427,.10025074831851577,.09069826643748093,-1.695626729061284,9.992625640332562,9.41234290811807,4.399390231537295,2.9584526333135837,-.3944202552907497,1.9276011695935553,.16806895899709043,-.6414016656584437,-.7567209773934679,-2.788481415712038,-4.1592469782730115,-2.4891229741643124,-.5920017965740294,2.2358693684449165,2.58004168224494,.10515040097326135,-1.760016434883978,-.7651108585101956,.04594178216063295,.6976585507028423,-.4251159444317868,-1.0920889501548503,-3.1069660198744153,-5.014765196321434,-.6432099888716608,-1.1875013266410586,-2.6409481932222625,-1.529175033915507,2.6184103929395337,-5.48432053174158,.11446197798472174,-.5483287101113329,-1.3023768232463324,-1.6394147903703042,-5.506473018989573,-14.708600108249485,-4.365620205342774,-4.526861189762075,.17605004126649795,3.93157010918859,1.6835997515212704,-.61139349140394,.8280103905393927,.3546684931739444,-.2009169845125056,1.0184892899503135,1.3513337532302323,2.1473704681576287,2.2158701010147377,-.32369113481435363,2.672311121024643,1.3717519001871972,-2.67357254096617,-1.398670586731511,1.558759680676879,.24096506955870348,1.099664446756382,1.5561765616212095,6.970283197185374,3.1302473963672863,-.7145535890118201,-3.3998057069021943,1.8863965519243366,-.03572152180212163,.42767614454065345,3.56862161003789,-1.3044407450170556,.3660185398671781,1.7569847359705586,.7053464500103125,1.2670082974548904,8.359308868559486,-.7876323138466826,1.5063681516819152,1.4399299829721346,.22210000618677905,-.4057795015415909,-1.632384372814559,-1.7823151433736484,-.7372903495926734,.8834368819386483,.0943958188022007,2.944692935145048,7.842414464737396,-5.69918732205338,-1.529136364459713,.5365253527296321,1.9867809755689978,-.4033916471705238,.9266415921275136,-1.1230113502360002,-.08695084387350147,.5128141256164092,1.4930905150053342,4.331915151184601,5.96146046272457,14.810221708029985,.6322633362708493,.2133967378312891,2.494912699878879,1.2441042505253248,-2.0986023178413378,-2.1481168633664076,-.05203045652760143,.44181060731800903,-.26395007630880285,2.569172414439626,5.480694911234387,4.319297097668368,.09906814374301043,1.760024354532099,-.17164392186771835,.45656056999672384,-5.840474258090778,-1.3724163587675984,-.4310302973164393,-.681824621088539,-.6260124992619617,1.5915635419712806,-2.421599863425291,-1.3115127969311937,-4.300466240431475,-2.263817618785161,-2.3270074325757393,-.8844160651001366],oie=[3.592574868528974,1.7782715162542346,1.028057648204043,1.015641159808127,.17126432302338307,1.0496507247904627,6.733498300523817,10.647033284642559,12.900307828765573,14.764929803585746,11.33493297168024,6.709917680354051,3.035960042581614,1.4825240099446648,.9003043296098643,1.0947621842316377,.7662450651981341,2.244840728526968,3.803363687501226,10.741351093432579,11.568391177275984,14.262299721482394,11.110618769570468,5.063228444614323,3.7087953487282483,1.952719984635347,1.331936217146474,1.1591629849153209,1.1208970635299516,2.127974824734817,6.089366756146667,8.19658774357056,8.8637461603626,9.637949427945522,7.512858526202574,4.077334992112749,1.5115875050523366,1.053189286150481,.674568773268085,.9587503717445821,.41680616825910866,1.3781845800827952,4.5668418862138305,7.62163587721641,12.00608375757697,13.684460886243636,9.97751058758313,4.612820814154541,3.455872561628854,1.7588941590128844,1.1796269197196014,1.0895752416973237,.4692367237298097,2.096033739166935,3.388682601477402,9.86459373531256,12.362807495376082,13.467901539615962,10.068123992527628,5.1747983525910675,2.960311761370201,1.3548893856890774,1.118166011711502,1.0614201682940678,.3048319643846533,1.2521192191484183,5.4552035916052395,10.2997609745892,12.031763239587791,14.322780248665099,10.680850704650137,5.396875644999651,2.745571512371369,1.5564918041742863,1.062073524479536,1.2655427998410904,.8133548206569575,1.4907678480820978,6.364093493015633,10.77314240288866,12.190408450885151,13.499593586739126,10.917616981721839,5.8138256714928085,3.675277311470488,1.4339993351483038,1.0262304912518763,1.1208297052938252,.7657860455592196,1.6664124067771915,5.178255334265811,8.865528143681022,8.450681837356528,11.225636188698939,9.089869207891377,4.611651506300685,3.374559775382857,1.9325823035904304,1.0440564509134382,.8628896320710117,.49731277545331787,1.3162890308996282,5.5900631679196255,8.284534887759953,10.859183456982358,12.14411605643286,9.164644682124457,4.226502435951157,3.1907244954090443,1.7308618040985673,1.2802692606328003,.929951905463079,.596191024058677,1.9302211592062537,4.913077628432266,6.725699068530616,7.198215412814024,9.372121467639312,7.202353508406529,3.367626751637484,2.4239909196683476,1.090471216364356,.8083730613741541,.9020488076448925,.24610189485383754,1.3688759055948747,5.1766981344515655,7.891080349032247,10.349741716099315,11.028697012861366,8.863663845590636,5.071737020922155,3.289376374504574,1.7625295776235812,1.0536913956727103,.7553431239731869,.5912403004205877,1.346639216765495,6.0709693700319365,6.714326002949105,8.774206269932966,9.663682039915173,7.474316826127741,4.021720956501392,2.6827115565532083,1.8107483736970547,.9172895630830922,.9753536979206112,.41945597976621196,1.9949861813155536,5.941866078842538,7.640114361185705,7.514975675488044,8.651594482933769,7.057246261051778,4.0544389895991175,2.237815498367219,1.132237141262634,.9298995066338357,.7648838271143759,.37405005439929906,.6563498369113245,2.5517947502518905,9.973635756004265,12.379853513890149,13.007891939460011,10.16474376931536,5.502400983202632,3.014813477173052,1.6920667876165167,1.1667460459186938,1.108124293113769,.21445615719918137,1.1547717414902077,5.669263428955664,9.88161284245164,11.29843443814054,13.82221967920738,10.966991844598816,5.740882892905357,3.3685936596401986,2.0712851424420946,1.0997970549827571,.9922727830249266,.32007844477020675,.5993282527241576,5.1988035912055395,10.970586455734809,11.633650498086123,13.83514274659052,10.877536705418354,5.733516205892928,3.4695253321545234,1.7002393121765909,1.1266299401651694,1.0011999145455106,.1835818508790818,.4751826222565688,5.2459611744318755,11.71891968788658,13.318898932373068,14.786613051930239,11.74517257994963,5.986726831582308,3.0487354363137054,1.9834851765112245,1.238374409153973,1.189380818670725,.8449551265646652,1.911333935427095,7.563918669286296,9.387656008160358,11.45688031944956,12.826967135559904,10.281530295257175,4.722080564111447,3.3814871134691207,1.9910162877778947,1.289384552910129,.7063765504846481,.1859792064169178,1.0394607763048096,5.9123583528254935,10.723741166447953,13.22487097728799,13.534123753337994,10.733071845190326,5.1414585424191115,3.1837206266025824,1.8558326929598608,.9676756272489851,.9178595560230095,.09668652042237776,.7478821899511726,3.531884732787419,10.5620524321617,12.734882098548226,15.100106193871023,11.125071215865354,6.194608738239029,3.365725953668928,1.8415993802083854,1.0049062992003972,1.0894366564161984,.5738531686596549,1.6951426595068522,3.6700545902707566,9.335169816730037,13.217937931334644,14.87342524812841,11.691908310992433,6.200204423767594,4.030136782510434,1.7224552616198425,1.1580561243893,1.049786749598381,.7570385794884043,1.0567394715636624,5.755003372948347,11.269258255147777,11.801103434236389,13.974734241468505,10.923768681936235,6.0669982830445175,3.678823890913455,1.9267032398103328,1.2162442756509135,1.1115659293977922,.42748715443538116,1.8559443888003062,4.925750982823906,9.364083472700726,10.353441603483063,12.833952169416998,10.667346621402729,5.847851380597669,3.185884044412922,1.3721409867584355,1.0106448784419961,1.2624726697651314,.5101600922739559,1.189012887210481,7.2501211009583475,9.608451978290747,11.987868549893756,14.155490955983716,10.665551092743815,5.969264264874983,2.3490858081282235,1.525757252577729,.9741795904115491,1.2482818533361033,.6043498074570738,1.469267157964551,7.404897453139042,9.665122762479202,11.84350523486676,13.517538444727464,11.03670170510003,5.700124511764036,3.4032745567681695,1.4761731663409245,1.0353469337688381,1.2737694138786209,.864951971642365,1.779492360343897,7.217801625622915,10.168204103931952,10.421653997259423,12.509545937611783,9.751862031017806,5.7129312838408985,2.191466003370001,1.682100570837513,1.173670516443142,1.2996392678527633,.981640079249723,1.858979800960179,3.579661594304435,7.5233879704762385,11.409494166245846,13.202576307181708,10.37625789087761,5.513083075017947,3.368046673027279,1.9135294764197766,1.1296788197847984,1.159463534210141,.8098801307102955,1.121570162799733,7.329392863915222,8.915738045258209,11.518360468136652,12.681969265441817,9.384673798363849,5.25769136436909,3.667175411325159,1.834646772986116,1.172934675522874,.923531412262815,.6623973797083745,1.2788079264103682,6.507081771324024,10.328020450101995,11.278656758280393,13.59835219732764,10.773345606223351,5.106439897583873,2.3303214826231975,1.4968217150800653,.9417474979148932,1.0299839958980133,.5046971603668239,1.579891249433817,5.970487458573141,9.99873044718383,12.322162557076554,13.753383953273493,10.757662090318421,5.890953109317246,2.8998953864321027,1.5759926415453955,.9713793261970208,.812749178826014,.5288471360789613,.7140176502436064,5.536113984288668,11.640104999690594,11.487814682698133,14.532995850903452,11.71749968781859,6.281154251706392,4.239763513953873,1.6890324797777383,.8801530208723334,1.223735789481582,.9932434452276041,1.8695882856756005,4.883750952053358,8.873973441989135,10.84358433910183,14.531347365517473,10.342602660900665,5.945847404804408,3.6913129269998137,1.6374867490518503,1.3038715930888147,1.1004785752665769,.7735161371376837,1.1477659927852237,6.018818051433083,10.70868981578877,11.182890995401731,13.809875725795298,9.76475949974742,5.498510927097412,3.838016591415912,1.5724989015758768,1.0378346372819625,.918664458303389,.5400162345404392,1.9453738577767499,4.484416557127496,9.533073928473138,11.54360837851199,12.82713278331237,10.990548496965301,5.726793710895044,3.763297366719524,1.6772165562492296,.8486009499105032,.842466059071744,.53741794993265,2.085262468504404,5.523150680957408,9.878211921774517,13.051872325365323,14.226808290117887,11.083647313466761,5.758543117402694,3.037499146419897,2.095087023436708,1.4427199336665513,1.0505793695720953,.7297489192768689,2.0911912493980425,6.291495227932463,7.808991505845014,12.890864301611769,14.092984906760712,10.782926368667866,4.954794077100499,2.2819640556215828,1.8683498876574345,1.094048355329374,.9717137536127253,.18892508666745533,.42639554914456124,3.530487001330499,10.781359035181225,12.205560805650904,14.415641626996257,12.362989681829479,6.478363508145815,4.532371592787978,2.0771972300639003,1.4466354163992758,1.0748461338615556,.5269560335930743,2.2379987112115365,6.987914623462631,10.252123041667828,12.120704293761937,14.013158667477155,10.353811037109558,3.2948192819652595,3.9337280758966005,2.044019950127549,1.3439575313859136,1.0094628191540393,.4585404367700089,1.7045834039022203,5.488932782782864,9.136139018526526,11.899324324078574,12.951864284451588,9.907278337243444,5.338460235589533,3.4462053961805936,1.3877011309430947,1.1082125439923443,.9306889468085386,.6650900542024536,1.4876575845242157,5.630328679456813,7.973095493416648,10.399635985067821,11.902680861161455,8.737956000642331,4.400961419026769,3.2684808380998915,1.5205324263957039,1.0525319575940648,1.1361978329184523,.16289997638240114,1.0046979010924113,6.774075427781637,9.679848447711091,11.466976190865394,12.951867202960718,9.928566214139495,5.1771058493928575,2.0723739718100878,1.8453264494725257,1.1523675949004482,1.114721955201715,.4326816789832507,1.110723913928202,3.0649874161391493,9.78925241538671,12.173153296550467,13.78197241698931,11.105015999742424,5.784111259540293,2.691635824021682,1.449405376513078,1.2090280963382365,1.1763592467252388,1.1593942306321248,2.259500456051581,7.243803319217185,9.244577607508987,9.97477884768036,12.680500701432578,9.95095351007465,5.044183986460655,2.582176449132704,1.4386404351967472,.9562834413878941,1.0866203539121626,.7922298495600335,1.7421925757509034,4.326067743684369,11.499041390335439,12.083330948864733,14.2087700647354,10.460718023277009,5.871315130435873,4.269689337471246,1.2674934620647116,.9878642746321289,1.2213762740020995,.6786611979800615,1.8036133433027417,6.809972801026586,10.685306985945658,11.645504385556832,12.761435430516137,10.742202701894444,5.483583394662436,3.8906888190782722,1.4519016144818162,.9788236362344402,.8759940567832173,.6620269916942446,1.192992656201751,2.0865196769820638,11.661764397206168,11.453199641552157,15.394686492317632,12.655616779041951,6.7088501331066634,4.222945912182824,1.7279066943128516,1.2376418195798948,1.1390085376312638,.8451347375969936,1.7951367034594512,7.49518517852617,10.15528803438303,12.181858552631533,13.485353965172045,9.195117631930666,5.610837837303412,3.0893132609121023,1.4439958044981689,.9527981640751102,.6705881302870159,.043929981584568775,1.34297256860034,5.402507319288882,11.944745410870802,11.88255660274153,14.648843467858418,12.256876993181637,6.167734736134466,3.1841253795311535,1.8412044090717135,1.1447293176443356,.8783891155361704,.7776456285432676,1.4080461722943838,6.640507399928699,10.847718296129655,11.654999877867839,14.000171707386176,10.890848630131511,5.783649922410025,3.3005423715742364,1.296814242086902,.9346357256371898,1.2725032261154496,.8298736378006156,1.5844111004506445,6.236157998250972,8.34644134477168,11.509298069147864,13.708834661194253,10.873069059748179,5.552127172282099,3.5942162063945693,1.7283720490643075,1.0382568854149805,1.2249320651173548,1.023163019987869,2.8236310977999657,6.770958968169323,10.556766336273306,11.992710567759786,12.776543612362156,10.138495715229556,4.745717201658643,2.3497551189320007,1.1768373404020416,.9714368440260058,.8756953090610569,.06935968748637954,.7306705590410745,6.59971842004963,11.68036098289296,13.051103461869626,14.105137208905516,10.993513957428142,5.580198328109991,2.565658173038471,1.460833789929884,.9849896020138459,1.0568655722437794,.779498487447236,1.1340064815674835,5.705619422601704,11.268285344281532,12.85582607157389,12.78240450237903,11.31055195549251,6.417763868718123,3.34864292720181,1.83239497095375,1.0955501240724264,1.3442964857694681,.5592034855217916,.9359495027168891,5.464442010733693,11.270881727581957,13.016769389054259,13.612268065656684,10.279554525307587,6.16039402687411,2.485443820553511,1.9409158378018587,1.3657309275151888,1.4259768644007718,1.0922574105311305,4.005379801315109,6.417491592463148,10.134405090409619,10.52623691371089,11.63577639113104,7.104228480134234,3.8997970564087083,3.3625019686210216,1.7141482904345755,1.2450088103086139,1.0985435192652149,.8530215458263749,2.559163236060425,5.240381709649053,4.9652566638000195,7.3622385245679425,8.0416024868898,6.084386391657153,2.839521681671539,2.272549495944147,1.1382812020656417,.6151604374662563,.6357606589970799,.09920872092603653,.4407080064127592,3.31049958458554,11.656018647550313,12.751788334177578,14.284443455729312,11.367769832408339,5.030611661593652,4.449684505235384,1.609047880648062,1.2842675088139432,.9880524535045706,.2942094179638059,.926090927297025,5.947077734998159,10.856113205268196,13.186902362419426,13.841175400441818,10.60816574972271,6.177427552292649,2.8199700295807313,1.6233105385686066,1.1371752937816264,.9265902212445781,.3012838182004052,1.4110092517561685,6.358235249229416,10.365193926621403,11.861964962926985,13.751919059777581,11.057300367791616,5.99793603121401,4.12145992120266,2.045186603239742,1.2802516403013289,.9759942537295929,.8855286094774483,.9717070953095926,6.4730403856324665,10.22483934329707,12.671977204214635,13.836707587167636,10.56716063207671,5.389937022280311,2.3116757847526204,1.3692952670325382,1.0192611200514814,1.0185657381164293,.5422393499540261,.6330564675864794,3.952521594835668,12.532024782680576,12.086495902027517,14.592213250482091,11.783127913448576,4.504550506578345,2.5487547276497398,1.4103804088122278,1.035348037011627,.8479255901246039,.07683973882126663,.3574760091943314,3.658590101499321,11.36236607162803,13.008478299048427,14.158857337600091,11.424531692002915,5.642914829383634,3.9252121990901268,1.359310503191067,.8934343712771432,1.5053667001379907,.8993300301442178,2.002555212467925,6.623485349912585,11.335583778892182,12.000786265462764,13.976807879740313,10.654974498646984,5.831632606037996,2.4827620304917684,1.3060246865178762,1.027880029375235,1.2134609678480401,.913860991732233,1.4101734743747782,7.40947373085775,10.211510117357424,11.854345799485044,13.297057463163627,9.819010641182164,4.368254551798245,3.2039013262276526,1.3619486224778454,1.0058347082790122,1.1268297653108303,.2301761270164639,.7339852248859483,6.076453116375466,10.850087223105898,12.476729859269962,13.378759242544135,11.077656557960461,4.326985399272367,3.922489338345727,2.050723142062091,1.2983022756049776,1.1409489944451816,.6091742651940817,1.075006000814807,7.412339234587382,9.99910585216132,11.296496890920269,11.621364623442238,9.72793904455679,5.2768779895447,3.1468544284610567,1.6808529785614696,.9793880588001449,1.0074361071088254,.8142335194754631,2.5626234132393635,4.556036145313861,7.786736807147777,9.088267274962313,11.381155753159815,8.47386212596555,4.781516593750929,3.3534010054307024,1.5132023040573965,1.041919315339785,1.18869414643354,.7149247257937542,1.2322879417232626,5.582465018557183,8.302994024511548,8.942961237503425,10.827799393489643,7.979109017118832,2.562448211839992,2.1167596032544096,1.7538393652658508,1.2110373566870198,1.0478259686831939,.574620646439143,1.4280569825678116,5.373336383495091,5.530247982588238,8.91447332986782,10.009603719535312,7.573792479447246,4.0936945815726,3.1335607960848257,1.6561500387201098,1.1498649310692086,1.1186802319947053,.6819241134345642,.5235296106445777,4.106232345346104,6.163288427736581,7.063242223788433,8.524317061677381,6.288428342504222,3.5832160562434425,2.0896456716452145,1.621066504808092,.9780801371863381,.901337642628426,.2841855553950747,.7247947672015167,5.752634492166543,8.90050947145432,8.61038314352238,9.616536085947747,8.377992009288809,4.421056034788167,2.0338614594337012,1.3349052920135998,.6222158215239643,.6019405475305789,.07730025615165406,.7830649649488528,5.777550867974764,9.071234747252523,10.720200296726432,13.073651273307926,10.320107459024427,5.917858256674141,3.411865359422788,1.8043678866401254,1.137203570002529,1.1969663545668086,.5545342905696851,2.0746757601413357,5.633513655077592,7.487704755849723,10.523899525925614,11.818137199495256,9.4319464571091,4.9221387750505,3.0402983964213632,1.3975771921328635,1.0440929158055738,.4877544688641648,.403767784734113,.4395451086322427,5.705230683655219,9.174271182972513,11.430756947478468,14.214532204402966,11.868043384632385,6.72660838008173,4.621934821362701,2.196835642322318,1.103332049612432,1.1089836335985144,.34023068696244757,1.4960271323412488,5.984976360708317,8.61114915251904,13.039886391972484,14.903737037376956,11.68480644198988,5.967003328870723,2.7491529080350894,1.5834805768965057,.9560458430309254,.8047922894703602,.48464789157099614,2.0882374558214694,6.541073649868686,11.261605448023904,11.45065191857518,13.41645366670633,10.216827992425506,5.657609808571862,3.4292975314684875,1.430769601673309,1.0425292511351574,.8124527517905523,.019525099121108315,.8149115457654198,4.741113410573391,5.939136991429164,11.28375819152349,14.972182070480695,12.481526199679005,6.372221802607651,3.8392416706415307,1.747247893268132,1.3143801994529387,1.2148697640643982,.658996160033714,1.4481706072106042,5.973472289294829,10.558864529710977,12.081482820474921,13.376891444025274,10.28692896470536,5.960555717412075,4.040293215767313,1.808021772520012,1.4435879888306795,.9777160032340119,.40006406231184366,1.4022745150442646,5.6558406649280135,9.595199523166638,12.327095726491565,13.177614556163185,10.677910803328395,5.341651053334288,1.8252173056229373,1.8394202752492559,1.341584852273993,1.0118661489292984,.5029367208083977,1.6062582484772043,5.676209544049863,11.412315999821555,11.819430182952765,12.5690170623346,10.243889146430087,5.321189727796107,3.5272207726148235,1.4567771834309684,.9003144883129226,1.1176050028429618,.8746540690084935,1.765671032976663,7.065564359733647,9.297336827728346,11.717332161261295,13.052249584063059,10.104873482608339,5.655565470235365,3.844014571204307,1.5534281625891966,.9089677496983316,1.152362144853115,.6373445287905796,1.6004349740922215,3.9466018374137524,9.009295988232944,12.361490849170465,13.980269109612626,9.742198766147105,5.78014953508526,4.189899918474424,1.679939563469058,.9703994393461501,1.1382585316556328,.3504091905338082,1.9432124129066768,7.432137493902003,10.453447020850053,11.823970842523588,12.998103582637334,9.96623571775625,5.44912912367584,1.7092413550173522,1.5756226084432967,.9472451848488572,.8964129556566138,.12578804758117348,.9307295300853975,5.77706243565471,8.870301019240642,11.603567176957666,14.994789369228009,11.843994642110545,5.862651648358786,3.895161800547407,1.9443451756288608,1.0669410012286893,1.0212855029088854,.69938627166429,.9182268544384918,3.3016596489429424,10.504429507895772,13.428016547130541,14.953495782828195,11.293195939311392,6.33501623373261,4.040644698769912,1.7388100258793902,1.2073864111208168,1.3936206343198532,.9153687303291427,2.8328931639230226,6.867147106968077,10.367759124515093,11.529194603422303,12.595831467369743,10.094554520408524,4.867070792201438,2.90252960619984,1.922829513082361,1.1482655960395476,.8054806767181443,.4531545538199864,1.9354307897804368,6.373983007793644,9.218821490276063,10.5465885458148,11.601994846523912,9.278436385853094,4.955437310704395,3.186899146823513,1.6634711515320695,1.0821197685727089,1.1039716897163705,.43268841411844217,1.5629045952787965,6.057082533734519,8.775765629514094,9.757011855634216,11.865249300638508,9.19371075093624,4.874720733868455,1.917291937465262,1.8164099654172883,1.0428117252594042,.8217165285241644,.23915701984679438,1.4336377157495515,3.754207361292713,9.163861528742068,12.300929033195672,13.774492920525041,10.638045500003331,5.886050873025813,2.6700422603409693,1.5871163313780197,.9251604894383523,1.1531310248036475,.3056233944798666,.5896271095895663,6.835698788001762,9.10161362131669,9.78439490807821,14.007474575738456,11.543566240650845,6.571769915965845,3.018578448963432,1.8037223998791778,1.467485239116697,1.2706699348106216,1.3182718922780776,1.8272748308099873,5.169740599834269,10.668606140990955,11.376310317181186,12.633671427587771,10.613235930684523,5.7790533596166656,3.4158385983134685,1.617436182272496,.9409520005592296,1.2426905011459513,.9494152571679447,2.25278517006261,6.300108728432767,9.124631574745285,9.842072983951596,11.721560533752383,8.78438259152621,4.2948316476432415,3.4434990863644352,1.7336341478802755,1.2689934313873086,1.2859922433392714,.7541676712342587,1.6227896226066127,4.405500309607017,7.334993329530139,8.028742594712675,8.544111558957058,6.511920834263762,3.2928552276124323,2.2968172581127666,1.0232306323889622,.7977194450557287,1.0358347552971483,.3905815476201029,1.5184707558065842,4.233432747495994,6.204944700251914,7.344553408889948,7.650058039957238,5.998625054015989,3.240616542991368,2.257630192157824,.7310456568771692,.6262134736248938,.5074187669764597,.18886452191245365,.41671325967321715,4.298013106994024,8.892727032001627,11.216835316352373,12.379343338548393,9.510910856127362,5.131027262063237,1.877346577583812,1.7016084841136958,.9754752270421725,.6799351500151444,.05499735028166584,.8396226868527057,3.955907117443571,11.40109519603637,11.328918923414243,14.803445508023701,11.466906086915596,5.96546548371894,4.057378949353448,1.732654161694799,1.2898431290777321,1.057911966904243,.7903378267250414,.7461139809359696,4.083429781326203,10.31798403906948,12.093867342951366,13.808945768833036,10.163508306019333,5.753112522274058,3.7875392918341793,1.5679349459291336,1.0383019534047442,1.0954380568475302,.07601860853283932,.6452005464422381,6.255922965292566,7.302161894973919,13.081430694767405,14.146148717921484,11.252337294336174,5.808304525612026,4.199251551772032,2.0037062674544717,.9279214182399211,1.2836956219257118,.8770095762307749,1.04451527594023,4.685394662638707,9.220070424560223,10.960475368845541,12.191694193654103,9.693012274527758,5.23349817940084,3.8181015085918215,1.8224781926389244,1.075498546024732,.976092852796735,.5997171749149762,1.16278880596442,5.241649903512771,8.2196891970264,8.985152917625415,9.934601353034566,7.7184488240343345,4.304317990553059],aie=[3.7928802605708967,1.8275736993952125,1.0688703004047464,.7767457613269099,.1451893980227211,.5314717246870149,3.3951217764273287,12.047425481569727,13.18157114472685,14.786179810532722,11.797473299159051,5.217829585478263,4.580600858612282,1.6093778243417785,1.3006887741760693,.9881678633167156,.295005092783504,.9692627764665096,5.951668601637429,10.92143674606867,13.165503513620745,13.820032866554975,10.611344048219841,6.177288564132186,3.097445342051335,1.9481607255949358,1.1688778924029999,.8087835605168164,.465937616265529,2.089430082936833,6.903903066634446,9.892643198098737,11.383730608216334,12.54882718606437,10.060709817577646,5.512409899511526,2.9632609109866617,1.7291298408867999,1.1982936490298004,1.1410874250086176,.22511314087723416,1.091630783712972,5.707232785728289,10.005348234916857,11.407918915104883,13.963595007802223,11.207717593834586,5.834935358335452,3.9039563601676535,1.8522344983853105,1.1941235763017093,.9209850289285687,.6762991008094447,1.3688928604629438,6.539547290653605,10.41747569138147,11.842793826588183,13.888614336428718,10.981164030708477,5.289217975912259,3.4699016335993984,1.4475926493243134,.9007946679071637,1.1059779581284852,.8736374213416492,1.7898602742817435,7.176110202083876,9.420173655524989,11.816079070708383,12.909197111526195,10.067995793770837,5.697897943023409,3.862059116746667,1.5583079875291712,.9147995516249299,1.164352433600702,.6573608231330359,1.5991537665030537,3.948839225840875,9.01163299843201,12.393614656242937,14.065153679523695,9.806138228335877,5.797300748486421,3.832892403515893,1.979977025376105,1.2315283221461426,.9463871374142648,.7955068056781197,.9205051227338479,6.422603064806302,10.113069188149241,12.403683259335473,13.55445089527537,10.362070637185646,5.29789020886683,3.298446289856358,1.7039172760706998,1.1361802251338675,1.0039268502270768,.1790973638215366,.4705008631124402,5.2606519973178525,11.719581289339748,13.306630963873717,14.77132556739647,11.732495686564617,5.979917299068574,3.722225378355673,1.988552468843439,1.180861793096049,1.194353270103495,.91867064424089,1.2030447493672172,7.864780470289754,9.4106347110711,12.377867877238701,13.68997366033207,10.11403167999184,5.685657939758663,3.885681466505976,1.8601483067484257,1.2007220463454809,.9321422544408774,.6996500130149528,1.3504187362411342,6.523792442935145,10.317367698812555,11.713743015913636,13.72867798106637,10.781683287120845,5.182558605555691,3.7885218369985223,1.8347715975108059,1.176735063667693,.9065552211660068,.6433335712357948,1.3668271080232097,6.557288886873274,10.387277696614332,11.394582783005568,13.676668650140202,10.837205970271196,5.14043802158492,3.46875619962428,1.4469922903198689,.9000312605358647,1.104772020616373,.8705986871256808,1.787026090025427,7.175384702925885,9.418473447238156,11.801943878022396,12.8585625283396,10.03079864472042,5.69670249640357,3.654513606046977,1.407197743543362,1.1597900433847936,.9638587097270246,.7589977428814054,1.5422248318848972,6.0603946776066255,8.40072556811685,11.200348845552355,12.7517220039655,9.447371121513218,4.834975710252973,3.313696017957579,1.7280330857756945,1.1574086801110979,1.0662851286230062,.451836644958673,1.9294219785958895,3.0455641387774266,9.174446779856561,11.376108359158842,12.332728419496876,9.223580661564002,4.6284295337500625,2.905970673836063,1.358982386258197,.9973252170089432,1.2223408958264312,.4675314895628454,1.1274489006662203,7.102552959217283,9.456785051176524,11.859168080044292,14.017347731127927,10.748537419686393,5.922470024236249,2.860953015496058,1.4682625795299828,.8850886109078204,1.0636184226608998,.6905563674962945,2.1703253713482407,3.7220861559050937,10.628508048105438,11.164449571307571,14.07057314216042,11.146133790061286,5.034932665479798,3.6989225902339316,1.9509134583792993,1.3302201588767968,1.1577556088629255,1.1186327171738035,2.1161723739510667,6.091615925259086,8.19307620841245,8.784013742165637,9.608593458744698,7.475193935867165,4.063694622454013,2.7961290201446416,1.3665425514454947,1.0110409262767548,.7591722689218378,.4052512918155844,1.3131920062824418,5.006953046584663,7.597199701029078,9.93184812061149,10.97826414250313,8.319519763559931,3.7845257668154733,2.9417384939622413,1.68310461850423,1.2189455256337989,.9049600455231542,.5534500598661963,1.8229024856964198,4.729196052361793,6.238813456717797,6.20849004428366,7.73507638526551,6.045668878064383,2.7028939117917985,.9712158132442434,1.0136265943423242,.5656805291176122,.738568750213913,.3530286630433096,.9016225107473317,4.168641786356775,6.898232192320517,10.876912545613852,12.399668228121792,9.043673062339757,4.130012266887828,2.994179855180108,1.5378881373621442,.8593056742923465,1.0537791859871783,.34902210594781624,1.6470643050638136,5.888262859837332,8.892246903652444,11.24162004648111,11.95404255177258,9.298238136157313,5.580595048915945,3.3818470528886917,1.5160745665390192,.9921996064590437,1.0565837325621266,.06666325301809489,.6559423313779597,6.164417495166218,7.288994056802342,13.031898519551502,14.099792045561331,11.197504812210619,5.795975119417619,4.473279627288071,1.6110251968279679,1.3022431865449475,.9889812696482144,.29495975736093244,.9112935302305128,5.888772233308783,10.909687685119666,13.149555266561514,13.802325328642144,10.597741105345143,6.172823669144439,2.819827647320168,1.6238444690230653,1.1379861050762108,.9269703742474535,.301949237419942,1.4145256252851295,6.354166295225364,10.355087328905656,11.850416990318648,13.738712898608256,11.046471350119514,5.987262297749857,4.413579537512084,2.085355511252095,1.4436095073283162,1.0738979385455474,.5261509813957055,2.223968040362469,6.952651236636742,10.2311174825061,12.139230388509224,13.541859482320408,10.365385693080022,3.293801835323388,3.3655056528104024,1.9117238509620347,1.1423521972687098,1.1601140222590363,.841948219408677,1.104148784582395,7.532539785878859,9.200420509604282,12.07393580063895,13.203801316423608,9.774876275434085,5.5193417521934105,2.6662723550229006,1.458041667115726,.8731057326456833,1.0451134977279641,.6547119385181658,2.1609672684788643,3.635854014147193,10.343668856994281,11.054291854056121,13.6573305566035,10.802927610954505,4.871440358009638,3.621200311819826,2.082608251026181,1.109213179470856,.99738695556563,.31790753418917395,.5411774598466902,5.231622520117601,11.210110309745104,11.781451805138753,13.490472625464013,10.957401637260514,5.811432694531606,3.7979443484312023,1.5445250037499552,1.0177869844657128,1.0791432141519566,.07229819214460002,.6752074568903427,6.272769320894797,7.297000204738723,13.048255538510961,14.116590529843473,11.236125241991633,5.801135603875041,3.820834418809789,1.776654000949538,1.070313289688684,1.263717959253185,1.1315346342313608,2.8999828105087437,6.7079217058952105,10.501946694934654,11.895400705809628,13.22831010788239,10.232708422752845,4.6976489176190315,3.758729833089509,1.5333257613435527,.9081219492637589,1.1230643835932397,.631072800298891,1.6206041516086622,3.978796619824185,9.073858002459747,12.44389720711363,14.0787953132389,9.794168663643745,5.828509944142415,2.455228435425314,1.3028391782586477,1.0205116009733854,1.1948070219475024,.8723972696470157,1.4043344098052215,7.354820749079178,10.128368127943759,11.745541452461705,13.079666265611477,9.702729234504393,4.319270556948986,3.75516069260497,1.8245298426475904,1.1789672834334761,.908190125009291,.6693357515125956,1.3272930372135858,6.338186847095784,10.213531054174604,11.142538997153295,13.455563691781485,10.659213179556414,5.0593589162523935,3.7373216072520243,2.025047673076761,1.1271819146670534,.8919301623404002,.5441373034994121,1.4558086269738537,6.1134973942618664,8.950815410112105,11.922258667365323,13.178985251261388,10.050719075460677,4.651426506684548,3.2288465949798133,1.696802377661339,.9943026611606458,1.019197667599106,.8300242682206062,2.5943341474425656,4.678814809783299,8.189295514127327,9.502556058352265,11.790703780065845,8.827395357073078,4.898293429612691,2.9759458268580525,1.6533067642539545,.9621728952387768,.9977704201220908,.7462352326404806,2.2685670687618607,3.87137205686814,6.783999507066966,8.016043478514124,9.90457169224739,6.9861688554929895,3.7933075715446645,2.018259181764753,1.775148481841159,.9141618229851741,.6551567658592491,.08514759188134866,.7069020780103183,5.96744629556656,9.372466093922062,11.078805600726321,13.554856696694841,10.738291081245105,6.180413360677343,2.5847012602417285,1.444568161522437,1.2035436489392997,1.165942485708236,1.1419251364355583,2.2868186112345033,7.287521356905889,9.331009802534776,10.08720472985721,12.863628380282266,10.072131067264596,5.093945200717502,2.278573500511453,1.3507592651614009,.9978462908360316,1.000700795614324,.517969746411979,.6229408006890917,3.918985124009786,12.452110334565662,12.007293477072983,14.485675223206632,11.700298779572782,4.478532266634918,2.5678371772248205,1.9211464782436218,1.1341295833960525,.9882805874445435,.2178425981996439,.4285774187458989,3.552572075827776,10.815744302430245,12.243471324856555,14.462440690369462,12.426149700616929,6.495283015466909,2.005631442672489,1.8674583835266545,1.373647223997093,1.0189356446012257,.5270052404210112,1.6907094766598625,5.757071826995554,11.572976804771658,12.018477756104868,12.781018621248109,10.421162264715306,5.3950551100517234,2.327047664585482,1.370659668779027,1.020853742745616,1.0209306739288158,.5450002096276324,.6355518436513058,3.9543406874795752,12.53194266817323,12.08641643569174,14.592213251083441,11.783156200200866,4.504550506740348,2.5487547276556737,1.4103804087641894,1.0353480369884374,.8478348717133635,.07683970044513812,.357357705788772,3.6547747419634073,11.341226345406884,12.983479724709548,14.133570186602707,11.40573529641675,5.6312104724504115,4.4285416958246175,1.7450890955861091,1.293813626052012,1.0597156788043944,.7903093850206889,.7328915704720859,4.074761242305927,10.251007023430784,12.052343907444083,13.746649056380603,10.51114050899675,5.78812342936517,2.2479342152356967,1.7037274969313303,1.2136758502085414,1.322446766303995,1.0324965858497706,1.8782956553122516,3.617088283810757,7.594080398063118,11.526697463848455,13.565966425121523,10.575115539572845,5.655031129742786,3.4700744389787426,1.9176684891764937,1.1315316372631659,1.157871107953773,.8082678057095934,1.1485896227200552,7.610459961959178,9.183322197018317,11.865355106251043,13.079042834649686,9.66129079349953,5.4435935583982875,3.416168861438789,1.7820974925666622,1.3493273184237669,.9588622534577338,.6459110757212667,2.054262006654878,5.853082801546405,7.710509189120306,8.23745287080182,10.885000633768449,8.36673258400449,4.044129276573079,2.392500934974792,1.0090680201133064,.7021351835009101,.4768739783234108,.3629007439954715,.4409196299228196,5.697999912637496,9.192339351508785,11.450820957723662,14.23545937801102,11.896050335796138,6.739191566540048,3.8777557380580245,1.8417648213149616,1.1612893749163482,1.2086546019924322,.5823011243900894,2.3055513887406542,5.913244018919202,7.848841949232183,11.10663862400663,12.423964515698824,9.87407407317433,5.102091806828164,3.5072993263657675,1.6782935742026177,1.0196798237335702,.688055088690433,.11801151514017755,.502792478845689,3.3659765290765504,11.999847648404693,13.121389089187861,14.715988213314194,11.743200233109588,5.197608932686449,4.074215181720167,1.7159815575786281,1.2321229195739352,1.1213428388114823,.8256069291044191,1.7489124470779531,7.402793177538034,10.079524964888094,12.174837611506634,13.386788697898076,9.310095893720733,5.578764231209973,2.7201886647079343,1.4572574756959307,.8874224200868935,1.0469589379288466,.6842680467441932,2.1533793904272014,3.643495538933534,10.360091400049004,11.209385491847502,13.784246731332788,10.888103119000645,4.910810634124255,3.9483184535710625,1.4834878643187464,1.0291649893555441,.8066210994042506,.2701876050591951,.5235965141483364,4.738585557710147,9.747653097207943,12.381440828737762,13.656242306158191,10.424793007426628,5.7774383168569505,3.9301280113353556,1.4547646664418847,.9925659386784527,.878265598069452,.6834102977266129,1.1843011935495966,2.0865196769012675,11.67535123480601,11.45044558095811,15.391499354982423,12.684685888088584,6.723159081802815,4.223027681474103,1.7279861583423024,1.237723932596202,1.138928579347309,.8450480998229702,1.7295924554460251,7.344865047219761,9.985338150347106,11.95602558996822,13.23802875822939,9.217814716896688,5.519709515666142,3.876656963541386,1.5321062249919242,1.0970253675474677,1.2085072170128015,.8080354879781139,1.4117508033558994,6.638404155237603,9.424874094295221,10.229943295166423,11.845765189459224,9.12916100681449,3.0813046727941202,2.456006756639681,1.8252581852139578,1.3232338380097932,1.065858969556106,.658189007802709,2.039528364131901,5.541932000139726,5.670223692899616,9.114267245172595,10.216203515007225,7.714817177613206,4.151878425968633,3.156117679705006,1.6595760725218605,1.1469896656934555,1.1160281035726505,.6688430834388689,.5120330290800299,4.168098418660081,6.262859774499547,7.15194359057814,8.668915602331113,6.407449428063504,3.6465812709298717,2.571195472752869,1.5977277001675716,.9829923289375737,.8420065950434805,.4035547411429711,.7983086711819295,4.662830748119854,7.416681061981081,8.12167804497214,8.946581099802554,6.8709362349275125,3.797426354613895,1.296550802445755,.9751569563828083,.560818802014207,.6800827342511837,.3600039399589216,1.2008568408658258,4.4640813670084665,7.348781697459566,11.593556519358419,13.090561557288424,9.600276530297068,4.42388502747906,3.4982736567402624,1.5007970654879217,1.056461191580757,1.1201158507846871,.16114347609346322,1.1746486248382415,7.091526335387094,10.210630743987162,11.874535655144207,13.657973973387337,10.504193709859798,5.528915143460474,3.6831465203881515,1.4361980802274046,1.0282296947109881,1.1230289790793577,.7678173980125346,1.671958655191907,5.16460411448181,8.889674303832333,8.487137895288013,11.306648030269718,8.435537118606801,4.474572741859546,2.7968020617105234,1.2862487438367032,1.0002767515672633,.5105061892340943,.4108925730327056,.4373639121331088,5.693184763233955,9.158237437905747,11.407546212712834,14.150090197859479,11.823603273520854,6.716629439029189,4.422420084254611,2.0034180266819237,.9279348734327657,1.2720769218679555,.8693649204910725,1.0471632408985942,4.6884598998577385,9.234485734422043,11.053508369243865,12.479111635873409,9.797974570340026,5.279529507781989,3.1499363189408816,1.4170407364275697,.99619967687964,.8923085906430189,.5025140723429731,.7245518580668197,2.8897607388039477,11.038463731153337,13.585382704681304,14.28461620599204,11.520452666802196,6.1473814731053364,4.1886959852032435,2.0805781483613313,1.173829184690977,.9164960917100666,.6057255686733349,1.4963693889547536,6.146432934059893,9.025786860992865,11.895196572202607,13.292390847861029,10.180966720164582,4.699880795510238,2.336910728944405,1.4944214373332467,.9397986433995863,1.0293071988659142,.5056945982120258,1.5159214057022143,5.887743165749498,9.87099862417805,12.175573188843478,13.577291309261499,10.747117069119277,5.8194448427298795,2.8004852493297303,1.7236364135059004,1.4076531680726876,1.2050025309368841,1.1896684795926693,1.6989837339151834,4.542403358794235,9.941547204343136,10.255251812262841,11.78192789449206,9.841973560051425,5.36276139393475,3.332017723776323,1.6931906194500534,1.1093873451271807,1.1245302212747728,.4468332511681829,1.6119853189521973,6.5126805673807215,9.280738358904575,10.3057257010086,12.569534994226132,9.790814669454885,5.235218490329053,2.2740987264143024,1.4754877772638433,.9283060710367685,1.0147505576056197,.4975724969615726,1.542220540491247,5.926543502021519,9.927313909812025,12.227393891407173,13.653298130126236,10.801947965932445,5.847087748154014,3.906663398569324,1.4598598848372895,.9919051065976716,.8850227491128407,.6890472812342685,1.1887881197234198,2.0909208528482424,11.700214433101976,11.475299966140188,15.389847356570376,12.681405445292736,6.728663636018416,2.8371989859397155,1.3123564761413613,1.0349213630515621,1.2234192103030705,.9539648835154252,1.470465900704093,7.431459364736739,10.240241357629113,11.895088066130556,12.948024382080858,9.773398617849567,4.385096688019277,3.684922097723116,1.7971036211459523,1.0438436422169761,.760934882635034,.13832406457120583,.5196563309979719,3.4119452162997264,12.099688934648327,13.247805133201002,14.855825273697429,11.855057121737746,5.242105151258767,2.004544142429305,1.8875017022572769,1.372884946286338,1.0185560976941286,.5265597320709453,1.688700856100449,5.716376526202641,11.528899886508889,11.975291611707938,12.771310537986801,10.393527880592282,5.341429392644723,3.333562945602024,1.7172530728657358,1.1452009482635828,1.0174449975648403,.18507482203988002,.473462049081855,5.23071135727388,11.701417813750819,13.297087218815863,14.771821296328204,11.714012295250724,5.978636130946483,4.157651426274871,1.736296970287822,1.2881145632453728,1.0562950267150728,.7883593652212953,.7228038579328228,4.014435847232421,10.129342306785501,11.915686243627663,13.599186753933376,10.398744789892945,5.723113922611577,3.904398590518015,1.8577037755388268,1.3202700943277843,1.3228677673338598,.922299571557359,.5907449525080164,5.2729317346162885,7.88703188901407,8.93385616776769,10.781492549561133,8.03029177165255,4.788766172597123,3.1378529962123975,1.6490963837315955,1.0658311107229197,.775616042430706,.47796998436355503,1.2503635393071244,5.975931636633961,9.449892984590171,10.66906494237943,12.568016394329396,9.927571001024962,4.636974821736388,2.251078597113266,1.450389655322526,.9055764490947751,1.00304913393219,.4942761604770769,1.52616903662469,5.914943304473099,9.902311537750792,12.213891002315082,13.634207900350244,10.789395515791252,5.83284543168781,4.090932160917116,2.0978826786271214,1.0768169355074526,1.0707457486143455,.3157851791573488,1.4358578704542584,5.893683689064977,8.59868072805106,12.915314510719682,14.760240447258223,11.570833749171234,5.914253241858862,2.7197264373789163,1.573703513044318,.9512340332116612,.7961397148064109,.47217343335619677,2.0144364738958003,6.438146441627475,11.101838242492386,11.27396053239052,13.205849094445014,10.056471053826707,5.578141494999216,3.619576560377777,1.714799588949948,1.0542952722268046,1.2109211426183593,1.047380428683806,2.715522668934383,6.493153677743011,10.388416345534909,11.757702183994263,12.535017064486404,10.116836035974826,4.6528317953606555,2.942003613436707,1.6977598873778756,1.1780333118510566,1.081324287322111,.1957273574152593,1.155038556068774,5.775277094601552,10.162492156797756,11.565391499777771,14.146476697952966,11.355815289250693,5.899103671024196,2.7902821818934718,1.4797848077565783,.8959218540128856,1.0853203745303701,.7276753755788673,2.165225432279263,3.738257693402751,10.645415745462616,11.484754656431537,14.13346128649196,11.066028446961909,5.081138623365958,4.144978975183731,1.8949486044549337,1.3401803824058642,1.3610364803882933,.9715197973866744,.6133001003545089,5.546759976479182,8.22944133656228,9.301279248976785,11.373048473688476,8.48048765099932,5.047790151517755,2.9134683086923046,1.3187093610877614,.9432644449102735,.7863166196474822,.4141485692887896,.7141563825840505,2.795708074824312,11.101145278338077,13.67545780325925,14.366154864495662,11.595201456696179,6.193160862418182,3.7938264962810764,1.4618950541095885,.9124148394504623,1.130012369893577,.9309591589446962,1.842797504613037,7.170767394367854,9.41161381928355,11.78088769508118,13.137464312906646,10.019252320547142,5.694788969483684,3.0293739608964723,1.7405105991512888,1.2129781698487265,1.1412871870357841,.22458706537946688,1.1529903868792268,5.730423302210152,10.10842064116621,11.506162056345326,14.084235630655321,11.304682412190937,5.876880335644915,3.4773369549444473,2.0877132478129394,1.1113538577933462,.9992309470974552,.3200593539992885,.6064602001524305,5.312595923754136,11.491299607042373,12.112033114410535,14.363541379488012,11.379273916681315,5.980722798776093,3.557378363479213,1.7285829319643966,1.1543859030178254,1.0216126352965114,.1905392406745366,.4710397346399608,5.239253892108143,11.693335044440891,13.289895723485866,14.758661600736371,11.704291163494831,5.976208157596481,3.6837720254810193,1.732762703925899,1.302666806240721,1.2018298612811142,.6486910934883441,1.4599325048987453,6.0271821925698745,10.651889890344151,12.206223821305155,13.48792302932771,10.374213996418554,6.007665842699991,2.3909929569161954,1.9049170261420945,1.1314063952237003,.9980824436323321,.22176657073153666,.4192302978103635,3.53115986567009,10.747304240740897,12.164049942774538,14.380510389313645,12.31685652118872,6.4433048147850025,3.9596199317546925,1.7625043581292652,1.070944586153751,1.261033872702688,1.1335409792373414,2.8884619151412143,6.673852578810797,10.479128584711484,11.932586952791809,13.340026990127766,10.346456504162855,4.761350564273494,3.2626626523832605,1.6762831640373956,.9954743002066831,.9901168206942547,.8013638093423328,2.6482086182807762,4.800932794500343,8.362861388367705,9.804550323476239,12.171412098036098,9.102685380468085,5.052070646834918,2.7442563416659227,1.3630697727738537,1.1140128704192322,1.067130452399076,.3064071979409191,1.1777788522427657,5.409046582845978,10.256966205853686,11.998121716733804,14.299987068913513,10.681783883296712,5.395493282216314,3.370974359957404,1.2931249849695743,.9244350904353072,1.2477282832465297,.7900676310542623,1.6005776770758047,6.258108414853642,8.356387344547555,11.519314304983865,13.698381943465554,10.87317693301761,5.545762751093044,3.9992338980458966,1.2595541513149684,.9747908928193806,1.19468014817458,.6345035270271137,1.7378467998010314,6.781367823539758,10.633860570405808,11.680719732658353,12.692201516063944,10.677837841680217,5.433892249484014,3.3063600373051707,1.327995435252243,.8654870021351627,1.4224381941358513,.8044121393419696,1.9587333646566418,6.6233220756716396,11.322162137399282,11.96643065888073,13.918199822071896,10.609035733324323,5.811403423709445,2.598403892441572,1.5763288062328713,.9519184335270121,.8001091033783111,.47044190937023495,2.0370423525882178,6.552521152840278,11.274498477233875,11.465757149163856,13.431359816066127,10.213802999262622,5.674264458316327],lie=[2316.4171318266162,2318.009498023818,2321.5521340895366,2324.455592625524,2330.6750604897275,2334.6043109976736,2335.0808931489732,2333.738797736042,2330.1361386831827,2323.6982850054396,2318.593328498391,2315.648741700417,2315.955662605221,2318.1418349585265,2322.667760214156,2326.1406597027008,2328.1425250982606,2329.3992999722786,2330.6412124965955,2326.414740205457,2321.869979383406,2316.9658804908167,2312.36853639339,2309.754581233384,2309.2943083266473,2310.2761026046896,2311.518735189296,2313.199076232673,2314.8413089585274,2314.1920428246954,2308.9280732912766,2299.71688954387,2291.1875987876315,2281.7894986200954,2273.1847684548293,2268.336455915246,2267.896866510422,2268.981771333757,2270.9496394672965,2272.587953079286,2278.164683223944,2280.290512068292,2281.510826490475,2278.327589961756,2273.302049177256,2268.03740052511,2263.7803256733955,2261.6349234539093,2261.482575990463,2262.9849648993218,2264.6764364995897,2267.5393755126306,2271.435694274442,2271.673553306406,2271.593407867882,2265.928496456841,2259.5799487836725,2253.333789242495,2246.8325425746243,2243.092130050325,2242.2663848243515,2245.421856693175,2247.1027147025907,2250.0510340235846,2257.729517430711,2259.6510662203314,2260.283529540906,2254.997188230456,2250.3947081296483,2244.943848442199,2239.7432050986777,2236.6248587228947,2236.906920866225,2239.5308266634233,2241.3275667593384,2243.4452386383855,2245.7290117436205,2250.5579896090208,2246.467287854573,2239.4356596683333,2233.339259763878,2226.8901625961175,2220.2977092211436,2215.62140043625,2214.8825970905423,2216.151184875983,2217.618049154168,2219.0572688999387,2220.550213699205,2220.7364403954157,2217.22928885815,2210.121153553663,2204.4946732826547,2196.801309833464,2189.532475837629,2185.2738591270336,2183.9667834848956,2184.5298575455245,2187.3232565906237,2189.4152879540507,2191.3836882644837,2192.9660038510888,2189.5382834856705,2184.0591626698647,2178.0194874440076,2171.4175321841158,2164.350260337946,2161.0400474780927,2160.469351245215,2161.5551661635795,2162.4392166514936,2164.596283812711,2165.2852511127962,2165.039130093913,2160.600331399581,2152.26078845982,2144.5760503400015,2134.6490082431824,2125.492098999953,2120.2448344907025,2118.696030049703,2119.465003495872,2123.3302918358336,2125.1342768522027,2127.433522967249,2129.342334654581,2129.0545907873834,2124.2832647473674,2118.519828265259,2111.481710861053,2105.904263586782,2102.4811848758727,2101.750836496595,2103.0159025506337,2104.794649744925,2107.303447752114,2108.635464138191,2109.827141663062,2106.2942314591787,2100.757503040687,2094.7894583247166,2086.547149758319,2079.178616406484,2075.1102657403476,2073.8850123098046,2074.894580395498,2077.9469260996843,2080.2101262188935,2082.069665924425,2081.7410691967284,2077.2196067966515,2069.9567279326566,2062.8256845909523,2053.473096982098,2044.9299173579523,2040.1682288784082,2040.11869085974,2041.6649226838142,2043.240734960188,2047.4046923989233,2049.5392724141793,2053.364438299078,2057.169581709553,2053.9679663031366,2049.1400091937453,2044.2445433489372,2040.0621805435983,2037.907324893258,2038.821470536849,2040.5195930829855,2042.6634813926087,2047.6665502250416,2055.0758673380933,2057.3543330753273,2057.8480917442935,2054.0306844969177,2049.639411327292,2044.2360816114724,2039.7139089859832,2037.6110832399902,2037.9449623188527,2039.8110319632744,2041.8005290968556,2044.5269112229062,2050.831380802096,2057.1383881351985,2059.0305647629416,2056.270956036189,2052.7118577699107,2047.6175622153694,2043.301210455805,2041.1655268461448,2042.8451499998769,2046.395832212793,2052.381593953044,2054.8956107515664,2065.724754166437,2075.2697776656305,2076.144794623585,2075.7794455526337,2071.863767297262,2066.0647628334523,2061.944678440559,2061.095705092952,2062.6764210033566,2064.249412915934,2065.9686306468598,2068.309454268907,2070.570844796199,2071.8432493207333,2069.112606505734,2063.6160166013765,2058.1070496450457,2052.0671176067617,2045.2304798950113,2041.7479432259406,2041.5012736965825,2042.4619762103182,2043.9919544894396,2049.1714255631828,2056.036791965638,2062.0720804764874,2061.6454237223015,2056.5012487666772,2051.124079928519,2046.0606366297575,2041.469814103333,2039.2259269425529,2039.6816967845755,2041.5651371966565,2048.2936568762634,2055.557567921789,2065.6315796199738,2072.2608876818254,2076.2452904664237,2074.912389645167,2072.2995767281427,2068.011725221896,2064.9543816940545,2064.206024642581,2065.3134942963325,2067.2950278650433,2074.1925606759505,2080.3959814475165,2087.5282608951165,2088.5283266538786,2092.0437669141365,2089.413769443122,2085.7644049526903,2080.6855840404637,2076.307289248364,2074.570300354687,2074.330048792738,2076.3523644381557,2079.083804205541,2086.4547372664388,2088.968298968174,2095.093778450102,2093.541700525283,2088.660123604609,2084.131264113819,2079.4996575633136,2074.936933848867,2071.9954404910827,2072.8443216795727,2073.7786945795992,2075.495602150065,2077.603343652741,2081.4965442542116,2083.2037552529314,2080.9805371746847,2075.336567614882,2070.510275887143,2064.14019429905,2057.67481622889,2053.87708561273,2053.2789648384296,2055.1537799327375,2057.5042586730774,2059.45663573416,2065.12720239686,2067.4878017286233,2066.01826551097,2062.060217091506,2058.1258602975727,2053.1073823247184,2048.176111488972,2044.999572214996,2045.8261922806291,2048.378774626408,2054.6637714536546,2057.1980563112047,2057.998052635928,2058.8397949431323,2056.584787651486,2051.4314837874076,2045.9353172343228,2040.5688923056791,2034.9991712252008,2031.509119648629,2030.986908266049,2032.6617917276092,2034.7945774056593,2036.1321982015318,2037.7883522442576,2038.6459823671664,2035.272573079334,2028.8369722828584,2023.5690719478712,2016.9610714086593,2009.8587660310072,2005.4539721803699,2005.5736713009385,2006.380463288754,2007.4110513387377,2009.3900520639959,2010.5377210088802,2011.461183804346,2011.8655761931457,2007.3837067251816,2001.8110356691225,1995.2685236854402,1988.656934592161,1984.747226609709,1983.7606568257095,1984.4759124051084,1986.030669652609,1987.2964479042719,1988.4649166947454,1991.0095921340778,1986.8537772524332,1981.2720178805428,1974.3467206705272,1966.9578347994307,1960.422511102787,1956.632219256977,1955.815070883519,1956.5526300350386,1957.6304643300214,1960.2334978746276,1962.955772390146,1963.6620861829085,1961.1677494021849,1955.090887951692,1949.572291360741,1943.2915655934926,1937.2362517773006,1934.209325761057,1934.892906410475,1938.284896313143,1946.2764962048288,1948.5843454404035,1951.3854856689245,1951.6058606288266,1948.6588271034113,1943.0425014766302,1937.8098482051103,1932.4101692805991,1926.5066648176964,1923.0756963771198,1923.3868907062676,1925.0277905502444,1929.7520168674766,1936.6393386226575,1941.9112437048066,1947.7657672624935,1951.1596148402332,1949.8524401875643,1946.6224699030392,1940.3483836737785,1936.2141663700647,1934.5502945473954,1934.6121776451373,1936.0205182744767,1941.3176918279376,1948.8688406329422,1948.6260474917735,1949.8231383961624,1949.6526984680365,1945.8858208169802,1942.200395047933,1937.0311394248952,1932.6783791403855,1930.3242269131836,1930.3752164531465,1932.5139728887389,1934.0356888776657,1937.7007960673222,1940.7835551973408,1943.3279662249215,1941.7733946978478,1934.9786527826222,1929.4359109579902,1923.1481154565336,1917.3484511854197,1913.2970785933187,1912.4359104233502,1914.0931227743872,1916.563880374182,1918.8660575430295,1920.5119385968615,1920.668542101414,1920.134310925437,1915.6069388584813,1911.1890711921394,1905.5894039646623,1899.8710993595428,1896.8963058486993,1896.7969958456056,1898.1299321588308,1907.6480532786334,1918.3496407605194,1921.806377396678,1922.6147669028014,1922.25317869392,1920.4434852478087,1916.1169974610007,1910.44681051926,1905.9226900542087,1904.5813658595494,1906.0210074063004,1907.476772108526,1908.9056480859335,1911.3182544622532,1914.4564809555475,1917.1862074667479,1913.8142046581693,1910.3343565936464,1904.7645636853522,1899.397139592516,1894.113942159216,1891.7606795295635,1893.1499499125523,1894.6379573534123,1897.3697682537465,1901.6395190765422,1912.9482585183612,1919.9472706309082,1924.6510533716732,1922.993802383671,1921.0327784005867,1915.9760373879085,1912.887650358423,1911.9867158345303,1912.5460887773193,1913.7761790861905,1915.551263996908,1919.8069005125997,1923.8136884107573,1922.7454398120183,1919.2874505360335,1913.6594109749724,1908.351923281584,1901.8495580341087,1896.2492208298218,1893.8093109843687,1893.052795491319,1893.938378196158,1895.0001715835315,1896.929375262939,1899.9685083304767,1900.5274430764205,1897.3878314133997,1891.21165754705,1884.9613778382995,1877.89996441183,1871.4129556868036,1867.6898190913953,1866.7896605337826,1868.2532559921779,1870.687109558152,1872.389534071721,1874.8607113729795,1874.7231604517276,1871.072472094934,1865.759177792948,1859.3894577019537,1852.22548884815,1845.7335366064,1842.2392467238683,1840.8230827719722,1841.808660139964,1843.9497222404052,1845.1619348066904,1851.0697711652715,1852.7811858873768,1851.0973860281915,1846.4512718050955,1841.50010512529,1836.2292264094224,1831.5994996162146,1828.5762450101022,1832.1443076704486,1832.789918209595,1835.795447971118,1838.0734101534183,1843.4685241156478,1845.1612764367433,1850.5365653249362,1845.5017684020484,1840.4194589773138,1836.5436185661895,1832.5935819862552,1830.2946204608918,1831.2089193571808,1834.2644288513136,1835.5993999515108,1838.2446945511913,1839.157788668296,1838.5456619518527,1835.684869634944,1830.2847986872562,1824.3707704629107,1818.2815526080442,1812.2175264995376,1809.193500733119,1808.7453294164318,1810.7455042791355,1817.6315578516912,1823.765738786594,1823.779234197836,1824.9493796759466,1827.7394412871524,1822.5124491705876,1818.1634757756167,1813.9359432415256,1809.9280176347393,1807.4853420669556,1807.6332928731804,1811.0705183799857,1812.9109379091583,1816.1625543507262,1818.1453646117263,1818.8408844351977,1816.42371544606,1810.6606227633706,1804.4927683670849,1798.798873940649,1793.1489586429834,1789.8725985498727,1789.4776735118262,1791.897691264649,1795.9871681409677,1800.9989044626175,1803.6543006048505,1809.35752054119,1813.7294994121605,1812.0659461860325,1811.0027794586986,1805.1023176774108,1800.3160550796215,1798.7552015304375,1798.8295995982755,1800.0737975793177,1802.1237191717007,1805.9795453006186,1810.198940082953,1809.861480547696,1805.577425364248,1800.1321060319242,1794.4507086910999,1788.1807932353333,1782.7591306299644,1779.0801053839127,1778.8742645438474,1780.166125122053,1783.4253168398852,1794.2910787411433,1804.4903123486713,1808.6280510611798,1811.3665312633143,1811.187262406205,1808.2351064292177,1802.8713793236907,1799.0700195590828,1798.3255710773337,1799.1929211611068,1800.7842131005607,1806.914913015974,1819.1106564483707,1818.472793088395,1819.080149092613,1815.2652237942577,1809.4379033662772,1805.4504804597423,1800.29092925697,1795.2130122465962,1792.3757901681636,1792.9956622823602,1796.0453638913782,1800.7526263843208,1804.0377721906277,1804.454882081579,1807.706539919067,1806.1647708920389,1801.3339007419968,1795.5538306874748,1789.642765819033,1784.0533009931482,1781.2156825210482,1780.1586710400413,1780.9830320833885,1782.7321092184604,1784.3704477416318,1785.3756081866666,1785.9168744685235,1782.362362520743,1775.6820743241235,1769.752728479372,1762.7480841726376,1756.5396525752483,1752.9342140489312,1753.3078734181474,1755.7213047970652,1757.9555949052808,1764.397729759969,1771.581936675198,1776.7366792001394,1776.1813854398933,1773.267083116634,1769.589917236838,1765.7225933447792,1762.3769641235665,1760.6123413136293,1762.1627719336695,1768.0688157684228,1773.3156728832016,1781.192202149171,1781.4393750648221,1789.3371346547608,1789.0864884575553,1783.9027989035753,1780.0755015276402,1776.2539003521572,1772.400364425708,1770.6462621722685,1771.8521321398846,1773.1395174689533,1775.40186288865,1777.3897355449244,1782.8274974831274,1788.822946711719,1787.001296928756,1781.9149540914145,1777.1246729520678,1771.7691227155574,1766.946017114108,1764.463353433387,1766.061475533428,1766.788780731933,1767.5262733365334,1768.7822329191972,1770.5019996009175,1769.8981046457832,1766.9733406481357,1760.5053049665244,1755.4076297371691,1749.7050406541773,1744.7624369978157,1741.7115615673151,1740.4127789554,1741.4571463261536,1742.6977509958997,1743.9051877297304,1744.6941136075782,1743.125066968763,1737.732731660072,1731.0882155715735,1723.071899654401,1713.574709418186,1705.3555932554718,1700.8447296938448,1699.3957621850568,1700.1295991059649,1702.5794152340118,1709.519188240246,1715.6588623442865,1723.5445887535614,1726.9736112180328,1725.0809835339967,1722.5755173401126,1718.7530254839135,1716.0806886881928,1716.2206082212017,1716.9002688466285,1718.8688753693914,1721.05869209076,1725.4128026550234,1730.255073571874,1734.2841438566238,1734.216558492637,1731.254330192879,1727.0436571487523,1723.0169303061418,1719.9255522564988,1718.0137403750448,1719.71773446213,1721.9567278269485,1725.2780859703605,1733.643834898795,1743.019878256355,1744.163311070514,1742.418947243826,1739.0094179336616,1736.1325417491198,1731.3863653031924,1727.318519883214,1725.7788598411744,1726.911913676569,1728.4452893668104,1730.834097806603,1734.8318849795112,1736.8619963633441,1739.4116131578235,1736.7769557503138,1731.6298470019085,1727.2560094995665,1722.1476389792356,1717.2643411605377,1714.9554187495314,1716.2973849864593,1721.0267105390092,1727.0619385867788,1731.683935190095,1738.8610333282447,1745.3721432355978,1751.5583618577216,1747.0150068896705,1743.299972798389,1738.0887823315395,1734.5098283718614,1734.2537598627414,1736.8610821862944,1740.6723766118748,1746.985315828627,1754.2625238539092,1764.238222933345,1778.2272187429364,1778.9268543322728,1778.942964316913,1777.7767271160242,1773.9317191258015,1770.5073101042303,1769.773636507737,1770.8317061241366,1777.5081317803974,1787.3688282362086,1787.5123609575742,1788.514503363629,1789.3904385804576,1786.541252830932,1780.9578247588695,1775.641773736425,1770.648671958569,1765.8552822516508,1763.218157826347,1764.0546005928677,1767.4644596435137,1769.3048033246846,1770.3037383980918,1771.8769241706643,1773.3363504997762,1770.5015409884209,1764.9287402855318,1760.159646367427,1754.965571600551,1750.0416631173334,1747.984191344632,1747.960395613878,1749.9583633061513,1751.7488670045723,1754.703067242298,1768.8128030653525,1775.7413495425292,1772.294856389777,1768.5568367877415,1765.1576503101405,1760.0349358858093,1756.2762960067555,1755.4329561967556,1756.1378821333378,1757.4878138465403,1758.8838105333775,1761.1538347255319,1763.8572553250237,1766.826920412091,1762.9231621134693,1757.242937275704,1752.5785235301312,1747.597038347138,1742.378246117144,1739.3838970243635,1739.7263355267678,1740.889310260017,1743.6463561815515,1747.07804020502,1747.8067214961604,1747.9902373515,1746.2227271632732,1740.2597668689878,1734.780142250752,1727.6461447253796,1721.3566899254226,1717.7903155234292,1716.9618833051836,1718.4490853081845,1719.928613983312,1721.3906490773943,1722.432103126563,1726.7336274499437,1722.9588064016857,1717.5577791575136,1712.2403016467242,1706.56880618921,1701.2391172546302,1699.5151973270908,1699.5703176490902,1700.2999668226546,1700.6797901025448,1703.0286700640595,1704.1174126295964,1703.8027025586614,1700.0629490674078,1694.5444379872683,1687.8633684460408,1679.9898267048457,1673.3154195948136,1669.3588257646602,1668.0672388761006,1668.629258395962,1669.1792964124709,1669.8855550322955,1670.3149861882005,1674.9794666333441,1670.9754086795551,1663.9687828336728,1657.568555490006,1649.8929777847018,1643.148873907743,1638.718878577324,1637.9978785553112,1638.408450546116,1639.6217290772468,1641.118222903664,1645.3538099718178,1646.906264664126,1643.064700673596,1636.0698078609323,1630.1651114119743,1622.7878973356958,1616.090078201973,1612.042709716764,1612.0376485022082,1612.7256003628368,1615.1001762916087,1622.4177867861215,1628.9468749166228,1635.1865662917435,1636.1046540177394,1634.7720430247598,1632.9262258160925,1628.3357766913887,1625.034955342109,1623.5529564710569,1624.5438375222911,1626.2948948328155,1628.5493496951187,1630.7616950403221,1633.849361668641,1634.3376389804987,1632.4566162609174,1628.0399677570613,1622.934569610706,1616.763970808461,1611.3712412918605,1608.5214414141717,1608.3391557212842,1609.9557024155513,1612.238409147122,1623.9962712712052,1626.927221382448,1642.141454859443,1643.7632099679074,1644.8227498690535,1642.9491981826093,1639.4183523430095,1635.831967602987,1635.3986019303295,1635.9291919441234,1637.5302187812717,1641.8735810154208,1647.021761990872,1657.1174793007153,1660.2868609060697,1660.4648919406557,1659.7459945445278,1655.2710381552106,1651.520748709952,1648.2073708549478,1646.9898413222832,1649.1727881210677,1652.2473384449283,1662.1676530329153,1676.3170578062557,1675.152096298653,1675.087821126113,1673.3679827116148,1670.1773986415683,1667.2378888897476,1663.4044609385244,1659.9676702146062,1658.0363419250848,1659.2903818257464,1662.0890338510349,1665.0383244012517,1674.3736206824474,1691.0201032819289,1696.9224332184874,1699.3704924158758,1702.608724332291,1702.9339896618192,1698.922560928353,1694.8209541666947,1694.280024783221,1695.450118184269,1698.6659552057743,1701.144211630556,1704.9466717823868,1712.0439036141847,1713.768227860333,1712.192243556893,1707.717432624231,1703.5224258136666,1699.71616282146,1696.0683610593865,1694.3412593252913,1694.4364363797904,1695.984922630111,1697.1950430301215,1701.2976549118403,1710.847726425438,1714.1845676077237,1712.4549512462359,1708.7204047304629,1704.6983648029911,1700.9845156163906,1697.2125732429952,1695.1863282014747,1697.0031918566422,1698.1120139894294,1699.2942046395333,1701.6942193462694,1704.689617922092,1706.6042760906973,1704.304599290837,1698.9257238526097,1694.4003959707995,1689.1859815565917,1683.9950653518697,1681.319709724575,1681.1999782016787,1683.0114585041101,1687.2800189341017,1690.9651666379877,1691.5424386810946,1692.3542235765665,1689.7345838969713,1684.9180540881919,1680.5824753824538,1675.3977117474014,1670.1664409301566,1667.2139166717375,1666.5911243920923,1668.136476748627,1673.5474996988437,1676.8980337695446,1677.6183983638105,1678.3943657614566,1679.819934576782,1676.5571892636833,1670.7899460817193,1666.0273778321807,1661.616469639738,1659.1353979369146,1658.756454068095,1659.9018431921395,1663.6318195222857,1666.4835603952038,1673.0086225557911,1674.282911855641,1670.9940385943721,1665.5268781701775,1661.6714623457788,1656.9604409536687,1651.7699594033581,1648.5821961563138,1650.0470899870586,1651.312699460151,1654.737355213758,1659.089447532708,1662.9182225824468,1668.5505828351588,1669.2668589008765,1671.233780625373,1668.6171098924624,1662.881341425028,1659.0179747735367,1657.9866299908692,1659.237515920033,1660.8559753267575,1668.3569101022274,1674.7891238289076,1677.5337844596636,1685.494261536112,1692.978553613594,1690.539873991521,1685.9859226532758,1680.074175517047,1676.5183930556568,1675.513645684069,1675.7678516492276,1677.474607780778,1680.322073768726,1681.9840754955915,1685.491288886284,1685.1313972604605,1682.437753012911,1676.9622874206595,1672.5425392692946,1667.213562922296,1662.026836452709,1659.2836845561362,1659.2343234752002,1660.2754187895412,1661.6619378813946,1665.8886485856412,1668.5946737083232,1668.9710286528837,1666.0899061535233,1660.6163490723927,1655.581744705025,1649.4137327447768,1643.9543817792826,1640.7549830160856,1640.241012458013,1641.4317269642092,1642.667455573764,1644.1115153259632,1647.1791022662858,1647.7979107654141,1644.969410422472,1639.4025176172188,1634.5584435164028,1627.7969033991733,1621.6976296733842,1618.5664814403817,1619.1432943368675,1620.0944889440937,1621.463485551149,1625.9492308501267,1629.2321631289014,1630.404832736862,1632.7642912736205,1629.3408870978087,1625.3520221704803,1620.682099319743,1616.7864122348776,1615.0747886091258,1617.0708756150798,1618.8284312270891,1625.9391511516137,1628.601238537515,1632.341508710144,1643.9290026876656,1643.925508155611,1643.9098723086763,1644.4672484862615,1639.4068441347158,1635.531933142967,1634.5624187667288,1636.3548555162097,1637.8534972823327,1639.2676417216892,1642.1228175859774,1643.3406441588959,1646.3479169661325,1645.432633229419,1639.6801808302332,1634.7048846696407,1629.8864686468132,1625.091252155241,1622.0393694831464,1622.1287094988716,1623.8441126069706,1629.6731525844878,1630.6195337182353,1631.505746025658,1631.1250956861852,1627.3925302259086,1622.2259210609411,1616.8650199767696,1610.6891849356848,1604.9545539118944,1602.04356383992,1600.8170745621187,1601.768672430027,1602.3345116589094,1603.498306791038,1604.4738507911957,1604.629710574504,1599.9348397853053,1592.4549752292864,1584.6224382618555,1575.9017042424127,1568.7931266258581,1564.7118887451213,1563.37276592009,1564.2620469088406,1568.964291745607,1569.2413945639867,1570.7926900535654,1569.563515847017,1565.2769592310874,1558.501672164433,1550.4090793011483,1541.8905237797724,1534.6431168090637,1530.2375143929817,1528.8841926367427,1529.5032677601982,1531.3525513521176,1536.295711835888,1537.7033868460935,1544.2034708075719,1543.2306896461316,1539.2046093980612,1535.1964044912388,1529.8034032678318,1524.6833444382883,1521.7401470276307,1523.4600987821982,1525.2487011989283,1529.7881905803547,1542.104534221988,1559.3561826725927,1564.7067723858222,1568.4815698724487,1566.570242059246,1565.0040455372773,1559.7292797191815,1556.7029089821788,1555.932594378392,1556.3869007668209,1559.196626195257,1560.4959027910304,1563.3410812972868,1564.7372004149295,1570.1516751559823,1571.3248909657352,1566.6504972941736,1562.7982655143724,1558.7764053269593,1554.5968291818258,1552.0509274554242,1552.325258595194,1554.196271060286,1556.5001803451842,1562.0614804443644,1574.039167626275,1586.2020696350894,1589.0279835493916,1589.3474964932334,1588.2268736689427,1583.9518819163404,1581.7849455170413,1581.5607277096824,1582.2325794334306,1583.728224018957,1586.9714797084484,1589.0609080450809,1590.1872331390014,1592.4662985168613,1590.9738655910094,1586.3059604234024,1581.922139733569,1576.9683475792312,1572.1111214195387,1568.9707926011874,1568.4162763544564,1569.642121101962,1570.4373362820058,1572.5377786311349,1574.0387462805013,1574.3777061826422,1570.9502894045258,1563.182839874891,1556.059858083435,1548.5091097187985,1542.0067747594708,1538.2087831826072],Q4={averageUnmetDemandBaseline:tie,averageUnmetDemand:nie,averageDifference:iie,averageDemandBaseline:rie,averageDemandDifference:sie,averageSupplyBaseline:oie,averageSupply:aie,averageGroundwater:lie};function cie({counter:t,displayMonth:e,dataset:n}){const i=ha({col:dw,saturation:.5}),r=ha({col:dw,saturation:.5,brightness:.5}),s=ha({col:Zh,saturation:.5}),u=ha({col:Zh,saturation:.5,brightness:.5}),a=(t+9)%12+1,y=oc().domain([0,cD(Q4[n],L=>L)]).range([40,90]),w=oc().domain([1,12]).range([0,2*Math.PI]),M=dy().radius(L=>y(L)).curve(my).angle((L,U)=>w((U+9)%12+1)),R=dy().radius(L=>y(L)).curve(my).angle((L,U)=>w(U%12+1));_t.useEffect(()=>(Lo("#clockContainer").style("visibility","visible"),Lo("#pieOutline path").attr("d",Ay().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",n=="averageGroundwater"?`rgb(${i})`:`rgba(${s}, 1)`),Lo("#demandLine path").data([Q4[n]]).join("path").attr("d",L=>M(L)).attr("stroke",n=="averageGroundwater"?`rgba(${r}, 0.3)`:`rgba(${u}, 0.3)`).attr("stroke-width","0.2").attr("fill","none"),function(){Lo("#clockContainer").style("visibility","hidden"),Lo("#pie path").attr("d",""),Lo("#pieOutline path").attr("d",""),Lo("#demandLine path").attr("d",""),Lo("#demandLineCur path").attr("d",""),Lo("#date").text("")}),[n]),_t.useEffect(()=>{Lo("#pie path").attr("d",Ay().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*a/12*2)).attr("fill",n=="averageGroundwater"?`rgb(${i})`:`rgba(${s}, 1)`);let L=qa(t);e?Lo("#date").html("<b>"+L.toLocaleString("default",{year:"numeric"})+"</b><br/>"+L.toLocaleString("default",{month:"long"})):Lo("#date").html("<b>"+L.toLocaleString("default",{year:"numeric"})+"</b>"),HR("#demandLineCur path").data([Q4[n].filter((U,q)=>qa(q).toLocaleString("default",{year:"numeric"})==L.toLocaleString("default",{year:"numeric"}))]).join("path").attr("d",U=>R(U)).attr("stroke",n=="averageGroundwater"?`rgba(${r}, 1)`:`rgba(${u}, 1)`).attr("stroke-width","2").attr("fill","none")})}function uie({slide:t,setSlide:e,counter:n,cycler:i,curScenario:r,transitioning:s,speedyCounter:u}){return En.createElement(En.Fragment,null,En.createElement(eie,{slide:t,transitioning:s}),(ln(t,1,6)||ln(t,14,1e3))&&En.createElement(cie,{counter:t>=14?ln(t,14,19)?1026:t==20?1197:t==21?Math.floor(i/3)*67%1199+1:u:ln(t,3,6)?t<=4?1026:1197:n,displayMonth:ln(t,3,6),dataset:t==2?"averageGroundwater":"averageDemandBaseline"}),t<22&&En.createElement("button",{onClick:()=>{e(a=>a+1)},className:"buttons right"},""),t>0&&En.createElement("button",{onClick:()=>{e(a=>a-1)},className:"buttons left"},""),ln(t,15,21)&&En.createElement("h1",null,LP[ln(t,20,21)?i%3:r]))}function hie({curScenario:t,setCurScenario:e,speedyCounter:n,setSpeedyCounter:i,playing:r,setPlaying:s,displayGW:u,setDisplayGW:a,displayDiff:y,setDisplayDiff:w,displayUnmet:M,setDisplayUnmet:R,displayDemand:L,setDisplayDemand:U,displayLandUse:q,setDisplayLandUse:te}){return En.createElement(En.Fragment,null,En.createElement("button",{onClick:()=>{s(pe=>!pe)},style:{position:"absolute",display:"block",bottom:"20px",right:"50%",transform:"translateX(50%)"}},r?"Pause":"Play"),En.createElement("input",{onChange:function(pe){s(!1),i(parseInt(pe.target.value))},onInput:function(pe){i(parseInt(pe.target.value))},value:n,style:{width:"50vw",position:"absolute",display:"block",bottom:"40px",right:"50%",transform:"translateX(50%)"},type:"range",min:"0",max:"1199",id:"myRange"}),En.createElement("div",{style:{position:"absolute",display:"block",bottom:"20%",right:"0",transform:"translateY(50%)"}},En.createElement("div",null,En.createElement("input",{type:"checkbox",value:"display1",checked:u,onChange:()=>a(pe=>!pe)}),En.createElement("label",{htmlFor:"display1"},"Display Groundwater")),En.createElement("div",null,En.createElement("input",{type:"checkbox",value:"display2",checked:y,onChange:()=>w(pe=>!pe)}),En.createElement("label",{htmlFor:"display2"},"Display Difference to Baseline")),En.createElement("div",null,En.createElement("input",{type:"checkbox",value:"display3",checked:M,onChange:()=>R(pe=>!pe)}),En.createElement("label",{htmlFor:"display3"},"Display Unmet Demand")),En.createElement("div",null,En.createElement("input",{type:"checkbox",value:"display4",checked:L,onChange:()=>U(pe=>!pe)}),En.createElement("label",{htmlFor:"display4"},"Display Demand")),En.createElement("div",null,En.createElement("input",{type:"checkbox",value:"display5",checked:q,onChange:()=>te(pe=>!pe)}),En.createElement("label",{htmlFor:"display5"},"Display Land Use"))),En.createElement("div",{onChange:function(pe){e(pe.target.value)},style:{position:"absolute",display:"block",bottom:"50%",right:"0",transform:"translateY(50%)"}},En.createElement("div",null,En.createElement("input",{type:"radio",name:"scenario",value:"0",checked:t==0}),En.createElement("label",{htmlFor:"scenario1"},"Scenario 1")),En.createElement("div",null,En.createElement("input",{type:"radio",name:"scenario",value:"1",checked:t==1}),En.createElement("label",{htmlFor:"scenario2"},"Scenario 2")),En.createElement("div",null,En.createElement("input",{type:"radio",name:"scenario",value:"2",checked:t==2}),En.createElement("label",{htmlFor:"scenario3"},"Scenario 3"))))}function fie({slide:t,setCurScenario:e}){const[n,i]=_t.useState(Hte),[r,s]=_t.useState(!1),u=_t.useCallback(()=>{i({...Wte,onTransitionEnd:()=>s(!1)})},[]),a=_t.useCallback(()=>{i({...qte,onTransitionEnd:()=>s(!1)})},[]),y=_t.useCallback(()=>{i({...Zte,onTransitionEnd:()=>s(!1)})},[]),w=_t.useCallback(()=>{i({...Xte,onTransitionEnd:()=>s(!1)})},[]),M=_t.useCallback(()=>{i({...pw,onTransitionEnd:()=>s(!1)})},[]),R=_t.useCallback(()=>{s(!0),i({...$te,onTransitionEnd:a})},[]),L=_t.useCallback(()=>{s(!0),i({...pw,onTransitionEnd:y})},[]);return _t.useEffect(()=>{t==8?(s(!0),u()):t==10?L():t==11?R():t==12?(s(!0),M()):t==17&&(s(!0),w()),ln(t,15,17)?e(0):t==18?e(1):t==19&&e(2)},[t]),{curViewState:n,transitioning:r}}function Aie({slide:t}){const[e,n]=_t.useState(1026),[i,r]=_t.useState(1026),[s,u]=_t.useState(!1),[a,y]=_t.useState(0),[w,M]=_t.useState(!1);return _t.useEffect(()=>{if(s){let R=setTimeout(()=>r(L=>L%1199+1),250);return function(){clearTimeout(R)}}},[i,s]),_t.useEffect(()=>{if(ln(t,1,2)){M(!0);let R=setTimeout(()=>n(L=>L%1199+1),250);return function(){clearTimeout(R),M(!1)}}},[e,t]),_t.useEffect(()=>{if(ln(t,20,21)){let R=setTimeout(()=>y(L=>(L+1)%1e3),2e3);return function(){clearTimeout(R)}}},[a,t]),{counter:e,setCounter:n,speedyCounter:i,setSpeedyCounter:r,playing:s,setPlaying:u,cycler:a,setCycler:y,counting:w,setCounting:M}}function die({slide:t,counter:e,cycler:n,curScenario:i,counting:r,speedyCounter:s}){return{getTooltip:_t.useCallback(({object:a})=>{if(r||ln(t,1,6)||t==14){let y=t==14?qa(1026):ln(t,1,2)?qa(e):ln(t,3,4)?qa(1026):qa(1197),w=t==14?1026:ln(t,1,2)?e:ln(t,3,4)?1026:1197;return a&&{html:`        <div><i>${y.toLocaleString("default",{month:"long"})} ${y.toLocaleString("default",{year:"numeric"})}</i></div>
        <div><b>Demand</b></div>
        <div>${a.properties.DemandBaseline[w]}</div>
        <div><b>Supply</b></div>
        <div>${a.properties.DemandBaseline[w]+a.properties.UnmetDemandBaseline[w]}</div>
        <div><b>Unmet Demand</b></div>
        <div>${-a.properties.UnmetDemandBaseline[w]}</div>
        <div><b>Groundwater</b></div>
        <div>${a.properties.Groundwater[w]}</div>
        <div><b>Land Holder</b></div>
        <div>${Z4[a.properties.LandUse[0]]}</div>
    `}}if(ln(t,15,1e3)){let y=ln(t,14,19)?qa(1026):ln(t,20,20)?qa(1197):ln(t,21,21)?qa(Math.floor(n/3)*67%1199+1):qa(s),w=ln(t,14,19)?1026:ln(t,20,20)?1197:ln(t,21,21)?Math.floor(n/3)*67%1199+1:s,M=t==20?n%3:i;return a&&{html:`        <div><i>${y.toLocaleString("default",{month:"long"})} ${y.toLocaleString("default",{year:"numeric"})}</i></div>
        <div><i>${LP[M]}</i></div>
        <div><b>Demand</b></div>
        <div>${a.properties.Demand[ho[M]][w]}</div>
        <div><b>Supply</b></div>
        <div>${a.properties.Demand[ho[M]][w]+a.properties.UnmetDemand[ho[M]][w]}</div>
        <div><b>Unmet Demand</b></div>
        <div>${-a.properties.UnmetDemand[ho[M]][w]}</div>
        <div><b>Groundwater</b></div>
        <div>${a.properties.Groundwater[w]}</div>
        <div><b>Land Holder</b></div>
        <div>${Z4[a.properties.LandUse[0]]}</div>
    `}}return a&&{html:`        <div><b>Demand (Averaged Over 100 Years)</b></div>
        <div>${a.properties.DemandBaselineAverage}</div>
        <div><b>Supply (Averaged)</b></div>
        <div>${a.properties.DemandBaselineAverage+a.properties.UnmetDemandBaselineAverage}</div>
        <div><b>Unmet (Averaged)</b></div>
        <div>${-a.properties.UnmetDemandBaselineAverage}</div>
        <div><b>Groundwater (Averaged)</b></div>
        <div>${a.properties.GroundwaterAverage}</div>
        <div><b>Land Holder</b></div>
        <div>${Z4[a.properties.LandUse[0]]}</div>
    `}},[e,t,s,n,i])}}function pie(){const[t,e]=_t.useState(!0),[n,i]=_t.useState(!0),[r,s]=_t.useState(!0),[u,a]=_t.useState(!1),[y,w]=_t.useState(!1);return{displayGW:t,setDisplayGW:e,displayDiff:n,setDisplayDiff:i,displayUnmet:r,setDisplayUnmet:s,displayDemand:u,setDisplayDemand:a,displayLandUse:y,setDisplayLandUse:w}}function mie(){const[t,e]=_t.useState(0),[n,i]=_t.useState(0),[r,s]=_t.useState(0),u={data:G2,slide:t,curRes:n,setSlide:e,curScenario:r,setCurScenario:s},a=pie(),y=Aie(u),{curViewState:w,transitioning:M}=fie(u),{getTooltip:R}=die({...u,...y}),L={...u,...y,transitioning:M},U=t>=22,q=[new VP(L),new GP({...L,...a})];return En.createElement(En.Fragment,null,En.createElement(Kne,{layers:q,setCurRes:i,curViewState:w,getTooltip:R}),En.createElement(uie,{...L}),U&&En.createElement(hie,{...L,...a}))}function gie(t){FE(t).render(En.createElement(mie,null))}gie(document.getElementById("app"));
