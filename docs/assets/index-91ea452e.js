function hI(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function _d(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function fI(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function O6(t){let e,n,i;t.length!==2?(e=_d,n=(a,y)=>_d(t(a),y),i=(a,y)=>t(a)-y):(e=t===_d||t===fI?t:AI,n=t,i=t);function r(a,y,w=0,I=a.length){if(w<I){if(e(y,y)!==0)return I;do{const R=w+I>>>1;n(a[R],y)<0?w=R+1:I=R}while(w<I)}return w}function s(a,y,w=0,I=a.length){if(w<I){if(e(y,y)!==0)return I;do{const R=w+I>>>1;n(a[R],y)<=0?w=R+1:I=R}while(w<I)}return w}function u(a,y,w=0,I=a.length){const R=r(a,y,w,I-1);return R>w&&i(a[R-1],y)>-i(a[R],y)?R-1:R}return{left:r,center:u,right:s}}function AI(){return 0}function dI(t){return t===null?NaN:+t}const pI=O6(_d),mI=pI.right;O6(dI).center;const vw=mI;function F6(t,e){let n,i;if(e===void 0)for(const r of t)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let s of t)(s=e(s,++r,t))!=null&&(n===void 0?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)))}return[n,i]}const gI=Math.sqrt(50),_I=Math.sqrt(10),yI=Math.sqrt(2);function Zd(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),u=s>=gI?10:s>=_I?5:s>=yI?2:1;let a,y,w;return r<0?(w=Math.pow(10,-r)/u,a=Math.round(t*w),y=Math.round(e*w),a/w<t&&++a,y/w>e&&--y,w=-w):(w=Math.pow(10,r)*u,a=Math.round(t/w),y=Math.round(e/w),a*w<t&&++a,y*w>e&&--y),y<a&&.5<=n&&n<2?Zd(t,e,n*2):[a,y,w]}function vI(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,s,u]=i?Zd(e,t,n):Zd(t,e,n);if(!(s>=r))return[];const a=s-r+1,y=new Array(a);if(i)if(u<0)for(let w=0;w<a;++w)y[w]=(s-w)/-u;else for(let w=0;w<a;++w)y[w]=(s-w)*u;else if(u<0)for(let w=0;w<a;++w)y[w]=(r+w)/-u;else for(let w=0;w<a;++w)y[w]=(r+w)*u;return y}function q4(t,e,n){return e=+e,t=+t,n=+n,Zd(t,e,n)[2]}function Z4(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?q4(e,t,n):q4(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function xI(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function xw(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}var wI={value:()=>{}};function ww(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new yd(n)}function yd(t){this._=t}function bI(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}yd.prototype=ww.prototype={constructor:yd,on:function(t,e){var n=this._,i=bI(t+"",n),r,s=-1,u=i.length;if(arguments.length<2){for(;++s<u;)if((r=(t=i[s]).type)&&(r=EI(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<u;)if(r=(t=i[s]).type)n[r]=m9(n[r],t.name,e);else if(e==null)for(r in n)n[r]=m9(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new yd(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function EI(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function m9(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=wI,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var X4="http://www.w3.org/1999/xhtml";const g9={svg:"http://www.w3.org/2000/svg",xhtml:X4,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function n3(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),g9.hasOwnProperty(e)?{space:g9[e],local:t}:t}function TI(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===X4&&e.documentElement.namespaceURI===X4?e.createElement(t):e.createElementNS(n,t)}}function SI(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function bw(t){var e=n3(t);return(e.local?SI:TI)(e)}function CI(){}function N6(t){return t==null?CI:function(){return this.querySelector(t)}}function PI(t){typeof t!="function"&&(t=N6(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=new Array(u),y,w,I=0;I<u;++I)(y=s[I])&&(w=t.call(y,y.__data__,I,s))&&("__data__"in y&&(w.__data__=y.__data__),a[I]=w);return new Ss(i,this._parents)}function Ew(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function MI(){return[]}function Tw(t){return t==null?MI:function(){return this.querySelectorAll(t)}}function II(t){return function(){return Ew(t.apply(this,arguments))}}function kI(t){typeof t=="function"?t=II(t):t=Tw(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var u=e[s],a=u.length,y,w=0;w<a;++w)(y=u[w])&&(i.push(t.call(y,y.__data__,w,u)),r.push(y));return new Ss(i,r)}function Sw(t){return function(){return this.matches(t)}}function Cw(t){return function(e){return e.matches(t)}}var LI=Array.prototype.find;function DI(t){return function(){return LI.call(this.children,t)}}function RI(){return this.firstElementChild}function zI(t){return this.select(t==null?RI:DI(typeof t=="function"?t:Cw(t)))}var BI=Array.prototype.filter;function OI(){return Array.from(this.children)}function FI(t){return function(){return BI.call(this.children,t)}}function NI(t){return this.selectAll(t==null?OI:FI(typeof t=="function"?t:Cw(t)))}function UI(t){typeof t!="function"&&(t=Sw(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=[],y,w=0;w<u;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new Ss(i,this._parents)}function Pw(t){return new Array(t.length)}function VI(){return new Ss(this._enter||this._groups.map(Pw),this._parents)}function Xd(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Xd.prototype={constructor:Xd,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function GI(t){return function(){return t}}function jI(t,e,n,i,r,s){for(var u=0,a,y=e.length,w=s.length;u<w;++u)(a=e[u])?(a.__data__=s[u],i[u]=a):n[u]=new Xd(t,s[u]);for(;u<y;++u)(a=e[u])&&(r[u]=a)}function HI(t,e,n,i,r,s,u){var a,y,w=new Map,I=e.length,R=s.length,D=new Array(I),U;for(a=0;a<I;++a)(y=e[a])&&(D[a]=U=u.call(y,y.__data__,a,e)+"",w.has(U)?r[a]=y:w.set(U,y));for(a=0;a<R;++a)U=u.call(t,s[a],a,s)+"",(y=w.get(U))?(i[a]=y,y.__data__=s[a],w.delete(U)):n[a]=new Xd(t,s[a]);for(a=0;a<I;++a)(y=e[a])&&w.get(D[a])===y&&(r[a]=y)}function WI(t){return t.__data__}function $I(t,e){if(!arguments.length)return Array.from(this,WI);var n=e?HI:jI,i=this._parents,r=this._groups;typeof t!="function"&&(t=GI(t));for(var s=r.length,u=new Array(s),a=new Array(s),y=new Array(s),w=0;w<s;++w){var I=i[w],R=r[w],D=R.length,U=qI(t.call(I,I&&I.__data__,w,i)),q=U.length,ne=a[w]=new Array(q),pe=u[w]=new Array(q),J=y[w]=new Array(D);n(I,R,ne,pe,J,U,e);for(var ie=0,re=0,ge,be;ie<q;++ie)if(ge=ne[ie]){for(ie>=re&&(re=ie+1);!(be=pe[re])&&++re<q;);ge._next=be||null}}return u=new Ss(u,i),u._enter=a,u._exit=y,u}function qI(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ZI(){return new Ss(this._exit||this._groups.map(Pw),this._parents)}function XI(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function QI(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,u=Math.min(r,s),a=new Array(r),y=0;y<u;++y)for(var w=n[y],I=i[y],R=w.length,D=a[y]=new Array(R),U,q=0;q<R;++q)(U=w[q]||I[q])&&(D[q]=U);for(;y<r;++y)a[y]=n[y];return new Ss(a,this._parents)}function YI(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],u;--r>=0;)(u=i[r])&&(s&&u.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(u,s),s=u);return this}function KI(t){t||(t=JI);function e(R,D){return R&&D?t(R.__data__,D.__data__):!R-!D}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var u=n[s],a=u.length,y=r[s]=new Array(a),w,I=0;I<a;++I)(w=u[I])&&(y[I]=w);y.sort(e)}return new Ss(r,this._parents).order()}function JI(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ek(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function tk(){return Array.from(this)}function nk(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var u=i[r];if(u)return u}return null}function ik(){let t=0;for(const e of this)++t;return t}function rk(){return!this.node()}function sk(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,u=r.length,a;s<u;++s)(a=r[s])&&t.call(a,a.__data__,s,r);return this}function ok(t){return function(){this.removeAttribute(t)}}function ak(t){return function(){this.removeAttributeNS(t.space,t.local)}}function lk(t,e){return function(){this.setAttribute(t,e)}}function ck(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function uk(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function hk(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function fk(t,e){var n=n3(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?ak:ok:typeof e=="function"?n.local?hk:uk:n.local?ck:lk)(n,e))}function Mw(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ak(t){return function(){this.style.removeProperty(t)}}function dk(t,e,n){return function(){this.style.setProperty(t,e,n)}}function pk(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function mk(t,e,n){return arguments.length>1?this.each((e==null?Ak:typeof e=="function"?pk:dk)(t,e,n??"")):r1(this.node(),t)}function r1(t,e){return t.style.getPropertyValue(e)||Mw(t).getComputedStyle(t,null).getPropertyValue(e)}function gk(t){return function(){delete this[t]}}function _k(t,e){return function(){this[t]=e}}function yk(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function vk(t,e){return arguments.length>1?this.each((e==null?gk:typeof e=="function"?yk:_k)(t,e)):this.node()[t]}function Iw(t){return t.trim().split(/^|\s+/)}function U6(t){return t.classList||new kw(t)}function kw(t){this._node=t,this._names=Iw(t.getAttribute("class")||"")}kw.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Lw(t,e){for(var n=U6(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Dw(t,e){for(var n=U6(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function xk(t){return function(){Lw(this,t)}}function wk(t){return function(){Dw(this,t)}}function bk(t,e){return function(){(e.apply(this,arguments)?Lw:Dw)(this,t)}}function Ek(t,e){var n=Iw(t+"");if(arguments.length<2){for(var i=U6(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?bk:e?xk:wk)(n,e))}function Tk(){this.textContent=""}function Sk(t){return function(){this.textContent=t}}function Ck(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Pk(t){return arguments.length?this.each(t==null?Tk:(typeof t=="function"?Ck:Sk)(t)):this.node().textContent}function Mk(){this.innerHTML=""}function Ik(t){return function(){this.innerHTML=t}}function kk(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Lk(t){return arguments.length?this.each(t==null?Mk:(typeof t=="function"?kk:Ik)(t)):this.node().innerHTML}function Dk(){this.nextSibling&&this.parentNode.appendChild(this)}function Rk(){return this.each(Dk)}function zk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Bk(){return this.each(zk)}function Ok(t){var e=typeof t=="function"?t:bw(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Fk(){return null}function Nk(t,e){var n=typeof t=="function"?t:bw(t),i=e==null?Fk:typeof e=="function"?e:N6(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Uk(){var t=this.parentNode;t&&t.removeChild(this)}function Vk(){return this.each(Uk)}function Gk(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function jk(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Hk(t){return this.select(t?jk:Gk)}function Wk(t){return arguments.length?this.property("__data__",t):this.node().__data__}function $k(t){return function(e){t.call(this,e,this.__data__)}}function qk(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Zk(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function Xk(t,e,n){return function(){var i=this.__on,r,s=$k(e);if(i){for(var u=0,a=i.length;u<a;++u)if((r=i[u]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function Qk(t,e,n){var i=qk(t+""),r,s=i.length,u;if(arguments.length<2){var a=this.node().__on;if(a){for(var y=0,w=a.length,I;y<w;++y)for(r=0,I=a[y];r<s;++r)if((u=i[r]).type===I.type&&u.name===I.name)return I.value}return}for(a=e?Xk:Zk,r=0;r<s;++r)this.each(a(i[r],e,n));return this}function Rw(t,e,n){var i=Mw(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Yk(t,e){return function(){return Rw(this,t,e)}}function Kk(t,e){return function(){return Rw(this,t,e.apply(this,arguments))}}function Jk(t,e){return this.each((typeof e=="function"?Kk:Yk)(t,e))}function*eL(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,u;r<s;++r)(u=i[r])&&(yield u)}var V6=[null];function Ss(t,e){this._groups=t,this._parents=e}function M2(){return new Ss([[document.documentElement]],V6)}function tL(){return this}Ss.prototype=M2.prototype={constructor:Ss,select:PI,selectAll:kI,selectChild:zI,selectChildren:NI,filter:UI,data:$I,enter:VI,exit:ZI,join:XI,merge:QI,selection:tL,order:YI,sort:KI,call:ek,nodes:tk,node:nk,size:ik,empty:rk,each:sk,attr:fk,style:mk,property:vk,classed:Ek,text:Pk,html:Lk,raise:Rk,lower:Bk,append:Ok,insert:Nk,remove:Vk,clone:Hk,datum:Wk,on:Qk,dispatch:Jk,[Symbol.iterator]:eL};function ko(t){return typeof t=="string"?new Ss([[document.querySelector(t)]],[document.documentElement]):new Ss([[t]],V6)}function nL(t){return typeof t=="string"?new Ss([document.querySelectorAll(t)],[document.documentElement]):new Ss([Ew(t)],V6)}function G6(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function zw(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function I2(){}var Kf=.7,Qd=1/Kf,qh="\\s*([+-]?\\d+)\\s*",Jf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ya="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",iL=/^#([0-9a-f]{3,8})$/,rL=new RegExp(`^rgb\\(${qh},${qh},${qh}\\)$`),sL=new RegExp(`^rgb\\(${Ya},${Ya},${Ya}\\)$`),oL=new RegExp(`^rgba\\(${qh},${qh},${qh},${Jf}\\)$`),aL=new RegExp(`^rgba\\(${Ya},${Ya},${Ya},${Jf}\\)$`),lL=new RegExp(`^hsl\\(${Jf},${Ya},${Ya}\\)$`),cL=new RegExp(`^hsla\\(${Jf},${Ya},${Ya},${Jf}\\)$`),_9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};G6(I2,ru,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:y9,formatHex:y9,formatHex8:uL,formatHsl:hL,formatRgb:v9,toString:v9});function y9(){return this.rgb().formatHex()}function uL(){return this.rgb().formatHex8()}function hL(){return Bw(this).formatHsl()}function v9(){return this.rgb().formatRgb()}function ru(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=iL.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?x9(e):n===3?new Ns(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?yA(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?yA(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=rL.exec(t))?new Ns(e[1],e[2],e[3],1):(e=sL.exec(t))?new Ns(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=oL.exec(t))?yA(e[1],e[2],e[3],e[4]):(e=aL.exec(t))?yA(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=lL.exec(t))?E9(e[1],e[2]/100,e[3]/100,1):(e=cL.exec(t))?E9(e[1],e[2]/100,e[3]/100,e[4]):_9.hasOwnProperty(t)?x9(_9[t]):t==="transparent"?new Ns(NaN,NaN,NaN,0):null}function x9(t){return new Ns(t>>16&255,t>>8&255,t&255,1)}function yA(t,e,n,i){return i<=0&&(t=e=n=NaN),new Ns(t,e,n,i)}function fL(t){return t instanceof I2||(t=ru(t)),t?(t=t.rgb(),new Ns(t.r,t.g,t.b,t.opacity)):new Ns}function Yd(t,e,n,i){return arguments.length===1?fL(t):new Ns(t,e,n,i??1)}function Ns(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}G6(Ns,Yd,zw(I2,{brighter(t){return t=t==null?Qd:Math.pow(Qd,t),new Ns(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Kf:Math.pow(Kf,t),new Ns(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ns(eu(this.r),eu(this.g),eu(this.b),Kd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w9,formatHex:w9,formatHex8:AL,formatRgb:b9,toString:b9}));function w9(){return`#${Xc(this.r)}${Xc(this.g)}${Xc(this.b)}`}function AL(){return`#${Xc(this.r)}${Xc(this.g)}${Xc(this.b)}${Xc((isNaN(this.opacity)?1:this.opacity)*255)}`}function b9(){const t=Kd(this.opacity);return`${t===1?"rgb(":"rgba("}${eu(this.r)}, ${eu(this.g)}, ${eu(this.b)}${t===1?")":`, ${t})`}`}function Kd(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function eu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Xc(t){return t=eu(t),(t<16?"0":"")+t.toString(16)}function E9(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ua(t,e,n,i)}function Bw(t){if(t instanceof ua)return new ua(t.h,t.s,t.l,t.opacity);if(t instanceof I2||(t=ru(t)),!t)return new ua;if(t instanceof ua)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),u=NaN,a=s-r,y=(s+r)/2;return a?(e===s?u=(n-i)/a+(n<i)*6:n===s?u=(i-e)/a+2:u=(e-n)/a+4,a/=y<.5?s+r:2-s-r,u*=60):a=y>0&&y<1?0:u,new ua(u,a,y,t.opacity)}function dL(t,e,n,i){return arguments.length===1?Bw(t):new ua(t,e,n,i??1)}function ua(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}G6(ua,dL,zw(I2,{brighter(t){return t=t==null?Qd:Math.pow(Qd,t),new ua(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Kf:Math.pow(Kf,t),new ua(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Ns(bm(t>=240?t-240:t+120,r,i),bm(t,r,i),bm(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new ua(T9(this.h),vA(this.s),vA(this.l),Kd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Kd(this.opacity);return`${t===1?"hsl(":"hsla("}${T9(this.h)}, ${vA(this.s)*100}%, ${vA(this.l)*100}%${t===1?")":`, ${t})`}`}}));function T9(t){return t=(t||0)%360,t<0?t+360:t}function vA(t){return Math.max(0,Math.min(1,t||0))}function bm(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function pL(t,e,n,i,r){var s=t*t,u=s*t;return((1-3*t+3*s-u)*e+(4-6*s+3*u)*n+(1+3*t+3*s-3*u)*i+u*r)/6}function mL(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],u=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return pL((n-i/e)*e,u,r,s,a)}}const j6=t=>()=>t;function gL(t,e){return function(n){return t+n*e}}function _L(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function yL(t){return(t=+t)==1?Ow:function(e,n){return n-e?_L(e,n,t):j6(isNaN(e)?n:e)}}function Ow(t,e){var n=e-t;return n?gL(t,n):j6(isNaN(t)?e:t)}const Jd=function t(e){var n=yL(e);function i(r,s){var u=n((r=Yd(r)).r,(s=Yd(s)).r),a=n(r.g,s.g),y=n(r.b,s.b),w=Ow(r.opacity,s.opacity);return function(I){return r.r=u(I),r.g=a(I),r.b=y(I),r.opacity=w(I),r+""}}return i.gamma=t,i}(1);function vL(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),s=new Array(n),u,a;for(u=0;u<n;++u)a=Yd(e[u]),i[u]=a.r||0,r[u]=a.g||0,s[u]=a.b||0;return i=t(i),r=t(r),s=t(s),a.opacity=1,function(y){return a.r=i(y),a.g=r(y),a.b=s(y),a+""}}}var xL=vL(mL);function wL(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function bL(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function EL(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),u;for(u=0;u<i;++u)r[u]=i3(t[u],e[u]);for(;u<n;++u)s[u]=e[u];return function(a){for(u=0;u<i;++u)s[u]=r[u](a);return s}}function TL(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function la(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function SL(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=i3(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var Q4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Em=new RegExp(Q4.source,"g");function CL(t){return function(){return t}}function PL(t){return function(e){return t(e)+""}}function Fw(t,e){var n=Q4.lastIndex=Em.lastIndex=0,i,r,s,u=-1,a=[],y=[];for(t=t+"",e=e+"";(i=Q4.exec(t))&&(r=Em.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),a[u]?a[u]+=s:a[++u]=s),(i=i[0])===(r=r[0])?a[u]?a[u]+=r:a[++u]=r:(a[++u]=null,y.push({i:u,x:la(i,r)})),n=Em.lastIndex;return n<e.length&&(s=e.slice(n),a[u]?a[u]+=s:a[++u]=s),a.length<2?y[0]?PL(y[0].x):CL(e):(e=y.length,function(w){for(var I=0,R;I<e;++I)a[(R=y[I]).i]=R.x(w);return a.join("")})}function i3(t,e){var n=typeof e,i;return e==null||n==="boolean"?j6(e):(n==="number"?la:n==="string"?(i=ru(e))?(e=i,Jd):Fw:e instanceof ru?Jd:e instanceof Date?TL:bL(e)?wL:Array.isArray(e)?EL:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?SL:la)(t,e)}function ML(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var S9=180/Math.PI,Y4={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Nw(t,e,n,i,r,s){var u,a,y;return(u=Math.sqrt(t*t+e*e))&&(t/=u,e/=u),(y=t*n+e*i)&&(n-=t*y,i-=e*y),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,y/=a),t*i<e*n&&(t=-t,e=-e,y=-y,u=-u),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*S9,skewX:Math.atan(y)*S9,scaleX:u,scaleY:a}}var xA;function IL(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Y4:Nw(e.a,e.b,e.c,e.d,e.e,e.f)}function kL(t){return t==null||(xA||(xA=document.createElementNS("http://www.w3.org/2000/svg","g")),xA.setAttribute("transform",t),!(t=xA.transform.baseVal.consolidate()))?Y4:(t=t.matrix,Nw(t.a,t.b,t.c,t.d,t.e,t.f))}function Uw(t,e,n,i){function r(w){return w.length?w.pop()+" ":""}function s(w,I,R,D,U,q){if(w!==R||I!==D){var ne=U.push("translate(",null,e,null,n);q.push({i:ne-4,x:la(w,R)},{i:ne-2,x:la(I,D)})}else(R||D)&&U.push("translate("+R+e+D+n)}function u(w,I,R,D){w!==I?(w-I>180?I+=360:I-w>180&&(w+=360),D.push({i:R.push(r(R)+"rotate(",null,i)-2,x:la(w,I)})):I&&R.push(r(R)+"rotate("+I+i)}function a(w,I,R,D){w!==I?D.push({i:R.push(r(R)+"skewX(",null,i)-2,x:la(w,I)}):I&&R.push(r(R)+"skewX("+I+i)}function y(w,I,R,D,U,q){if(w!==R||I!==D){var ne=U.push(r(U)+"scale(",null,",",null,")");q.push({i:ne-4,x:la(w,R)},{i:ne-2,x:la(I,D)})}else(R!==1||D!==1)&&U.push(r(U)+"scale("+R+","+D+")")}return function(w,I){var R=[],D=[];return w=t(w),I=t(I),s(w.translateX,w.translateY,I.translateX,I.translateY,R,D),u(w.rotate,I.rotate,R,D),a(w.skewX,I.skewX,R,D),y(w.scaleX,w.scaleY,I.scaleX,I.scaleY,R,D),w=I=null,function(U){for(var q=-1,ne=D.length,pe;++q<ne;)R[(pe=D[q]).i]=pe.x(U);return R.join("")}}}var LL=Uw(IL,"px, ","px)","deg)"),DL=Uw(kL,", ",")",")"),s1=0,Sf=0,nf=0,Vw=1e3,ep,Cf,tp=0,su=0,r3=0,e2=typeof performance=="object"&&performance.now?performance:Date,Gw=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function H6(){return su||(Gw(RL),su=e2.now()+r3)}function RL(){su=0}function np(){this._call=this._time=this._next=null}np.prototype=jw.prototype={constructor:np,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?H6():+n)+(e==null?0:+e),!this._next&&Cf!==this&&(Cf?Cf._next=this:ep=this,Cf=this),this._call=t,this._time=n,K4()},stop:function(){this._call&&(this._call=null,this._time=1/0,K4())}};function jw(t,e,n){var i=new np;return i.restart(t,e,n),i}function zL(){H6(),++s1;for(var t=ep,e;t;)(e=su-t._time)>=0&&t._call.call(void 0,e),t=t._next;--s1}function C9(){su=(tp=e2.now())+r3,s1=Sf=0;try{zL()}finally{s1=0,OL(),su=0}}function BL(){var t=e2.now(),e=t-tp;e>Vw&&(r3-=e,tp=t)}function OL(){for(var t,e=ep,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:ep=n);Cf=t,K4(i)}function K4(t){if(!s1){Sf&&(Sf=clearTimeout(Sf));var e=t-su;e>24?(t<1/0&&(Sf=setTimeout(C9,t-e2.now()-r3)),nf&&(nf=clearInterval(nf))):(nf||(tp=e2.now(),nf=setInterval(BL,Vw)),s1=1,Gw(C9))}}function P9(t,e,n){var i=new np;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var FL=ww("start","end","cancel","interrupt"),NL=[],Hw=0,M9=1,J4=2,vd=3,I9=4,e5=5,xd=6;function s3(t,e,n,i,r,s){var u=t.__transition;if(!u)t.__transition={};else if(n in u)return;UL(t,n,{name:e,index:i,group:r,on:FL,tween:NL,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Hw})}function W6(t,e){var n=va(t,e);if(n.state>Hw)throw new Error("too late; already scheduled");return n}function nl(t,e){var n=va(t,e);if(n.state>vd)throw new Error("too late; already running");return n}function va(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function UL(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=jw(s,0,n.time);function s(w){n.state=M9,n.timer.restart(u,n.delay,n.time),n.delay<=w&&u(w-n.delay)}function u(w){var I,R,D,U;if(n.state!==M9)return y();for(I in i)if(U=i[I],U.name===n.name){if(U.state===vd)return P9(u);U.state===I9?(U.state=xd,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete i[I]):+I<e&&(U.state=xd,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete i[I])}if(P9(function(){n.state===vd&&(n.state=I9,n.timer.restart(a,n.delay,n.time),a(w))}),n.state=J4,n.on.call("start",t,t.__data__,n.index,n.group),n.state===J4){for(n.state=vd,r=new Array(D=n.tween.length),I=0,R=-1;I<D;++I)(U=n.tween[I].value.call(t,t.__data__,n.index,n.group))&&(r[++R]=U);r.length=R+1}}function a(w){for(var I=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(y),n.state=e5,1),R=-1,D=r.length;++R<D;)r[R].call(t,I);n.state===e5&&(n.on.call("end",t,t.__data__,n.index,n.group),y())}function y(){n.state=xd,n.timer.stop(),delete i[e];for(var w in i)return;delete t.__transition}}function VL(t,e){var n=t.__transition,i,r,s=!0,u;if(n){e=e==null?null:e+"";for(u in n){if((i=n[u]).name!==e){s=!1;continue}r=i.state>J4&&i.state<e5,i.state=xd,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[u]}s&&delete t.__transition}}function GL(t){return this.each(function(){VL(this,t)})}function jL(t,e){var n,i;return function(){var r=nl(this,t),s=r.tween;if(s!==n){i=n=s;for(var u=0,a=i.length;u<a;++u)if(i[u].name===e){i=i.slice(),i.splice(u,1);break}}r.tween=i}}function HL(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=nl(this,t),u=s.tween;if(u!==i){r=(i=u).slice();for(var a={name:e,value:n},y=0,w=r.length;y<w;++y)if(r[y].name===e){r[y]=a;break}y===w&&r.push(a)}s.tween=r}}function WL(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=va(this.node(),n).tween,r=0,s=i.length,u;r<s;++r)if((u=i[r]).name===t)return u.value;return null}return this.each((e==null?jL:HL)(n,t,e))}function $6(t,e,n){var i=t._id;return t.each(function(){var r=nl(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return va(r,i).value[e]}}function Ww(t,e){var n;return(typeof e=="number"?la:e instanceof ru?Jd:(n=ru(e))?(e=n,Jd):Fw)(t,e)}function $L(t){return function(){this.removeAttribute(t)}}function qL(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ZL(t,e,n){var i,r=n+"",s;return function(){var u=this.getAttribute(t);return u===r?null:u===i?s:s=e(i=u,n)}}function XL(t,e,n){var i,r=n+"",s;return function(){var u=this.getAttributeNS(t.space,t.local);return u===r?null:u===i?s:s=e(i=u,n)}}function QL(t,e,n){var i,r,s;return function(){var u,a=n(this),y;return a==null?void this.removeAttribute(t):(u=this.getAttribute(t),y=a+"",u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a)))}}function YL(t,e,n){var i,r,s;return function(){var u,a=n(this),y;return a==null?void this.removeAttributeNS(t.space,t.local):(u=this.getAttributeNS(t.space,t.local),y=a+"",u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a)))}}function KL(t,e){var n=n3(t),i=n==="transform"?DL:Ww;return this.attrTween(t,typeof e=="function"?(n.local?YL:QL)(n,i,$6(this,"attr."+t,e)):e==null?(n.local?qL:$L)(n):(n.local?XL:ZL)(n,i,e))}function JL(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function eD(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function tD(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&eD(t,s)),n}return r._value=e,r}function nD(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&JL(t,s)),n}return r._value=e,r}function iD(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=n3(t);return this.tween(n,(i.local?tD:nD)(i,e))}function rD(t,e){return function(){W6(this,t).delay=+e.apply(this,arguments)}}function sD(t,e){return e=+e,function(){W6(this,t).delay=e}}function oD(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?rD:sD)(e,t)):va(this.node(),e).delay}function aD(t,e){return function(){nl(this,t).duration=+e.apply(this,arguments)}}function lD(t,e){return e=+e,function(){nl(this,t).duration=e}}function cD(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?aD:lD)(e,t)):va(this.node(),e).duration}function uD(t,e){if(typeof e!="function")throw new Error;return function(){nl(this,t).ease=e}}function hD(t){var e=this._id;return arguments.length?this.each(uD(e,t)):va(this.node(),e).ease}function fD(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;nl(this,t).ease=n}}function AD(t){if(typeof t!="function")throw new Error;return this.each(fD(this._id,t))}function dD(t){typeof t!="function"&&(t=Sw(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=[],y,w=0;w<u;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new Kl(i,this._parents,this._name,this._id)}function pD(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),u=new Array(i),a=0;a<s;++a)for(var y=e[a],w=n[a],I=y.length,R=u[a]=new Array(I),D,U=0;U<I;++U)(D=y[U]||w[U])&&(R[U]=D);for(;a<i;++a)u[a]=e[a];return new Kl(u,this._parents,this._name,this._id)}function mD(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function gD(t,e,n){var i,r,s=mD(e)?W6:nl;return function(){var u=s(this,t),a=u.on;a!==i&&(r=(i=a).copy()).on(e,n),u.on=r}}function _D(t,e){var n=this._id;return arguments.length<2?va(this.node(),n).on.on(t):this.each(gD(n,t,e))}function yD(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function vD(){return this.on("end.remove",yD(this._id))}function xD(t){var e=this._name,n=this._id;typeof t!="function"&&(t=N6(t));for(var i=this._groups,r=i.length,s=new Array(r),u=0;u<r;++u)for(var a=i[u],y=a.length,w=s[u]=new Array(y),I,R,D=0;D<y;++D)(I=a[D])&&(R=t.call(I,I.__data__,D,a))&&("__data__"in I&&(R.__data__=I.__data__),w[D]=R,s3(w[D],e,n,D,w,va(I,n)));return new Kl(s,this._parents,e,n)}function wD(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Tw(t));for(var i=this._groups,r=i.length,s=[],u=[],a=0;a<r;++a)for(var y=i[a],w=y.length,I,R=0;R<w;++R)if(I=y[R]){for(var D=t.call(I,I.__data__,R,y),U,q=va(I,n),ne=0,pe=D.length;ne<pe;++ne)(U=D[ne])&&s3(U,e,n,ne,D,q);s.push(D),u.push(I)}return new Kl(s,u,e,n)}var bD=M2.prototype.constructor;function ED(){return new bD(this._groups,this._parents)}function TD(t,e){var n,i,r;return function(){var s=r1(this,t),u=(this.style.removeProperty(t),r1(this,t));return s===u?null:s===n&&u===i?r:r=e(n=s,i=u)}}function $w(t){return function(){this.style.removeProperty(t)}}function SD(t,e,n){var i,r=n+"",s;return function(){var u=r1(this,t);return u===r?null:u===i?s:s=e(i=u,n)}}function CD(t,e,n){var i,r,s;return function(){var u=r1(this,t),a=n(this),y=a+"";return a==null&&(y=a=(this.style.removeProperty(t),r1(this,t))),u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a))}}function PD(t,e){var n,i,r,s="style."+e,u="end."+s,a;return function(){var y=nl(this,t),w=y.on,I=y.value[s]==null?a||(a=$w(e)):void 0;(w!==n||r!==I)&&(i=(n=w).copy()).on(u,r=I),y.on=i}}function MD(t,e,n){var i=(t+="")=="transform"?LL:Ww;return e==null?this.styleTween(t,TD(t,i)).on("end.style."+t,$w(t)):typeof e=="function"?this.styleTween(t,CD(t,i,$6(this,"style."+t,e))).each(PD(this._id,t)):this.styleTween(t,SD(t,i,e),n).on("end.style."+t,null)}function ID(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function kD(t,e,n){var i,r;function s(){var u=e.apply(this,arguments);return u!==r&&(i=(r=u)&&ID(t,u,n)),i}return s._value=e,s}function LD(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,kD(t,e,n??""))}function DD(t){return function(){this.textContent=t}}function RD(t){return function(){var e=t(this);this.textContent=e??""}}function zD(t){return this.tween("text",typeof t=="function"?RD($6(this,"text",t)):DD(t==null?"":t+""))}function BD(t){return function(e){this.textContent=t.call(this,e)}}function OD(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&BD(r)),e}return i._value=t,i}function FD(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,OD(t))}function ND(){for(var t=this._name,e=this._id,n=qw(),i=this._groups,r=i.length,s=0;s<r;++s)for(var u=i[s],a=u.length,y,w=0;w<a;++w)if(y=u[w]){var I=va(y,e);s3(y,t,n,w,u,{time:I.time+I.delay+I.duration,delay:0,duration:I.duration,ease:I.ease})}return new Kl(i,this._parents,t,n)}function UD(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,u){var a={value:u},y={value:function(){--r===0&&s()}};n.each(function(){var w=nl(this,i),I=w.on;I!==t&&(e=(t=I).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(y)),w.on=e}),r===0&&s()})}var VD=0;function Kl(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function qw(){return++VD}var zl=M2.prototype;Kl.prototype={constructor:Kl,select:xD,selectAll:wD,selectChild:zl.selectChild,selectChildren:zl.selectChildren,filter:dD,merge:pD,selection:ED,transition:ND,call:zl.call,nodes:zl.nodes,node:zl.node,size:zl.size,empty:zl.empty,each:zl.each,on:_D,attr:KL,attrTween:iD,style:MD,styleTween:LD,text:zD,textTween:FD,remove:vD,tween:WL,delay:oD,duration:cD,ease:hD,easeVarying:AD,end:UD,[Symbol.iterator]:zl[Symbol.iterator]};function GD(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var q6=1.70158;(function t(e){e=+e;function n(i){return(i=+i)*i*(e*(i-1)+i)}return n.overshoot=t,n})(q6);var k9=function t(e){e=+e;function n(i){return--i*i*((i+1)*e+i)+1}return n.overshoot=t,n}(q6);(function t(e){e=+e;function n(i){return((i*=2)<1?i*i*((e+1)*i-e):(i-=2)*i*((e+1)*i+e)+2)/2}return n.overshoot=t,n})(q6);var jD={time:null,delay:0,duration:250,ease:GD};function HD(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function WD(t){var e,n;t instanceof Kl?(e=t._id,t=t._name):(e=qw(),(n=jD).time=H6(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var u=i[s],a=u.length,y,w=0;w<a;++w)(y=u[w])&&s3(y,t,e,w,u,n||HD(y,e));return new Kl(i,this._parents,t,e)}M2.prototype.interrupt=GL;M2.prototype.transition=WD;const t5=Math.PI,n5=2*t5,Wc=1e-6,$D=n5-Wc;function Zw(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function qD(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Zw;const n=10**e;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}class ZD{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Zw:qD(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,i,r){this._append`Q${+e},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(e,n,i,r,s,u){this._append`C${+e},${+n},${+i},${+r},${this._x1=+s},${this._y1=+u}`}arcTo(e,n,i,r,s){if(e=+e,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let u=this._x1,a=this._y1,y=i-e,w=r-n,I=u-e,R=a-n,D=I*I+R*R;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(D>Wc)if(!(Math.abs(R*y-w*I)>Wc)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let U=i-u,q=r-a,ne=y*y+w*w,pe=U*U+q*q,J=Math.sqrt(ne),ie=Math.sqrt(D),re=s*Math.tan((t5-Math.acos((ne+D-pe)/(2*J*ie)))/2),ge=re/ie,be=re/J;Math.abs(ge-1)>Wc&&this._append`L${e+ge*I},${n+ge*R}`,this._append`A${s},${s},0,0,${+(R*U>I*q)},${this._x1=e+be*y},${this._y1=n+be*w}`}}arc(e,n,i,r,s,u){if(e=+e,n=+n,i=+i,u=!!u,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),y=i*Math.sin(r),w=e+a,I=n+y,R=1^u,D=u?r-s:s-r;this._x1===null?this._append`M${w},${I}`:(Math.abs(this._x1-w)>Wc||Math.abs(this._y1-I)>Wc)&&this._append`L${w},${I}`,i&&(D<0&&(D=D%n5+n5),D>$D?this._append`A${i},${i},0,1,${R},${e-a},${n-y}A${i},${i},0,1,${R},${this._x1=w},${this._y1=I}`:D>Wc&&this._append`A${i},${i},0,${+(D>=t5)},${R},${this._x1=e+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(e,n,i,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}function XD(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ip(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function o1(t){return t=ip(Math.abs(t)),t?t[1]:NaN}function QD(t,e){return function(n,i){for(var r=n.length,s=[],u=0,a=t[0],y=0;r>0&&a>0&&(y+a+1>i&&(a=Math.max(1,i-y)),s.push(n.substring(r-=a,r+a)),!((y+=a+1)>i));)a=t[u=(u+1)%t.length];return s.reverse().join(e)}}function YD(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var KD=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rp(t){if(!(e=KD.exec(t)))throw new Error("invalid format: "+t);var e;return new Z6({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}rp.prototype=Z6.prototype;function Z6(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Z6.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function JD(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var Xw;function eR(t,e){var n=ip(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(Xw=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,u=i.length;return s===u?i:s>u?i+new Array(s-u+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+ip(t,Math.max(0,e+s-1))[0]}function L9(t,e){var n=ip(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const D9={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:XD,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>L9(t*100,e),r:L9,s:eR,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function R9(t){return t}var z9=Array.prototype.map,B9=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function tR(t){var e=t.grouping===void 0||t.thousands===void 0?R9:QD(z9.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?R9:YD(z9.call(t.numerals,String)),u=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",y=t.nan===void 0?"NaN":t.nan+"";function w(R){R=rp(R);var D=R.fill,U=R.align,q=R.sign,ne=R.symbol,pe=R.zero,J=R.width,ie=R.comma,re=R.precision,ge=R.trim,be=R.type;be==="n"?(ie=!0,be="g"):D9[be]||(re===void 0&&(re=12),ge=!0,be="g"),(pe||D==="0"&&U==="=")&&(pe=!0,D="0",U="=");var De=ne==="$"?n:ne==="#"&&/[boxX]/.test(be)?"0"+be.toLowerCase():"",qe=ne==="$"?i:/[%p]/.test(be)?u:"",et=D9[be],ht=/[defgprs%]/.test(be);re=re===void 0?6:/[gprs]/.test(be)?Math.max(1,Math.min(21,re)):Math.max(0,Math.min(20,re));function ot(at){var Mt=De,ut=qe,St,Pn,Ot;if(be==="c")ut=et(at)+ut,at="";else{at=+at;var Gn=at<0||1/at<0;if(at=isNaN(at)?y:et(Math.abs(at),re),ge&&(at=JD(at)),Gn&&+at==0&&q!=="+"&&(Gn=!1),Mt=(Gn?q==="("?q:a:q==="-"||q==="("?"":q)+Mt,ut=(be==="s"?B9[8+Xw/3]:"")+ut+(Gn&&q==="("?")":""),ht){for(St=-1,Pn=at.length;++St<Pn;)if(Ot=at.charCodeAt(St),48>Ot||Ot>57){ut=(Ot===46?r+at.slice(St+1):at.slice(St))+ut,at=at.slice(0,St);break}}}ie&&!pe&&(at=e(at,1/0));var vt=Mt.length+at.length+ut.length,Bt=vt<J?new Array(J-vt+1).join(D):"";switch(ie&&pe&&(at=e(Bt+at,Bt.length?J-ut.length:1/0),Bt=""),U){case"<":at=Mt+at+ut+Bt;break;case"=":at=Mt+Bt+at+ut;break;case"^":at=Bt.slice(0,vt=Bt.length>>1)+Mt+at+ut+Bt.slice(vt);break;default:at=Bt+Mt+at+ut;break}return s(at)}return ot.toString=function(){return R+""},ot}function I(R,D){var U=w((R=rp(R),R.type="f",R)),q=Math.max(-8,Math.min(8,Math.floor(o1(D)/3)))*3,ne=Math.pow(10,-q),pe=B9[8+q/3];return function(J){return U(ne*J)+pe}}return{format:w,formatPrefix:I}}var wA,Qw,Yw;nR({thousands:",",grouping:[3],currency:["$",""]});function nR(t){return wA=tR(t),Qw=wA.format,Yw=wA.formatPrefix,wA}function iR(t){return Math.max(0,-o1(Math.abs(t)))}function rR(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(o1(e)/3)))*3-o1(Math.abs(t)))}function sR(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,o1(e)-o1(t))+1}function X6(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function oR(t){return function(){return t}}function aR(t){return+t}var O9=[0,1];function Th(t){return t}function i5(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:oR(isNaN(e)?NaN:.5)}function lR(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function cR(t,e,n){var i=t[0],r=t[1],s=e[0],u=e[1];return r<i?(i=i5(r,i),s=n(u,s)):(i=i5(i,r),s=n(s,u)),function(a){return s(i(a))}}function uR(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),u=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++u<i;)r[u]=i5(t[u],t[u+1]),s[u]=n(e[u],e[u+1]);return function(a){var y=vw(t,a,1,i)-1;return s[y](r[y](a))}}function Kw(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function hR(){var t=O9,e=O9,n=i3,i,r,s,u=Th,a,y,w;function I(){var D=Math.min(t.length,e.length);return u!==Th&&(u=lR(t[0],t[D-1])),a=D>2?uR:cR,y=w=null,R}function R(D){return D==null||isNaN(D=+D)?s:(y||(y=a(t.map(i),e,n)))(i(u(D)))}return R.invert=function(D){return u(r((w||(w=a(e,t.map(i),la)))(D)))},R.domain=function(D){return arguments.length?(t=Array.from(D,aR),I()):t.slice()},R.range=function(D){return arguments.length?(e=Array.from(D),I()):e.slice()},R.rangeRound=function(D){return e=Array.from(D),n=ML,I()},R.clamp=function(D){return arguments.length?(u=D?!0:Th,I()):u!==Th},R.interpolate=function(D){return arguments.length?(n=D,I()):n},R.unknown=function(D){return arguments.length?(s=D,R):s},function(D,U){return i=D,r=U,I()}}function Jw(){return hR()(Th,Th)}function fR(t,e,n,i){var r=Z4(t,e,n),s;switch(i=rp(i??",f"),i.type){case"s":{var u=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(s=rR(r,u))&&(i.precision=s),Yw(i,u)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=sR(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=iR(r))&&(i.precision=s-(i.type==="%")*2);break}}return Qw(i)}function eb(t){var e=t.domain;return t.ticks=function(n){var i=e();return vI(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return fR(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,s=i.length-1,u=i[r],a=i[s],y,w,I=10;for(a<u&&(w=u,u=a,a=w,w=r,r=s,s=w);I-- >0;){if(w=q4(u,a,n),w===y)return i[r]=u,i[s]=a,e(i);if(w>0)u=Math.floor(u/w)*w,a=Math.ceil(a/w)*w;else if(w<0)u=Math.ceil(u*w)/w,a=Math.floor(a*w)/w;else break;y=w}return t},t}function ga(){var t=Jw();return t.copy=function(){return Kw(t,ga())},X6.apply(t,arguments),eb(t)}function AR(t,e){t=t.slice();var n=0,i=t.length-1,r=t[n],s=t[i],u;return s<r&&(u=n,n=i,i=u,u=r,r=s,s=u),t[n]=e.floor(r),t[i]=e.ceil(s),t}function T1(){var t=0,e=1,n=1,i=[.5],r=[0,1],s;function u(y){return y!=null&&y<=y?r[vw(i,y,0,n)]:s}function a(){var y=-1;for(i=new Array(n);++y<n;)i[y]=((y+1)*e-(y-n)*t)/(n+1);return u}return u.domain=function(y){return arguments.length?([t,e]=y,t=+t,e=+e,a()):[t,e]},u.range=function(y){return arguments.length?(n=(r=Array.from(y)).length-1,a()):r.slice()},u.invertExtent=function(y){var w=r.indexOf(y);return w<0?[NaN,NaN]:w<1?[t,i[0]]:w>=n?[i[n-1],e]:[i[w-1],i[w]]},u.unknown=function(y){return arguments.length&&(s=y),u},u.thresholds=function(){return i.slice()},u.copy=function(){return T1().domain([t,e]).range(r).unknown(s)},X6.apply(eb(u),arguments)}const Tm=new Date,Sm=new Date;function xr(t,e,n,i){function r(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(t(s=new Date(+s)),s),r.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),r.round=s=>{const u=r(s),a=r.ceil(s);return s-u<a-s?u:a},r.offset=(s,u)=>(e(s=new Date(+s),u==null?1:Math.floor(u)),s),r.range=(s,u,a)=>{const y=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<u)||!(a>0))return y;let w;do y.push(w=new Date(+s)),e(s,a),t(s);while(w<s&&s<u);return y},r.filter=s=>xr(u=>{if(u>=u)for(;t(u),!s(u);)u.setTime(u-1)},(u,a)=>{if(u>=u)if(a<0)for(;++a<=0;)for(;e(u,-1),!s(u););else for(;--a>=0;)for(;e(u,1),!s(u););}),n&&(r.count=(s,u)=>(Tm.setTime(+s),Sm.setTime(+u),t(Tm),t(Sm),Math.floor(n(Tm,Sm))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?u=>i(u)%s===0:u=>r.count(0,u)%s===0):r)),r}const sp=xr(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);sp.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?xr(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):sp);sp.range;const Hl=1e3,Oo=Hl*60,Wl=Oo*60,Jl=Wl*24,Q6=Jl*7,F9=Jl*30,Cm=Jl*365,Sh=xr(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Hl)},(t,e)=>(e-t)/Hl,t=>t.getUTCSeconds());Sh.range;const Y6=xr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Hl)},(t,e)=>{t.setTime(+t+e*Oo)},(t,e)=>(e-t)/Oo,t=>t.getMinutes());Y6.range;const dR=xr(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Oo)},(t,e)=>(e-t)/Oo,t=>t.getUTCMinutes());dR.range;const K6=xr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Hl-t.getMinutes()*Oo)},(t,e)=>{t.setTime(+t+e*Wl)},(t,e)=>(e-t)/Wl,t=>t.getHours());K6.range;const pR=xr(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Wl)},(t,e)=>(e-t)/Wl,t=>t.getUTCHours());pR.range;const k2=xr(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Oo)/Jl,t=>t.getDate()-1);k2.range;const J6=xr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Jl,t=>t.getUTCDate()-1);J6.range;const mR=xr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Jl,t=>Math.floor(t/Jl));mR.range;function yu(t){return xr(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Oo)/Q6)}const o3=yu(0),op=yu(1),gR=yu(2),_R=yu(3),a1=yu(4),yR=yu(5),vR=yu(6);o3.range;op.range;gR.range;_R.range;a1.range;yR.range;vR.range;function vu(t){return xr(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/Q6)}const tb=vu(0),ap=vu(1),xR=vu(2),wR=vu(3),l1=vu(4),bR=vu(5),ER=vu(6);tb.range;ap.range;xR.range;wR.range;l1.range;bR.range;ER.range;const eg=xr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());eg.range;const TR=xr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());TR.range;const e0=xr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());e0.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xr(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});e0.range;const ou=xr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ou.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xr(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});ou.range;function SR(t,e,n,i,r,s){const u=[[Sh,1,Hl],[Sh,5,5*Hl],[Sh,15,15*Hl],[Sh,30,30*Hl],[s,1,Oo],[s,5,5*Oo],[s,15,15*Oo],[s,30,30*Oo],[r,1,Wl],[r,3,3*Wl],[r,6,6*Wl],[r,12,12*Wl],[i,1,Jl],[i,2,2*Jl],[n,1,Q6],[e,1,F9],[e,3,3*F9],[t,1,Cm]];function a(w,I,R){const D=I<w;D&&([w,I]=[I,w]);const U=R&&typeof R.range=="function"?R:y(w,I,R),q=U?U.range(w,+I+1):[];return D?q.reverse():q}function y(w,I,R){const D=Math.abs(I-w)/R,U=O6(([,,pe])=>pe).right(u,D);if(U===u.length)return t.every(Z4(w/Cm,I/Cm,R));if(U===0)return sp.every(Math.max(Z4(w,I,R),1));const[q,ne]=u[D/u[U-1][2]<u[U][2]/D?U-1:U];return q.every(ne)}return[a,y]}const[CR,PR]=SR(e0,eg,o3,k2,K6,Y6);function Pm(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Mm(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function rf(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function MR(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,s=t.days,u=t.shortDays,a=t.months,y=t.shortMonths,w=sf(r),I=of(r),R=sf(s),D=of(s),U=sf(u),q=of(u),ne=sf(a),pe=of(a),J=sf(y),ie=of(y),re={a:Gn,A:vt,b:Bt,B:Qt,c:null,d:H9,e:H9,f:KR,g:lz,G:uz,H:XR,I:QR,j:YR,L:nb,m:JR,M:ez,p:Mn,q:bn,Q:q9,s:Z9,S:tz,u:nz,U:iz,V:rz,w:sz,W:oz,x:null,X:null,y:az,Y:cz,Z:hz,"%":$9},ge={a:pn,A:Nn,b:ti,B:Ue,c:null,d:W9,e:W9,f:pz,g:Tz,G:Cz,H:fz,I:Az,j:dz,L:rb,m:mz,M:gz,p:An,q:Un,Q:q9,s:Z9,S:_z,u:yz,U:vz,V:xz,w:wz,W:bz,x:null,X:null,y:Ez,Y:Sz,Z:Pz,"%":$9},be={a:ot,A:at,b:Mt,B:ut,c:St,d:G9,e:G9,f:WR,g:V9,G:U9,H:j9,I:j9,j:VR,L:HR,m:UR,M:GR,p:ht,q:NR,Q:qR,s:ZR,S:jR,u:RR,U:zR,V:BR,w:DR,W:OR,x:Pn,X:Ot,y:V9,Y:U9,Z:FR,"%":$R};re.x=De(n,re),re.X=De(i,re),re.c=De(e,re),ge.x=De(n,ge),ge.X=De(i,ge),ge.c=De(e,ge);function De(At,Xt){return function(yn){var mt=[],jn=-1,Bn=0,li=At.length,ei,ci,hr;for(yn instanceof Date||(yn=new Date(+yn));++jn<li;)At.charCodeAt(jn)===37&&(mt.push(At.slice(Bn,jn)),(ci=N9[ei=At.charAt(++jn)])!=null?ei=At.charAt(++jn):ci=ei==="e"?" ":"0",(hr=Xt[ei])&&(ei=hr(yn,ci)),mt.push(ei),Bn=jn+1);return mt.push(At.slice(Bn,jn)),mt.join("")}}function qe(At,Xt){return function(yn){var mt=rf(1900,void 0,1),jn=et(mt,At,yn+="",0),Bn,li;if(jn!=yn.length)return null;if("Q"in mt)return new Date(mt.Q);if("s"in mt)return new Date(mt.s*1e3+("L"in mt?mt.L:0));if(Xt&&!("Z"in mt)&&(mt.Z=0),"p"in mt&&(mt.H=mt.H%12+mt.p*12),mt.m===void 0&&(mt.m="q"in mt?mt.q:0),"V"in mt){if(mt.V<1||mt.V>53)return null;"w"in mt||(mt.w=1),"Z"in mt?(Bn=Mm(rf(mt.y,0,1)),li=Bn.getUTCDay(),Bn=li>4||li===0?ap.ceil(Bn):ap(Bn),Bn=J6.offset(Bn,(mt.V-1)*7),mt.y=Bn.getUTCFullYear(),mt.m=Bn.getUTCMonth(),mt.d=Bn.getUTCDate()+(mt.w+6)%7):(Bn=Pm(rf(mt.y,0,1)),li=Bn.getDay(),Bn=li>4||li===0?op.ceil(Bn):op(Bn),Bn=k2.offset(Bn,(mt.V-1)*7),mt.y=Bn.getFullYear(),mt.m=Bn.getMonth(),mt.d=Bn.getDate()+(mt.w+6)%7)}else("W"in mt||"U"in mt)&&("w"in mt||(mt.w="u"in mt?mt.u%7:"W"in mt?1:0),li="Z"in mt?Mm(rf(mt.y,0,1)).getUTCDay():Pm(rf(mt.y,0,1)).getDay(),mt.m=0,mt.d="W"in mt?(mt.w+6)%7+mt.W*7-(li+5)%7:mt.w+mt.U*7-(li+6)%7);return"Z"in mt?(mt.H+=mt.Z/100|0,mt.M+=mt.Z%100,Mm(mt)):Pm(mt)}}function et(At,Xt,yn,mt){for(var jn=0,Bn=Xt.length,li=yn.length,ei,ci;jn<Bn;){if(mt>=li)return-1;if(ei=Xt.charCodeAt(jn++),ei===37){if(ei=Xt.charAt(jn++),ci=be[ei in N9?Xt.charAt(jn++):ei],!ci||(mt=ci(At,yn,mt))<0)return-1}else if(ei!=yn.charCodeAt(mt++))return-1}return mt}function ht(At,Xt,yn){var mt=w.exec(Xt.slice(yn));return mt?(At.p=I.get(mt[0].toLowerCase()),yn+mt[0].length):-1}function ot(At,Xt,yn){var mt=U.exec(Xt.slice(yn));return mt?(At.w=q.get(mt[0].toLowerCase()),yn+mt[0].length):-1}function at(At,Xt,yn){var mt=R.exec(Xt.slice(yn));return mt?(At.w=D.get(mt[0].toLowerCase()),yn+mt[0].length):-1}function Mt(At,Xt,yn){var mt=J.exec(Xt.slice(yn));return mt?(At.m=ie.get(mt[0].toLowerCase()),yn+mt[0].length):-1}function ut(At,Xt,yn){var mt=ne.exec(Xt.slice(yn));return mt?(At.m=pe.get(mt[0].toLowerCase()),yn+mt[0].length):-1}function St(At,Xt,yn){return et(At,e,Xt,yn)}function Pn(At,Xt,yn){return et(At,n,Xt,yn)}function Ot(At,Xt,yn){return et(At,i,Xt,yn)}function Gn(At){return u[At.getDay()]}function vt(At){return s[At.getDay()]}function Bt(At){return y[At.getMonth()]}function Qt(At){return a[At.getMonth()]}function Mn(At){return r[+(At.getHours()>=12)]}function bn(At){return 1+~~(At.getMonth()/3)}function pn(At){return u[At.getUTCDay()]}function Nn(At){return s[At.getUTCDay()]}function ti(At){return y[At.getUTCMonth()]}function Ue(At){return a[At.getUTCMonth()]}function An(At){return r[+(At.getUTCHours()>=12)]}function Un(At){return 1+~~(At.getUTCMonth()/3)}return{format:function(At){var Xt=De(At+="",re);return Xt.toString=function(){return At},Xt},parse:function(At){var Xt=qe(At+="",!1);return Xt.toString=function(){return At},Xt},utcFormat:function(At){var Xt=De(At+="",ge);return Xt.toString=function(){return At},Xt},utcParse:function(At){var Xt=qe(At+="",!0);return Xt.toString=function(){return At},Xt}}}var N9={"-":"",_:" ",0:"0"},kr=/^\s*\d+/,IR=/^%/,kR=/[\\^$*+?|[\]().{}]/g;function hi(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function LR(t){return t.replace(kR,"\\$&")}function sf(t){return new RegExp("^(?:"+t.map(LR).join("|")+")","i")}function of(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function DR(t,e,n){var i=kr.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function RR(t,e,n){var i=kr.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function zR(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function BR(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function OR(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function U9(t,e,n){var i=kr.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function V9(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function FR(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function NR(t,e,n){var i=kr.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function UR(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function G9(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function VR(t,e,n){var i=kr.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function j9(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function GR(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function jR(t,e,n){var i=kr.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function HR(t,e,n){var i=kr.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function WR(t,e,n){var i=kr.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function $R(t,e,n){var i=IR.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function qR(t,e,n){var i=kr.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function ZR(t,e,n){var i=kr.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function H9(t,e){return hi(t.getDate(),e,2)}function XR(t,e){return hi(t.getHours(),e,2)}function QR(t,e){return hi(t.getHours()%12||12,e,2)}function YR(t,e){return hi(1+k2.count(e0(t),t),e,3)}function nb(t,e){return hi(t.getMilliseconds(),e,3)}function KR(t,e){return nb(t,e)+"000"}function JR(t,e){return hi(t.getMonth()+1,e,2)}function ez(t,e){return hi(t.getMinutes(),e,2)}function tz(t,e){return hi(t.getSeconds(),e,2)}function nz(t){var e=t.getDay();return e===0?7:e}function iz(t,e){return hi(o3.count(e0(t)-1,t),e,2)}function ib(t){var e=t.getDay();return e>=4||e===0?a1(t):a1.ceil(t)}function rz(t,e){return t=ib(t),hi(a1.count(e0(t),t)+(e0(t).getDay()===4),e,2)}function sz(t){return t.getDay()}function oz(t,e){return hi(op.count(e0(t)-1,t),e,2)}function az(t,e){return hi(t.getFullYear()%100,e,2)}function lz(t,e){return t=ib(t),hi(t.getFullYear()%100,e,2)}function cz(t,e){return hi(t.getFullYear()%1e4,e,4)}function uz(t,e){var n=t.getDay();return t=n>=4||n===0?a1(t):a1.ceil(t),hi(t.getFullYear()%1e4,e,4)}function hz(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+hi(e/60|0,"0",2)+hi(e%60,"0",2)}function W9(t,e){return hi(t.getUTCDate(),e,2)}function fz(t,e){return hi(t.getUTCHours(),e,2)}function Az(t,e){return hi(t.getUTCHours()%12||12,e,2)}function dz(t,e){return hi(1+J6.count(ou(t),t),e,3)}function rb(t,e){return hi(t.getUTCMilliseconds(),e,3)}function pz(t,e){return rb(t,e)+"000"}function mz(t,e){return hi(t.getUTCMonth()+1,e,2)}function gz(t,e){return hi(t.getUTCMinutes(),e,2)}function _z(t,e){return hi(t.getUTCSeconds(),e,2)}function yz(t){var e=t.getUTCDay();return e===0?7:e}function vz(t,e){return hi(tb.count(ou(t)-1,t),e,2)}function sb(t){var e=t.getUTCDay();return e>=4||e===0?l1(t):l1.ceil(t)}function xz(t,e){return t=sb(t),hi(l1.count(ou(t),t)+(ou(t).getUTCDay()===4),e,2)}function wz(t){return t.getUTCDay()}function bz(t,e){return hi(ap.count(ou(t)-1,t),e,2)}function Ez(t,e){return hi(t.getUTCFullYear()%100,e,2)}function Tz(t,e){return t=sb(t),hi(t.getUTCFullYear()%100,e,2)}function Sz(t,e){return hi(t.getUTCFullYear()%1e4,e,4)}function Cz(t,e){var n=t.getUTCDay();return t=n>=4||n===0?l1(t):l1.ceil(t),hi(t.getUTCFullYear()%1e4,e,4)}function Pz(){return"+0000"}function $9(){return"%"}function q9(t){return+t}function Z9(t){return Math.floor(+t/1e3)}var fh,ob;Mz({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Mz(t){return fh=MR(t),ob=fh.format,fh.parse,fh.utcFormat,fh.utcParse,fh}function Iz(t){return new Date(t)}function kz(t){return t instanceof Date?+t:+new Date(+t)}function ab(t,e,n,i,r,s,u,a,y,w){var I=Jw(),R=I.invert,D=I.domain,U=w(".%L"),q=w(":%S"),ne=w("%I:%M"),pe=w("%I %p"),J=w("%a %d"),ie=w("%b %d"),re=w("%B"),ge=w("%Y");function be(De){return(y(De)<De?U:a(De)<De?q:u(De)<De?ne:s(De)<De?pe:i(De)<De?r(De)<De?J:ie:n(De)<De?re:ge)(De)}return I.invert=function(De){return new Date(R(De))},I.domain=function(De){return arguments.length?D(Array.from(De,kz)):D().map(Iz)},I.ticks=function(De){var qe=D();return t(qe[0],qe[qe.length-1],De??10)},I.tickFormat=function(De,qe){return qe==null?be:w(qe)},I.nice=function(De){var qe=D();return(!De||typeof De.range!="function")&&(De=e(qe[0],qe[qe.length-1],De??10)),De?D(AR(qe,De)):I},I.copy=function(){return Kw(I,ab(t,e,n,i,r,s,u,a,y,w))},I}function Lz(){return X6.apply(ab(CR,PR,e0,eg,o3,k2,K6,Y6,Sh,ob).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function L2(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const D2=t=>xL(t[t.length-1]);var Dz=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(L2);const Rz=D2(Dz);var zz=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(L2);const Bz=D2(zz);var Oz=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(L2);const Fz=D2(Oz);var Nz=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(L2);const Uz=D2(Nz);var Vz=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(L2);const Gz=D2(Vz);function Os(t){return function(){return t}}const X9=Math.abs,Kr=Math.atan2,Uc=Math.cos,jz=Math.max,Im=Math.min,Ua=Math.sin,Ch=Math.sqrt,rs=1e-12,t2=Math.PI,lp=t2/2,Hz=2*t2;function Wz(t){return t>1?0:t<-1?t2:Math.acos(t)}function Q9(t){return t>=1?lp:t<=-1?-lp:Math.asin(t)}function lb(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);e=i}return t},()=>new ZD(e)}function $z(t){return t.innerRadius}function qz(t){return t.outerRadius}function Zz(t){return t.startAngle}function Xz(t){return t.endAngle}function Qz(t){return t&&t.padAngle}function Yz(t,e,n,i,r,s,u,a){var y=n-t,w=i-e,I=u-r,R=a-s,D=R*y-I*w;if(!(D*D<rs))return D=(I*(e-s)-R*(t-r))/D,[t+D*y,e+D*w]}function bA(t,e,n,i,r,s,u){var a=t-n,y=e-i,w=(u?s:-s)/Ch(a*a+y*y),I=w*y,R=-w*a,D=t+I,U=e+R,q=n+I,ne=i+R,pe=(D+q)/2,J=(U+ne)/2,ie=q-D,re=ne-U,ge=ie*ie+re*re,be=r-s,De=D*ne-q*U,qe=(re<0?-1:1)*Ch(jz(0,be*be*ge-De*De)),et=(De*re-ie*qe)/ge,ht=(-De*ie-re*qe)/ge,ot=(De*re+ie*qe)/ge,at=(-De*ie+re*qe)/ge,Mt=et-pe,ut=ht-J,St=ot-pe,Pn=at-J;return Mt*Mt+ut*ut>St*St+Pn*Pn&&(et=ot,ht=at),{cx:et,cy:ht,x01:-I,y01:-R,x11:et*(r/be-1),y11:ht*(r/be-1)}}function Y9(){var t=$z,e=qz,n=Os(0),i=null,r=Zz,s=Xz,u=Qz,a=null,y=lb(w);function w(){var I,R,D=+t.apply(this,arguments),U=+e.apply(this,arguments),q=r.apply(this,arguments)-lp,ne=s.apply(this,arguments)-lp,pe=X9(ne-q),J=ne>q;if(a||(a=I=y()),U<D&&(R=U,U=D,D=R),!(U>rs))a.moveTo(0,0);else if(pe>Hz-rs)a.moveTo(U*Uc(q),U*Ua(q)),a.arc(0,0,U,q,ne,!J),D>rs&&(a.moveTo(D*Uc(ne),D*Ua(ne)),a.arc(0,0,D,ne,q,J));else{var ie=q,re=ne,ge=q,be=ne,De=pe,qe=pe,et=u.apply(this,arguments)/2,ht=et>rs&&(i?+i.apply(this,arguments):Ch(D*D+U*U)),ot=Im(X9(U-D)/2,+n.apply(this,arguments)),at=ot,Mt=ot,ut,St;if(ht>rs){var Pn=Q9(ht/D*Ua(et)),Ot=Q9(ht/U*Ua(et));(De-=Pn*2)>rs?(Pn*=J?1:-1,ge+=Pn,be-=Pn):(De=0,ge=be=(q+ne)/2),(qe-=Ot*2)>rs?(Ot*=J?1:-1,ie+=Ot,re-=Ot):(qe=0,ie=re=(q+ne)/2)}var Gn=U*Uc(ie),vt=U*Ua(ie),Bt=D*Uc(be),Qt=D*Ua(be);if(ot>rs){var Mn=U*Uc(re),bn=U*Ua(re),pn=D*Uc(ge),Nn=D*Ua(ge),ti;if(pe<t2)if(ti=Yz(Gn,vt,pn,Nn,Mn,bn,Bt,Qt)){var Ue=Gn-ti[0],An=vt-ti[1],Un=Mn-ti[0],At=bn-ti[1],Xt=1/Ua(Wz((Ue*Un+An*At)/(Ch(Ue*Ue+An*An)*Ch(Un*Un+At*At)))/2),yn=Ch(ti[0]*ti[0]+ti[1]*ti[1]);at=Im(ot,(D-yn)/(Xt-1)),Mt=Im(ot,(U-yn)/(Xt+1))}else at=Mt=0}qe>rs?Mt>rs?(ut=bA(pn,Nn,Gn,vt,U,Mt,J),St=bA(Mn,bn,Bt,Qt,U,Mt,J),a.moveTo(ut.cx+ut.x01,ut.cy+ut.y01),Mt<ot?a.arc(ut.cx,ut.cy,Mt,Kr(ut.y01,ut.x01),Kr(St.y01,St.x01),!J):(a.arc(ut.cx,ut.cy,Mt,Kr(ut.y01,ut.x01),Kr(ut.y11,ut.x11),!J),a.arc(0,0,U,Kr(ut.cy+ut.y11,ut.cx+ut.x11),Kr(St.cy+St.y11,St.cx+St.x11),!J),a.arc(St.cx,St.cy,Mt,Kr(St.y11,St.x11),Kr(St.y01,St.x01),!J))):(a.moveTo(Gn,vt),a.arc(0,0,U,ie,re,!J)):a.moveTo(Gn,vt),!(D>rs)||!(De>rs)?a.lineTo(Bt,Qt):at>rs?(ut=bA(Bt,Qt,Mn,bn,D,-at,J),St=bA(Gn,vt,pn,Nn,D,-at,J),a.lineTo(ut.cx+ut.x01,ut.cy+ut.y01),at<ot?a.arc(ut.cx,ut.cy,at,Kr(ut.y01,ut.x01),Kr(St.y01,St.x01),!J):(a.arc(ut.cx,ut.cy,at,Kr(ut.y01,ut.x01),Kr(ut.y11,ut.x11),!J),a.arc(0,0,D,Kr(ut.cy+ut.y11,ut.cx+ut.x11),Kr(St.cy+St.y11,St.cx+St.x11),J),a.arc(St.cx,St.cy,at,Kr(St.y11,St.x11),Kr(St.y01,St.x01),!J))):a.arc(0,0,D,be,ge,J)}if(a.closePath(),I)return a=null,I+""||null}return w.centroid=function(){var I=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,R=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-t2/2;return[Uc(R)*I,Ua(R)*I]},w.innerRadius=function(I){return arguments.length?(t=typeof I=="function"?I:Os(+I),w):t},w.outerRadius=function(I){return arguments.length?(e=typeof I=="function"?I:Os(+I),w):e},w.cornerRadius=function(I){return arguments.length?(n=typeof I=="function"?I:Os(+I),w):n},w.padRadius=function(I){return arguments.length?(i=I==null?null:typeof I=="function"?I:Os(+I),w):i},w.startAngle=function(I){return arguments.length?(r=typeof I=="function"?I:Os(+I),w):r},w.endAngle=function(I){return arguments.length?(s=typeof I=="function"?I:Os(+I),w):s},w.padAngle=function(I){return arguments.length?(u=typeof I=="function"?I:Os(+I),w):u},w.context=function(I){return arguments.length?(a=I??null,w):a},w}function Kz(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function cb(t){this._context=t}cb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function ub(t){return new cb(t)}function Jz(t){return t[0]}function eB(t){return t[1]}function tB(t,e){var n=Os(!0),i=null,r=ub,s=null,u=lb(a);t=typeof t=="function"?t:t===void 0?Jz:Os(t),e=typeof e=="function"?e:e===void 0?eB:Os(e);function a(y){var w,I=(y=Kz(y)).length,R,D=!1,U;for(i==null&&(s=r(U=u())),w=0;w<=I;++w)!(w<I&&n(R=y[w],w,y))===D&&((D=!D)?s.lineStart():s.lineEnd()),D&&s.point(+t(R,w,y),+e(R,w,y));if(U)return s=null,U+""||null}return a.x=function(y){return arguments.length?(t=typeof y=="function"?y:Os(+y),a):t},a.y=function(y){return arguments.length?(e=typeof y=="function"?y:Os(+y),a):e},a.defined=function(y){return arguments.length?(n=typeof y=="function"?y:Os(!!y),a):n},a.curve=function(y){return arguments.length?(r=y,i!=null&&(s=r(i)),a):r},a.context=function(y){return arguments.length?(y==null?i=s=null:s=r(i=y),a):i},a}var nB=fb(ub);function hb(t){this._curve=t}hb.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function fb(t){function e(n){return new hb(t(n))}return e._curve=t,e}function iB(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(fb(n)):e()._curve},t}function K9(){return iB(tB().curve(nB))}function J9(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function tg(t,e){this._context=t,this._k=(1-e)/6}tg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:J9(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:J9(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(i){return new tg(i,e)}return n.tension=function(i){return t(+i)},n})(0);function rB(t,e,n){var i=t._x1,r=t._y1,s=t._x2,u=t._y2;if(t._l01_a>rs){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,y=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/y,r=(r*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/y}if(t._l23_a>rs){var w=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,I=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*w+t._x1*t._l23_2a-e*t._l12_2a)/I,u=(u*w+t._y1*t._l23_2a-n*t._l12_2a)/I}t._context.bezierCurveTo(i,r,s,u,t._x2,t._y2)}function Ab(t,e){this._context=t,this._alpha=e}Ab.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:rB(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const e_=function t(e){function n(i){return e?new Ab(i,e):new tg(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function Pf(t,e,n){this.k=t,this.x=e,this.y=n}Pf.prototype={constructor:Pf,scale:function(t){return t===1?this:new Pf(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Pf(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Pf.prototype;function cp(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const ng=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),t_=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);t_&&parseFloat(t_[1]);const sB="3.4.14";function t0(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const wd=typeof process!="object"||String(process)!=="[object process]"||process.browser,oB=typeof window<"u"&&typeof window.orientation<"u",n_=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);n_&&parseFloat(n_[1]);function n2(t){"@babel/helpers - typeof";return n2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n2(t)}function aB(t,e){if(n2(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(n2(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lB(t){var e=aB(t,"string");return n2(e)==="symbol"?e:String(e)}function Z(t,e,n){return e=lB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class cB{constructor(e,n){Z(this,"name",void 0),Z(this,"workerThread",void 0),Z(this,"isRunning",!0),Z(this,"result",void 0),Z(this,"_resolve",()=>{}),Z(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){t0(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){t0(this.isRunning),this.isRunning=!1,this._reject(e)}}let km=class{terminate(){}};const Lm=new Map;function uB(t){t0(t.source&&!t.url||!t.source&&t.url);let e=Lm.get(t.source||t.url);return e||(t.url&&(e=hB(t.url),Lm.set(t.url,e)),t.source&&(e=db(t.source),Lm.set(t.source,e))),t0(e),e}function hB(t){if(!t.startsWith("http"))return t;const e=fB(t);return db(e)}function db(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function fB(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function pb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(i_(t))i.add(t);else if(i_(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const r in t)pb(t[r],e,i)}}return n===void 0?Array.from(i):[]}function i_(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Dm=()=>{};class r5{static isSupported(){return typeof Worker<"u"&&wd||typeof km<"u"&&!wd}constructor(e){Z(this,"name",void 0),Z(this,"source",void 0),Z(this,"url",void 0),Z(this,"terminated",!1),Z(this,"worker",void 0),Z(this,"onMessage",void 0),Z(this,"onError",void 0),Z(this,"_loadableURL","");const{name:n,source:i,url:r}=e;t0(i||r),this.name=n,this.source=i,this.url=r,this.onMessage=Dm,this.onError=s=>console.log(s),this.worker=wd?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Dm,this.onError=Dm,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||pb(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=uB({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new km(i,{eval:!1})}else if(this.source)e=new km(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class AB{static isSupported(){return r5.isSupported()}constructor(e){Z(this,"name","unnamed"),Z(this,"source",void 0),Z(this,"url",void 0),Z(this,"maxConcurrency",1),Z(this,"maxMobileConcurrency",1),Z(this,"onDebug",()=>{}),Z(this,"reuseWorkers",!0),Z(this,"props",{}),Z(this,"jobQueue",[]),Z(this,"idleQueue",[]),Z(this,"count",0),Z(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,u,a)=>s.done(a),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,u)=>s.error(u);const r=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:i,onStart:s}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const i=new cB(n.name,e);e.onMessage=r=>n.onMessage(i,r.type,r.payload),e.onError=r=>n.onError(i,r),n.onStart(i);try{await i.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new r5({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return oB?this.maxMobileConcurrency:this.maxConcurrency}}const dB={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Gl{static isSupported(){return r5.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Gl._workerFarm=Gl._workerFarm||new Gl({}),Gl._workerFarm.setProps(e),Gl._workerFarm}constructor(e){Z(this,"props",void 0),Z(this,"workerPools",new Map),this.props={...dB},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:i,url:r}=e;let s=this.workerPools.get(n);return s||(s=new AB({name:n,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}Z(Gl,"_workerFarm",void 0);const pB="latest";function mB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(!r&&t.id==="compression"&&(r=e.workerUrl),e._workerType==="test"&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let s=t.version;s==="latest"&&(s=pB);const u=s?"@".concat(s):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(u,"/dist/").concat(i)}return t0(r),r}function gB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sB;t0(t,"no worker provided");const n=t.version;return!(!e||!n)}function _B(t,e){return!Gl.isSupported()||!wd&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function yB(t,e,n,i,r){const s=t.id,u=mB(t,n),y=Gl.getWorkerFarm(n).getWorkerPool({name:s,url:u});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const w=await y.startJob("process-on-worker",vB.bind(null,r));return w.postMessage("process",{input:e,options:n,context:i}),await(await w.result).result}async function vB(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:s,options:u}=i;try{const a=await t(s,u);e.postMessage("done",{id:r,result:a})}catch(a){const y=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:y})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function xB(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}function wB(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=i.reduce((a,y)=>a+y.byteLength,0),s=new Uint8Array(r);let u=0;for(const a of i)s.set(a,u),u+=a.byteLength;return s.buffer}async function bB(t){const e=[];for await(const n of t)e.push(n);return wB(...e)}function r_(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let s_=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=r_(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(r_()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},EB=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:i}=e;let r=this.stats[n];return r||(e instanceof s_?r=e:r=new s_(n,i),this.stats[n]=r),r}};const TB="Queued Requests",SB="Active Requests",CB="Cancelled Requests",PB="Queued Requests Ever",MB="Active Requests Ever",IB={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class kB{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Z(this,"props",void 0),Z(this,"stats",void 0),Z(this,"activeRequestCount",0),Z(this,"requestQueue",[]),Z(this,"requestMap",new Map),Z(this,"deferredUpdate",null),this.props={...IB,...e},this.stats=new EB({id:this.props.id}),this.stats.get(TB),this.stats.get(SB),this.stats.get(CB),this.stats.get(PB),this.stats.get(MB)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const i={handle:e,priority:0,getPriority:n},r=new Promise(s=>(i.resolve=s,i));return this.requestQueue.push(i),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:n,resolve:i}=e;let r=!1;const s=()=>{r||(r=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const i=this.requestQueue.shift();i&&this._issueRequest(i)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const i=e[n];this._updateRequest(i)||(e.splice(n,1),this.requestMap.delete(i.handle),n--)}e.sort((n,i)=>n.priority-i.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let LB="";const o_={};function DB(t){for(const e in o_)if(t.startsWith(e)){const n=o_[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(LB).concat(t)),t}function RB(t){return t&&typeof t=="object"&&t.isBuffer}function mb(t){if(RB(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function gb(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function zB(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const BB=t=>typeof t=="boolean",Bf=t=>typeof t=="function",R2=t=>t!==null&&typeof t=="object",a_=t=>R2(t)&&t.constructor==={}.constructor,OB=t=>t&&typeof t[Symbol.iterator]=="function",FB=t=>t&&typeof t[Symbol.asyncIterator]=="function",xu=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,wu=t=>typeof Blob<"u"&&t instanceof Blob,NB=t=>t&&typeof t=="object"&&t.isBuffer,UB=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||R2(t)&&Bf(t.tee)&&Bf(t.cancel)&&Bf(t.getReader),VB=t=>R2(t)&&Bf(t.read)&&Bf(t.pipe)&&BB(t.readable),_b=t=>UB(t)||VB(t),GB=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,jB=/^([-\w.]+\/[-\w.+]+)/;function HB(t){const e=jB.exec(t);return e?e[1]:t}function l_(t){const e=GB.exec(t);return e?e[1]:""}const yb=/\?.*/;function WB(t){const e=t.match(yb);return e&&e[0]}function ig(t){return t.replace(yb,"")}function a3(t){return xu(t)?t.url:wu(t)?t.name||"":typeof t=="string"?t:""}function rg(t){if(xu(t)){const e=t,n=e.headers.get("content-type")||"",i=ig(e.url);return HB(n)||l_(i)}return wu(t)?t.type||"":typeof t=="string"?l_(t):""}function $B(t){return xu(t)?t.headers["content-length"]||-1:wu(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function vb(t){if(xu(t))return t;const e={},n=$B(t);n>=0&&(e["content-length"]=String(n));const i=a3(t),r=rg(t);r&&(e["content-type"]=r);const s=await XB(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const u=new Response(t,{headers:e});return Object.defineProperty(u,"url",{value:i}),u}async function qB(t){if(!t.ok){const e=await ZB(t);throw new Error(e)}}async function ZB(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function XB(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(i=>{const r=new FileReader;r.onload=s=>{var u;return i(s==null||(u=s.target)===null||u===void 0?void 0:u.result)},r.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),i=QB(n);return"data:base64,".concat(i)}return null}function QB(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}async function c_(t,e){if(typeof t=="string"){t=DB(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await vb(t)}function YB(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function z2(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||YB()}const EA=globalThis.window||globalThis.self||globalThis.global,af=globalThis.process||{},xb=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";z2();function KB(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let JB=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=KB(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function eO(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function tO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Rm(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let up;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(up||(up={}));const nO=10;function u_(t){return typeof t!="string"?t:(t=t.toUpperCase(),up[t]||up.WHITE)}function iO(t,e,n){if(!z2&&typeof t=="string"){if(e){const i=u_(e);t="\x1B[".concat(i,"m").concat(t,"\x1B[39m")}if(n){const i=u_(n);t="\x1B[".concat(i+nO,"m").concat(t,"\x1B[49m")}}return t}function rO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n),r=t;for(const s of i){const u=r[s];typeof u=="function"&&(e.find(a=>s===a)||(r[s]=u.bind(t)))}}function hp(t,e){if(!t)throw new Error(e||"Assertion failed")}function Ah(){let t;if(z2()&&EA.performance){var e,n;t=EA==null||(e=EA.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in af){var i;const r=af==null||(i=af.hrtime)===null||i===void 0?void 0:i.call(af);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const dh={debug:z2()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},sO={enabled:!0,level:0};function Lo(){}const h_={},f_={once:!0};let sg=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=xb,this._startTs=Ah(),this._deltaTs=Ah(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new JB("__probe-".concat(this.id,"__"),sO),this.timeStamp("".concat(this.id," started")),rO(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ah()-this._startTs).toPrecision(10))}getDelta(){return Number((Ah()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){hp(e,n)}warn(e){return this._getLogFunction(0,e,dh.warn,arguments,f_)}error(e){return this._getLogFunction(0,e,dh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,dh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,dh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,dh.debug||dh.info,arguments,f_)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Lo,i&&[i],{tag:cO(n)}):Lo}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?z2()?lO({image:r,message:s,scale:u}):aO():Lo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Lo)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=A_({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Lo)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=wb(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=A_({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,hp(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Ah();const u=s.tag||s.message;if(s.once&&u)if(!h_[u])h_[u]=Ah();else return Lo;return n=oO(this.id,s.message,s),i.bind(console,n,...s.args)}return Lo}};sg.VERSION=xb;function wb(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return hp(Number.isFinite(e)&&e>=0),e}function A_(t){const{logLevel:e,message:n}=t;t.logLevel=wb(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return hp(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function oO(t,e,n){if(typeof e=="string"){const i=n.time?tO(eO(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=iO(e,n.color,n.background)}return e}function aO(t){return console.warn("removed"),Lo}function lO(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=Rm(s,n,i);console.log(...u)},s.src=e,Lo}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...Rm(e,n,i)),Lo;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Rm(s,n,i)),s.src=e.toDataURL(),Lo}return Lo}function cO(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const d_=new sg({id:"loaders.gl"});class uO{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class hO{constructor(){Z(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.error.bind(this.console,...n)}}const bb={fetch:null,mimeType:void 0,nothrow:!1,log:new hO,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ng,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},fO={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Eb(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const Tb=()=>{const t=Eb();return t.globalOptions=t.globalOptions||{...bb},t.globalOptions};function AO(t,e,n,i){return n=n||[],n=Array.isArray(n)?n:[n],dO(t,n),mO(e,t,i)}function dO(t,e){p_(t,null,bb,fO,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};p_(i,n.id,r,s,e)}}function p_(t,e,n,i,r){const s=e||"Top level",u=e?"".concat(e,"."):"";for(const a in t){const y=!e&&R2(t[a]),w=a==="baseUri"&&!e,I=a==="workerUrl"&&e;if(!(a in n)&&!w&&!I){if(a in i)d_.warn("".concat(s," loader option '").concat(u).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!y){const R=pO(a,r);d_.warn("".concat(s," loader option '").concat(u).concat(a,"' not recognized. ").concat(R))()}}}}function pO(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(t===s)return"Did you mean '".concat(r.id,".").concat(s,"'?");const u=s.toLowerCase();(n.startsWith(u)||u.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(s,"'?"))}return i}function mO(t,e,n){const r={...t.options||{}};return gO(r,n),r.log===null&&(r.log=new uO),m_(r,Tb()),m_(r,e),r}function m_(t,e){for(const n in e)if(n in e){const i=e[n];a_(i)&&a_(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function gO(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function og(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function ag(t){var e,n;cp(t,"null loader"),cp(og(t),"invalid loader");let i;return Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Sb=()=>{const t=Eb();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function _O(t){const e=Sb();t=Array.isArray(t)?t:[t];for(const n of t){const i=ag(n);e.find(r=>i===r)||e.unshift(i)}}function yO(){return Sb()}const vO=new sg({id:"loaders.gl"}),xO=/\.([^.]+)$/;async function wO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!Cb(t))return null;let r=g_(t,e,{...n,nothrow:!0},i);if(r)return r;if(wu(t)&&(t=await t.slice(0,10).arrayBuffer(),r=g_(t,e,n,i)),!r&&!(n!=null&&n.nothrow))throw new Error(Pb(t));return r}function g_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!Cb(t))return null;if(e&&!Array.isArray(e))return ag(e);let r=[];e&&(r=r.concat(e)),n!=null&&n.ignoreRegisteredLoaders||r.push(...yO()),EO(r);const s=bO(t,r,n,i);if(!s&&!(n!=null&&n.nothrow))throw new Error(Pb(t));return s}function bO(t,e,n,i){const r=a3(t),s=rg(t),u=ig(r)||i?.url;let a=null,y="";if(n!=null&&n.mimeType&&(a=zm(e,n?.mimeType),y="match forced by supplied MIME type ".concat(n?.mimeType)),a=a||TO(e,u),y=y||(a?"matched url ".concat(u):""),a=a||zm(e,s),y=y||(a?"matched MIME type ".concat(s):""),a=a||CO(e,t),y=y||(a?"matched initial data ".concat(Mb(t)):""),a=a||zm(e,n?.fallbackMimeType),y=y||(a?"matched fallback MIME type ".concat(s):""),y){var w;vO.log(1,"selectLoader selected ".concat((w=a)===null||w===void 0?void 0:w.name,": ").concat(y,"."))}return a}function Cb(t){return!(t instanceof Response&&t.status===204)}function Pb(t){const e=a3(t),n=rg(t);let i="No valid loader found (";i+=e?"".concat(gb(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?Mb(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function EO(t){for(const e of t)ag(e)}function TO(t,e){const n=e&&xO.exec(e),i=n&&n[1];return i?SO(t,i):null}function SO(t,e){e=e.toLowerCase();for(const n of t)for(const i of n.extensions)if(i.toLowerCase()===e)return n;return null}function zm(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function CO(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(PO(e,n))return n}else if(ArrayBuffer.isView(e)){if(__(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&__(e,0,n))return n;return null}function PO(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function __(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>MO(t,e,n,r))}function MO(t,e,n,i){if(i instanceof ArrayBuffer)return xB(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":const r=s5(t,e,i.length);return i===r;default:return!1}}function Mb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?s5(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?s5(t,0,e):""}function s5(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let s=0;s<n;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}const IO=256*1024;function*kO(t,e){const n=e?.chunkSize||IO;let i=0;const r=new TextEncoder;for(;i<t.length;){const s=Math.min(t.length-i,n),u=t.slice(i,i+s);i+=s,yield r.encode(u)}}const LO=256*1024;function DO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=LO}=e;let i=0;for(;i<t.byteLength;){const r=Math.min(t.byteLength-i,n),s=new ArrayBuffer(r),u=new Uint8Array(t,i,r);new Uint8Array(s).set(u),i+=r,yield s}}()}const RO=1024*1024;async function*zO(t,e){const n=e?.chunkSize||RO;let i=0;for(;i<t.size;){const r=i+n,s=await t.slice(i,r).arrayBuffer();i=r,yield s}}function y_(t,e){return ng?BO(t,e):OO(t)}async function*BO(t,e){const n=t.getReader();let i;try{for(;;){const r=i||n.read();e!=null&&e._streamReadAhead&&(i=n.read());const{done:s,value:u}=await r;if(s)return;yield mb(u)}}catch{n.releaseLock()}}async function*OO(t,e){for await(const n of t)yield mb(n)}function FO(t,e){if(typeof t=="string")return kO(t,e);if(t instanceof ArrayBuffer)return DO(t,e);if(wu(t))return zO(t,e);if(_b(t))return y_(t,e);if(xu(t))return y_(t.body,e);throw new Error("makeIterator")}const Ib="Cannot convert supplied data type";function NO(t,e,n){if(e.text&&typeof t=="string")return t;if(NB(t)&&(t=t.buffer),t instanceof ArrayBuffer){const i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer;const r=t.byteLength||t.length;return(t.byteOffset!==0||r!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+r)),i}throw new Error(Ib)}async function UO(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||i)return NO(t,e);if(wu(t)&&(t=await vb(t)),xu(t)){const r=t;return await qB(r),e.binary?await r.arrayBuffer():await r.text()}if(_b(t)&&(t=FO(t,n)),OB(t)||FB(t))return bB(t);throw new Error(Ib)}function kb(t,e){const n=Tb(),i=t||n;return typeof i.fetch=="function"?i.fetch:R2(i.fetch)?r=>c_(r,i):e!=null&&e.fetch?e?.fetch:c_}function VO(t,e,n){if(n)return n;const i={fetch:kb(e,t),...t};if(i.url){const r=ig(i.url);i.baseUrl=r,i.queryString=WB(i.url),i.filename=gb(r),i.baseUrl=zB(r)}return Array.isArray(i.loaders)||(i.loaders=null),i}function GO(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...i]:i}return n&&n.length?n:null}async function lg(t,e,n,i){t0(!i||typeof i=="object"),e&&!Array.isArray(e)&&!og(e)&&(i=void 0,n=e,e=void 0),t=await t,n=n||{};const r=a3(t),u=GO(e,i),a=await wO(t,u,n);return a?(n=AO(n,a,u,r),i=VO({url:r,parse:lg,loaders:u},n,i||null),await jO(a,t,n,i)):null}async function jO(t,e,n,i){if(gB(t),xu(e)){const r=e,{ok:s,redirected:u,status:a,statusText:y,type:w,url:I}=r,R=Object.fromEntries(r.headers.entries());i.response={headers:R,ok:s,redirected:u,status:a,statusText:y,type:w,url:I}}if(e=await UO(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,i,t);if(_B(t,n))return await yB(t,e,n,i,lg);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw t0(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function fp(t,e,n,i){!Array.isArray(e)&&!og(e)&&(n=e,e=void 0);const r=kb(n);let s=t;return typeof t=="string"&&(s=await r(t)),wu(t)&&(s=await r(t)),await lg(s,e,n)}const HO="3.4.14",{_parseImageNode:WO}=globalThis,o5=typeof Image<"u",a5=typeof ImageBitmap<"u",$O=!!WO,l5=ng?!0:$O;function qO(t){switch(t){case"auto":return a5||o5||l5;case"imagebitmap":return a5;case"image":return o5;case"data":return l5;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function ZO(){if(a5)return"imagebitmap";if(o5)return"image";if(l5)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function XO(t){const e=YO(t);if(!e)throw new Error("Not an image");return e}function QO(t){switch(XO(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function YO(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const KO=/^data:image\/svg\+xml/,JO=/\.svg((\?|#).*)?$/;function cg(t){return t&&(KO.test(t)||JO.test(t))}function eF(t,e){if(cg(e)){let i=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return Lb(t,e)}function Lb(t,e){if(cg(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Db(t,e,n){const i=eF(t,n),r=self.URL||self.webkitURL,s=typeof i!="string"&&r.createObjectURL(i);try{return await tF(s||i,e)}finally{s&&r.revokeObjectURL(s)}}async function tF(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=s=>r(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){r(s)}})}const nF={};let v_=!0;async function iF(t,e,n){let i;cg(n)?i=await Db(t,e,n):i=Lb(t,n);const r=e&&e.imagebitmap;return await rF(i,r)}async function rF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((sF(e)||!v_)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),v_=!1}return await createImageBitmap(t)}function sF(t){for(const e in t||nF)return!1;return!0}function oF(t){return!uF(t,"ftyp",4)||!(t[8]&96)?null:aF(t)}function aF(t){switch(lF(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function lF(t,e,n){return String.fromCharCode(...t.slice(e,n))}function cF(t){return[...t].map(e=>e.charCodeAt(0))}function uF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=cF(e);for(let r=0;r<i.length;++r)if(i[r]!==t[r+n])return!1;return!0}const Za=!1,Of=!0;function Rb(t){const e=B2(t);return fF(e)||pF(e)||AF(e)||dF(e)||hF(e)}function hF(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=oF(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function fF(t){const e=B2(t);return e.byteLength>=24&&e.getUint32(0,Za)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Za),height:e.getUint32(20,Za)}:null}function AF(t){const e=B2(t);return e.byteLength>=10&&e.getUint32(0,Za)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Of),height:e.getUint16(8,Of)}:null}function dF(t){const e=B2(t);return e.byteLength>=14&&e.getUint16(0,Za)===16973&&e.getUint32(2,Of)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Of),height:e.getUint32(22,Of)}:null}function pF(t){const e=B2(t);if(!(e.byteLength>=3&&e.getUint16(0,Za)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:r}=mF();let s=2;for(;s+9<e.byteLength;){const u=e.getUint16(s,Za);if(r.has(u))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Za),width:e.getUint16(s+7,Za)};if(!i.has(u))return null;s+=2,s+=e.getUint16(s,Za)}return null}function mF(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function B2(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function gF(t,e){const{mimeType:n}=Rb(t)||{},i=globalThis._parseImageNode;return cp(i),await i(t,n)}async function _F(t,e,n){e=e||{};const r=(e.image||{}).type||"auto",{url:s}=n||{},u=yF(r);let a;switch(u){case"imagebitmap":a=await iF(t,e,s);break;case"image":a=await Db(t,e,s);break;case"data":a=await gF(t);break;default:cp(!1)}return r==="data"&&(a=QO(a)),a}function yF(t){switch(t){case"auto":case"data":return ZO();default:return qO(t),t}}const vF=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],xF=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],wF={image:{type:"auto",decode:!0}},bF={id:"image",module:"images",name:"Images",version:HO,mimeTypes:xF,extensions:vF,parse:_F,tests:[t=>!!Rb(new DataView(t))],options:wF};function zb(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function S1(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||zb()}const bd={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},TA=bd.window||bd.self||bd.global,lf=bd.process||{},Bb=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";S1();const Bm=globalThis;function EF(t){if(!t&&!S1())return"Node";if(zb(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":Bm.chrome?"Chrome":Bm.safari?"Safari":Bm.mozInnerScreenX?"Firefox":"Unknown"}function TF(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let SF=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Z(this,"storage",void 0),Z(this,"id",void 0),Z(this,"config",void 0),this.storage=TF(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function CF(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function PF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Om(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Ap;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ap||(Ap={}));function x_(t){return typeof t=="string"?Ap[t.toUpperCase()]||Ap.WHITE:t}function MF(t,e,n){return!S1&&typeof t=="string"&&(e&&(e=x_(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=x_(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function IF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(s=>r===s)||(t[r]=t[r].bind(t)))}function dp(t,e){if(!t)throw new Error(e||"Assertion failed")}function ph(){let t;if(S1&&"performance"in TA){var e,n;t=TA==null||(e=TA.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in lf){var i;const r=lf==null||(i=lf.hrtime)===null||i===void 0?void 0:i.call(lf);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const mh={debug:S1&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},kF={enabled:!0,level:0};function Do(){}const w_={},b_={once:!0};let Ob=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};Z(this,"id",void 0),Z(this,"VERSION",Bb),Z(this,"_startTs",ph()),Z(this,"_deltaTs",ph()),Z(this,"_storage",void 0),Z(this,"userData",{}),Z(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new SF("__probe-".concat(this.id,"__"),kF),this.timeStamp("".concat(this.id," started")),IF(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ph()-this._startTs).toPrecision(10))}getDelta(){return Number((ph()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){dp(e,n)}warn(e){return this._getLogFunction(0,e,mh.warn,arguments,b_)}error(e){return this._getLogFunction(0,e,mh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,mh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,mh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,n,mh.debug||mh.info,arguments,b_)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Do,i&&[i],{tag:zF(n)}):Do}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?S1?RF({image:r,message:s,scale:u}):DF():Do}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Do)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=E_({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Do)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Fb(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=E_({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,dp(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=ph();const u=s.tag||s.message;if(s.once)if(!w_[u])w_[u]=ph();else return Do;return n=LF(this.id,s.message,s),i.bind(console,n,...s.args)}return Do}};Z(Ob,"VERSION",Bb);function Fb(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return dp(Number.isFinite(e)&&e>=0),e}function E_(t){const{logLevel:e,message:n}=t;t.logLevel=Fb(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return dp(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function LF(t,e,n){if(typeof e=="string"){const i=n.time?PF(CF(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=MF(e,n.color,n.background)}return e}function DF(t){return console.warn("removed"),Do}function RF(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=Om(s,n,i);console.log(...u)},s.src=e,Do}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...Om(e,n,i)),Do;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Om(s,n,i)),s.src=e.toDataURL(),Do}return Do}function zF(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Xn=new Ob({id:"deck"});let c5={};function BF(t){c5=t}function ss(t,e,n,i){Xn.level>0&&c5[t]&&c5[t].call(null,e,n,i)}function OF(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const FF={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:OF,parseTextSync:JSON.parse};function NF(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Xn.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Xn,_registerLoggers:BF},_O([FF,[bF,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const UF=NF(),Yn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Yn,"IDENTITY",{get:()=>(Xn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const ha={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},au={common:0,meters:1,pixels:2},T_={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function VF(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function C1(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||VF()}const Ed={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},SA=Ed.window||Ed.self||Ed.global,cf=Ed.process||{},Nb=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";C1();function GF(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class jF{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Z(this,"storage",void 0),Z(this,"id",void 0),Z(this,"config",void 0),this.storage=GF(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function HF(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function WF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Fm(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let pp;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(pp||(pp={}));function S_(t){return typeof t=="string"?pp[t.toUpperCase()]||pp.WHITE:t}function $F(t,e,n){return!C1&&typeof t=="string"&&(e&&(e=S_(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=S_(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function qF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(s=>r===s)||(t[r]=t[r].bind(t)))}function mp(t,e){if(!t)throw new Error(e||"Assertion failed")}function gh(){let t;if(C1&&"performance"in SA){var e,n;t=SA==null||(e=SA.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in cf){var i;const r=cf==null||(i=cf.hrtime)===null||i===void 0?void 0:i.call(cf);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const _h={debug:C1&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},ZF={enabled:!0,level:0};function Ro(){}const C_={},P_={once:!0};class Ub{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};Z(this,"id",void 0),Z(this,"VERSION",Nb),Z(this,"_startTs",gh()),Z(this,"_deltaTs",gh()),Z(this,"_storage",void 0),Z(this,"userData",{}),Z(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new jF("__probe-".concat(this.id,"__"),ZF),this.timeStamp("".concat(this.id," started")),qF(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((gh()-this._startTs).toPrecision(10))}getDelta(){return Number((gh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){mp(e,n)}warn(e){return this._getLogFunction(0,e,_h.warn,arguments,P_)}error(e){return this._getLogFunction(0,e,_h.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,_h.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,_h.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,n,_h.debug||_h.info,arguments,P_)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Ro,i&&[i],{tag:KF(n)}):Ro}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?C1?YF({image:r,message:s,scale:u}):QF():Ro}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ro)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=M_({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ro)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Vb(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=M_({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,mp(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=gh();const u=s.tag||s.message;if(s.once)if(!C_[u])C_[u]=gh();else return Ro;return n=XF(this.id,s.message,s),i.bind(console,n,...s.args)}return Ro}}Z(Ub,"VERSION",Nb);function Vb(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return mp(Number.isFinite(e)&&e>=0),e}function M_(t){const{logLevel:e,message:n}=t;t.logLevel=Vb(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return mp(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function XF(t,e,n){if(typeof e=="string"){const i=n.time?WF(HF(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=$F(e,n.color,n.background)}return e}function QF(t){return console.warn("removed"),Ro}function YF(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=Fm(s,n,i);console.log(...u)},s.src=e,Ro}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...Fm(e,n,i)),Ro;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Fm(s,n,i)),s.src=e.toDataURL(),Ro}return Ro}function KF(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const cn=new Ub({id:"luma.gl"});function bs(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const JF="Invalid WebGLRenderingContext",eN="Requires WebGL2";function l3(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Kn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function tN(t){return Kn(t)?t:null}function c3(t){return bs(l3(t),JF),t}function ls(t){return bs(Kn(t),eN),t}const Mf={};function nN(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function iN(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function rN(t,e){Mf[t]=!0,e!==void 0&&nN(e)}function sN(t){const e=t.getError;t.getError=function(){let i;do i=e.apply(t),i!==0&&(Mf[i]=!0);while(i!==0);for(i in Mf)if(Mf[i])return delete Mf[i],parseInt(i,10);return 0}}const O2=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};O2.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};O2.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const bu=function(e){const n=this;this.gl=e,sN(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const u=n.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,s);const a=u.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const u=n.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,s);const a=u.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,u){switch(s){case 34962:n.currentArrayBuffer=u;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=u;break}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,u){const y=n.currentVertexArrayObject.attribs[s];switch(u){case 34975:return y.buffer;case 34338:return y.enabled;case 34339:return y.size;case 34340:return y.stride;case 34341:return y.type;case 34922:return y.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,u,a,y,w,I){const R=n.currentVertexArrayObject;R.maxAttrib=Math.max(R.maxAttrib,s);const D=R.attribs[s];return D.buffer=n.currentArrayBuffer,D.size=u,D.type=a,D.normalized=y,D.stride=w,D.offset=I,D.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{iN("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};bu.prototype.VERTEX_ARRAY_BINDING_OES=34229;bu.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new O2(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};bu.prototype.createVertexArrayOES=function(){const e=new O2(this);return this.vertexArrayObjects.push(e),e};bu.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};bu.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof O2&&e.hasBeenBound&&e.ext===this)};bu.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){rN(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(n,34963,s.elementArrayBuffer);let u=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let y=0;y<=a;y++){const w=s.attribs[y],I=r?r.attribs[y]:null;if((!r||w.enabled!==I.enabled)&&(w.enabled?i.enableVertexAttribArray.call(n,y):i.disableVertexAttribArray.call(n,y)),w.enabled){let R=!1;(!r||w.buffer!==I.buffer)&&(u!==w.buffer&&(i.bindBuffer.call(n,34962,w.buffer),u=w.buffer),R=!0),(R||w.cached!==I.cached)&&i.vertexAttribPointer.call(n,y,w.size,w.type,w.normalized,w.stride,w.offset)}}this.currentArrayBuffer!==u&&i.bindBuffer.call(n,34962,this.currentArrayBuffer)};function oN(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const n=t.getExtension;t.getExtension=function(r){const s=n.call(this,r);return s||(r!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new bu(this)),this.__OESVertexArrayObject))}}const I_="OES_element_index",k_="WEBGL_draw_buffers",aN="EXT_disjoint_timer_query",lN="EXT_disjoint_timer_query_webgl2",cN="EXT_texture_filter_anisotropic",L_="WEBGL_debug_renderer_info",uN=35723,hN=4352,fN=36795,AN=34047,dN=37445,pN=37446,Ci=t=>Kn(t)?void 0:0,mN={3074:t=>Kn(t)?void 0:36064,[uN]:t=>Kn(t)?void 0:hN,35977:Ci,32937:Ci,[fN]:(t,e)=>{const n=Kn(t)?t.getExtension(lN):t.getExtension(aN);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[dN]:(t,e)=>{const n=t.getExtension(L_);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[pN]:(t,e)=>{const n=t.getExtension(L_);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[AN]:(t,e)=>{const n=t.luma.extensions[cN];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Ci,35071:Ci,37447:Ci,36063:(t,e)=>{if(!Kn(t)){const n=t.getExtension(k_);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Ci,35374:Ci,35377:Ci,34852:t=>{if(!Kn(t)){const e=t.getExtension(k_);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(I_)?2147483647:65535,33001:t=>t.getExtension(I_)?16777216:65535,33e3:t=>16777216,37157:Ci,35373:Ci,35657:Ci,36183:Ci,37137:Ci,34045:Ci,35978:Ci,35979:Ci,35968:Ci,35376:Ci,35375:Ci,35659:Ci,37154:Ci,35371:Ci,35658:Ci,35076:Ci,35077:Ci,35380:Ci};function gN(t,e,n){const i=mN[n],r=typeof i=="function"?i(t,e,n):i;return r!==void 0?r:e(n)}const _N="OES_vertex_array_object",Gb="ANGLE_instanced_arrays",yN="WEBGL_draw_buffers",vN="EXT_disjoint_timer_query",xN="EXT_texture_filter_anisotropic",wN="VertexArray requires WebGL2 or OES_vertex_array_object extension";function bN(t,e){return{webgl2:Kn(t),ext:t.getExtension(e)}}const jb={[_N]:{meta:{suffix:"OES"},createVertexArray:()=>{bs(!1,wN)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[Gb]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){bs(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[yN]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{bs(!1)}},[vN]:{meta:{suffix:"EXT"},createQuery:()=>{bs(!1)},deleteQuery:()=>{bs(!1)},beginQuery:()=>{bs(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Nm={readBuffer:(t,e,n)=>{Kn(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:s}=bN(t,Gb);let u;switch(i){case 35069:u=r?void 0:!1;break;case 35070:u=!r&&!s?0:void 0;break}return u!==void 0?u:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!Kn(t))switch(i){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>{if(!Kn(t))switch(r){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,i,r)},getTexParameter(t,e,n,i){switch(i){case 34046:const{extensions:r}=t.luma,s=r[xN];i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,i)},getParameter:gN,hint(t,e,n,i){return e(n,i)}};function EN(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(oN(t),TN(t),CN(t,jb),SN(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=EN;function TN(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function SN(t,e){let{target:n,target2:i}=e;Object.keys(Nm).forEach(r=>{if(typeof Nm[r]=="function"){const s=t[r]?t[r].bind(t):()=>{},u=Nm[r].bind(null,t,s);n[r]=u,i[r]=u}})}function CN(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&PN(t,{extension:n,target:t.luma,target2:t})}function PN(t,e){let{extension:n,target:i,target2:r}=e;const s=jb[n];bs(s);const{meta:u={}}=s,{suffix:a=""}=u,y=t.getExtension(n);for(const w of Object.keys(s)){const I="".concat(w).concat(a);let R=null;w==="meta"||typeof t[w]=="function"||(y&&typeof y[I]=="function"?R=function(){return y[I](...arguments)}:typeof s[w]=="function"&&(R=s[w].bind(i))),R&&(i[w]=R,r[w]=R)}}const ug={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},L0=(t,e,n)=>e?t.enable(n):t.disable(n),D_=(t,e,n)=>t.hint(n,e),ro=(t,e,n)=>t.pixelStorei(n,e),MN=(t,e)=>{const n=Kn(t)?36009:36160;return t.bindFramebuffer(n,e)},IN=(t,e)=>t.bindFramebuffer(36008,e);function uf(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const kN={3042:L0,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:L0,2885:(t,e)=>t.cullFace(e),2929:L0,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:L0,35723:D_,36006:MN,2886:(t,e)=>t.frontFace(e),33170:D_,2849:(t,e)=>t.lineWidth(e),32823:L0,32824:"polygonOffset",10752:"polygonOffset",35977:L0,32938:"sampleCoverage",32939:"sampleCoverage",3089:L0,3088:(t,e)=>t.scissor(...e),2960:L0,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:ro,3317:ro,37440:ro,37441:ro,37443:ro,3330:ro,3332:ro,3331:ro,36010:IN,3314:ro,32878:ro,3316:ro,3315:ro,32877:ro,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=uf(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=uf(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=uf(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=uf(e)&&e.length===3?[...e,...e]:e;const[n,i,r,s,u,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,s,u,a)},stencilOp:(t,e)=>{e=uf(e)&&e.length===3?[...e,...e]:e;const[n,i,r,s,u,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,s,u,a)},viewport:(t,e)=>t.viewport(...e)};function Qi(t,e,n){return e[t]!==void 0?e[t]:n[t]}const LN={blendEquation:(t,e,n)=>t.blendEquationSeparate(Qi(32777,e,n),Qi(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Qi(32969,e,n),Qi(32968,e,n),Qi(32971,e,n),Qi(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Qi(32824,e,n),Qi(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Qi(32938,e,n),Qi(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Qi(2962,e,n),Qi(2967,e,n),Qi(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Qi(34816,e,n),Qi(36003,e,n),Qi(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Qi(2964,e,n),Qi(2965,e,n),Qi(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Qi(34817,e,n),Qi(34818,e,n),Qi(34819,e,n))},R_={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:i,[e===1028?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:i,[e===1028?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Va=(t,e)=>t.isEnabled(e),z_={3042:Va,2884:Va,2929:Va,3024:Va,32823:Va,32926:Va,32928:Va,3089:Va,2960:Va,35977:Va};function Hb(t){for(const e in t)return!1;return!0}function DN(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function B_(t,e){const n=t[e].bind(t);t[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in t.state.cache?t.state.enable?t.state.cache[r]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function RN(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var s=arguments.length,u=new Array(s),a=0;a<s;a++)u[a]=arguments[a];const{valueChanged:y,oldValue:w}=n(t.state._updateCache,...u);return y&&i(...u),w},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function zN(t){const e=t.useProgram.bind(t);t.useProgram=function(i){t.state.program!==i&&(e(i),t.state.program=i)}}class BN{constructor(e){let{copyState:n=!1,log:i=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?FN(e):Object.assign({},ug),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){bs(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];n0(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,i;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){bs(s!==void 0);const u=e[s],a=this.cache[s];DN(u,a)||(n=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=u)}return{valueChanged:n,oldValue:i}}}function Wb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(bs(i!==void 0),!t.state){const{polyfillContext:r}=globalThis;r&&r(t),t.state=new BN(t,{copyState:i}),zN(t);for(const s in R_){const u=R_[s];RN(t,s,u)}B_(t,"getParameter"),B_(t,"isEnabled")}return t.state.enable=n,t}function ON(t){t.state||Wb(t,{copyState:!1}),t.state.push()}function O_(t){bs(t.state),t.state.pop()}function n0(t,e){if(bs(l3(t),"setParameters requires a WebGL context"),Hb(e))return;const n={};for(const r in e){const s=Number(r),u=kN[r];u&&(typeof u=="string"?n[u]=!0:u(t,e[r],s))}const i=t.state&&t.state.cache;if(i)for(const r in n){const s=LN[r];s(t,e,i)}}function FN(t,e){if(e=e||ug,typeof e=="number"){const r=e,s=z_[r];return s?s(t,r):t.getParameter(r)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const s=z_[r];i[r]=s?s(t,Number(r)):t.getParameter(Number(r))}return i}function NN(t){n0(t,ug)}function da(t,e,n){if(Hb(e))return n(t);const{nocatch:i=!0}=e;ON(t),n0(t,e);let r;if(i)r=n(t),O_(t);else try{r=n(t)}finally{O_(t)}return r}function c1(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function Um(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=c1(t),r=t.drawingBufferWidth,s=t.drawingBufferHeight;return VN(e,i,r,s,n)}function UN(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function VN(t,e,n,i,r){const s=F_(t[0],e,n);let u=N_(t[1],e,i,r),a=F_(t[0]+1,e,n);const y=a===n-1?a:a-1;a=N_(t[1]+1,e,i,r);let w;return r?(a=a===0?a:a+1,w=u,u=a):w=a===i-1?a:a-1,{x:s,y:u,width:Math.max(y-s+1,1),height:Math.max(w-u+1,1)}}function F_(t,e,n){return Math.min(Math.round(t*e),n-1)}function N_(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const hg=C1(),GN=hg&&typeof document<"u",$b={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function qb(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bs(hg,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},$b,t);const{width:e,height:n}=t;function i(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=i;let r;const{canvas:s}=t,u=$N({canvas:s,width:e,height:n,onError:i});return r=WN(u,t),r?(r=fg(r,t),qN(r),r):null}function fg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||ZN(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},$b,e);const{manageState:n,debug:i}=e;return n&&Wb(t,{copyState:!1,log:function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];return cn.log(1,...s)()}}),hg&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),cn.level=Math.max(cn.level,1)):cn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function jN(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info"),r=i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),s=i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function HN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const i=UN(e.useDevicePixels);XN(t,i,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function WN(t,e){const{onError:n}=e;let i=null;const r=y=>i=y.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:u=!0}=e;let a=null;return u&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(u&&!s?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function $N(t){let{canvas:e,width:n=800,height:i=600,onError:r}=t,s;return typeof e=="string"?(GN&&document.readyState==="complete"||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function qN(t){const e=Kn(t)?"WebGL2":"WebGL1",n=jN(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";cn.info(1,"".concat(e).concat(r," context ").concat(i))()}function ZN(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function XN(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;(!i||!r)&&(cn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let u=e;const a=Math.floor(i*u),y=Math.floor(r*u);t.canvas.width=a,t.canvas.height=y,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==y)&&(cn.warn("Device pixel ratio clamped")(),u=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*u),t.canvas.height=Math.floor(r*u)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}function U_(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let V_=class{constructor(e,n){Z(this,"name",void 0),Z(this,"type",void 0),Z(this,"sampleSize",1),Z(this,"time",void 0),Z(this,"count",void 0),Z(this,"samples",void 0),Z(this,"lastTiming",void 0),Z(this,"lastSampleTime",void 0),Z(this,"lastSampleCount",void 0),Z(this,"_count",0),Z(this,"_time",0),Z(this,"_samples",0),Z(this,"_startTime",0),Z(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=U_(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(U_()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},QN=class{constructor(e){Z(this,"id",void 0),Z(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof V_?this.stats[n]=e:this.stats[n]=new V_(n,i)),this.stats[n]}};function Zb(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Xb(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||Zb()}const Vm=globalThis;function YN(t){if(!t&&!Xb())return"Node";if(Zb(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":Vm.chrome?"Chrome":Vm.safari?"Safari":Vm.mozInnerScreenX?"Firefox":"Unknown"}const Ff="8.5.21",KN="set luma.log.level=1 (or higher) to trace rendering";class JN{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new QN({id:e})),this.stats.get(e)}}const Qc=new JN;if(globalThis.luma&&globalThis.luma.VERSION!==Ff)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Ff));globalThis.luma||(Xb()&&cn.log(1,"luma.gl ".concat(Ff," - ").concat(KN))(),globalThis.luma=globalThis.luma||{VERSION:Ff,version:Ff,log:cn,stats:Qc,globals:{modules:{},nodeIO:{}}});function eU(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function tU(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Ht(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Gm(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const i=t[e];return Ht(i!==void 0,"Accessing undefined constant GL.".concat(e)),i}function Z0(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const jm={};function sc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";jm[t]=jm[t]||1;const e=jm[t]++;return"".concat(t,"-").concat(e)}function G_(t){return Ht(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function u1(t){let e=!0;for(const n in t){e=!1;break}return e}function Qb(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);i.forEach(u=>{s.methodName||(s[u]=()=>{throw cn.removed("Calling removed method ".concat(e,".").concat(u,": "),r)(),new Error(u)})})}const yh="Resource subclass must define virtual methods";let u0=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c3(e);const{id:i,userData:r={}}=n;this.gl=e,this.gl2=e,this.id=i||sc(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(i=>i.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Gm(this.gl,e),Ht(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=Kn(this.gl);if(!((!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const a=r.webgl1,y="webgl2"in r?r.webgl2:r.webgl1;return s?y:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:i}=e,r=this.constructor.PARAMETERS||{},s=Kn(this.gl),u={},a=n||Object.keys(r);for(const y of a){const w=r[y];if(w&&(!("webgl2"in w)||s)&&(!("extension"in w)||this.gl.getExtension(w.extension))){const R=i?Z0(this.gl,y):y;u[R]=this.getParameter(y,e),i&&w.type==="GLenum"&&(u[R]=Z0(this.gl,u[R]))}}return u}setParameter(e,n){e=Gm(this.gl,e),Ht(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=Kn(this.gl);if(!((!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");r.type==="GLenum"&&(n=Gm(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,i){return Qb(this,e,n,i)}initialize(e){}_createHandle(){throw new Error(yh)}_deleteHandle(){throw new Error(yh)}_bindHandle(e){throw new Error(yh)}_getOptsFromHandle(){throw new Error(yh)}_getParameter(e,n){throw new Error(yh)}_setParameter(e,n){throw new Error(yh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Qc.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Qc.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const r=Qc.get("Memory Usage".concat(i));r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=Qc.get("Memory Usage".concat(n));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const nU="Failed to deduce GL constant from typed array";function u5(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(nU)}}function i2(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function iU(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:s}=t;const u=n*r;s=s||new Uint8Array(u);for(let a=0;a<i/2;++a){const y=a*u,w=(i-a-1)*u;s.set(e.subarray(y,y+u)),e.copyWithin(y,w,w+u),e.set(s,w)}}function rU(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),s=Math.round(i/2),u=new Uint8Array(r*s*4);for(let a=0;a<s;a++)for(let y=0;y<r;y++)for(let w=0;w<4;w++)u[(a*r+y)*4+w]=e[(a*2*n+y*2)*4+w];return{data:u,width:r,height:s}}function h5(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=n;for(const a in i)if(a in e){const w=i[a]?"".concat(t,".").concat(i[a]):"N/A";cn.removed("".concat(t,".").concat(a),w)()}for(const a in r)if(a in e){const y=r[a];cn.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(y))()}let u=null;for(const a in s)if(a in e){const y=s[a];cn.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(y))(),u=u||Object.assign({},e),u[y]=e[a],delete u[a]}return u||e}const sU={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},oU={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class uo{static getBytesPerElement(e){return i2(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Ht(e.size),i2(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new uo(sU,...n)}constructor(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return uo.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return uo.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=h5("Accessor",e,oU),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const j_=10,Yb={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},aU={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Yb},lU={removedProps:Yb};class vi extends u0{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/uo.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/uo.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=h5("Buffer",e,aU),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=h5("Buffer",e,lU),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new uo(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;Ht(n);const u=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(u,this.handle),r!==0||s!==void 0?(ls(this.gl),this.gl.bufferSubData(this.target,i,n,r,s)):this.gl.bufferSubData(u,i,n),this.gl.bindBuffer(u,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:i=0,writeOffset:r=0,size:s}=e;const{gl:u}=this;return ls(u),u.bindBuffer(36662,n.handle),u.bindBuffer(36663,this.handle),u.copyBufferSubData(36662,36663,i,r,s),u.bindBuffer(36662,null),u.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:i=0,length:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ls(this.gl);const s=i2(this.accessor.type||5126,{clamped:!1}),u=this._getAvailableElementCount(n),a=i;let y,w;e?(w=e.length,y=w-a):(y=Math.min(u,r||u),w=a+y);const I=Math.min(u,y);return r=r||I,Ht(r<=I),e=e||new s(w),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?r!==void 0?this.gl.bindBufferRange(e,n,this.handle,i,r):(Ht(i===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(j_,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Ht(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,n,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,j_),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=u5(e);return Ht(s),this.setAccessor(new uo(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Ht(e>=0),this._trackDeallocatedMemory();let i=e;e===0&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,n),this.gl.bindBuffer(r,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=i2(this.accessor.type||5126,{clamped:!1}),i=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new uo(this.accessor,{type:u5(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return cn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return cn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return cn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return cn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new uo(this.accessor,e),this}}const Ag={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},Kb={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Jb={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function cU(t,e){const n=Ag[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const i=Kn(t)&&n.gl2||n.gl1;return typeof i=="string"?t.getExtension(i):i}function uU(t,e){const n=Ag[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const hU=[9729,9728],H_=globalThis.WebGLBuffer||function(){};class lu extends u0{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:i,linearFiltering:r}=n;let s=!0;return i&&(s=s&&cU(e,i),s=s&&(!r||uU(e,i))),s}constructor(e,n){const{id:i=sc("texture"),handle:r,target:s}=n;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(ie=>this.initialize(Object.assign({},e,{pixels:ie,data:ie}))),this;const i=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(i&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:u=0,recreate:a=!1,parameters:y={},pixelStore:w={},textureUnit:I=void 0}=e;n||(n=r);let{width:R,height:D,dataFormat:U,type:q,compressed:ne=!1,mipmaps:pe=!0}=e;const{depth:J=0}=e;return{width:R,height:D,compressed:ne,dataFormat:U,type:q}=this._deduceParameters({format:s,type:q,dataFormat:U,compressed:ne,data:n,width:R,height:D}),this.width=R,this.height=D,this.depth=J,this.format=s,this.type=q,this.dataFormat=U,this.border=u,this.textureUnit=I,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),pe&&this._isNPOT()&&(cn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),pe=!1,this._updateForNPOT(y)),this.mipmaps=pe,this.setImageData({data:n,width:R,height:D,depth:J,format:s,type:q,dataFormat:U,border:u,mipmaps:pe,parameters:w,compressed:ne}),pe&&this.generateMipmap(),this.setParameters(y),a&&(this.data=n),i&&(this._video={video:n,parameters:y,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:i,mipmaps:r=!1}=e;return i!==this.width||n!==this.height?this.initialize({width:i,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(cn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),da(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:i=null,level:r=0,format:s=this.format,border:u=this.border,offset:a=0,parameters:y={}}=e;let{data:w=null,type:I=this.type,width:R=this.width,height:D=this.height,dataFormat:U=this.dataFormat,compressed:q=!1}=e;w||(w=i),{type:I,dataFormat:U,compressed:q,width:R,height:D}=this._deduceParameters({format:s,type:I,dataFormat:U,compressed:q,data:w,width:R,height:D});const{gl:ne}=this;ne.bindTexture(this.target,this.handle);let pe=null;({data:w,dataType:pe}=this._getDataType({data:w,compressed:q}));let J,ie=0;if(da(this.gl,y,()=>{switch(pe){case"null":ne.texImage2D(n,r,s,R,D,u,U,I,w);break;case"typed-array":ne.texImage2D(n,r,s,R,D,u,U,I,w,a);break;case"buffer":J=ls(ne),J.bindBuffer(35052,w.handle||w),J.texImage2D(n,r,s,R,D,u,U,I,a),J.bindBuffer(35052,null);break;case"browser-object":Kn(ne)?ne.texImage2D(n,r,s,R,D,u,U,I,w):ne.texImage2D(n,r,s,U,I,w);break;case"compressed":for(const[re,ge]of w.entries())ne.compressedTexImage2D(n,re,ge.format,ge.width,ge.height,u,ge.data),ie+=ge.levelSize;break;default:Ht(!1,"Unknown image data type")}}),pe==="compressed")this._trackAllocatedMemory(ie,"Texture");else if(w&&w.byteLength)this._trackAllocatedMemory(w.byteLength,"Texture");else{const re=Kb[this.dataFormat]||4,ge=Jb[this.type]||1;this._trackAllocatedMemory(this.width*this.height*re*ge,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:i=null,data:r=null,x:s=0,y:u=0,width:a=this.width,height:y=this.height,level:w=0,format:I=this.format,type:R=this.type,dataFormat:D=this.dataFormat,compressed:U=!1,offset:q=0,border:ne=this.border,parameters:pe={}}=e;if({type:R,dataFormat:D,compressed:U,width:a,height:y}=this._deduceParameters({format:I,type:R,dataFormat:D,compressed:U,data:r,width:a,height:y}),Ht(this.depth===0,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const J=r;r=J.data,a=J.shape[0],y=J.shape[1]}r instanceof vi&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),da(this.gl,pe,()=>{if(U)this.gl.compressedTexSubImage2D(n,w,s,u,a,y,I,r);else if(r===null)this.gl.texSubImage2D(n,w,s,u,a,y,D,R,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(n,w,s,u,a,y,D,R,r,q);else if(r instanceof H_){const J=ls(this.gl);J.bindBuffer(35052,r),J.texSubImage2D(n,w,s,u,a,y,D,R,q),J.bindBuffer(35052,null)}else Kn(this.gl)?ls(this.gl).texSubImage2D(n,w,s,u,a,y,D,R,r):this.gl.texSubImage2D(n,w,s,u,D,R,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return cn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:i=!1}=e;return i?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof vi?{data:n.handle,dataType:"buffer"}:n instanceof H_?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:i}=e;let{width:r,height:s,dataFormat:u,type:a,compressed:y}=e;const w=Ag[n];return u=u||w&&w.dataFormat,a=a||w&&w.types[0],y=y||w&&w.compressed,{width:r,height:s}=this._deduceImageSize(i,r,s),{dataFormat:u,type:a,compressed:y,width:r,height:s,format:n,data:i}}_deduceImageSize(e,n,i){let r;return typeof ImageData<"u"&&e instanceof ImageData?r={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?r={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?r={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?r={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?r={width:e.videoWidth,height:e.videoHeight}:e?r={width:n,height:i}:r={width:n>=0?n:1,height:i>=0?i:1},Ht(r,"Could not deduced texture size"),Ht(n===void 0||r.width===n,"Deduced texture width does not match supplied width"),Ht(i===void 0||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Ht(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Kn(this.gl)||!this.width||!this.height?!1:!G_(this.width)||!G_(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:hU.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let fU="";function AU(t,e){return Ht(typeof t=="string"),t=fU+t,new Promise((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error("Could not load image ".concat(t,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=t}catch(r){i(r)}})}class Ws extends lu{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return lu.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c3(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:AU(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const f5=[34069,34070,34071,34072,34073,34074];class eE extends lu{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c3(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:i={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(i)}),this}subImage(e){let{face:n,data:i,x:r=0,y:s=0,mipmapLevel:u=0}=e;return this._subImage({target:n,data:i,x:r,y:s,mipmapLevel:u})}async setCubeMapImageData(e){let{width:n,height:i,pixels:r,data:s,border:u=0,format:a=6408,type:y=5121}=e;const{gl:w}=this,I=r||s,R=await Promise.all(f5.map(D=>{const U=I[D];return Promise.all(Array.isArray(U)?U:[U])}));this.bind(),f5.forEach((D,U)=>{R[U].length>1&&this.opts.mipmaps!==!1&&cn.warn("".concat(this.id," has mipmap and multiple LODs."))(),R[U].forEach((q,ne)=>{n&&i?w.texImage2D(D,ne,a,n,i,u,a,y,q):w.texImage2D(D,ne,a,a,y,q)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:i,height:r,pixels:s,data:u,border:a=0,format:y=6408,type:w=5121}=e,{gl:I}=this,R=s||u;return this.bind(),R instanceof Promise?R.then(D=>this.setImageDataForFace(Object.assign({},e,{face:n,data:D,pixels:D}))):this.width||this.height?I.texImage2D(n,0,y,i,r,a,y,w,R):I.texImage2D(n,0,y,y,w,R),this}}eE.FACES=f5;class dU extends lu{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Kn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ls(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:i=6408,width:r,height:s,depth:u=1,border:a=0,format:y,type:w=5121,offset:I=0,data:R,parameters:D={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),da(this.gl,D,()=>{ArrayBuffer.isView(R)&&this.gl.texImage3D(this.target,n,i,r,s,u,a,y,w,R),R instanceof vi&&(this.gl.bindBuffer(35052,R.handle),this.gl.texImage3D(this.target,n,i,r,s,u,a,y,w,I))}),R&&R.byteLength)this._trackAllocatedMemory(R.byteLength,"Texture");else{const U=Kb[this.dataFormat]||4,q=Jb[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*U*q,"Texture")}return this.loaded=!0,this}}const Vc="EXT_color_buffer_float",W_={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Vc,bpp:2},33327:{gl2:Vc,bpp:4},34842:{gl2:Vc,bpp:8},33326:{gl2:Vc,bpp:4},33328:{gl2:Vc,bpp:8},34836:{gl2:Vc,bpp:16},35898:{gl2:Vc,bpp:4}};function pU(t,e,n){const i=n[e];if(!i)return!1;const r=Kn(t)&&i.gl2||i.gl1;return typeof r=="string"?t.getExtension(r):r}class Ph extends u0{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||pU(e,n,W_)}static getSamplesForFormat(e,n){let{format:i}=n;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:i=1,height:r=1,samples:s=0}=e;return Ht(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&Kn(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,i,r):this.gl.renderbufferStorage(36161,n,i,r),this.format=n,this.width=i,this.height=r,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*W_[this.format].bpp),this}resize(e){let{width:n,height:i}=e;return n!==this.width||i!==this.height?this.initialize({width:n,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const mU=256,gU=1024,_U=16384,$_=6144,q_=6145,Z_=6146,X_=34041,tE="clear: bad arguments";function dg(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let u=0;n&&(u|=_U,n!==!0&&(s.clearColor=n)),i&&(u|=mU,i!==!0&&(s.clearDepth=i)),r&&(u|=gU,i!==!0&&(s.clearStencil=i)),Ht(u!==0,tE),da(t,s,()=>{t.clear(u)})}function yU(t){let{framebuffer:e=null,buffer:n=$_,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ls(t),da(t,{framebuffer:e},()=>{switch(n){case $_:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case q_:t.clearBufferfv(q_,0,[r]);break;case Z_:t.clearBufferiv(Z_,0,[r]);break;case X_:const[s,u]=r;t.clearBufferfi(X_,0,s,u);break;default:Ht(!1,tE)}})}function vU(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Ht(!1),0}}function u3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:u=null,sourceWidth:a,sourceHeight:y,sourceType:w}=e;const{framebuffer:I,deleteFramebuffer:R}=nE(t);Ht(I);const{gl:D,handle:U,attachments:q}=I;a=a||I.width,y=y||I.height,s===36064&&U===null&&(s=1028),Ht(q[s]),w=w||q[s].type,u=wU(u,w,r,a,y),w=w||u5(u);const ne=D.bindFramebuffer(36160,U);return D.readPixels(n,i,a,y,r,w,u),D.bindFramebuffer(36160,ne||null),R&&I.delete(),u}function Q_(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=u3(t,{sourceAttachment:e}),{width:r,height:s}=t;for(;s>n;)({data:i,width:r,height:s}=rU({data:i,width:r,height:s}));iU({data:i,width:r,height:s});const u=document.createElement("canvas");u.width=r,u.height=s;const a=u.getContext("2d"),y=a.createImageData(r,s);return y.data.set(i),a.putImageData(y,0,0),u.toDataURL()}function xU(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:u=6408}=n;let{targetX:a,targetY:y,targetZ:w,width:I,height:R}=n;const{framebuffer:D,deleteFramebuffer:U}=nE(t);Ht(D);const{gl:q,handle:ne}=D,pe=typeof a<"u"||typeof y<"u"||typeof w<"u";a=a||0,y=y||0,w=w||0;const J=q.bindFramebuffer(36160,ne);Ht(e);let ie=null;if(e instanceof lu&&(ie=e,I=Number.isFinite(I)?I:ie.width,R=Number.isFinite(R)?R:ie.height,ie.bind(0),e=ie.target),!pe)q.copyTexImage2D(e,s,u,i,r,I,R,0);else switch(e){case 3553:case 34067:q.copyTexSubImage2D(e,s,a,y,i,r,I,R);break;case 35866:case 32879:ls(q).copyTexSubImage3D(e,s,a,y,w,i,r,I,R);break}return ie&&ie.unbind(),q.bindFramebuffer(36160,J||null),U&&D.delete(),ie}function nE(t){return t instanceof vr?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:kU(t),deleteFramebuffer:!0}}function wU(t,e,n,i,r){if(t)return t;e=e||5121;const s=i2(e,{clamped:!1}),u=vU(n);return new s(i*r*u)}const Pi={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function bU(t){const e=new Ws(t,{format:6408,type:5126,dataFormat:6408}),n=new vr(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),i===36053}const iE={[Pi.WEBGL2]:[!1,!0],[Pi.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Pi.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Pi.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Pi.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Pi.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Pi.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Pi.FLOAT_BLEND]:["EXT_float_blend"],[Pi.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Pi.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Pi.TEXTURE_FLOAT]:["OES_texture_float",!0],[Pi.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Pi.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Pi.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Pi.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Pi.COLOR_ATTACHMENT_RGBA32F]:[bU,"EXT_color_buffer_float"],[Pi.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Pi.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Pi.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Pi.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Pi.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Pi.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},EU=2;function rE(t,e){return pg(t,e)}function pg(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>sE(t,n))}function TU(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in iE)t.luma.caps[e]===void 0&&(t.luma.caps[e]=sE(t,e));return t.luma.caps}function sE(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=SU(t,e)),t.luma.caps[e]||cn.log(EU,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function SU(t,e){const n=iE[e];Ht(n,e);let i;const r=Kn(t)&&n[1]||n[0];if(typeof r=="function")i=r(t);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&!!t.getExtension(s)}else typeof r=="string"?i=!!t.getExtension(r):typeof r=="boolean"?i=r:Ht(!1);return i}const Y_="Multiple render targets not supported";class vr extends u0{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=n;let s=!0;return i&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new vr(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=ls(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=ls(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:i=1,attachments:r=null,color:s=!0,depth:u=!0,stencil:a=!1,check:y=!0,readBuffer:w=void 0,drawBuffers:I=void 0}=e;if(Ht(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,r)for(const R in r){const D=r[R];(Array.isArray(D)?D[0]:D).resize({width:n,height:i})}else r=this._createDefaultAttachments(s,u,a,n,i);this.update({clearAttachments:!0,attachments:r,readBuffer:w,drawBuffers:I}),r&&y&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:i,drawBuffers:r,clearAttachments:s=!1,resizeAttachments:u=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:u});const{gl:a}=this,y=a.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),a.bindFramebuffer(36160,y||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:i}=e;if(this.handle===null)return Ht(n===void 0&&i===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),i===void 0&&(i=this.gl.drawingBufferHeight),n!==this.width&&i!==this.height&&cn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:n,height:i});return this.width=n,this.height=i,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:i=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={};n&&Object.keys(this.attachments).forEach(u=>{r[u]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const u in r){Ht(u!==void 0,"Misspelled framebuffer binding point?");const a=Number(u),y=r[a];let w=y;if(!w)this._unattach(a);else if(w instanceof Ph)this._attachRenderbuffer({attachment:a,renderbuffer:w});else if(Array.isArray(y)){const[I,R=0,D=0]=y;w=I,this._attachTexture({attachment:a,texture:I,layer:R,level:D})}else this._attachTexture({attachment:a,texture:w,layer:0,level:0});i&&w&&w.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(u=>!this.attachments[u]).forEach(u=>{delete this.attachments[u]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(PU(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),i}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:i,stencil:r,drawBuffers:s=[]}=e,u=this.gl.bindFramebuffer(36160,this.handle);return(n||i||r)&&dg(this.gl,{color:n,depth:i,stencil:r}),s.forEach((a,y)=>{yU(this.gl,{drawBuffer:y,value:a})}),this.gl.bindFramebuffer(36160,u||null),this}readPixels(){return cn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return cn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return cn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return cn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return cn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return cn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:i=0,y:r=0,width:s,height:u}=e;const a=ls(this.gl),y=a.bindFramebuffer(36008,this.handle);return i===0&&r===0&&s===void 0&&u===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,i,r,s,u),a.bindFramebuffer(36008,y),this}getAttachmentParameter(e,n,i){let r=this._getAttachmentParameterFallback(n);return r===null&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=Z0(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const s of i){const u=n?Z0(this.gl,s):s;r[u]=this.getAttachmentParameter(e,s,n)}return r}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),i={};for(const r of n){const s=Number(r),u=e?Z0(this.gl,s):s;i[u]=this.getAttachmentParameters(s,e)}return i}show(){return typeof window<"u"&&window.open(Q_(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>cn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const i=Q_(this,{targetMaxHeight:100});return cn.image({logLevel:e,message:n,image:i},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,i,r,s){let u=null;return e&&(u=u||{},u[36064]=new Ws(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(u[36064])),n&&i?(u=u||{},u[33306]=new Ph(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(u[33306])):n?(u=u||{},u[36096]=new Ph(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:s}),this.ownResources.push(u[36096])):i&&Ht(!1),u}_unattach(e){const n=this.attachments[e];n&&(n instanceof Ph?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,n,36161,i.handle),this.attachments[n]=i}_attachTexture(e){let{attachment:n=36064,texture:i,layer:r,level:s}=e;const{gl:u}=this;switch(u.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:ls(u).framebufferTextureLayer(36160,n,i.target,s,r);break;case 34067:const y=CU(r);u.framebufferTexture2D(36160,n,y,i.handle,s);break;case 3553:u.framebufferTexture2D(36160,n,3553,i.handle,s);break;default:Ht(!1,"Illegal texture type")}u.bindTexture(i.target,null),this.attachments[n]=i}_setReadBuffer(e){const n=tN(this.gl);n?n.readBuffer(e):Ht(e===36064||e===1029,Y_),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,i=ls(n);if(i)i.drawBuffers(e);else{const r=n.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):Ht(e.length===1&&(e[0]===36064||e[0]===1029),Y_)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=TU(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function CU(t){return t<34069?t+34069:t}function PU(t){return(vr.STATUS||{})[t]||"Framebuffer error ".concat(t)}const MU=[36049,36048,33296,33298,33299,33300,33301,33302,33303];vr.ATTACHMENT_PARAMETERS=MU;function IU(t,e){Ht(t instanceof Ws||t instanceof eE||t instanceof dU);const n=t.constructor,{gl:i,width:r,height:s,format:u,type:a,dataFormat:y,border:w,mipmaps:I}=t,R=Object.assign({width:r,height:s,format:u,type:a,dataFormat:y,border:w,mipmaps:I},e);return new n(i,R)}function kU(t,e){const{gl:n,width:i,height:r,id:s}=t;return new vr(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:i,height:r,attachments:{36064:t}}))}function Td(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}const LU=35632,DU=35633;function RU(t){switch(t){case LU:return"fragment";case DU:return"vertex";default:return"unknown type"}}function zU(t,e,n,i){const r=t.split(/\r?\n/),s={},u={},a=i||Td(e)||"(unnamed)",y="".concat(RU(n)," shader ").concat(a);for(let I=0;I<r.length;I++){const R=r[I];if(R.length<=1)continue;const D=R.split(":"),U=D[0],q=parseInt(D[2],10);if(isNaN(q))throw new Error("GLSL compilation error in ".concat(y,": ").concat(t));U!=="WARNING"?s[q]=R:u[q]=R}const w=BU(e);return{shaderName:y,errors:K_(s,w),warnings:K_(u,w)}}function K_(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if(!(!t[i+3]&&!t[i+2]&&!t[i+1])&&(n+="".concat(r,`
`),t[i+1])){const s=t[i+1],u=s.split(":",3),a=u[0],y=parseInt(u[1],10)||0,w=s.substring(u.join(":").length+1).trim();n+=oE("^^^ ".concat(a,": ").concat(w,`

`),y)}}return n}function BU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,u)=>{const a=String(u+e),y=a.length;return oE(a,r-y)+n+s})}function oE(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}function aE(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const i=parseInt(n[1],10);Number.isFinite(i)&&(e=i)}return e}const OU="Shader: GLSL source code must be a JavaScript string";class r2 extends u0{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Ht(!1),"unknown"}}constructor(e,n){c3(e),Ht(typeof n.source=="string",OU);const i=Td(n.source,null)||n.id||sc("unnamed ".concat(r2.getTypeName(n.shaderType)));super(e,{id:i}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const i=Td(n,null);i&&(this.id=sc(i)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(r2.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Td(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:u}=zU(i,this.source,this.shaderType,this.id);throw cn.error("GLSL compilation errors in ".concat(r,`
`).concat(s))(),cn.warn("GLSL compilation warnings in ".concat(r,`
`).concat(u))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Hm extends r2{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Wm extends r2{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const FU={5126:Li.bind(null,"uniform1fv",so,1,Jr),35664:Li.bind(null,"uniform2fv",so,2,Jr),35665:Li.bind(null,"uniform3fv",so,3,Jr),35666:Li.bind(null,"uniform4fv",so,4,Jr),5124:Li.bind(null,"uniform1iv",D0,1,Jr),35667:Li.bind(null,"uniform2iv",D0,2,Jr),35668:Li.bind(null,"uniform3iv",D0,3,Jr),35669:Li.bind(null,"uniform4iv",D0,4,Jr),35670:Li.bind(null,"uniform1iv",D0,1,Jr),35671:Li.bind(null,"uniform2iv",D0,2,Jr),35672:Li.bind(null,"uniform3iv",D0,3,Jr),35673:Li.bind(null,"uniform4iv",D0,4,Jr),35674:Li.bind(null,"uniformMatrix2fv",so,4,Bl),35675:Li.bind(null,"uniformMatrix3fv",so,9,Bl),35676:Li.bind(null,"uniformMatrix4fv",so,16,Bl),35678:Nr,35680:Nr,5125:Li.bind(null,"uniform1uiv",CA,1,Jr),36294:Li.bind(null,"uniform2uiv",CA,2,Jr),36295:Li.bind(null,"uniform3uiv",CA,3,Jr),36296:Li.bind(null,"uniform4uiv",CA,4,Jr),35685:Li.bind(null,"uniformMatrix2x3fv",so,6,Bl),35686:Li.bind(null,"uniformMatrix2x4fv",so,8,Bl),35687:Li.bind(null,"uniformMatrix3x2fv",so,6,Bl),35688:Li.bind(null,"uniformMatrix3x4fv",so,12,Bl),35689:Li.bind(null,"uniformMatrix4x2fv",so,8,Bl),35690:Li.bind(null,"uniformMatrix4x3fv",so,12,Bl),35678:Nr,35680:Nr,35679:Nr,35682:Nr,36289:Nr,36292:Nr,36293:Nr,36298:Nr,36299:Nr,36300:Nr,36303:Nr,36306:Nr,36307:Nr,36308:Nr,36311:Nr},NU={},UU={},VU={},J_=[0];function mg(t,e,n,i){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(J_[0]=t,t=J_);const r=t.length;if(r%e&&cn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=i[r];s||(s=new n(r),i[r]=s);for(let u=0;u<r;u++)s[u]=t[u];return s}function so(t,e){return mg(t,e,Float32Array,NU)}function D0(t,e){return mg(t,e,Int32Array,UU)}function CA(t,e){return mg(t,e,Uint32Array,VU)}function ey(t,e,n){const i=FU[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function GU(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function jU(t,e,n){for(const i in t){const r=t[i];if((!n||!!n[i])&&!HU(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}return!0}function HU(t){return Array.isArray(t)||ArrayBuffer.isView(t)?$U(t):isFinite(t)||t===!0||t===!1||t instanceof lu||t instanceof Ph?!0:t instanceof vr?!!t.texture:!1}function WU(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let r=0,s=n.length;r<s;++r)i[r]=n[r]}else t[e]=n.slice();else t[e]=n}function $U(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Nr(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function Li(t,e,n,i){let r=null,s=null;return(u,a,y)=>{const w=e(y,n),I=w.length;let R=!1;if(r===null)r=new Float32Array(I),s=I,R=!0;else{Ht(s===I,"Uniform length cannot change.");for(let D=0;D<I;++D)if(w[D]!==r[D]){R=!0;break}}return R&&(i(u,t,a,w),r.set(w)),R}}function Jr(t,e,n,i){t[e](n,i)}function Bl(t,e,n,i){t[e](n,!1,i)}const qU=5120,ZU=5121,XU=5122,QU=5123,ty=0,PA=1,YU=2,KU=3,MA=4,JU=5,eV=6,gr=5126,tV=35664,nV=35665,iV=35666,hf=5124,rV=35667,sV=35668,oV=35669,ff=5125,aV=36294,lV=36295,cV=36296,uV=35670,hV=35671,fV=35672,AV=35673,dV=35674,pV=35675,mV=35676,gV=35685,_V=35686,yV=35687,vV=35688,xV=35689,wV=35690,A5={[gr]:[gr,1,"float"],[tV]:[gr,2,"vec2"],[nV]:[gr,3,"vec3"],[iV]:[gr,4,"vec4"],[hf]:[hf,1,"int"],[rV]:[hf,2,"ivec2"],[sV]:[hf,3,"ivec3"],[oV]:[hf,4,"ivec4"],[ff]:[ff,1,"uint"],[aV]:[ff,2,"uvec2"],[lV]:[ff,3,"uvec3"],[cV]:[ff,4,"uvec4"],[uV]:[gr,1,"bool"],[hV]:[gr,2,"bvec2"],[fV]:[gr,3,"bvec3"],[AV]:[gr,4,"bvec4"],[dV]:[gr,8,"mat2"],[gV]:[gr,8,"mat2x3"],[_V]:[gr,8,"mat2x4"],[pV]:[gr,12,"mat3"],[yV]:[gr,12,"mat3x2"],[vV]:[gr,12,"mat3x4"],[mV]:[gr,16,"mat4"],[xV]:[gr,16,"mat4x2"],[wV]:[gr,16,"mat4x3"]};function bV(t){switch(t){case ty:return ty;case PA:return PA;case KU:return PA;case YU:return PA;case MA:return MA;case JU:return MA;case eV:return MA;default:return Ht(!1),0}}function ny(t){const e=A5[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function lE(t,e){switch(t){case qU:case ZU:case XU:case QU:t=gr;break}for(const n in A5){const[i,r,s]=A5[n];if(i===t&&r===e)return{glType:n,name:s}}return null}class EV{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,i=n.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:u,size:a}=n.getActiveAttrib(e.handle,r),y=n.getAttribLocation(e.handle,s);y>=0&&this._addAttribute(y,s,u,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Kn(n))return;const i=n.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:u,size:a}=n.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,u,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,n,i,r){const{type:s,components:u}=ny(i),a={type:s,size:r*u};this._inferProperties(e,n,a);const y={location:e,name:n,accessor:new uo(a)};this.attributeInfos.push(y),this.attributeInfosByLocation[e]=y,this.attributeInfosByName[y.name]=y}_inferProperties(e,n,i){/instance/i.test(n)&&(i.divisor=1)}_addVarying(e,n,i,r){const{type:s,components:u}=ny(i),a=new uo({type:s,size:r*u}),y={location:e,name:n,accessor:a};this.varyingInfos.push(y),this.varyingInfosByName[y.name]=y}}const iy=4,TV=35981,SV=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class cE extends u0{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",SV),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:i,fs:r,varyings:s,bufferMode:u=TV}=e;return this.hash=n||"",this.vs=typeof i=="string"?new Hm(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs=typeof r=="string"?new Wm(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,Ht(this.vs instanceof Hm),Ht(this.fs instanceof Wm),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(ls(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,u)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new EV(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:i=4,vertexCount:r,offset:s=0,start:u,end:a,isIndexed:y=!1,indexType:w=5123,instanceCount:I=0,isInstanced:R=I>0,vertexArray:D=null,transformFeedback:U,framebuffer:q,parameters:ne={},uniforms:pe,samplers:J}=e;if((pe||J)&&(cn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(pe||{})),cn.priority>=n){const ie=q?q.id:"default",re="mode=".concat(Z0(this.gl,i)," verts=").concat(r," ")+"instances=".concat(I," indexType=").concat(Z0(this.gl,w)," ")+"isInstanced=".concat(R," isIndexed=").concat(y," ")+"Framebuffer=".concat(ie);cn.log(n,re)()}return Ht(D),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||r===0||R&&I===0?!1:(D.bindForDraw(r,I,()=>{if(q!==void 0&&(ne=Object.assign({},ne,{framebuffer:q})),U){const ie=bV(i);U.begin(ie)}this._bindTextures(),da(this.gl,ne,()=>{y&&R?this.gl2.drawElementsInstanced(i,r,w,s,I):y&&Kn(this.gl)&&!isNaN(u)&&!isNaN(a)?this.gl2.drawRangeElements(i,u,a,r,w,s):y?this.gl.drawElements(i,r,w,s):R?this.gl2.drawArraysInstanced(i,s,r,I):this.gl.drawArrays(i,s,r)}),U&&U.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};cn.priority>=2&&jU(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const i=e[n],r=this._uniformSetters[n];if(r){let s=i,u=!1;if(s instanceof vr&&(s=s.texture),s instanceof lu)if(u=this.uniforms[n]!==i,u){r.textureIndex===void 0&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:y}=r;a.bind(y),s=y,this._textureUniforms[n]=a}else s=r.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(r(s)||u)&&WU(this.uniforms,n,i)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const i=this._textureUniforms[n];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),i={};for(const r of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new Hm({handle:r});break;case 35632:i.fs=new Wm({handle:r});break}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=sc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),cn.time(iy,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),cn.timeEnd(iy,"linkProgram for ".concat(this._getName()))(),e.debug||cn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const i=this.gl.getActiveUniform(this.handle,n),{name:r}=GU(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=ey(e,s,i),i.size>1)for(let u=0;u<i.size;u++)s=e.getUniformLocation(this.handle,"".concat(r,"[").concat(u,"]")),this._uniformSetters["".concat(r,"[").concat(u,"]")]=ey(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const CV=34918,PV=34919,MV=35007,IV=36795,kV=35976,LV=35887,DV=36202;class gp extends u0{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=Kn(e),r=pg(e,Pi.TIMER_QUERY);let s=i||r;for(const u of n)switch(u){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:Ht(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(MV)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?DV:LV)}beginTransformFeedbackQuery(){return this.begin(kV)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,PV);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(IV)}getResult(){return this.gl2.getQueryParameter(this.handle,CV)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return gp.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class uE extends u0{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Kn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ls(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,u1(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:u}=this._getBufferParams(n);return i<0?(this.unused[e]=r,cn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=n,this.bindOnUse||this._bindBuffer(i,r,u,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,i,r;return e instanceof vi?r=e:(r=e.buffer,i=e.byteSize,n=e.byteOffset),(n!==void 0||i!==void 0)&&(n=n||0,i=i||r.byteLength-n),{buffer:r,byteOffset:n,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||r===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,i,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let IA=null;function RV(t){return(!IA||IA.byteLength<t)&&(IA=new ArrayBuffer(t)),IA}function zV(t,e){const n=RV(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function BV(t){let{target:e,source:n,start:i=0,count:r=1}=t;const s=n.length,u=r*s;let a=0;for(let y=i;a<s;a++)e[y++]=n[a];for(;a<u;)a<u-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+u-a),a=u);return e}const OV="elements must be GL.ELEMENT_ARRAY_BUFFER";class lo extends u0{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Kn(e)||YN()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new lo(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return lo.MAX_ATTRIBUTES=lo.MAX_ATTRIBUTES||e.getParameter(34921),lo.MAX_ATTRIBUTES}static setConstant(e,n,i){switch(i.constructor){case Float32Array:lo._setConstantFloatArray(e,n,i);break;case Int32Array:lo._setConstantIntArray(e,n,i);break;case Uint32Array:lo._setConstantUintArray(e,n,i);break;default:Ht(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:i})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return lo.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Ht(!e||e.target===34963,OV),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,i){if(n.target===34963)return this.setElementBuffer(n,i);const{size:r,type:s,stride:u,offset:a,normalized:y,integer:w,divisor:I}=i,{gl:R,gl2:D}=this;return e=Number(e),this.bind(()=>{R.bindBuffer(34962,n.handle),w?(Ht(Kn(R)),D.vertexAttribIPointer(e,r,s,u,a)):R.vertexAttribPointer(e,r,s,y,u,a),R.enableVertexAttribArray(e),D.vertexAttribDivisor(e,I||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!lo.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const i=this._normalizeConstantArrayValue(n),r=i.byteLength*e,s=i.length*e;let u=!this.buffer;if(this.buffer=this.buffer||new vi(this.gl,r),u=u||this.buffer.reallocate(r),u=u||!this._compareConstantArrayValues(i,this.bufferValue),u){const a=zV(n.constructor,s);BV({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==n[i])return!1;return!0}static _setConstantFloatArray(e,n,i){switch(i.length){case 1:e.vertexAttrib1fv(n,i);break;case 2:e.vertexAttrib2fv(n,i);break;case 3:e.vertexAttrib3fv(n,i);break;case 4:e.vertexAttrib4fv(n,i);break;default:Ht(!1)}}static _setConstantIntArray(e,n,i){switch(Ht(Kn(e)),i.length){case 1:e.vertexAttribI1iv(n,i);break;case 2:e.vertexAttribI2iv(n,i);break;case 3:e.vertexAttribI3iv(n,i);break;case 4:e.vertexAttribI4iv(n,i);break;default:Ht(!1)}}static _setConstantUintArray(e,n,i){switch(Ht(Kn(e)),i.length){case 1:e.vertexAttribI1uiv(n,i);break;case 2:e.vertexAttribI2uiv(n,i);break;case 3:e.vertexAttribI3uiv(n,i);break;case 4:e.vertexAttribI4uiv(n,i);break;default:Ht(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:i}=n;return Ht(Number.isFinite(i)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(i,e);default:return this.gl.getVertexAttrib(i,e)}})}}const FV="VertexArray: attributes must be Buffers or constants (i.e. typed array)",NV=/^(.+)__LOCATION_([0-9]+)$/,UV=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class VV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;this.id=i,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new lo(e),Qb(this,"VertexArray","v6.0",UV),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const i=e[n];this._setAttribute(n,i)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,i);return r>=0&&(this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,n,s)),this}setConstant(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},i));return r>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new vi(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof vi&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof vi&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),r=i()}),r}_resolveLocationAndAccessor(e,n,i,r){const s={location:-1,accessor:null},{location:u,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(u)||u<0)return this.unused[e]=n,cn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const y=this._getAttributeInfo(a||u);if(!y)return s;const w=this.accessors[u]||{},I=uo.resolve(y.accessor,w,i,r),{size:R,type:D}=I;return Ht(Number.isFinite(R)&&Number.isFinite(D)),{location:u,accessor:I}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const i=NV.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,n){if(n instanceof vi)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof vi){const i=n[0],r=n[1];this.setBuffer(e,i,r)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const i=n;this.setConstant(e,i)}else if(n.buffer instanceof vi){const i=n;this.setBuffer(e,i.buffer,i)}else throw new Error(FV)}_setConstantAttributes(e,n){const i=Math.max(e|0,n|0);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,n){if(lo.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const i=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,n){lo.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const i=this.values[n],r=this.accessors[n];if(!i)return;const{divisor:s}=r,u=s>0;if(e.isInstanced=e.isInstanced||u,i instanceof vi){const a=i;if(u){const y=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,y)}else{const y=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,y)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function GV(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let u=0;u<t.length&&u<n;++u)u>0&&(r+=",".concat(u%i===0?" ":"")),r+=s2(t[u],e);const s=t.length>n?"...":"]";return"".concat(r).concat(s)}function s2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return GV(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function ry(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;Ht(n);const s=".*_.*",u=".*Matrix",a=n._uniformSetters,y={},w=Object.keys(a).sort();let I=0;for(const U of w)!U.match(s)&&!U.match(u)&&$m({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&I++;for(const U of w)U.match(u)&&$m({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&I++;for(const U of w)y[U]||$m({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&I++;let R=0;const D={};if(!r)for(const U in i){const q=i[U];y[U]||(R++,D[U]={Type:"NOT USED: ".concat(q),[e]:s2(q)})}return{table:y,count:I,unusedTable:D,unusedCount:R}}function $m(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:s}=t;const u=i[r],a=jV(u);return!s||!a?(e[r]={[n]:a?s2(u):"N/A","Uniform Type":a?u:"NOT PROVIDED"},!0):!1}function jV(t){return t!=null}function HV(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=sy(e,e.elements,null,n));const r=e.values;for(const s in r){const u=e._getAttributeInfo(s);if(u){let a="".concat(s,": ").concat(u.name);const y=e.accessors[u.location];y&&(a="".concat(s,": ").concat(WV(u.name,y))),i[a]=sy(e,r[s],y,n)}}return i}function sy(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let s="NOT PROVIDED",u=1,a=0,y=0,w,I,R;if(n&&(s=n.type,u=n.size,s=String(s).replace("Array",""),w=s.indexOf("nt")!==-1),e instanceof vi){const D=e,{data:U,changed:q}=D.getDebugData();I=q?"*":"",R=U,y=D.byteLength,a=y/U.BYTES_PER_ELEMENT/u;let ne;if(n){const pe=n.divisor>0;ne="".concat(pe?"I ":"P "," ").concat(a," (x").concat(u,"=").concat(y," bytes ").concat(Z0(r,s),")")}else w=!0,ne="".concat(y," bytes");return{[i]:"".concat(I).concat(s2(R,{size:u,isInteger:w})),"Format ":ne}}return R=e,u=e.length,s=String(e.constructor.name).replace("Array",""),w=s.indexOf("nt")!==-1,{[i]:"".concat(s2(R,{size:u,isInteger:w})," (constant)"),"Format ":"".concat(u,"x").concat(s," (constant)")}}function WV(t,e){const{type:n,size:i}=e,r=lE(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function $V(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const r=oy(i);e["in ".concat(r)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const r=oy(i);e["out ".concat(r)]={[n]:JSON.stringify(i.accessor)}}return e}function oy(t){const{type:e,size:n}=t.accessor,i=lE(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}function qV(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function ZV(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||qV()}const ay=ZV()&&typeof document<"u";let XV=0;class QV{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=pe=>qb(pe),onAddHTML:i=null,onInitialize:r=()=>{},onRender:s=()=>{},onFinalize:u=()=>{},onError:a,gl:y=null,glOptions:w={},debug:I=!1,createFramebuffer:R=!1,autoResizeViewport:D=!0,autoResizeDrawingBuffer:U=!0,stats:q=Qc.get("animation-loop-".concat(XV++))}=e;let{useDevicePixels:ne=!0}=e;"useDevicePixelRatio"in e&&(cn.deprecated("useDevicePixelRatio","useDevicePixels")(),ne=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:u,onError:a,gl:y,glOptions:w,debug:I,createFramebuffer:R},this.gl=y,this.needsRedraw=null,this.timeline=null,this.stats=q,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:D,autoResizeDrawingBuffer:U,useDevicePixels:ne}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Ht(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=gp.isSupported(this.gl,["timers"])?new gp(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),i!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):n}setViewParameters(){return cn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=ay?new Promise((e,n)=>{if(ay&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):tU(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):eU(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?fg(this.props.gl,e):this.onCreateContext(e),!l3(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");NN(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const i=this.props.onAddHTML(n);i&&(n.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&n>0&&(i=e/n),{width:e,height:n,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&HN(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new vr(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const F2="vs",gg="fs";function fo(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const qm={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function YV(t){const e={};for(const n in t){const i=t[n],r=KV(i);e[n]=r}return e}function KV(t){let e=ly(t);return e==="object"?t?"type"in t?Object.assign({},t,qm[t.type]):"value"in t?(e=ly(t.value),Object.assign({type:e},t,qm[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},qm[e])}function ly(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const JV="vs",eG="fs";class cy{constructor(e){let{name:n,vs:i,fs:r,dependencies:s=[],uniforms:u,getUniforms:a,deprecations:y=[],defines:w={},inject:I={},vertexShader:R,fragmentShader:D}=e;fo(typeof n=="string"),this.name=n,this.vs=i||R,this.fs=r||D,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(y),this.defines=w,this.injections=tG(I),u&&(this.uniforms=YV(u))}getModuleSource(e){let n;switch(e){case JV:n=this.vs||"";break;case eG:n=this.fs||"";break;default:fo(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&fo(s.validate(e[r],s),"".concat(this.name,": invalid ").concat(r)),n[r]=e[r]):n[r]=s.value}return n}}function tG(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);typeof i=="string"&&(i={order:0,injection:i}),e[r][n]=i}return e}function nG(t){return iG(fE(t))}function iG(t){const e={},n={};return hE({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((i,r)=>n[r]-n[i]).map(i=>e[i])}function hE(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)i[s.name]=s,(r[s.name]===void 0||r[s.name]<n)&&(r[s.name]=n);for(const s of e)s.dependencies&&hE({modules:s.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function fE(t,e){return t.map(n=>(n instanceof cy||(fo(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),fo(n.name,"shader module has no name"),n=new cy(n),n.dependencies=fE(n.dependencies)),n))}function rG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r}const sG=7936,oG=7937,aG=7938,lG=35724,_g={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},$c={};Object.keys(_g).forEach(t=>{$c[t]=t});function cG(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function uG(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||sG),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||oG);return{gpuVendor:hG(n,i),vendor:n,renderer:i,version:t.getParameter(aG),shadingLanguageVersion:t.getParameter(lG)}}function hG(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Zm={};function uy(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=_g[e];if(fo(i,e),!rG(n))return!0;if(e in Zm)return Zm[e];const r=i[0],s=n.behavior||"enable",u="#extension GL_".concat(r," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,u),t.compileShader(a);const y=t.getShaderParameter(a,35713);return t.deleteShader(a),Zm[e]=y,y}function fG(t,e){const n=_g[e];fo(n,e);const i=cG(t)&&n[1]||n[0],r=typeof i=="string"?!!t.getExtension(i):i;return fo(r===!1||r===!0),r}function kA(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>fG(t,n))}function AG(t){switch(uG(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function dG(t,e,n){let i=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return kA(t,$c.GLSL_FRAG_DEPTH)&&(i+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),kA(t,$c.GLSL_DERIVATIVES)&&uy(t,$c.GLSL_DERIVATIVES)&&(i+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),kA(t,$c.GLSL_FRAG_DATA)&&uy(t,$c.GLSL_FRAG_DATA,{behavior:"require"})&&(i+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),kA(t,$c.GLSL_TEXTURE_LOD)&&(i+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),i}const pG=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,mG=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,gG={[F2]:pG,[gg]:mG},Sd="__LUMA_INJECT_DECLARATIONS__",hy=/void\s+main\s*\([^)]*\)\s*\{\n?/,fy=/}\n?[^{}]*$/,Xm=[];function Ay(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=e===F2;for(const s in n){const u=n[s];u.sort((y,w)=>y.order-w.order),Xm.length=u.length;for(let y=0,w=u.length;y<w;++y)Xm[y]=u[y].injection;const a="".concat(Xm.join(`
`),`
`);switch(s){case"vs:#decl":r&&(t=t.replace(Sd,a));break;case"vs:#main-start":r&&(t=t.replace(hy,y=>y+a));break;case"vs:#main-end":r&&(t=t.replace(fy,y=>a+y));break;case"fs:#decl":r||(t=t.replace(Sd,a));break;case"fs:#main-start":r||(t=t.replace(hy,y=>y+a));break;case"fs:#main-end":r||(t=t.replace(fy,y=>a+y));break;default:t=t.replace(s,y=>y+a)}}return t=t.replace(Sd,""),i&&(t=t.replace(/\}\s*$/,s=>s+gG[e])),t}function d5(t){const e={};return fo(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const i in n)e[i]=e[i]?"".concat(e[i],`
`).concat(n[i]):n[i]}),e}function h1(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const AE=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],_G=[...AE,[h1("attribute"),"in $1"],[h1("varying"),"out $1"]],yG=[...AE,[h1("varying"),"in $1"]],dE=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],vG=[...dE,[h1("in"),"attribute $1"],[h1("out"),"varying $1"]],xG=[...dE,[h1("in"),"varying $1"]],p5="gl_FragColor",m5=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,wG=/void\s+main\s*\([^)]*\)\s*\{\n?/;function bG(t,e,n){switch(e){case 300:return n?_p(t,_G):EG(t);case 100:return n?_p(t,vG):TG(t);default:throw new Error("unknown GLSL version ".concat(e))}}function _p(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}function EG(t){t=_p(t,yG);const e=t.match(m5);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(p5,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(wG,i=>"out vec4 ".concat(n,`;
`).concat(i)).replace(new RegExp("\\b".concat(p5,"\\b"),"g"),n)}return t}function TG(t){t=_p(t,xG);const e=t.match(m5);if(e){const n=e[1];t=t.replace(m5,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),p5)}return t}const SG=`

`.concat(Sd,`

`),pE={[F2]:"vertex",[gg]:"fragment"},CG=`precision highp float;

`;function PG(t,e){const{vs:n,fs:i}=e,r=nG(e.modules||[]);return{gl:t,vs:dy(t,Object.assign({},e,{source:n,type:F2,modules:r})),fs:dy(t,Object.assign({},e,{source:i,type:gg,modules:r})),getUniforms:MG(r)}}function dy(t,e){let{id:n,source:i,type:r,modules:s,defines:u={},hookFunctions:a=[],inject:y={},transpileToGLSL100:w=!1,prologue:I=!0,log:R}=e;fo(typeof i=="string","shader source must be a string");const D=r===F2,U=i.split(`
`);let q=100,ne="",pe=i;U[0].indexOf("#version ")===0?(q=300,ne=U[0],pe=U.slice(1).join(`
`)):ne="#version ".concat(q);const J={};s.forEach(qe=>{Object.assign(J,qe.getDefines())}),Object.assign(J,u);let ie=I?"".concat(ne,`
`).concat(kG({id:n,source:i,type:r}),`
`).concat(IG({type:r}),`
`).concat(AG(t),`
`).concat(dG(t),`
`).concat(LG(J),`
`).concat(D?"":CG,`
`):"".concat(ne,`
`);const re=RG(a),ge={},be={},De={};for(const qe in y){const et=typeof y[qe]=="string"?{injection:y[qe],order:0}:y[qe],ht=qe.match(/^(v|f)s:(#)?([\w-]+)$/);if(ht){const ot=ht[2],at=ht[3];ot?at==="decl"?be[qe]=[et]:De[qe]=[et]:ge[qe]=[et]}else De[qe]=[et]}for(const qe of s){R&&qe.checkDeprecations(pe,R);const et=qe.getModuleSource(r,q);ie+=et;const ht=qe.injections[r];for(const ot in ht){const at=ot.match(/^(v|f)s:#([\w-]+)$/);if(at){const ut=at[2]==="decl"?be:De;ut[ot]=ut[ot]||[],ut[ot].push(ht[ot])}else ge[ot]=ge[ot]||[],ge[ot].push(ht[ot])}}return ie+=SG,ie=Ay(ie,r,be),ie+=DG(re[r],ge),ie+=pe,ie=Ay(ie,r,De),ie=bG(ie,w?100:q,D),ie}function MG(t){return function(n){const i={};for(const r of t){const s=r.getUniforms(n,i);Object.assign(i,s)}return i}}function IG(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(pE[e].toUpperCase(),`
`)}function kG(t){let{id:e,source:n,type:i}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(pE[i],`

`):""}function LG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const i in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],`
`))}return e===0&&(n+=`
`),n}function DG(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature,` {
`),r.header&&(n+="  ".concat(r.header)),e[i]){const s=e[i];s.sort((u,a)=>u.order-a.order);for(const u of s)n+="  ".concat(u.injection,`
`)}r.footer&&(n+="  ".concat(r.footer)),n+=`}
`}return n}function RG(t){const e={vs:{},fs:{}};return t.forEach(n=>{let i;typeof n!="string"?(i=n,n=i.hook):i={},n=n.trim();const[r,s]=n.split(":"),u=n.replace(/\(.+/,"");e[r][u]=Object.assign(i,{signature:s})}),e}const zG="void main() {gl_FragColor = vec4(0);}",mE=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,BG=`#version 300 es
`.concat(mE);function gE(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,s]=n;if(!e.includes(i)||!r||!s)return null;const u=s.split(";")[0];return{qualifier:i,type:r,name:u}}function _E(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return e===300?BG:e>300?"#version ".concat(e,`
`).concat(mE):zG;const s=NG(n,i);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(i," ").concat(n,`;
out vec4 `).concat(r,`;
void main() {
  `).concat(r," = ").concat(s,`;
}`):"varying ".concat(i," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function OG(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return fo(!1),null}}function FG(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return fo(!1),null}}function NG(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return fo(!1),null}}const UG=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,VG={name:"fp32",vs:UG,fs:null};function o2(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Es={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function GG(t,{precision:e=Es.precision}={}){return t=jG(t),"".concat(parseFloat(t.toPrecision(e)))}function cu(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function j0(t,e,n){return WG(t,i=>Math.max(e,Math.min(n,i)))}function Ka(t,e,n){return cu(t)?t.map((i,r)=>Ka(i,e[r],n)):n*e+(1-n)*t}function Xl(t,e,n){const i=Es.EPSILON;n&&(Es.EPSILON=n);try{if(t===e)return!0;if(cu(t)&&cu(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!Xl(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Es.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Es.EPSILON=i}}function jG(t){return Math.round(t/Es.EPSILON)*Es.EPSILON}function HG(t){return t.clone?t.clone():new Array(t.length)}function WG(t,e,n){if(cu(t)){const i=t;n=n||HG(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}function $G(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class yg extends $G(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+n];return this.check()}toArray(e=[],n=0){for(let i=0;i<this.ELEMENTS;++i)e[n+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:cu(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Es)}formatString(e){let n="";for(let i=0;i<this.ELEMENTS;++i)n+=(i>0?", ":"")+GG(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Xl(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,i){if(i===void 0)return this.lerp(this,e,n);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(n[r]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),n[i]);return this.check()}add(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=n[i];return this.check()}subtract(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=n[i];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Es.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),n);return this.check()}get elements(){return this}}function qG(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function wi(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Nf(t,e,n=""){if(Es.debug&&!qG(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class yE extends yg{get x(){return this[0]}set x(e){this[0]=wi(e)}get y(){return this[1]}set y(e){this[1]=wi(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];n+=r*r}return wi(n)}dot(e){let n=0;for(let i=0;i<this.ELEMENTS;++i)n+=this[i]*e[i];return wi(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=n[i];return this.check()}divide(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=n[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return o2(e>=0&&e<this.ELEMENTS,"index is out of range"),wi(this[e])}setComponent(e,n){return o2(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Uf=1e-6,_a=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function ZG(){var t=new _a(2);return _a!=Float32Array&&(t[0]=0,t[1]=0),t}function g5(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function XG(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function QG(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function YG(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function KG(t,e){return t[0]=-e[0],t[1]=-e[1],t}function vE(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t}function JG(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function ej(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}var tj=XG;(function(){var t=ZG();return function(e,n,i,r,s,u){var a,y;for(n||(n=2),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,u),e[a]=t[0],e[a+1]=t[1];return e}})();function nj(t,e,n){const i=e[0],r=e[1],s=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/s,t[1]=(n[1]*i+n[5]*r)/s,t}function xE(t,e,n){const i=e[0],r=e[1],s=e[2],u=n[3]*i+n[7]*r+n[11]*s||1;return t[0]=(n[0]*i+n[4]*r+n[8]*s)/u,t[1]=(n[1]*i+n[5]*r+n[9]*s)/u,t[2]=(n[2]*i+n[6]*r+n[10]*s)/u,t}function ij(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}function rj(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3],t}function wE(t,e,n){const i=e[0],r=e[1],s=e[2];return t[0]=n[0]*i+n[3]*r+n[6]*s,t[1]=n[1]*i+n[4]*r+n[7]*s,t[2]=n[2]*i+n[5]*r+n[8]*s,t[3]=e[3],t}function bE(){var t=new _a(3);return _a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function sj(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function py(t,e,n){var i=new _a(3);return i[0]=t,i[1]=e,i[2]=n,i}function oj(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function aj(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function lj(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function cj(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function EE(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Cd(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[0],a=n[1],y=n[2];return t[0]=r*y-s*a,t[1]=s*u-i*y,t[2]=i*a-r*u,t}function uj(t,e,n,i){var r=e[0],s=e[1],u=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=u+i*(n[2]-u),t}function vg(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[3]*i+n[7]*r+n[11]*s+n[15];return u=u||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/u,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/u,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/u,t}function TE(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t}function SE(t,e,n){var i=n[0],r=n[1],s=n[2],u=n[3],a=e[0],y=e[1],w=e[2],I=r*w-s*y,R=s*a-i*w,D=i*y-r*a,U=r*D-s*R,q=s*I-i*D,ne=i*R-r*I,pe=u*2;return I*=pe,R*=pe,D*=pe,U*=2,q*=2,ne*=2,t[0]=a+I+U,t[1]=y+R+q,t[2]=w+D+ne,t}function hj(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function fj(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Aj(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function dj(t,e){var n=t[0],i=t[1],r=t[2],s=e[0],u=e[1],a=e[2],y=Math.sqrt(n*n+i*i+r*r),w=Math.sqrt(s*s+u*u+a*a),I=y*w,R=I&&EE(t,e)/I;return Math.acos(Math.min(Math.max(R,-1),1))}var CE=oj,PE=sj,Qm=aj;(function(){var t=bE();return function(e,n,i,r,s,u){var a,y;for(n||(n=3),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,u),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const Ym=[0,0,0];let LA;class Zt extends yE{static get ZERO(){return LA||(LA=new Zt(0,0,0),Object.freeze(LA)),LA}constructor(e=0,n=0,i=0){super(-0,-0,-0),arguments.length===1&&cu(e)?this.copy(e):(Es.debug&&(wi(e),wi(n),wi(i)),this[0]=e,this[1]=n,this[2]=i)}set(e,n,i){return this[0]=e,this[1]=n,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Es.debug&&(wi(e.x),wi(e.y),wi(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=wi(e)}angle(e){return dj(this,e)}cross(e){return Cd(this,this,e),this.check()}rotateX({radians:e,origin:n=Ym}){return hj(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Ym}){return fj(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Ym}){return Aj(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return vg(this,this,e),this.check()}transformAsVector(e){return xE(this,this,e),this.check()}transformByMatrix3(e){return TE(this,this,e),this.check()}transformByMatrix2(e){return ij(this,this,e),this.check()}transformByQuaternion(e){return SE(this,this,e),this.check()}}let DA;class xg extends yE{static get ZERO(){return DA||(DA=new xg(0,0,0,0),Object.freeze(DA)),DA}constructor(e=0,n=0,i=0,r=0){super(-0,-0,-0,-0),cu(e)&&arguments.length===1?this.copy(e):(Es.debug&&(wi(e),wi(n),wi(i),wi(r)),this[0]=e,this[1]=n,this[2]=i,this[3]=r)}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Es.debug&&(wi(e.x),wi(e.y),wi(e.z),wi(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=wi(e)}get w(){return this[3]}set w(e){this[3]=wi(e)}transform(e){return vg(this,this,e),this.check()}transformByMatrix3(e){return wE(this,this,e),this.check()}transformByMatrix2(e){return rj(this,this,e),this.check()}transformByQuaternion(e){return SE(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class ME extends yg{toString(){let e="[";if(Es.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,i){return this[n*this.RANK+e]=wi(i),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)n[r]=this[i+r];return n}setColumn(e,n){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=n[r];return this}}function pj(){var t=new _a(9);return _a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function mj(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function gj(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=e[4],a=e[5],y=e[6],w=e[7],I=e[8],R=I*u-a*w,D=-I*s+a*y,U=w*s-u*y,q=n*R+i*D+r*U;return q?(q=1/q,t[0]=R*q,t[1]=(-I*i+r*w)*q,t[2]=(a*i-r*u)*q,t[3]=D*q,t[4]=(I*n-r*y)*q,t[5]=(-a*n+r*s)*q,t[6]=U*q,t[7]=(-w*n+i*y)*q,t[8]=(u*n-i*s)*q,t):null}function _j(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],u=t[5],a=t[6],y=t[7],w=t[8];return e*(w*s-u*y)+n*(-w*r+u*a)+i*(y*r-s*a)}function my(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],I=e[7],R=e[8],D=n[0],U=n[1],q=n[2],ne=n[3],pe=n[4],J=n[5],ie=n[6],re=n[7],ge=n[8];return t[0]=D*i+U*u+q*w,t[1]=D*r+U*a+q*I,t[2]=D*s+U*y+q*R,t[3]=ne*i+pe*u+J*w,t[4]=ne*r+pe*a+J*I,t[5]=ne*s+pe*y+J*R,t[6]=ie*i+re*u+ge*w,t[7]=ie*r+re*a+ge*I,t[8]=ie*s+re*y+ge*R,t}function yj(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],I=e[7],R=e[8],D=n[0],U=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=u,t[4]=a,t[5]=y,t[6]=D*i+U*u+w,t[7]=D*r+U*a+I,t[8]=D*s+U*y+R,t}function vj(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],I=e[7],R=e[8],D=Math.sin(n),U=Math.cos(n);return t[0]=U*i+D*u,t[1]=U*r+D*a,t[2]=U*s+D*y,t[3]=U*u-D*i,t[4]=U*a-D*r,t[5]=U*y-D*s,t[6]=w,t[7]=I,t[8]=R,t}function gy(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function xj(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n+n,a=i+i,y=r+r,w=n*u,I=i*u,R=i*a,D=r*u,U=r*a,q=r*y,ne=s*u,pe=s*a,J=s*y;return t[0]=1-R-q,t[3]=I-J,t[6]=D+pe,t[1]=I+J,t[4]=1-w-q,t[7]=U-ne,t[2]=D-pe,t[5]=U+ne,t[8]=1-w-R,t}var _5;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(_5||(_5={}));const wj=Object.freeze([1,0,0,0,1,0,0,0,1]);class Vr extends ME{static get IDENTITY(){return Ej()}static get ZERO(){return bj()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return _5}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(wj)}fromObject(e){return this.check()}fromQuaternion(e){return xj(this,e),this.check()}set(e,n,i,r,s,u,a,y,w){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=u,this[6]=a,this[7]=y,this[8]=w,this.check()}setRowMajor(e,n,i,r,s,u,a,y,w){return this[0]=e,this[1]=r,this[2]=a,this[3]=n,this[4]=s,this[5]=y,this[6]=i,this[7]=u,this[8]=w,this.check()}determinant(){return _j(this)}transpose(){return mj(this,this),this.check()}invert(){return gj(this,this),this.check()}multiplyLeft(e){return my(this,e,this),this.check()}multiplyRight(e){return my(this,this,e),this.check()}rotate(e){return vj(this,this,e),this.check()}scale(e){return Array.isArray(e)?gy(this,this,e):gy(this,this,[e,e]),this.check()}translate(e){return yj(this,this,e),this.check()}transform(e,n){let i;switch(e.length){case 2:i=JG(n||[-0,-0],e,this);break;case 3:i=TE(n||[-0,-0,-0],e,this);break;case 4:i=wE(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Nf(i,e.length),i}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let RA,zA;function bj(){return RA||(RA=new Vr([0,0,0,0,0,0,0,0,0]),Object.freeze(RA)),RA}function Ej(){return zA||(zA=new Vr,Object.freeze(zA)),zA}function Tj(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Sj(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],u=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=u,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function y5(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=e[4],a=e[5],y=e[6],w=e[7],I=e[8],R=e[9],D=e[10],U=e[11],q=e[12],ne=e[13],pe=e[14],J=e[15],ie=n*a-i*u,re=n*y-r*u,ge=n*w-s*u,be=i*y-r*a,De=i*w-s*a,qe=r*w-s*y,et=I*ne-R*q,ht=I*pe-D*q,ot=I*J-U*q,at=R*pe-D*ne,Mt=R*J-U*ne,ut=D*J-U*pe,St=ie*ut-re*Mt+ge*at+be*ot-De*ht+qe*et;return St?(St=1/St,t[0]=(a*ut-y*Mt+w*at)*St,t[1]=(r*Mt-i*ut-s*at)*St,t[2]=(ne*qe-pe*De+J*be)*St,t[3]=(D*De-R*qe-U*be)*St,t[4]=(y*ot-u*ut-w*ht)*St,t[5]=(n*ut-r*ot+s*ht)*St,t[6]=(pe*ge-q*qe-J*re)*St,t[7]=(I*qe-D*ge+U*re)*St,t[8]=(u*Mt-a*ot+w*et)*St,t[9]=(i*ot-n*Mt-s*et)*St,t[10]=(q*De-ne*ge+J*ie)*St,t[11]=(R*ge-I*De-U*ie)*St,t[12]=(a*ht-u*at-y*et)*St,t[13]=(n*at-i*ht+r*et)*St,t[14]=(ne*re-q*be-pe*ie)*St,t[15]=(I*be-R*re+D*ie)*St,t):null}function Cj(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],u=t[5],a=t[6],y=t[7],w=t[8],I=t[9],R=t[10],D=t[11],U=t[12],q=t[13],ne=t[14],pe=t[15],J=e*u-n*s,ie=e*a-i*s,re=e*y-r*s,ge=n*a-i*u,be=n*y-r*u,De=i*y-r*a,qe=w*q-I*U,et=w*ne-R*U,ht=w*pe-D*U,ot=I*ne-R*q,at=I*pe-D*q,Mt=R*pe-D*ne;return J*Mt-ie*at+re*ot+ge*ht-be*et+De*qe}function tu(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],I=e[7],R=e[8],D=e[9],U=e[10],q=e[11],ne=e[12],pe=e[13],J=e[14],ie=e[15],re=n[0],ge=n[1],be=n[2],De=n[3];return t[0]=re*i+ge*a+be*R+De*ne,t[1]=re*r+ge*y+be*D+De*pe,t[2]=re*s+ge*w+be*U+De*J,t[3]=re*u+ge*I+be*q+De*ie,re=n[4],ge=n[5],be=n[6],De=n[7],t[4]=re*i+ge*a+be*R+De*ne,t[5]=re*r+ge*y+be*D+De*pe,t[6]=re*s+ge*w+be*U+De*J,t[7]=re*u+ge*I+be*q+De*ie,re=n[8],ge=n[9],be=n[10],De=n[11],t[8]=re*i+ge*a+be*R+De*ne,t[9]=re*r+ge*y+be*D+De*pe,t[10]=re*s+ge*w+be*U+De*J,t[11]=re*u+ge*I+be*q+De*ie,re=n[12],ge=n[13],be=n[14],De=n[15],t[12]=re*i+ge*a+be*R+De*ne,t[13]=re*r+ge*y+be*D+De*pe,t[14]=re*s+ge*w+be*U+De*J,t[15]=re*u+ge*I+be*q+De*ie,t}function yp(t,e,n){var i=n[0],r=n[1],s=n[2],u,a,y,w,I,R,D,U,q,ne,pe,J;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*s+e[12],t[13]=e[1]*i+e[5]*r+e[9]*s+e[13],t[14]=e[2]*i+e[6]*r+e[10]*s+e[14],t[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(u=e[0],a=e[1],y=e[2],w=e[3],I=e[4],R=e[5],D=e[6],U=e[7],q=e[8],ne=e[9],pe=e[10],J=e[11],t[0]=u,t[1]=a,t[2]=y,t[3]=w,t[4]=I,t[5]=R,t[6]=D,t[7]=U,t[8]=q,t[9]=ne,t[10]=pe,t[11]=J,t[12]=u*i+I*r+q*s+e[12],t[13]=a*i+R*r+ne*s+e[13],t[14]=y*i+D*r+pe*s+e[14],t[15]=w*i+U*r+J*s+e[15]),t}function wg(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Pj(t,e,n,i){var r=i[0],s=i[1],u=i[2],a=Math.hypot(r,s,u),y,w,I,R,D,U,q,ne,pe,J,ie,re,ge,be,De,qe,et,ht,ot,at,Mt,ut,St,Pn;return a<Uf?null:(a=1/a,r*=a,s*=a,u*=a,y=Math.sin(n),w=Math.cos(n),I=1-w,R=e[0],D=e[1],U=e[2],q=e[3],ne=e[4],pe=e[5],J=e[6],ie=e[7],re=e[8],ge=e[9],be=e[10],De=e[11],qe=r*r*I+w,et=s*r*I+u*y,ht=u*r*I-s*y,ot=r*s*I-u*y,at=s*s*I+w,Mt=u*s*I+r*y,ut=r*u*I+s*y,St=s*u*I-r*y,Pn=u*u*I+w,t[0]=R*qe+ne*et+re*ht,t[1]=D*qe+pe*et+ge*ht,t[2]=U*qe+J*et+be*ht,t[3]=q*qe+ie*et+De*ht,t[4]=R*ot+ne*at+re*Mt,t[5]=D*ot+pe*at+ge*Mt,t[6]=U*ot+J*at+be*Mt,t[7]=q*ot+ie*at+De*Mt,t[8]=R*ut+ne*St+re*Pn,t[9]=D*ut+pe*St+ge*Pn,t[10]=U*ut+J*St+be*Pn,t[11]=q*ut+ie*St+De*Pn,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function IE(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],u=e[5],a=e[6],y=e[7],w=e[8],I=e[9],R=e[10],D=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+w*i,t[5]=u*r+I*i,t[6]=a*r+R*i,t[7]=y*r+D*i,t[8]=w*r-s*i,t[9]=I*r-u*i,t[10]=R*r-a*i,t[11]=D*r-y*i,t}function Mj(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],u=e[1],a=e[2],y=e[3],w=e[8],I=e[9],R=e[10],D=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-w*i,t[1]=u*r-I*i,t[2]=a*r-R*i,t[3]=y*r-D*i,t[8]=s*i+w*r,t[9]=u*i+I*r,t[10]=a*i+R*r,t[11]=y*i+D*r,t}function kE(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],u=e[1],a=e[2],y=e[3],w=e[4],I=e[5],R=e[6],D=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+w*i,t[1]=u*r+I*i,t[2]=a*r+R*i,t[3]=y*r+D*i,t[4]=w*r-s*i,t[5]=I*r-u*i,t[6]=R*r-a*i,t[7]=D*r-y*i,t}function Ij(t,e){var n=e[0],i=e[1],r=e[2],s=e[4],u=e[5],a=e[6],y=e[8],w=e[9],I=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(s,u,a),t[2]=Math.hypot(y,w,I),t}function kj(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n+n,a=i+i,y=r+r,w=n*u,I=i*u,R=i*a,D=r*u,U=r*a,q=r*y,ne=s*u,pe=s*a,J=s*y;return t[0]=1-R-q,t[1]=I+J,t[2]=D-pe,t[3]=0,t[4]=I-J,t[5]=1-w-q,t[6]=U+ne,t[7]=0,t[8]=D+pe,t[9]=U-ne,t[10]=1-w-R,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Lj(t,e,n,i,r,s,u){var a=1/(n-e),y=1/(r-i),w=1/(s-u);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*y,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*y,t[10]=(u+s)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*s*2*w,t[15]=0,t}function Dj(t,e,n,i,r){var s=1/Math.tan(e/2),u;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(u=1/(i-r),t[10]=(r+i)*u,t[14]=2*r*i*u):(t[10]=-1,t[14]=-2*i),t}var Rj=Dj;function zj(t,e,n,i,r,s,u){var a=1/(e-n),y=1/(i-r),w=1/(s-u);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*y,t[14]=(u+s)*w,t[15]=1,t}var Bj=zj;function Oj(t,e,n,i){var r,s,u,a,y,w,I,R,D,U,q=e[0],ne=e[1],pe=e[2],J=i[0],ie=i[1],re=i[2],ge=n[0],be=n[1],De=n[2];return Math.abs(q-ge)<Uf&&Math.abs(ne-be)<Uf&&Math.abs(pe-De)<Uf?Tj(t):(I=q-ge,R=ne-be,D=pe-De,U=1/Math.hypot(I,R,D),I*=U,R*=U,D*=U,r=ie*D-re*R,s=re*I-J*D,u=J*R-ie*I,U=Math.hypot(r,s,u),U?(U=1/U,r*=U,s*=U,u*=U):(r=0,s=0,u=0),a=R*u-D*s,y=D*r-I*u,w=I*s-R*r,U=Math.hypot(a,y,w),U?(U=1/U,a*=U,y*=U,w*=U):(a=0,y=0,w=0),t[0]=r,t[1]=a,t[2]=I,t[3]=0,t[4]=s,t[5]=y,t[6]=R,t[7]=0,t[8]=u,t[9]=w,t[10]=D,t[11]=0,t[12]=-(r*q+s*ne+u*pe),t[13]=-(a*q+y*ne+w*pe),t[14]=-(I*q+R*ne+D*pe),t[15]=1,t)}function Fj(){var t=new _a(4);return _a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Nj(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function bg(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Uj(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function Vj(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function Gj(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n*n+i*i+r*r+s*s;return u>0&&(u=1/Math.sqrt(u)),t[0]=n*u,t[1]=i*u,t[2]=r*u,t[3]=s*u,t}function jj(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Hj(t,e,n,i){var r=e[0],s=e[1],u=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=u+i*(n[2]-u),t[3]=a+i*(n[3]-a),t}function P1(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*u,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*u,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*u,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*u,t}function Wj(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[0],a=n[1],y=n[2],w=n[3],I=w*i+a*s-y*r,R=w*r+y*i-u*s,D=w*s+u*r-a*i,U=-u*i-a*r-y*s;return t[0]=I*w+U*-u+R*-y-D*-a,t[1]=R*w+U*-a+D*-u-I*-y,t[2]=D*w+U*-y+I*-a-R*-u,t[3]=e[3],t}(function(){var t=Fj();return function(e,n,i,r,s,u){var a,y;for(n||(n=4),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,u),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var v5;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(v5||(v5={}));const $j=45*Math.PI/180,qj=1,Km=.1,Jm=500,Zj=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Vs extends ME{static get IDENTITY(){return Qj()}static get ZERO(){return Xj()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return v5}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,i,r,s,u,a,y,w,I,R,D,U,q,ne,pe){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=u,this[6]=a,this[7]=y,this[8]=w,this[9]=I,this[10]=R,this[11]=D,this[12]=U,this[13]=q,this[14]=ne,this[15]=pe,this.check()}setRowMajor(e,n,i,r,s,u,a,y,w,I,R,D,U,q,ne,pe){return this[0]=e,this[1]=s,this[2]=w,this[3]=U,this[4]=n,this[5]=u,this[6]=I,this[7]=q,this[8]=i,this[9]=a,this[10]=R,this[11]=ne,this[12]=r,this[13]=y,this[14]=D,this[15]=pe,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Zj)}fromObject(e){return this.check()}fromQuaternion(e){return kj(this,e),this.check()}frustum(e){const{left:n,right:i,bottom:r,top:s,near:u=Km,far:a=Jm}=e;return a===1/0?Yj(this,n,i,r,s,u):Lj(this,n,i,r,s,u,a),this.check()}lookAt(e){const{eye:n,center:i=[0,0,0],up:r=[0,1,0]}=e;return Oj(this,n,i,r),this.check()}ortho(e){const{left:n,right:i,bottom:r,top:s,near:u=Km,far:a=Jm}=e;return Bj(this,n,i,r,s,u,a),this.check()}orthographic(e){const{fovy:n=$j,aspect:i=qj,focalDistance:r=1,near:s=Km,far:u=Jm}=e;_y(n);const a=n/2,y=r*Math.tan(a),w=y*i;return this.ortho({left:-w,right:w,bottom:-y,top:y,near:s,far:u})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}=e;return _y(n),Rj(this,n,i,r,s),this.check()}determinant(){return Cj(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],s=1/i[1],u=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*u,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*u,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],s=1/i[1],u=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*u,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*u,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*u,e}transpose(){return Sj(this,this),this.check()}invert(){return y5(this,this),this.check()}multiplyLeft(e){return tu(this,e,this),this.check()}multiplyRight(e){return tu(this,this,e),this.check()}rotateX(e){return IE(this,this,e),this.check()}rotateY(e){return Mj(this,this,e),this.check()}rotateZ(e){return kE(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Pj(this,this,e,n),this.check()}scale(e){return wg(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return yp(this,this,e),this.check()}transform(e,n){return e.length===4?(n=P1(n||[-0,-0,-0,-0],e,this),Nf(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:i}=e;let r;switch(i){case 2:r=ej(n||[-0,-0],e,this);break;case 3:r=vg(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Nf(r,e.length),r}transformAsVector(e,n){let i;switch(e.length){case 2:i=nj(n||[-0,-0],e,this);break;case 3:i=xE(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Nf(i,e.length),i}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,i){return this.identity().translate([e,n,i])}}let BA,OA;function Xj(){return BA||(BA=new Vs([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(BA)),BA}function Qj(){return OA||(OA=new Vs,Object.freeze(OA)),OA}function _y(t){if(t>Math.PI*2)throw Error("expected radians")}function Yj(t,e,n,i,r,s){const u=2*s/(n-e),a=2*s/(r-i),y=(n+e)/(n-e),w=(r+i)/(r-i),I=-1,R=-1,D=-2*s;return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=y,t[9]=w,t[10]=I,t[11]=R,t[12]=0,t[13]=0,t[14]=D,t[15]=0,t}function yy(){var t=new _a(4);return _a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Kj(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function LE(t,e,n){n=n*.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function vy(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=n[0],y=n[1],w=n[2],I=n[3];return t[0]=i*I+u*a+r*w-s*y,t[1]=r*I+u*y+s*a-i*w,t[2]=s*I+u*w+i*y-r*a,t[3]=u*I-i*a-r*y-s*w,t}function Jj(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y+u*a,t[1]=r*y+s*a,t[2]=s*y-r*a,t[3]=u*y-i*a,t}function eH(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y-s*a,t[1]=r*y+u*a,t[2]=s*y+i*a,t[3]=u*y-r*a,t}function tH(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y+r*a,t[1]=r*y-i*a,t[2]=s*y+u*a,t[3]=u*y-s*a,t}function nH(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function Pd(t,e,n,i){var r=e[0],s=e[1],u=e[2],a=e[3],y=n[0],w=n[1],I=n[2],R=n[3],D,U,q,ne,pe;return U=r*y+s*w+u*I+a*R,U<0&&(U=-U,y=-y,w=-w,I=-I,R=-R),1-U>Uf?(D=Math.acos(U),q=Math.sin(D),ne=Math.sin((1-i)*D)/q,pe=Math.sin(i*D)/q):(ne=1-i,pe=i),t[0]=ne*r+pe*y,t[1]=ne*s+pe*w,t[2]=ne*u+pe*I,t[3]=ne*a+pe*R,t}function iH(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n*n+i*i+r*r+s*s,a=u?1/u:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t}function rH(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function DE(t,e){var n=e[0]+e[4]+e[8],i;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[r*3+r]&&(r=2);var s=(r+1)%3,u=(r+2)%3;i=Math.sqrt(e[r*3+r]-e[s*3+s]-e[u*3+u]+1),t[r]=.5*i,i=.5/i,t[3]=(e[s*3+u]-e[u*3+s])*i,t[s]=(e[s*3+r]+e[r*3+s])*i,t[u]=(e[u*3+r]+e[r*3+u])*i}return t}var sH=Nj,oH=bg,aH=jj,lH=Hj,cH=Uj,uH=Vj,RE=Gj,hH=function(){var t=bE(),e=py(1,0,0),n=py(0,1,0);return function(i,r,s){var u=EE(r,s);return u<-.999999?(Cd(t,e,r),PE(t)<1e-6&&Cd(t,n,r),cj(t,t),LE(i,t,Math.PI),i):u>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(Cd(t,r,s),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+u,RE(i,i))}}();(function(){var t=yy(),e=yy();return function(n,i,r,s,u,a){return Pd(t,i,u,a),Pd(e,r,s,a),Pd(n,t,e,2*a*(1-a)),n}})();(function(){var t=pj();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],RE(e,DE(e,t))}})();const fH=[0,0,0,1];class xy extends yg{constructor(e=0,n=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return DE(this,e),this.check()}fromAxisRotation(e,n){return LE(this,e,n),this.check()}identity(){return Kj(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=wi(e)}get y(){return this[1]}set y(e){this[1]=wi(e)}get z(){return this[2]}set z(e){this[2]=wi(e)}get w(){return this[3]}set w(e){this[3]=wi(e)}len(){return cH(this)}lengthSquared(){return uH(this)}dot(e){return aH(this,e)}rotationTo(e,n){return hH(this,e,n),this.check()}add(e){return sH(this,this,e),this.check()}calculateW(){return nH(this,this),this.check()}conjugate(){return rH(this,this),this.check()}invert(){return iH(this,this),this.check()}lerp(e,n,i){return i===void 0?this.lerp(this,e,n):(lH(this,e,n,i),this.check())}multiplyRight(e){return vy(this,this,e),this.check()}multiplyLeft(e){return vy(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return Jj(this,this,e),this.check()}rotateY(e){return eH(this,this,e),this.check()}rotateZ(e){return tH(this,this,e),this.check()}scale(e){return oH(this,this,e),this.check()}slerp(e,n,i){let r,s,u;switch(arguments.length){case 1:({start:r=fH,target:s,ratio:u}=e);break;case 2:r=this,s=e,u=n;break;default:r=e,s=n,u=i}return Pd(this,r,s,u),this.check()}transformVector4(e,n=new xg){return Wj(n,e,this),Nf(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const zE={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},wy=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,AH={lightSources:{}};function e4(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function dH(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return e?r["lighting_uAmbientLight.color"]=e4(e):r["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,u)=>{r["lighting_uPointLight[".concat(u,"].color")]=e4(s),r["lighting_uPointLight[".concat(u,"].position")]=s.position,r["lighting_uPointLight[".concat(u,"].attenuation")]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=n.length,i.forEach((s,u)=>{r["lighting_uDirectionalLight[".concat(u,"].color")]=e4(s),r["lighting_uDirectionalLight[".concat(u,"].direction")]=s.direction}),r.lighting_uDirectionalLightCount=i.length,r}function BE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:AH;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},dH({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return BE({lightSources:e})}return{}}const OE={name:"lights",vs:wy,fs:wy,getUniforms:BE,defines:{MAX_LIGHTS:3}},pH=new Uint8Array([0,255,255,255]),mH={pickingSelectedColor:null,pickingHighlightColor:pH,pickingActive:!1,pickingAttribute:!1};function gH(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mH;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const _H=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,yH=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,vH={name:"picking",vs:_H,fs:yH,getUniforms:gH},FE=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,xH={};function wH(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}function NE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xH;if(!("material"in t))return{};const{material:e}=t;return e?wH(e):{lighting_uEnabled:!1}}const bH={name:"gouraud-lighting",dependencies:[OE],vs:FE,defines:{LIGHTING_VERTEX:1},getUniforms:NE},EH={name:"phong-lighting",dependencies:[OE],fs:FE,defines:{LIGHTING_FRAGMENT:1},getUniforms:NE},TH=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,SH={name:"transform",vs:TH,fs:null};class N2{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new N2(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:i="",defines:r={},inject:s={},varyings:u=[],bufferMode:a=35981,transpileToGLSL100:y=!1}=e,w=this._getModuleList(e.modules),I=this._getHash(n),R=this._getHash(i),D=w.map(re=>this._getHash(re.name)).sort(),U=u.map(re=>this._getHash(re)),q=Object.keys(r).sort(),ne=Object.keys(s).sort(),pe=[],J=[];for(const re of q)pe.push(this._getHash(re)),pe.push(this._getHash(r[re]));for(const re of ne)J.push(this._getHash(re)),J.push(this._getHash(s[re]));const ie="".concat(I,"/").concat(R,"D").concat(pe.join("/"),"M").concat(D.join("/"),"I").concat(J.join("/"),"V").concat(U.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(y?"T":"");if(!this._programCache[ie]){const re=PG(this.gl,{vs:n,fs:i,modules:w,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:y});this._programCache[ie]=new cE(this.gl,{hash:ie,vs:re.vs,fs:re.fs,varyings:u,bufferMode:a}),this._getUniforms[ie]=re.getUniforms||(ge=>{}),this._useCounts[ie]=0}return this._useCounts[ie]++,this._programCache[ie]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,u=this._defaultModules.length;s<u;++s){const a=this._defaultModules[s],y=a.name;n[r++]=a,i[y]=!0}for(let s=0,u=e.length;s<u;++s){const a=e[s],y=a.name;i[y]||(n[r++]=a,i[y]=!0)}return n.length=r,n}}const CH={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function PH(t,e,n){const i={};let r=e.indices;for(const s in e.attributes){const u=e.attributes[s],a=MH(s,n);if(s==="indices")r=u;else if(u.constant)i[a]=u.value;else{const y=u.value,w={...u};delete w.value,i[a]=[new vi(t,y),w],IH(s,w)}}if(r){const s=r.value||r;Ht(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const u={size:1,isIndexed:r.isIndexed===void 0?!0:r.isIndexed};i.indices=[new vi(t,{data:s,target:34963}),u]}return i}function MH(t,e){const{attributeMap:n=CH}=e||{};return n&&n[t]||t}function IH(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Ht(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const vh=2,kH=1e4,LH="Model needs drawMode and vertexCount",by=()=>{},DH={};class i0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:i=sc("model")}=n;Ht(l3(e)),this.id=i,this.gl=e,this.id=n.id||sc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||N2.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:I}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:I},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Ht(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),LH)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:I}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:I},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Ht(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Ht(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=PH(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(u1(e))return this;const n={};for(const i in e){const r=e[i];n[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return dg(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:u=this.transformFeedback,parameters:a={},vertexArray:y=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(r);let w;cn.priority>=vh&&(w=this._logDrawCallStart(vh));const I=this.vertexArray.getDrawParams(),{isIndexed:R=I.isIndexed,indexType:D=I.indexType,indexOffset:U=I.indexOffset,vertexArrayInstanced:q=I.isInstanced}=this.props;q&&!this.isInstanced&&cn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:ne,instanceCount:pe}=this,{onBeforeRender:J=by,onAfterRender:ie=by}=this.props;J(),this.program.setUniforms(this.uniforms);const re=this.program.draw(Object.assign(DH,e,{logPriority:w,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:y,transformFeedback:u,isIndexed:R,indexType:D,isInstanced:ne,instanceCount:pe,offset:R?U:0}));return ie(),cn.priority>=vh&&this._logDrawCallEnd(w,y,i),re}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),n&&(s=Object.assign({},s,{35977:n})),r.forEach(u=>u.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(u=>u.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return cn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:u,defines:a,varyings:y,bufferMode:w,transpileToGLSL100:I}=this.programProps;n=this.programManager.get({vs:i,fs:r,modules:s,inject:u,defines:a,varyings:y,bufferMode:w,transpileToGLSL100:I}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Ht(n instanceof cE,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new VV(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof vi&&n.delete()}}_setAnimationProps(e){this.animated&&Ht(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(u1(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new uE(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:kH;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),cn.group(vh,">>> DRAWING MODEL ".concat(this.id),{collapsed:cn.level<=2})(),e}_logDrawCallEnd(e,n,i,r){if(e===void 0)return;const s=HV({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:u,unusedTable:a,unusedCount:y}=ry({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:w,count:I}=ry({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});I>0&&cn.log("MISSING UNIFORMS",Object.keys(w))(),y>0&&cn.log("UNUSED UNIFORMS",Object.keys(a))();const R=$V(this.vertexArray.configuration);cn.table(e,s)(),cn.table(e,u)(),cn.table(e+1,R)(),r&&r.log({logLevel:vh,message:"Rendered to ".concat(r.id)}),cn.groupEnd(vh)()}}class RH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=n;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],i=e?n[e]:null;return i?i instanceof vi?i:i.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,i=this.getBuffer(n);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Ht(Kn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in n&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if(typeof s=="string"){const u=n[s],{byteLength:a,usage:y,accessor:w}=u;i[r]=this._createNewBuffer(r,{byteLength:a,usage:y,accessor:w})}}return i}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:i})}_setupTransformFeedback(e,n){let{model:i}=n;const{program:r}=i;e.transformFeedback=new uE(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:n,feedbackBuffers:i})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];n[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],Ht(i[s]instanceof vi)}return{sourceBuffers:n,feedbackBuffers:i}}_createNewBuffer(e,n){const i=new vi(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}const zH="transform_uSampler_",vp="transform_uSize_",Ey="transform_position";function BH(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,u=Object.keys(n).length,a=null;const y={};let w=e,I={};if(u>0||i){const R=w.split(`
`),D=R.slice();if(R.forEach((U,q,ne)=>{if(u>0){const pe=VH(U,n);if(pe){const{updatedLine:J,inject:ie}=pe;D[q]=J,I=d5([I,ie]),Object.assign(y,pe.samplerTextureMap),u--}}i&&!a&&(a=UH(U,i))}),i){Ht(r);const U="".concat(vp).concat(i),q="uniform vec2 ".concat(U,`;
`),ne="     vec2 ".concat(Ey," = transform_getPos(").concat(U,`);
     gl_Position = vec4(`).concat(Ey,`, 0, 1.);
`);I=d5([I,{"vs:#decl":q,"vs:#main-start":ne}])}w=D.join(`
`)}return{vs:w,targetTextureType:a,inject:I,samplerTextureMap:y}}function OH(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let s,u;n&&({width:s,height:u}=i,r["".concat(vp).concat(n)]=[s,u]);for(const a in e)({width:s,height:u}=e[a]),r["".concat(vp).concat(a)]=[s,u];return r}function FH(t){return gE(t,["attribute","in"])}function NH(t){const e="".concat(zH).concat(t),n="".concat(vp).concat(t),i="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}function UH(t,e){const n=gE(t,["varying","out"]);return n&&n.name===e?n.type:null}function VH(t,e){const n={},i=FH(t);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const u="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:y,uniformDeclerations:w}=NH(s),I=OG(r),R="  ".concat(r," ").concat(s," = transform_getInput(").concat(a,", ").concat(y,").").concat(I,`;
`);return n[a]=s,{updatedLine:u,inject:{"vs:#decl":w,"vs:#main-start":R},samplerTextureMap:n}}return null}const GH={10241:9728,10240:9728,10242:33071,10243:33071},jH="transform_output";class HH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],u=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),y=Object.assign({},e.parameters);let w=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){u.transform_elementID=this.elementIDBuffer;for(const R in this.samplerTextureMap){const D=this.samplerTextureMap[R];a[R]=i[D]}this._setSourceTextureParameters();const I=OH({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,I)}return this.hasTargetTexture&&(w=!1,y.viewport=[0,0,r.width,r.height]),{attributes:u,framebuffer:r,uniforms:a,discard:w,parameters:y}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],i=u3(n);if(!e)return i;const r=i.constructor,s=FG(this.targetTextureType),u=new r(i.length*s/4);let a=0;for(let y=0;y<i.length;y+=4)for(let w=0;w<s;w++)u[a++]=i[y+w];return u}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:i}=e;if(i instanceof Ws)return i;const r=n[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new vi(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:n,targetTexture:i})}}_updateBinding(e,n){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:u,height:a}=s,{framebuffer:y}=e;y?(y.update({attachments:{36064:s},resizeAttachments:!1}),y.resize({width:u,height:a})):e.framebuffer=new vr(this.gl,{id:"transform-framebuffer",width:u,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const i in n)n[i].setParameters(GH)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const i=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:i}}_createNewTexture(e){const n=IU(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:u,inject:a,samplerTextureMap:y}=BH({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),w=d5([e.inject||{},a]);this.targetTextureType=u,this.samplerTextureMap=y;const I=e._fs||_E({version:aE(r),input:this.targetTextureVarying,inputType:u,output:jH}),R=this.hasSourceTextures||this.targetTextureVarying?[SH].concat(e.modules||[]):e.modules;return{vs:r,fs:I,modules:R,uniforms:s,inject:w}}}class Eg{static isSupported(e){return Kn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:i}=this;e&&e.delete(),n&&n.delete(),i&&i.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,i=this._updateDrawOptions(e);n&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=e||i.swap();Ht(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)i.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new i0(n,Object.assign({},e,{fs:e.fs||_E({version:aE(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=r.updateModelProps(n);return n}_buildResourceTransforms(e,n){WH(n)&&(this.bufferTransform=new RH(e,n)),$H(n)&&(this.textureTransform=new HH(e,n)),Ht(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=Object.assign(n,r.getDrawOptions(n));return n}}function WH(t){return!!(!u1(t.feedbackBuffers)||!u1(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function $H(t){return!!(!u1(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const Ty={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Ql{static get DRAW_MODE(){return Ty}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=sc("geometry"),drawMode:i=Ty.TRIANGLES,attributes:r={},indices:s=null,vertexCount:u=null}=e;this.id=n,this.drawMode=i|0,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=u||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,Ht(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),(i==="POSITION"||i==="positions")&&!r.size&&(r.size=3),i==="indices"?(Ht(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let i=1/0;for(const r in e){const s=e[r],{value:u,size:a,constant:y}=s;!y&&u&&a>=1&&(i=Math.min(i,u.length/a))}return Ht(Number.isFinite(i)),i}}let qH=1,ZH=1;class UE{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,u=qH++,a={time:0,delay:n,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(u,a),u}removeChannel(e){this.channels.delete(e);for(const[n,i]of this.animations)i.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const r of n)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:u}=r;s.setTime(this.getTime(u))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const i=ZH++;return this.animations.set(i,{animation:e,channel:n}),e.setTime(this.getTime(n)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const i=n-e.delay,r=e.duration*e.repeat;i>=r?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const XH=[255,255,255],QH=1;let YH=0;class VE{constructor(e={}){Z(this,"id",void 0),Z(this,"color",void 0),Z(this,"intensity",void 0),Z(this,"type","ambient");const{color:n=XH}=e,{intensity:i=QH}=e;this.id=e.id||"ambient-".concat(YH++),this.color=n,this.intensity=i}}const KH=[255,255,255],JH=1,eW=[0,0,-1];let tW=0;class x5{constructor(e={}){Z(this,"id",void 0),Z(this,"color",void 0),Z(this,"intensity",void 0),Z(this,"type","directional"),Z(this,"direction",void 0),Z(this,"shadow",void 0);const{color:n=KH}=e,{intensity:i=JH}=e,{direction:r=eW}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(tW++),this.color=n,this.intensity=i,this.type="directional",this.direction=new Zt(r).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class nW{constructor(e,n={id:"pass"}){Z(this,"id",void 0),Z(this,"gl",void 0),Z(this,"props",void 0);const{id:i}=n;this.id=i,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Tg extends nW{constructor(...e){super(...e),Z(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return n0(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:i,viewports:r,views:s,onViewportActive:u,clearStack:a=!0,clearCanvas:y=!0}=e;e.pass=e.pass||"unknown";const w=this.gl;y&&rW(w,n),a&&(this._lastRenderIndex=-1);const I=[];for(const R of r){const D=s&&s[R.id];u?.(R);const U=this._getDrawLayerParams(R,e),q=R.subViewports||[R];for(const ne of q){const pe=this._drawLayersInViewport(w,{target:n,moduleParameters:i,viewport:ne,view:D,pass:e.pass,layers:e.layers},U);I.push(pe)}}return I}_getDrawLayerParams(e,{layers:n,pass:i,isPicking:r=!1,layerFilter:s,cullRect:u,effects:a,moduleParameters:y},w=!1){const I=[],R=GE(this._lastRenderIndex+1),D={layer:n[0],viewport:e,isPicking:r,renderPass:i,cullRect:u},U={};for(let q=0;q<n.length;q++){const ne=n[q],pe=this._shouldDrawLayer(ne,D,s,U),J={shouldDrawLayer:pe};pe&&!w&&(J.layerRenderIndex=R(ne,pe),J.moduleParameters=this._getModuleParameters(ne,a,i,y),J.layerParameters=this.getLayerParameters(ne,q,e)),I[q]=J}return I}_drawLayersInViewport(e,{layers:n,moduleParameters:i,pass:r,target:s,viewport:u,view:a},y){const w=iW(e,{moduleParameters:i,target:s,viewport:u});if(a&&a.props.clear){const R=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;da(e,{scissorTest:!0,scissor:w},()=>dg(e,R))}const I={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};n0(e,{viewport:w});for(let R=0;R<n.length;R++){const D=n[R],{shouldDrawLayer:U,layerRenderIndex:q,moduleParameters:ne,layerParameters:pe}=y[R];if(U&&D.props.pickable&&I.pickableCount++,D.isComposite)I.compositeCount++;else if(U){I.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,q),ne.viewport=u;try{D._drawLayer({moduleParameters:ne,uniforms:{layerIndex:q},parameters:pe})}catch(J){D.raiseError(J,"drawing ".concat(D," to ").concat(r))}}}return I}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,i){return e.props.parameters}_shouldDrawLayer(e,n,i,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let u=e.parent;for(;u;){if(!u.props.visible||!u.filterSubLayer(n))return!1;n.layer=u,u=u.parent}if(i){const a=n.layer.id;if(a in r||(r[a]=i(n)),!r[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,i,r){var s;const u=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:c1(this.gl)});if(n)for(const y of n){var a;Object.assign(u,(a=y.getModuleParameters)===null||a===void 0?void 0:a.call(y,e))}return Object.assign(u,this.getModuleParameters(e,n),r)}}function GE(t=0,e={}){const n={},i=(r,s)=>{const u=r.props._offset,a=r.id,y=r.parent&&r.parent.id;let w;if(y&&!(y in e)&&i(r.parent,!1),y in n){const I=n[y]=n[y]||GE(e[y],e);w=I(r,s),n[a]=I}else Number.isFinite(u)?(w=u+(e[y]||0),n[a]=null):w=t;return s&&w>=t&&(t=w+1),e[a]=w,w};return i}function iW(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||c1(t),u=r?n.height:t.drawingBufferHeight,a=i;return[a.x*s,u-(a.y+a.height)*s,a.width*s,a.height*s]}function rW(t,e){const n=e?e.width:t.drawingBufferWidth,i=e?e.height:t.drawingBufferHeight;n0(t,{viewport:[0,0,n,i]}),t.clear(16640)}class sW extends Tg{constructor(e,n){super(e,n),Z(this,"shadowMap",void 0),Z(this,"depthBuffer",void 0),Z(this,"fbo",void 0),this.shadowMap=new Ws(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Ph(e,{format:33189,width:1,height:1}),this.fbo=new vr(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;da(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=c1(this.gl),s=i.width*r,u=i.height*r;(s!==n.width||u!==n.height)&&n.resize({width:s,height:u}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const jE="#define SMOOTH_EDGE_RADIUS 0.5",oW=`
`.concat(jE,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),aW=`
`.concat(jE,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),lW={name:"geometry",vs:oW,fs:aW},cW=Object.keys(Yn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Yn[t],";")).join(""),uW=Object.keys(ha).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(ha[t],";")).join(""),hW=Object.keys(au).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(au[t],";")).join(""),fW="".concat(cW,`
`).concat(uW,`
`).concat(hW,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function AW(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function U2(t){let e={},n;return i=>{for(const r in i)if(!AW(i[r],e[r])){n=t(i),e=i;break}return n}}const Sy=[0,0,0,0],dW=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],HE=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],pW=[0,0,0],WE=[0,0,0],mW=U2(yW);function $E(t,e,n=WE){n.length<3&&(n=[n[0],n[1],0]);let i=n,r,s=!0;switch(e===Yn.LNGLAT_OFFSETS||e===Yn.METER_OFFSETS?r=n:r=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case ha.WEB_MERCATOR:(e===Yn.LNGLAT||e===Yn.CARTESIAN)&&(r=[0,0,0],s=!1);break;case ha.WEB_MERCATOR_AUTO_OFFSET:e===Yn.LNGLAT?i=r:e===Yn.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case ha.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case ha.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function gW(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:s,viewProjectionMatrix:u}=t,a=Sy,y=Sy,w=t.cameraPosition;const{geospatialOrigin:I,shaderCoordinateOrigin:R,offsetMode:D}=$E(t,e,n);return D&&(y=t.projectPosition(I||R),w=[w[0]-y[0],w[1]-y[1],w[2]-y[2]],y[3]=1,a=P1([],y,u),s=i||s,u=tu([],r,s),u=tu([],u,dW)),{viewMatrix:s,viewProjectionMatrix:u,projectionCenter:a,originCommon:y,cameraPosCommon:w,shaderCoordinateOrigin:R,geospatialOrigin:I}}function _W({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=Yn.DEFAULT,coordinateOrigin:r=WE,autoWrapLongitude:s=!1}){i===Yn.DEFAULT&&(i=t.isGeospatial?Yn.LNGLAT:Yn.CARTESIAN);const u=mW({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return u.project_uWrapLongitude=s,u.project_uModelMatrix=n||HE,u}function yW({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:u,cameraPosCommon:a,shaderCoordinateOrigin:y,geospatialOrigin:w}=gW(t,n,i),I=t.getDistanceScales(),R=[t.width*e,t.height*e],D=P1([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,U={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:y,project_uCommonOrigin:u.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:R,project_uDevicePixelRatio:e,project_uFocalDistance:D,project_uCommonUnitsPerMeter:I.unitsPerMeter,project_uCommonUnitsPerWorldUnit:I.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:pW,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:HE,project_uCameraPosition:a};if(w){const q=t.getDistanceScales(w);switch(n){case Yn.METER_OFFSETS:U.project_uCommonUnitsPerWorldUnit=q.unitsPerMeter,U.project_uCommonUnitsPerWorldUnit2=q.unitsPerMeter2;break;case Yn.LNGLAT:case Yn.LNGLAT_OFFSETS:t._pseudoMeters||(U.project_uCommonUnitsPerMeter=q.unitsPerMeter),U.project_uCommonUnitsPerWorldUnit=q.unitsPerDegree,U.project_uCommonUnitsPerWorldUnit2=q.unitsPerDegree2;break;case Yn.CARTESIAN:U.project_uCommonUnitsPerWorldUnit=[1,1,q.unitsPerMeter[2]],U.project_uCommonUnitsPerWorldUnit2=[0,0,q.unitsPerMeter2[2]];break}}return U}const vW={};function xW(t=vW){return"viewport"in t?_W(t):{}}const Sg={name:"project",dependencies:[VG,lW],vs:fW,getUniforms:xW};function wW(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Zh(t,e){const n=P1([],e,t);return bg(n,n,1/n[3]),n}function Cy(t,e){const n=t%e;return n<0?e+n:n}function bW(t,e,n){return n*e+(1-n)*t}function w5(t,e,n){return t<e?e:t>n?n:t}function EW(t){return Math.log(t)*Math.LOG2E}const Cg=Math.log2||EW;function r0(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const fa=Math.PI,qE=fa/4,No=fa/180,b5=180/fa,f1=512,xp=4003e4,FA=85.051129,TW=1.5;function Py(t){return Math.pow(2,t)}function ZE(t){return Cg(t)}function tl(t){const[e,n]=t;r0(Number.isFinite(e)),r0(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=e*No,r=n*No,s=f1*(i+fa)/(2*fa),u=f1*(fa+Math.log(Math.tan(qE+r*.5)))/(2*fa);return[s,u]}function uu(t){const[e,n]=t,i=e/f1*(2*fa)-fa,r=2*(Math.atan(Math.exp(n/f1*(2*fa)-fa))-qE);return[i*b5,r*b5]}function SW(t){const{latitude:e}=t;r0(Number.isFinite(e));const n=Math.cos(e*No);return ZE(xp*n)-9}function t4(t){const e=Math.cos(t*No);return f1/xp/e}function E5(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;r0(Number.isFinite(e)&&Number.isFinite(n));const r=f1,s=Math.cos(e*No),u=r/360,a=u/s,y=r/xp/s,w={unitsPerMeter:[y,y,y],metersPerUnit:[1/y,1/y,1/y],unitsPerDegree:[u,a,y],degreesPerUnit:[1/u,1/a,1/y]};if(i){const I=No*Math.tan(e*No)/s,R=u*I/2,D=r/xp*I,U=D/a*y;w.unitsPerDegree2=[0,R,D],w.unitsPerMeter2=[U,0,U]}return w}function XE(t,e){const[n,i,r]=t,[s,u,a]=e,{unitsPerMeter:y,unitsPerMeter2:w}=E5({longitude:n,latitude:i,highPrecision:!0}),I=tl(t);I[0]+=s*(y[0]+w[0]*u),I[1]+=u*(y[1]+w[1]*u);const R=uu(I),D=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[R[0],R[1],D]:R}function CW(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:s,center:u}=t,a=wW();yp(a,a,[0,0,-r]),IE(a,a,-n*No),kE(a,a,i*No);const y=s/e;return wg(a,a,[y,y,y]),u&&yp(a,a,lj([],u)),a}function PW(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:s,center:u,scale:a,nearZMultiplier:y=1,farZMultiplier:w=1}=t;let{fovy:I=wp(TW)}=t;i!==void 0&&(I=wp(i));const R=I*No,D=r*No,U=QE(I);let q=U;u&&(q+=u[2]*a/Math.cos(D)/n);const ne=R*(.5+(s?s[1]:0)/n),pe=Math.sin(ne)*q/Math.sin(w5(Math.PI/2-D-ne,.01,Math.PI-.01)),J=Math.sin(D)*pe+q,ie=q*10,re=Math.min(J*w,ie);return{fov:R,aspect:e/n,focalDistance:U,near:y,far:re}}function wp(t){return 2*Math.atan(.5/t)*b5}function QE(t){return .5/Math.tan(.5*t*No)}function YE(t,e){const[n,i,r=0]=t;return r0(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),Zh(e,[n,i,r,1])}function Pg(t,e,n=0){const[i,r,s]=t;if(r0(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Zh(e,[i,r,s,1]);const u=Zh(e,[i,r,0,1]),a=Zh(e,[i,r,1,1]),y=u[2],w=a[2],I=y===w?0:((n||0)-y)/(w-y);return vE([],u,a,I)}function MW(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:s=24,offset:u=[0,0]}=t,[[a,y],[w,I]]=i,R=IW(t.padding),D=tl([a,w5(I,-FA,FA)]),U=tl([w,w5(y,-FA,FA)]),q=[Math.max(Math.abs(U[0]-D[0]),r),Math.max(Math.abs(U[1]-D[1]),r)],ne=[e-R.left-R.right-Math.abs(u[0])*2,n-R.top-R.bottom-Math.abs(u[1])*2];r0(ne[0]>0&&ne[1]>0);const pe=ne[0]/q[0],J=ne[1]/q[1],ie=(R.right-R.left)/2/pe,re=(R.top-R.bottom)/2/J,ge=[(U[0]+D[0])/2+ie,(U[1]+D[1])/2+re],be=uu(ge),De=Math.min(s,Cg(Math.abs(Math.min(pe,J))));return r0(Number.isFinite(De)),{longitude:be[0],latitude:be[1],zoom:De}}function IW(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(r0(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const My=Math.PI/180;function kW(t,e=0){const{width:n,height:i,unproject:r}=t,s={targetZ:e},u=r([0,i],s),a=r([n,i],s);let y,w;const I=t.fovy?.5*t.fovy*My:Math.atan(.5/t.altitude),R=(90-t.pitch)*My;return I>R-.01?(y=Iy(t,0,e),w=Iy(t,n,e)):(y=r([0,0],s),w=r([n,0],s)),[u,a,w,y]}function Iy(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=Zh(i,[e,0,1,1]),s=Zh(i,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2]),y=vE([],r,s,a),w=uu(y);return w.push(n),w}const ky=512;function LW(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:s,zoom:u,bearing:a=0}=t;(r<-180||r>180)&&(r=Cy(r+180,360)-180),(a<-180||a>180)&&(a=Cy(a+180,360)-180);const y=Cg(n/ky);if(u<=y)u=y,s=0;else{const w=n/2/Math.pow(2,u),I=uu([0,w])[1];if(s<I)s=I;else{const R=uu([0,ky-w])[1];s>R&&(s=R)}}return{width:e,height:n,longitude:r,latitude:s,zoom:u,pitch:i,bearing:a}}const KE=.01,DW=["longitude","latitude","zoom"],JE={curve:1.414,speed:1.2};function RW(t,e,n,i){const{startZoom:r,startCenterXY:s,uDelta:u,w0:a,u1:y,S:w,rho:I,rho2:R,r0:D}=eT(t,e,i);if(y<KE){const ge={};for(const be of DW){const De=t[be],qe=e[be];ge[be]=bW(De,qe,n)}return ge}const U=n*w,q=Math.cosh(D)/Math.cosh(D+I*U),ne=a*((Math.cosh(D)*Math.tanh(D+I*U)-Math.sinh(D))/R)/y,pe=1/q,J=r+ZE(pe),ie=QG([],u,ne);g5(ie,ie,s);const re=uu(ie);return{longitude:re[0],latitude:re[1],zoom:J}}function zW(t,e,n){const i={...JE,...n},{screenSpeed:r,speed:s,maxDuration:u}=i,{S:a,rho:y}=eT(t,e,i),w=1e3*a;let I;return Number.isFinite(r)?I=w/(r/y):I=w/s,Number.isFinite(u)&&I>u?0:I}function eT(t,e,n){n=Object.assign({},JE,n);const i=n.curve,r=t.zoom,s=[t.longitude,t.latitude],u=Py(r),a=e.zoom,y=[e.longitude,e.latitude],w=Py(a-r),I=tl(s),R=tl(y),D=tj([],R,I),U=Math.max(t.width,t.height),q=U/w,ne=YG(D)*u,pe=Math.max(ne,KE),J=i*i,ie=(q*q-U*U+J*J*pe*pe)/(2*U*J*pe),re=(q*q-U*U-J*J*pe*pe)/(2*q*J*pe),ge=Math.log(Math.sqrt(ie*ie+1)-ie),be=Math.log(Math.sqrt(re*re+1)-re),De=(be-ge)/i;return{startZoom:r,startCenterXY:I,uDelta:D,w0:U,u1:ne,S:De,rho:i,rho2:J,r0:ge,r1:be}}const BW=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,OW=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,FW=U2(jW),NW=U2(HW),UW=[0,0,0,1],VW=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function GW(t,e){const[n,i,r]=t,s=Pg([n,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}function jW({viewport:t,center:e}){return new Vs(t.viewProjectionMatrix).invert().transform(e)}function HW({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,s=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(u=>GW(u,i));for(const u of e){const a=u.clone().translate(new Zt(t.center).negate()),y=s.map(I=>a.transform(I)),w=new Vs().ortho({left:Math.min(...y.map(I=>I[0])),right:Math.max(...y.map(I=>I[0])),bottom:Math.min(...y.map(I=>I[1])),top:Math.max(...y.map(I=>I[1])),near:Math.min(...y.map(I=>-I[2])),far:Math.max(...y.map(I=>-I[2]))});n.push(w.multiplyRight(u))}return n}function WW(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||UW,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=FW({viewport:t.viewport,center:e.project_uCenter}),s=[],u=NW({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const y=u[a],w=y.clone().translate(new Zt(t.viewport.center).negate());e.project_uCoordinateSystem===Yn.LNGLAT&&e.project_uProjectionMode===ha.WEB_MERCATOR?(u[a]=w,s[a]=r):(u[a]=y.clone().multiplyRight(VW),s[a]=w.transform(r))}for(let a=0;a<u.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=u[a],i["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:i["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return i}const n4={name:"shadow",dependencies:[Sg],vs:BW,fs:OW,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?WW(t,e):{}},$W={color:[255,255,255],intensity:1},Ly=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],qW=[0,0,0,200/255];class Mg{constructor(e={}){Z(this,"id","lighting-effect"),Z(this,"props",void 0),Z(this,"shadowColor",qW),Z(this,"shadow",void 0),Z(this,"ambientLight",void 0),Z(this,"directionalLights",void 0),Z(this,"pointLights",void 0),Z(this,"shadowPasses",[]),Z(this,"shadowMaps",[]),Z(this,"dummyShadowMap",null),Z(this,"programManager",void 0),Z(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const i=e[n];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:u}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=N2.getDefaultProgramManager(e),n4&&this.programManager.addDefaultModule(n4)),this.dummyShadowMap||(this.dummyShadowMap=new Ws(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:u,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(n4),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const i=new Vs().lookAt({eye:new Zt(n.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const i=new sW(e);this.shadowPasses[n]=i,this.shadowMaps[n]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:i}=this;!e&&n.length===0&&i.length===0&&(this.ambientLight=new VE($W),this.directionalLights.push(new x5(Ly[0]),new x5(Ly[1])))}}class ZW{constructor(e={}){Z(this,"_pool",[]),Z(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:i=1,type:r,padding:s=0,copy:u=!1,initialize:a=!1,maxCount:y}){const w=r||e&&e.constructor||Float32Array,I=n*i+s;if(ArrayBuffer.isView(e)){if(I<=e.length)return e;if(I*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new w(e.buffer,0,I)}let R=1/0;y&&(R=y*i+s);const D=this._allocate(w,I,a,R);return e&&u?D.set(e):a||D.fill(0,0,4),this._release(e),D}release(e){this._release(e)}_allocate(e,n,i,r){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>r&&(s=r);const u=this._pool,a=e.BYTES_PER_ELEMENT*s,y=u.findIndex(w=>w.byteLength>=a);if(y>=0){const w=new e(u.splice(y,1)[0],0,s);return i&&w.fill(0),w}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:i}=e,{byteLength:r}=i,s=n.findIndex(u=>u.byteLength>=r);s<0?n.push(i):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,i),n.length>this.opts.poolSize&&n.shift()}}const A1=new ZW;function If(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function XW(t){return[t[12],t[13],t[14]]}function QW(t){return{left:xh(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:xh(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:xh(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:xh(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:xh(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:xh(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const Dy=new Zt;function xh(t,e,n,i){Dy.set(t,e,n);const r=Dy.len();return{distance:i/r,normal:new Zt(-t/r,-e/r,-n/r)}}function YW(t){return t-Math.fround(t)}let Af;function i4(t,e){const{size:n=1,startIndex:i=0}=e,r=e.endIndex!==void 0?e.endIndex:t.length,s=(r-i)/n;Af=A1.allocate(Af,s,{type:Float32Array,size:n*2});let u=i,a=0;for(;u<r;){for(let y=0;y<n;y++){const w=t[u++];Af[a+y]=w,Af[a+y+n]=YW(w)}a+=n*2}return Af.subarray(0,s*n*2)}function KW(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}const JW=Math.PI/180,e$=If(),Ry=[0,0,0],t$={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function n$({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:s,near:u,far:a}){const y=t/e,w=n?new Vs().orthographic({fovy:i,aspect:y,focalDistance:r,near:u,far:a}):new Vs().perspective({fovy:i,aspect:y,near:u,far:a});if(s){const{left:I=0,right:R=0,top:D=0,bottom:U=0}=s,q=j0((I+t-R)/2,0,t)-t/2,ne=j0((D+e-U)/2,0,e)-e/2;w[8]-=q*2/t,w[9]+=ne*2/e}return w}class Eu{constructor(e={}){Z(this,"id",void 0),Z(this,"x",void 0),Z(this,"y",void 0),Z(this,"width",void 0),Z(this,"height",void 0),Z(this,"padding",void 0),Z(this,"isGeospatial",void 0),Z(this,"zoom",void 0),Z(this,"focalDistance",void 0),Z(this,"position",void 0),Z(this,"modelMatrix",void 0),Z(this,"distanceScales",void 0),Z(this,"scale",void 0),Z(this,"center",void 0),Z(this,"cameraPosition",void 0),Z(this,"projectionMatrix",void 0),Z(this,"viewMatrix",void 0),Z(this,"viewMatrixUncentered",void 0),Z(this,"viewMatrixInverse",void 0),Z(this,"viewProjectionMatrix",void 0),Z(this,"pixelProjectionMatrix",void 0),Z(this,"pixelUnprojectionMatrix",void 0),Z(this,"resolution",void 0),Z(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||t$,this.focalDistance=e.focalDistance||1,this.position=e.position||Ry,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?ha.WEB_MERCATOR:ha.WEB_MERCATOR_AUTO_OFFSET:ha.IDENTITY}equals(e){return e instanceof Eu?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Xl(e.projectionMatrix,this.projectionMatrix)&&Xl(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const i=this.projectPosition(e),r=YE(i,this.pixelProjectionMatrix),[s,u]=r,a=n?u:this.height-u;return e.length===2?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,u]=e,a=n?s:this.height-s,y=i&&i*this.distanceScales.unitsPerMeter[2],w=Pg([r,a,u],this.pixelUnprojectionMatrix,y),[I,R,D]=this.unprojectPosition(w);return Number.isFinite(u)?[I,R,D]:Number.isFinite(i)?[I,R,i]:[I,R]}projectPosition(e){const[n,i]=this.projectFlat(e),r=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,i,r]}unprojectPosition(e){const[n,i]=this.unprojectFlat(e),r=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,i,r]}projectFlat(e){if(this.isGeospatial){const n=tl(e);return n[1]=j0(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?uu(e):e}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,0],n),r=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),u=this.unproject([this.width,this.height],n);return[Math.min(i[0],r[0],s[0],u[0]),Math.min(i[1],r[1],s[1],u[1]),Math.max(i[0],r[0],s[0],u[0]),Math.max(i[1],r[1],s[1],u[1])]}getDistanceScales(e){return e?E5({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,QW(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=SW({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||E5({latitude:i,longitude:n}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:u}=e;let a=Ry;if(s&&(a=u?new Vs(u).transformAsVector(s,[]):s),this.isGeospatial){const y=this.projectPosition([n,i,0]);this.center=new Zt(a).scale(this.distanceScales.unitsPerMeter).add(y)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=e$,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:u=75,near:a=.1,far:y=1e3,padding:w=null,focalDistance:I=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Vs().multiplyRight(n).translate(new Zt(this.center).negate()),this.projectionMatrix=i||n$({width:this.width,height:this.height,orthographic:r,fovyRadians:s||u*JW,focalDistance:I,padding:w,near:a,far:y});const R=If();tu(R,R,this.projectionMatrix),tu(R,R,this.viewMatrix),this.viewProjectionMatrix=R,this.viewMatrixInverse=y5([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=XW(this.viewMatrixInverse);const D=If(),U=If();wg(D,D,[this.width/2,-this.height/2,1]),yp(D,D,[1,-1,0]),tu(U,D,this.viewProjectionMatrix),this.pixelProjectionMatrix=U,this.pixelUnprojectionMatrix=y5(If(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Xn.warn("Pixel project matrix not invertible")()}}Z(Eu,"displayName","Viewport");class oc extends Eu{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,pitch:s=0,bearing:u=0,nearZMultiplier:a=.1,farZMultiplier:y=1.01,nearZ:w,farZ:I,orthographic:R=!1,projectionMatrix:D,repeat:U=!1,worldOffset:q=0,position:ne,padding:pe,legacyMeterSizes:J=!1}=e;let{width:ie,height:re,altitude:ge=1.5}=e;const be=Math.pow(2,r);ie=ie||1,re=re||1;let De,qe=null;if(D)ge=D[5]/2,De=wp(ge);else{e.fovy?(De=e.fovy,ge=QE(De)):De=wp(ge);let ht;if(pe){const{top:ot=0,bottom:at=0}=pe;ht=[0,j0((ot+re-at)/2,0,re)-re/2]}qe=PW({width:ie,height:re,scale:be,center:ne&&[0,0,ne[2]*t4(n)],offset:ht,pitch:s,fovy:De,nearZMultiplier:a,farZMultiplier:y}),Number.isFinite(w)&&(qe.near=w),Number.isFinite(I)&&(qe.far=I)}let et=CW({height:re,pitch:s,bearing:u,scale:be,altitude:ge});q&&(et=new Vs().translate([512*q,0,0]).multiplyLeft(et)),super({...e,width:ie,height:re,viewMatrix:et,longitude:i,latitude:n,zoom:r,...qe,fovy:De,focalDistance:ge}),Z(this,"longitude",void 0),Z(this,"latitude",void 0),Z(this,"pitch",void 0),Z(this,"bearing",void 0),Z(this,"altitude",void 0),Z(this,"fovy",void 0),Z(this,"orthographic",void 0),Z(this,"_subViewports",void 0),Z(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=s,this.bearing=u,this.altitude=ge,this.fovy=De,this.orthographic=R,this._subViewports=U?[]:null,this._pseudoMeters=J,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=n;r<=i;r++){const s=r?new oc({...this,worldOffset:r}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,i]=this.projectFlat(e),r=(e[2]||0)*t4(e[1]);return[n,i,r]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,i]=this.unprojectFlat(e),r=(e[2]||0)/t4(i);return[n,i,r]}addMetersToLngLat(e,n){return XE(e,n)}panByPosition(e,n){const i=Pg(n,this.pixelUnprojectionMatrix),r=this.projectFlat(e),s=g5([],r,KG([],i)),u=g5([],this.center,s),[a,y]=this.unprojectFlat(u);return{longitude:a,latitude:y}}getBounds(e={}){const n=kW(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:i,height:r}=this,{longitude:s,latitude:u,zoom:a}=MW({width:i,height:r,bounds:e,...n});return new oc({width:i,height:r,longitude:s,latitude:u,zoom:a})}}Z(oc,"displayName","WebMercatorViewport");const zy=[0,0,0];function r4(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof oc){const[r,s,u=0]=t,a=e.getDistanceScales([r,s]);i[2]=u*a.unitsPerMeter[2]}return i}function i$(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:u}=t;return r===Yn.DEFAULT&&(r=e.isGeospatial?Yn.LNGLAT:Yn.CARTESIAN),s===void 0&&(s=r),u===void 0&&(u=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:u}}function tT(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[u,a,y=0]=t;switch(n&&([u,a,y]=P1([],[u,a,y,1],n)),i){case Yn.LNGLAT:return r4([u,a,y],e,s);case Yn.LNGLAT_OFFSETS:return r4([u+r[0],a+r[1],y+(r[2]||0)],e,s);case Yn.METER_OFFSETS:return r4(XE(r,[u,a,y]),e,s);case Yn.CARTESIAN:default:return e.isGeospatial?[u+r[0],a+r[1],y+r[2]]:e.projectPosition([u,a,y])}}function r$(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:u,fromCoordinateOrigin:a}=i$(e),{autoOffset:y=!0}=e,{geospatialOrigin:w=zy,shaderCoordinateOrigin:I=zy,offsetMode:R=!1}=y?$E(n,i,r):{},D=tT(t,{viewport:n,modelMatrix:s,coordinateSystem:u,coordinateOrigin:a,offsetMode:R});if(R){const U=n.projectPosition(w||I);CE(D,D,U)}return D}const hu=Math.PI/180,s$=1e3*60*60*24,o$=2440588,a$=2451545,bp=hu*23.4397,l$=357.5291,c$=.98560028,u$=280.147,h$=360.9856235;function f$(t,e,n){const i=hu*-n,r=hu*e,s=d$(t),u=w$(s),a=y$(s,i)-u.rightAscension;return{azimuth:g$(a,r,u.declination),altitude:_$(a,r,u.declination)}}function By(t,e,n){const{azimuth:i,altitude:r}=f$(t,e,n);return[Math.sin(i)*Math.cos(r),Math.cos(i)*Math.cos(r),-Math.sin(r)]}function A$(t){return(typeof t=="number"?t:t.getTime())/s$-.5+o$}function d$(t){return A$(t)-a$}function p$(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(bp)-Math.tan(e)*Math.sin(bp),Math.cos(n))}function m$(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(bp)+Math.cos(e)*Math.sin(bp)*Math.sin(n))}function g$(t,e,n){const i=t,r=e,s=n;return Math.atan2(Math.sin(i),Math.cos(i)*Math.sin(r)-Math.tan(s)*Math.cos(r))}function _$(t,e,n){const i=t,r=e,s=n;return Math.asin(Math.sin(r)*Math.sin(s)+Math.cos(r)*Math.cos(s)*Math.cos(i))}function y$(t,e){return hu*(u$+h$*t)-e}function v$(t){return hu*(l$+c$*t)}function x$(t){const e=t,n=hu*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),i=hu*102.9372;return e+n+i+Math.PI}function w$(t){const e=v$(t),n=x$(e);return{declination:m$(n,0),rightAscension:p$(n,0)}}class b$ extends x5{constructor(e){super(e),Z(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[r,s,u]=By(this.timestamp,0,0);this.direction=[r,-u,s]}else{const{latitude:r,longitude:s}=n;this.direction=By(this.timestamp,r,s)}return this}}const Oy={blendFunc:[1,0,32771,0],blendEquation:32774};class nT extends Tg{constructor(...e){super(...e),Z(this,"pickZ",void 0),Z(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,pickingFBO:u,deviceRect:{x:a,y,width:w,height:I},cullRect:R,effects:D,pass:U="picking",pickZ:q,moduleParameters:ne}){const pe=this.gl;this.pickZ=q;const J=this._resetColorEncoder(q),ie=da(pe,{scissorTest:!0,scissor:[a,y,w,I],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Oy,blend:!q},()=>super.render({target:u,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,cullRect:R,effects:D?.filter(ge=>ge.useInPicking),pass:U,isPicking:!0,moduleParameters:ne}));return this._colorEncoderState=null,{decodePickingColor:J&&T$.bind(null,J),stats:ie}}shouldDrawLayer(e){const{pickable:n,operation:i}=e.props;return n&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,i){const r={...e.props.parameters},{pickable:s,operation:u}=e.props;return this._colorEncoderState?s&&u.includes("draw")&&(Object.assign(r,Oy),r.blend=!0,r.blendColor=E$(this._colorEncoderState,e,i)):r.blend=!1,u.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function E$(t,e,n){const{byLayer:i,byAlpha:r}=t;let s,u=i.get(e);return u?(u.viewports.push(n),s=u.a):(s=i.size+1,s<=255?(u={a:s,layer:e,viewports:[n]},i.set(e,u),r[s]=u):(Xn.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function T$(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Eh={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Ep=Symbol.for("component"),X0=Symbol.for("propTypes"),s4=Symbol.for("deprecatedProps"),Xh=Symbol.for("asyncPropDefaults"),fu=Symbol.for("asyncPropOriginal"),H0=Symbol.for("asyncPropResolved");function h3(t,e=()=>!0){return Array.isArray(t)?iT(t,e,[]):e(t)?[t]:[]}function iT(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?iT(r,e,n):e(r)&&n.push(r)}return n}function S$({target:t,source:e,start:n=0,count:i=1}){const r=e.length,s=i*r;let u=0;for(let a=n;u<r;u++)t[a++]=e[u];for(;u<s;)u<s-u?(t.copyWithin(n+u,n,n+u),u*=2):(t.copyWithin(n+u,n,n+s-u),u=s);return t}function Fy(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class Ny{constructor(e,n){Z(this,"name",void 0),Z(this,"type",void 0),Z(this,"sampleSize",1),Z(this,"time",void 0),Z(this,"count",void 0),Z(this,"samples",void 0),Z(this,"lastTiming",void 0),Z(this,"lastSampleTime",void 0),Z(this,"lastSampleCount",void 0),Z(this,"_count",0),Z(this,"_time",0),Z(this,"_samples",0),Z(this,"_startTime",0),Z(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Fy(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Fy()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class rT{constructor(e){Z(this,"id",void 0),Z(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof Ny?this.stats[n]=e:this.stats[n]=new Ny(n,i)),this.stats[n]}}class C${constructor(e,n,i){Z(this,"id",void 0),Z(this,"context",void 0),Z(this,"isLoaded",void 0),Z(this,"persistent",void 0),Z(this,"_loadCount",0),Z(this,"_subscribers",new Set),Z(this,"_data",void 0),Z(this,"_loader",void 0),Z(this,"_error",void 0),Z(this,"_content",void 0),this.id=e,this.context=i,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const i=++this._loadCount;let r=e;typeof e=="string"&&(r=fp(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class P${constructor({gl:e,protocol:n}){Z(this,"protocol",void 0),Z(this,"_context",void 0),Z(this,"_resources",void 0),Z(this,"_consumers",void 0),Z(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(n,i):(s=new C$(e,n,this._context),this._resources[e]=s),s.persistent=r}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const i in n){const r=n[i],s=this._resources[r.resourceId];s&&s.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:u}=this;e.startsWith(u)&&(e=e.replace(u,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,i,r){const s=this._consumers,u=s[e]=s[e]||{},a=u[n]||{},y=a.resourceId&&this._resources[a.resourceId];y&&(y.unsubscribe(a),this.prune()),i&&(u[n]=a,a.onChange=r,a.resourceId=i.id,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const M$=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Tu={name:"project32",dependencies:[Sg],vs:M$},Su={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...vH},I$=[Sg],k$=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function L$(t){const e=N2.getDefaultProgramManager(t);for(const n of I$)e.addDefaultModule(n);for(const n of k$)e.addShaderHook(n);return e}const D$="layerManager.setLayers",R$="layerManager.activateViewport";class z${constructor(e,{deck:n,stats:i,viewport:r,timeline:s}={}){Z(this,"layers",void 0),Z(this,"context",void 0),Z(this,"resourceManager",void 0),Z(this,"_lastRenderedLayers",[]),Z(this,"_needsRedraw",!1),Z(this,"_needsUpdate",!1),Z(this,"_nextLayers",null),Z(this,"_debug",!1),Z(this,"activateViewport",u=>{ss(R$,this,u),u&&(this.context.viewport=u)}),this.layers=[],this.resourceManager=new P$({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&L$(e),stats:i||new rT({id:"deck.gl"}),viewport:r||new Eu({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new UE,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);n=n||r}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(i=>n.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){ss(D$,this,n,e),this._lastRenderedLayers=e;const i=h3(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,i){i.raiseError(n,"".concat(e," of ").concat(i))}_updateLayers(e,n){const i={};for(const u of e)i[u.id]?Xn.warn("Multiple old layers with same id ".concat(u.id))():i[u.id]=u;const r=[];this._updateSublayersRecursively(n,i,r),this._finalizeOldLayers(i);let s=!1;for(const u of r)if(u.hasUniformTransition()){s="Uniform transition in ".concat(u);break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,n,i){for(const r of e){r.context=this.context;const s=n[r.id];s===null&&Xn.warn("Multiple new layers with same id ".concat(r.id))(),n[r.id]=null;let u=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),u=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}u&&this._updateSublayersRecursively(u,n,i)}}_finalizeOldLayers(e){for(const n in e){const i=e[n];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Eh.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Eh.MATCHED,n!==e&&(e.lifecycle=Eh.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Eh.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Eh.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Qa(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!Qa(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const s of i)if(!e.hasOwnProperty(s)||!Qa(t[s],e[s],n-1))return!1;return!0}return!1}class B${constructor(e){Z(this,"width",void 0),Z(this,"height",void 0),Z(this,"views",void 0),Z(this,"viewState",void 0),Z(this,"controllers",void 0),Z(this,"timeline",void 0),Z(this,"_viewports",void 0),Z(this,"_viewportMap",void 0),Z(this,"_isUpdating",void 0),Z(this,"_needsRedraw",void 0),Z(this,"_needsUpdate",void 0),Z(this,"_eventManager",void 0),Z(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,i=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,n){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const u=i[s];if(u.containsPixel(r)){const a=e.slice();return a[0]-=u.x,a[1]-=u.y,u.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=h3(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Qa(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Xn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const i=n.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var u;return(u=this.getView(e.id))===null||u===void 0?void 0:u.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,i,r){const s=e.controller;if(s&&i){const u={...n,...s,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!r||r.constructor!==s.type)&&(r=this._createController(e,u)),r&&r.setProps(u),r}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const s=e[r],u=this.getViewState(s),a=s.makeViewport({viewState:u,width:this.width,height:this.height});let y=n[s.id];const w=!!s.controller;w&&!y&&(i=!0),(i||!w)&&y&&(y.finalize(),y=null),this.controllers[s.id]=this._updateController(s,u,a,y),a&&this._viewports.unshift(a)}for(const r in n){const s=n[r];s&&!this.controllers[r]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((i,r)=>!e[r].equals(n[r]))}}const O$=/([0-9]+\.?[0-9]*)(%|px)/;function R0(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=O$.exec(t);if(e&&e.length>=3){const n=e[2]==="%",i=parseFloat(e[1]);return{position:n?i/100:i,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function z0(t,e){return t.relative?Math.round(t.position*e):t.position}function Mr(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class d1{constructor(e){Z(this,"id",void 0),Z(this,"viewportInstance",void 0),Z(this,"_x",void 0),Z(this,"_y",void 0),Z(this,"_width",void 0),Z(this,"_height",void 0),Z(this,"_padding",void 0),Z(this,"props",void 0);const{id:n,x:i=0,y:r=0,width:s="100%",height:u="100%",padding:a=null,viewportInstance:y}=e||{};Mr(!y||y instanceof Eu),this.viewportInstance=y,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=R0(i),this._y=R0(r),this._width=R0(s),this._height=R0(u),this._padding=a&&{left:R0(a.left||0),right:R0(a.right||0),top:R0(a.top||0),bottom:R0(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Qa(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return!r.height||!r.width?null:new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const i in this.props.viewState)i!=="id"&&(n[i]=this.props.viewState[i]);return n}return e}getDimensions({width:e,height:n}){const i={x:z0(this._x,e),y:z0(this._y,n),width:z0(this._width,e),height:z0(this._height,n)};return this._padding&&(i.padding={left:z0(this._padding.left,e),top:z0(this._padding.top,n),right:z0(this._padding.right,e),bottom:z0(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class V2{constructor(e){Z(this,"_inProgress",void 0),Z(this,"_handle",void 0),Z(this,"_timeline",void 0),Z(this,"time",void 0),Z(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,i;this.cancel(),this.settings=e,this._inProgress=!0,(n=(i=this.settings).onStart)===null||n===void 0||n.call(i,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Uy=()=>{},T5={BREAK:1,SNAP_TO_END:2,IGNORE:3},F$=t=>t,N$=T5.BREAK;class U${constructor(e){Z(this,"getControllerState",void 0),Z(this,"props",void 0),Z(this,"propsInTransition",void 0),Z(this,"transition",void 0),Z(this,"onViewStateChange",void 0),Z(this,"onStateChange",void 0),Z(this,"_onTransitionUpdate",n=>{const{time:i,settings:{interpolator:r,startProps:s,endProps:u,duration:a,easing:y}}=n,w=y(i/a),I=r.interpolateProps(s,u,w);this.propsInTransition=this.getControllerState({...this.props,...I}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new V2(e.timeline),this.onViewStateChange=e.onViewStateChange||Uy,this.onStateChange=e.onStateChange||Uy}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:s,endProps:u}=this.transition.settings;r={...i,...s===T5.SNAP_TO_END?u:this.propsInTransition||i}}this._triggerTransition(r,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:i}=e;return(n>0||n==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===T5.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const i=this.getControllerState(e),r=this.getControllerState(n).shortestPathFrom(i),s=n.transitionInterpolator,u=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(u===0)return;const a=s.initializeProps(e,r);this.propsInTransition={};const y={duration:u,easing:n.transitionEasing||F$,interpolator:s,interruption:n.transitionInterruption||N$,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(y),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class sT{constructor(e){Z(this,"_propsToCompare",void 0),Z(this,"_propsToExtract",void 0),Z(this,"_requiredProps",void 0);const{compare:n,extract:i,required:r}=e;this._propsToCompare=n,this._propsToExtract=i||n,this._requiredProps=r}arePropsEqual(e,n){for(const i of this._propsToCompare)if(!(i in e)||!(i in n)||!Xl(e[i],n[i]))return!1;return!0}initializeProps(e,n){const i={},r={};for(const s of this._propsToExtract)(s in e||s in n)&&(i[s]=e[s],r[s]=n[s]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const i=e[n];Mr(Number.isFinite(i)||Array.isArray(i),"".concat(n," is required for transition"))})}}const V$=["longitude","latitude","zoom","bearing","pitch"],G$=["longitude","latitude","zoom"];class oT extends sT{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:V$,required:G$},super(i.transitionProps),Z(this,"opts",void 0),this.opts=i}initializeProps(e,n){const i=super.initializeProps(e,n),{makeViewport:r,around:s}=this.opts;if(r&&s){const u=r(e),a=r(n),y=u.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(y),aroundPosition:y,width:n.width,height:n.height})}return i}interpolateProps(e,n,i){const r={};for(const s of this._propsToExtract)r[s]=Ka(e[s]||0,n[s]||0,i);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...r});Object.assign(r,s.panByPosition(n.aroundPosition,Ka(e.around,n.around,i)))}return r}}const B0={transitionDuration:0},j$=300,NA=t=>1-(1-t)*(1-t),wh={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Gc={};class H${constructor(e){Z(this,"props",void 0),Z(this,"state",{}),Z(this,"transitionManager",void 0),Z(this,"eventManager",void 0),Z(this,"onViewStateChange",void 0),Z(this,"onStateChange",void 0),Z(this,"makeViewport",void 0),Z(this,"_controllerState",void 0),Z(this,"_events",{}),Z(this,"_interactionState",{isDragging:!1}),Z(this,"_customEvents",[]),Z(this,"_eventStartBlocked",null),Z(this,"_panMove",!1),Z(this,"invertPan",!1),Z(this,"dragMode","rotate"),Z(this,"inertia",0),Z(this,"scrollZoom",!0),Z(this,"dragPan",!0),Z(this,"dragRotate",!0),Z(this,"doubleClickZoom",!0),Z(this,"touchZoom",!0),Z(this,"touchRotate",!1),Z(this,"keyboard",!0),this.transitionManager=new U$({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:i}=this.props,{offsetCenter:r}=e;return[r.x-n,r.y-i]}isPointInBounds(e,n){const{width:i,height:r}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?j$:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:u=!0,touchZoom:a=!0,touchRotate:y=!1,keyboard:w=!0}=e,I=!!this.onViewStateChange;this.toggleEvents(wh.WHEEL,I&&i),this.toggleEvents(wh.PAN,I),this.toggleEvents(wh.PINCH,I&&(a||y)),this.toggleEvents(wh.TRIPLE_PAN,I&&y),this.toggleEvents(wh.DOUBLE_TAP,I&&u),this.toggleEvents(wh.KEYBOARD,I&&w),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=u,this.touchZoom=a,this.touchRotate=y,this.keyboard=w}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(i=>{this._events[i]!==n&&(this._events[i]=n,n?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,n=null,i={}){const r={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const u=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:u})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:n});return this._panMove=i,this.updateViewport(r,B0,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),i=this.controllerState.pan({pos:n});return this.updateViewport(i,B0,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:NA},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),i=this.controllerState.rotate({pos:n});return this.updateViewport(i,B0,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:NA},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:i=.01,smooth:r=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let u=2/(1+Math.exp(-Math.abs(s*i)));s<0&&u!==0&&(u=1/u);const a=this.controllerState.zoom({pos:n,scale:u});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.rotateStart({pos:n});return this.updateViewport(i,B0,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const i=this.controllerState.rotate({pos:n});return this.updateViewport(i,B0,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:NA},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Gc._startPinchRotation=e.rotation,Gc._lastPinchEvent=e,this.updateViewport(i,B0,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);n=n.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;n=n.rotate({deltaAngleX:Gc._startPinchRotation-i})}return this.updateViewport(n,B0,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Gc._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:i}=Gc;if(this.touchZoom&&n&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const u=Math.log2(e.scale),a=(u-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),y=Math.pow(2,u+a*n/2);s=s.zoom({pos:r,scale:y}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:r}),transitionDuration:n,transitionEasing:NA},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Gc._startPinchRotation=null,Gc._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:n,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:u}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let y;const w={};switch(e.srcEvent.code){case"Minus":y=n?a.zoomOut(i).zoomOut(i):a.zoomOut(i),w.isZooming=!0;break;case"Equal":y=n?a.zoomIn(i).zoomIn(i):a.zoomIn(i),w.isZooming=!0;break;case"ArrowLeft":n?(y=a.rotateLeft(s),w.isRotating=!0):(y=a.moveLeft(r),w.isPanning=!0);break;case"ArrowRight":n?(y=a.rotateRight(s),w.isRotating=!0):(y=a.moveRight(r),w.isPanning=!0);break;case"ArrowUp":n?(y=a.rotateUp(u),w.isRotating=!0):(y=a.moveUp(r),w.isPanning=!0);break;case"ArrowDown":n?(y=a.rotateDown(u),w.isRotating=!0):(y=a.moveDown(r),w.isPanning=!0);break;default:return!1}return this.updateViewport(y,this._getTransitionProps(),w),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?B0:e?{...n,transitionInterpolator:new oT({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class W${constructor(e,n){Z(this,"_viewportProps",void 0),Z(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Vy=5,$$=1.2;class q$ extends W${constructor(e){const{width:n,height:i,latitude:r,longitude:s,zoom:u,bearing:a=0,pitch:y=0,altitude:w=1.5,position:I=[0,0,0],maxZoom:R=20,minZoom:D=0,maxPitch:U=60,minPitch:q=0,startPanLngLat:ne,startZoomLngLat:pe,startRotatePos:J,startBearing:ie,startPitch:re,startZoom:ge,normalize:be=!0}=e;Mr(Number.isFinite(s)),Mr(Number.isFinite(r)),Mr(Number.isFinite(u)),super({width:n,height:i,latitude:r,longitude:s,zoom:u,bearing:a,pitch:y,altitude:w,maxZoom:R,minZoom:D,maxPitch:U,minPitch:q,normalize:be,position:I},{startPanLngLat:ne,startZoomLngLat:pe,startRotatePos:J,startBearing:ie,startPitch:re,startZoom:ge}),Z(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:u}=this.getState();if(!r||s===void 0||u===void 0)return this;let a;return e?a=this._getNewRotation(e,r,u,s):a={bearing:s+n,pitch:u+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomLngLat:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:u,minZoom:a}=this.getViewportProps();let y=r+Math.log2(i);y=j0(y,a,u);const w=this.makeViewport({...this.getViewportProps(),zoom:y});return this._getUpdatedState({zoom:y,...w.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:s}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-n.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=j0(r,i,n);const{maxPitch:s,minPitch:u,pitch:a}=e;e.pitch=j0(a,u,s);const{normalize:y=!0}=e;return y&&Object.assign(e,LW(e)),e}_zoomFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.zoom({pos:[n/2,i/2],scale:e})}_panFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.pan({startPos:[n/2,i/2],pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,i,r){const s=e[0]-n[0],u=e[1]-n[1],a=e[1],y=n[1],{width:w,height:I}=this.getViewportProps(),R=s/w;let D=0;u>0?Math.abs(I-y)>Vy&&(D=u/(y-I)*$$):u<0&&y>Vy&&(D=1-a/y),D=j0(D,-1,1);const{minPitch:U,maxPitch:q}=this.getViewportProps(),ne=r+180*R;let pe=i;return D>0?pe=i+D*(q-i):D<0&&(pe=i-D*(U-i)),{pitch:pe,bearing:ne}}}class Z$ extends H${constructor(...e){super(...e),Z(this,"ControllerState",q$),Z(this,"transition",{transitionDuration:300,transitionInterpolator:new oT({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),Z(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class aT extends d1{get ViewportType(){return oc}get ControllerType(){return Z$}}Z(aT,"displayName","MapView");const X$=new Mg;function Q$(t,e){var n,i;const r=(n=t.order)!==null&&n!==void 0?n:1/0,s=(i=e.order)!==null&&i!==void 0?i:1/0;return r-s}class Y${constructor(){Z(this,"effects",void 0),Z(this,"_resolvedEffects",[]),Z(this,"_defaultEffects",[]),Z(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(i=>i.id===e.id)){const i=n.findIndex(r=>Q$(r,e)>0);i<0?n.push(e):n.splice(i,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Qa(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const r of this.effects)n[r.id]=r;const i=[];for(const r of e){const s=n[r.id];s&&s!==r?s.setProps?(s.setProps(r.props),i.push(s)):(s.cleanup(),i.push(r)):i.push(r),delete n[r.id]}for(const r in n)n[r].cleanup();this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(r=>r instanceof Mg)||this._resolvedEffects.push(X$),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class K$ extends Tg{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const J$="deckRenderer.renderLayers";class eq{constructor(e){Z(this,"gl",void 0),Z(this,"layerFilter",void 0),Z(this,"drawPickingColors",void 0),Z(this,"drawLayersPass",void 0),Z(this,"pickLayersPass",void 0),Z(this,"renderCount",void 0),Z(this,"_needsRedraw",void 0),Z(this,"renderBuffers",void 0),Z(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new K$(e),this.pickLayersPass=new nT(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||vr.getDefaultFramebuffer(this.gl)};i.effects&&this._preRender(i.effects,i);const r=this.lastPostProcessEffect?this.renderBuffers[0]:i.target,s=n.render({...i,target:r});i.effects&&this._postRender(i.effects,i),this.renderCount++,ss(J$,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const i of e)n.preRenderStats[i.id]=i.preRender(this.gl,n),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new vr(this.gl),new vr(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:i}=this,r={...n,inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){r.target=n.target,s.postRender(this.gl,r);break}const u=s.postRender(this.gl,r);r.inputBuffer=u,r.swapBuffer=u===i[0]?i[1]:i[0]}}}const tq={pickedColor:null,pickedObjectIndex:-1};function nq({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:s}){const{x:u,y:a,width:y,height:w}=s;let I=r*r,R=-1,D=0;for(let U=0;U<w;U++){const q=U+a-i,ne=q*q;if(ne>I)D+=4*y;else for(let pe=0;pe<y;pe++){if(t[D+3]-1>=0){const ie=pe+u-n,re=ie*ie+ne;re<=I&&(I=re,R=D)}D+=4}}if(R>=0){const U=t.slice(R,R+4),q=e(U);if(q){const ne=Math.floor(R/4/y),pe=R/4-ne*y;return{...q,pickedColor:U,pickedX:u+pe,pickedY:a+ne}}Xn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return tq}function iq({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const s=t.slice(i,i+4),u=s.join(",");if(!n.has(u)){const a=e(s);a?n.set(u,{...a,color:s}):Xn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function lT({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:s}){let u=e[0];e.length>1&&(u=sq(t?.pickedViewports||e,{x:i,y:r}));let a;if(u){const y=[i-u.x,r-u.y];s!==void 0&&(y[2]=s),a=u.unproject(y)}return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function rq(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:s,pickedLayer:u,pickedObjectIndex:a}=e,y=u?[u]:[];if(i==="hover"){const R=n.index,D=n.layerId,U=u?u.props.id:null;if(U!==D||a!==R){if(U!==D){const q=r.find(ne=>ne.props.id===D);q&&y.unshift(q)}n.layerId=U,n.index=a,n.info=null}}const w=lT(t),I=new Map;return I.set(null,w),y.forEach(R=>{let D={...w};R===u&&(D.color=s,D.index=a,D.picked=!0),D=cT({layer:R,info:D,mode:i});const U=D.layer;R===u&&i==="hover"&&(n.info=D),I.set(U.id,D),i==="hover"&&U.updateAutoHighlight(D)}),I}function cT({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function sq(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}class oq{constructor(e){Z(this,"gl",void 0),Z(this,"pickingFBO",void 0),Z(this,"depthFBO",void 0),Z(this,"pickLayersPass",void 0),Z(this,"layerFilter",void 0),Z(this,"lastPickedInfo",void 0),Z(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new nT(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:i,viewports:r},s=this.lastPickedInfo.info){const u=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,y=u?i.find(D=>D.id===u):null,w=a&&r.find(D=>D.id===a)||r[0],I=w&&w.unproject([e-w.x,n-w.y]);return{...s,...{x:e,y:n,viewport:w,coordinate:I,layer:y}}}_resizeBuffer(){var e,n;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new vr(i),vr.isSupported(i,{colorBufferFloat:!0}))){const r=new vr(i);r.attach({36064:new Ws(i,{format:Kn(i)?34836:6408,type:5126})}),this.depthFBO=r}(e=this.pickingFBO)===null||e===void 0||e.resize({width:i.canvas.width,height:i.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:i,x:r,y:s,radius:u=0,depth:a=1,mode:y="query",unproject3D:w,onViewportActive:I,effects:R}){const D=this._getPickable(e),U=c1(this.gl);if(!D)return{result:[],emptyInfo:lT({viewports:i,x:r,y:s,pixelRatio:U})};this._resizeBuffer();const q=Um(this.gl,[r,s],!0),ne=[q.x+Math.floor(q.width/2),q.y+Math.floor(q.height/2)],pe=Math.round(u*U),{width:J,height:ie}=this.pickingFBO,re=this._getPickingRect({deviceX:ne[0],deviceY:ne[1],deviceRadius:pe,deviceWidth:J,deviceHeight:ie}),ge={x:r-u,y:s-u,width:u*2+1,height:u*2+1};let be;const De=[],qe=new Set;for(let et=0;et<a;et++){let ht;if(re){const at=this._drawAndSample({layers:D,views:n,viewports:i,onViewportActive:I,deviceRect:re,cullRect:ge,effects:R,pass:"picking:".concat(y)});ht=nq({...at,deviceX:ne[0],deviceY:ne[1],deviceRadius:pe,deviceRect:re})}else ht={pickedColor:null,pickedObjectIndex:-1};let ot;if(ht.pickedLayer&&w&&this.depthFBO){const{pickedColors:at}=this._drawAndSample({layers:[ht.pickedLayer],views:n,viewports:i,onViewportActive:I,deviceRect:{x:ht.pickedX,y:ht.pickedY,width:1,height:1},cullRect:ge,effects:R,pass:"picking:".concat(y,":z")},!0);at[3]&&(ot=at[0])}ht.pickedLayer&&et+1<a&&(qe.add(ht.pickedLayer),ht.pickedLayer.disablePickingIndex(ht.pickedObjectIndex)),be=rq({pickInfo:ht,lastPickedInfo:this.lastPickedInfo,mode:y,layers:D,viewports:i,x:r,y:s,z:ot,pixelRatio:U});for(const at of be.values())at.layer&&De.push(at);if(!ht.pickedColor)break}for(const et of qe)et.restorePickingColors();return{result:De,emptyInfo:be.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:i,x:r,y:s,width:u=1,height:a=1,mode:y="query",maxObjects:w=null,onViewportActive:I,effects:R}){const D=this._getPickable(e);if(!D)return[];this._resizeBuffer();const U=c1(this.gl),q=Um(this.gl,[r,s],!0),ne=q.x,pe=q.y+q.height,J=Um(this.gl,[r+u,s+a],!0),ie=J.x+J.width,re=J.y,ge={x:ne,y:re,width:ie-ne,height:pe-re},be=this._drawAndSample({layers:D,views:n,viewports:i,onViewportActive:I,deviceRect:ge,cullRect:{x:r,y:s,width:u,height:a},effects:R,pass:"picking:".concat(y)}),De=iq(be),qe=new Map,et=Number.isFinite(w);for(let ht=0;ht<De.length&&!(et&&w&&qe.size>=w);ht++){const ot=De[ht];let at={color:ot.pickedColor,layer:null,index:ot.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:U};at=cT({layer:ot.pickedLayer,info:at,mode:y}),qe.has(at.object)||qe.set(at.object,at)}return Array.from(qe.values())}_drawAndSample({layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:s,cullRect:u,effects:a,pass:y},w=!1){const I=w?this.depthFBO:this.pickingFBO,R={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:I,deviceRect:s,cullRect:u,effects:a,pass:y,pickZ:w,preRenderStats:{}};for(const ie of a)ie.useInPicking&&(R.preRenderStats[ie.id]=ie.preRender(this.gl,R));const{decodePickingColor:D}=this.pickLayersPass.render(R),{x:U,y:q,width:ne,height:pe}=s,J=new(w?Float32Array:Uint8Array)(ne*pe*4);return u3(I,{sourceX:U,sourceY:q,sourceWidth:ne,sourceHeight:pe,target:J}),{pickedColors:J,decodePickingColor:D}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const u=Math.max(0,e-i),a=Math.max(0,n-i),y=Math.min(r,e+i+1)-u,w=Math.min(s,n+i+1)-a;return y<=0||w<=0?null:{x:u,y:a,width:y,height:w}}}const aq={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class lq{constructor(e){Z(this,"el",null),Z(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,aq),n.appendChild(this.el))}setTooltip(e,n,i){const r=this.el;if(r){if(typeof e=="string")r.innerText=e;else if(e)e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className);else{this.isVisible=!1,r.style.display="none";return}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(n,"px, ").concat(i,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(r.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var cq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function f3(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uT={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,i,r){var s=["","webkit","Moz","MS","ms","o"],u=n.createElement("div"),a="function",y=Math.round,w=Math.abs,I=Date.now;function R(ue,me,Ie){return setTimeout(re(ue,Ie),me)}function D(ue,me,Ie){return Array.isArray(ue)?(U(ue,Ie[me],Ie),!0):!1}function U(ue,me,Ie){var Qe;if(ue)if(ue.forEach)ue.forEach(me,Ie);else if(ue.length!==r)for(Qe=0;Qe<ue.length;)me.call(Ie,ue[Qe],Qe,ue),Qe++;else for(Qe in ue)ue.hasOwnProperty(Qe)&&me.call(Ie,ue[Qe],Qe,ue)}function q(ue,me,Ie){var Qe="DEPRECATED METHOD: "+me+`
`+Ie+` AT 
`;return function(){var gt=new Error("get-stack-trace"),Ut=gt&&gt.stack?gt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",En=e.console&&(e.console.warn||e.console.log);return En&&En.call(e.console,Qe,Ut),ue.apply(this,arguments)}}var ne;typeof Object.assign!="function"?ne=function(me){if(me===r||me===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ie=Object(me),Qe=1;Qe<arguments.length;Qe++){var gt=arguments[Qe];if(gt!==r&&gt!==null)for(var Ut in gt)gt.hasOwnProperty(Ut)&&(Ie[Ut]=gt[Ut])}return Ie}:ne=Object.assign;var pe=q(function(me,Ie,Qe){for(var gt=Object.keys(Ie),Ut=0;Ut<gt.length;)(!Qe||Qe&&me[gt[Ut]]===r)&&(me[gt[Ut]]=Ie[gt[Ut]]),Ut++;return me},"extend","Use `assign`."),J=q(function(me,Ie){return pe(me,Ie,!0)},"merge","Use `assign`.");function ie(ue,me,Ie){var Qe=me.prototype,gt;gt=ue.prototype=Object.create(Qe),gt.constructor=ue,gt._super=Qe,Ie&&ne(gt,Ie)}function re(ue,me){return function(){return ue.apply(me,arguments)}}function ge(ue,me){return typeof ue==a?ue.apply(me&&me[0]||r,me):ue}function be(ue,me){return ue===r?me:ue}function De(ue,me,Ie){U(ot(me),function(Qe){ue.addEventListener(Qe,Ie,!1)})}function qe(ue,me,Ie){U(ot(me),function(Qe){ue.removeEventListener(Qe,Ie,!1)})}function et(ue,me){for(;ue;){if(ue==me)return!0;ue=ue.parentNode}return!1}function ht(ue,me){return ue.indexOf(me)>-1}function ot(ue){return ue.trim().split(/\s+/g)}function at(ue,me,Ie){if(ue.indexOf&&!Ie)return ue.indexOf(me);for(var Qe=0;Qe<ue.length;){if(Ie&&ue[Qe][Ie]==me||!Ie&&ue[Qe]===me)return Qe;Qe++}return-1}function Mt(ue){return Array.prototype.slice.call(ue,0)}function ut(ue,me,Ie){for(var Qe=[],gt=[],Ut=0;Ut<ue.length;){var En=me?ue[Ut][me]:ue[Ut];at(gt,En)<0&&Qe.push(ue[Ut]),gt[Ut]=En,Ut++}return Ie&&(me?Qe=Qe.sort(function(Tn,ki){return Tn[me]>ki[me]}):Qe=Qe.sort()),Qe}function St(ue,me){for(var Ie,Qe,gt=me[0].toUpperCase()+me.slice(1),Ut=0;Ut<s.length;){if(Ie=s[Ut],Qe=Ie?Ie+gt:me,Qe in ue)return Qe;Ut++}return r}var Pn=1;function Ot(){return Pn++}function Gn(ue){var me=ue.ownerDocument||ue;return me.defaultView||me.parentWindow||e}var vt=/mobile|tablet|ip(ad|hone|od)|android/i,Bt="ontouchstart"in e,Qt=St(e,"PointerEvent")!==r,Mn=Bt&&vt.test(navigator.userAgent),bn="touch",pn="pen",Nn="mouse",ti="kinect",Ue=25,An=1,Un=2,At=4,Xt=8,yn=1,mt=2,jn=4,Bn=8,li=16,ei=mt|jn,ci=Bn|li,hr=ei|ci,Dn=["x","y"],fr=["clientX","clientY"];function ni(ue,me){var Ie=this;this.manager=ue,this.callback=me,this.element=ue.element,this.target=ue.options.inputTarget,this.domHandler=function(Qe){ge(ue.options.enable,[ue])&&Ie.handler(Qe)},this.init()}ni.prototype={handler:function(){},init:function(){this.evEl&&De(this.element,this.evEl,this.domHandler),this.evTarget&&De(this.target,this.evTarget,this.domHandler),this.evWin&&De(Gn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&qe(this.element,this.evEl,this.domHandler),this.evTarget&&qe(this.target,this.evTarget,this.domHandler),this.evWin&&qe(Gn(this.element),this.evWin,this.domHandler)}};function Wr(ue){var me,Ie=ue.options.inputClass;return Ie?me=Ie:Qt?me=pt:Mn?me=Rr:Bt?me=Y:me=mn,new me(ue,yo)}function yo(ue,me,Ie){var Qe=Ie.pointers.length,gt=Ie.changedPointers.length,Ut=me&An&&Qe-gt===0,En=me&(At|Xt)&&Qe-gt===0;Ie.isFirst=!!Ut,Ie.isFinal=!!En,Ut&&(ue.session={}),Ie.eventType=me,sr(ue,Ie),ue.emit("hammer.input",Ie),ue.recognize(Ie),ue.session.prevInput=Ie}function sr(ue,me){var Ie=ue.session,Qe=me.pointers,gt=Qe.length;Ie.firstInput||(Ie.firstInput=$r(me)),gt>1&&!Ie.firstMultiple?Ie.firstMultiple=$r(me):gt===1&&(Ie.firstMultiple=!1);var Ut=Ie.firstInput,En=Ie.firstMultiple,_i=En?En.center:Ut.center,Tn=me.center=nt(Qe);me.timeStamp=I(),me.deltaTime=me.timeStamp-Ut.timeStamp,me.angle=In(_i,Tn),me.distance=or(_i,Tn),Lr(Ie,me),me.offsetDirection=Ms(me.deltaX,me.deltaY);var ki=wt(me.deltaTime,me.deltaX,me.deltaY);me.overallVelocityX=ki.x,me.overallVelocityY=ki.y,me.overallVelocity=w(ki.x)>w(ki.y)?ki.x:ki.y,me.scale=En?Ar(En.pointers,Qe):1,me.rotation=En?wr(En.pointers,Qe):0,me.maxPointers=Ie.prevInput?me.pointers.length>Ie.prevInput.maxPointers?me.pointers.length:Ie.prevInput.maxPointers:me.pointers.length,vo(Ie,me);var On=ue.element;et(me.srcEvent.target,On)&&(On=me.srcEvent.target),me.target=On}function Lr(ue,me){var Ie=me.center,Qe=ue.offsetDelta||{},gt=ue.prevDelta||{},Ut=ue.prevInput||{};(me.eventType===An||Ut.eventType===At)&&(gt=ue.prevDelta={x:Ut.deltaX||0,y:Ut.deltaY||0},Qe=ue.offsetDelta={x:Ie.x,y:Ie.y}),me.deltaX=gt.x+(Ie.x-Qe.x),me.deltaY=gt.y+(Ie.y-Qe.y)}function vo(ue,me){var Ie=ue.lastInterval||me,Qe=me.timeStamp-Ie.timeStamp,gt,Ut,En,_i;if(me.eventType!=Xt&&(Qe>Ue||Ie.velocity===r)){var Tn=me.deltaX-Ie.deltaX,ki=me.deltaY-Ie.deltaY,On=wt(Qe,Tn,ki);Ut=On.x,En=On.y,gt=w(On.x)>w(On.y)?On.x:On.y,_i=Ms(Tn,ki),ue.lastInterval=me}else gt=Ie.velocity,Ut=Ie.velocityX,En=Ie.velocityY,_i=Ie.direction;me.velocity=gt,me.velocityX=Ut,me.velocityY=En,me.direction=_i}function $r(ue){for(var me=[],Ie=0;Ie<ue.pointers.length;)me[Ie]={clientX:y(ue.pointers[Ie].clientX),clientY:y(ue.pointers[Ie].clientY)},Ie++;return{timeStamp:I(),pointers:me,center:nt(me),deltaX:ue.deltaX,deltaY:ue.deltaY}}function nt(ue){var me=ue.length;if(me===1)return{x:y(ue[0].clientX),y:y(ue[0].clientY)};for(var Ie=0,Qe=0,gt=0;gt<me;)Ie+=ue[gt].clientX,Qe+=ue[gt].clientY,gt++;return{x:y(Ie/me),y:y(Qe/me)}}function wt(ue,me,Ie){return{x:me/ue||0,y:Ie/ue||0}}function Ms(ue,me){return ue===me?yn:w(ue)>=w(me)?ue<0?mt:jn:me<0?Bn:li}function or(ue,me,Ie){Ie||(Ie=Dn);var Qe=me[Ie[0]]-ue[Ie[0]],gt=me[Ie[1]]-ue[Ie[1]];return Math.sqrt(Qe*Qe+gt*gt)}function In(ue,me,Ie){Ie||(Ie=Dn);var Qe=me[Ie[0]]-ue[Ie[0]],gt=me[Ie[1]]-ue[Ie[1]];return Math.atan2(gt,Qe)*180/Math.PI}function wr(ue,me){return In(me[1],me[0],fr)+In(ue[1],ue[0],fr)}function Ar(ue,me){return or(me[0],me[1],fr)/or(ue[0],ue[1],fr)}var dr={mousedown:An,mousemove:Un,mouseup:At},us="mousedown",bt="mousemove mouseup";function mn(){this.evEl=us,this.evWin=bt,this.pressed=!1,ni.apply(this,arguments)}ie(mn,ni,{handler:function(me){var Ie=dr[me.type];Ie&An&&me.button===0&&(this.pressed=!0),Ie&Un&&me.which!==1&&(Ie=At),this.pressed&&(Ie&At&&(this.pressed=!1),this.callback(this.manager,Ie,{pointers:[me],changedPointers:[me],pointerType:Nn,srcEvent:me}))}});var dn={pointerdown:An,pointermove:Un,pointerup:At,pointercancel:Xt,pointerout:Xt},Ii={2:bn,3:pn,4:Nn,5:ti},hs="pointerdown",un="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(hs="MSPointerDown",un="MSPointerMove MSPointerUp MSPointerCancel");function pt(){this.evEl=hs,this.evWin=un,ni.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ie(pt,ni,{handler:function(me){var Ie=this.store,Qe=!1,gt=me.type.toLowerCase().replace("ms",""),Ut=dn[gt],En=Ii[me.pointerType]||me.pointerType,_i=En==bn,Tn=at(Ie,me.pointerId,"pointerId");Ut&An&&(me.button===0||_i)?Tn<0&&(Ie.push(me),Tn=Ie.length-1):Ut&(At|Xt)&&(Qe=!0),!(Tn<0)&&(Ie[Tn]=me,this.callback(this.manager,Ut,{pointers:Ie,changedPointers:[me],pointerType:En,srcEvent:me}),Qe&&Ie.splice(Tn,1))}});var zi={touchstart:An,touchmove:Un,touchend:At,touchcancel:Xt},$s="touchstart",bi="touchstart touchmove touchend touchcancel";function Wi(){this.evTarget=$s,this.evWin=bi,this.started=!1,ni.apply(this,arguments)}ie(Wi,ni,{handler:function(me){var Ie=zi[me.type];if(Ie===An&&(this.started=!0),!!this.started){var Qe=Hn.call(this,me,Ie);Ie&(At|Xt)&&Qe[0].length-Qe[1].length===0&&(this.started=!1),this.callback(this.manager,Ie,{pointers:Qe[0],changedPointers:Qe[1],pointerType:bn,srcEvent:me})}}});function Hn(ue,me){var Ie=Mt(ue.touches),Qe=Mt(ue.changedTouches);return me&(At|Xt)&&(Ie=ut(Ie.concat(Qe),"identifier",!0)),[Ie,Qe]}var qs={touchstart:An,touchmove:Un,touchend:At,touchcancel:Xt},Dr="touchstart touchmove touchend touchcancel";function Rr(){this.evTarget=Dr,this.targetIds={},ni.apply(this,arguments)}ie(Rr,ni,{handler:function(me){var Ie=qs[me.type],Qe=qr.call(this,me,Ie);Qe&&this.callback(this.manager,Ie,{pointers:Qe[0],changedPointers:Qe[1],pointerType:bn,srcEvent:me})}});function qr(ue,me){var Ie=Mt(ue.touches),Qe=this.targetIds;if(me&(An|Un)&&Ie.length===1)return Qe[Ie[0].identifier]=!0,[Ie,Ie];var gt,Ut,En=Mt(ue.changedTouches),_i=[],Tn=this.target;if(Ut=Ie.filter(function(ki){return et(ki.target,Tn)}),me===An)for(gt=0;gt<Ut.length;)Qe[Ut[gt].identifier]=!0,gt++;for(gt=0;gt<En.length;)Qe[En[gt].identifier]&&_i.push(En[gt]),me&(At|Xt)&&delete Qe[En[gt].identifier],gt++;if(_i.length)return[ut(Ut.concat(_i),"identifier",!0),_i]}var Is=2500,ar=25;function Y(){ni.apply(this,arguments);var ue=re(this.handler,this);this.touch=new Rr(this.manager,ue),this.mouse=new mn(this.manager,ue),this.primaryTouch=null,this.lastTouches=[]}ie(Y,ni,{handler:function(me,Ie,Qe){var gt=Qe.pointerType==bn,Ut=Qe.pointerType==Nn;if(!(Ut&&Qe.sourceCapabilities&&Qe.sourceCapabilities.firesTouchEvents)){if(gt)V.call(this,Ie,Qe);else if(Ut&&oe.call(this,Qe))return;this.callback(me,Ie,Qe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function V(ue,me){ue&An?(this.primaryTouch=me.changedPointers[0].identifier,X.call(this,me)):ue&(At|Xt)&&X.call(this,me)}function X(ue){var me=ue.changedPointers[0];if(me.identifier===this.primaryTouch){var Ie={x:me.clientX,y:me.clientY};this.lastTouches.push(Ie);var Qe=this.lastTouches,gt=function(){var Ut=Qe.indexOf(Ie);Ut>-1&&Qe.splice(Ut,1)};setTimeout(gt,Is)}}function oe(ue){for(var me=ue.srcEvent.clientX,Ie=ue.srcEvent.clientY,Qe=0;Qe<this.lastTouches.length;Qe++){var gt=this.lastTouches[Qe],Ut=Math.abs(me-gt.x),En=Math.abs(Ie-gt.y);if(Ut<=ar&&En<=ar)return!0}return!1}var f=St(u.style,"touchAction"),W=f!==r,ke="compute",Ce="auto",Ee="manipulation",Me="none",Ne="pan-x",rt="pan-y",Ve=Ct();function ft(ue,me){this.manager=ue,this.set(me)}ft.prototype={set:function(ue){ue==ke&&(ue=this.compute()),W&&this.manager.element.style&&Ve[ue]&&(this.manager.element.style[f]=ue),this.actions=ue.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ue=[];return U(this.manager.recognizers,function(me){ge(me.options.enable,[me])&&(ue=ue.concat(me.getTouchAction()))}),Lt(ue.join(" "))},preventDefaults:function(ue){var me=ue.srcEvent,Ie=ue.offsetDirection;if(this.manager.session.prevented){me.preventDefault();return}var Qe=this.actions,gt=ht(Qe,Me)&&!Ve[Me],Ut=ht(Qe,rt)&&!Ve[rt],En=ht(Qe,Ne)&&!Ve[Ne];if(gt){var _i=ue.pointers.length===1,Tn=ue.distance<2,ki=ue.deltaTime<250;if(_i&&Tn&&ki)return}if(!(En&&Ut)&&(gt||Ut&&Ie&ei||En&&Ie&ci))return this.preventSrc(me)},preventSrc:function(ue){this.manager.session.prevented=!0,ue.preventDefault()}};function Lt(ue){if(ht(ue,Me))return Me;var me=ht(ue,Ne),Ie=ht(ue,rt);return me&&Ie?Me:me||Ie?me?Ne:rt:ht(ue,Ee)?Ee:Ce}function Ct(){if(!W)return!1;var ue={},me=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ie){ue[Ie]=me?e.CSS.supports("touch-action",Ie):!0}),ue}var Yt=1,Gt=2,on=4,$t=8,Kt=$t,wn=16,Ln=32;function Wn(ue){this.options=ne({},this.defaults,ue||{}),this.id=Ot(),this.manager=null,this.options.enable=be(this.options.enable,!0),this.state=Yt,this.simultaneous={},this.requireFail=[]}Wn.prototype={defaults:{},set:function(ue){return ne(this.options,ue),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ue){if(D(ue,"recognizeWith",this))return this;var me=this.simultaneous;return ue=tn(ue,this),me[ue.id]||(me[ue.id]=ue,ue.recognizeWith(this)),this},dropRecognizeWith:function(ue){return D(ue,"dropRecognizeWith",this)?this:(ue=tn(ue,this),delete this.simultaneous[ue.id],this)},requireFailure:function(ue){if(D(ue,"requireFailure",this))return this;var me=this.requireFail;return ue=tn(ue,this),at(me,ue)===-1&&(me.push(ue),ue.requireFailure(this)),this},dropRequireFailure:function(ue){if(D(ue,"dropRequireFailure",this))return this;ue=tn(ue,this);var me=at(this.requireFail,ue);return me>-1&&this.requireFail.splice(me,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ue){return!!this.simultaneous[ue.id]},emit:function(ue){var me=this,Ie=this.state;function Qe(gt){me.manager.emit(gt,ue)}Ie<$t&&Qe(me.options.event+Vt(Ie)),Qe(me.options.event),ue.additionalEvent&&Qe(ue.additionalEvent),Ie>=$t&&Qe(me.options.event+Vt(Ie))},tryEmit:function(ue){if(this.canEmit())return this.emit(ue);this.state=Ln},canEmit:function(){for(var ue=0;ue<this.requireFail.length;){if(!(this.requireFail[ue].state&(Ln|Yt)))return!1;ue++}return!0},recognize:function(ue){var me=ne({},ue);if(!ge(this.options.enable,[this,me])){this.reset(),this.state=Ln;return}this.state&(Kt|wn|Ln)&&(this.state=Yt),this.state=this.process(me),this.state&(Gt|on|$t|wn)&&this.tryEmit(me)},process:function(ue){},getTouchAction:function(){},reset:function(){}};function Vt(ue){return ue&wn?"cancel":ue&$t?"end":ue&on?"move":ue&Gt?"start":""}function _e(ue){return ue==li?"down":ue==Bn?"up":ue==mt?"left":ue==jn?"right":""}function tn(ue,me){var Ie=me.manager;return Ie?Ie.get(ue):ue}function $i(){Wn.apply(this,arguments)}ie($i,Wn,{defaults:{pointers:1},attrTest:function(ue){var me=this.options.pointers;return me===0||ue.pointers.length===me},process:function(ue){var me=this.state,Ie=ue.eventType,Qe=me&(Gt|on),gt=this.attrTest(ue);return Qe&&(Ie&Xt||!gt)?me|wn:Qe||gt?Ie&At?me|$t:me&Gt?me|on:Gt:Ln}});function $n(){$i.apply(this,arguments),this.pX=null,this.pY=null}ie($n,$i,{defaults:{event:"pan",threshold:10,pointers:1,direction:hr},getTouchAction:function(){var ue=this.options.direction,me=[];return ue&ei&&me.push(rt),ue&ci&&me.push(Ne),me},directionTest:function(ue){var me=this.options,Ie=!0,Qe=ue.distance,gt=ue.direction,Ut=ue.deltaX,En=ue.deltaY;return gt&me.direction||(me.direction&ei?(gt=Ut===0?yn:Ut<0?mt:jn,Ie=Ut!=this.pX,Qe=Math.abs(ue.deltaX)):(gt=En===0?yn:En<0?Bn:li,Ie=En!=this.pY,Qe=Math.abs(ue.deltaY))),ue.direction=gt,Ie&&Qe>me.threshold&&gt&me.direction},attrTest:function(ue){return $i.prototype.attrTest.call(this,ue)&&(this.state&Gt||!(this.state&Gt)&&this.directionTest(ue))},emit:function(ue){this.pX=ue.deltaX,this.pY=ue.deltaY;var me=_e(ue.direction);me&&(ue.additionalEvent=this.options.event+me),this._super.emit.call(this,ue)}});function Ho(){$i.apply(this,arguments)}ie(Ho,$i,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Me]},attrTest:function(ue){return this._super.attrTest.call(this,ue)&&(Math.abs(ue.scale-1)>this.options.threshold||this.state&Gt)},emit:function(ue){if(ue.scale!==1){var me=ue.scale<1?"in":"out";ue.additionalEvent=this.options.event+me}this._super.emit.call(this,ue)}});function Wo(){Wn.apply(this,arguments),this._timer=null,this._input=null}ie(Wo,Wn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ce]},process:function(ue){var me=this.options,Ie=ue.pointers.length===me.pointers,Qe=ue.distance<me.threshold,gt=ue.deltaTime>me.time;if(this._input=ue,!Qe||!Ie||ue.eventType&(At|Xt)&&!gt)this.reset();else if(ue.eventType&An)this.reset(),this._timer=R(function(){this.state=Kt,this.tryEmit()},me.time,this);else if(ue.eventType&At)return Kt;return Ln},reset:function(){clearTimeout(this._timer)},emit:function(ue){this.state===Kt&&(ue&&ue.eventType&At?this.manager.emit(this.options.event+"up",ue):(this._input.timeStamp=I(),this.manager.emit(this.options.event,this._input)))}});function wa(){$i.apply(this,arguments)}ie(wa,$i,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Me]},attrTest:function(ue){return this._super.attrTest.call(this,ue)&&(Math.abs(ue.rotation)>this.options.threshold||this.state&Gt)}});function de(){$i.apply(this,arguments)}ie(de,$i,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ei|ci,pointers:1},getTouchAction:function(){return $n.prototype.getTouchAction.call(this)},attrTest:function(ue){var me=this.options.direction,Ie;return me&(ei|ci)?Ie=ue.overallVelocity:me&ei?Ie=ue.overallVelocityX:me&ci&&(Ie=ue.overallVelocityY),this._super.attrTest.call(this,ue)&&me&ue.offsetDirection&&ue.distance>this.options.threshold&&ue.maxPointers==this.options.pointers&&w(Ie)>this.options.velocity&&ue.eventType&At},emit:function(ue){var me=_e(ue.offsetDirection);me&&this.manager.emit(this.options.event+me,ue),this.manager.emit(this.options.event,ue)}});function xo(){Wn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ie(xo,Wn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ee]},process:function(ue){var me=this.options,Ie=ue.pointers.length===me.pointers,Qe=ue.distance<me.threshold,gt=ue.deltaTime<me.time;if(this.reset(),ue.eventType&An&&this.count===0)return this.failTimeout();if(Qe&&gt&&Ie){if(ue.eventType!=At)return this.failTimeout();var Ut=this.pTime?ue.timeStamp-this.pTime<me.interval:!0,En=!this.pCenter||or(this.pCenter,ue.center)<me.posThreshold;this.pTime=ue.timeStamp,this.pCenter=ue.center,!En||!Ut?this.count=1:this.count+=1,this._input=ue;var _i=this.count%me.taps;if(_i===0)return this.hasRequireFailures()?(this._timer=R(function(){this.state=Kt,this.tryEmit()},me.interval,this),Gt):Kt}return Ln},failTimeout:function(){return this._timer=R(function(){this.state=Ln},this.options.interval,this),Ln},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Kt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function fs(ue,me){return me=me||{},me.recognizers=be(me.recognizers,fs.defaults.preset),new Ta(ue,me)}fs.VERSION="2.0.7",fs.defaults={domEvents:!1,touchAction:ke,enable:!0,inputTarget:null,inputClass:null,preset:[[wa,{enable:!1}],[Ho,{enable:!1},["rotate"]],[de,{direction:ei}],[$n,{direction:ei},["swipe"]],[xo],[xo,{event:"doubletap",taps:2},["tap"]],[Wo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ba=1,Ea=2;function Ta(ue,me){this.options=ne({},fs.defaults,me||{}),this.options.inputTarget=this.options.inputTarget||ue,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ue,this.input=Wr(this),this.touchAction=new ft(this,this.options.touchAction),rl(this,!0),U(this.options.recognizers,function(Ie){var Qe=this.add(new Ie[0](Ie[1]));Ie[2]&&Qe.recognizeWith(Ie[2]),Ie[3]&&Qe.requireFailure(Ie[3])},this)}Ta.prototype={set:function(ue){return ne(this.options,ue),ue.touchAction&&this.touchAction.update(),ue.inputTarget&&(this.input.destroy(),this.input.target=ue.inputTarget,this.input.init()),this},stop:function(ue){this.session.stopped=ue?Ea:ba},recognize:function(ue){var me=this.session;if(!me.stopped){this.touchAction.preventDefaults(ue);var Ie,Qe=this.recognizers,gt=me.curRecognizer;(!gt||gt&&gt.state&Kt)&&(gt=me.curRecognizer=null);for(var Ut=0;Ut<Qe.length;)Ie=Qe[Ut],me.stopped!==Ea&&(!gt||Ie==gt||Ie.canRecognizeWith(gt))?Ie.recognize(ue):Ie.reset(),!gt&&Ie.state&(Gt|on|$t)&&(gt=me.curRecognizer=Ie),Ut++}},get:function(ue){if(ue instanceof Wn)return ue;for(var me=this.recognizers,Ie=0;Ie<me.length;Ie++)if(me[Ie].options.event==ue)return me[Ie];return null},add:function(ue){if(D(ue,"add",this))return this;var me=this.get(ue.options.event);return me&&this.remove(me),this.recognizers.push(ue),ue.manager=this,this.touchAction.update(),ue},remove:function(ue){if(D(ue,"remove",this))return this;if(ue=this.get(ue),ue){var me=this.recognizers,Ie=at(me,ue);Ie!==-1&&(me.splice(Ie,1),this.touchAction.update())}return this},on:function(ue,me){if(ue!==r&&me!==r){var Ie=this.handlers;return U(ot(ue),function(Qe){Ie[Qe]=Ie[Qe]||[],Ie[Qe].push(me)}),this}},off:function(ue,me){if(ue!==r){var Ie=this.handlers;return U(ot(ue),function(Qe){me?Ie[Qe]&&Ie[Qe].splice(at(Ie[Qe],me),1):delete Ie[Qe]}),this}},emit:function(ue,me){this.options.domEvents&&sl(ue,me);var Ie=this.handlers[ue]&&this.handlers[ue].slice();if(!(!Ie||!Ie.length)){me.type=ue,me.preventDefault=function(){me.srcEvent.preventDefault()};for(var Qe=0;Qe<Ie.length;)Ie[Qe](me),Qe++}},destroy:function(){this.element&&rl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function rl(ue,me){var Ie=ue.element;if(Ie.style){var Qe;U(ue.options.cssProps,function(gt,Ut){Qe=St(Ie.style,Ut),me?(ue.oldCssProps[Qe]=Ie.style[Qe],Ie.style[Qe]=gt):Ie.style[Qe]=ue.oldCssProps[Qe]||""}),me||(ue.oldCssProps={})}}function sl(ue,me){var Ie=n.createEvent("Event");Ie.initEvent(ue,!0,!0),Ie.gesture=me,me.target.dispatchEvent(Ie)}ne(fs,{INPUT_START:An,INPUT_MOVE:Un,INPUT_END:At,INPUT_CANCEL:Xt,STATE_POSSIBLE:Yt,STATE_BEGAN:Gt,STATE_CHANGED:on,STATE_ENDED:$t,STATE_RECOGNIZED:Kt,STATE_CANCELLED:wn,STATE_FAILED:Ln,DIRECTION_NONE:yn,DIRECTION_LEFT:mt,DIRECTION_RIGHT:jn,DIRECTION_UP:Bn,DIRECTION_DOWN:li,DIRECTION_HORIZONTAL:ei,DIRECTION_VERTICAL:ci,DIRECTION_ALL:hr,Manager:Ta,Input:ni,TouchAction:ft,TouchInput:Rr,MouseInput:mn,PointerEventInput:pt,TouchMouseInput:Y,SingleTouchInput:Wi,Recognizer:Wn,AttrRecognizer:$i,Tap:xo,Pan:$n,Swipe:de,Pinch:Ho,Rotate:wa,Press:Wo,on:De,off:qe,each:U,merge:J,extend:pe,assign:ne,inherit:ie,bindFn:re,prefixed:St});var ks=typeof e<"u"?e:typeof self<"u"?self:{};ks.Hammer=fs,typeof r=="function"&&r.amd?r(function(){return fs}):t.exports?t.exports=fs:e[i]=fs})(window,document,"Hammer")})(uT);var G2=uT.exports;const uq=f3(G2),Ga=hI({__proto__:null,default:uq},[G2]),hT=1,fT=2,S5=4,hq={mousedown:hT,mousemove:fT,mouseup:S5};function fq(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function Aq(t){const e=t.prototype.handler;t.prototype.handler=function(i){const r=this.store;i.button>0&&i.type==="pointerdown"&&(fq(r,s=>s.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}}function dq(t){t.prototype.handler=function(n){let i=hq[n.type];i&hT&&n.button>=0&&(this.pressed=!0),i&fT&&n.which===0&&(i=S5),this.pressed&&(i&S5&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}Aq(G2.PointerEventInput);dq(G2.MouseInput);const pq=G2.Manager;class A3{constructor(e,n,i){this.element=e,this.callback=n,this.options={enable:!0,...i}}}const mq=Ga?[[Ga.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Ga.Rotate,{enable:!1}],[Ga.Pinch,{enable:!1}],[Ga.Swipe,{enable:!1}],[Ga.Pan,{threshold:0,enable:!1}],[Ga.Press,{enable:!1}],[Ga.Tap,{event:"doubletap",taps:2,enable:!1}],[Ga.Tap,{event:"anytap",enable:!1}],[Ga.Tap,{enable:!1}]]:null,Gy={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},gq={doubletap:["tap"]},_q={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Ig={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},yq={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},jy={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},vq=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Mh=typeof window<"u"?window:global;let C5=!1;try{const t={get passive(){return C5=!0,!0}};Mh.addEventListener("test",null,t),Mh.removeEventListener("test",null)}catch{C5=!1}const xq=vq.indexOf("firefox")!==-1,{WHEEL_EVENTS:wq}=Ig,Hy="wheel",Wy=4.000244140625,bq=40,Eq=.25;class Tq extends A3{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{if(!this.options.enable)return;let s=r.deltaY;Mh.WheelEvent&&(xq&&r.deltaMode===Mh.WheelEvent.DOM_DELTA_PIXEL&&(s/=Mh.devicePixelRatio),r.deltaMode===Mh.WheelEvent.DOM_DELTA_LINE&&(s*=bq)),s!==0&&s%Wy===0&&(s=Math.floor(s/Wy)),r.shiftKey&&s&&(s=s*Eq),this.callback({type:Hy,center:{x:r.clientX,y:r.clientY},delta:-s,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(wq),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,C5?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Hy&&(this.options.enable=n)}}const{MOUSE_EVENTS:Sq}=Ig,$y="pointermove",qy="pointerover",Zy="pointerout",Xy="pointerenter",Qy="pointerleave";class Cq extends A3{constructor(e,n,i){super(e,n,i),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(Sq),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===$y&&(this.enableMoveEvent=n),e===qy&&(this.enableOverEvent=n),e===Zy&&(this.enableOutEvent=n),e===Xy&&(this.enableEnterEvent=n),e===Qy&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(qy,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Zy,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Xy,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(Qy,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit($y,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:Pq}=Ig,Yy="keydown",Ky="keyup";class Mq extends A3{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{const s=r.target||r.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&r.type==="keydown"&&this.callback({type:Yy,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&r.type==="keyup"&&this.callback({type:Ky,srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Pq),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Yy&&(this.enableDownEvent=n),e===Ky&&(this.enableUpEvent=n)}}const Jy="contextmenu";class Iq extends A3{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:Jy,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===Jy&&(this.options.enable=n)}}const P5=1,Tp=2,M5=4,kq={pointerdown:P5,pointermove:Tp,pointerup:M5,mousedown:P5,mousemove:Tp,mouseup:M5},Lq=1,Dq=2,Rq=3,zq=0,Bq=1,Oq=2,Fq=1,Nq=2,Uq=4;function Vq(t){const e=kq[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let s=!1,u=!1,a=!1;return e===M5||e===Tp&&!Number.isFinite(n)?(s=r===Lq,u=r===Dq,a=r===Rq):e===Tp?(s=!!(n&Fq),u=!!(n&Uq),a=!!(n&Nq)):e===P5&&(s=i===zq,u=i===Bq,a=i===Oq),{leftButton:s,middleButton:u,rightButton:a}}function Gq(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1,u={x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/s};return{center:n,offsetCenter:u}}const o4={srcElement:"root",priority:0};class jq{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let r=n.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,i,r=!1,s=!1){const{handlers:u,handlersByElement:a}=this;let y=o4;typeof i=="string"||i&&i.addEventListener?y={...o4,srcElement:i}:i&&(y={...o4,...i});let w=a.get(y.srcElement);w||(w=[],a.set(y.srcElement,w));const I={type:e,handler:n,srcElement:y.srcElement,priority:y.priority};r&&(I.once=!0),s&&(I.passive=!0),u.push(I),this._active=this._active||!I.passive;let R=w.length-1;for(;R>=0&&!(w[R].priority>=I.priority);)R--;w.splice(R+1,0,I)}remove(e,n){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const u=i[s];if(u.type===e&&u.handler===n){i.splice(s,1);const a=r.get(u.srcElement);a.splice(a.indexOf(u),1),a.length===0&&r.delete(u.srcElement)}}this._active=i.some(s=>!s.passive)}_emit(e,n){const i=this.handlersByElement.get(n);if(i){let r=!1;const s=()=>{e.handled=!0},u=()=>{e.handled=!0,r=!0},a=[];for(let y=0;y<i.length;y++){const{type:w,handler:I,once:R}=i[y];if(I({...e,type:w,stopPropagation:s,stopImmediatePropagation:u}),R&&a.push(i[y]),r)break}for(let y=0;y<a.length;y++){const{type:w,handler:I}=a[y];this.remove(w,I)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...Vq(e),...Gq(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Hq={events:null,recognizers:null,recognizerOptions:{},Manager:pq,touchAction:"none",tabIndex:0};class Wq{constructor(e=null,n){this._onBasicInput=r=>{const{srcEvent:s}=r,u=_q[s.type];u&&this.manager.emit(u,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...Hq,...n},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,i=n.Manager;this.manager=new i(e,{touchAction:n.touchAction,recognizers:n.recognizers||mq}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Gy).forEach(r=>{const s=this.manager.get(r);s&&Gy[r].forEach(u=>{s.recognizeWith(u)})});for(const r in n.recognizerOptions){const s=this.manager.get(r);if(s){const u=n.recognizerOptions[r];delete u.enable,s.set(u)}}this.wheelInput=new Tq(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Cq(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Mq(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new Iq(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,i){this._addEventHandler(e,n,i,!1)}once(e,n,i){this._addEventHandler(e,n,i,!0)}watch(e,n,i){this._addEventHandler(e,n,i,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==n){r.set({enable:n});const s=gq[e];s&&!this.options.recognizers&&s.forEach(u=>{const a=i.get(u);n?(a.requireFailure(e),r.dropRequireFailure(u)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,i,r,s){if(typeof e!="string"){i=n;for(const I in e)this._addEventHandler(I,e[I],i,r,s);return}const{manager:u,events:a}=this,y=jy[e]||e;let w=a.get(y);w||(w=new jq(this),a.set(y,w),w.recognizerName=yq[y]||y,u&&u.on(y,w.handleEvent)),w.add(e,n,i,r,s),w.isEmpty()||this._toggleRecognizer(w.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const u in e)this._removeEventHandler(u,e[u]);return}const{events:i}=this,r=jy[e]||e,s=i.get(r);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:u}=s;let a=!1;for(const y of i.values())if(y.recognizerName===u&&!y.isEmpty()){a=!0;break}a||this._toggleRecognizer(u,!1)}}}function jc(){}const $q=({isDragging:t})=>t?"grabbing":"grab",AT={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:jc,onResize:jc,onViewStateChange:jc,onInteractionStateChange:jc,onBeforeRender:jc,onAfterRender:jc,onLoad:jc,onError:t=>Xn.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:$q,getTooltip:null,debug:!1,drawPickingColors:!1};class d3{constructor(e){Z(this,"props",void 0),Z(this,"width",0),Z(this,"height",0),Z(this,"userData",{}),Z(this,"canvas",null),Z(this,"viewManager",null),Z(this,"layerManager",null),Z(this,"effectManager",null),Z(this,"deckRenderer",null),Z(this,"deckPicker",null),Z(this,"eventManager",null),Z(this,"tooltip",null),Z(this,"metrics",void 0),Z(this,"animationLoop",void 0),Z(this,"stats",void 0),Z(this,"viewState",void 0),Z(this,"cursorState",void 0),Z(this,"_needsRedraw",void 0),Z(this,"_pickRequest",void 0),Z(this,"_lastPointerDownInfo",null),Z(this,"_metricsCounter",void 0),Z(this,"_onPointerMove",n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const r=n.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n}),Z(this,"_onEvent",n=>{const i=T_[n.type],r=n.offsetCenter;if(!i||!r||!this.layerManager)return;const s=this.layerManager.getLayers(),u=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:s,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:a}=u,y=a&&(a[i.handler]||a.props[i.handler]),w=this.props[i.handler];let I=!1;y&&(I=y.call(a,u,n)),!I&&w&&w(u,n)}),Z(this,"_onPointerDown",n=>{const i=n.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...AT,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Xn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),EF()==="IE"&&Xn.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new rT({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&A1.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,i,r,s,u,a,y;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(i=this.viewManager)===null||i===void 0||i.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(u=this.deckPicker)===null||u===void 0||u.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(y=this.tooltip)===null||y===void 0||y.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var w;(w=this.canvas.parentElement)===null||w===void 0||w.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Xn.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Xn.removed("onLayerClick","onClick")(),e.initialViewState&&!Qa(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),u=this.deckRenderer.needsRedraw(e);return n=n||i||r||s||u,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Mr(this.viewManager),this.viewManager.views}getViewports(e){return Mr(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,i){Mr(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Mr(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:i}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(i||i===0){var r;const s=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=((r=e.style)===null||r===void 0?void 0:r.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:i}=this;if(!i)return;const r=(e=i.clientWidth)!==null&&e!==void 0?e:i.width,s=(n=i.clientHeight)!==null&&n!==void 0?n:i.height;if(r!==this.width||s!==this.height){var u,a;this.width=r,this.height=s,(u=this.viewManager)===null||u===void 0||u.setProps({width:r,height:s}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:s})}}_createAnimationLoop(e){const{width:n,height:i,gl:r,glOptions:s,debug:u,onError:a,onBeforeRender:y,onAfterRender:w,useDevicePixels:I}=e;return new QV({width:n,height:i,useDevicePixels:I,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:R=>qb({...s,...R,canvas:this.canvas,debug:u,onContextLost:()=>this._onContextLost()}),onInitialize:R=>this._setGLContext(R.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:y,onAfterRender:w,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new aT({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let s=r,u=!1;for(const a of i){var n;s=a,u=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||u}if(!u&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,fg(e,{enable:!0,copyState:!0})),this.tooltip=new lq(this.canvas),n0(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new UE;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new Wq(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in T_)this.eventManager.on(r,this._onEvent);this.viewManager=new B$({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new z$(e,{deck:this,stats:this.stats,viewport:i,timeline:n}),this.effectManager=new Y$,this.deckRenderer=new eq(e),this.deckPicker=new oq(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:i}=this.layerManager.context;n0(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Xn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const i=Qc.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}Z(d3,"defaultProps",AT);Z(d3,"VERSION",UF);class a4{constructor(e,n){Z(this,"opts",void 0),Z(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:i}=this.source,{size:r}=n;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const u=n.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[u+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function qq(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Md(t){return t.stride||t.size*t.bytesPerElement}function dT(t,e){e.offset&&Xn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Md(t),i=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,r=e.elementOffset||0,s=i*n+r*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function Zq(t,e){const n=dT(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class Xq{constructor(e,n,i){Z(this,"gl",void 0),Z(this,"id",void 0),Z(this,"size",void 0),Z(this,"settings",void 0),Z(this,"value",void 0),Z(this,"doublePrecision",void 0),Z(this,"_buffer",void 0),Z(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const r=n.logicalType||n.type,s=r===5130;let{defaultValue:u}=n;u=Number.isFinite(u)?[u]:u||new Array(this.size).fill(0);let a;s?a=5126:!r&&n.isIndexed?a=e&&rE(e,Pi.ELEMENT_INDEX_UINT32)?5125:5123:a=r||5126;let y=qq(r||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(y=Float32Array),this.value=null,this.settings={...n,defaultType:y,defaultValue:u,logicalType:r,type:a,size:this.size,bytesPerElement:y.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new vi(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Md(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),A1.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=Zq(this.getAccessor(),n||{});return i[e]=new a4(this,s.high),i["".concat(e,"64Low")]=r?new a4(this,s.low):new Float32Array(this.size),i}if(n){const i=dT(this.getAccessor(),n);return{[e]:new a4(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:i,size:r}=this,s=i*r;if(n&&s&&n.length>=s){const u=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let y=0;y<s;)for(let w=0;w<r;w++){const I=n[y++];I<u[w]&&(u[w]=I),I>a[w]&&(a[w]=I)}e=[u,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof vi?i={buffer:e}:i=e;const r={...this.settings,...i};if(n.bufferAccessor=r,n.bounds=null,i.constant){let s=i.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(i.buffer){const s=i.buffer;n.externalBuffer=s,n.constant=!1,this.value=i.value||null;const u=i.value instanceof Float64Array;r.type=i.type||s.accessor.type,r.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(u?2:1),r.stride=Md(r)}else if(i.value){this._checkExternalBuffer(i);let s=i.value;n.externalBuffer=null,n.constant=!1,this.value=s,r.bytesPerElement=s.BYTES_PER_ELEMENT,r.stride=Md(r);const{buffer:u,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=i4(s,r));const y=s.byteLength+a+r.stride*2;u.byteLength<y&&u.reallocate(y),u.setAccessor(null),u.subData({data:s,offset:a}),r.type=i.type||u.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?i4(n,{size:this.size,startIndex:i,endIndex:r}):n.subarray(i,r),offset:i*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:i}=this,r=i.allocatedValue,s=A1.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:u,byteOffset:a}=this;return u.byteLength<s.byteLength+a&&(u.reallocate(s.byteLength+a),n&&r&&u.subData({data:r instanceof Float64Array?i4(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=n.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Xn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return n[i]=e,n;if(!e){let u=s;for(;--u>=0;)n[i+u]=r[u];return n}switch(s){case 4:n[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:n[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:n[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:n[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let u=s;for(;--u>=0;)n[i+u]=Number.isFinite(e[u])?e[u]:r[u]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==n[r])return!1;return!0}}const ev=[],tv=[];function j2(t,e=0,n=1/0){let i=ev;const r={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?i=t:t.length>0&&(tv.length=t.length,i=tv):i=ev,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function pT(t){return t&&t[Symbol.asyncIterator]}function mT(t,e){const{size:n,stride:i,offset:r,startIndices:s,nested:u}=e,a=t.BYTES_PER_ELEMENT,y=i?i/a:n,w=r?r/a:0,I=Math.floor((t.length-w)/y);return(R,{index:D,target:U})=>{if(!s){const J=D*y+w;for(let ie=0;ie<n;ie++)U[ie]=t[J+ie];return U}const q=s[D],ne=s[D+1]||I;let pe;if(u){pe=new Array(ne-q);for(let J=q;J<ne;J++){const ie=J*y+w;U=new Array(n);for(let re=0;re<n;re++)U[re]=t[ie+re];pe[J-q]=U}}else if(y===n)pe=t.subarray(q*n+w,ne*n+w);else{pe=new t.constructor((ne-q)*n);let J=0;for(let ie=q;ie<ne;ie++){const re=ie*y+w;for(let ge=0;ge<n;ge++)pe[J++]=t[re+ge]}}return pe}}const Qq=[],Id=[[0,1/0]];function Yq(t,e){if(t===Id||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],i=t.length;let r=0;for(let s=0;s<i;s++){const u=t[s];u[1]<e[0]?(n.push(u),r=s+1):u[0]>e[1]?n.push(u):e=[Math.min(u[0],e[0]),Math.max(u[1],e[1])]}return n.splice(r,0,e),n}function l4(t){const{source:e,target:n,start:i=0,size:r,getData:s}=t,u=t.end||n.length,a=e.length,y=u-i;if(a>y){n.set(e.subarray(0,y),i);return}if(n.set(e,i),!s)return;let w=a;for(;w<y;){const I=s(w,e);for(let R=0;R<r;R++)n[i+w]=I[R]||0,w++}}function Kq({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return l4({source:t,target:e,size:n,getData:i}),e;let u=0,a=0;const y=i&&((I,R)=>i(I+a,R)),w=Math.min(r.length,s.length);for(let I=1;I<w;I++){const R=r[I]*n,D=s[I]*n;l4({source:t.subarray(u,R),target:e,start:a,end:D,size:n,getData:y}),u=R,a=D}return a<e.length&&l4({source:[],target:e,start:a,size:n,getData:y}),e}const Jq={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function gT(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Jq[n],...e,...t,type:n}}function _T(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function yT(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function vT(t){t.push(t.shift())}function kg(t,e){const{doublePrecision:n,settings:i,value:r,size:s}=t,u=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*u}function xT({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:s=u=>u}){const u=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*u,y=n.byteOffset,w=n.startIndices,I=r&&w,R=kg(n,e),D=n.isConstant;if(!I&&i>=R)return;const U=D?n.value:n.getBuffer().getData({srcByteOffset:y});if(n.settings.normalized&&!D){const J=s;s=(ie,re)=>n.normalizeConstant(J(ie,re))}const q=D?(J,ie)=>s(U,ie):(J,ie)=>s(U.subarray(J,J+a),ie),ne=t.getData({length:i}),pe=new Float32Array(R);Kq({source:ne,target:pe,sourceStartIndices:r,targetStartIndices:w,size:a,getData:q}),t.byteLength<pe.byteLength+y&&t.reallocate(pe.byteLength+y),t.subData({data:pe,offset:y})}class Lg extends Xq{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Id}),Z(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,i=this.settings.transition,r=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return gT(r,i)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:i=0,endRow:r=1/0}=n;this.state.updateRanges=Yq(this.state.updateRanges,[i,r])}else this.state.updateRanges=Id}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Qq}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,n.updateRanges!==Id),!0):!1}updateBuffer({numInstances:e,data:n,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:u,noAlloc:a}}=this;let y=!0;if(u){for(const[w,I]of s)u.call(r,this,{data:n,startRow:w,endRow:I,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[w,I]of s){const R=Number.isFinite(w)?this.getVertexOffset(w):0,D=Number.isFinite(I)?this.getVertexOffset(I):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:R,endOffset:D})}this._checkAttributeArray()}else y=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),y}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const u=e;Mr(ArrayBuffer.isView(u.value),"invalid ".concat(r.accessor));const a=!!u.size&&u.size!==this.size;return i.binaryAccessor=mT(u.value,{size:u.size||this.size,stride:u.stride,offset:u.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const i in e)Object.assign(n,super.getShaderAttributes(i,e[i]));return n}_autoUpdater(e,{data:n,startRow:i,endRow:r,props:s,numInstances:u}){if(e.constant)return;const{settings:a,state:y,value:w,size:I,startIndices:R}=e,{accessor:D,transform:U}=a,q=y.binaryAccessor||(typeof D=="function"?D:s[D]);Mr(typeof q=="function",'accessor "'.concat(D,'" is not a function'));let ne=e.getVertexOffset(i);const{iterable:pe,objectInfo:J}=j2(n,i,r);for(const ie of pe){J.index++;let re=q(ie,J);if(U&&(re=U.call(this,re)),R){const ge=(J.index<R.length-1?R[J.index+1]:u)-R[J.index];if(re&&Array.isArray(re[0])){let be=ne;for(const De of re)e._normalizeValue(De,w,be),be+=I}else re&&re.length>I?w.set(re,ne):(e._normalizeValue(re,J.target,0),S$({target:w,source:J.target,start:ne,count:ge}));ne+=ge*I}else e._normalizeValue(re,w,ne),ne+=I}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let i=!0;switch(n){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class eZ{constructor({gl:e,attribute:n,timeline:i}){Z(this,"gl",void 0),Z(this,"type","interpolation"),Z(this,"attributeInTransition",void 0),Z(this,"settings",void 0),Z(this,"attribute",void 0),Z(this,"transition",void 0),Z(this,"currentStartIndices",void 0),Z(this,"currentLength",void 0),Z(this,"transform",void 0),Z(this,"buffers",void 0),this.gl=e,this.transition=new V2(i),this.attribute=n,this.attributeInTransition=new Lg(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=nZ(e,n);const r={byteLength:0,usage:35050};this.buffers=[new vi(e,r),new vi(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:i,buffers:r,attribute:s}=this;vT(r);const u={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)xT({buffer:a,...u});this.currentStartIndices=s.startIndices,this.currentLength=kg(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:_T(i,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:i}=this.settings,{time:r}=this.transition;let s=r/n;i&&(s=i(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const tZ=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function nZ(t,e){const n=yT(e.size);return new Eg(t,{vs:tZ,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class iZ{constructor({gl:e,attribute:n,timeline:i}){Z(this,"gl",void 0),Z(this,"type","spring"),Z(this,"attributeInTransition",void 0),Z(this,"settings",void 0),Z(this,"attribute",void 0),Z(this,"transition",void 0),Z(this,"currentStartIndices",void 0),Z(this,"currentLength",void 0),Z(this,"texture",void 0),Z(this,"framebuffer",void 0),Z(this,"transform",void 0),Z(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new V2(i),this.attribute=n,this.attributeInTransition=new Lg(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=sZ(e),this.framebuffer=oZ(e,this.texture),this.transform=rZ(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new vi(e,r),new vi(e,r),new vi(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:i,buffers:r,attribute:s}=this,u={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)xT({buffer:a,...u});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=kg(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:_T(i,s)}})}update(){const{buffers:e,transform:n,framebuffer:i,transition:r}=this;if(!r.update())return!1;const u=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:u.stiffness,damping:u.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),vT(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),u3(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function rZ(t,e,n){const i=yT(e.size);return new Eg(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}function sZ(t){return new Ws(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function oZ(t,e){return new vr(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const aZ={interpolation:eZ,spring:iZ};class lZ{constructor(e,{id:n,timeline:i}){Z(this,"id",void 0),Z(this,"isSupported",void 0),Z(this,"gl",void 0),Z(this,"timeline",void 0),Z(this,"transitions",void 0),Z(this,"needsRedraw",void 0),Z(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Eg.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],u=s.getTransitionSetting(n);u&&this._updateAttribute(r,s,u)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(n))&&this._removeTransition(r)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const i=this.transitions[n];i.inProgress&&(e[n]=i.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported){Xn.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}r&&this._removeTransition(e);const u=aZ[i.type];u?this.transitions[e]=new u({attribute:n,timeline:this.timeline,gl:this.gl}):(Xn.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const nv="attributeManager.invalidate",cZ="attributeManager.updateStart",uZ="attributeManager.updateEnd",hZ="attribute.updateStart",fZ="attribute.allocate",AZ="attribute.updateEnd";class dZ{constructor(e,{id:n="attribute-manager",stats:i,timeline:r}={}){Z(this,"id",void 0),Z(this,"gl",void 0),Z(this,"attributes",void 0),Z(this,"updateTriggers",void 0),Z(this,"needsRedraw",void 0),Z(this,"userData",void 0),Z(this,"stats",void 0),Z(this,"attributeTransitionManager",void 0),Z(this,"mergeBoundsMemoized",U2(KW)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new lZ(e,{id:"".concat(n,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const i=this._invalidateTrigger(e,n);ss(nv,this,e,i)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);ss(nv,this,"all")}update({data:e,numInstances:n,startIndices:i=null,transitions:r,props:s={},buffers:u={},context:a={}}){let y=!1;ss(cZ,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const w in this.attributes){const I=this.attributes[w],R=I.settings.accessor;I.startIndices=i,I.numInstances=n,s[w]&&Xn.removed("props.".concat(w),"data.attributes.".concat(w))(),I.setExternalBuffer(u[w])||I.setBinaryValue(typeof R=="string"?u[R]:void 0,e.startIndices)||typeof R=="string"&&!u[R]&&I.setConstantValue(s[R])||I.needsUpdate()&&(y=!0,this._updateAttribute({attribute:I,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||I.needsRedraw()}y&&ss(uZ,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(i=>{var r;return(r=this.attributes[i])===null||r===void 0?void 0:r.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const s in n){const u=n[s];u.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=u)}return r}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const i={};for(const r in e)n[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,n={}){for(const i in e){const r=e[i];this.attributes[i]=this._createAttribute(i,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,i){const r={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:i.instanced?1:n.divisor||0};return new Lg(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(u=>{const a=i[u];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:i}=e;if(ss(hZ,n),n.constant){n.setConstantValue(n.value);return}n.allocate(i)&&ss(fZ,n,i),n.updateBuffer(e)&&(this.needsRedraw=!0,ss(AZ,n,i))}}class pZ extends V2{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:i,duration:r,easing:s}}=this,u=s(e/r);this._value=Ka(n,i,u)}}const iv=1e-5;function rv(t,e,n,i,r){const s=e-t,a=(n-e)*r,y=-s*i;return a+y+s+e}function mZ(t,e,n,i,r){if(Array.isArray(n)){const s=[];for(let u=0;u<n.length;u++)s[u]=rv(t[u],e[u],n[u],i,r);return s}return rv(t,e,n,i,r)}function sv(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class gZ extends V2{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:u=e}=this;let a=mZ(s,u,n,i,r);const y=sv(a,n),w=sv(a,u);y<iv&&w<iv&&(a=n,this.end()),this._prevValue=u,this._currValue=a}}const _Z={interpolation:pZ,spring:gZ};class yZ{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,i,r){const{transitions:s}=this;if(s.has(e)){const y=s.get(e),{value:w=y.settings.fromValue}=y;n=w,this.remove(e)}if(r=gT(r),!r)return;const u=_Z[r.type];if(!u){Xn.error("unsupported transition type '".concat(r.type,"'"))();return}const a=new u(this.timeline);a.start({...r,fromValue:n,toValue:i}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,i]of this.transitions)i.update(),e[n]=i.value,i.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function vZ(t){const e=t[X0];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function xZ(t,e){const n=wT({newProps:t,oldProps:e,propTypes:t[X0],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=bZ(t,e);let r=!1;return i||(r=EZ(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:TZ(t,e),transitionsChanged:wZ(t,e)}}function wZ(t,e){if(!t.transitions)return!1;const n={},i=t[X0];let r=!1;for(const s in t.transitions){const u=i[s],a=u&&u.type;(a==="number"||a==="color"||a==="array")&&I5(t[s],e[s],u)&&(n[s]=!0,r=!0)}return r?n:!1}function wT({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(r," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(r,".").concat(s," added");const u=I5(t[s],e[s],i[s]);if(u)return"".concat(r,".").concat(s," ").concat(u)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const u=I5(t[s],e[s],i[s]);if(u)return"".concat(r,".").concat(s," ").concat(u)}}return!1}function I5(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":!i&&e!==t?"changed shallowly":null}function bZ(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}function EZ(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&ov(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)r!=="all"&&ov(t,e,r)&&(n[r]=!0,i=!0);return i?n:!1}function TZ(t,e){if(e===null)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i||i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function ov(t,e,n){let i=t.updateTriggers[n];i=i??{};let r=e.updateTriggers[n];return r=r??{},wT({oldProps:r,newProps:i,triggerName:n})}const SZ="count(): argument not an object",CZ="count(): argument not a container";function PZ(t){if(!IZ(t))throw new Error(SZ);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(MZ(t))return Object.keys(t).length;throw new Error(CZ)}function MZ(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function IZ(t){return t!==null&&typeof t=="object"}function kZ(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=n.modules.findIndex(r=>r.name==="project32");i>=0&&n.modules.splice(i,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const i={...t.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];n.inject=i}return n}const LZ={10241:9987,10240:9729,10242:33071,10243:33071},k5={};function DZ(t,e,n,i){if(n instanceof Ws)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const s=new Ws(e,{...n,parameters:{...LZ,...r,...i}});return k5[s.id]=t,s}function RZ(t,e){!e||!(e instanceof Ws)||k5[e.id]===t&&(e.delete(),delete k5[e.id])}const zZ={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||L5(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Qa(t,e,1)}},accessor:{validate(t,e){const n=Sp(t);return n==="function"||n===Sp(e.value)},equal(t,e,n){return typeof e=="function"?!0:Qa(t,e,1)}},array:{validate(t,e){return e.optional&&!t||L5(t)},equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?Qa(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?Qa(t,e,r):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return!i||!i.gl?null:DZ(n.id,i.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{RZ(n.id,t)}}};function BZ(t){const e={},n={},i={};for(const[r,s]of Object.entries(t)){const u=s?.deprecatedFor;if(u)i[r]=Array.isArray(u)?u:[u];else{const a=OZ(r,s);e[r]=a,n[r]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}function OZ(t,e){switch(Sp(e)){case"object":return df(t,e);case"array":return df(t,{type:"array",value:e,compare:!1});case"boolean":return df(t,{type:"boolean",value:e});case"number":return df(t,{type:"number",value:e});case"function":return df(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function df(t,e){return"type"in e?{name:t,...zZ[e.type],...e}:"value"in e?{name:t,type:Sp(e.value),...e}:{name:t,type:"object",value:e}}function L5(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Sp(t){return L5(t)?"array":t===null?"null":typeof t}function FZ(t,e){let n;for(let s=e.length-1;s>=0;s--){const u=e[s];"extensions"in u&&(n=u.extensions)}const i=D5(t.constructor,n),r=Object.create(i);r[Ep]=t,r[fu]={},r[H0]={};for(let s=0;s<e.length;++s){const u=e[s];for(const a in u)r[a]=u[a]}return Object.freeze(r),r}const NZ="_mergedDefaultProps";function D5(t,e){let n=NZ;if(e)for(const r of e){const s=r.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const i=bT(t,n);return i||(t[n]=UZ(t,e||[]))}function UZ(t,e){if(!t.prototype)return null;const i=Object.getPrototypeOf(t),r=D5(i),s=bT(t,"defaultProps")||{},u=BZ(s),a=Object.assign(Object.create(null),r,u.defaultProps),y=Object.assign(Object.create(null),r?.[X0],u.propTypes),w=Object.assign(Object.create(null),r?.[s4],u.deprecatedProps);for(const I of e){const R=D5(I.constructor);R&&(Object.assign(a,R),Object.assign(y,R[X0]),Object.assign(w,R[s4]))}return VZ(a,t),jZ(a,y),GZ(a,w),a[X0]=y,a[s4]=w,e.length===0&&!Dg(t,"_propTypes")&&(t._propTypes=y),a}function VZ(t,e){const n=WZ(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function GZ(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(n);for(const s of e[n])Dg(this,s)||(this[s]=i);Xn.deprecated(r,e[n].join("/"))()}})}function jZ(t,e){const n={},i={};for(const r in e){const s=e[r],{name:u,value:a}=s;s.async&&(n[u]=a,i[u]=HZ(u))}t[Xh]=n,t[fu]={},Object.defineProperties(t,i)}function HZ(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||pT(e)?this[fu][t]=e:this[H0][t]=e},get(){if(this[H0]){if(t in this[H0])return this[H0][t]||this[Xh][t];if(t in this[fu]){const e=this[Ep]&&this[Ep].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Xh][t]}}return this[Xh][t]}}}function Dg(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function bT(t,e){return Dg(t,e)&&t[e]}function WZ(t){const e=t.componentName;return e||Xn.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let $Z=0;class Rg{constructor(...e){Z(this,"id",void 0),Z(this,"props",void 0),Z(this,"count",void 0),this.props=FZ(this,e),this.id=this.props.id,this.count=$Z++}clone(e){const{props:n}=this,i={};for(const r in n[Xh])r in n[H0]?i[r]=n[H0][r]:r in n[fu]&&(i[r]=n[fu][r]);return new this.constructor({...n,...i,...e})}}Z(Rg,"componentName","Component");Z(Rg,"defaultProps",{});const qZ=Object.freeze({});class ZZ{constructor(e){Z(this,"component",void 0),Z(this,"onAsyncPropUpdated",void 0),Z(this,"asyncProps",void 0),Z(this,"oldProps",void 0),Z(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||qZ}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Ep]||this.component;const n=e[H0]||{},i=e[fu]||e,r=e[Xh]||{};for(const s in n){const u=n[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,u),n[s]=this.getAsyncProp(s)}for(const s in i){const u=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,u)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(pT(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const i=this.asyncProps[e];return n===i.resolvedValue||n===i.lastValue?!1:(i.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(n=this._postProcessValue(i,n),i.resolvedValue=n,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,n,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),r.resolvedValue=n,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const r=i.pendingLoadCount;let s=[],u=0;for await(const a of n){if(!this.component)return;const{dataTransform:y}=this.component.props;y?s=y(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:u,endRow:s.length}]}),u=s.length,this._setAsyncPropValue(e,s,r)}this._onResolve(e,s)}_postProcessValue(e,n){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(n,i,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const r=this.component&&this.component.props[X0];this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class XZ extends ZZ{constructor({attributeManager:e,layer:n}){super(n),Z(this,"attributeManager",void 0),Z(this,"needsRedraw",void 0),Z(this,"needsUpdate",void 0),Z(this,"subLayers",void 0),Z(this,"usesPickingColorCache",void 0),Z(this,"hasPickingBuffer",void 0),Z(this,"changeFlags",void 0),Z(this,"viewport",void 0),Z(this,"uniformTransitions",void 0),Z(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const i=this.layer,r=i?.props.fetch;return r?r(n,{propName:e,layer:i}):super._fetch(e,n)}_onResolve(e,n){const i=this.layer;if(i){const r=i.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:i})}}_onError(e,n){const i=this.layer;i&&i.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const QZ="layer.changeFlag",YZ="layer.initialize",KZ="layer.update",JZ="layer.finalize",eX="layer.matched",av=2**24-1,tX=Object.freeze([]),nX=U2(({oldViewport:t,viewport:e})=>t.equals(e));let ja=new Uint8ClampedArray(0);const iX={data:{type:"data",value:tX,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:u}=n.context;if(r=r||n.getLoadOptions(),i=i||n.props.loaders,s){var a;r={...r,fetch:{...(a=r)===null||a===void 0?void 0:a.fetch,signal:s}}}let y=u.contains(t);return!y&&!r&&(u.add({resourceId:t,data:fp(t,i),persistent:!1}),y=!0),y?u.subscribe({resourceId:t,onChange:w=>{var I;return(I=n.internalState)===null||I===void 0?void 0:I.reloadAsyncProp(e,w)},consumerId:n.id,requestId:e}):fp(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Yn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class xa extends Rg{constructor(...e){super(...e),Z(this,"internalState",null),Z(this,"lifecycle",Eh.NO_STATE),Z(this,"context",void 0),Z(this,"state",void 0),Z(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Mr(this.internalState);const n=this.internalState.viewport||this.context.viewport,i=tT(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,u]=YE(i,n.pixelProjectionMatrix);return e.length===2?[r,s]:[r,s,u]}unproject(e){return Mr(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Mr(this.internalState);const i=this.internalState.viewport||this.context.viewport;return r$(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Yn.DEFAULT||e===Yn.LNGLAT||e===Yn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Mr(e instanceof Uint8Array);const[n,i,r]=e;return n+i*256+r*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:PZ(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=kZ(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&n)if(Array.isArray(i))for(const r of i)n.invalidateAll(r);else n.invalidateAll();if(n){const{props:r}=e,s=this.internalState.hasPickingBuffer,u=Number.isInteger(r.highlightedObjectIndex)||r.pickable||r.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==u){this.internalState.hasPickingBuffer=u;const{pickingColors:a,instancePickingColors:y}=n.attributes,w=a||y;w&&(u&&w.constant&&(w.constant=!1,n.invalidate(w.id)),!w.value&&!u&&(w.constant=!0,w.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:i}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,n){var i,r;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((i=(r=this.props).onError)!==null&&i!==void 0&&i.call(r,e))){var s,u;(s=this.context)===null||s===void 0||(u=s.onError)===null||u===void 0||u.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!nX({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:n.data,numInstances:i,startIndices:r,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),i=Object.create(this.props);for(const r in n)Object.defineProperty(i,r,{value:n[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const i=Math.floor(ja.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>av&&Xn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),ja=A1.allocate(ja,n,{size:3,copy:!0,maxCount:Math.max(n,av)});const r=Math.floor(ja.length/3),s=[];for(let u=i;u<r;u++)this.encodePickingColor(u,s),ja[u*3+0]=s[0],ja[u*3+1]=s[1],ja[u*3+2]=s[2]}e.value=ja.subarray(0,n*3)}_setModelAttributes(e,n){const i=this.getAttributeManager(),r=e.userData.excludeAttributes||{},s=i.getShaderAttributes(n,r);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,u=s&&n.attributes&&n.attributes[s.id];if(u&&u.value){const a=u.value,y=this.encodePickingColor(e);for(let w=0;w<n.length;w++){const I=s.getVertexOffset(w);a[I]===y[0]&&a[I+1]===y[1]&&a[I+2]===y[2]&&this._disablePickingIndex(w)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i;if(!r)return;const s=r.getVertexOffset(e),u=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(u-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==ja.buffer&&(i.value=ja.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Mr(!this.internalState),Mr(Number.isFinite(this.props.coordinateSystem)),ss(YZ,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new XZ({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Xn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new yZ(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ss(eX,this,this===e);const{state:n,internalState:i}=e;this!==e&&(this.internalState=i,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ss(KZ,this,e),!e)return;const n=this.props,i=this.context,r=this.internalState,s=i.viewport,u=this._updateUniformTransition();r.propsInTransition=u,i.viewport=r.viewport||s,this.props=u;try{const a=this._getUpdateParams(),y=this.getModels();if(i.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const I of this.props.extensions)I.updateState.call(this,a,I);const w=this.getModels()[0]!==y[0];this._postUpdate(a,w)}finally{i.viewport=s,this.props=n,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){ss(JZ,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,s=this.context;this.props=this.internalState.propsInTransition||r;const u=this.props.opacity;n.opacity=Math.pow(u,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,y=a&&a(n)||[0,0];n0(s.gl,{polygonOffset:y}),da(s.gl,i,()=>{const w={moduleParameters:e,uniforms:n,parameters:i,context:s};for(const I of this.props.extensions)I.draw.call(this,w,I);this.draw(w)})}finally{this.props=r}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const r in e)if(e[r]){let s=!1;switch(r){case"dataChanged":const u=e[r],a=n[r];u&&Array.isArray(a)&&(n.dataChanged=Array.isArray(u)?a.concat(u):u,s=!0);default:n[r]||(n[r]=e[r],s=!0)}s&&ss(QZ,this,r,e)}const i=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=i,n.somethingChanged=i||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const i=xZ(e,n);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(s,n[s],e[s],(r=e.transitions)===null||r===void 0?void 0:r[s])}return this.setChangeFlags(i)}validateProps(){vZ(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(n.pickingHighlightColor=i(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new dZ(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:u,highlightedObjectIndex:a,highlightColor:y}=i;if(n||r.autoHighlight!==u||r.highlightedObjectIndex!==a||r.highlightColor!==y){const w={};u||(w.pickingSelectedColor=null),Array.isArray(y)&&(w.pickingHighlightColor=y),(n||a!==r.highlightedObjectIndex)&&(w.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(w)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),r=i?i.getNeedsRedraw(e):!1;if(n=n||r,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Z(xa,"defaultProps",iX);Z(xa,"layerName","Layer");const rX="compositeLayer.renderLayers";class il extends xa{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||n}getSubLayerRow(e,n,i){return e.__source={parent:this,object:n,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(n.index=i.__source.index,e(i.__source.object,n)):e(i,r)}return e}getSubLayerProps(e={}){var n;const{opacity:i,pickable:r,visible:s,parameters:u,getPolygonOffset:a,highlightedObjectIndex:y,autoHighlight:w,highlightColor:I,coordinateSystem:R,coordinateOrigin:D,wrapLongitude:U,positionFormat:q,modelMatrix:ne,extensions:pe,fetch:J,operation:ie,_subLayerProps:re}=this.props,ge={id:"",updateTriggers:{},opacity:i,pickable:r,visible:s,parameters:u,getPolygonOffset:a,highlightedObjectIndex:y,autoHighlight:w,highlightColor:I,coordinateSystem:R,coordinateOrigin:D,wrapLongitude:U,positionFormat:q,modelMatrix:ne,extensions:pe,fetch:J,operation:ie},be=re&&e.id&&re[e.id],De=be&&be.updateTriggers,qe=e.id||"sublayer";if(be){const et=this.props[X0],ht=e.type?e.type._propTypes:{};for(const ot in be){const at=ht[ot]||et[ot];at&&at.type==="accessor"&&(be[ot]=this.getSubLayerAccessor(be[ot]))}}Object.assign(ge,e,be),ge.id="".concat(this.props.id,"-").concat(qe),ge.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...De};for(const et of pe){const ht=et.getSubLayerProps.call(this,et);ht&&Object.assign(ge,ht,{updateTriggers:Object.assign(ge.updateTriggers,ht.updateTriggers)})}return ge}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();if(r){const s=this.renderLayers();i=h3(s,Boolean),this.internalState.subLayers=i}ss(rX,this,r,i);for(const s of i)s.parent=this}}Z(il,"layerName","CompositeLayer");const UA=Math.PI/180,lv=180/Math.PI,kd=6370972,Ih=256;function sX(){const t=Ih/kd,e=Math.PI/180*Ih;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class oX extends Eu{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,nearZMultiplier:s=.1,farZMultiplier:u=2,resolution:a=10}=e;let{height:y,altitude:w=1.5}=e;y=y||1,w=Math.max(.75,w);const I=new Vs().lookAt({eye:[0,-w,0],up:[0,0,1]}),R=Math.pow(2,r);I.rotateX(n*UA),I.rotateZ(-i*UA),I.scale(R/y);const D=Math.atan(.5/w),U=Ih*2*R/y;super({...e,height:y,viewMatrix:I,longitude:i,latitude:n,zoom:r,distanceScales:sX(),fovyRadians:D*2,focalDistance:w,near:s,far:Math.min(2,1/U+1)*w*u}),Z(this,"longitude",void 0),Z(this,"latitude",void 0),Z(this,"resolution",void 0),this.latitude=n,this.longitude=i,this.resolution=a}get projectionMode(){return ha.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,this.height/2],n),r=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),u=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],s[0],r[0],u[0]),Math.min(i[1],s[1],r[1],u[1]),Math.max(i[0],s[0],r[0],u[0]),Math.max(i[1],s[1],r[1],u[1])]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,u]=e,a=n?s:this.height-s,{pixelUnprojectionMatrix:y}=this;let w;if(Number.isFinite(u))w=c4(y,[r,a,u,1]);else{const U=c4(y,[r,a,-1,1]),q=c4(y,[r,a,1,1]),ne=((i||0)/kd+1)*Ih,pe=Qm(CE([],U,q)),J=Qm(U),ie=Qm(q),ge=4*((4*J*ie-(pe-J-ie)**2)/16)/pe,be=Math.sqrt(J-ge),De=Math.sqrt(Math.max(0,ne*ne-ge)),qe=(be-De)/Math.sqrt(pe);w=uj([],U,q,qe)}const[I,R,D]=this.unprojectPosition(w);return Number.isFinite(u)?[I,R,D]:Number.isFinite(i)?[I,R,i]:[I,R]}projectPosition(e){const[n,i,r=0]=e,s=n*UA,u=i*UA,a=Math.cos(u),y=(r/kd+1)*Ih;return[Math.sin(s)*a*y,-Math.cos(s)*a*y,Math.sin(u)*y]}unprojectPosition(e){const[n,i,r]=e,s=PE(e),u=Math.asin(r/s),y=Math.atan2(n,-i)*lv,w=u*lv,I=(s/Ih-1)*kd;return[y,w,I]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const i=this.unproject(n);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}}function c4(t,e){const n=P1([],e,t);return bg(n,n,1/n[3]),n}const u4={bearing:0,pitch:0,position:[0,0,0]},aX={speed:1.2,curve:1.414};class M1 extends sT{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),Z(this,"opts",void 0),this.opts={...aX,...e}}interpolateProps(e,n,i){const r=RW(e,n,i,this.opts);for(const s in u4)r[s]=Ka(e[s]||u4[s],n[s]||u4[s],i);return r}getDuration(e,n){let{transitionDuration:i}=n;return i==="auto"&&(i=zW(e,n,this.opts)),i}}class ET{constructor(e){Z(this,"opts",void 0),Z(this,"typedArrayManager",void 0),Z(this,"indexStarts",[0]),Z(this,"vertexStarts",[0]),Z(this,"vertexCount",0),Z(this,"instanceCount",0),Z(this,"attributes",void 0),Z(this,"_attributeDefs",void 0),Z(this,"data",void 0),Z(this,"getGeometry",void 0),Z(this,"geometryBuffer",void 0),Z(this,"buffers",void 0),Z(this,"positionSize",void 0),Z(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=A1,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:i={},getGeometry:r,geometryBuffer:s,positionFormat:u,dataChanged:a,normalize:y=!0}=this.opts;if(this.data=n,this.getGeometry=r,this.positionSize=s&&s.size||(u==="XY"?2:3),this.buffers=i,this.normalize=y,s&&(Mr(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),y||(i.positions=s)),this.geometryBuffer=i.positions,Array.isArray(a))for(const w of a)this._rebuildGeometry(w);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?mT(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:i,buffers:r,_attributeDefs:s,typedArrayManager:u}=this;for(const a in s)if(a in r)u.release(i[a]),i[a]=null;else{const y=s[a];y.copy=n,i[a]=u.allocate(i[a],e,y)}}_forEachGeometry(e,n,i){const{data:r,getGeometry:s}=this,{iterable:u,objectInfo:a}=j2(r,n,i);for(const y of u){a.index++;const w=s?s(y,a):null;e(w,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:i,instanceCount:r}=this;const{data:s,geometryBuffer:u}=this,{startRow:a=0,endRow:y=1/0}=e||{},w={};if(e||(n=[0],i=[0]),this.normalize||!u)this._forEachGeometry((R,D)=>{const U=R&&this.normalizeGeometry(R);w[D]=U,i[D+1]=i[D]+(U?this.getGeometrySize(U):0)},a,y),r=i[i.length-1];else if(i=s.startIndices,r=i[s.length]||0,ArrayBuffer.isView(u))r=r||u.length/this.positionSize;else if(u instanceof vi){const R=u.accessor.stride||this.positionSize*4;r=r||u.byteLength/R}else if(u.buffer){const R=u.stride||this.positionSize*4;r=r||u.buffer.byteLength/R}else if(u.value){const R=u.value,D=u.stride/R.BYTES_PER_ELEMENT||this.positionSize;r=r||R.length/D}this._allocate(r,!!e),this.indexStarts=n,this.vertexStarts=i,this.instanceCount=r;const I={};this._forEachGeometry((R,D)=>{const U=w[D]||R;I.vertexStart=i[D],I.indexStart=n[D];const q=D<i.length-1?i[D+1]:r;I.geometrySize=q-i[D],I.geometryIndex=D,this.updateGeometryAttributes(U,I)},a,y),this.vertexCount=n[n.length-1]}}const lX=new Uint16Array([0,2,1,0,3,2]),cX=new Float32Array([0,1,0,0,1,0,1,1]);function uX(t,e){if(!e)return hX(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),i=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),r=Math.ceil(n/e)+1,s=Math.ceil(i/e)+1,u=(r-1)*(s-1)*6,a=new Uint32Array(u),y=new Float32Array(r*s*2),w=new Float64Array(r*s*3);let I=0,R=0;for(let D=0;D<r;D++){const U=D/(r-1);for(let q=0;q<s;q++){const ne=q/(s-1),pe=fX(t,U,ne);w[I*3+0]=pe[0],w[I*3+1]=pe[1],w[I*3+2]=pe[2]||0,y[I*2+0]=U,y[I*2+1]=1-ne,D>0&&q>0&&(a[R++]=I-s,a[R++]=I-s-1,a[R++]=I-1,a[R++]=I-s,a[R++]=I-1,a[R++]=I),I++}}return{vertexCount:u,positions:w,indices:a,texCoords:y}}function hX(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:lX,texCoords:cX}}function fX(t,e,n){return Ka(Ka(t[0],t[1],n),Ka(t[3],t[2],n),e)}const AX=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,dX=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,pX=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(dX,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),mX={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Yn.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class zg extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return super.getShaders({vs:AX,fs:pX,modules:[Tu,Su]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:i=>i.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:i=>i.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:i=>i.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:i}){const r=this.getAttributeManager();if(i.extensionsChanged){var s;const{gl:u}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(u),r.invalidateAll()}if(e.bounds!==n.bounds){const u=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const y in a)u&&u[y]!==a[y]&&r.invalidate(y);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,i=e.info;if(!i.color||!n)return i.bitmap=null,i;const{width:r,height:s}=n;i.index=0;const u=gX(i.color),a=[Math.floor(u[0]*r),Math.floor(u[1]*s)];return i.bitmap={size:{width:r,height:s},uv:u,pixel:a},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return cv(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),uX(n,this.context.viewport.resolution)}_getModel(e){return e?new i0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:i}=e,{model:r,coordinateConversion:s,bounds:u,disablePicking:a}=this.state,{image:y,desaturate:w,transparentColor:I,tintColor:R}=this.props;i.pickingActive&&a||y&&r&&r.setUniforms(n).setUniforms({bitmapTexture:y,desaturate:w,transparentColor:I.map(D=>D/255),tintColor:R.slice(0,3).map(D=>D/255),coordinateConversion:s,bounds:u}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:i}=Yn;let{_imageCoordinateSystem:r}=this.props;if(r!==i){const{bounds:s}=this.props;if(!cv(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const u=this.context.viewport.resolution?e:n;if(r=r===e?e:n,r===e&&u===n)return{coordinateConversion:-1,bounds:s};if(r===n&&u===e){const a=tl([s[0],s[1]]),y=tl([s[2],s[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],y[0],y[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}Z(zg,"layerName","BitmapLayer");Z(zg,"defaultProps",mX);function gX(t){const[e,n,i]=t,r=(i&240)/256,s=(i&15)/16;return[(e+s)/256,(n+r)/256]}function cv(t){return Number.isFinite(t[0])}const _X=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,yX=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,vX=1024,xX=4,uv=()=>{},hv={10241:9987,10240:9729,10242:33071,10243:33071};function wX(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function bX(t,e,n,i){const r=Math.min(n/e.width,i/e.height),s=Math.floor(e.width*r),u=Math.floor(e.height*r);return r===1?{data:e,width:s,height:u}:(t.canvas.height=u,t.canvas.width=s,t.clearRect(0,0,s,u),t.drawImage(e,0,0,e.width,e.height,0,0,s,u),{data:t.canvas,width:s,height:u})}function a2(t){return t&&(t.id||t.url)}function EX(t,e,n,i){const r=t.width,s=t.height,u=new Ws(t.gl,{width:e,height:n,parameters:i});return xU(t,u,{targetY:0,width:r,height:s}),t.delete(),u}function fv(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i],u=a2(r);t[u]={...r,x:s,y:n}}}function TX({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:u}){let a=[];for(let y=0;y<t.length;y++){const w=t[y],I=a2(w);if(!n[I]){const{height:R,width:D}=w;i+D+e>u&&(fv(n,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:w,xOffset:i}),i=i+D+e,s=Math.max(s,R)}}return a.length>0&&fv(n,a,r),{mapping:n,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:u,canvasHeight:wX(s+r+e)}}function SX(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:s}=j2(t);for(const u of r){s.index++;const a=e(u,s),y=a2(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[y]&&(!n[y]||a.url!==n[y].url)&&(i[y]={...a,source:u,sourceIndex:s.index})}return i}class CX{constructor(e,{onUpdate:n=uv,onError:i=uv}){Z(this,"gl",void 0),Z(this,"onUpdate",void 0),Z(this,"onError",void 0),Z(this,"_loadOptions",null),Z(this,"_texture",null),Z(this,"_externalTexture",null),Z(this,"_mapping",{}),Z(this,"_textureParameters",null),Z(this,"_pendingCount",0),Z(this,"_autoPacking",!1),Z(this,"_xOffset",0),Z(this,"_yOffset",0),Z(this,"_rowHeight",0),Z(this,"_buffer",xX),Z(this,"_canvasWidth",vX),Z(this,"_canvasHeight",0),Z(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=i}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?a2(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),r&&(this._mapping=r),i){var u;(u=this._texture)===null||u===void 0||u.delete(),this._texture=null,this._externalTexture=i}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(SX(e,n,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:s,yOffset:u,rowHeight:a,canvasHeight:y}=TX({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=r,this._xOffset=s,this._yOffset=u,this._canvasHeight=y,this._texture||(this._texture=new Ws(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||hv})),this._texture.height!==this._canvasHeight&&(this._texture=EX(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||hv)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const i of e)this._pendingCount++,fp(i.url,this._loadOptions).then(r=>{const s=a2(i),u=this._mapping[s],{x:a,y,width:w,height:I}=u,{data:R,width:D,height:U}=bX(n,r,w,I);this._texture.setSubImageData({data:R,x:a+(w-D)/2,y:y+(I-U)/2,width:D,height:U}),u.width=D,u.height=U,this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const TT=[0,0,0,255],PX={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:TT},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class p3 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return super.getShaders({vs:_X,fs:yX,modules:[Tu,Su]})}initializeState(){this.state={iconManager:new CX(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:TT},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager(),{iconAtlas:u,iconMapping:a,data:y,getIcon:w,textureParameters:I}=n,{iconManager:R}=this.state,D=u||this.internalState.isAsyncPropLoading("iconAtlas");if(R.setProps({loadOptions:n.loadOptions,autoPacking:!D,iconAtlas:u,iconMapping:D?a:null,textureParameters:I}),D?i.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&R.packIcons(y,w),r.extensionsChanged){var U;const{gl:q}=this.context;(U=this.state.model)===null||U===void 0||U.delete(),this.state.model=this._getModel(q),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:s,billboard:u,alphaCutoff:a}=this.props,{iconManager:y}=this.state,w=y.getTexture();w&&this.state.model.setUniforms(e).setUniforms({iconsTexture:w,iconsTextureDim:[w.width,w.height],sizeUnits:au[s],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:u,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new i0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const i=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;i?i(e):Xn.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:i,anchorX:r=n/2,anchorY:s=i/2}=this.state.iconManager.getIconMapping(e);return[n/2-r,i/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:i,width:r,height:s}=this.state.iconManager.getIconMapping(e);return[n,i,r,s]}}Z(p3,"defaultProps",PX);Z(p3,"layerName","IconLayer");const MX=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,IX=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Av=[0,0,0,255],kX={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Av},getLineColor:{type:"accessor",value:Av},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Bg extends xa{getShaders(){return super.getShaders({vs:MX,fs:IX,modules:[Tu,Su]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:i}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,stroked:u,filled:a,billboard:y,antialiasing:w,lineWidthUnits:I,lineWidthScale:R,lineWidthMinPixels:D,lineWidthMaxPixels:U}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:u?1:0,filled:a,billboard:y,antialiasing:w,radiusUnits:au[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,lineWidthUnits:au[I],lineWidthScale:R,lineWidthMinPixels:D,lineWidthMaxPixels:U}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new i0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}Z(Bg,"defaultProps",kX);Z(Bg,"layerName","ScatterplotLayer");const ST={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function CT(t,e,n={}){return LX(t,n)!==e?(RX(t,n),!0):!1}function LX(t,e={}){return Math.sign(DX(t,e))}function DX(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let s=0;for(let u=n,a=i-r;u<i;u+=r)s+=(t[u]-t[a])*(t[u+1]+t[a+1]),a=u;return s/2}function RX(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,s=(i-n)/r,u=Math.floor(s/2);for(let a=0;a<u;++a){const y=n+a*r,w=n+(s-1-a)*r;for(let I=0;I<r;++I){const R=t[y+I];t[y+I]=t[w+I],t[w+I]=R}}}function Aa(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let s=0;s<n;s++)if(t[i-n+s]!==e[s]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function R5(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function l2(t,e,n,i,r=[]){const s=i+e*n;for(let u=0;u<n;u++)r[u]=t[s+u];return r}function z5(t,e,n,i,r=[]){let s,u;if(n&8)s=(i[3]-t[1])/(e[1]-t[1]),u=3;else if(n&4)s=(i[1]-t[1])/(e[1]-t[1]),u=1;else if(n&2)s=(i[2]-t[0])/(e[0]-t[0]),u=2;else if(n&1)s=(i[0]-t[0])/(e[0]-t[0]),u=0;else return null;for(let a=0;a<t.length;a++)r[a]=(u&1)===a?i[u]:s*(e[a]-t[a])+t[a];return r}function Ld(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function PT(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:s=[0,0],startIndex:u=0,endIndex:a=t.length}=e||{},y=(a-u)/n;let w=[];const I=[w],R=l2(t,0,n,u);let D,U;const q=IT(R,r,s,[]),ne=[];Aa(w,R);for(let pe=1;pe<y;pe++){for(D=l2(t,pe,n,u,D),U=Ld(D,q);U;){z5(R,D,U,q,ne);const J=Ld(ne,q);J&&(z5(R,ne,J,q,ne),U=J),Aa(w,ne),R5(R,ne),BX(q,r,U),i&&w.length>n&&(w=[],I.push(w),Aa(w,R)),U=Ld(D,q)}Aa(w,D),R5(R,D)}return i?I:I[0]}const dv=0,zX=1;function VA(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function MT(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:s=[0,0],edgeTypes:u=!1}=n||{},a=[],y=[{pos:t,types:u?new Array(t.length/i).fill(zX):null,holes:e||[]}],w=[[],[]];let I=[];for(;y.length;){const{pos:R,types:D,holes:U}=y.shift();OX(R,i,U[0]||R.length,w),I=IT(w[0],r,s,I);const q=Ld(w[1],I);if(q){let ne=pv(R,D,i,0,U[0]||R.length,I,q);const pe={pos:ne[0].pos,types:ne[0].types,holes:[]},J={pos:ne[1].pos,types:ne[1].types,holes:[]};y.push(pe,J);for(let ie=0;ie<U.length;ie++)ne=pv(R,D,i,U[ie],U[ie+1]||R.length,I,q),ne[0]&&(pe.holes.push(pe.pos.length),pe.pos=VA(pe.pos,ne[0].pos),u&&(pe.types=VA(pe.types,ne[0].types))),ne[1]&&(J.holes.push(J.pos.length),J.pos=VA(J.pos,ne[1].pos),u&&(J.types=VA(J.types,ne[1].types)))}else{const ne={positions:R};u&&(ne.edgeTypes=D),U.length&&(ne.holeIndices=U),a.push(ne)}}return a}function pv(t,e,n,i,r,s,u){const a=(r-i)/n,y=[],w=[],I=[],R=[],D=[];let U,q,ne;const pe=l2(t,a-1,n,i);let J=Math.sign(u&8?pe[1]-s[3]:pe[0]-s[2]),ie=e&&e[a-1],re=0,ge=0;for(let be=0;be<a;be++)U=l2(t,be,n,i,U),q=Math.sign(u&8?U[1]-s[3]:U[0]-s[2]),ne=e&&e[i/n+be],q&&J&&J!==q&&(z5(pe,U,u,s,D),Aa(y,D)&&I.push(ie),Aa(w,D)&&R.push(ie)),q<=0?(Aa(y,U)&&I.push(ne),re-=q):I.length&&(I[I.length-1]=dv),q>=0?(Aa(w,U)&&R.push(ne),ge+=q):R.length&&(R[R.length-1]=dv),R5(pe,U),J=q,ie=ne;return[re?{pos:y,types:e&&I}:null,ge?{pos:w,types:e&&R}:null]}function IT(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=s,i[2]=r+e,i[3]=s+e,i}function BX(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function OX(t,e,n,i){let r=1/0,s=-1/0,u=1/0,a=-1/0;for(let y=0;y<n;y+=e){const w=t[y],I=t[y+1];r=w<r?w:r,s=w>s?w:s,u=I<u?I:u,a=I>a?I:a}return i[0][0]=r,i[0][1]=u,i[1][0]=s,i[1][1]=a,i}const FX=85.051129;function NX(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:s=!0}=e||{},u=t.slice(i,r);kT(u,n,0,r-i);const a=PT(u,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const y of a)LT(y,n);return a}function UX(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:s=!1}=n||{};e=e||[];const u=[],a=[];let y=0,w=0;for(let R=0;R<=e.length;R++){const D=e[R]||t.length,U=w,q=VX(t,i,y,D);for(let ne=q;ne<D;ne++)u[w++]=t[ne];for(let ne=y;ne<q;ne++)u[w++]=t[ne];kT(u,i,U,w),GX(u,i,U,w,n?.maxLatitude),y=D,a[R]=w}a.pop();const I=MT(u,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(r)for(const R of I)LT(R.positions,i);return I}function VX(t,e,n,i){let r=-1,s=-1;for(let u=n+1;u<i;u+=e){const a=Math.abs(t[u]);a>r&&(r=a,s=u-1)}return s}function GX(t,e,n,i,r=FX){const s=t[n],u=t[i-e];if(Math.abs(s-u)>180){const a=l2(t,0,e,n);a[0]+=Math.round((u-s)/360)*360,Aa(t,a),a[1]=Math.sign(a[1])*r,Aa(t,a),a[0]=s,Aa(t,a)}}function kT(t,e,n,i){let r=t[0],s;for(let u=n;u<i;u+=e){s=t[u];const a=s-r;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[u]=r=s}}function LT(t,e){let n;const i=t.length/e;for(let s=0;s<i&&(n=t[s*e],(n+180)%360===0);s++);const r=-Math.round(n/360)*360;if(r!==0)for(let s=0;s<i;s++)t[s*e]+=r}function jX(t,e,n,i){let r;if(Array.isArray(t[0])){const s=t.length*e;r=new Array(s);for(let u=0;u<t.length;u++)for(let a=0;a<e;a++)r[u*e+a]=t[u][a]||0}else r=t;return n?PT(r,{size:e,gridResolution:n}):i?NX(r,{size:e}):r}const HX=1,WX=2,h4=4;class $X extends ET{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?jX(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(mv(e)){let i=0;for(const r of e)i+=this.getGeometrySize(r);return i}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&mv(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const i=this.attributes.segmentTypes,r=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:u}=n;i.fill(0,s,s+u),r?(i[s]=h4,i[s+u-2]=h4):(i[s]+=HX,i[s+u-2]+=WX),i[s+u-1]=h4}_updatePositions(e,n){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:r,geometrySize:s}=n,u=new Array(3);for(let a=r,y=0;y<s;a++,y++)this.getPointOnPath(e,y,u),i[a*3]=u[0],i[a*3+1]=u[1],i[a*3+2]=u[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,i=[]){const{positionSize:r}=this;n*r>=e.length&&(n+=1-e.length/r);const s=n*r;return i[0]=e[s],i[1]=e[s+1],i[2]=r===3&&e[s+2]||0,i}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,i=e.length-n;return e[0]===e[i]&&e[1]===e[i+1]&&(n===2||e[2]===e[i+2])}}function mv(t){return Array.isArray(t[0])}const qX=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,ZX=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,DT=[0,0,0,255],XX={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:DT},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},f4={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Og extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return super.getShaders({vs:qX,fs:ZX,modules:[Tu,Su]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:f4,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:f4,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:f4,defaultValue:DT},instancePickingColors:{size:3,type:5121,accessor:(i,{index:r,target:s})=>this.encodePickingColor(i&&i.__source?i.__source.index:r,s)}}),this.setState({pathTesselator:new $X({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:i}=e,r=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,y=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:y.getPath,buffers:y,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),i.dataChanged||r.invalidateAll()}if(i.extensionsChanged){var u;const{gl:a}=this.context;(u=this.state.model)===null||u===void 0||u.delete(),this.state.model=this._getModel(a),r.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(s=>s.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:i,billboard:r,miterLimit:s,widthUnits:u,widthScale:a,widthMinPixels:y,widthMaxPixels:w}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:au[u],widthScale:a,miterLimit:s,widthMinPixels:y,widthMaxPixels:w}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],i=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new i0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(i),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}Z(Og,"defaultProps",XX);Z(Og,"layerName","PathLayer");var Fg={exports:{}};Fg.exports=m3;Fg.exports.default=m3;function m3(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,s=RT(t,0,r,n,!0),u=[];if(!s||s.next===s.prev)return u;var a,y,w,I,R,D,U;if(i&&(s=eQ(t,e,s,n)),t.length>80*n){a=w=t[0],y=I=t[1];for(var q=n;q<r;q+=n)R=t[q],D=t[q+1],R<a&&(a=R),D<y&&(y=D),R>w&&(w=R),D>I&&(I=D);U=Math.max(w-a,I-y),U=U!==0?32767/U:0}return c2(s,u,n,a,y,U,0),u}function RT(t,e,n,i,r){var s,u;if(r===F5(t,e,n,i)>0)for(s=e;s<n;s+=i)u=gv(s,t[s],t[s+1],u);else for(s=n-i;s>=e;s-=i)u=gv(s,t[s],t[s+1],u);return u&&g3(u,u.next)&&(h2(u),u=u.next),u}function Au(t,e){if(!t)return t;e||(e=t);var n=t,i;do if(i=!1,!n.steiner&&(g3(n,n.next)||Gi(n.prev,n,n.next)===0)){if(h2(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function c2(t,e,n,i,r,s,u){if(t){!u&&s&&sQ(t,i,r,s);for(var a=t,y,w;t.prev!==t.next;){if(y=t.prev,w=t.next,s?YX(t,i,r,s):QX(t)){e.push(y.i/n|0),e.push(t.i/n|0),e.push(w.i/n|0),h2(t),t=w.next,a=w.next;continue}if(t=w,t===a){u?u===1?(t=KX(Au(t),e,n),c2(t,e,n,i,r,s,2)):u===2&&JX(t,e,n,i,r,s):c2(Au(t),e,n,i,r,s,1);break}}}}function QX(t){var e=t.prev,n=t,i=t.next;if(Gi(e,n,i)>=0)return!1;for(var r=e.x,s=n.x,u=i.x,a=e.y,y=n.y,w=i.y,I=r<s?r<u?r:u:s<u?s:u,R=a<y?a<w?a:w:y<w?y:w,D=r>s?r>u?r:u:s>u?s:u,U=a>y?a>w?a:w:y>w?y:w,q=i.next;q!==e;){if(q.x>=I&&q.x<=D&&q.y>=R&&q.y<=U&&kh(r,a,s,y,u,w,q.x,q.y)&&Gi(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function YX(t,e,n,i){var r=t.prev,s=t,u=t.next;if(Gi(r,s,u)>=0)return!1;for(var a=r.x,y=s.x,w=u.x,I=r.y,R=s.y,D=u.y,U=a<y?a<w?a:w:y<w?y:w,q=I<R?I<D?I:D:R<D?R:D,ne=a>y?a>w?a:w:y>w?y:w,pe=I>R?I>D?I:D:R>D?R:D,J=B5(U,q,e,n,i),ie=B5(ne,pe,e,n,i),re=t.prevZ,ge=t.nextZ;re&&re.z>=J&&ge&&ge.z<=ie;){if(re.x>=U&&re.x<=ne&&re.y>=q&&re.y<=pe&&re!==r&&re!==u&&kh(a,I,y,R,w,D,re.x,re.y)&&Gi(re.prev,re,re.next)>=0||(re=re.prevZ,ge.x>=U&&ge.x<=ne&&ge.y>=q&&ge.y<=pe&&ge!==r&&ge!==u&&kh(a,I,y,R,w,D,ge.x,ge.y)&&Gi(ge.prev,ge,ge.next)>=0))return!1;ge=ge.nextZ}for(;re&&re.z>=J;){if(re.x>=U&&re.x<=ne&&re.y>=q&&re.y<=pe&&re!==r&&re!==u&&kh(a,I,y,R,w,D,re.x,re.y)&&Gi(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;ge&&ge.z<=ie;){if(ge.x>=U&&ge.x<=ne&&ge.y>=q&&ge.y<=pe&&ge!==r&&ge!==u&&kh(a,I,y,R,w,D,ge.x,ge.y)&&Gi(ge.prev,ge,ge.next)>=0)return!1;ge=ge.nextZ}return!0}function KX(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!g3(r,s)&&zT(r,i,i.next,s)&&u2(r,s)&&u2(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),h2(i),h2(i.next),i=t=s),i=i.next}while(i!==t);return Au(i)}function JX(t,e,n,i,r,s){var u=t;do{for(var a=u.next.next;a!==u.prev;){if(u.i!==a.i&&lQ(u,a)){var y=BT(u,a);u=Au(u,u.next),y=Au(y,y.next),c2(u,e,n,i,r,s,0),c2(y,e,n,i,r,s,0);return}a=a.next}u=u.next}while(u!==t)}function eQ(t,e,n,i){var r=[],s,u,a,y,w;for(s=0,u=e.length;s<u;s++)a=e[s]*i,y=s<u-1?e[s+1]*i:t.length,w=RT(t,a,y,i,!1),w===w.next&&(w.steiner=!0),r.push(aQ(w));for(r.sort(tQ),s=0;s<r.length;s++)n=nQ(r[s],n);return n}function tQ(t,e){return t.x-e.x}function nQ(t,e){var n=iQ(t,e);if(!n)return e;var i=BT(n,t);return Au(i,i.next),Au(n,n.next)}function iQ(t,e){var n=e,i=t.x,r=t.y,s=-1/0,u;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s&&(s=a,u=n.x<n.next.x?n:n.next,a===i))return u}n=n.next}while(n!==e);if(!u)return null;var y=u,w=u.x,I=u.y,R=1/0,D;n=u;do i>=n.x&&n.x>=w&&i!==n.x&&kh(r<I?i:s,r,w,I,r<I?s:i,r,n.x,n.y)&&(D=Math.abs(r-n.y)/(i-n.x),u2(n,t)&&(D<R||D===R&&(n.x>u.x||n.x===u.x&&rQ(u,n)))&&(u=n,R=D)),n=n.next;while(n!==y);return u}function rQ(t,e){return Gi(t.prev,t,e.prev)<0&&Gi(e.next,t,t.next)<0}function sQ(t,e,n,i){var r=t;do r.z===0&&(r.z=B5(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,oQ(r)}function oQ(t){var e,n,i,r,s,u,a,y,w=1;do{for(n=t,t=null,s=null,u=0;n;){for(u++,i=n,a=0,e=0;e<w&&(a++,i=i.nextZ,!!i);e++);for(y=w;a>0||y>0&&i;)a!==0&&(y===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,y--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,w*=2}while(u>1);return t}function B5(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function aQ(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function kh(t,e,n,i,r,s,u,a){return(r-u)*(e-a)>=(t-u)*(s-a)&&(t-u)*(i-a)>=(n-u)*(e-a)&&(n-u)*(s-a)>=(r-u)*(i-a)}function lQ(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!cQ(t,e)&&(u2(t,e)&&u2(e,t)&&uQ(t,e)&&(Gi(t.prev,t,e.prev)||Gi(t,e.prev,e))||g3(t,e)&&Gi(t.prev,t,t.next)>0&&Gi(e.prev,e,e.next)>0)}function Gi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function g3(t,e){return t.x===e.x&&t.y===e.y}function zT(t,e,n,i){var r=jA(Gi(t,e,n)),s=jA(Gi(t,e,i)),u=jA(Gi(n,i,t)),a=jA(Gi(n,i,e));return!!(r!==s&&u!==a||r===0&&GA(t,n,e)||s===0&&GA(t,i,e)||u===0&&GA(n,t,i)||a===0&&GA(n,e,i))}function GA(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function jA(t){return t>0?1:t<0?-1:0}function cQ(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&zT(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function u2(t,e){return Gi(t.prev,t,t.next)<0?Gi(t,e,t.next)>=0&&Gi(t,t.prev,e)>=0:Gi(t,e,t.prev)<0||Gi(t,t.next,e)<0}function uQ(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function BT(t,e){var n=new O5(t.i,t.x,t.y),i=new O5(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function gv(t,e,n,i){var r=new O5(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function h2(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O5(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}m3.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,u=Math.abs(F5(t,0,s,n));if(r)for(var a=0,y=e.length;a<y;a++){var w=e[a]*n,I=a<y-1?e[a+1]*n:t.length;u-=Math.abs(F5(t,w,I,n))}var R=0;for(a=0;a<i.length;a+=3){var D=i[a]*n,U=i[a+1]*n,q=i[a+2]*n;R+=Math.abs((t[D]-t[q])*(t[U+1]-t[D+1])-(t[D]-t[U])*(t[q+1]-t[D+1]))}return u===0&&R===0?0:Math.abs((R-u)/u)};function F5(t,e,n,i){for(var r=0,s=e,u=n-i;s<n;s+=i)r+=(t[u]-t[s])*(t[s+1]+t[u+1]),u=s;return r}m3.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var u=0;u<e;u++)n.vertices.push(t[r][s][u]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var hQ=Fg.exports;const fQ=f3(hQ),HA=ST.CLOCKWISE,_v=ST.COUNTER_CLOCKWISE,W0={isClosed:!0};function AQ(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function kf(t){return"positions"in t?t.positions:t}function Dd(t){return"holeIndices"in t?t.holeIndices:null}function dQ(t){return Array.isArray(t[0])}function pQ(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function mQ(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function gQ(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}function yv(t,e,n,i,r){let s=e;const u=n.length;for(let a=0;a<u;a++)for(let y=0;y<i;y++)t[s++]=n[a][y]||0;if(!mQ(n))for(let a=0;a<i;a++)t[s++]=n[0][a]||0;return W0.start=e,W0.end=s,W0.size=i,CT(t,r,W0),s}function vv(t,e,n,i,r=0,s,u){s=s||n.length;const a=s-r;if(a<=0)return e;let y=e;for(let w=0;w<a;w++)t[y++]=n[r+w];if(!gQ(n,i,r,s))for(let w=0;w<i;w++)t[y++]=n[r+w];return W0.start=e,W0.end=y,W0.size=i,CT(t,u,W0),y}function _Q(t,e){AQ(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:s}=t;if(s){let u=0;for(let a=0;a<=s.length;a++)u=vv(n,u,r,e,s[a-1],s[a],a===0?HA:_v),i.push(u);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!dQ(t))return vv(n,0,t,e,0,n.length,HA),n;if(!pQ(t)){let r=0;for(const[s,u]of t.entries())r=yv(n,r,u,e,s===0?HA:_v),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return yv(n,0,t,e,HA),n}function A4(t,e,n){const i=t.length/3;let r=0;for(let s=0;s<i;s++){const u=(s+1)%i;r+=t[s*3+e]*t[u*3+n],r-=t[u*3+e]*t[s*3+n]}return Math.abs(r/2)}function xv(t,e,n,i){const r=t.length/3;for(let s=0;s<r;s++){const u=s*3,a=t[u+0],y=t[u+1],w=t[u+2];t[u+e]=a,t[u+n]=y,t[u+i]=w}}function yQ(t,e,n,i){let r=Dd(t);r&&(r=r.map(a=>a/e));let s=kf(t);const u=i&&e===3;if(n){const a=s.length;s=s.slice();const y=[];for(let w=0;w<a;w+=e){y[0]=s[w],y[1]=s[w+1],u&&(y[2]=s[w+2]);const I=n(y);s[w]=I[0],s[w+1]=I[1],u&&(s[w+2]=I[2])}}if(u){const a=A4(s,0,1),y=A4(s,0,2),w=A4(s,1,2);if(!a&&!y&&!w)return[];a>y&&a>w||(y>w?(n||(s=s.slice()),xv(s,0,2,1)):(n||(s=s.slice()),xv(s,2,0,1)))}return fQ(s,r,e)}class vQ extends ET{constructor(e){const{fp64:n,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=_Q(e,this.positionSize);return this.opts.resolution?MT(kf(n),Dd(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?UX(kf(n),Dd(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(wv(e)){let n=0;for(const i of e)n+=this.getGeometrySize(i);return n}return kf(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&wv(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:i,indexStart:r}){const{attributes:s,indexStarts:u,typedArrayManager:a}=this;let y=s.indices;if(!y||!e)return;let w=r;const I=yQ(e,this.positionSize,this.opts.preproject,this.opts.full3d);y=a.allocate(y,r+I.length,{copy:!0});for(let R=0;R<I.length;R++)y[w++]=I[R]+i;u[n+1]=r+I.length,s.indices=y}_updatePositions(e,{vertexStart:n,geometrySize:i}){const{attributes:{positions:r},positionSize:s}=this;if(!r||!e)return;const u=kf(e);for(let a=n,y=0;y<i;a++,y++){const w=u[y*s],I=u[y*s+1],R=s>2?u[y*s+2]:0;r[a*3]=w,r[a*3+1]=I,r[a*3+2]=R}}_updateVertexValid(e,{vertexStart:n,geometrySize:i}){const{positionSize:r}=this,s=this.attributes.vertexValid,u=e&&Dd(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+i),u)for(let a=0;a<u.length;a++)s[n+u[a]/r-1]=0;s[n+i-1]=0}}function wv(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const OT=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,xQ=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(OT,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),wQ=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(OT,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),bQ=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Cp=[0,0,0,255],EQ={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Cp},getLineColor:{type:"accessor",value:Cp},material:!0},WA={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class H2 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?xQ:wQ,fs:bQ,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Tu,bH,Su]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:i}=this.props;const{_full3d:r}=this.props;n.isGeospatial&&i===Yn.DEFAULT&&(i=Yn.LNGLAT);let s;i===Yn.LNGLAT&&(r?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new vQ({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||pg(e,Pi.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const u=this.getAttributeManager(),a=!0;u.remove(["instancePickingColors"]),u.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:WA,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,transition:WA,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:WA,accessor:"getFillColor",defaultValue:Cp,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:WA,accessor:"getLineColor",defaultValue:Cp,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(y,{index:w,target:I})=>this.encodePickingColor(y&&y.__source?y.__source.index:w,I),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(s=>s.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:i,wireframe:r,elevationScale:s}=this.props,{topModel:u,sideModel:a,polygonTesselator:y}=this.state,w={...e,extruded:!!n,elevationScale:s};a&&(a.setInstanceCount(y.instanceCount-1),a.setUniforms(w),r&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),i&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),u&&(u.setVertexCount(y.vertexCount),u.setUniforms(w).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager();if(r.extensionsChanged||n.filled!==i.filled||n.extruded!==i.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(y=>y.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,u=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:u.getPolygon,buffers:u,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:i,extruded:r}=this.props;let s,u;if(i){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new i0(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(u=new i0(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Ql({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),u.userData.excludeAttributes={indices:!0}),{models:[u,s].filter(Boolean),topModel:s,sideModel:u}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}Z(H2,"defaultProps",EQ);Z(H2,"layerName","SolidPolygonLayer");function TQ({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:s=1/0}=n,u=t.length;let a=u,y=u;for(let D=0;D<u;D++){const U=e(t[D]);if(a>D&&U>=r&&(a=D),U>=s){y=D;break}}let w=a;const R=y-a!==i.length?t.slice(y):void 0;for(let D=0;D<i.length;D++)t[w++]=i[D];if(R){for(let D=0;D<R.length;D++)t[w++]=R[D];t.length=w}return{startRow:a,endRow:a+i.length}}function SQ(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return n!==-1?CQ(t,i,n):null}function CQ(t,e,n){const i={properties:{...t.properties[e]}};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}function PQ(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(r.length*3);const s=[];for(let u=0;u<r.length;u++)e(r[u],s),n[i][u*3+0]=s[0],n[i][u*3+1]=s[1],n[i][u*3+2]=s[2]}return n}const MQ=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,d4=192/256,bv=[],IQ={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class Ng extends p3{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:MQ}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;let{outlineColor:r}=n;r!==i.outlineColor&&(r=r.map(s=>s/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!n.sdf&&n.outlineWidth&&Xn.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:i,outlineWidth:r}=this.props,{outlineColor:s}=this.state,u=r?Math.max(i,d4*(1-r)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:d4,outlineBuffer:u,gamma:i,sdf:!!n,outlineColor:s},super.draw(e),n&&r){const{iconManager:a}=this.state;a.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:d4}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):bv}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):bv}}Z(Ng,"defaultProps",IQ);Z(Ng,"layerName","MultiIconLayer");const Vf=1e20;class kQ{constructor({fontSize:e=24,buffer:n=3,radius:i=8,cutoff:r=.25,fontFamily:s="sans-serif",fontWeight:u="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=r,this.radius=i;const y=this.size=e+n*4,w=this._createCanvas(y),I=this.ctx=w.getContext("2d",{willReadFrequently:!0});I.font=`${a} ${u} ${e}px ${s}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:s,actualBoundingBoxRight:u}=this.ctx.measureText(e),a=Math.ceil(i),y=0,w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(u-s))),I=Math.min(this.size-this.buffer,a+Math.ceil(r)),R=w+2*this.buffer,D=I+2*this.buffer,U=Math.max(R*D,0),q=new Uint8ClampedArray(U),ne={data:q,width:R,height:D,glyphWidth:w,glyphHeight:I,glyphTop:a,glyphLeft:y,glyphAdvance:n};if(w===0||I===0)return ne;const{ctx:pe,buffer:J,gridInner:ie,gridOuter:re}=this;pe.clearRect(J,J,w,I),pe.fillText(e,J,J+a);const ge=pe.getImageData(J,J,w,I);re.fill(Vf,0,U),ie.fill(0,0,U);for(let be=0;be<I;be++)for(let De=0;De<w;De++){const qe=ge.data[4*(be*w+De)+3]/255;if(qe===0)continue;const et=(be+J)*R+De+J;if(qe===1)re[et]=0,ie[et]=Vf;else{const ht=.5-qe;re[et]=ht>0?ht*ht:0,ie[et]=ht<0?ht*ht:0}}Ev(re,0,0,R,D,R,this.f,this.v,this.z),Ev(ie,J,J,w,I,R,this.f,this.v,this.z);for(let be=0;be<U;be++){const De=Math.sqrt(re[be])-Math.sqrt(ie[be]);q[be]=Math.round(255-255*(De/this.radius+this.cutoff))}return ne}}function Ev(t,e,n,i,r,s,u,a,y){for(let w=e;w<e+i;w++)Tv(t,n*s+w,s,r,u,a,y);for(let w=n;w<n+r;w++)Tv(t,w*s+e,1,i,u,a,y)}function Tv(t,e,n,i,r,s,u){s[0]=0,u[0]=-Vf,u[1]=Vf,r[0]=t[e];for(let a=1,y=0,w=0;a<i;a++){r[a]=t[e+a*n];const I=a*a;do{const R=s[y];w=(r[a]-r[R]+I-R*R)/(a-R)/2}while(w<=u[y]&&--y>-1);y++,s[y]=a,u[y]=w,u[y+1]=Vf}for(let a=0,y=0;a<i;a++){for(;u[y+1]<a;)y++;const w=s[y],I=a-w;t[e+a*n]=r[w]+I*I}}const LQ=32,DQ=[];function RQ(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function zQ({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:u=0,yOffset:a=0}){let y=0,w=u;const I=n+i*2;for(const R of t)if(!s[R]){const D=e(R);w+D+i*2>r&&(w=0,y++),s[R]={x:w+i,y:a+y*I+i,width:D,height:I,layoutWidth:D,layoutHeight:n},w+=D+i*2}return{mapping:s,xOffset:w,yOffset:a+y*I,canvasHeight:RQ(a+(y+1)*I)}}function FT(t,e,n,i){let r=0;for(let u=e;u<n;u++){var s;const a=t[u];r+=((s=i[a])===null||s===void 0?void 0:s.layoutWidth)||0}return r}function NT(t,e,n,i,r,s){let u=e,a=0;for(let y=e;y<n;y++){const w=FT(t,y,y+1,r);a+w>i&&(u<y&&s.push(y),u=y,a=0),a+=w}return a}function BQ(t,e,n,i,r,s){let u=e,a=e,y=e,w=0;for(let I=e;I<n;I++)if((t[I]===" "||t[I+1]===" "||I+1===n)&&(y=I+1),y>a){let R=FT(t,a,y,r);w+R>i&&(u<a&&(s.push(a),u=a,w=0),R>i&&(R=NT(t,a,y,i,r,s),u=s[s.length-1])),a=y,w+=R}return w}function OQ(t,e,n,i,r=0,s){s===void 0&&(s=t.length);const u=[];return e==="break-all"?NT(t,r,s,n,i,u):BQ(t,r,s,n,i,u),u}function FQ(t,e,n,i,r,s){let u=0,a=0;for(let y=e;y<n;y++){const w=t[y],I=i[w];I?(a||(a=I.layoutHeight),r[y]=u+I.layoutWidth/2,u+=I.layoutWidth):(Xn.warn("Missing character: ".concat(w," (").concat(w.codePointAt(0),")"))(),r[y]=u,u+=LQ)}s[0]=u,s[1]=a}function NQ(t,e,n,i,r){const s=Array.from(t),u=s.length,a=new Array(u),y=new Array(u),w=new Array(u),I=(n==="break-word"||n==="break-all")&&isFinite(i)&&i>0,R=[0,0],D=[0,0];let U=0,q=0,ne=0;for(let J=0;J<=u;J++){const ie=s[J];if((ie===`
`||J===u)&&(ne=J),ne>q){const re=I?OQ(s,n,i,r,q,ne):DQ;for(let ge=0;ge<=re.length;ge++){const be=ge===0?q:re[ge-1],De=ge<re.length?re[ge]:ne;FQ(s,be,De,r,a,D);for(let qe=be;qe<De;qe++){var pe;const et=s[qe],ht=((pe=r[et])===null||pe===void 0?void 0:pe.layoutOffsetY)||0;y[qe]=U+D[1]/2+ht,w[qe]=D[0]}U=U+D[1]*e,R[0]=Math.max(R[0],D[0])}q=ne}ie===`
`&&(a[q]=0,y[q]=0,w[q]=0,q++)}return R[1]=U,{x:a,y,rowWidth:w,size:R}}function UQ({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:s}){const u=t.BYTES_PER_ELEMENT,a=n?n/u:1,y=i?i/u:0,w=r[e]||Math.ceil((t.length-y)/a),I=s&&new Set,R=new Array(e);let D=t;if(a>1||y>0){const U=t.constructor;D=new U(w);for(let q=0;q<w;q++)D[q]=t[q*a+y]}for(let U=0;U<e;U++){const q=r[U],ne=r[U+1]||w,pe=D.subarray(q,ne);R[U]=String.fromCodePoint.apply(null,pe),I&&pe.forEach(I.add,I)}if(I)for(const U of I)s.add(String.fromCodePoint(U));return{texts:R,characterCount:w}}class UT{constructor(e=5){Z(this,"limit",void 0),Z(this,"_cache",{}),Z(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function VQ(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const Qh={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:VQ(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},Sv=1024,Cv=.9,Pv=1.2,VT=3;let Pp=new UT(VT);function GQ(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const i=Pp.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}function jQ(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Mv(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function HQ(t){Xn.assert(Number.isFinite(t)&&t>=VT,"Invalid cache limit"),Pp=new UT(t)}class WQ{constructor(){Z(this,"props",{...Qh}),Z(this,"_key",void 0),Z(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*Pv+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=GQ(this._key,this.props.characterSet),i=Pp.get(this._key);if(i&&n.size===0){this._atlas!==i&&(this._atlas=i);return}const r=this._generateFontAtlas(n,i);this._atlas=r,Pp.set(this._key,r)}_generateFontAtlas(e,n){const{fontFamily:i,fontWeight:r,fontSize:s,buffer:u,sdf:a,radius:y,cutoff:w}=this.props;let I=n&&n.data;I||(I=document.createElement("canvas"),I.width=Sv);const R=I.getContext("2d",{willReadFrequently:!0});Mv(R,i,s,r);const{mapping:D,canvasHeight:U,xOffset:q,yOffset:ne}=zQ({getFontWidth:pe=>R.measureText(pe).width,fontHeight:s*Pv,buffer:u,characterSet:e,maxCanvasWidth:Sv,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(I.height!==U){const pe=R.getImageData(0,0,I.width,I.height);I.height=U,R.putImageData(pe,0,0)}if(Mv(R,i,s,r),a){const pe=new kQ({fontSize:s,buffer:u,radius:y,cutoff:w,fontFamily:i,fontWeight:"".concat(r)});for(const J of e){const{data:ie,width:re,height:ge,glyphTop:be}=pe.draw(J);D[J].width=re,D[J].layoutOffsetY=s*Cv-be;const De=R.createImageData(re,ge);jQ(ie,De),R.putImageData(De,D[J].x,D[J].y)}}else for(const pe of e)R.fillText(pe,D[pe].x,D[pe].y+u+s*Cv);return{xOffset:q,yOffset:ne,mapping:D,data:I,width:I.width,height:I.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:i,buffer:r,sdf:s,radius:u,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(i," ").concat(r," ").concat(u," ").concat(a):"".concat(e," ").concat(n," ").concat(i," ").concat(r)}}const $Q=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,qQ=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,ZQ={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class Ug extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){return super.getShaders({vs:$Q,fs:qQ,modules:[Tu,Su]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var i;const{gl:r}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:s,sizeMaxPixels:u,getLineWidth:a}=this.props;let{padding:y}=this.props;y.length<4&&(y=[y[0],y[1],y[0],y[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!a,padding:y,sizeUnits:au[r],sizeScale:i,sizeMinPixels:s,sizeMaxPixels:u}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new i0(e,{...this.getShaders(),id:this.props.id,geometry:new Ql({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}Z(Ug,"defaultProps",ZQ);Z(Ug,"layerName","TextBackgroundLayer");const Iv={start:1,middle:0,end:-1},kv={top:1,center:0,bottom:-1},p4=[0,0,0,255],XQ=1,QQ={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:p4},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Qh.characterSet},fontFamily:Qh.fontFamily,fontWeight:Qh.fontWeight,lineHeight:XQ,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:p4},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:p4},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Vg extends il{constructor(...e){super(...e),Z(this,"state",void 0),Z(this,"getBoundingRect",(n,i)=>{let{size:[r,s]}=this.transformParagraph(n,i);const{fontSize:u}=this.state.fontAtlasManager.props;r/=u,s/=u;const{getTextAnchor:a,getAlignmentBaseline:y}=this.props,w=Iv[typeof a=="function"?a(n,i):a],I=kv[typeof y=="function"?y(n,i):y];return[(w-1)*r/2,(I-1)*s/2,r,s]}),Z(this,"getIconOffsets",(n,i)=>{const{getTextAnchor:r,getAlignmentBaseline:s}=this.props,{x:u,y:a,rowWidth:y,size:[w,I]}=this.transformParagraph(n,i),R=Iv[typeof r=="function"?r(n,i):r],D=kv[typeof s=="function"?s(n,i):s],U=u.length,q=new Array(U*2);let ne=0;for(let pe=0;pe<U;pe++){const J=(1-R)*(w-y[pe])/2;q[ne++]=(R-1)*w/2+J+u[pe],q[ne++]=(D-1)*I/2+a[pe]}return q})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new WQ},this.props.maxWidth>0&&Xn.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==i.lineHeight||n.wordBreak!==i.wordBreak||n.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:s}=this.state,u={...e,characterSet:s,fontFamily:n,fontWeight:i};if(!r.mapping)return r.setProps(u),!0;for(const a in u)if(u[a]!==r.props[a])return r.setProps(u),!0;return!1}_updateText(){var e;const{data:n,characterSet:i}=this.props,r=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,u=n.startIndices,a;const y=i==="auto"&&new Set;if(r&&u){const{texts:w,characterCount:I}=UQ({...ArrayBuffer.isView(r)?{value:r}:r,length:n.length,startIndices:u,characterSet:y});a=I,s=(R,{index:D})=>w[D]}else{const{iterable:w,objectInfo:I}=j2(n);u=[0],a=0;for(const R of w){I.index++;const D=Array.from(s(R,I)||"");y&&D.forEach(y.add,y),a+=D.length,u.push(a)}}this.setState({getText:s,startIndices:u,numInstances:a,characterSet:y||i})}transformParagraph(e,n){const{fontAtlasManager:i}=this.state,r=i.mapping,s=this.state.getText,{wordBreak:u,lineHeight:a,maxWidth:y}=this.props,w=s(e,n)||"";return NQ(w,a,u,y*i.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:n,getText:i,fontAtlasManager:{scale:r,texture:s,mapping:u},styleVersion:a}=this.state,{data:y,_dataDiff:w,getPosition:I,getColor:R,getSize:D,getAngle:U,getPixelOffset:q,getBackgroundColor:ne,getBorderColor:pe,getBorderWidth:J,backgroundPadding:ie,background:re,billboard:ge,fontSettings:be,outlineWidth:De,outlineColor:qe,sizeScale:et,sizeUnits:ht,sizeMinPixels:ot,sizeMaxPixels:at,transitions:Mt,updateTriggers:ut}=this.props,St=this.getSubLayerClass("characters",Ng),Pn=this.getSubLayerClass("background",Ug);return[re&&new Pn({getFillColor:ne,getLineColor:pe,getLineWidth:J,padding:ie,getPosition:I,getSize:D,getAngle:U,getPixelOffset:q,billboard:ge,sizeScale:et,sizeUnits:ht,sizeMinPixels:ot,sizeMaxPixels:at,transitions:Mt&&{getPosition:Mt.getPosition,getAngle:Mt.getAngle,getSize:Mt.getSize,getFillColor:Mt.getBackgroundColor,getLineColor:Mt.getBorderColor,getLineWidth:Mt.getBorderWidth,getPixelOffset:Mt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:ut.getPosition,getAngle:ut.getAngle,getSize:ut.getSize,getFillColor:ut.getBackgroundColor,getLineColor:ut.getBorderColor,getLineWidth:ut.getBorderWidth,getPixelOffset:ut.getPixelOffset,getBoundingRect:{getText:ut.getText,getTextAnchor:ut.getTextAnchor,getAlignmentBaseline:ut.getAlignmentBaseline,styleVersion:a}}}),{data:y.attributes&&y.attributes.background?{length:y.length,attributes:y.attributes.background}:y,_dataDiff:w,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new St({sdf:be.sdf,smoothing:Number.isFinite(be.smoothing)?be.smoothing:Qh.smoothing,outlineWidth:De/(be.radius||Qh.radius),outlineColor:qe,iconAtlas:s,iconMapping:u,getPosition:I,getColor:R,getSize:D,getAngle:U,getPixelOffset:q,billboard:ge,sizeScale:et*r,sizeUnits:ht,sizeMinPixels:ot*r,sizeMaxPixels:at*r,transitions:Mt&&{getPosition:Mt.getPosition,getAngle:Mt.getAngle,getColor:Mt.getColor,getSize:Mt.getSize,getPixelOffset:Mt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:ut.getText,getPosition:ut.getPosition,getAngle:ut.getAngle,getColor:ut.getColor,getSize:ut.getSize,getPixelOffset:ut.getPixelOffset,getIconOffsets:{getTextAnchor:ut.getTextAnchor,getAlignmentBaseline:ut.getAlignmentBaseline,styleVersion:a}}}),{data:y,_dataDiff:w,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){HQ(e)}}Z(Vg,"defaultProps",QQ);Z(Vg,"layerName","TextLayer");const Rd={circle:{type:Bg,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:p3,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Vg,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},zd={type:Og,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},N5={type:H2,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function pf({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function m4(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const u=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[u]=i[s],n&&(r.transitions[u]=n[s])),r[u]=a}return r}function YQ(t){if(Array.isArray(t))return t;switch(Xn.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Xn.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function Lv(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:s=t.length}=n;for(let u=r;u<s;u++){const a=t[u],{geometry:y}=a;if(y)if(y.type==="GeometryCollection"){Xn.assert(Array.isArray(y.geometries),"GeoJSON does not have geometries array");const{geometries:w}=y;for(let I=0;I<w.length;I++){const R=w[I];Dv(R,i,e,a,u)}}else Dv(y,i,e,a,u)}return i}function Dv(t,e,n,i,r){const{type:s,coordinates:u}=t,{pointFeatures:a,lineFeatures:y,polygonFeatures:w,polygonOutlineFeatures:I}=e;if(!JQ(s,u)){Xn.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":u.forEach(R=>{a.push(n({geometry:{type:"Point",coordinates:R}},i,r))});break;case"LineString":y.push(n({geometry:t},i,r));break;case"MultiLineString":u.forEach(R=>{y.push(n({geometry:{type:"LineString",coordinates:R}},i,r))});break;case"Polygon":w.push(n({geometry:t},i,r)),u.forEach(R=>{I.push(n({geometry:{type:"LineString",coordinates:R}},i,r))});break;case"MultiPolygon":u.forEach(R=>{w.push(n({geometry:{type:"Polygon",coordinates:R}},i,r)),R.forEach(D=>{I.push(n({geometry:{type:"LineString",coordinates:D}},i,r))})});break}}const KQ={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function JQ(t,e){let n=KQ[t];for(Xn.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function GT(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function $A(t){return t.geometry.coordinates}function eY(t,e){const n=GT(),{pointFeatures:i,lineFeatures:r,polygonFeatures:s,polygonOutlineFeatures:u}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=$A,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=$A,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=$A,n.polygonsOutline.data=u,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=$A,n}function tY(t,e){const n=GT(),{points:i,lines:r,polygons:s}=t,u=PQ(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:u.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:u.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:u.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:u.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const nY=["points","linestrings","polygons"],iY={...pf(Rd.circle),...pf(Rd.icon),...pf(Rd.text),...pf(zd),...pf(N5),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Gg extends il{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const i=tY(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:n}){const i=YQ(e.data),r=this.getSubLayerRow.bind(this);let s={};const u={};if(Array.isArray(n.dataChanged)){const y=this.state.features;for(const w in y)s[w]=y[w].slice(),u[w]=[];for(const w of n.dataChanged){const I=Lv(i,r,w);for(const R in y)u[R].push(TQ({data:s[R],getIndex:D=>D.__source.index,dataRange:w,replace:I[R]}))}}else s=Lv(i,r);const a=eY(s,u);this.setState({features:s,featuresDiff:u,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i,sourceLayer:r}=n;return n.featureType=nY.find(s=>r.id.startsWith("".concat(this.id,"-").concat(s,"-"))),i>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[i]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),i=e.featureType==="points";for(const r of this.getSubLayers())r.id.startsWith(n)===i&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:i}=this.state,r="polygons-fill",s=this.shouldRenderSubLayer(r,i.polygons.data)&&this.getSubLayerClass(r,N5.type);if(s){const u=m4(this,N5.props),a=e&&n;return a||delete u.getLineColor,u.updateTriggers.lineColors=a,new s(u,this.getSubLayerProps({id:r,updateTriggers:u.updateTriggers}),i.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:i}=this.state,r="polygons-stroke",s="linestrings",u=!e&&n&&this.shouldRenderSubLayer(r,i.polygonsOutline.data)&&this.getSubLayerClass(r,zd.type),a=this.shouldRenderSubLayer(s,i.lines.data)&&this.getSubLayerClass(s,zd.type);if(u||a){const y=m4(this,zd.props);return[u&&new u(y,this.getSubLayerProps({id:r,updateTriggers:y.updateTriggers}),i.polygonsOutline),a&&new a(y,this.getSubLayerProps({id:s,updateTriggers:y.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:i}=this.state;let{highlightedObjectIndex:r}=this.props;!i&&Number.isFinite(r)&&(r=n.points.data.findIndex(a=>a.__source.index===r));const s=new Set(e.split("+")),u=[];for(const a of s){const y="points-".concat(a),w=Rd[a],I=w&&this.shouldRenderSubLayer(y,n.points.data)&&this.getSubLayerClass(y,w.type);if(I){const R=m4(this,w.props);let D=n.points;if(a==="text"&&i){const{instancePickingColors:U,...q}=D.data.attributes;D={...D,data:{...D.data,attributes:q}}}u.push(new I(R,this.getSubLayerProps({id:y,updateTriggers:R.updateTriggers,highlightedObjectIndex:r}),D))}}return u}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),i=this._renderLineLayers(),r=this._renderPointLayers();return[!e&&n,i,r,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(i,r)=>{const{data:s,index:u}=r,a=SQ(s,u);return e(a,r)}}}Z(Gg,"layerName","GeoJsonLayer");Z(Gg,"defaultProps",iY);class rY{constructor(e){Z(this,"index",void 0),Z(this,"isVisible",void 0),Z(this,"isSelected",void 0),Z(this,"parent",void 0),Z(this,"children",void 0),Z(this,"content",void 0),Z(this,"state",void 0),Z(this,"layers",void 0),Z(this,"id",void 0),Z(this,"zoom",void 0),Z(this,"userData",void 0),Z(this,"boundingBox",void 0),Z(this,"_abortController",void 0),Z(this,"_loader",void 0),Z(this,"_loaderId",void 0),Z(this,"_isLoaded",void 0),Z(this,"_isCancelled",void 0),Z(this,"_needsReload",void 0),Z(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:i,onError:r}){const{index:s,id:u,bbox:a,userData:y,zoom:w}=this,I=this._loaderId;this._abortController=new AbortController;const{signal:R}=this._abortController,D=await n.scheduleRequest(this,ne=>ne.isSelected?1:-1);if(!D){this._isCancelled=!0;return}if(this._isCancelled){D.done();return}let U=null,q;try{U=await e({index:s,id:u,bbox:a,userData:y,zoom:w,signal:R})}catch(ne){q=ne||!0}finally{D.done()}if(I===this._loaderId){if(this._loader=void 0,this.content=U,this._isCancelled&&!U){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,q?r(q,this):i(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const os={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},Rv=new Zt,sY=new Zt;class jg{constructor(e=[0,0,0],n=[0,0,0],i){Z(this,"center",void 0),Z(this,"halfDiagonal",void 0),Z(this,"minimum",void 0),Z(this,"maximum",void 0),i=i||Rv.copy(e).add(n).scale(.5),this.center=new Zt(i),this.halfDiagonal=new Zt(n).subtract(this.center),this.minimum=new Zt(e),this.maximum=new Zt(n)}clone(){return new jg(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,i=sY.from(e.normal),r=n.x*Math.abs(i.x)+n.y*Math.abs(i.y)+n.z*Math.abs(i.z),s=this.center.dot(i)+e.distance;return s-r>0?os.INSIDE:s+r<0?os.OUTSIDE:os.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=Rv.from(e).subtract(this.center),{halfDiagonal:i}=this;let r=0,s;return s=Math.abs(n.x)-i.x,s>0&&(r+=s*s),s=Math.abs(n.y)-i.y,s>0&&(r+=s*s),s=Math.abs(n.z)-i.z,s>0&&(r+=s*s),r}}const mf=new Zt,zv=new Zt;class Hg{constructor(e=[0,0,0],n=0){Z(this,"center",void 0),Z(this,"radius",void 0),this.radius=-0,this.center=new Zt,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=mf.from(n),this.center=new Zt().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new Hg(this.center,this.radius)}union(e){const n=this.center,i=this.radius,r=e.center,s=e.radius,u=mf.copy(r).subtract(n),a=u.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const y=(i+a+s)*.5;return zv.copy(u).scale((-i+y)/a).add(n),this.center.copy(zv),this.radius=y,this}expand(e){const i=mf.from(e).subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(e){this.center.transform(e);const n=Ij(mf,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const i=mf.from(e).subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(e){const n=this.center,i=this.radius,s=e.normal.dot(n)+e.distance;return s<-i?os.OUTSIDE:s<i?os.INTERSECTING:os.INSIDE}}const oY=new Zt,aY=new Zt,qA=new Zt,ZA=new Zt,XA=new Zt,lY=new Zt,cY=new Zt,Ol={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class Wg{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){Z(this,"center",void 0),Z(this,"halfAxes",void 0),this.center=new Zt().from(e),this.halfAxes=new Vr(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new Zt(e).len(),new Zt(n).len(),new Zt(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new Zt(e).normalize(),s=new Zt(n).normalize(),u=new Zt(i).normalize();return new xy().fromMatrix3(new Vr([...r,...s,...u]))}fromCenterHalfSizeQuaternion(e,n,i){const r=new xy(i),s=new Vr().fromQuaternion(r);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new Zt().from(e),this.halfAxes=s,this}clone(){return new Wg(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new Hg){const n=this.halfAxes,i=n.getColumn(0,qA),r=n.getColumn(1,ZA),s=n.getColumn(2,XA),u=oY.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=u.magnitude(),e}intersectPlane(e){const n=this.center,i=e.normal,r=this.halfAxes,s=i.x,u=i.y,a=i.z,y=Math.abs(s*r[Ol.COLUMN0ROW0]+u*r[Ol.COLUMN0ROW1]+a*r[Ol.COLUMN0ROW2])+Math.abs(s*r[Ol.COLUMN1ROW0]+u*r[Ol.COLUMN1ROW1]+a*r[Ol.COLUMN1ROW2])+Math.abs(s*r[Ol.COLUMN2ROW0]+u*r[Ol.COLUMN2ROW1]+a*r[Ol.COLUMN2ROW2]),w=i.dot(n)+e.distance;return w<=-y?os.OUTSIDE:w>=y?os.INSIDE:os.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=aY.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,qA),s=i.getColumn(1,ZA),u=i.getColumn(2,XA),a=r.magnitude(),y=s.magnitude(),w=u.magnitude();r.normalize(),s.normalize(),u.normalize();let I=0,R;return R=Math.abs(n.dot(r))-a,R>0&&(I+=R*R),R=Math.abs(n.dot(s))-y,R>0&&(I+=R*R),R=Math.abs(n.dot(u))-w,R>0&&(I+=R*R),I}computePlaneDistances(e,n,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const u=this.center,a=this.halfAxes,y=a.getColumn(0,qA),w=a.getColumn(1,ZA),I=a.getColumn(2,XA),R=lY.copy(y).add(w).add(I).add(u),D=cY.copy(R).subtract(e);let U=n.dot(D);return r=Math.min(U,r),s=Math.max(U,s),R.copy(u).add(y).add(w).subtract(I),D.copy(R).subtract(e),U=n.dot(D),r=Math.min(U,r),s=Math.max(U,s),R.copy(u).add(y).subtract(w).add(I),D.copy(R).subtract(e),U=n.dot(D),r=Math.min(U,r),s=Math.max(U,s),R.copy(u).add(y).subtract(w).subtract(I),D.copy(R).subtract(e),U=n.dot(D),r=Math.min(U,r),s=Math.max(U,s),u.copy(R).subtract(y).add(w).add(I),D.copy(R).subtract(e),U=n.dot(D),r=Math.min(U,r),s=Math.max(U,s),u.copy(R).subtract(y).add(w).subtract(I),D.copy(R).subtract(e),U=n.dot(D),r=Math.min(U,r),s=Math.max(U,s),u.copy(R).subtract(y).subtract(w).add(I),D.copy(R).subtract(e),U=n.dot(D),r=Math.min(U,r),s=Math.max(U,s),u.copy(R).subtract(y).subtract(w).subtract(I),D.copy(R).subtract(e),U=n.dot(D),r=Math.min(U,r),s=Math.max(U,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,qA);n.transformAsPoint(e);const i=this.halfAxes.getColumn(1,ZA);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,XA);return r.transformAsPoint(e),this.halfAxes=new Vr([...n,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const Bv=new Zt,Ov=new Zt;class p1{constructor(e=[0,0,1],n=0){Z(this,"normal",void 0),Z(this,"distance",void 0),this.normal=new Zt,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return o2(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=Bv.from(e),this.normal.from(n).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,n,i,r){return this.normal.set(e,n,i),o2(Xl(this.normal.len(),1)),this.distance=r,this}clone(){return new p1(this.normal,this.distance)}equals(e){return Xl(this.distance,e.distance)&&Xl(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=Ov.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,n)}projectPointOntoPlane(e,n=[0,0,0]){e=Bv.from(e);const i=this.getPointDistance(e),r=Ov.copy(this.normal).scale(i);return e.subtract(r).to(n)}}const Fv=[new Zt([1,0,0]),new Zt([0,1,0]),new Zt([0,0,1])],Nv=new Zt,uY=new Zt;new p1(new Zt(1,0,0),0);class $l{constructor(e=[]){Z(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*Fv.length;const n=e.center,i=e.radius;let r=0;for(const s of Fv){let u=this.planes[r],a=this.planes[r+1];u||(u=this.planes[r]=new p1),a||(a=this.planes[r+1]=new p1);const y=Nv.copy(s).scale(-i).add(n);-s.dot(y),u.fromPointNormal(y,s);const w=Nv.copy(s).scale(i).add(n),I=uY.copy(s).negate();-I.dot(w),a.fromPointNormal(w,I),r+=2}return this}computeVisibility(e){let n=os.INSIDE;for(const i of this.planes)switch(e.intersectPlane(i)){case os.OUTSIDE:return os.OUTSIDE;case os.INTERSECTING:n=os.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(o2(Number.isFinite(n),"parentPlaneMask is required."),n===$l.MASK_OUTSIDE||n===$l.MASK_INSIDE)return n;let i=$l.MASK_INSIDE;const r=this.planes;for(let s=0;s<this.planes.length;++s){const u=s<31?1<<s:0;if(s<31&&!(n&u))continue;const a=r[s],y=e.intersectPlane(a);if(y===os.OUTSIDE)return $l.MASK_OUTSIDE;y===os.INTERSECTING&&(i|=u)}return i}}Z($l,"MASK_OUTSIDE",4294967295);Z($l,"MASK_INSIDE",0);Z($l,"MASK_INDETERMINATE",2147483647);new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;new Zt;const Wa=new Vr,hY=new Vr,fY=new Vr,QA=new Vr,Uv=new Vr;function AY(t,e={}){const n=zE.EPSILON20,i=10;let r=0,s=0;const u=hY,a=fY;u.identity(),a.copy(t);const y=n*dY(a);for(;s<i&&pY(a)>y;)mY(a,QA),Uv.copy(QA).transpose(),a.multiplyRight(QA),a.multiplyLeft(Uv),u.multiplyRight(QA),++r>2&&(++s,r=0);return e.unitary=u.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function dY(t){let e=0;for(let n=0;n<9;++n){const i=t[n];e+=i*i}return Math.sqrt(e)}const U5=[1,0,0],V5=[2,2,1];function pY(t){let e=0;for(let n=0;n<3;++n){const i=t[Wa.getElementIndex(V5[n],U5[n])];e+=2*i*i}return Math.sqrt(e)}function mY(t,e){const n=zE.EPSILON15;let i=0,r=1;for(let w=0;w<3;++w){const I=Math.abs(t[Wa.getElementIndex(V5[w],U5[w])]);I>i&&(r=w,i=I)}const s=U5[r],u=V5[r];let a=1,y=0;if(Math.abs(t[Wa.getElementIndex(u,s)])>n){const w=t[Wa.getElementIndex(u,u)],I=t[Wa.getElementIndex(s,s)],R=t[Wa.getElementIndex(u,s)],D=(w-I)/2/R;let U;D<0?U=-1/(-D+Math.sqrt(1+D*D)):U=1/(D+Math.sqrt(1+D*D)),a=1/Math.sqrt(1+U*U),y=U*a}return Vr.IDENTITY.to(e),e[Wa.getElementIndex(s,s)]=e[Wa.getElementIndex(u,u)]=a,e[Wa.getElementIndex(u,s)]=y,e[Wa.getElementIndex(s,u)]=-y,e}const O0=new Zt,gY=new Zt,_Y=new Zt,yY=new Zt,vY=new Zt,xY=new Vr,wY={diagonal:new Vr,unitary:new Vr};function bY(t,e=new Wg){if(!t||t.length===0)return e.halfAxes=new Vr([0,0,0,0,0,0,0,0,0]),e.center=new Zt,e;const n=t.length,i=new Zt(0,0,0);for(const ht of t)i.add(ht);const r=1/n;i.multiplyByScalar(r);let s=0,u=0,a=0,y=0,w=0,I=0;for(const ht of t){const ot=O0.copy(ht).subtract(i);s+=ot.x*ot.x,u+=ot.x*ot.y,a+=ot.x*ot.z,y+=ot.y*ot.y,w+=ot.y*ot.z,I+=ot.z*ot.z}s*=r,u*=r,a*=r,y*=r,w*=r,I*=r;const R=xY;R[0]=s,R[1]=u,R[2]=a,R[3]=u,R[4]=y,R[5]=w,R[6]=a,R[7]=w,R[8]=I;const{unitary:D}=AY(R,wY),U=e.halfAxes.copy(D);let q=U.getColumn(0,_Y),ne=U.getColumn(1,yY),pe=U.getColumn(2,vY),J=-Number.MAX_VALUE,ie=-Number.MAX_VALUE,re=-Number.MAX_VALUE,ge=Number.MAX_VALUE,be=Number.MAX_VALUE,De=Number.MAX_VALUE;for(const ht of t)O0.copy(ht),J=Math.max(O0.dot(q),J),ie=Math.max(O0.dot(ne),ie),re=Math.max(O0.dot(pe),re),ge=Math.min(O0.dot(q),ge),be=Math.min(O0.dot(ne),be),De=Math.min(O0.dot(pe),De);q=q.multiplyByScalar(.5*(ge+J)),ne=ne.multiplyByScalar(.5*(be+ie)),pe=pe.multiplyByScalar(.5*(De+re)),e.center.copy(q).add(ne).add(pe);const qe=gY.set(J-ge,ie-be,re-De).multiplyByScalar(.5),et=new Vr([qe[0],0,0,0,qe[1],0,0,0,qe[2]]);return e.halfAxes.multiplyRight(et),e}const Lh=512,Vv=3,jT=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],HT=jT.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),EY=HT.concat([[.25,.5],[.75,.5]]);class Dh{constructor(e,n,i){Z(this,"x",void 0),Z(this,"y",void 0),Z(this,"z",void 0),Z(this,"childVisible",void 0),Z(this,"selected",void 0),Z(this,"_children",void 0),this.x=e,this.y=n,this.z=i}get children(){if(!this._children){const e=this.x*2,n=this.y*2,i=this.z+1;this._children=[new Dh(e,n,i),new Dh(e,n+1,i),new Dh(e+1,n,i),new Dh(e+1,n+1,i)]}return this._children}update(e){const{viewport:n,cullingVolume:i,elevationBounds:r,minZ:s,maxZ:u,bounds:a,offset:y,project:w}=e,I=this.getBoundingVolume(r,y,w);if(a&&!this.insideBounds(a)||i.computeVisibility(I)<0)return!1;if(!this.childVisible){let{z:D}=this;if(D<u&&D>=s){const U=I.distanceTo(n.cameraPosition)*n.scale/n.height;D+=Math.floor(Math.log2(U))}if(D>=u)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const D of this.children)D.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,i,r]){const s=Math.pow(2,this.z),u=Lh/s;return this.x*u<i&&this.y*u<r&&(this.x+1)*u>e&&(this.y+1)*u>n}getBoundingVolume(e,n,i){if(i){const y=this.z<1?EY:this.z<2?HT:jT,w=[];for(const I of y){const R=j5(this.x+I[0],this.y+I[1],this.z);R[2]=e[0],w.push(i(R)),e[0]!==e[1]&&(R[2]=e[1],w.push(i(R)))}return bY(w)}const r=Math.pow(2,this.z),s=Lh/r,u=this.x*s+n*Lh,a=Lh-(this.y+1)*s;return new jg([u,a,e[0]],[u+s,a+s,e[1]])}}function TY(t,e,n,i){const r=t instanceof oX&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:U,distance:q})=>new p1(U.clone().negate(),q)),u=new $l(s),a=t.distanceScales.unitsPerMeter[2],y=n&&n[0]*a||0,w=n&&n[1]*a||0,I=t instanceof oc&&t.pitch<=60?e:0;if(i){const[U,q,ne,pe]=i,J=tl([U,pe]),ie=tl([ne,q]);i=[J[0],Lh-J[1],ie[0],Lh-ie[1]]}const R=new Dh(0,0,0),D={viewport:t,project:r,cullingVolume:u,elevationBounds:[y,w],minZ:I,maxZ:e,bounds:i,offset:0};if(R.update(D),t instanceof oc&&t.subViewports&&t.subViewports.length>1){for(D.offset=-1;R.update(D)&&!(--D.offset<-Vv););for(D.offset=1;R.update(D)&&!(++D.offset>Vv););}return R.getSelected()}const s0=512,SY=[-1/0,-1/0,1/0,1/0],CY={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}};function WT(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(r=>r[0])),Math.min(...n.map(r=>r[1])),Math.max(...n.map(r=>r[0])),Math.max(...n.map(r=>r[1]))]}function PY(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function MY(t,e){if(!t||!t.length)return null;const{index:n,id:i}=e;if(Array.isArray(t)){const s=PY(i)%t.length;t=t[s]}let r=t;for(const s of Object.keys(n)){const u=new RegExp("{".concat(s,"}"),"g");r=r.replace(u,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(r=r.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),r}function IY(t,e,n){let i;if(e&&e.length===2){const[r,s]=e,u=t.getBounds({z:r}),a=t.getBounds({z:s});i=[Math.min(u[0],a[0]),Math.min(u[1],a[1]),Math.max(u[2],a[2]),Math.max(u[3],a[3])]}else i=t.getBounds();return t.isGeospatial?[Math.max(i[0],n[0]),Math.max(i[1],n[1]),Math.min(i[2],n[2]),Math.min(i[3],n[3])]:[Math.max(Math.min(i[0],n[2]),n[0]),Math.max(Math.min(i[1],n[3]),n[1]),Math.min(Math.max(i[2],n[0]),n[2]),Math.min(Math.max(i[3],n[1]),n[3])]}function kY({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(r=>G5(r,e,n))}function G5(t,e,n){if(!Array.isArray(e)){const s=n.x-t.x,u=n.y-t.y,{width:a,height:y}=n,w={targetZ:e},I=t.unproject([s,u],w),R=t.unproject([s+a,u],w),D=t.unproject([s,u+y],w),U=t.unproject([s+a,u+y],w);return[Math.min(I[0],R[0],D[0],U[0]),Math.min(I[1],R[1],D[1],U[1]),Math.max(I[0],R[0],D[0],U[0]),Math.max(I[1],R[1],D[1],U[1])]}const i=G5(t,e[0],n),r=G5(t,e[1],n);return[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[2],r[2]),Math.max(i[3],r[3])]}function LY(t,e,n){return n?WT(t,n).map(r=>r*e/s0):t.map(i=>i*e/s0)}function $g(t,e){return Math.pow(2,t)*s0/e}function j5(t,e,n){const i=$g(n,s0),r=t/i*360-180,s=Math.PI-2*Math.PI*e/i,u=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[r,u]}function Gv(t,e,n,i){const r=$g(n,i);return[t/r*s0,e/r*s0]}function DY(t,e,n,i,r=s0){if(t.isGeospatial){const[w,I]=j5(e,n,i),[R,D]=j5(e+1,n+1,i);return{west:w,north:I,east:R,south:D}}const[s,u]=Gv(e,n,i,r),[a,y]=Gv(e+1,n+1,i,r);return{left:s,top:u,right:a,bottom:y}}function RY(t,e,n,i,r){const s=IY(t,null,i),u=$g(e,n),[a,y,w,I]=LY(s,u,r),R=[];for(let D=Math.floor(a);D<w;D++)for(let U=Math.floor(y);U<I;U++)R.push({x:D,y:U,z:e});return R}function zY({viewport:t,maxZoom:e,minZoom:n,zRange:i,extent:r,tileSize:s=s0,modelMatrix:u,modelMatrixInverse:a,zoomOffset:y=0}){let w=t.isGeospatial?Math.round(t.zoom+Math.log2(s0/s))+y:Math.ceil(t.zoom)+y;if(typeof n=="number"&&Number.isFinite(n)&&w<n){if(!r)return[];w=n}typeof e=="number"&&Number.isFinite(e)&&w>e&&(w=e);let I=r;return u&&a&&r&&!t.isGeospatial&&(I=WT(r,u)),t.isGeospatial?TY(t,w,i,r):RY(t,w,s,I||SY,a)}function BY(t){let e={},n;return i=>{for(const r in i)if(!OY(i[r],e[r])){n=t(i),e=i;break}return n}}function OY(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}const jv=1,_3=2,FY="never",NY="no-overlap",qg="best-available",UY=5,VY={[qg]:HY,[NY]:WY,[FY]:()=>{}},GY={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class jY{constructor(e){Z(this,"opts",void 0),Z(this,"_requestScheduler",void 0),Z(this,"_cache",void 0),Z(this,"_dirty",void 0),Z(this,"_tiles",void 0),Z(this,"_cacheByteSize",void 0),Z(this,"_viewport",void 0),Z(this,"_zRange",void 0),Z(this,"_selectedTiles",void 0),Z(this,"_frameNumber",void 0),Z(this,"_modelMatrix",void 0),Z(this,"_modelMatrixInverse",void 0),Z(this,"_maxZoom",void 0),Z(this,"_minZoom",void 0),Z(this,"onTileLoad",void 0),Z(this,"_getCullBounds",BY(kY)),this.opts={...GY,...e},this.onTileLoad=n=>{var i,r;(i=(r=this.opts).onTileLoad)===null||i===void 0||i.call(r,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new kB({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Vs,this._modelMatrixInverse=new Vs,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:i}={}){const r=new Vs(i),s=!r.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Xl(this._zRange,n)||s){s&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(y=>this._getTile(y,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const u=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),u&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:r}=e;for(const[s,u,a,y]of i){let w;if("west"in r)w=r.west<a&&r.east>s&&r.south<y&&r.north>u;else{const I=Math.min(r.top,r.bottom),R=Math.max(r.top,r.bottom);w=r.left<a&&r.right>s&&I<y&&R>u}if(w)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:i,zRange:r,modelMatrix:s,modelMatrixInverse:u}){const{tileSize:a,extent:y,zoomOffset:w}=this.opts;return zY({viewport:e,maxZoom:n,minZoom:i,zRange:r,tileSize:a,extent:y,modelMatrix:s,modelMatrixInverse:u,zoomOffset:w})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:DY(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),i=Math.floor(e.y/2),r=e.z-1;return{x:n,y:i,z:r}}updateTileStates(){const e=this.opts.refinementStrategy||qg,n=new Array(this._cache.size);let i=0;for(const r of this._cache.values())n[i++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;(typeof e=="function"?e:VY[e])(Array.from(this._cache.values())),i=0;for(const r of this._cache.values())if(n[i++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let i=0;for(const r of this._cache.values())r.isLoading&&(i++,!r.isSelected&&!r.isVisible&&n.push(r));for(;e>0&&i>e&&n.length>0;)n.shift().abort(),i--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const i=this._getNearestAncestor(n);n.parent=i,i!=null&&i.children&&i.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,i=n.maxCacheSize||(n.maxCacheByteSize?1/0:UY*this.selectedTiles.length),r=n.maxCacheByteSize||1/0;if(e.size>i||this._cacheByteSize>r){for(const[y,w]of e){if(!w.isVisible&&!w.isSelected){var u,a;this._cacheByteSize-=n.maxCacheByteSize?w.byteLength:0,e.delete(y),(u=(a=this.opts).onTileUnload)===null||u===void 0||u.call(a,w)}if(e.size<=i&&this._cacheByteSize<=r)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((y,w)=>y.zoom-w.zoom),this._dirty=!1)}_getTile(e,n){const i=this.getTileId(e);let r=this._cache.get(i),s=!1;return!r&&n?(r=new rY(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:i,zoom:this.getTileZoom(r.index)}),s=!0,this._cache.set(i,r),this._dirty=!0):r&&r.needsReload&&(s=!0),r&&s&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:n=0}=this;let i=e.index;for(;this.getTileZoom(i)>n;){i=this.getParentIndex(i);const r=this._getTile(i);if(r)return r}return null}}function HY(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!$T(e)&&Zg(e);for(const e of t)e.isVisible=!!(e.state&_3)}function WY(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&$T(n);const e=Array.from(t).sort((n,i)=>n.zoom-i.zoom);for(const n of e)if(n.isVisible=!!(n.state&_3),n.children&&(n.isVisible||n.state&jv))for(const i of n.children)i.state=jv;else n.isSelected&&Zg(n)}function $T(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=_3,!0;e=e.parent}return!1}function Zg(t){for(const e of t.children)e.isLoaded||e.content?e.state|=_3:Zg(e)}const $Y={TilesetClass:jY,data:{type:"data",value:[]},dataComparator:CY.equal,renderSubLayers:{type:"function",value:t=>new Gg(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:qg,zRange:null,maxRequests:6,zoomOffset:0};class Xg extends il{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,i;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(i=n.selectedTiles)===null||i===void 0?void 0:i.every(r=>r.isLoaded&&r.layers&&r.layers.every(s=>s.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const i=e.propsOrDataChanged||e.updateTriggersChanged,r=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?i&&(n.setOptions(this._getTilesetOptions()),r?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:i,refinementStrategy:r,extent:s,maxZoom:u,minZoom:a,maxRequests:y,zoomOffset:w}=this.props;return{maxCacheSize:n,maxCacheByteSize:i,maxZoom:u,minZoom:a,tileSize:e,refinementStrategy:r,extent:s,maxRequests:y,zoomOffset:w,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:i}=this.props,r=e.update(this.context.viewport,{zRange:n,modelMatrix:i}),{isLoaded:s}=e,u=this.state.isLoaded!==s,a=this.state.frameNumber!==r;s&&(u||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:r}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:i,fetch:r}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?MY(n,e):null,i?i(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const i=n.props.tile;return e.picked&&(e.tile=i),e.sourceTile=i,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const i of n.layers)i.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(i=>e.layers[0].props[i]!==n[i])&&(e.layers=e.layers.map(i=>i.clone(n)));else{const i=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=h3(i,Boolean).map(r=>r.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:i}=e.props;return this.state.tileset.isTileVisible(i,n)}}Z(Xg,"defaultProps",$Y);Z(Xg,"layerName","TileLayer");const g4=Math.PI/180,YA=new Float32Array(16),Hv=new Float32Array(12);function Wv(t,e,n){const i=e[0]*g4,r=e[1]*g4,s=e[2]*g4,u=Math.sin(s),a=Math.sin(i),y=Math.sin(r),w=Math.cos(s),I=Math.cos(i),R=Math.cos(r),D=n[0],U=n[1],q=n[2];t[0]=D*R*I,t[1]=D*y*I,t[2]=D*-a,t[3]=U*(-y*w+R*a*u),t[4]=U*(R*w+y*a*u),t[5]=U*I*u,t[6]=q*(y*u+R*a*w),t[7]=q*(-R*u+y*a*w),t[8]=q*I*w}function $v(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const qY={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:r,getScale:s,getTranslation:u,getTransformMatrix:a}=this.props,y=Array.isArray(a),w=y&&a.length===16,I=Array.isArray(s),R=Array.isArray(r),D=Array.isArray(u),U=w||!y&&!!a(i[0]);U?t.constant=w:t.constant=R&&I&&D;const q=t.value;if(t.constant){let ne;U?(YA.set(a),ne=$v(YA)):(ne=Hv,Wv(ne,r,s),ne.set(u,9)),t.value=new Float32Array(ne)}else{let ne=e*t.size;const{iterable:pe,objectInfo:J}=j2(i,e,n);for(const ie of pe){J.index++;let re;if(U)YA.set(w?a:a(ie,J)),re=$v(YA);else{re=Hv;const ge=R?r:r(ie,J),be=I?s:s(ie,J);Wv(re,ge,be),re.set(D?u:u(ie,J),9)}q[ne++]=re[0],q[ne++]=re[1],q[ne++]=re[2],q[ne++]=re[3],q[ne++]=re[4],q[ne++]=re[5],q[ne++]=re[6],q[ne++]=re[7],q[ne++]=re[8],q[ne++]=re[9],q[ne++]=re[10],q[ne++]=re[11]}}}};function ZY(t,e){return e===Yn.CARTESIAN||e===Yn.METER_OFFSETS||e===Yn.DEFAULT&&!t.isGeospatial}const XY=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,QY=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function qT(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,u=-1/0;const a=t.POSITION?t.POSITION.value:[],y=a&&a.length;for(let w=0;w<y;w+=3){const I=a[w],R=a[w+1],D=a[w+2];e=I<e?I:e,n=R<n?R:n,i=D<i?D:i,r=I>r?I:r,s=R>s?R:s,u=D>u?D:u}return[[e,n,i],[r,s,u]]}function YY(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class Rh{constructor(e,n){Z(this,"fields",void 0),Z(this,"metadata",void 0),YY(Array.isArray(e)),KY(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(const u of i)e[u]=!0;const s=this.fields.filter(u=>e[u.name]);return new Rh(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];const r=n.map(s=>this.fields[s]).filter(Boolean);return new Rh(r,this.metadata)}assign(e){let n,i=this.metadata;if(e instanceof Rh){const u=e;n=u.fields,i=qv(qv(new Map,this.metadata),u.metadata)}else n=e;const r=Object.create(null);for(const u of this.fields)r[u.name]=u;for(const u of n)r[u.name]=u;const s=Object.values(r);return new Rh(s,i)}}function KY(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function qv(t,e){return new Map([...t||new Map,...e||new Map])}class Gf{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;Z(this,"name",void 0),Z(this,"type",void 0),Z(this,"nullable",void 0),Z(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new Gf(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Yi=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),ZT,XT,QT;class Qg{static isNull(e){return e&&e.typeId===Yi.Null}static isInt(e){return e&&e.typeId===Yi.Int}static isFloat(e){return e&&e.typeId===Yi.Float}static isBinary(e){return e&&e.typeId===Yi.Binary}static isUtf8(e){return e&&e.typeId===Yi.Utf8}static isBool(e){return e&&e.typeId===Yi.Bool}static isDecimal(e){return e&&e.typeId===Yi.Decimal}static isDate(e){return e&&e.typeId===Yi.Date}static isTime(e){return e&&e.typeId===Yi.Time}static isTimestamp(e){return e&&e.typeId===Yi.Timestamp}static isInterval(e){return e&&e.typeId===Yi.Interval}static isList(e){return e&&e.typeId===Yi.List}static isStruct(e){return e&&e.typeId===Yi.Struct}static isUnion(e){return e&&e.typeId===Yi.Union}static isFixedSizeBinary(e){return e&&e.typeId===Yi.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Yi.FixedSizeList}static isMap(e){return e&&e.typeId===Yi.Map}static isDictionary(e){return e&&e.typeId===Yi.Dictionary}get typeId(){return Yi.NONE}compareTo(e){return this===e}}ZT=Symbol.toStringTag;class I1 extends Qg{constructor(e,n){super(),Z(this,"isSigned",void 0),Z(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Yi.Int}get[ZT](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class JY extends I1{constructor(){super(!0,8)}}class eK extends I1{constructor(){super(!0,16)}}class tK extends I1{constructor(){super(!0,32)}}class nK extends I1{constructor(){super(!1,8)}}class iK extends I1{constructor(){super(!1,16)}}class rK extends I1{constructor(){super(!1,32)}}const YT={HALF:16,SINGLE:32,DOUBLE:64};XT=Symbol.toStringTag;class KT extends Qg{constructor(e){super(),Z(this,"precision",void 0),this.precision=e}get typeId(){return Yi.Float}get[XT](){return"Float"}toString(){return"Float".concat(this.precision)}}class sK extends KT{constructor(){super(YT.SINGLE)}}class oK extends KT{constructor(){super(YT.DOUBLE)}}QT=Symbol.toStringTag;class aK extends Qg{constructor(e,n){super(),Z(this,"listSize",void 0),Z(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Yi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[QT](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function lK(t){switch(t.constructor){case Int8Array:return new JY;case Uint8Array:return new nK;case Int16Array:return new eK;case Uint16Array:return new iK;case Int32Array:return new tK;case Uint32Array:return new rK;case Float32Array:return new sK;case Float64Array:return new oK;default:throw new Error("array type not supported")}}function Zv(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),Xn.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Xv(t,e){if(t.attributes)return Zv(t.attributes,e),t instanceof Ql?t:new Ql(t);if(t.positions||t.POSITION)return Zv(t,e),new Ql({attributes:t});throw Error("Invalid mesh")}const cK=[0,0,0,255],uK={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:cK},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class k1 extends xa{constructor(...e){super(...e),Z(this,"state",void 0)}getShaders(){const e=!Kn(this.context.gl),n={};return rE(this.context.gl,Pi.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:XY,fs:QY,modules:[Tu,EH,Su],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:i}=this.props;if(!i)return null;if(n=(e=i.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:r}=Xv(i,this.props._useMeshColors);r.POSITION=r.POSITION||r.positions,n=qT(r)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:qY}),this.setState({emptyTexture:new Ws(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e;if(n.mesh!==i.mesh||r.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const u=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(u.NORMAL||u.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==i.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:r,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!s||ZY(n,r),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new i0(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:Xv(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:r}=this.state;return n.setUniforms({sampler:i||r,hasTexture:!!i}),n}setTexture(e){const{emptyTexture:n,model:i}=this.state;i&&i.setUniforms({sampler:e||n,hasTexture:!!e})}}Z(k1,"defaultProps",uK);Z(k1,"layerName","SimpleMeshLayer");var JT={exports:{}},Jn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W2=Symbol.for("react.element"),hK=Symbol.for("react.portal"),fK=Symbol.for("react.fragment"),AK=Symbol.for("react.strict_mode"),dK=Symbol.for("react.profiler"),pK=Symbol.for("react.provider"),mK=Symbol.for("react.context"),gK=Symbol.for("react.forward_ref"),_K=Symbol.for("react.suspense"),yK=Symbol.for("react.memo"),vK=Symbol.for("react.lazy"),Qv=Symbol.iterator;function xK(t){return t===null||typeof t!="object"?null:(t=Qv&&t[Qv]||t["@@iterator"],typeof t=="function"?t:null)}var eS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tS=Object.assign,nS={};function L1(t,e,n){this.props=t,this.context=e,this.refs=nS,this.updater=n||eS}L1.prototype.isReactComponent={};L1.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};L1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iS(){}iS.prototype=L1.prototype;function Yg(t,e,n){this.props=t,this.context=e,this.refs=nS,this.updater=n||eS}var Kg=Yg.prototype=new iS;Kg.constructor=Yg;tS(Kg,L1.prototype);Kg.isPureReactComponent=!0;var Yv=Array.isArray,rS=Object.prototype.hasOwnProperty,Jg={current:null},sS={key:!0,ref:!0,__self:!0,__source:!0};function oS(t,e,n){var i,r={},s=null,u=null;if(e!=null)for(i in e.ref!==void 0&&(u=e.ref),e.key!==void 0&&(s=""+e.key),e)rS.call(e,i)&&!sS.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var y=Array(a),w=0;w<a;w++)y[w]=arguments[w+2];r.children=y}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:W2,type:t,key:s,ref:u,props:r,_owner:Jg.current}}function wK(t,e){return{$$typeof:W2,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function e8(t){return typeof t=="object"&&t!==null&&t.$$typeof===W2}function bK(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Kv=/\/+/g;function _4(t,e){return typeof t=="object"&&t!==null&&t.key!=null?bK(""+t.key):e.toString(36)}function Bd(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var u=!1;if(t===null)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case W2:case hK:u=!0}}if(u)return u=t,r=r(u),t=i===""?"."+_4(u,0):i,Yv(r)?(n="",t!=null&&(n=t.replace(Kv,"$&/")+"/"),Bd(r,e,n,"",function(w){return w})):r!=null&&(e8(r)&&(r=wK(r,n+(!r.key||u&&u.key===r.key?"":(""+r.key).replace(Kv,"$&/")+"/")+t)),e.push(r)),1;if(u=0,i=i===""?".":i+":",Yv(t))for(var a=0;a<t.length;a++){s=t[a];var y=i+_4(s,a);u+=Bd(s,e,n,y,r)}else if(y=xK(t),typeof y=="function")for(t=y.call(t),a=0;!(s=t.next()).done;)s=s.value,y=i+_4(s,a++),u+=Bd(s,e,n,y,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return u}function KA(t,e,n){if(t==null)return t;var i=[],r=0;return Bd(t,i,"","",function(s){return e.call(n,s,r++)}),i}function EK(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Cs={current:null},Od={transition:null},TK={ReactCurrentDispatcher:Cs,ReactCurrentBatchConfig:Od,ReactCurrentOwner:Jg};Jn.Children={map:KA,forEach:function(t,e,n){KA(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return KA(t,function(){e++}),e},toArray:function(t){return KA(t,function(e){return e})||[]},only:function(t){if(!e8(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Jn.Component=L1;Jn.Fragment=fK;Jn.Profiler=dK;Jn.PureComponent=Yg;Jn.StrictMode=AK;Jn.Suspense=_K;Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TK;Jn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=tS({},t.props),r=t.key,s=t.ref,u=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,u=Jg.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(y in e)rS.call(e,y)&&!sS.hasOwnProperty(y)&&(i[y]=e[y]===void 0&&a!==void 0?a[y]:e[y])}var y=arguments.length-2;if(y===1)i.children=n;else if(1<y){a=Array(y);for(var w=0;w<y;w++)a[w]=arguments[w+2];i.children=a}return{$$typeof:W2,type:t.type,key:r,ref:s,props:i,_owner:u}};Jn.createContext=function(t){return t={$$typeof:mK,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:pK,_context:t},t.Consumer=t};Jn.createElement=oS;Jn.createFactory=function(t){var e=oS.bind(null,t);return e.type=t,e};Jn.createRef=function(){return{current:null}};Jn.forwardRef=function(t){return{$$typeof:gK,render:t}};Jn.isValidElement=e8;Jn.lazy=function(t){return{$$typeof:vK,_payload:{_status:-1,_result:t},_init:EK}};Jn.memo=function(t,e){return{$$typeof:yK,type:t,compare:e===void 0?null:e}};Jn.startTransition=function(t){var e=Od.transition;Od.transition={};try{t()}finally{Od.transition=e}};Jn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Jn.useCallback=function(t,e){return Cs.current.useCallback(t,e)};Jn.useContext=function(t){return Cs.current.useContext(t)};Jn.useDebugValue=function(){};Jn.useDeferredValue=function(t){return Cs.current.useDeferredValue(t)};Jn.useEffect=function(t,e){return Cs.current.useEffect(t,e)};Jn.useId=function(){return Cs.current.useId()};Jn.useImperativeHandle=function(t,e,n){return Cs.current.useImperativeHandle(t,e,n)};Jn.useInsertionEffect=function(t,e){return Cs.current.useInsertionEffect(t,e)};Jn.useLayoutEffect=function(t,e){return Cs.current.useLayoutEffect(t,e)};Jn.useMemo=function(t,e){return Cs.current.useMemo(t,e)};Jn.useReducer=function(t,e,n){return Cs.current.useReducer(t,e,n)};Jn.useRef=function(t){return Cs.current.useRef(t)};Jn.useState=function(t){return Cs.current.useState(t)};Jn.useSyncExternalStore=function(t,e,n){return Cs.current.useSyncExternalStore(t,e,n)};Jn.useTransition=function(){return Cs.current.useTransition()};Jn.version="18.2.0";JT.exports=Jn;var yt=JT.exports;const Vn=f3(yt),SK=typeof window<"u"?yt.useLayoutEffect:yt.useEffect,CK=SK;function Mp(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const PK={position:"absolute",zIndex:-1};function aS(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>aS(n,e));if(y3(t)){if(MK(t))return e.style=PK,yt.cloneElement(t,e);if(IK(t))return yt.cloneElement(t,e)}return t}function y3(t){return t&&typeof t=="object"&&"type"in t||!1}function MK(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function IK(t){const e=t.type;return e&&e.deckGLViewProps}function H5(t){if(typeof t=="function")return yt.createElement(d1,{},t);if(Array.isArray(t))return t.map(H5);if(y3(t)){if(t.type===yt.Fragment)return H5(t.props.children);if(Mp(t.type,d1))return t}return t}function kK({children:t,layers:e=[],views:n=null}){const i=[],r=[],s={};return yt.Children.forEach(H5(t),u=>{if(y3(u)){const a=u.type;if(Mp(a,xa)){const y=LK(a,u.props);r.push(y)}else i.push(u);if(Mp(a,d1)&&a!==d1&&u.props.id){const y=new a(u.props);s[y.id]=y}}else u&&i.push(u)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(u=>{s[u.id]=u}):n&&(s[n.id]=n),n=Object.values(s)),e=r.length>0?[...r,...e]:e,{layers:e,children:i,views:n}}function LK(t,e){const n={},i=t.defaultProps||{};for(const r in e)i[r]!==e[r]&&(n[r]=e[r]);return new t(n)}function DK({children:t,deck:e,ContextProvider:n}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const r={},s=i.views[0].id;for(const u of t){let a=s,y=u;y3(u)&&Mp(u.type,d1)&&(a=u.props.id||s,y=u.props.children);const w=i.getViewport(a),I=i.getViewState(a);if(w){I.padding=w.padding;const{x:R,y:D,width:U,height:q}=w;y=aS(y,{x:R,y:D,width:U,height:q,viewport:w,viewState:I}),r[a]||(r[a]={viewport:w,children:[]}),r[a].children.push(y)}}return Object.keys(r).map(u=>{const{viewport:a,children:y}=r[u],{x:w,y:I,width:R,height:D}=a,U={position:"absolute",left:w,top:I,width:R,height:D},q="view-".concat(u),ne=yt.createElement("div",{key:q,id:q,style:U},...y);if(n){const pe={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:J=>{J.viewId=u,e._onViewStateChange(J)}};return yt.createElement(n,{key:q,value:pe},ne)}return ne})}const RK={mixBlendMode:null};function zK({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const s in n)s in RK?r[s]=n[s]:i[s]=n[s];return{containerStyle:i,canvasStyle:r}}function BK(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function lS(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function OK(t,e,n){const i=new e({...n,_customRender:r=>{t.redrawReason=r;const s=i.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():lS(t)}});return i}const cS=yt.forwardRef((t,e)=>{const[n,i]=yt.useState(0),s=yt.useRef({control:null,version:n,forceUpdate:()=>i(be=>be+1)}).current,u=yt.useRef(null),a=yt.useRef(null),y=yt.useMemo(()=>kK(t),[t.layers,t.views,t.children]);let w=!0;const I=be=>{var De;return w&&t.viewState?(s.viewStateUpdateRequested=be,null):(s.viewStateUpdateRequested=null,(De=t.onViewStateChange)===null||De===void 0?void 0:De.call(t,be))},R=be=>{if(w)s.interactionStateUpdateRequested=be;else{var De;s.interactionStateUpdateRequested=null,(De=t.onInteractionStateChange)===null||De===void 0||De.call(t,be)}},D=yt.useMemo(()=>{const be={...t,style:null,width:"100%",height:"100%",parent:u.current,canvas:a.current,layers:y.layers,views:y.views,onViewStateChange:I,onInteractionStateChange:R};return delete be._customRender,s.deck&&s.deck.setProps(be),be},[t]);yt.useEffect(()=>{const be=t.Deck||d3;return s.deck=OK(s,be,{...D,parent:u.current,canvas:a.current}),()=>{var De;return(De=s.deck)===null||De===void 0?void 0:De.finalize()}},[]),CK(()=>{lS(s);const{viewStateUpdateRequested:be,interactionStateUpdateRequested:De}=s;be&&I(be),De&&R(De)}),yt.useImperativeHandle(e,()=>BK(s),[]);const U=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:q,width:ne,height:pe,id:J,style:ie}=t,{containerStyle:re,canvasStyle:ge}=yt.useMemo(()=>zK({width:ne,height:pe,style:ie}),[ne,pe,ie]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===U||s.version!==n){s.lastRenderedViewports=U,s.version=n;const be=DK({children:y.children,deck:s.deck,ContextProvider:q}),De=yt.createElement("canvas",{key:"canvas",id:J||"deckgl-overlay",ref:a,style:ge});s.control=yt.createElement("div",{id:"".concat(J||"deckgl","-wrapper"),ref:u,style:re},[De,be])}return w=!1,s.control});cS.defaultProps=d3.defaultProps;const FK=cS,NK=/^[og]\s*(.+)?/,UK=/^mtllib /,VK=/^usemtl /;class t8{constructor(e){let{index:n,name:i="",mtllib:r,smooth:s,groupStart:u}=e;this.index=n,this.name=i,this.mtllib=r,this.smooth=s,this.groupStart=u,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new t8({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class GK{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);const r=new t8({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:i!==void 0?i.smooth:this.smooth,groupStart:i!==void 0?i.groupEnd:0});return this.materials.push(r),r}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let i=this.materials.length-1;i>=0;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class jK{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new GK(e),this.object.fromDeclaration=n,i&&i.name&&typeof i.clone=="function"){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/3)*3}parseNormalIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/3)*3}parseUVIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/2)*2}addVertex(e,n,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addColor(e,n,i){const r=this.colors,s=this.object.geometry.colors;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addUV(e,n,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[n+0],r[n+1]),s.push(r[i+0],r[i+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,i,r,s,u,a,y,w){const I=this.vertices.length;let R=this.parseVertexIndex(e,I),D=this.parseVertexIndex(n,I),U=this.parseVertexIndex(i,I);if(this.addVertex(R,D,U),r!==void 0&&r!==""){const q=this.uvs.length;R=this.parseUVIndex(r,q),D=this.parseUVIndex(s,q),U=this.parseUVIndex(u,q),this.addUV(R,D,U)}if(a!==void 0&&a!==""){const q=this.normals.length;R=this.parseNormalIndex(a,q),D=a===y?R:this.parseNormalIndex(y,q),U=a===w?R:this.parseNormalIndex(w,q),this.addNormal(R,D,U)}this.colors.length>0&&this.addColor(R,D,U)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const i of e)this.addVertexPoint(this.parseVertexIndex(i,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(const s of e)this.addVertexLine(this.parseVertexIndex(s,i));for(const s of n)this.addUVLine(this.parseUVIndex(s,r))}}function HK(t){const e=new jK;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let i="",r="",s=0,u=[];const a=typeof"".trimLeft=="function";for(let I=0,R=n.length;I<R;I++)if(i=n[I],i=a?i.trimLeft():i.trim(),s=i.length,s!==0&&(r=i.charAt(0),r!=="#"))if(r==="v"){const D=i.split(/\s+/);switch(D[0]){case"v":e.vertices.push(parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3])),D.length>=7&&e.colors.push(parseFloat(D[4]),parseFloat(D[5]),parseFloat(D[6]));break;case"vn":e.normals.push(parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]));break;case"vt":e.uvs.push(parseFloat(D[1]),parseFloat(D[2]));break}}else if(r==="f"){const U=i.substr(1).trim().split(/\s+/),q=[];for(let pe=0,J=U.length;pe<J;pe++){const ie=U[pe];if(ie.length>0){const re=ie.split("/");q.push(re)}}const ne=q[0];for(let pe=1,J=q.length-1;pe<J;pe++){const ie=q[pe],re=q[pe+1];e.addFace(ne[0],ie[0],re[0],ne[1],ie[1],re[1],ne[2],ie[2],re[2])}}else if(r==="l"){const D=i.substring(1).trim().split(" ");let U;const q=[];if(i.indexOf("/")===-1)U=D;else{U=[];for(let ne=0,pe=D.length;ne<pe;ne++){const J=D[ne].split("/");J[0]!==""&&U.push(J[0]),J[1]!==""&&q.push(J[1])}}e.addLineGeometry(U,q)}else if(r==="p"){const U=i.substr(1).trim().split(" ");e.addPointGeometry(U)}else if((u=NK.exec(i))!==null){const D=(" "+u[0].substr(1).trim()).substr(1);e.startObject(D)}else if(VK.test(i))e.object.startMaterial(i.substring(7).trim(),e.materialLibraries);else if(UK.test(i))e.materialLibraries.push(i.substring(7).trim());else if(r==="s"){if(u=i.split(" "),u.length>1){const U=u[1].trim().toLowerCase();e.object.smooth=U!=="0"&&U!=="off"}else e.object.smooth=!0;const D=e.object.currentMaterial();D&&(D.smooth=e.object.smooth)}else{if(i==="\0")continue;throw new Error('Unexpected line: "'.concat(i,'"'))}e.finalize();const y=[],w=[];for(const I of e.objects){const{geometry:R}=I;if(R.vertices.length===0)continue;const D={header:{vertexCount:R.vertices.length/3},attributes:{}};switch(R.type){case"Points":D.mode=0;break;case"Line":D.mode=1;break;default:D.mode=4;break}D.attributes.POSITION={value:new Float32Array(R.vertices),size:3},R.normals.length>0&&(D.attributes.NORMAL={value:new Float32Array(R.normals),size:3}),R.colors.length>0&&(D.attributes.COLOR_0={value:new Float32Array(R.colors),size:3}),R.uvs.length>0&&(D.attributes.TEXCOORD_0={value:new Float32Array(R.uvs),size:2}),D.materials=[];for(const U of I.materials){const q={name:U.name,flatShading:!U.smooth};D.materials.push(q),w.push(q)}D.name=I.name,y.push(D)}return{meshes:y,materials:w}}function WK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const r in e)n=n||new Map,r!=="value"&&n.set(r,JSON.stringify(e[r]));const i=[];for(const r in t){const s=t[r],u=$K(r,s);i.push(u)}return new Rh(i,n)}function $K(t,e){const n=new Map;for(const s in e)s!=="value"&&n.set(s,JSON.stringify(e[s]));const i=lK(e.value);return!("size"in e)||e.size===1?new Gf(t,i,!1,n):new Gf(t,new aK(e.size,new Gf("value",i)),!1,n)}function Jv(t,e){const{meshes:n}=HK(t),i=n.reduce((a,y)=>a+y.header.vertexCount,0),r=qK(n,i),s={vertexCount:i,boundingBox:qT(r)},u=WK(r,{mode:4,boundingBox:s.boundingBox});return{loaderData:{header:{}},schema:u,header:s,mode:4,attributes:r}}function qK(t,e){const n=new Float32Array(e*3);let i,r,s,u=0;for(const y of t){const{POSITION:w,NORMAL:I,COLOR_0:R,TEXCOORD_0:D}=y.attributes;n.set(w.value,u*3),I&&(i=i||new Float32Array(e*3),i.set(I.value,u*3)),R&&(r=r||new Float32Array(e*3),r.set(R.value,u*3)),D&&(s=s||new Float32Array(e*2),s.set(D.value,u*2)),u+=w.value.length/3}const a={};return a.POSITION={value:n,size:3},i&&(a.NORMAL={value:i,size:3}),r&&(a.COLOR_0={value:r,size:3}),s&&(a.TEXCOORD_0={value:s,size:2}),a}const ZK="3.4.14",XK={name:"OBJ",id:"obj",module:"obj",version:ZK,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:QK,options:{obj:{}}};function QK(t){return t[0]==="v"}const es={...XK,parse:async(t,e)=>Jv(new TextDecoder().decode(t)),parseTextSync:(t,e)=>Jv(t)};var uS={exports:{}},go={},hS={exports:{}},fS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(vt,Bt){var Qt=vt.length;vt.push(Bt);e:for(;0<Qt;){var Mn=Qt-1>>>1,bn=vt[Mn];if(0<r(bn,Bt))vt[Mn]=Bt,vt[Qt]=bn,Qt=Mn;else break e}}function n(vt){return vt.length===0?null:vt[0]}function i(vt){if(vt.length===0)return null;var Bt=vt[0],Qt=vt.pop();if(Qt!==Bt){vt[0]=Qt;e:for(var Mn=0,bn=vt.length,pn=bn>>>1;Mn<pn;){var Nn=2*(Mn+1)-1,ti=vt[Nn],Ue=Nn+1,An=vt[Ue];if(0>r(ti,Qt))Ue<bn&&0>r(An,ti)?(vt[Mn]=An,vt[Ue]=Qt,Mn=Ue):(vt[Mn]=ti,vt[Nn]=Qt,Mn=Nn);else if(Ue<bn&&0>r(An,Qt))vt[Mn]=An,vt[Ue]=Qt,Mn=Ue;else break e}}return Bt}function r(vt,Bt){var Qt=vt.sortIndex-Bt.sortIndex;return Qt!==0?Qt:vt.id-Bt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var u=Date,a=u.now();t.unstable_now=function(){return u.now()-a}}var y=[],w=[],I=1,R=null,D=3,U=!1,q=!1,ne=!1,pe=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function re(vt){for(var Bt=n(w);Bt!==null;){if(Bt.callback===null)i(w);else if(Bt.startTime<=vt)i(w),Bt.sortIndex=Bt.expirationTime,e(y,Bt);else break;Bt=n(w)}}function ge(vt){if(ne=!1,re(vt),!q)if(n(y)!==null)q=!0,Ot(be);else{var Bt=n(w);Bt!==null&&Gn(ge,Bt.startTime-vt)}}function be(vt,Bt){q=!1,ne&&(ne=!1,J(et),et=-1),U=!0;var Qt=D;try{for(re(Bt),R=n(y);R!==null&&(!(R.expirationTime>Bt)||vt&&!at());){var Mn=R.callback;if(typeof Mn=="function"){R.callback=null,D=R.priorityLevel;var bn=Mn(R.expirationTime<=Bt);Bt=t.unstable_now(),typeof bn=="function"?R.callback=bn:R===n(y)&&i(y),re(Bt)}else i(y);R=n(y)}if(R!==null)var pn=!0;else{var Nn=n(w);Nn!==null&&Gn(ge,Nn.startTime-Bt),pn=!1}return pn}finally{R=null,D=Qt,U=!1}}var De=!1,qe=null,et=-1,ht=5,ot=-1;function at(){return!(t.unstable_now()-ot<ht)}function Mt(){if(qe!==null){var vt=t.unstable_now();ot=vt;var Bt=!0;try{Bt=qe(!0,vt)}finally{Bt?ut():(De=!1,qe=null)}}else De=!1}var ut;if(typeof ie=="function")ut=function(){ie(Mt)};else if(typeof MessageChannel<"u"){var St=new MessageChannel,Pn=St.port2;St.port1.onmessage=Mt,ut=function(){Pn.postMessage(null)}}else ut=function(){pe(Mt,0)};function Ot(vt){qe=vt,De||(De=!0,ut())}function Gn(vt,Bt){et=pe(function(){vt(t.unstable_now())},Bt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(vt){vt.callback=null},t.unstable_continueExecution=function(){q||U||(q=!0,Ot(be))},t.unstable_forceFrameRate=function(vt){0>vt||125<vt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ht=0<vt?Math.floor(1e3/vt):5},t.unstable_getCurrentPriorityLevel=function(){return D},t.unstable_getFirstCallbackNode=function(){return n(y)},t.unstable_next=function(vt){switch(D){case 1:case 2:case 3:var Bt=3;break;default:Bt=D}var Qt=D;D=Bt;try{return vt()}finally{D=Qt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(vt,Bt){switch(vt){case 1:case 2:case 3:case 4:case 5:break;default:vt=3}var Qt=D;D=vt;try{return Bt()}finally{D=Qt}},t.unstable_scheduleCallback=function(vt,Bt,Qt){var Mn=t.unstable_now();switch(typeof Qt=="object"&&Qt!==null?(Qt=Qt.delay,Qt=typeof Qt=="number"&&0<Qt?Mn+Qt:Mn):Qt=Mn,vt){case 1:var bn=-1;break;case 2:bn=250;break;case 5:bn=1073741823;break;case 4:bn=1e4;break;default:bn=5e3}return bn=Qt+bn,vt={id:I++,callback:Bt,priorityLevel:vt,startTime:Qt,expirationTime:bn,sortIndex:-1},Qt>Mn?(vt.sortIndex=Qt,e(w,vt),n(y)===null&&vt===n(w)&&(ne?(J(et),et=-1):ne=!0,Gn(ge,Qt-Mn))):(vt.sortIndex=bn,e(y,vt),q||U||(q=!0,Ot(be))),vt},t.unstable_shouldYield=at,t.unstable_wrapCallback=function(vt){var Bt=D;return function(){var Qt=D;D=Bt;try{return vt.apply(this,arguments)}finally{D=Qt}}}})(fS);hS.exports=fS;var YK=hS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AS=yt,po=YK;function xt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dS=new Set,f2={};function Cu(t,e){m1(t,e),m1(t+"Capture",e)}function m1(t,e){for(f2[t]=e,t=0;t<e.length;t++)dS.add(e[t])}var o0=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),W5=Object.prototype.hasOwnProperty,KK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ex={},tx={};function JK(t){return W5.call(tx,t)?!0:W5.call(ex,t)?!1:KK.test(t)?tx[t]=!0:(ex[t]=!0,!1)}function eJ(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function tJ(t,e,n,i){if(e===null||typeof e>"u"||eJ(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ps(t,e,n,i,r,s,u){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=u}var jr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){jr[t]=new Ps(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];jr[e]=new Ps(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){jr[t]=new Ps(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){jr[t]=new Ps(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){jr[t]=new Ps(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){jr[t]=new Ps(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){jr[t]=new Ps(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){jr[t]=new Ps(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){jr[t]=new Ps(t,5,!1,t.toLowerCase(),null,!1,!1)});var n8=/[\-:]([a-z])/g;function i8(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(n8,i8);jr[e]=new Ps(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(n8,i8);jr[e]=new Ps(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(n8,i8);jr[e]=new Ps(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){jr[t]=new Ps(t,1,!1,t.toLowerCase(),null,!1,!1)});jr.xlinkHref=new Ps("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){jr[t]=new Ps(t,1,!1,t.toLowerCase(),null,!0,!0)});function r8(t,e,n,i){var r=jr.hasOwnProperty(e)?jr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tJ(e,n,r,i)&&(n=null),i||r===null?JK(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var h0=AS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,JA=Symbol.for("react.element"),zh=Symbol.for("react.portal"),Bh=Symbol.for("react.fragment"),s8=Symbol.for("react.strict_mode"),$5=Symbol.for("react.profiler"),pS=Symbol.for("react.provider"),mS=Symbol.for("react.context"),o8=Symbol.for("react.forward_ref"),q5=Symbol.for("react.suspense"),Z5=Symbol.for("react.suspense_list"),a8=Symbol.for("react.memo"),N0=Symbol.for("react.lazy"),gS=Symbol.for("react.offscreen"),nx=Symbol.iterator;function gf(t){return t===null||typeof t!="object"?null:(t=nx&&t[nx]||t["@@iterator"],typeof t=="function"?t:null)}var Hi=Object.assign,y4;function Lf(t){if(y4===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);y4=e&&e[1]||""}return`
`+y4+t}var v4=!1;function x4(t,e){if(!t||v4)return"";v4=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(w){var i=w}Reflect.construct(t,[],e)}else{try{e.call()}catch(w){i=w}t.call(e.prototype)}else{try{throw Error()}catch(w){i=w}t()}}catch(w){if(w&&i&&typeof w.stack=="string"){for(var r=w.stack.split(`
`),s=i.stack.split(`
`),u=r.length-1,a=s.length-1;1<=u&&0<=a&&r[u]!==s[a];)a--;for(;1<=u&&0<=a;u--,a--)if(r[u]!==s[a]){if(u!==1||a!==1)do if(u--,a--,0>a||r[u]!==s[a]){var y=`
`+r[u].replace(" at new "," at ");return t.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",t.displayName)),y}while(1<=u&&0<=a);break}}}finally{v4=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Lf(t):""}function nJ(t){switch(t.tag){case 5:return Lf(t.type);case 16:return Lf("Lazy");case 13:return Lf("Suspense");case 19:return Lf("SuspenseList");case 0:case 2:case 15:return t=x4(t.type,!1),t;case 11:return t=x4(t.type.render,!1),t;case 1:return t=x4(t.type,!0),t;default:return""}}function X5(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bh:return"Fragment";case zh:return"Portal";case $5:return"Profiler";case s8:return"StrictMode";case q5:return"Suspense";case Z5:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mS:return(t.displayName||"Context")+".Consumer";case pS:return(t._context.displayName||"Context")+".Provider";case o8:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case a8:return e=t.displayName||null,e!==null?e:X5(t.type)||"Memo";case N0:e=t._payload,t=t._init;try{return X5(t(e))}catch{}}return null}function iJ(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X5(e);case 8:return e===s8?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ac(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _S(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rJ(t){var e=_S(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(u){i=""+u,s.call(this,u)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(u){i=""+u},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ed(t){t._valueTracker||(t._valueTracker=rJ(t))}function yS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=_S(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Ip(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Q5(t,e){var n=e.checked;return Hi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ix(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=ac(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vS(t,e){e=e.checked,e!=null&&r8(t,"checked",e,!1)}function Y5(t,e){vS(t,e);var n=ac(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?K5(t,e.type,n):e.hasOwnProperty("defaultValue")&&K5(t,e.type,ac(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function K5(t,e,n){(e!=="number"||Ip(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Df=Array.isArray;function Yh(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+ac(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function J5(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xt(91));return Hi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function sx(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(xt(92));if(Df(n)){if(1<n.length)throw Error(xt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ac(n)}}function xS(t,e){var n=ac(e.value),i=ac(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function ox(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function wS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function e6(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?wS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var td,bS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(td=td||document.createElement("div"),td.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=td.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function A2(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var jf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sJ=["Webkit","ms","Moz","O"];Object.keys(jf).forEach(function(t){sJ.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jf[e]=jf[t]})});function ES(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||jf.hasOwnProperty(t)&&jf[t]?(""+e).trim():e+"px"}function TS(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=ES(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var oJ=Hi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function t6(t,e){if(e){if(oJ[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xt(62))}}function n6(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var i6=null;function l8(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var r6=null,Kh=null,Jh=null;function ax(t){if(t=Z2(t)){if(typeof r6!="function")throw Error(xt(280));var e=t.stateNode;e&&(e=E3(e),r6(t.stateNode,t.type,e))}}function SS(t){Kh?Jh?Jh.push(t):Jh=[t]:Kh=t}function CS(){if(Kh){var t=Kh,e=Jh;if(Jh=Kh=null,ax(t),e)for(t=0;t<e.length;t++)ax(e[t])}}function PS(t,e){return t(e)}function MS(){}var w4=!1;function IS(t,e,n){if(w4)return t(e,n);w4=!0;try{return PS(t,e,n)}finally{w4=!1,(Kh!==null||Jh!==null)&&(MS(),CS())}}function d2(t,e){var n=t.stateNode;if(n===null)return null;var i=E3(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(xt(231,e,typeof n));return n}var s6=!1;if(o0)try{var _f={};Object.defineProperty(_f,"passive",{get:function(){s6=!0}}),window.addEventListener("test",_f,_f),window.removeEventListener("test",_f,_f)}catch{s6=!1}function aJ(t,e,n,i,r,s,u,a,y){var w=Array.prototype.slice.call(arguments,3);try{e.apply(n,w)}catch(I){this.onError(I)}}var Hf=!1,kp=null,Lp=!1,o6=null,lJ={onError:function(t){Hf=!0,kp=t}};function cJ(t,e,n,i,r,s,u,a,y){Hf=!1,kp=null,aJ.apply(lJ,arguments)}function uJ(t,e,n,i,r,s,u,a,y){if(cJ.apply(this,arguments),Hf){if(Hf){var w=kp;Hf=!1,kp=null}else throw Error(xt(198));Lp||(Lp=!0,o6=w)}}function Pu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function kS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function lx(t){if(Pu(t)!==t)throw Error(xt(188))}function hJ(t){var e=t.alternate;if(!e){if(e=Pu(t),e===null)throw Error(xt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return lx(r),t;if(s===i)return lx(r),e;s=s.sibling}throw Error(xt(188))}if(n.return!==i.return)n=r,i=s;else{for(var u=!1,a=r.child;a;){if(a===n){u=!0,n=r,i=s;break}if(a===i){u=!0,i=r,n=s;break}a=a.sibling}if(!u){for(a=s.child;a;){if(a===n){u=!0,n=s,i=r;break}if(a===i){u=!0,i=s,n=r;break}a=a.sibling}if(!u)throw Error(xt(189))}}if(n.alternate!==i)throw Error(xt(190))}if(n.tag!==3)throw Error(xt(188));return n.stateNode.current===n?t:e}function LS(t){return t=hJ(t),t!==null?DS(t):null}function DS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=DS(t);if(e!==null)return e;t=t.sibling}return null}var RS=po.unstable_scheduleCallback,cx=po.unstable_cancelCallback,fJ=po.unstable_shouldYield,AJ=po.unstable_requestPaint,rr=po.unstable_now,dJ=po.unstable_getCurrentPriorityLevel,c8=po.unstable_ImmediatePriority,zS=po.unstable_UserBlockingPriority,Dp=po.unstable_NormalPriority,pJ=po.unstable_LowPriority,BS=po.unstable_IdlePriority,v3=null,Ja=null;function mJ(t){if(Ja&&typeof Ja.onCommitFiberRoot=="function")try{Ja.onCommitFiberRoot(v3,t,void 0,(t.current.flags&128)===128)}catch{}}var pa=Math.clz32?Math.clz32:yJ,gJ=Math.log,_J=Math.LN2;function yJ(t){return t>>>=0,t===0?32:31-(gJ(t)/_J|0)|0}var nd=64,id=4194304;function Rf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Rp(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,u=n&268435455;if(u!==0){var a=u&~r;a!==0?i=Rf(a):(s&=u,s!==0&&(i=Rf(s)))}else u=n&~r,u!==0?i=Rf(u):s!==0&&(i=Rf(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-pa(e),r=1<<n,i|=t[n],e&=~r;return i}function vJ(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xJ(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var u=31-pa(s),a=1<<u,y=r[u];y===-1?(!(a&n)||a&i)&&(r[u]=vJ(a,e)):y<=e&&(t.expiredLanes|=a),s&=~a}}function a6(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function OS(){var t=nd;return nd<<=1,!(nd&4194240)&&(nd=64),t}function b4(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function $2(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pa(e),t[e]=n}function wJ(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-pa(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function u8(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-pa(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var gi=0;function FS(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var NS,h8,US,VS,GS,l6=!1,rd=[],Q0=null,Y0=null,K0=null,p2=new Map,m2=new Map,V0=[],bJ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ux(t,e){switch(t){case"focusin":case"focusout":Q0=null;break;case"dragenter":case"dragleave":Y0=null;break;case"mouseover":case"mouseout":K0=null;break;case"pointerover":case"pointerout":p2.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":m2.delete(e.pointerId)}}function yf(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Z2(e),e!==null&&h8(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function EJ(t,e,n,i,r){switch(e){case"focusin":return Q0=yf(Q0,t,e,n,i,r),!0;case"dragenter":return Y0=yf(Y0,t,e,n,i,r),!0;case"mouseover":return K0=yf(K0,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return p2.set(s,yf(p2.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,m2.set(s,yf(m2.get(s)||null,t,e,n,i,r)),!0}return!1}function jS(t){var e=Yc(t.target);if(e!==null){var n=Pu(e);if(n!==null){if(e=n.tag,e===13){if(e=kS(n),e!==null){t.blockedOn=e,GS(t.priority,function(){US(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Fd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=c6(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);i6=i,n.target.dispatchEvent(i),i6=null}else return e=Z2(n),e!==null&&h8(e),t.blockedOn=n,!1;e.shift()}return!0}function hx(t,e,n){Fd(t)&&n.delete(e)}function TJ(){l6=!1,Q0!==null&&Fd(Q0)&&(Q0=null),Y0!==null&&Fd(Y0)&&(Y0=null),K0!==null&&Fd(K0)&&(K0=null),p2.forEach(hx),m2.forEach(hx)}function vf(t,e){t.blockedOn===e&&(t.blockedOn=null,l6||(l6=!0,po.unstable_scheduleCallback(po.unstable_NormalPriority,TJ)))}function g2(t){function e(r){return vf(r,t)}if(0<rd.length){vf(rd[0],t);for(var n=1;n<rd.length;n++){var i=rd[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Q0!==null&&vf(Q0,t),Y0!==null&&vf(Y0,t),K0!==null&&vf(K0,t),p2.forEach(e),m2.forEach(e),n=0;n<V0.length;n++)i=V0[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<V0.length&&(n=V0[0],n.blockedOn===null);)jS(n),n.blockedOn===null&&V0.shift()}var e1=h0.ReactCurrentBatchConfig,zp=!0;function SJ(t,e,n,i){var r=gi,s=e1.transition;e1.transition=null;try{gi=1,f8(t,e,n,i)}finally{gi=r,e1.transition=s}}function CJ(t,e,n,i){var r=gi,s=e1.transition;e1.transition=null;try{gi=4,f8(t,e,n,i)}finally{gi=r,e1.transition=s}}function f8(t,e,n,i){if(zp){var r=c6(t,e,n,i);if(r===null)D4(t,e,i,Bp,n),ux(t,i);else if(EJ(r,t,e,n,i))i.stopPropagation();else if(ux(t,i),e&4&&-1<bJ.indexOf(t)){for(;r!==null;){var s=Z2(r);if(s!==null&&NS(s),s=c6(t,e,n,i),s===null&&D4(t,e,i,Bp,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else D4(t,e,i,null,n)}}var Bp=null;function c6(t,e,n,i){if(Bp=null,t=l8(i),t=Yc(t),t!==null)if(e=Pu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=kS(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Bp=t,null}function HS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dJ()){case c8:return 1;case zS:return 4;case Dp:case pJ:return 16;case BS:return 536870912;default:return 16}default:return 16}}var $0=null,A8=null,Nd=null;function WS(){if(Nd)return Nd;var t,e=A8,n=e.length,i,r="value"in $0?$0.value:$0.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var u=n-t;for(i=1;i<=u&&e[n-i]===r[s-i];i++);return Nd=r.slice(t,1<i?1-i:void 0)}function Ud(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function sd(){return!0}function fx(){return!1}function _o(t){function e(n,i,r,s,u){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=u,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?sd:fx,this.isPropagationStopped=fx,this}return Hi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=sd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=sd)},persist:function(){},isPersistent:sd}),e}var D1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},d8=_o(D1),q2=Hi({},D1,{view:0,detail:0}),PJ=_o(q2),E4,T4,xf,x3=Hi({},q2,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p8,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xf&&(xf&&t.type==="mousemove"?(E4=t.screenX-xf.screenX,T4=t.screenY-xf.screenY):T4=E4=0,xf=t),E4)},movementY:function(t){return"movementY"in t?t.movementY:T4}}),Ax=_o(x3),MJ=Hi({},x3,{dataTransfer:0}),IJ=_o(MJ),kJ=Hi({},q2,{relatedTarget:0}),S4=_o(kJ),LJ=Hi({},D1,{animationName:0,elapsedTime:0,pseudoElement:0}),DJ=_o(LJ),RJ=Hi({},D1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),zJ=_o(RJ),BJ=Hi({},D1,{data:0}),dx=_o(BJ),OJ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FJ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},NJ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UJ(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=NJ[t])?!!e[t]:!1}function p8(){return UJ}var VJ=Hi({},q2,{key:function(t){if(t.key){var e=OJ[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ud(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?FJ[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p8,charCode:function(t){return t.type==="keypress"?Ud(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ud(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),GJ=_o(VJ),jJ=Hi({},x3,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),px=_o(jJ),HJ=Hi({},q2,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p8}),WJ=_o(HJ),$J=Hi({},D1,{propertyName:0,elapsedTime:0,pseudoElement:0}),qJ=_o($J),ZJ=Hi({},x3,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),XJ=_o(ZJ),QJ=[9,13,27,32],m8=o0&&"CompositionEvent"in window,Wf=null;o0&&"documentMode"in document&&(Wf=document.documentMode);var YJ=o0&&"TextEvent"in window&&!Wf,$S=o0&&(!m8||Wf&&8<Wf&&11>=Wf),mx=String.fromCharCode(32),gx=!1;function qS(t,e){switch(t){case"keyup":return QJ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Oh=!1;function KJ(t,e){switch(t){case"compositionend":return ZS(e);case"keypress":return e.which!==32?null:(gx=!0,mx);case"textInput":return t=e.data,t===mx&&gx?null:t;default:return null}}function JJ(t,e){if(Oh)return t==="compositionend"||!m8&&qS(t,e)?(t=WS(),Nd=A8=$0=null,Oh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $S&&e.locale!=="ko"?null:e.data;default:return null}}var eee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _x(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!eee[t.type]:e==="textarea"}function XS(t,e,n,i){SS(i),e=Op(e,"onChange"),0<e.length&&(n=new d8("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var $f=null,_2=null;function tee(t){oC(t,0)}function w3(t){var e=Uh(t);if(yS(e))return t}function nee(t,e){if(t==="change")return e}var QS=!1;if(o0){var C4;if(o0){var P4="oninput"in document;if(!P4){var yx=document.createElement("div");yx.setAttribute("oninput","return;"),P4=typeof yx.oninput=="function"}C4=P4}else C4=!1;QS=C4&&(!document.documentMode||9<document.documentMode)}function vx(){$f&&($f.detachEvent("onpropertychange",YS),_2=$f=null)}function YS(t){if(t.propertyName==="value"&&w3(_2)){var e=[];XS(e,_2,t,l8(t)),IS(tee,e)}}function iee(t,e,n){t==="focusin"?(vx(),$f=e,_2=n,$f.attachEvent("onpropertychange",YS)):t==="focusout"&&vx()}function ree(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return w3(_2)}function see(t,e){if(t==="click")return w3(e)}function oee(t,e){if(t==="input"||t==="change")return w3(e)}function aee(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ya=typeof Object.is=="function"?Object.is:aee;function y2(t,e){if(ya(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!W5.call(e,r)||!ya(t[r],e[r]))return!1}return!0}function xx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function wx(t,e){var n=xx(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=xx(n)}}function KS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?KS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function JS(){for(var t=window,e=Ip();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ip(t.document)}return e}function g8(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function lee(t){var e=JS(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&KS(n.ownerDocument.documentElement,n)){if(i!==null&&g8(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=wx(n,s);var u=wx(n,i);r&&u&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==u.node||t.focusOffset!==u.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(u.node,u.offset)):(e.setEnd(u.node,u.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var cee=o0&&"documentMode"in document&&11>=document.documentMode,Fh=null,u6=null,qf=null,h6=!1;function bx(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;h6||Fh==null||Fh!==Ip(i)||(i=Fh,"selectionStart"in i&&g8(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),qf&&y2(qf,i)||(qf=i,i=Op(u6,"onSelect"),0<i.length&&(e=new d8("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Fh)))}function od(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Nh={animationend:od("Animation","AnimationEnd"),animationiteration:od("Animation","AnimationIteration"),animationstart:od("Animation","AnimationStart"),transitionend:od("Transition","TransitionEnd")},M4={},eC={};o0&&(eC=document.createElement("div").style,"AnimationEvent"in window||(delete Nh.animationend.animation,delete Nh.animationiteration.animation,delete Nh.animationstart.animation),"TransitionEvent"in window||delete Nh.transitionend.transition);function b3(t){if(M4[t])return M4[t];if(!Nh[t])return t;var e=Nh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eC)return M4[t]=e[n];return t}var tC=b3("animationend"),nC=b3("animationiteration"),iC=b3("animationstart"),rC=b3("transitionend"),sC=new Map,Ex="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cc(t,e){sC.set(t,e),Cu(e,[t])}for(var I4=0;I4<Ex.length;I4++){var k4=Ex[I4],uee=k4.toLowerCase(),hee=k4[0].toUpperCase()+k4.slice(1);cc(uee,"on"+hee)}cc(tC,"onAnimationEnd");cc(nC,"onAnimationIteration");cc(iC,"onAnimationStart");cc("dblclick","onDoubleClick");cc("focusin","onFocus");cc("focusout","onBlur");cc(rC,"onTransitionEnd");m1("onMouseEnter",["mouseout","mouseover"]);m1("onMouseLeave",["mouseout","mouseover"]);m1("onPointerEnter",["pointerout","pointerover"]);m1("onPointerLeave",["pointerout","pointerover"]);Cu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fee=new Set("cancel close invalid load scroll toggle".split(" ").concat(zf));function Tx(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,uJ(i,e,void 0,t),t.currentTarget=null}function oC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var u=i.length-1;0<=u;u--){var a=i[u],y=a.instance,w=a.currentTarget;if(a=a.listener,y!==s&&r.isPropagationStopped())break e;Tx(r,a,w),s=y}else for(u=0;u<i.length;u++){if(a=i[u],y=a.instance,w=a.currentTarget,a=a.listener,y!==s&&r.isPropagationStopped())break e;Tx(r,a,w),s=y}}}if(Lp)throw t=o6,Lp=!1,o6=null,t}function Di(t,e){var n=e[m6];n===void 0&&(n=e[m6]=new Set);var i=t+"__bubble";n.has(i)||(aC(e,t,2,!1),n.add(i))}function L4(t,e,n){var i=0;e&&(i|=4),aC(n,t,i,e)}var ad="_reactListening"+Math.random().toString(36).slice(2);function v2(t){if(!t[ad]){t[ad]=!0,dS.forEach(function(n){n!=="selectionchange"&&(fee.has(n)||L4(n,!1,t),L4(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ad]||(e[ad]=!0,L4("selectionchange",!1,e))}}function aC(t,e,n,i){switch(HS(e)){case 1:var r=SJ;break;case 4:r=CJ;break;default:r=f8}n=r.bind(null,e,n,t),r=void 0,!s6||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function D4(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var u=i.tag;if(u===3||u===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(u===4)for(u=i.return;u!==null;){var y=u.tag;if((y===3||y===4)&&(y=u.stateNode.containerInfo,y===r||y.nodeType===8&&y.parentNode===r))return;u=u.return}for(;a!==null;){if(u=Yc(a),u===null)return;if(y=u.tag,y===5||y===6){i=s=u;continue e}a=a.parentNode}}i=i.return}IS(function(){var w=s,I=l8(n),R=[];e:{var D=sC.get(t);if(D!==void 0){var U=d8,q=t;switch(t){case"keypress":if(Ud(n)===0)break e;case"keydown":case"keyup":U=GJ;break;case"focusin":q="focus",U=S4;break;case"focusout":q="blur",U=S4;break;case"beforeblur":case"afterblur":U=S4;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=Ax;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=IJ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=WJ;break;case tC:case nC:case iC:U=DJ;break;case rC:U=qJ;break;case"scroll":U=PJ;break;case"wheel":U=XJ;break;case"copy":case"cut":case"paste":U=zJ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=px}var ne=(e&4)!==0,pe=!ne&&t==="scroll",J=ne?D!==null?D+"Capture":null:D;ne=[];for(var ie=w,re;ie!==null;){re=ie;var ge=re.stateNode;if(re.tag===5&&ge!==null&&(re=ge,J!==null&&(ge=d2(ie,J),ge!=null&&ne.push(x2(ie,ge,re)))),pe)break;ie=ie.return}0<ne.length&&(D=new U(D,q,null,n,I),R.push({event:D,listeners:ne}))}}if(!(e&7)){e:{if(D=t==="mouseover"||t==="pointerover",U=t==="mouseout"||t==="pointerout",D&&n!==i6&&(q=n.relatedTarget||n.fromElement)&&(Yc(q)||q[a0]))break e;if((U||D)&&(D=I.window===I?I:(D=I.ownerDocument)?D.defaultView||D.parentWindow:window,U?(q=n.relatedTarget||n.toElement,U=w,q=q?Yc(q):null,q!==null&&(pe=Pu(q),q!==pe||q.tag!==5&&q.tag!==6)&&(q=null)):(U=null,q=w),U!==q)){if(ne=Ax,ge="onMouseLeave",J="onMouseEnter",ie="mouse",(t==="pointerout"||t==="pointerover")&&(ne=px,ge="onPointerLeave",J="onPointerEnter",ie="pointer"),pe=U==null?D:Uh(U),re=q==null?D:Uh(q),D=new ne(ge,ie+"leave",U,n,I),D.target=pe,D.relatedTarget=re,ge=null,Yc(I)===w&&(ne=new ne(J,ie+"enter",q,n,I),ne.target=re,ne.relatedTarget=pe,ge=ne),pe=ge,U&&q)t:{for(ne=U,J=q,ie=0,re=ne;re;re=bh(re))ie++;for(re=0,ge=J;ge;ge=bh(ge))re++;for(;0<ie-re;)ne=bh(ne),ie--;for(;0<re-ie;)J=bh(J),re--;for(;ie--;){if(ne===J||J!==null&&ne===J.alternate)break t;ne=bh(ne),J=bh(J)}ne=null}else ne=null;U!==null&&Sx(R,D,U,ne,!1),q!==null&&pe!==null&&Sx(R,pe,q,ne,!0)}}e:{if(D=w?Uh(w):window,U=D.nodeName&&D.nodeName.toLowerCase(),U==="select"||U==="input"&&D.type==="file")var be=nee;else if(_x(D))if(QS)be=oee;else{be=ree;var De=iee}else(U=D.nodeName)&&U.toLowerCase()==="input"&&(D.type==="checkbox"||D.type==="radio")&&(be=see);if(be&&(be=be(t,w))){XS(R,be,n,I);break e}De&&De(t,D,w),t==="focusout"&&(De=D._wrapperState)&&De.controlled&&D.type==="number"&&K5(D,"number",D.value)}switch(De=w?Uh(w):window,t){case"focusin":(_x(De)||De.contentEditable==="true")&&(Fh=De,u6=w,qf=null);break;case"focusout":qf=u6=Fh=null;break;case"mousedown":h6=!0;break;case"contextmenu":case"mouseup":case"dragend":h6=!1,bx(R,n,I);break;case"selectionchange":if(cee)break;case"keydown":case"keyup":bx(R,n,I)}var qe;if(m8)e:{switch(t){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else Oh?qS(t,n)&&(et="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(et="onCompositionStart");et&&($S&&n.locale!=="ko"&&(Oh||et!=="onCompositionStart"?et==="onCompositionEnd"&&Oh&&(qe=WS()):($0=I,A8="value"in $0?$0.value:$0.textContent,Oh=!0)),De=Op(w,et),0<De.length&&(et=new dx(et,t,null,n,I),R.push({event:et,listeners:De}),qe?et.data=qe:(qe=ZS(n),qe!==null&&(et.data=qe)))),(qe=YJ?KJ(t,n):JJ(t,n))&&(w=Op(w,"onBeforeInput"),0<w.length&&(I=new dx("onBeforeInput","beforeinput",null,n,I),R.push({event:I,listeners:w}),I.data=qe))}oC(R,e)})}function x2(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Op(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=d2(t,n),s!=null&&i.unshift(x2(t,s,r)),s=d2(t,e),s!=null&&i.push(x2(t,s,r))),t=t.return}return i}function bh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Sx(t,e,n,i,r){for(var s=e._reactName,u=[];n!==null&&n!==i;){var a=n,y=a.alternate,w=a.stateNode;if(y!==null&&y===i)break;a.tag===5&&w!==null&&(a=w,r?(y=d2(n,s),y!=null&&u.unshift(x2(n,y,a))):r||(y=d2(n,s),y!=null&&u.push(x2(n,y,a)))),n=n.return}u.length!==0&&t.push({event:e,listeners:u})}var Aee=/\r\n?/g,dee=/\u0000|\uFFFD/g;function Cx(t){return(typeof t=="string"?t:""+t).replace(Aee,`
`).replace(dee,"")}function ld(t,e,n){if(e=Cx(e),Cx(t)!==e&&n)throw Error(xt(425))}function Fp(){}var f6=null,A6=null;function d6(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var p6=typeof setTimeout=="function"?setTimeout:void 0,pee=typeof clearTimeout=="function"?clearTimeout:void 0,Px=typeof Promise=="function"?Promise:void 0,mee=typeof queueMicrotask=="function"?queueMicrotask:typeof Px<"u"?function(t){return Px.resolve(null).then(t).catch(gee)}:p6;function gee(t){setTimeout(function(){throw t})}function R4(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),g2(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);g2(e)}function J0(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Mx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var R1=Math.random().toString(36).slice(2),Xa="__reactFiber$"+R1,w2="__reactProps$"+R1,a0="__reactContainer$"+R1,m6="__reactEvents$"+R1,_ee="__reactListeners$"+R1,yee="__reactHandles$"+R1;function Yc(t){var e=t[Xa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[a0]||n[Xa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Mx(t);t!==null;){if(n=t[Xa])return n;t=Mx(t)}return e}t=n,n=t.parentNode}return null}function Z2(t){return t=t[Xa]||t[a0],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Uh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(xt(33))}function E3(t){return t[w2]||null}var g6=[],Vh=-1;function uc(t){return{current:t}}function Ri(t){0>Vh||(t.current=g6[Vh],g6[Vh]=null,Vh--)}function Mi(t,e){Vh++,g6[Vh]=t.current,t.current=e}var lc={},cs=uc(lc),Gs=uc(!1),du=lc;function g1(t,e){var n=t.type.contextTypes;if(!n)return lc;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function js(t){return t=t.childContextTypes,t!=null}function Np(){Ri(Gs),Ri(cs)}function Ix(t,e,n){if(cs.current!==lc)throw Error(xt(168));Mi(cs,e),Mi(Gs,n)}function lC(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(xt(108,iJ(t)||"Unknown",r));return Hi({},n,i)}function Up(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||lc,du=cs.current,Mi(cs,t),Mi(Gs,Gs.current),!0}function kx(t,e,n){var i=t.stateNode;if(!i)throw Error(xt(169));n?(t=lC(t,e,du),i.__reactInternalMemoizedMergedChildContext=t,Ri(Gs),Ri(cs),Mi(cs,t)):Ri(Gs),Mi(Gs,n)}var Vl=null,T3=!1,z4=!1;function cC(t){Vl===null?Vl=[t]:Vl.push(t)}function vee(t){T3=!0,cC(t)}function hc(){if(!z4&&Vl!==null){z4=!0;var t=0,e=gi;try{var n=Vl;for(gi=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Vl=null,T3=!1}catch(r){throw Vl!==null&&(Vl=Vl.slice(t+1)),RS(c8,hc),r}finally{gi=e,z4=!1}}return null}var Gh=[],jh=0,Vp=null,Gp=0,zo=[],Bo=0,pu=null,ql=1,Zl="";function qc(t,e){Gh[jh++]=Gp,Gh[jh++]=Vp,Vp=t,Gp=e}function uC(t,e,n){zo[Bo++]=ql,zo[Bo++]=Zl,zo[Bo++]=pu,pu=t;var i=ql;t=Zl;var r=32-pa(i)-1;i&=~(1<<r),n+=1;var s=32-pa(e)+r;if(30<s){var u=r-r%5;s=(i&(1<<u)-1).toString(32),i>>=u,r-=u,ql=1<<32-pa(e)+r|n<<r|i,Zl=s+t}else ql=1<<s|n<<r|i,Zl=t}function _8(t){t.return!==null&&(qc(t,1),uC(t,1,0))}function y8(t){for(;t===Vp;)Vp=Gh[--jh],Gh[jh]=null,Gp=Gh[--jh],Gh[jh]=null;for(;t===pu;)pu=zo[--Bo],zo[Bo]=null,Zl=zo[--Bo],zo[Bo]=null,ql=zo[--Bo],zo[Bo]=null}var Ao=null,ho=null,Fi=!1,ca=null;function hC(t,e){var n=Fo(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Lx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ao=t,ho=J0(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ao=t,ho=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pu!==null?{id:ql,overflow:Zl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Fo(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ao=t,ho=null,!0):!1;default:return!1}}function _6(t){return(t.mode&1)!==0&&(t.flags&128)===0}function y6(t){if(Fi){var e=ho;if(e){var n=e;if(!Lx(t,e)){if(_6(t))throw Error(xt(418));e=J0(n.nextSibling);var i=Ao;e&&Lx(t,e)?hC(i,n):(t.flags=t.flags&-4097|2,Fi=!1,Ao=t)}}else{if(_6(t))throw Error(xt(418));t.flags=t.flags&-4097|2,Fi=!1,Ao=t}}}function Dx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ao=t}function cd(t){if(t!==Ao)return!1;if(!Fi)return Dx(t),Fi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!d6(t.type,t.memoizedProps)),e&&(e=ho)){if(_6(t))throw fC(),Error(xt(418));for(;e;)hC(t,e),e=J0(e.nextSibling)}if(Dx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(xt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ho=J0(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ho=null}}else ho=Ao?J0(t.stateNode.nextSibling):null;return!0}function fC(){for(var t=ho;t;)t=J0(t.nextSibling)}function _1(){ho=Ao=null,Fi=!1}function v8(t){ca===null?ca=[t]:ca.push(t)}var xee=h0.ReactCurrentBatchConfig;function oa(t,e){if(t&&t.defaultProps){e=Hi({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var jp=uc(null),Hp=null,Hh=null,x8=null;function w8(){x8=Hh=Hp=null}function b8(t){var e=jp.current;Ri(jp),t._currentValue=e}function v6(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function t1(t,e){Hp=t,x8=Hh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Us=!0),t.firstContext=null)}function Vo(t){var e=t._currentValue;if(x8!==t)if(t={context:t,memoizedValue:e,next:null},Hh===null){if(Hp===null)throw Error(xt(308));Hh=t,Hp.dependencies={lanes:0,firstContext:t}}else Hh=Hh.next=t;return e}var Kc=null;function E8(t){Kc===null?Kc=[t]:Kc.push(t)}function AC(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,E8(e)):(n.next=r.next,r.next=n),e.interleaved=n,l0(t,i)}function l0(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var U0=!1;function T8(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ec(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,ai&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,l0(t,n)}return r=i.interleaved,r===null?(e.next=e,E8(i)):(e.next=r.next,r.next=e),i.interleaved=e,l0(t,n)}function Vd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,u8(t,n)}}function Rx(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var u={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=u:s=s.next=u,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Wp(t,e,n,i){var r=t.updateQueue;U0=!1;var s=r.firstBaseUpdate,u=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var y=a,w=y.next;y.next=null,u===null?s=w:u.next=w,u=y;var I=t.alternate;I!==null&&(I=I.updateQueue,a=I.lastBaseUpdate,a!==u&&(a===null?I.firstBaseUpdate=w:a.next=w,I.lastBaseUpdate=y))}if(s!==null){var R=r.baseState;u=0,I=w=y=null,a=s;do{var D=a.lane,U=a.eventTime;if((i&D)===D){I!==null&&(I=I.next={eventTime:U,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var q=t,ne=a;switch(D=e,U=n,ne.tag){case 1:if(q=ne.payload,typeof q=="function"){R=q.call(U,R,D);break e}R=q;break e;case 3:q.flags=q.flags&-65537|128;case 0:if(q=ne.payload,D=typeof q=="function"?q.call(U,R,D):q,D==null)break e;R=Hi({},R,D);break e;case 2:U0=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,D=r.effects,D===null?r.effects=[a]:D.push(a))}else U={eventTime:U,lane:D,tag:a.tag,payload:a.payload,callback:a.callback,next:null},I===null?(w=I=U,y=R):I=I.next=U,u|=D;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;D=a,a=D.next,D.next=null,r.lastBaseUpdate=D,r.shared.pending=null}}while(1);if(I===null&&(y=R),r.baseState=y,r.firstBaseUpdate=w,r.lastBaseUpdate=I,e=r.shared.interleaved,e!==null){r=e;do u|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);gu|=u,t.lanes=u,t.memoizedState=R}}function zx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(xt(191,r));r.call(i)}}}var pC=new AS.Component().refs;function x6(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Hi({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var S3={isMounted:function(t){return(t=t._reactInternals)?Pu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Ts(),r=nc(t),s=Yl(i,r);s.payload=e,n!=null&&(s.callback=n),e=ec(t,s,r),e!==null&&(ma(e,t,r,i),Vd(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Ts(),r=nc(t),s=Yl(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ec(t,s,r),e!==null&&(ma(e,t,r,i),Vd(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ts(),i=nc(t),r=Yl(n,i);r.tag=2,e!=null&&(r.callback=e),e=ec(t,r,i),e!==null&&(ma(e,t,i,n),Vd(e,t,i))}};function Bx(t,e,n,i,r,s,u){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,u):e.prototype&&e.prototype.isPureReactComponent?!y2(n,i)||!y2(r,s):!0}function mC(t,e,n){var i=!1,r=lc,s=e.contextType;return typeof s=="object"&&s!==null?s=Vo(s):(r=js(e)?du:cs.current,i=e.contextTypes,s=(i=i!=null)?g1(t,r):lc),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=S3,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function Ox(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&S3.enqueueReplaceState(e,e.state,null)}function w6(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=pC,T8(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Vo(s):(s=js(e)?du:cs.current,r.context=g1(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(x6(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&S3.enqueueReplaceState(r,r.state,null),Wp(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function wf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(xt(309));var i=n.stateNode}if(!i)throw Error(xt(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(u){var a=r.refs;a===pC&&(a=r.refs={}),u===null?delete a[s]:a[s]=u},e._stringRef=s,e)}if(typeof t!="string")throw Error(xt(284));if(!n._owner)throw Error(xt(290,t))}return t}function ud(t,e){throw t=Object.prototype.toString.call(e),Error(xt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Fx(t){var e=t._init;return e(t._payload)}function gC(t){function e(J,ie){if(t){var re=J.deletions;re===null?(J.deletions=[ie],J.flags|=16):re.push(ie)}}function n(J,ie){if(!t)return null;for(;ie!==null;)e(J,ie),ie=ie.sibling;return null}function i(J,ie){for(J=new Map;ie!==null;)ie.key!==null?J.set(ie.key,ie):J.set(ie.index,ie),ie=ie.sibling;return J}function r(J,ie){return J=ic(J,ie),J.index=0,J.sibling=null,J}function s(J,ie,re){return J.index=re,t?(re=J.alternate,re!==null?(re=re.index,re<ie?(J.flags|=2,ie):re):(J.flags|=2,ie)):(J.flags|=1048576,ie)}function u(J){return t&&J.alternate===null&&(J.flags|=2),J}function a(J,ie,re,ge){return ie===null||ie.tag!==6?(ie=G4(re,J.mode,ge),ie.return=J,ie):(ie=r(ie,re),ie.return=J,ie)}function y(J,ie,re,ge){var be=re.type;return be===Bh?I(J,ie,re.props.children,ge,re.key):ie!==null&&(ie.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===N0&&Fx(be)===ie.type)?(ge=r(ie,re.props),ge.ref=wf(J,ie,re),ge.return=J,ge):(ge=qd(re.type,re.key,re.props,null,J.mode,ge),ge.ref=wf(J,ie,re),ge.return=J,ge)}function w(J,ie,re,ge){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==re.containerInfo||ie.stateNode.implementation!==re.implementation?(ie=j4(re,J.mode,ge),ie.return=J,ie):(ie=r(ie,re.children||[]),ie.return=J,ie)}function I(J,ie,re,ge,be){return ie===null||ie.tag!==7?(ie=iu(re,J.mode,ge,be),ie.return=J,ie):(ie=r(ie,re),ie.return=J,ie)}function R(J,ie,re){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=G4(""+ie,J.mode,re),ie.return=J,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case JA:return re=qd(ie.type,ie.key,ie.props,null,J.mode,re),re.ref=wf(J,null,ie),re.return=J,re;case zh:return ie=j4(ie,J.mode,re),ie.return=J,ie;case N0:var ge=ie._init;return R(J,ge(ie._payload),re)}if(Df(ie)||gf(ie))return ie=iu(ie,J.mode,re,null),ie.return=J,ie;ud(J,ie)}return null}function D(J,ie,re,ge){var be=ie!==null?ie.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return be!==null?null:a(J,ie,""+re,ge);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case JA:return re.key===be?y(J,ie,re,ge):null;case zh:return re.key===be?w(J,ie,re,ge):null;case N0:return be=re._init,D(J,ie,be(re._payload),ge)}if(Df(re)||gf(re))return be!==null?null:I(J,ie,re,ge,null);ud(J,re)}return null}function U(J,ie,re,ge,be){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return J=J.get(re)||null,a(ie,J,""+ge,be);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case JA:return J=J.get(ge.key===null?re:ge.key)||null,y(ie,J,ge,be);case zh:return J=J.get(ge.key===null?re:ge.key)||null,w(ie,J,ge,be);case N0:var De=ge._init;return U(J,ie,re,De(ge._payload),be)}if(Df(ge)||gf(ge))return J=J.get(re)||null,I(ie,J,ge,be,null);ud(ie,ge)}return null}function q(J,ie,re,ge){for(var be=null,De=null,qe=ie,et=ie=0,ht=null;qe!==null&&et<re.length;et++){qe.index>et?(ht=qe,qe=null):ht=qe.sibling;var ot=D(J,qe,re[et],ge);if(ot===null){qe===null&&(qe=ht);break}t&&qe&&ot.alternate===null&&e(J,qe),ie=s(ot,ie,et),De===null?be=ot:De.sibling=ot,De=ot,qe=ht}if(et===re.length)return n(J,qe),Fi&&qc(J,et),be;if(qe===null){for(;et<re.length;et++)qe=R(J,re[et],ge),qe!==null&&(ie=s(qe,ie,et),De===null?be=qe:De.sibling=qe,De=qe);return Fi&&qc(J,et),be}for(qe=i(J,qe);et<re.length;et++)ht=U(qe,J,et,re[et],ge),ht!==null&&(t&&ht.alternate!==null&&qe.delete(ht.key===null?et:ht.key),ie=s(ht,ie,et),De===null?be=ht:De.sibling=ht,De=ht);return t&&qe.forEach(function(at){return e(J,at)}),Fi&&qc(J,et),be}function ne(J,ie,re,ge){var be=gf(re);if(typeof be!="function")throw Error(xt(150));if(re=be.call(re),re==null)throw Error(xt(151));for(var De=be=null,qe=ie,et=ie=0,ht=null,ot=re.next();qe!==null&&!ot.done;et++,ot=re.next()){qe.index>et?(ht=qe,qe=null):ht=qe.sibling;var at=D(J,qe,ot.value,ge);if(at===null){qe===null&&(qe=ht);break}t&&qe&&at.alternate===null&&e(J,qe),ie=s(at,ie,et),De===null?be=at:De.sibling=at,De=at,qe=ht}if(ot.done)return n(J,qe),Fi&&qc(J,et),be;if(qe===null){for(;!ot.done;et++,ot=re.next())ot=R(J,ot.value,ge),ot!==null&&(ie=s(ot,ie,et),De===null?be=ot:De.sibling=ot,De=ot);return Fi&&qc(J,et),be}for(qe=i(J,qe);!ot.done;et++,ot=re.next())ot=U(qe,J,et,ot.value,ge),ot!==null&&(t&&ot.alternate!==null&&qe.delete(ot.key===null?et:ot.key),ie=s(ot,ie,et),De===null?be=ot:De.sibling=ot,De=ot);return t&&qe.forEach(function(Mt){return e(J,Mt)}),Fi&&qc(J,et),be}function pe(J,ie,re,ge){if(typeof re=="object"&&re!==null&&re.type===Bh&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case JA:e:{for(var be=re.key,De=ie;De!==null;){if(De.key===be){if(be=re.type,be===Bh){if(De.tag===7){n(J,De.sibling),ie=r(De,re.props.children),ie.return=J,J=ie;break e}}else if(De.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===N0&&Fx(be)===De.type){n(J,De.sibling),ie=r(De,re.props),ie.ref=wf(J,De,re),ie.return=J,J=ie;break e}n(J,De);break}else e(J,De);De=De.sibling}re.type===Bh?(ie=iu(re.props.children,J.mode,ge,re.key),ie.return=J,J=ie):(ge=qd(re.type,re.key,re.props,null,J.mode,ge),ge.ref=wf(J,ie,re),ge.return=J,J=ge)}return u(J);case zh:e:{for(De=re.key;ie!==null;){if(ie.key===De)if(ie.tag===4&&ie.stateNode.containerInfo===re.containerInfo&&ie.stateNode.implementation===re.implementation){n(J,ie.sibling),ie=r(ie,re.children||[]),ie.return=J,J=ie;break e}else{n(J,ie);break}else e(J,ie);ie=ie.sibling}ie=j4(re,J.mode,ge),ie.return=J,J=ie}return u(J);case N0:return De=re._init,pe(J,ie,De(re._payload),ge)}if(Df(re))return q(J,ie,re,ge);if(gf(re))return ne(J,ie,re,ge);ud(J,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,ie!==null&&ie.tag===6?(n(J,ie.sibling),ie=r(ie,re),ie.return=J,J=ie):(n(J,ie),ie=G4(re,J.mode,ge),ie.return=J,J=ie),u(J)):n(J,ie)}return pe}var y1=gC(!0),_C=gC(!1),X2={},el=uc(X2),b2=uc(X2),E2=uc(X2);function Jc(t){if(t===X2)throw Error(xt(174));return t}function S8(t,e){switch(Mi(E2,e),Mi(b2,t),Mi(el,X2),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:e6(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=e6(e,t)}Ri(el),Mi(el,e)}function v1(){Ri(el),Ri(b2),Ri(E2)}function yC(t){Jc(E2.current);var e=Jc(el.current),n=e6(e,t.type);e!==n&&(Mi(b2,t),Mi(el,n))}function C8(t){b2.current===t&&(Ri(el),Ri(b2))}var Vi=uc(0);function $p(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var B4=[];function P8(){for(var t=0;t<B4.length;t++)B4[t]._workInProgressVersionPrimary=null;B4.length=0}var Gd=h0.ReactCurrentDispatcher,O4=h0.ReactCurrentBatchConfig,mu=0,ji=null,_r=null,Pr=null,qp=!1,Zf=!1,T2=0,wee=0;function ts(){throw Error(xt(321))}function M8(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ya(t[n],e[n]))return!1;return!0}function I8(t,e,n,i,r,s){if(mu=s,ji=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Gd.current=t===null||t.memoizedState===null?See:Cee,t=n(i,r),Zf){s=0;do{if(Zf=!1,T2=0,25<=s)throw Error(xt(301));s+=1,Pr=_r=null,e.updateQueue=null,Gd.current=Pee,t=n(i,r)}while(Zf)}if(Gd.current=Zp,e=_r!==null&&_r.next!==null,mu=0,Pr=_r=ji=null,qp=!1,e)throw Error(xt(300));return t}function k8(){var t=T2!==0;return T2=0,t}function $a(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pr===null?ji.memoizedState=Pr=t:Pr=Pr.next=t,Pr}function Go(){if(_r===null){var t=ji.alternate;t=t!==null?t.memoizedState:null}else t=_r.next;var e=Pr===null?ji.memoizedState:Pr.next;if(e!==null)Pr=e,_r=t;else{if(t===null)throw Error(xt(310));_r=t,t={memoizedState:_r.memoizedState,baseState:_r.baseState,baseQueue:_r.baseQueue,queue:_r.queue,next:null},Pr===null?ji.memoizedState=Pr=t:Pr=Pr.next=t}return Pr}function S2(t,e){return typeof e=="function"?e(t):e}function F4(t){var e=Go(),n=e.queue;if(n===null)throw Error(xt(311));n.lastRenderedReducer=t;var i=_r,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var u=r.next;r.next=s.next,s.next=u}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=u=null,y=null,w=s;do{var I=w.lane;if((mu&I)===I)y!==null&&(y=y.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),i=w.hasEagerState?w.eagerState:t(i,w.action);else{var R={lane:I,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};y===null?(a=y=R,u=i):y=y.next=R,ji.lanes|=I,gu|=I}w=w.next}while(w!==null&&w!==s);y===null?u=i:y.next=a,ya(i,e.memoizedState)||(Us=!0),e.memoizedState=i,e.baseState=u,e.baseQueue=y,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,ji.lanes|=s,gu|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function N4(t){var e=Go(),n=e.queue;if(n===null)throw Error(xt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var u=r=r.next;do s=t(s,u.action),u=u.next;while(u!==r);ya(s,e.memoizedState)||(Us=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function vC(){}function xC(t,e){var n=ji,i=Go(),r=e(),s=!ya(i.memoizedState,r);if(s&&(i.memoizedState=r,Us=!0),i=i.queue,L8(EC.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||Pr!==null&&Pr.memoizedState.tag&1){if(n.flags|=2048,C2(9,bC.bind(null,n,i,r,e),void 0,null),Ir===null)throw Error(xt(349));mu&30||wC(n,e,r)}return r}function wC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ji.updateQueue,e===null?(e={lastEffect:null,stores:null},ji.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function bC(t,e,n,i){e.value=n,e.getSnapshot=i,TC(e)&&SC(t)}function EC(t,e,n){return n(function(){TC(e)&&SC(t)})}function TC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ya(t,n)}catch{return!0}}function SC(t){var e=l0(t,1);e!==null&&ma(e,t,1,-1)}function Nx(t){var e=$a();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:S2,lastRenderedState:t},e.queue=t,t=t.dispatch=Tee.bind(null,ji,t),[e.memoizedState,t]}function C2(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=ji.updateQueue,e===null?(e={lastEffect:null,stores:null},ji.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function CC(){return Go().memoizedState}function jd(t,e,n,i){var r=$a();ji.flags|=t,r.memoizedState=C2(1|e,n,void 0,i===void 0?null:i)}function C3(t,e,n,i){var r=Go();i=i===void 0?null:i;var s=void 0;if(_r!==null){var u=_r.memoizedState;if(s=u.destroy,i!==null&&M8(i,u.deps)){r.memoizedState=C2(e,n,s,i);return}}ji.flags|=t,r.memoizedState=C2(1|e,n,s,i)}function Ux(t,e){return jd(8390656,8,t,e)}function L8(t,e){return C3(2048,8,t,e)}function PC(t,e){return C3(4,2,t,e)}function MC(t,e){return C3(4,4,t,e)}function IC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kC(t,e,n){return n=n!=null?n.concat([t]):null,C3(4,4,IC.bind(null,e,t),n)}function D8(){}function LC(t,e){var n=Go();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&M8(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function DC(t,e){var n=Go();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&M8(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function RC(t,e,n){return mu&21?(ya(n,e)||(n=OS(),ji.lanes|=n,gu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Us=!0),t.memoizedState=n)}function bee(t,e){var n=gi;gi=n!==0&&4>n?n:4,t(!0);var i=O4.transition;O4.transition={};try{t(!1),e()}finally{gi=n,O4.transition=i}}function zC(){return Go().memoizedState}function Eee(t,e,n){var i=nc(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},BC(t))OC(e,n);else if(n=AC(t,e,n,i),n!==null){var r=Ts();ma(n,t,i,r),FC(n,e,i)}}function Tee(t,e,n){var i=nc(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(BC(t))OC(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var u=e.lastRenderedState,a=s(u,n);if(r.hasEagerState=!0,r.eagerState=a,ya(a,u)){var y=e.interleaved;y===null?(r.next=r,E8(e)):(r.next=y.next,y.next=r),e.interleaved=r;return}}catch{}finally{}n=AC(t,e,r,i),n!==null&&(r=Ts(),ma(n,t,i,r),FC(n,e,i))}}function BC(t){var e=t.alternate;return t===ji||e!==null&&e===ji}function OC(t,e){Zf=qp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function FC(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,u8(t,n)}}var Zp={readContext:Vo,useCallback:ts,useContext:ts,useEffect:ts,useImperativeHandle:ts,useInsertionEffect:ts,useLayoutEffect:ts,useMemo:ts,useReducer:ts,useRef:ts,useState:ts,useDebugValue:ts,useDeferredValue:ts,useTransition:ts,useMutableSource:ts,useSyncExternalStore:ts,useId:ts,unstable_isNewReconciler:!1},See={readContext:Vo,useCallback:function(t,e){return $a().memoizedState=[t,e===void 0?null:e],t},useContext:Vo,useEffect:Ux,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,jd(4194308,4,IC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return jd(4194308,4,t,e)},useInsertionEffect:function(t,e){return jd(4,2,t,e)},useMemo:function(t,e){var n=$a();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=$a();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Eee.bind(null,ji,t),[i.memoizedState,t]},useRef:function(t){var e=$a();return t={current:t},e.memoizedState=t},useState:Nx,useDebugValue:D8,useDeferredValue:function(t){return $a().memoizedState=t},useTransition:function(){var t=Nx(!1),e=t[0];return t=bee.bind(null,t[1]),$a().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=ji,r=$a();if(Fi){if(n===void 0)throw Error(xt(407));n=n()}else{if(n=e(),Ir===null)throw Error(xt(349));mu&30||wC(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,Ux(EC.bind(null,i,s,t),[t]),i.flags|=2048,C2(9,bC.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=$a(),e=Ir.identifierPrefix;if(Fi){var n=Zl,i=ql;n=(i&~(1<<32-pa(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=T2++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wee++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Cee={readContext:Vo,useCallback:LC,useContext:Vo,useEffect:L8,useImperativeHandle:kC,useInsertionEffect:PC,useLayoutEffect:MC,useMemo:DC,useReducer:F4,useRef:CC,useState:function(){return F4(S2)},useDebugValue:D8,useDeferredValue:function(t){var e=Go();return RC(e,_r.memoizedState,t)},useTransition:function(){var t=F4(S2)[0],e=Go().memoizedState;return[t,e]},useMutableSource:vC,useSyncExternalStore:xC,useId:zC,unstable_isNewReconciler:!1},Pee={readContext:Vo,useCallback:LC,useContext:Vo,useEffect:L8,useImperativeHandle:kC,useInsertionEffect:PC,useLayoutEffect:MC,useMemo:DC,useReducer:N4,useRef:CC,useState:function(){return N4(S2)},useDebugValue:D8,useDeferredValue:function(t){var e=Go();return _r===null?e.memoizedState=t:RC(e,_r.memoizedState,t)},useTransition:function(){var t=N4(S2)[0],e=Go().memoizedState;return[t,e]},useMutableSource:vC,useSyncExternalStore:xC,useId:zC,unstable_isNewReconciler:!1};function x1(t,e){try{var n="",i=e;do n+=nJ(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function U4(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function b6(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Mee=typeof WeakMap=="function"?WeakMap:Map;function NC(t,e,n){n=Yl(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Qp||(Qp=!0,D6=i),b6(t,e)},n}function UC(t,e,n){n=Yl(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){b6(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){b6(t,e),typeof i!="function"&&(tc===null?tc=new Set([this]):tc.add(this));var u=e.stack;this.componentDidCatch(e.value,{componentStack:u!==null?u:""})}),n}function Vx(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new Mee;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=jee.bind(null,t,e,n),e.then(t,t))}function Gx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function jx(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yl(-1,1),e.tag=2,ec(n,e,1))),n.lanes|=1),t)}var Iee=h0.ReactCurrentOwner,Us=!1;function ws(t,e,n,i){e.child=t===null?_C(e,null,n,i):y1(e,t.child,n,i)}function Hx(t,e,n,i,r){n=n.render;var s=e.ref;return t1(e,r),i=I8(t,e,n,i,s,r),n=k8(),t!==null&&!Us?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,c0(t,e,r)):(Fi&&n&&_8(e),e.flags|=1,ws(t,e,i,r),e.child)}function Wx(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!V8(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,VC(t,e,s,i,r)):(t=qd(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var u=s.memoizedProps;if(n=n.compare,n=n!==null?n:y2,n(u,i)&&t.ref===e.ref)return c0(t,e,r)}return e.flags|=1,t=ic(s,i),t.ref=e.ref,t.return=e,e.child=t}function VC(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(y2(s,i)&&t.ref===e.ref)if(Us=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Us=!0);else return e.lanes=t.lanes,c0(t,e,r)}return E6(t,e,n,i,r)}function GC(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mi($h,co),co|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Mi($h,co),co|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Mi($h,co),co|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Mi($h,co),co|=i;return ws(t,e,r,n),e.child}function jC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function E6(t,e,n,i,r){var s=js(n)?du:cs.current;return s=g1(e,s),t1(e,r),n=I8(t,e,n,i,s,r),i=k8(),t!==null&&!Us?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,c0(t,e,r)):(Fi&&i&&_8(e),e.flags|=1,ws(t,e,n,r),e.child)}function $x(t,e,n,i,r){if(js(n)){var s=!0;Up(e)}else s=!1;if(t1(e,r),e.stateNode===null)Hd(t,e),mC(e,n,i),w6(e,n,i,r),i=!0;else if(t===null){var u=e.stateNode,a=e.memoizedProps;u.props=a;var y=u.context,w=n.contextType;typeof w=="object"&&w!==null?w=Vo(w):(w=js(n)?du:cs.current,w=g1(e,w));var I=n.getDerivedStateFromProps,R=typeof I=="function"||typeof u.getSnapshotBeforeUpdate=="function";R||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==i||y!==w)&&Ox(e,u,i,w),U0=!1;var D=e.memoizedState;u.state=D,Wp(e,i,u,r),y=e.memoizedState,a!==i||D!==y||Gs.current||U0?(typeof I=="function"&&(x6(e,n,I,i),y=e.memoizedState),(a=U0||Bx(e,n,a,i,D,y,w))?(R||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(e.flags|=4194308)):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=y),u.props=i,u.state=y,u.context=w,i=a):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{u=e.stateNode,dC(t,e),a=e.memoizedProps,w=e.type===e.elementType?a:oa(e.type,a),u.props=w,R=e.pendingProps,D=u.context,y=n.contextType,typeof y=="object"&&y!==null?y=Vo(y):(y=js(n)?du:cs.current,y=g1(e,y));var U=n.getDerivedStateFromProps;(I=typeof U=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==R||D!==y)&&Ox(e,u,i,y),U0=!1,D=e.memoizedState,u.state=D,Wp(e,i,u,r);var q=e.memoizedState;a!==R||D!==q||Gs.current||U0?(typeof U=="function"&&(x6(e,n,U,i),q=e.memoizedState),(w=U0||Bx(e,n,w,i,D,q,y)||!1)?(I||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(i,q,y),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(i,q,y)),typeof u.componentDidUpdate=="function"&&(e.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof u.componentDidUpdate!="function"||a===t.memoizedProps&&D===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&D===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=q),u.props=i,u.state=q,u.context=y,i=w):(typeof u.componentDidUpdate!="function"||a===t.memoizedProps&&D===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&D===t.memoizedState||(e.flags|=1024),i=!1)}return T6(t,e,n,i,s,r)}function T6(t,e,n,i,r,s){jC(t,e);var u=(e.flags&128)!==0;if(!i&&!u)return r&&kx(e,n,!1),c0(t,e,s);i=e.stateNode,Iee.current=e;var a=u&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&u?(e.child=y1(e,t.child,null,s),e.child=y1(e,null,a,s)):ws(t,e,a,s),e.memoizedState=i.state,r&&kx(e,n,!0),e.child}function HC(t){var e=t.stateNode;e.pendingContext?Ix(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ix(t,e.context,!1),S8(t,e.containerInfo)}function qx(t,e,n,i,r){return _1(),v8(r),e.flags|=256,ws(t,e,n,i),e.child}var S6={dehydrated:null,treeContext:null,retryLane:0};function C6(t){return{baseLanes:t,cachePool:null,transitions:null}}function WC(t,e,n){var i=e.pendingProps,r=Vi.current,s=!1,u=(e.flags&128)!==0,a;if((a=u)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Mi(Vi,r&1),t===null)return y6(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(u=i.children,t=i.fallback,s?(i=e.mode,s=e.child,u={mode:"hidden",children:u},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=u):s=I3(u,i,0,null),t=iu(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=C6(n),e.memoizedState=S6,t):R8(e,u));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return kee(t,e,u,i,a,r,n);if(s){s=i.fallback,u=e.mode,r=t.child,a=r.sibling;var y={mode:"hidden",children:i.children};return!(u&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=y,e.deletions=null):(i=ic(r,y),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=ic(a,s):(s=iu(s,u,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,u=t.child.memoizedState,u=u===null?C6(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=t.childLanes&~n,e.memoizedState=S6,i}return s=t.child,t=s.sibling,i=ic(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function R8(t,e){return e=I3({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hd(t,e,n,i){return i!==null&&v8(i),y1(e,t.child,null,n),t=R8(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function kee(t,e,n,i,r,s,u){if(n)return e.flags&256?(e.flags&=-257,i=U4(Error(xt(422))),hd(t,e,u,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=I3({mode:"visible",children:i.children},r,0,null),s=iu(s,r,u,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&y1(e,t.child,null,u),e.child.memoizedState=C6(u),e.memoizedState=S6,s);if(!(e.mode&1))return hd(t,e,u,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(xt(419)),i=U4(s,i,void 0),hd(t,e,u,i)}if(a=(u&t.childLanes)!==0,Us||a){if(i=Ir,i!==null){switch(u&-u){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|u)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,l0(t,r),ma(i,t,r,-1))}return U8(),i=U4(Error(xt(421))),hd(t,e,u,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Hee.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,ho=J0(r.nextSibling),Ao=e,Fi=!0,ca=null,t!==null&&(zo[Bo++]=ql,zo[Bo++]=Zl,zo[Bo++]=pu,ql=t.id,Zl=t.overflow,pu=e),e=R8(e,i.children),e.flags|=4096,e)}function Zx(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),v6(t.return,e,n)}function V4(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function $C(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(ws(t,e,i.children,n),i=Vi.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Zx(t,n,e);else if(t.tag===19)Zx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Mi(Vi,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&$p(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),V4(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&$p(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}V4(e,!0,n,null,s);break;case"together":V4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Hd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function c0(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(xt(153));if(e.child!==null){for(t=e.child,n=ic(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ic(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Lee(t,e,n){switch(e.tag){case 3:HC(e),_1();break;case 5:yC(e);break;case 1:js(e.type)&&Up(e);break;case 4:S8(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Mi(jp,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Mi(Vi,Vi.current&1),e.flags|=128,null):n&e.child.childLanes?WC(t,e,n):(Mi(Vi,Vi.current&1),t=c0(t,e,n),t!==null?t.sibling:null);Mi(Vi,Vi.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return $C(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Mi(Vi,Vi.current),i)break;return null;case 22:case 23:return e.lanes=0,GC(t,e,n)}return c0(t,e,n)}var qC,P6,ZC,XC;qC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};P6=function(){};ZC=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Jc(el.current);var s=null;switch(n){case"input":r=Q5(t,r),i=Q5(t,i),s=[];break;case"select":r=Hi({},r,{value:void 0}),i=Hi({},i,{value:void 0}),s=[];break;case"textarea":r=J5(t,r),i=J5(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Fp)}t6(n,i);var u;n=null;for(w in r)if(!i.hasOwnProperty(w)&&r.hasOwnProperty(w)&&r[w]!=null)if(w==="style"){var a=r[w];for(u in a)a.hasOwnProperty(u)&&(n||(n={}),n[u]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(f2.hasOwnProperty(w)?s||(s=[]):(s=s||[]).push(w,null));for(w in i){var y=i[w];if(a=r?.[w],i.hasOwnProperty(w)&&y!==a&&(y!=null||a!=null))if(w==="style")if(a){for(u in a)!a.hasOwnProperty(u)||y&&y.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in y)y.hasOwnProperty(u)&&a[u]!==y[u]&&(n||(n={}),n[u]=y[u])}else n||(s||(s=[]),s.push(w,n)),n=y;else w==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,a=a?a.__html:void 0,y!=null&&a!==y&&(s=s||[]).push(w,y)):w==="children"?typeof y!="string"&&typeof y!="number"||(s=s||[]).push(w,""+y):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(f2.hasOwnProperty(w)?(y!=null&&w==="onScroll"&&Di("scroll",t),s||a===y||(s=[])):(s=s||[]).push(w,y))}n&&(s=s||[]).push("style",n);var w=s;(e.updateQueue=w)&&(e.flags|=4)}};XC=function(t,e,n,i){n!==i&&(e.flags|=4)};function bf(t,e){if(!Fi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function ns(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Dee(t,e,n){var i=e.pendingProps;switch(y8(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ns(e),null;case 1:return js(e.type)&&Np(),ns(e),null;case 3:return i=e.stateNode,v1(),Ri(Gs),Ri(cs),P8(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(cd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ca!==null&&(B6(ca),ca=null))),P6(t,e),ns(e),null;case 5:C8(e);var r=Jc(E2.current);if(n=e.type,t!==null&&e.stateNode!=null)ZC(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(xt(166));return ns(e),null}if(t=Jc(el.current),cd(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[Xa]=e,i[w2]=s,t=(e.mode&1)!==0,n){case"dialog":Di("cancel",i),Di("close",i);break;case"iframe":case"object":case"embed":Di("load",i);break;case"video":case"audio":for(r=0;r<zf.length;r++)Di(zf[r],i);break;case"source":Di("error",i);break;case"img":case"image":case"link":Di("error",i),Di("load",i);break;case"details":Di("toggle",i);break;case"input":ix(i,s),Di("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Di("invalid",i);break;case"textarea":sx(i,s),Di("invalid",i)}t6(n,s),r=null;for(var u in s)if(s.hasOwnProperty(u)){var a=s[u];u==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&ld(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&ld(i.textContent,a,t),r=["children",""+a]):f2.hasOwnProperty(u)&&a!=null&&u==="onScroll"&&Di("scroll",i)}switch(n){case"input":ed(i),rx(i,s,!0);break;case"textarea":ed(i),ox(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Fp)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{u=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=wS(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=u.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=u.createElement(n,{is:i.is}):(t=u.createElement(n),n==="select"&&(u=t,i.multiple?u.multiple=!0:i.size&&(u.size=i.size))):t=u.createElementNS(t,n),t[Xa]=e,t[w2]=i,qC(t,e,!1,!1),e.stateNode=t;e:{switch(u=n6(n,i),n){case"dialog":Di("cancel",t),Di("close",t),r=i;break;case"iframe":case"object":case"embed":Di("load",t),r=i;break;case"video":case"audio":for(r=0;r<zf.length;r++)Di(zf[r],t);r=i;break;case"source":Di("error",t),r=i;break;case"img":case"image":case"link":Di("error",t),Di("load",t),r=i;break;case"details":Di("toggle",t),r=i;break;case"input":ix(t,i),r=Q5(t,i),Di("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=Hi({},i,{value:void 0}),Di("invalid",t);break;case"textarea":sx(t,i),r=J5(t,i),Di("invalid",t);break;default:r=i}t6(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var y=a[s];s==="style"?TS(t,y):s==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&bS(t,y)):s==="children"?typeof y=="string"?(n!=="textarea"||y!=="")&&A2(t,y):typeof y=="number"&&A2(t,""+y):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(f2.hasOwnProperty(s)?y!=null&&s==="onScroll"&&Di("scroll",t):y!=null&&r8(t,s,y,u))}switch(n){case"input":ed(t),rx(t,i,!1);break;case"textarea":ed(t),ox(t);break;case"option":i.value!=null&&t.setAttribute("value",""+ac(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?Yh(t,!!i.multiple,s,!1):i.defaultValue!=null&&Yh(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Fp)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ns(e),null;case 6:if(t&&e.stateNode!=null)XC(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(xt(166));if(n=Jc(E2.current),Jc(el.current),cd(e)){if(i=e.stateNode,n=e.memoizedProps,i[Xa]=e,(s=i.nodeValue!==n)&&(t=Ao,t!==null))switch(t.tag){case 3:ld(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ld(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Xa]=e,e.stateNode=i}return ns(e),null;case 13:if(Ri(Vi),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Fi&&ho!==null&&e.mode&1&&!(e.flags&128))fC(),_1(),e.flags|=98560,s=!1;else if(s=cd(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(xt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(xt(317));s[Xa]=e}else _1(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ns(e),s=!1}else ca!==null&&(B6(ca),ca=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Vi.current&1?yr===0&&(yr=3):U8())),e.updateQueue!==null&&(e.flags|=4),ns(e),null);case 4:return v1(),P6(t,e),t===null&&v2(e.stateNode.containerInfo),ns(e),null;case 10:return b8(e.type._context),ns(e),null;case 17:return js(e.type)&&Np(),ns(e),null;case 19:if(Ri(Vi),s=e.memoizedState,s===null)return ns(e),null;if(i=(e.flags&128)!==0,u=s.rendering,u===null)if(i)bf(s,!1);else{if(yr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(u=$p(t),u!==null){for(e.flags|=128,bf(s,!1),i=u.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,u=s.alternate,u===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,t=u.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Mi(Vi,Vi.current&1|2),e.child}t=t.sibling}s.tail!==null&&rr()>w1&&(e.flags|=128,i=!0,bf(s,!1),e.lanes=4194304)}else{if(!i)if(t=$p(u),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),bf(s,!0),s.tail===null&&s.tailMode==="hidden"&&!u.alternate&&!Fi)return ns(e),null}else 2*rr()-s.renderingStartTime>w1&&n!==1073741824&&(e.flags|=128,i=!0,bf(s,!1),e.lanes=4194304);s.isBackwards?(u.sibling=e.child,e.child=u):(n=s.last,n!==null?n.sibling=u:e.child=u,s.last=u)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=rr(),e.sibling=null,n=Vi.current,Mi(Vi,i?n&1|2:n&1),e):(ns(e),null);case 22:case 23:return N8(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?co&1073741824&&(ns(e),e.subtreeFlags&6&&(e.flags|=8192)):ns(e),null;case 24:return null;case 25:return null}throw Error(xt(156,e.tag))}function Ree(t,e){switch(y8(e),e.tag){case 1:return js(e.type)&&Np(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return v1(),Ri(Gs),Ri(cs),P8(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return C8(e),null;case 13:if(Ri(Vi),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(xt(340));_1()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ri(Vi),null;case 4:return v1(),null;case 10:return b8(e.type._context),null;case 22:case 23:return N8(),null;case 24:return null;default:return null}}var fd=!1,as=!1,zee=typeof WeakSet=="function"?WeakSet:Set,Jt=null;function Wh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Ki(t,e,i)}else n.current=null}function M6(t,e,n){try{n()}catch(i){Ki(t,e,i)}}var Xx=!1;function Bee(t,e){if(f6=zp,t=JS(),g8(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var u=0,a=-1,y=-1,w=0,I=0,R=t,D=null;t:for(;;){for(var U;R!==n||r!==0&&R.nodeType!==3||(a=u+r),R!==s||i!==0&&R.nodeType!==3||(y=u+i),R.nodeType===3&&(u+=R.nodeValue.length),(U=R.firstChild)!==null;)D=R,R=U;for(;;){if(R===t)break t;if(D===n&&++w===r&&(a=u),D===s&&++I===i&&(y=u),(U=R.nextSibling)!==null)break;R=D,D=R.parentNode}R=U}n=a===-1||y===-1?null:{start:a,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(A6={focusedElem:t,selectionRange:n},zp=!1,Jt=e;Jt!==null;)if(e=Jt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Jt=t;else for(;Jt!==null;){e=Jt;try{var q=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(q!==null){var ne=q.memoizedProps,pe=q.memoizedState,J=e.stateNode,ie=J.getSnapshotBeforeUpdate(e.elementType===e.type?ne:oa(e.type,ne),pe);J.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var re=e.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xt(163))}}catch(ge){Ki(e,e.return,ge)}if(t=e.sibling,t!==null){t.return=e.return,Jt=t;break}Jt=e.return}return q=Xx,Xx=!1,q}function Xf(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&M6(e,n,s)}r=r.next}while(r!==i)}}function P3(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function I6(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function QC(t){var e=t.alternate;e!==null&&(t.alternate=null,QC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Xa],delete e[w2],delete e[m6],delete e[_ee],delete e[yee])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function YC(t){return t.tag===5||t.tag===3||t.tag===4}function Qx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||YC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function k6(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fp));else if(i!==4&&(t=t.child,t!==null))for(k6(t,e,n),t=t.sibling;t!==null;)k6(t,e,n),t=t.sibling}function L6(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(L6(t,e,n),t=t.sibling;t!==null;)L6(t,e,n),t=t.sibling}var Ur=null,aa=!1;function F0(t,e,n){for(n=n.child;n!==null;)KC(t,e,n),n=n.sibling}function KC(t,e,n){if(Ja&&typeof Ja.onCommitFiberUnmount=="function")try{Ja.onCommitFiberUnmount(v3,n)}catch{}switch(n.tag){case 5:as||Wh(n,e);case 6:var i=Ur,r=aa;Ur=null,F0(t,e,n),Ur=i,aa=r,Ur!==null&&(aa?(t=Ur,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ur.removeChild(n.stateNode));break;case 18:Ur!==null&&(aa?(t=Ur,n=n.stateNode,t.nodeType===8?R4(t.parentNode,n):t.nodeType===1&&R4(t,n),g2(t)):R4(Ur,n.stateNode));break;case 4:i=Ur,r=aa,Ur=n.stateNode.containerInfo,aa=!0,F0(t,e,n),Ur=i,aa=r;break;case 0:case 11:case 14:case 15:if(!as&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,u=s.destroy;s=s.tag,u!==void 0&&(s&2||s&4)&&M6(n,e,u),r=r.next}while(r!==i)}F0(t,e,n);break;case 1:if(!as&&(Wh(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Ki(n,e,a)}F0(t,e,n);break;case 21:F0(t,e,n);break;case 22:n.mode&1?(as=(i=as)||n.memoizedState!==null,F0(t,e,n),as=i):F0(t,e,n);break;default:F0(t,e,n)}}function Yx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new zee),e.forEach(function(i){var r=Wee.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function ra(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,u=e,a=u;e:for(;a!==null;){switch(a.tag){case 5:Ur=a.stateNode,aa=!1;break e;case 3:Ur=a.stateNode.containerInfo,aa=!0;break e;case 4:Ur=a.stateNode.containerInfo,aa=!0;break e}a=a.return}if(Ur===null)throw Error(xt(160));KC(s,u,r),Ur=null,aa=!1;var y=r.alternate;y!==null&&(y.return=null),r.return=null}catch(w){Ki(r,e,w)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)JC(e,t),e=e.sibling}function JC(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ra(e,t),Ha(t),i&4){try{Xf(3,t,t.return),P3(3,t)}catch(ne){Ki(t,t.return,ne)}try{Xf(5,t,t.return)}catch(ne){Ki(t,t.return,ne)}}break;case 1:ra(e,t),Ha(t),i&512&&n!==null&&Wh(n,n.return);break;case 5:if(ra(e,t),Ha(t),i&512&&n!==null&&Wh(n,n.return),t.flags&32){var r=t.stateNode;try{A2(r,"")}catch(ne){Ki(t,t.return,ne)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,u=n!==null?n.memoizedProps:s,a=t.type,y=t.updateQueue;if(t.updateQueue=null,y!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&vS(r,s),n6(a,u);var w=n6(a,s);for(u=0;u<y.length;u+=2){var I=y[u],R=y[u+1];I==="style"?TS(r,R):I==="dangerouslySetInnerHTML"?bS(r,R):I==="children"?A2(r,R):r8(r,I,R,w)}switch(a){case"input":Y5(r,s);break;case"textarea":xS(r,s);break;case"select":var D=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var U=s.value;U!=null?Yh(r,!!s.multiple,U,!1):D!==!!s.multiple&&(s.defaultValue!=null?Yh(r,!!s.multiple,s.defaultValue,!0):Yh(r,!!s.multiple,s.multiple?[]:"",!1))}r[w2]=s}catch(ne){Ki(t,t.return,ne)}}break;case 6:if(ra(e,t),Ha(t),i&4){if(t.stateNode===null)throw Error(xt(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(ne){Ki(t,t.return,ne)}}break;case 3:if(ra(e,t),Ha(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{g2(e.containerInfo)}catch(ne){Ki(t,t.return,ne)}break;case 4:ra(e,t),Ha(t);break;case 13:ra(e,t),Ha(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(O8=rr())),i&4&&Yx(t);break;case 22:if(I=n!==null&&n.memoizedState!==null,t.mode&1?(as=(w=as)||I,ra(e,t),as=w):ra(e,t),Ha(t),i&8192){if(w=t.memoizedState!==null,(t.stateNode.isHidden=w)&&!I&&t.mode&1)for(Jt=t,I=t.child;I!==null;){for(R=Jt=I;Jt!==null;){switch(D=Jt,U=D.child,D.tag){case 0:case 11:case 14:case 15:Xf(4,D,D.return);break;case 1:Wh(D,D.return);var q=D.stateNode;if(typeof q.componentWillUnmount=="function"){i=D,n=D.return;try{e=i,q.props=e.memoizedProps,q.state=e.memoizedState,q.componentWillUnmount()}catch(ne){Ki(i,n,ne)}}break;case 5:Wh(D,D.return);break;case 22:if(D.memoizedState!==null){Jx(R);continue}}U!==null?(U.return=D,Jt=U):Jx(R)}I=I.sibling}e:for(I=null,R=t;;){if(R.tag===5){if(I===null){I=R;try{r=R.stateNode,w?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=R.stateNode,y=R.memoizedProps.style,u=y!=null&&y.hasOwnProperty("display")?y.display:null,a.style.display=ES("display",u))}catch(ne){Ki(t,t.return,ne)}}}else if(R.tag===6){if(I===null)try{R.stateNode.nodeValue=w?"":R.memoizedProps}catch(ne){Ki(t,t.return,ne)}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===t)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===t)break e;for(;R.sibling===null;){if(R.return===null||R.return===t)break e;I===R&&(I=null),R=R.return}I===R&&(I=null),R.sibling.return=R.return,R=R.sibling}}break;case 19:ra(e,t),Ha(t),i&4&&Yx(t);break;case 21:break;default:ra(e,t),Ha(t)}}function Ha(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(YC(n)){var i=n;break e}n=n.return}throw Error(xt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(A2(r,""),i.flags&=-33);var s=Qx(t);L6(t,s,r);break;case 3:case 4:var u=i.stateNode.containerInfo,a=Qx(t);k6(t,a,u);break;default:throw Error(xt(161))}}catch(y){Ki(t,t.return,y)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Oee(t,e,n){Jt=t,eP(t)}function eP(t,e,n){for(var i=(t.mode&1)!==0;Jt!==null;){var r=Jt,s=r.child;if(r.tag===22&&i){var u=r.memoizedState!==null||fd;if(!u){var a=r.alternate,y=a!==null&&a.memoizedState!==null||as;a=fd;var w=as;if(fd=u,(as=y)&&!w)for(Jt=r;Jt!==null;)u=Jt,y=u.child,u.tag===22&&u.memoizedState!==null?ew(r):y!==null?(y.return=u,Jt=y):ew(r);for(;s!==null;)Jt=s,eP(s),s=s.sibling;Jt=r,fd=a,as=w}Kx(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Jt=s):Kx(t)}}function Kx(t){for(;Jt!==null;){var e=Jt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:as||P3(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!as)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:oa(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&zx(e,s,i);break;case 3:var u=e.updateQueue;if(u!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}zx(e,u,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var y=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&n.focus();break;case"img":y.src&&(n.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var w=e.alternate;if(w!==null){var I=w.memoizedState;if(I!==null){var R=I.dehydrated;R!==null&&g2(R)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xt(163))}as||e.flags&512&&I6(e)}catch(D){Ki(e,e.return,D)}}if(e===t){Jt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Jt=n;break}Jt=e.return}}function Jx(t){for(;Jt!==null;){var e=Jt;if(e===t){Jt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Jt=n;break}Jt=e.return}}function ew(t){for(;Jt!==null;){var e=Jt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{P3(4,e)}catch(y){Ki(e,n,y)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(y){Ki(e,r,y)}}var s=e.return;try{I6(e)}catch(y){Ki(e,s,y)}break;case 5:var u=e.return;try{I6(e)}catch(y){Ki(e,u,y)}}}catch(y){Ki(e,e.return,y)}if(e===t){Jt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Jt=a;break}Jt=e.return}}var Fee=Math.ceil,Xp=h0.ReactCurrentDispatcher,z8=h0.ReactCurrentOwner,Uo=h0.ReactCurrentBatchConfig,ai=0,Ir=null,ur=null,Gr=0,co=0,$h=uc(0),yr=0,P2=null,gu=0,M3=0,B8=0,Qf=null,Fs=null,O8=0,w1=1/0,Nl=null,Qp=!1,D6=null,tc=null,Ad=!1,q0=null,Yp=0,Yf=0,R6=null,Wd=-1,$d=0;function Ts(){return ai&6?rr():Wd!==-1?Wd:Wd=rr()}function nc(t){return t.mode&1?ai&2&&Gr!==0?Gr&-Gr:xee.transition!==null?($d===0&&($d=OS()),$d):(t=gi,t!==0||(t=window.event,t=t===void 0?16:HS(t.type)),t):1}function ma(t,e,n,i){if(50<Yf)throw Yf=0,R6=null,Error(xt(185));$2(t,n,i),(!(ai&2)||t!==Ir)&&(t===Ir&&(!(ai&2)&&(M3|=n),yr===4&&G0(t,Gr)),Hs(t,i),n===1&&ai===0&&!(e.mode&1)&&(w1=rr()+500,T3&&hc()))}function Hs(t,e){var n=t.callbackNode;xJ(t,e);var i=Rp(t,t===Ir?Gr:0);if(i===0)n!==null&&cx(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&cx(n),e===1)t.tag===0?vee(tw.bind(null,t)):cC(tw.bind(null,t)),mee(function(){!(ai&6)&&hc()}),n=null;else{switch(FS(i)){case 1:n=c8;break;case 4:n=zS;break;case 16:n=Dp;break;case 536870912:n=BS;break;default:n=Dp}n=lP(n,tP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function tP(t,e){if(Wd=-1,$d=0,ai&6)throw Error(xt(327));var n=t.callbackNode;if(n1()&&t.callbackNode!==n)return null;var i=Rp(t,t===Ir?Gr:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Kp(t,i);else{e=i;var r=ai;ai|=2;var s=iP();(Ir!==t||Gr!==e)&&(Nl=null,w1=rr()+500,nu(t,e));do try{Vee();break}catch(a){nP(t,a)}while(1);w8(),Xp.current=s,ai=r,ur!==null?e=0:(Ir=null,Gr=0,e=yr)}if(e!==0){if(e===2&&(r=a6(t),r!==0&&(i=r,e=z6(t,r))),e===1)throw n=P2,nu(t,0),G0(t,i),Hs(t,rr()),n;if(e===6)G0(t,i);else{if(r=t.current.alternate,!(i&30)&&!Nee(r)&&(e=Kp(t,i),e===2&&(s=a6(t),s!==0&&(i=s,e=z6(t,s))),e===1))throw n=P2,nu(t,0),G0(t,i),Hs(t,rr()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(xt(345));case 2:Zc(t,Fs,Nl);break;case 3:if(G0(t,i),(i&130023424)===i&&(e=O8+500-rr(),10<e)){if(Rp(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Ts(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=p6(Zc.bind(null,t,Fs,Nl),e);break}Zc(t,Fs,Nl);break;case 4:if(G0(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var u=31-pa(i);s=1<<u,u=e[u],u>r&&(r=u),i&=~s}if(i=r,i=rr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Fee(i/1960))-i,10<i){t.timeoutHandle=p6(Zc.bind(null,t,Fs,Nl),i);break}Zc(t,Fs,Nl);break;case 5:Zc(t,Fs,Nl);break;default:throw Error(xt(329))}}}return Hs(t,rr()),t.callbackNode===n?tP.bind(null,t):null}function z6(t,e){var n=Qf;return t.current.memoizedState.isDehydrated&&(nu(t,e).flags|=256),t=Kp(t,e),t!==2&&(e=Fs,Fs=n,e!==null&&B6(e)),t}function B6(t){Fs===null?Fs=t:Fs.push.apply(Fs,t)}function Nee(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ya(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function G0(t,e){for(e&=~B8,e&=~M3,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-pa(e),i=1<<n;t[n]=-1,e&=~i}}function tw(t){if(ai&6)throw Error(xt(327));n1();var e=Rp(t,0);if(!(e&1))return Hs(t,rr()),null;var n=Kp(t,e);if(t.tag!==0&&n===2){var i=a6(t);i!==0&&(e=i,n=z6(t,i))}if(n===1)throw n=P2,nu(t,0),G0(t,e),Hs(t,rr()),n;if(n===6)throw Error(xt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Zc(t,Fs,Nl),Hs(t,rr()),null}function F8(t,e){var n=ai;ai|=1;try{return t(e)}finally{ai=n,ai===0&&(w1=rr()+500,T3&&hc())}}function _u(t){q0!==null&&q0.tag===0&&!(ai&6)&&n1();var e=ai;ai|=1;var n=Uo.transition,i=gi;try{if(Uo.transition=null,gi=1,t)return t()}finally{gi=i,Uo.transition=n,ai=e,!(ai&6)&&hc()}}function N8(){co=$h.current,Ri($h)}function nu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,pee(n)),ur!==null)for(n=ur.return;n!==null;){var i=n;switch(y8(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Np();break;case 3:v1(),Ri(Gs),Ri(cs),P8();break;case 5:C8(i);break;case 4:v1();break;case 13:Ri(Vi);break;case 19:Ri(Vi);break;case 10:b8(i.type._context);break;case 22:case 23:N8()}n=n.return}if(Ir=t,ur=t=ic(t.current,null),Gr=co=e,yr=0,P2=null,B8=M3=gu=0,Fs=Qf=null,Kc!==null){for(e=0;e<Kc.length;e++)if(n=Kc[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var u=s.next;s.next=r,i.next=u}n.pending=i}Kc=null}return t}function nP(t,e){do{var n=ur;try{if(w8(),Gd.current=Zp,qp){for(var i=ji.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}qp=!1}if(mu=0,Pr=_r=ji=null,Zf=!1,T2=0,z8.current=null,n===null||n.return===null){yr=1,P2=e,ur=null;break}e:{var s=t,u=n.return,a=n,y=e;if(e=Gr,a.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var w=y,I=a,R=I.tag;if(!(I.mode&1)&&(R===0||R===11||R===15)){var D=I.alternate;D?(I.updateQueue=D.updateQueue,I.memoizedState=D.memoizedState,I.lanes=D.lanes):(I.updateQueue=null,I.memoizedState=null)}var U=Gx(u);if(U!==null){U.flags&=-257,jx(U,u,a,s,e),U.mode&1&&Vx(s,w,e),e=U,y=w;var q=e.updateQueue;if(q===null){var ne=new Set;ne.add(y),e.updateQueue=ne}else q.add(y);break e}else{if(!(e&1)){Vx(s,w,e),U8();break e}y=Error(xt(426))}}else if(Fi&&a.mode&1){var pe=Gx(u);if(pe!==null){!(pe.flags&65536)&&(pe.flags|=256),jx(pe,u,a,s,e),v8(x1(y,a));break e}}s=y=x1(y,a),yr!==4&&(yr=2),Qf===null?Qf=[s]:Qf.push(s),s=u;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var J=NC(s,y,e);Rx(s,J);break e;case 1:a=y;var ie=s.type,re=s.stateNode;if(!(s.flags&128)&&(typeof ie.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(tc===null||!tc.has(re)))){s.flags|=65536,e&=-e,s.lanes|=e;var ge=UC(s,a,e);Rx(s,ge);break e}}s=s.return}while(s!==null)}sP(n)}catch(be){e=be,ur===n&&n!==null&&(ur=n=n.return);continue}break}while(1)}function iP(){var t=Xp.current;return Xp.current=Zp,t===null?Zp:t}function U8(){(yr===0||yr===3||yr===2)&&(yr=4),Ir===null||!(gu&268435455)&&!(M3&268435455)||G0(Ir,Gr)}function Kp(t,e){var n=ai;ai|=2;var i=iP();(Ir!==t||Gr!==e)&&(Nl=null,nu(t,e));do try{Uee();break}catch(r){nP(t,r)}while(1);if(w8(),ai=n,Xp.current=i,ur!==null)throw Error(xt(261));return Ir=null,Gr=0,yr}function Uee(){for(;ur!==null;)rP(ur)}function Vee(){for(;ur!==null&&!fJ();)rP(ur)}function rP(t){var e=aP(t.alternate,t,co);t.memoizedProps=t.pendingProps,e===null?sP(t):ur=e,z8.current=null}function sP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Ree(n,e),n!==null){n.flags&=32767,ur=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yr=6,ur=null;return}}else if(n=Dee(n,e,co),n!==null){ur=n;return}if(e=e.sibling,e!==null){ur=e;return}ur=e=t}while(e!==null);yr===0&&(yr=5)}function Zc(t,e,n){var i=gi,r=Uo.transition;try{Uo.transition=null,gi=1,Gee(t,e,n,i)}finally{Uo.transition=r,gi=i}return null}function Gee(t,e,n,i){do n1();while(q0!==null);if(ai&6)throw Error(xt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(xt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(wJ(t,s),t===Ir&&(ur=Ir=null,Gr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ad||(Ad=!0,lP(Dp,function(){return n1(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Uo.transition,Uo.transition=null;var u=gi;gi=1;var a=ai;ai|=4,z8.current=null,Bee(t,n),JC(n,t),lee(A6),zp=!!f6,A6=f6=null,t.current=n,Oee(n),AJ(),ai=a,gi=u,Uo.transition=s}else t.current=n;if(Ad&&(Ad=!1,q0=t,Yp=r),s=t.pendingLanes,s===0&&(tc=null),mJ(n.stateNode),Hs(t,rr()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Qp)throw Qp=!1,t=D6,D6=null,t;return Yp&1&&t.tag!==0&&n1(),s=t.pendingLanes,s&1?t===R6?Yf++:(Yf=0,R6=t):Yf=0,hc(),null}function n1(){if(q0!==null){var t=FS(Yp),e=Uo.transition,n=gi;try{if(Uo.transition=null,gi=16>t?16:t,q0===null)var i=!1;else{if(t=q0,q0=null,Yp=0,ai&6)throw Error(xt(331));var r=ai;for(ai|=4,Jt=t.current;Jt!==null;){var s=Jt,u=s.child;if(Jt.flags&16){var a=s.deletions;if(a!==null){for(var y=0;y<a.length;y++){var w=a[y];for(Jt=w;Jt!==null;){var I=Jt;switch(I.tag){case 0:case 11:case 15:Xf(8,I,s)}var R=I.child;if(R!==null)R.return=I,Jt=R;else for(;Jt!==null;){I=Jt;var D=I.sibling,U=I.return;if(QC(I),I===w){Jt=null;break}if(D!==null){D.return=U,Jt=D;break}Jt=U}}}var q=s.alternate;if(q!==null){var ne=q.child;if(ne!==null){q.child=null;do{var pe=ne.sibling;ne.sibling=null,ne=pe}while(ne!==null)}}Jt=s}}if(s.subtreeFlags&2064&&u!==null)u.return=s,Jt=u;else e:for(;Jt!==null;){if(s=Jt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Xf(9,s,s.return)}var J=s.sibling;if(J!==null){J.return=s.return,Jt=J;break e}Jt=s.return}}var ie=t.current;for(Jt=ie;Jt!==null;){u=Jt;var re=u.child;if(u.subtreeFlags&2064&&re!==null)re.return=u,Jt=re;else e:for(u=ie;Jt!==null;){if(a=Jt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:P3(9,a)}}catch(be){Ki(a,a.return,be)}if(a===u){Jt=null;break e}var ge=a.sibling;if(ge!==null){ge.return=a.return,Jt=ge;break e}Jt=a.return}}if(ai=r,hc(),Ja&&typeof Ja.onPostCommitFiberRoot=="function")try{Ja.onPostCommitFiberRoot(v3,t)}catch{}i=!0}return i}finally{gi=n,Uo.transition=e}}return!1}function nw(t,e,n){e=x1(n,e),e=NC(t,e,1),t=ec(t,e,1),e=Ts(),t!==null&&($2(t,1,e),Hs(t,e))}function Ki(t,e,n){if(t.tag===3)nw(t,t,n);else for(;e!==null;){if(e.tag===3){nw(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(tc===null||!tc.has(i))){t=x1(n,t),t=UC(e,t,1),e=ec(e,t,1),t=Ts(),e!==null&&($2(e,1,t),Hs(e,t));break}}e=e.return}}function jee(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Ts(),t.pingedLanes|=t.suspendedLanes&n,Ir===t&&(Gr&n)===n&&(yr===4||yr===3&&(Gr&130023424)===Gr&&500>rr()-O8?nu(t,0):B8|=n),Hs(t,e)}function oP(t,e){e===0&&(t.mode&1?(e=id,id<<=1,!(id&130023424)&&(id=4194304)):e=1);var n=Ts();t=l0(t,e),t!==null&&($2(t,e,n),Hs(t,n))}function Hee(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),oP(t,n)}function Wee(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(xt(314))}i!==null&&i.delete(e),oP(t,n)}var aP;aP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Gs.current)Us=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Us=!1,Lee(t,e,n);Us=!!(t.flags&131072)}else Us=!1,Fi&&e.flags&1048576&&uC(e,Gp,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Hd(t,e),t=e.pendingProps;var r=g1(e,cs.current);t1(e,n),r=I8(null,e,i,t,r,n);var s=k8();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,js(i)?(s=!0,Up(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,T8(e),r.updater=S3,e.stateNode=r,r._reactInternals=e,w6(e,i,t,n),e=T6(null,e,i,!0,s,n)):(e.tag=0,Fi&&s&&_8(e),ws(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Hd(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=qee(i),t=oa(i,t),r){case 0:e=E6(null,e,i,t,n);break e;case 1:e=$x(null,e,i,t,n);break e;case 11:e=Hx(null,e,i,t,n);break e;case 14:e=Wx(null,e,i,oa(i.type,t),n);break e}throw Error(xt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:oa(i,r),E6(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:oa(i,r),$x(t,e,i,r,n);case 3:e:{if(HC(e),t===null)throw Error(xt(387));i=e.pendingProps,s=e.memoizedState,r=s.element,dC(t,e),Wp(e,i,null,n);var u=e.memoizedState;if(i=u.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=x1(Error(xt(423)),e),e=qx(t,e,i,n,r);break e}else if(i!==r){r=x1(Error(xt(424)),e),e=qx(t,e,i,n,r);break e}else for(ho=J0(e.stateNode.containerInfo.firstChild),Ao=e,Fi=!0,ca=null,n=_C(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(_1(),i===r){e=c0(t,e,n);break e}ws(t,e,i,n)}e=e.child}return e;case 5:return yC(e),t===null&&y6(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,u=r.children,d6(i,r)?u=null:s!==null&&d6(i,s)&&(e.flags|=32),jC(t,e),ws(t,e,u,n),e.child;case 6:return t===null&&y6(e),null;case 13:return WC(t,e,n);case 4:return S8(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=y1(e,null,i,n):ws(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:oa(i,r),Hx(t,e,i,r,n);case 7:return ws(t,e,e.pendingProps,n),e.child;case 8:return ws(t,e,e.pendingProps.children,n),e.child;case 12:return ws(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,u=r.value,Mi(jp,i._currentValue),i._currentValue=u,s!==null)if(ya(s.value,u)){if(s.children===r.children&&!Gs.current){e=c0(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){u=s.child;for(var y=a.firstContext;y!==null;){if(y.context===i){if(s.tag===1){y=Yl(-1,n&-n),y.tag=2;var w=s.updateQueue;if(w!==null){w=w.shared;var I=w.pending;I===null?y.next=y:(y.next=I.next,I.next=y),w.pending=y}}s.lanes|=n,y=s.alternate,y!==null&&(y.lanes|=n),v6(s.return,n,e),a.lanes|=n;break}y=y.next}}else if(s.tag===10)u=s.type===e.type?null:s.child;else if(s.tag===18){if(u=s.return,u===null)throw Error(xt(341));u.lanes|=n,a=u.alternate,a!==null&&(a.lanes|=n),v6(u,n,e),u=s.sibling}else u=s.child;if(u!==null)u.return=s;else for(u=s;u!==null;){if(u===e){u=null;break}if(s=u.sibling,s!==null){s.return=u.return,u=s;break}u=u.return}s=u}ws(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,t1(e,n),r=Vo(r),i=i(r),e.flags|=1,ws(t,e,i,n),e.child;case 14:return i=e.type,r=oa(i,e.pendingProps),r=oa(i.type,r),Wx(t,e,i,r,n);case 15:return VC(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:oa(i,r),Hd(t,e),e.tag=1,js(i)?(t=!0,Up(e)):t=!1,t1(e,n),mC(e,i,r),w6(e,i,r,n),T6(null,e,i,!0,t,n);case 19:return $C(t,e,n);case 22:return GC(t,e,n)}throw Error(xt(156,e.tag))};function lP(t,e){return RS(t,e)}function $ee(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fo(t,e,n,i){return new $ee(t,e,n,i)}function V8(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qee(t){if(typeof t=="function")return V8(t)?1:0;if(t!=null){if(t=t.$$typeof,t===o8)return 11;if(t===a8)return 14}return 2}function ic(t,e){var n=t.alternate;return n===null?(n=Fo(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function qd(t,e,n,i,r,s){var u=2;if(i=t,typeof t=="function")V8(t)&&(u=1);else if(typeof t=="string")u=5;else e:switch(t){case Bh:return iu(n.children,r,s,e);case s8:u=8,r|=8;break;case $5:return t=Fo(12,n,e,r|2),t.elementType=$5,t.lanes=s,t;case q5:return t=Fo(13,n,e,r),t.elementType=q5,t.lanes=s,t;case Z5:return t=Fo(19,n,e,r),t.elementType=Z5,t.lanes=s,t;case gS:return I3(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pS:u=10;break e;case mS:u=9;break e;case o8:u=11;break e;case a8:u=14;break e;case N0:u=16,i=null;break e}throw Error(xt(130,t==null?t:typeof t,""))}return e=Fo(u,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function iu(t,e,n,i){return t=Fo(7,t,i,e),t.lanes=n,t}function I3(t,e,n,i){return t=Fo(22,t,i,e),t.elementType=gS,t.lanes=n,t.stateNode={isHidden:!1},t}function G4(t,e,n){return t=Fo(6,t,null,e),t.lanes=n,t}function j4(t,e,n){return e=Fo(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Zee(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=b4(0),this.expirationTimes=b4(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=b4(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function G8(t,e,n,i,r,s,u,a,y){return t=new Zee(t,e,n,a,y),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Fo(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},T8(s),t}function Xee(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zh,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function cP(t){if(!t)return lc;t=t._reactInternals;e:{if(Pu(t)!==t||t.tag!==1)throw Error(xt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(js(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xt(171))}if(t.tag===1){var n=t.type;if(js(n))return lC(t,n,e)}return e}function uP(t,e,n,i,r,s,u,a,y){return t=G8(n,i,!0,t,r,s,u,a,y),t.context=cP(null),n=t.current,i=Ts(),r=nc(n),s=Yl(i,r),s.callback=e??null,ec(n,s,r),t.current.lanes=r,$2(t,r,i),Hs(t,i),t}function k3(t,e,n,i){var r=e.current,s=Ts(),u=nc(r);return n=cP(n),e.context===null?e.context=n:e.pendingContext=n,e=Yl(s,u),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=ec(r,e,u),t!==null&&(ma(t,r,u,s),Vd(t,r,u)),u}function Jp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function iw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function j8(t,e){iw(t,e),(t=t.alternate)&&iw(t,e)}function Qee(){return null}var hP=typeof reportError=="function"?reportError:function(t){console.error(t)};function H8(t){this._internalRoot=t}L3.prototype.render=H8.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(xt(409));k3(t,e,null,null)};L3.prototype.unmount=H8.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_u(function(){k3(null,t,null,null)}),e[a0]=null}};function L3(t){this._internalRoot=t}L3.prototype.unstable_scheduleHydration=function(t){if(t){var e=VS();t={blockedOn:null,target:t,priority:e};for(var n=0;n<V0.length&&e!==0&&e<V0[n].priority;n++);V0.splice(n,0,t),n===0&&jS(t)}};function W8(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function D3(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rw(){}function Yee(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var w=Jp(u);s.call(w)}}var u=uP(e,i,t,0,null,!1,!1,"",rw);return t._reactRootContainer=u,t[a0]=u.current,v2(t.nodeType===8?t.parentNode:t),_u(),u}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var w=Jp(y);a.call(w)}}var y=G8(t,0,!1,null,null,!1,!1,"",rw);return t._reactRootContainer=y,t[a0]=y.current,v2(t.nodeType===8?t.parentNode:t),_u(function(){k3(e,y,n,i)}),y}function R3(t,e,n,i,r){var s=n._reactRootContainer;if(s){var u=s;if(typeof r=="function"){var a=r;r=function(){var y=Jp(u);a.call(y)}}k3(e,u,t,r)}else u=Yee(n,e,t,r,i);return Jp(u)}NS=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Rf(e.pendingLanes);n!==0&&(u8(e,n|1),Hs(e,rr()),!(ai&6)&&(w1=rr()+500,hc()))}break;case 13:_u(function(){var i=l0(t,1);if(i!==null){var r=Ts();ma(i,t,1,r)}}),j8(t,1)}};h8=function(t){if(t.tag===13){var e=l0(t,134217728);if(e!==null){var n=Ts();ma(e,t,134217728,n)}j8(t,134217728)}};US=function(t){if(t.tag===13){var e=nc(t),n=l0(t,e);if(n!==null){var i=Ts();ma(n,t,e,i)}j8(t,e)}};VS=function(){return gi};GS=function(t,e){var n=gi;try{return gi=t,e()}finally{gi=n}};r6=function(t,e,n){switch(e){case"input":if(Y5(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=E3(i);if(!r)throw Error(xt(90));yS(i),Y5(i,r)}}}break;case"textarea":xS(t,n);break;case"select":e=n.value,e!=null&&Yh(t,!!n.multiple,e,!1)}};PS=F8;MS=_u;var Kee={usingClientEntryPoint:!1,Events:[Z2,Uh,E3,SS,CS,F8]},Ef={findFiberByHostInstance:Yc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Jee={bundleType:Ef.bundleType,version:Ef.version,rendererPackageName:Ef.rendererPackageName,rendererConfig:Ef.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:h0.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=LS(t),t===null?null:t.stateNode},findFiberByHostInstance:Ef.findFiberByHostInstance||Qee,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dd.isDisabled&&dd.supportsFiber)try{v3=dd.inject(Jee),Ja=dd}catch{}}go.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kee;go.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W8(e))throw Error(xt(200));return Xee(t,e,null,n)};go.createRoot=function(t,e){if(!W8(t))throw Error(xt(299));var n=!1,i="",r=hP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=G8(t,1,!1,null,null,n,!1,i,r),t[a0]=e.current,v2(t.nodeType===8?t.parentNode:t),new H8(e)};go.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(xt(188)):(t=Object.keys(t).join(","),Error(xt(268,t)));return t=LS(e),t=t===null?null:t.stateNode,t};go.flushSync=function(t){return _u(t)};go.hydrate=function(t,e,n){if(!D3(e))throw Error(xt(200));return R3(null,t,e,!0,n)};go.hydrateRoot=function(t,e,n){if(!W8(t))throw Error(xt(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",u=hP;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),e=uP(e,null,t,1,n??null,r,!1,s,u),t[a0]=e.current,v2(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new L3(e)};go.render=function(t,e,n){if(!D3(e))throw Error(xt(200));return R3(null,t,e,!1,n)};go.unmountComponentAtNode=function(t){if(!D3(t))throw Error(xt(40));return t._reactRootContainer?(_u(function(){R3(null,null,t,!1,function(){t._reactRootContainer=null,t[a0]=null})}),!0):!1};go.unstable_batchedUpdates=F8;go.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!D3(n))throw Error(xt(200));if(t==null||t._reactInternals===void 0)throw Error(xt(38));return R3(t,e,n,!1,i)};go.version="18.2.0-next-9e3b772b8-20220608";function fP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fP)}catch(t){console.error(t)}}fP(),uS.exports=go;var $8=uS.exports,AP,sw=$8;AP=sw.createRoot,sw.hydrateRoot;const ete="modulepreload",tte=function(t){return"/"+t},ow={},nte=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=tte(s),s in ow)return;ow[s]=!0;const u=s.endsWith(".css"),a=u?'[rel="stylesheet"]':"";if(!!i)for(let I=r.length-1;I>=0;I--){const R=r[I];if(R.href===s&&(!u||R.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const w=document.createElement("link");if(w.rel=u?"stylesheet":ete,u||(w.as="script",w.crossOrigin=""),w.href=s,document.head.appendChild(w),u)return new Promise((I,R)=>{w.addEventListener("load",I),w.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=s,window.dispatchEvent(u),!u.defaultPrevented)throw s})},ite=yt.createContext(null);function rte(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===s}function jl(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!jl(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const r of n)if(!e.hasOwnProperty(r)||!jl(t[r],e[r]))return!1;return!0}return!1}function ste(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function aw(t,e){if(!t.getProjection)return;const n=t.getProjection(),i=e.getProjection();jl(n,i)||e.setProjection(n)}function lw(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function cw(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const r=t.center;t.center=new r.constructor(n.longitude,n.latitude),i=i||r!==t.center}if("zoom"in n){const r=t.zoom;t.zoom=n.zoom,i=i||r!==t.zoom}if("bearing"in n){const r=t.bearing;t.bearing=n.bearing,i=i||r!==t.bearing}if("pitch"in n){const r=t.pitch;t.pitch=n.pitch,i=i||r!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const ote=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function uw(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const i of t.layers)e[i.id]=i;const n=t.layers.map(i=>{let r=null;"interactive"in i&&(r=Object.assign({},i),delete r.interactive);const s=e[i.ref];if(s){r=r||Object.assign({},i),delete r.ref;for(const u of ote)u in s&&(r[u]=s[u])}return r||i});return{...t,layers:n}}const hw={version:8,sources:{},layers:[]},fw={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},H4={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Aw={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},ate=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],lte=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class b1{constructor(e,n,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const s=this.props[Aw[r.type]];s?s(r):r.type==="error"&&console.error(r.error)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const s=this.props[fw[r.type]];s&&(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"&&(r.features=this._hoveredFeatures||this._queryRenderedFeatures(r.point)),s(r),delete r.features)},this._onCameraEvent=r=>{if(!this._internalUpdate){const s=this.props[H4[r.type]];s&&s(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=n,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const i=this._updateSettings(e,n);i&&this._createShadowTransform(this._map);const r=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(i||r||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const i=b1.savedMaps.pop();if(!i)return null;const r=i.map,s=r.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);r._container=n;const u=r._resizeObserver;u&&(u.disconnect(),u.observe(n)),i.setProps({...e,styleDiffing:!1}),r.resize();const{initialViewState:a}=e;return a&&(a.bounds?r.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):i._updateViewState(a,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),i}_initialize(e){const{props:n}=this,{mapStyle:i=hw}=n,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||cte()||null,container:e,style:uw(i)},s=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const I=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=I,n.gl)}const u=new this._MapClass(r);s.padding&&u.setPadding(s.padding),n.cursor&&(u.getCanvas().style.cursor=n.cursor),this._createShadowTransform(u);const a=u._render;u._render=I=>{this._inRender=!0,a.call(u,I),this._inRender=!1};const y=u._renderTaskQueue.run;u._renderTaskQueue.run=I=>{y.call(u._renderTaskQueue,I),this._onBeforeRepaint()},u.on("render",()=>this._onAfterRepaint());const w=u.fire;u.fire=this._fireEvent.bind(this,w),u.on("resize",()=>{this._renderTransform.resize(u.transform.width,u.transform.height)}),u.on("styledata",()=>{this._updateStyleComponents(this.props,{}),aw(u.transform,this._renderTransform)}),u.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const I in fw)u.on(I,this._onPointerEvent);for(const I in H4)u.on(I,this._onCameraEvent);for(const I in Aw)u.on(I,this._onEvent);this._map=u}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),b1.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=ste(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const i=this._map;if(n.width!==i.transform.width||n.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const i=this._map,r=this._renderTransform,{zoom:s,pitch:u,bearing:a}=r,y=i.isMoving();y&&(r.cameraElevationReference="sea");const w=cw(r,{...lw(i.transform),...e});if(y&&(r.cameraElevationReference="ground"),w&&n){const I=this._deferredEvents;I.move=!0,I.zoom||(I.zoom=s!==r.zoom),I.rotate||(I.rotate=a!==r.bearing),I.pitch||(I.pitch=u!==r.pitch)}return y||cw(i.transform,e),w}_updateSettings(e,n){const i=this._map;let r=!1;for(const s of ate)if(s in e&&!jl(e[s],n[s])){r=!0;const u=i[`set${s[0].toUpperCase()}${s.slice(1)}`];u?.call(i,e[s])}return r}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:i=hw,styleDiffing:r=!0}=e,s={diff:r};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(uw(i),s),!0}return!1}_updateStyleComponents(e,n){const i=this._map;let r=!1;return i.isStyleLoaded()&&("light"in e&&i.setLight&&!jl(e.light,n.light)&&(r=!0,i.setLight(e.light)),"fog"in e&&i.setFog&&!jl(e.fog,n.fog)&&(r=!0,i.setFog(e.fog)),"terrain"in e&&i.setTerrain&&!jl(e.terrain,n.terrain)&&(!e.terrain||i.getSource(e.terrain.source))&&(r=!0,i.setTerrain(e.terrain))),r}_updateHandlers(e,n){var i,r;const s=this._map;let u=!1;for(const a of lte){const y=(i=e[a])!==null&&i!==void 0?i:!0,w=(r=n[a])!==null&&r!==void 0?r:!0;jl(y,w)||(u=!0,y?s[a].enable(y):s[a].disable())}return u}_queryRenderedFeatures(e){const n=this._map,i=n.transform,{interactiveLayerIds:r=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=i}}_updateHover(e){var n;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const s=e.type,u=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),y=a.length>0;!y&&u&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,y&&!u&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,i){const r=this._map,s=r.transform,u=typeof n=="string"?n:n.type;return u==="move"&&this._updateViewState(this.props,!1),u in H4&&(typeof n=="object"&&(n.viewState=lw(s)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,n,i),r.transform=s,r):(e.call(r,n,i),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{aw(this._renderTransform,n),e.transform=n}}}b1.savedMaps=[];function cte(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const ute=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function hte(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>{const r=e.transform;e.transform=t.transform;const s=e.project(i);return e.transform=r,s},unproject:i=>{const r=e.transform;e.transform=t.transform;const s=e.unproject(i);return e.transform=r,s},queryTerrainElevation:(i,r)=>{const s=e.transform;e.transform=t.transform;const u=e.queryTerrainElevation(i,r);return e.transform=s,u},queryRenderedFeatures:(i,r)=>{const s=e.transform;e.transform=t.transform;const u=e.queryRenderedFeatures(i,r);return e.transform=s,u}};for(const i of fte(e))!(i in n)&&!ute.includes(i)&&(n[i]=e[i].bind(e));return n}function fte(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))i[0]!=="_"&&typeof t[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}const Ate=typeof document<"u"?yt.useLayoutEffect:yt.useEffect,dte=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function pte(t,e){for(const i of dte)i in e&&(t[i]=e[i]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,i=>{i&&console.error(i)},!1)}const z3=yt.createContext(null);function mte(t,e,n){const i=yt.useContext(ite),[r,s]=yt.useState(null),u=yt.useRef(),{current:a}=yt.useRef({mapLib:null,map:null});yt.useEffect(()=>{const I=t.mapLib;let R=!0,D;return Promise.resolve(I||n).then(U=>{if(!R)return;if(!U)throw new Error("Invalid mapLib");const q="Map"in U?U:U.default;if(!q.Map)throw new Error("Invalid mapLib");if(pte(q,t),!q.supported||q.supported(t))t.reuseMaps&&(D=b1.reuse(t,u.current)),D||(D=new b1(q.Map,t,u.current)),a.map=hte(D),a.mapLib=q,s(D),i?.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(U=>{const{onError:q}=t;q?q({type:"error",target:null,originalEvent:null,error:U}):console.error(U)}),()=>{R=!1,D&&(i?.onMapUnmount(t.id),t.reuseMaps?D.recycle():D.destroy())}},[]),Ate(()=>{r&&r.setProps(t)}),yt.useImperativeHandle(e,()=>a.map,[r]);const y=yt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),w={height:"100%"};return yt.createElement("div",{id:t.id,ref:u,style:y},r&&yt.createElement(z3.Provider,{value:a},yt.createElement("div",{"mapboxgl-children":"",style:w},t.children)))}const gte=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Mu(t,e){if(!t||!e)return;const n=t.style;for(const i in e){const r=e[i];Number.isFinite(r)&&!gte.test(i)?n[i]=`${r}px`:n[i]=r}}function _te(t,e){const{map:n,mapLib:i}=yt.useContext(z3),r=yt.useRef({props:t});r.current.props=t;const s=yt.useMemo(()=>{let ne=!1;yt.Children.forEach(t.children,ie=>{ie&&(ne=!0)});const pe={...t,element:ne?document.createElement("div"):null},J=new i.Marker(pe);return J.setLngLat([t.longitude,t.latitude]),J.getElement().addEventListener("click",ie=>{var re,ge;(ge=(re=r.current.props).onClick)===null||ge===void 0||ge.call(re,{type:"click",target:J,originalEvent:ie})}),J.on("dragstart",ie=>{var re,ge;const be=ie;be.lngLat=s.getLngLat(),(ge=(re=r.current.props).onDragStart)===null||ge===void 0||ge.call(re,be)}),J.on("drag",ie=>{var re,ge;const be=ie;be.lngLat=s.getLngLat(),(ge=(re=r.current.props).onDrag)===null||ge===void 0||ge.call(re,be)}),J.on("dragend",ie=>{var re,ge;const be=ie;be.lngLat=s.getLngLat(),(ge=(re=r.current.props).onDragEnd)===null||ge===void 0||ge.call(re,be)}),J},[]);yt.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:u,latitude:a,offset:y,style:w,draggable:I=!1,popup:R=null,rotation:D=0,rotationAlignment:U="auto",pitchAlignment:q="auto"}=t;return yt.useEffect(()=>{Mu(s.getElement(),w)},[w]),yt.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==u||s.getLngLat().lat!==a)&&s.setLngLat([u,a]),y&&!rte(s.getOffset(),y)&&s.setOffset(y),s.isDraggable()!==I&&s.setDraggable(I),s.getRotation()!==D&&s.setRotation(D),s.getRotationAlignment()!==U&&s.setRotationAlignment(U),s.getPitchAlignment()!==q&&s.setPitchAlignment(q),s.getPopup()!==R&&s.setPopup(R),$8.createPortal(t.children,s.getElement())}yt.memo(yt.forwardRef(_te));function dw(t){return new Set(t?t.trim().split(/\s+/):[])}function yte(t,e){const{map:n,mapLib:i}=yt.useContext(z3),r=yt.useMemo(()=>document.createElement("div"),[]),s=yt.useRef({props:t});s.current.props=t;const u=yt.useMemo(()=>{const a={...t},y=new i.Popup(a);return y.setLngLat([t.longitude,t.latitude]),y.once("open",w=>{var I,R;(R=(I=s.current.props).onOpen)===null||R===void 0||R.call(I,w)}),y},[]);if(yt.useEffect(()=>{const a=y=>{var w,I;(I=(w=s.current.props).onClose)===null||I===void 0||I.call(w,y)};return u.on("close",a),u.setDOMContent(r).addTo(n.getMap()),()=>{u.off("close",a),u.isOpen()&&u.remove()}},[]),yt.useEffect(()=>{Mu(u.getElement(),t.style)},[t.style]),yt.useImperativeHandle(e,()=>u,[]),u.isOpen()&&((u.getLngLat().lng!==t.longitude||u.getLngLat().lat!==t.latitude)&&u.setLngLat([t.longitude,t.latitude]),t.offset&&!jl(u.options.offset,t.offset)&&u.setOffset(t.offset),(u.options.anchor!==t.anchor||u.options.maxWidth!==t.maxWidth)&&(u.options.anchor=t.anchor,u.setMaxWidth(t.maxWidth)),u.options.className!==t.className)){const a=dw(u.options.className),y=dw(t.className);for(const w of a)y.has(w)||u.removeClassName(w);for(const w of y)a.has(w)||u.addClassName(w);u.options.className=t.className}return $8.createPortal(t.children,r)}yt.memo(yt.forwardRef(yte));function Q2(t,e,n,i){const r=yt.useContext(z3),s=yt.useMemo(()=>t(r),[]);return yt.useEffect(()=>{const u=i||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,y=typeof n=="function"?n:typeof e=="function"?e:null,{map:w}=r;return w.hasControl(s)||(w.addControl(s,u?.position),a&&a(r)),()=>{y&&y(r),w.hasControl(s)&&w.removeControl(s)}},[]),s}function vte(t){const e=Q2(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return yt.useEffect(()=>{Mu(e._container,t.style)},[t.style]),null}yt.memo(vte);function xte(t){const e=Q2(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return yt.useEffect(()=>{Mu(e._controlContainer,t.style)},[t.style]),null}yt.memo(xte);function wte(t,e){const n=yt.useRef({props:t}),i=Q2(({mapLib:r})=>{const s=new r.GeolocateControl(t),u=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||u(a)},s.on("geolocate",a=>{var y,w;(w=(y=n.current.props).onGeolocate)===null||w===void 0||w.call(y,a)}),s.on("error",a=>{var y,w;(w=(y=n.current.props).onError)===null||w===void 0||w.call(y,a)}),s.on("outofmaxbounds",a=>{var y,w;(w=(y=n.current.props).onOutOfMaxBounds)===null||w===void 0||w.call(y,a)}),s.on("trackuserlocationstart",a=>{var y,w;(w=(y=n.current.props).onTrackUserLocationStart)===null||w===void 0||w.call(y,a)}),s.on("trackuserlocationend",a=>{var y,w;(w=(y=n.current.props).onTrackUserLocationEnd)===null||w===void 0||w.call(y,a)}),s},{position:t.position});return n.current.props=t,yt.useImperativeHandle(e,()=>i,[]),yt.useEffect(()=>{Mu(i._container,t.style)},[t.style]),null}yt.memo(yt.forwardRef(wte));function bte(t){const e=Q2(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return yt.useEffect(()=>{Mu(e._container,t.style)},[t.style]),null}yt.memo(bte);function Ete(t){const e=Q2(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=yt.useRef(t),i=n.current;n.current=t;const{style:r}=t;return t.maxWidth!==void 0&&t.maxWidth!==i.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==i.unit&&e.setUnit(t.unit),yt.useEffect(()=>{Mu(e._container,r)},[r]),null}yt.memo(Ete);const Tte=nte(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),Ste=(()=>yt.forwardRef(function(e,n){return mte(e,n,Tte)}))();var dP={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(cq,function(){var n,i,r;function s(a,y){if(!n)n=y;else if(!i)i=y;else{var w="var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk);",I={};n(I),r=y(I),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}s(["exports"],function(a){var y=w;function w(c,o,h,g){this.cx=3*c,this.bx=3*(h-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(g-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=o,this.p2x=h,this.p2y=g}function I(c,o,h,g){const T=new y(c,o,h,g);return function(C){return T.solve(C)}}w.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,o){if(o===void 0&&(o=1e-6),c<0)return 0;if(c>1)return 1;for(var h=c,g=0;g<8;g++){var T=this.sampleCurveX(h)-c;if(Math.abs(T)<o)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=T/C}var k=0,B=1;for(h=c,g=0;g<20&&(T=this.sampleCurveX(h),!(Math.abs(T-c)<o));g++)c>T?k=h:B=h,h=.5*(B-k)+k;return h},solve:function(c,o){return this.sampleCurveY(this.solveCurveX(c,o))}};const R=I(.25,.1,.25,1);function D(c,o,h){return Math.min(h,Math.max(o,c))}function U(c,o,h){const g=h-o,T=((c-o)%g+g)%g+o;return T===o?h:T}function q(c,...o){for(const h of o)for(const g in h)c[g]=h[g];return c}let ne=1;function pe(c,o){c.forEach(h=>{o[h]&&(o[h]=o[h].bind(o))})}function J(c,o,h){const g={};for(const T in c)g[T]=o.call(h||this,c[T],T,c);return g}function ie(c,o,h){const g={};for(const T in c)o.call(h||this,c[T],T,c)&&(g[T]=c[T]);return g}function re(c){return Array.isArray(c)?c.map(re):typeof c=="object"&&c?J(c,re):c}const ge={};function be(c){ge[c]||(typeof console<"u"&&console.warn(c),ge[c]=!0)}function De(c,o,h){return(h.y-c.y)*(o.x-c.x)>(o.y-c.y)*(h.x-c.x)}function qe(c){let o=0;for(let h,g,T=0,C=c.length,k=C-1;T<C;k=T++)h=c[T],g=c[k],o+=(g.x-h.x)*(h.y+g.y);return o}function et(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ht(c){const o={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,g,T,C)=>{const k=T||C;return o[g]=!k||k.toLowerCase(),""}),o["max-age"]){const h=parseInt(o["max-age"],10);isNaN(h)?delete o["max-age"]:o["max-age"]=h}return o}let ot,at,Mt=null;function ut(c){if(Mt==null){const o=c.navigator?c.navigator.userAgent:null;Mt=!!c.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Mt}function St(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const Pn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(c){const o=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(c,o=0){const h=window.document.createElement("canvas"),g=h.getContext("2d");if(!g)throw new Error("failed to create canvas 2d context");return h.width=c.width,h.height=c.height,g.drawImage(c,0,0,c.width,c.height),g.getImageData(-o,-o,c.width+2*o,c.height+2*o)},resolveURL:c=>(ot||(ot=document.createElement("a")),ot.href=c,ot.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(at==null&&(at=matchMedia("(prefers-reduced-motion: reduce)")),at.matches)}};var Ot=Gn;function Gn(c,o){this.x=c,this.y=o}Gn.prototype={clone:function(){return new Gn(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,o){return this.clone()._rotateAround(c,o)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var o=c.x-this.x,h=c.y-this.y;return o*o+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,o){return Math.atan2(this.x*o-this.y*c,this.x*c+this.y*o)},_matMult:function(c){var o=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=o,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var o=Math.cos(c),h=Math.sin(c),g=h*this.x+o*this.y;return this.x=o*this.x-h*this.y,this.y=g,this},_rotateAround:function(c,o){var h=Math.cos(c),g=Math.sin(c),T=o.y+g*(this.x-o.x)+h*(this.y-o.y);return this.x=o.x+h*(this.x-o.x)-g*(this.y-o.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Gn.convert=function(c){return c instanceof Gn?c:Array.isArray(c)?new Gn(c[0],c[1]):c};const vt={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Bt="mapbox-tiles";let Qt,Mn,bn=500,pn=50;function Nn(){typeof caches>"u"||Qt||(Qt=caches.open(Bt))}let ti=1/0;const Ue={supported:!1,testSupport:function(c){!At&&Un&&(Xt?yn(c):An=c)}};let An,Un,At=!1,Xt=!1;function yn(c){const o=c.createTexture();c.bindTexture(c.TEXTURE_2D,o);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,Un),c.isContextLost())return;Ue.supported=!0}catch{}c.deleteTexture(o),At=!0}typeof document<"u"&&(Un=document.createElement("img"),Un.onload=function(){An&&yn(An),An=null,Xt=!0},Un.onerror=function(){At=!0,An=null},Un.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const mt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(mt);class jn extends Error{constructor(o,h,g,T){super(`AJAXError: ${h} (${o}): ${g}`),this.status=o,this.statusText=h,this.url=g,this.body=T}}const Bn=et()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function li(c,o){const h=new AbortController,g=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Bn(),signal:h.signal});let T=!1,C=!1;return c.type==="json"&&g.headers.set("Accept","application/json"),((k,B,F)=>{if(C)return;const j=Date.now();fetch(g).then(Q=>Q.ok?((te,ae,he)=>{(c.type==="arrayBuffer"?te.arrayBuffer():c.type==="json"?te.json():te.text()).then(fe=>{C||(ae&&he&&function(Le,Pe,Ge){if(Nn(),!Qt)return;const Ye={status:Pe.status,statusText:Pe.statusText,headers:new Headers};Pe.headers.forEach((Ze,ct)=>Ye.headers.set(ct,Ze));const Fe=ht(Pe.headers.get("Cache-Control")||"");Fe["no-store"]||(Fe["max-age"]&&Ye.headers.set("Expires",new Date(Ge+1e3*Fe["max-age"]).toUTCString()),new Date(Ye.headers.get("Expires")).getTime()-Ge<42e4||function(Ze,ct){if(Mn===void 0)try{new Response(new ReadableStream),Mn=!0}catch{Mn=!1}Mn?ct(Ze.body):Ze.blob().then(ct)}(Pe,Ze=>{const ct=new Response(Ze,Ye);Nn(),Qt&&Qt.then(lt=>lt.put(function(Nt){const jt=Nt.indexOf("?");return jt<0?Nt:Nt.slice(0,jt)}(Le.url),ct)).catch(lt=>be(lt.message))}))}(g,ae,he),T=!0,o(null,fe,te.headers.get("Cache-Control"),te.headers.get("Expires")))}).catch(fe=>{C||o(new Error(fe.message))})})(Q,null,j):Q.blob().then(te=>o(new jn(Q.status,Q.statusText,c.url,te)))).catch(Q=>{Q.code!==20&&o(new Error(Q.message))})})(),{cancel:()=>{C=!0,T||h.abort()}}}const ei=function(c,o){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){if(et()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,o);if(!et()){const g=c.url.substring(0,c.url.indexOf("://"));return(vt.REGISTERED_PROTOCOLS[g]||li)(c,o)}}if(!(/^file:/.test(h=c.url)||/^file:/.test(Bn())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return li(c,o);if(et()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,o,void 0,!0)}var h;return function(g,T){const C=new XMLHttpRequest;C.open(g.method||"GET",g.url,!0),g.type==="arrayBuffer"&&(C.responseType="arraybuffer");for(const k in g.headers)C.setRequestHeader(k,g.headers[k]);return g.type==="json"&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials=g.credentials==="include",C.onerror=()=>{T(new Error(C.statusText))},C.onload=()=>{if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let k=C.response;if(g.type==="json")try{k=JSON.parse(C.response)}catch(B){return T(B)}T(null,k,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else{const k=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});T(new jn(C.status,C.statusText,g.url,k))}},C.send(g.body),{cancel:()=>C.abort()}}(c,o)},ci=function(c,o){return ei(q(c,{type:"arrayBuffer"}),o)};function hr(c){const o=window.document.createElement("a");return o.href=c,o.protocol===window.document.location.protocol&&o.host===window.document.location.host}const Dn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fr,ni;fr=[],ni=0;const Wr=function(c,o){if(Ue.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),ni>=vt.MAX_PARALLEL_IMAGE_REQUESTS){const C={requestParameters:c,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return fr.push(C),C}ni++;let h=!1;const g=()=>{if(!h)for(h=!0,ni--;fr.length&&ni<vt.MAX_PARALLEL_IMAGE_REQUESTS;){const C=fr.shift(),{requestParameters:k,callback:B,cancelled:F}=C;F||(C.cancel=Wr(k,B).cancel)}},T=ci(c,(C,k,B,F)=>{g(),C?o(C):k&&function(j,Q){typeof createImageBitmap=="function"?function(te,ae){const he=new Blob([new Uint8Array(te)],{type:"image/png"});createImageBitmap(he).then(fe=>{ae(null,fe)}).catch(fe=>{ae(new Error(`Could not load image because of ${fe.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(j,Q):function(te,ae){const he=new Image;he.onload=()=>{ae(null,he),URL.revokeObjectURL(he.src),he.onload=null,window.requestAnimationFrame(()=>{he.src=Dn})},he.onerror=()=>ae(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const fe=new Blob([new Uint8Array(te)],{type:"image/png"});he.src=te.byteLength?URL.createObjectURL(fe):Dn}(j,Q)}(k,(j,Q)=>{j!=null?o(j):Q!=null&&o(null,Q,{cacheControl:B,expires:F})})});return{cancel:()=>{T.cancel(),g()}}};function yo(c,o,h){h[c]&&h[c].indexOf(o)!==-1||(h[c]=h[c]||[],h[c].push(o))}function sr(c,o,h){if(h&&h[c]){const g=h[c].indexOf(o);g!==-1&&h[c].splice(g,1)}}class Lr{constructor(o,h={}){q(this,h),this.type=o}}class vo extends Lr{constructor(o,h={}){super("error",q({error:o},h))}}class $r{on(o,h){return this._listeners=this._listeners||{},yo(o,h,this._listeners),this}off(o,h){return sr(o,h,this._listeners),sr(o,h,this._oneTimeListeners),this}once(o,h){return this._oneTimeListeners=this._oneTimeListeners||{},yo(o,h,this._oneTimeListeners),this}fire(o,h){typeof o=="string"&&(o=new Lr(o,h||{}));const g=o.type;if(this.listens(g)){o.target=this;const T=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const B of T)B.call(this,o);const C=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const B of C)sr(g,B,this._oneTimeListeners),B.call(this,o);const k=this._eventedParent;k&&(q(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(o))}else o instanceof vo&&console.error(o.error);return this}listens(o){return this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o)}setEventedParent(o,h){return this._eventedParent=o,this._eventedParentData=h,this}}var nt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class wt{constructor(o,h,g,T){this.message=(o?`${o}: `:"")+g,T&&(this.identifier=T),h!=null&&h.__line__&&(this.line=h.__line__)}}function Ms(c){const o=c.value;return o?[new wt(c.key,o,"constants have been deprecated as of v8")]:[]}function or(c,...o){for(const h of o)for(const g in h)c[g]=h[g];return c}function In(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function wr(c){if(Array.isArray(c))return c.map(wr);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const o={};for(const h in c)o[h]=wr(c[h]);return o}return In(c)}class Ar extends Error{constructor(o,h){super(h),this.message=h,this.key=o}}class dr{constructor(o,h=[]){this.parent=o,this.bindings={};for(const[g,T]of h)this.bindings[g]=T}concat(o){return new dr(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const us={kind:"null"},bt={kind:"number"},mn={kind:"string"},dn={kind:"boolean"},Ii={kind:"color"},hs={kind:"object"},un={kind:"value"},pt={kind:"collator"},zi={kind:"formatted"},$s={kind:"padding"},bi={kind:"resolvedImage"};function Wi(c,o){return{kind:"array",itemType:c,N:o}}function Hn(c){if(c.kind==="array"){const o=Hn(c.itemType);return typeof c.N=="number"?`array<${o}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${o}>`}return c.kind}const qs=[us,bt,mn,dn,Ii,zi,hs,Wi(un),$s,bi];function Dr(c,o){if(o.kind==="error")return null;if(c.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!Dr(c.itemType,o.itemType))&&(typeof c.N!="number"||c.N===o.N))return null}else{if(c.kind===o.kind)return null;if(c.kind==="value"){for(const h of qs)if(!Dr(h,o))return null}}return`Expected ${Hn(c)} but found ${Hn(o)} instead.`}function Rr(c,o){return o.some(h=>h.kind===c.kind)}function qr(c,o){return o.some(h=>h==="null"?c===null:h==="array"?Array.isArray(c):h==="object"?c&&!Array.isArray(c)&&typeof c=="object":h===typeof c)}var Is,ar={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Y(c){return(c=Math.round(c))<0?0:c>255?255:c}function V(c){return Y(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function X(c){return(o=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:o>1?1:o;var o}function oe(c,o,h){return h<0?h+=1:h>1&&(h-=1),6*h<1?c+(o-c)*h*6:2*h<1?o:3*h<2?c+(o-c)*(2/3-h)*6:c}try{Is={}.parseCSSColor=function(c){var o,h=c.replace(/ /g,"").toLowerCase();if(h in ar)return ar[h].slice();if(h[0]==="#")return h.length===4?(o=parseInt(h.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:h.length===7&&(o=parseInt(h.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var g=h.indexOf("("),T=h.indexOf(")");if(g!==-1&&T+1===h.length){var C=h.substr(0,g),k=h.substr(g+1,T-(g+1)).split(","),B=1;switch(C){case"rgba":if(k.length!==4)return null;B=X(k.pop());case"rgb":return k.length!==3?null:[V(k[0]),V(k[1]),V(k[2]),B];case"hsla":if(k.length!==4)return null;B=X(k.pop());case"hsl":if(k.length!==3)return null;var F=(parseFloat(k[0])%360+360)%360/360,j=X(k[1]),Q=X(k[2]),te=Q<=.5?Q*(j+1):Q+j-Q*j,ae=2*Q-te;return[Y(255*oe(ae,te,F+1/3)),Y(255*oe(ae,te,F)),Y(255*oe(ae,te,F-1/3)),B];default:return null}}return null}}catch{}class f{constructor(o,h,g,T=1){this.r=o,this.g=h,this.b=g,this.a=T}static parse(o){if(!o)return;if(o instanceof f)return o;if(typeof o!="string")return;const h=Is(o);return h?new f(h[0]/255*h[3],h[1]/255*h[3],h[2]/255*h[3],h[3]):void 0}toString(){const[o,h,g,T]=this.toArray();return`rgba(${Math.round(o)},${Math.round(h)},${Math.round(g)},${T})`}toArray(){const{r:o,g:h,b:g,a:T}=this;return T===0?[0,0,0,0]:[255*o/T,255*h/T,255*g/T,T]}}f.black=new f(0,0,0,1),f.white=new f(1,1,1,1),f.transparent=new f(0,0,0,0),f.red=new f(1,0,0,1);class W{constructor(o,h,g){this.sensitivity=o?h?"variant":"case":h?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,h){return this.collator.compare(o,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ke{constructor(o,h,g,T,C){this.text=o,this.image=h,this.scale=g,this.fontStack=T,this.textColor=C}}class Ce{constructor(o){this.sections=o}static fromString(o){return new Ce([new ke(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||o.image&&o.image.name.length!==0)}static factory(o){return o instanceof Ce?o:Ce.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}}class Ee{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof Ee)return o;if(typeof o=="number")return new Ee([o,o,o,o]);if(Array.isArray(o)&&!(o.length<1||o.length>4)){for(const h of o)if(typeof h!="number")return;switch(o.length){case 1:o=[o[0],o[0],o[0],o[0]];break;case 2:o=[o[0],o[1],o[0],o[1]];break;case 3:o=[o[0],o[1],o[2],o[1]]}return new Ee(o)}}toString(){return JSON.stringify(this.values)}}class Me{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Me({name:o,available:!1}):null}}function Ne(c,o,h,g){return typeof c=="number"&&c>=0&&c<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof h=="number"&&h>=0&&h<=255?g===void 0||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[c,o,h,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[c,o,h,g]:[c,o,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function rt(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof f||c instanceof W||c instanceof Ce||c instanceof Ee||c instanceof Me)return!0;if(Array.isArray(c)){for(const o of c)if(!rt(o))return!1;return!0}if(typeof c=="object"){for(const o in c)if(!rt(c[o]))return!1;return!0}return!1}function Ve(c){if(c===null)return us;if(typeof c=="string")return mn;if(typeof c=="boolean")return dn;if(typeof c=="number")return bt;if(c instanceof f)return Ii;if(c instanceof W)return pt;if(c instanceof Ce)return zi;if(c instanceof Ee)return $s;if(c instanceof Me)return bi;if(Array.isArray(c)){const o=c.length;let h;for(const g of c){const T=Ve(g);if(h){if(h===T)continue;h=un;break}h=T}return Wi(h||un,o)}return hs}function ft(c){const o=typeof c;return c===null?"":o==="string"||o==="number"||o==="boolean"?String(c):c instanceof f||c instanceof Ce||c instanceof Ee||c instanceof Me?c.toString():JSON.stringify(c)}class Lt{constructor(o,h){this.type=o,this.value=h}static parse(o,h){if(o.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!rt(o[1]))return h.error("invalid value");const g=o[1];let T=Ve(g);const C=h.expectedType;return T.kind!=="array"||T.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(T=C),new Lt(T,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ct{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Yt={string:mn,number:bt,boolean:dn,object:hs};class Gt{constructor(o,h){this.type=o,this.args=h}static parse(o,h){if(o.length<2)return h.error("Expected at least one argument.");let g,T=1;const C=o[0];if(C==="array"){let B,F;if(o.length>2){const j=o[1];if(typeof j!="string"||!(j in Yt)||j==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);B=Yt[j],T++}else B=un;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return h.error('The length argument to "array" must be a positive integer literal',2);F=o[2],T++}g=Wi(B,F)}else{if(!Yt[C])throw new Error(`Types doesn't contain name = ${C}`);g=Yt[C]}const k=[];for(;T<o.length;T++){const B=h.parse(o[T],T,un);if(!B)return null;k.push(B)}return new Gt(g,k)}evaluate(o){for(let h=0;h<this.args.length;h++){const g=this.args[h].evaluate(o);if(!Dr(this.type,Ve(g)))return g;if(h===this.args.length-1)throw new Ct(`Expected value to be of type ${Hn(this.type)}, but found ${Hn(Ve(g))} instead.`)}throw new Error}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const on={"to-boolean":dn,"to-color":Ii,"to-number":bt,"to-string":mn};class $t{constructor(o,h){this.type=o,this.args=h}static parse(o,h){if(o.length<2)return h.error("Expected at least one argument.");const g=o[0];if(!on[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if((g==="to-boolean"||g==="to-string")&&o.length!==2)return h.error("Expected one argument.");const T=on[g],C=[];for(let k=1;k<o.length;k++){const B=h.parse(o[k],k,un);if(!B)return null;C.push(B)}return new $t(T,C)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let h,g;for(const T of this.args){if(h=T.evaluate(o),g=null,h instanceof f)return h;if(typeof h=="string"){const C=o.parseColor(h);if(C)return C}else if(Array.isArray(h)&&(g=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Ne(h[0],h[1],h[2],h[3]),!g))return new f(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Ct(g||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}if(this.type.kind==="padding"){let h;for(const g of this.args){h=g.evaluate(o);const T=Ee.parse(h);if(T)return T}throw new Ct(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}if(this.type.kind==="number"){let h=null;for(const g of this.args){if(h=g.evaluate(o),h===null)return 0;const T=Number(h);if(!isNaN(T))return T}throw new Ct(`Could not convert ${JSON.stringify(h)} to number.`)}return this.type.kind==="formatted"?Ce.fromString(ft(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?Me.fromString(ft(this.args[0].evaluate(o))):ft(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const Kt=["Unknown","Point","LineString","Polygon"];class wn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Kt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(o){let h=this._parseColorCache[o];return h||(h=this._parseColorCache[o]=f.parse(o)),h}}class Ln{constructor(o,h,g,T){this.name=o,this.type=h,this._evaluate=g,this.args=T}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}static parse(o,h){const g=o[0],T=Ln.definitions[g];if(!T)return h.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(T)?T[0]:T.type,k=Array.isArray(T)?[[T[1],T[2]]]:T.overloads,B=k.filter(([j])=>!Array.isArray(j)||j.length===o.length-1);let F=null;for(const[j,Q]of B){F=new gt(h.registry,h.path,null,h.scope);const te=[];let ae=!1;for(let he=1;he<o.length;he++){const fe=o[he],Le=Array.isArray(j)?j[he-1]:j.type,Pe=F.parse(fe,1+te.length,Le);if(!Pe){ae=!0;break}te.push(Pe)}if(!ae)if(Array.isArray(j)&&j.length!==te.length)F.error(`Expected ${j.length} arguments, but found ${te.length} instead.`);else{for(let he=0;he<te.length;he++){const fe=Array.isArray(j)?j[he]:j.type,Le=te[he];F.concat(he+1).checkSubtype(fe,Le.type)}if(F.errors.length===0)return new Ln(g,C,Q,te)}}if(B.length===1)h.errors.push(...F.errors);else{const j=(B.length?B:k).map(([te])=>{return ae=te,Array.isArray(ae)?`(${ae.map(Hn).join(", ")})`:`(${Hn(ae.type)}...)`;var ae}).join(" | "),Q=[];for(let te=1;te<o.length;te++){const ae=h.parse(o[te],1+Q.length);if(!ae)return null;Q.push(Hn(ae.type))}h.error(`Expected arguments of type ${j}, but found (${Q.join(", ")}) instead.`)}return null}static register(o,h){Ln.definitions=h;for(const g in h)o[g]=Ln}}class Wn{constructor(o,h,g){this.type=pt,this.locale=g,this.caseSensitive=o,this.diacriticSensitive=h}static parse(o,h){if(o.length!==2)return h.error("Expected one argument.");const g=o[1];if(typeof g!="object"||Array.isArray(g))return h.error("Collator options argument must be an object.");const T=h.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,dn);if(!T)return null;const C=h.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,dn);if(!C)return null;let k=null;return g.locale&&(k=h.parse(g.locale,1,mn),!k)?null:new Wn(T,C,k)}evaluate(o){return new W(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}}const Vt=8192;function _e(c,o){c[0]=Math.min(c[0],o[0]),c[1]=Math.min(c[1],o[1]),c[2]=Math.max(c[2],o[0]),c[3]=Math.max(c[3],o[1])}function tn(c,o){return!(c[0]<=o[0]||c[2]>=o[2]||c[1]<=o[1]||c[3]>=o[3])}function $i(c,o){const h=(180+c[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,T=Math.pow(2,o.z);return[Math.round(h*T*Vt),Math.round(g*T*Vt)]}function $n(c,o,h){const g=c[0]-o[0],T=c[1]-o[1],C=c[0]-h[0],k=c[1]-h[1];return g*k-C*T==0&&g*C<=0&&T*k<=0}function Ho(c,o){let h=!1;for(let k=0,B=o.length;k<B;k++){const F=o[k];for(let j=0,Q=F.length;j<Q-1;j++){if($n(c,F[j],F[j+1]))return!1;(T=F[j])[1]>(g=c)[1]!=(C=F[j+1])[1]>g[1]&&g[0]<(C[0]-T[0])*(g[1]-T[1])/(C[1]-T[1])+T[0]&&(h=!h)}}var g,T,C;return h}function Wo(c,o){for(let h=0;h<o.length;h++)if(Ho(c,o[h]))return!0;return!1}function wa(c,o,h,g){const T=g[0]-h[0],C=g[1]-h[1],k=(c[0]-h[0])*C-T*(c[1]-h[1]),B=(o[0]-h[0])*C-T*(o[1]-h[1]);return k>0&&B<0||k<0&&B>0}function de(c,o,h){for(const j of h)for(let Q=0;Q<j.length-1;++Q)if((B=[(k=j[Q+1])[0]-(C=j[Q])[0],k[1]-C[1]])[0]*(F=[(T=o)[0]-(g=c)[0],T[1]-g[1]])[1]-B[1]*F[0]!=0&&wa(g,T,C,k)&&wa(C,k,g,T))return!0;var g,T,C,k,B,F;return!1}function xo(c,o){for(let h=0;h<c.length;++h)if(!Ho(c[h],o))return!1;for(let h=0;h<c.length-1;++h)if(de(c[h],c[h+1],o))return!1;return!0}function fs(c,o){for(let h=0;h<o.length;h++)if(xo(c,o[h]))return!0;return!1}function ba(c,o,h){const g=[];for(let T=0;T<c.length;T++){const C=[];for(let k=0;k<c[T].length;k++){const B=$i(c[T][k],h);_e(o,B),C.push(B)}g.push(C)}return g}function Ea(c,o,h){const g=[];for(let T=0;T<c.length;T++){const C=ba(c[T],o,h);g.push(C)}return g}function Ta(c,o,h,g){if(c[0]<h[0]||c[0]>h[2]){const T=.5*g;let C=c[0]-h[0]>T?-g:h[0]-c[0]>T?g:0;C===0&&(C=c[0]-h[2]>T?-g:h[2]-c[0]>T?g:0),c[0]+=C}_e(o,c)}function rl(c,o,h,g){const T=Math.pow(2,g.z)*Vt,C=[g.x*Vt,g.y*Vt],k=[];for(const B of c)for(const F of B){const j=[F.x+C[0],F.y+C[1]];Ta(j,o,h,T),k.push(j)}return k}function sl(c,o,h,g){const T=Math.pow(2,g.z)*Vt,C=[g.x*Vt,g.y*Vt],k=[];for(const F of c){const j=[];for(const Q of F){const te=[Q.x+C[0],Q.y+C[1]];_e(o,te),j.push(te)}k.push(j)}if(o[2]-o[0]<=T/2){(B=o)[0]=B[1]=1/0,B[2]=B[3]=-1/0;for(const F of k)for(const j of F)Ta(j,o,h,T)}var B;return k}class ks{constructor(o,h){this.type=dn,this.geojson=o,this.geometries=h}static parse(o,h){if(o.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(rt(o[1])){const g=o[1];if(g.type==="FeatureCollection")for(let T=0;T<g.features.length;++T){const C=g.features[T].geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new ks(g,g.features[T].geometry)}else if(g.type==="Feature"){const T=g.geometry.type;if(T==="Polygon"||T==="MultiPolygon")return new ks(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new ks(g,g)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(h,g){const T=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(g.type==="Polygon"){const B=ba(g.coordinates,C,k),F=rl(h.geometry(),T,C,k);if(!tn(T,C))return!1;for(const j of F)if(!Ho(j,B))return!1}if(g.type==="MultiPolygon"){const B=Ea(g.coordinates,C,k),F=rl(h.geometry(),T,C,k);if(!tn(T,C))return!1;for(const j of F)if(!Wo(j,B))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(h,g){const T=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(g.type==="Polygon"){const B=ba(g.coordinates,C,k),F=sl(h.geometry(),T,C,k);if(!tn(T,C))return!1;for(const j of F)if(!xo(j,B))return!1}if(g.type==="MultiPolygon"){const B=Ea(g.coordinates,C,k),F=sl(h.geometry(),T,C,k);if(!tn(T,C))return!1;for(const j of F)if(!fs(j,B))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ue(c){if(c instanceof Ln&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof ks)return!1;let o=!0;return c.eachChild(h=>{o&&!ue(h)&&(o=!1)}),o}function me(c){if(c instanceof Ln&&c.name==="feature-state")return!1;let o=!0;return c.eachChild(h=>{o&&!me(h)&&(o=!1)}),o}function Ie(c,o){if(c instanceof Ln&&o.indexOf(c.name)>=0)return!1;let h=!0;return c.eachChild(g=>{h&&!Ie(g,o)&&(h=!1)}),h}class Qe{constructor(o,h){this.type=h.type,this.name=o,this.boundExpression=h}static parse(o,h){if(o.length!==2||typeof o[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const g=o[1];return h.scope.has(g)?new Qe(g,h.scope.get(g)):h.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}}class gt{constructor(o,h=[],g,T=new dr,C=[]){this.registry=o,this.path=h,this.key=h.map(k=>`[${k}]`).join(""),this.scope=T,this.errors=C,this.expectedType=g}parse(o,h,g,T,C={}){return h?this.concat(h,g,T)._parse(o,C):this._parse(o,C)}_parse(o,h){function g(T,C,k){return k==="assert"?new Gt(C,[T]):k==="coerce"?new $t(C,[T]):T}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const T=o[0];if(typeof T!="string")return this.error(`Expression name must be a string, but found ${typeof T} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[T];if(C){let k=C.parse(o,this);if(!k)return null;if(this.expectedType){const B=this.expectedType,F=k.type;if(B.kind!=="string"&&B.kind!=="number"&&B.kind!=="boolean"&&B.kind!=="object"&&B.kind!=="array"||F.kind!=="value")if(B.kind!=="color"&&B.kind!=="formatted"&&B.kind!=="resolvedImage"||F.kind!=="value"&&F.kind!=="string")if(B.kind!=="padding"||F.kind!=="value"&&F.kind!=="number"&&F.kind!=="array"){if(this.checkSubtype(B,F))return null}else k=g(k,B,h.typeAnnotation||"coerce");else k=g(k,B,h.typeAnnotation||"coerce");else k=g(k,B,h.typeAnnotation||"assert")}if(!(k instanceof Lt)&&k.type.kind!=="resolvedImage"&&Ut(k)){const B=new wn;try{k=new Lt(k.type,k.evaluate(B))}catch(F){return this.error(F.message),null}}return k}return this.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,h,g){const T=typeof o=="number"?this.path.concat(o):this.path,C=g?this.scope.concat(g):this.scope;return new gt(this.registry,T,h||null,C,this.errors)}error(o,...h){const g=`${this.key}${h.map(T=>`[${T}]`).join("")}`;this.errors.push(new Ar(g,o))}checkSubtype(o,h){const g=Dr(o,h);return g&&this.error(g),g}}function Ut(c){if(c instanceof Qe)return Ut(c.boundExpression);if(c instanceof Ln&&c.name==="error"||c instanceof Wn||c instanceof ks)return!1;const o=c instanceof $t||c instanceof Gt;let h=!0;return c.eachChild(g=>{h=o?h&&Ut(g):h&&g instanceof Lt}),!!h&&ue(c)&&Ie(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function En(c,o){const h=c.length-1;let g,T,C=0,k=h,B=0;for(;C<=k;)if(B=Math.floor((C+k)/2),g=c[B],T=c[B+1],g<=o){if(B===h||o<T)return B;C=B+1}else{if(!(g>o))throw new Ct("Input is not a number.");k=B-1}return 0}class _i{constructor(o,h,g){this.type=o,this.input=h,this.labels=[],this.outputs=[];for(const[T,C]of g)this.labels.push(T),this.outputs.push(C)}static parse(o,h){if(o.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return h.error("Expected an even number of arguments.");const g=h.parse(o[1],1,bt);if(!g)return null;const T=[];let C=null;h.expectedType&&h.expectedType.kind!=="value"&&(C=h.expectedType);for(let k=1;k<o.length;k+=2){const B=k===1?-1/0:o[k],F=o[k+1],j=k,Q=k+1;if(typeof B!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(T.length&&T[T.length-1][0]>=B)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const te=h.parse(F,Q,C);if(!te)return null;C=C||te.type,T.push([B,te])}return new _i(C,g,T)}evaluate(o){const h=this.labels,g=this.outputs;if(h.length===1)return g[0].evaluate(o);const T=this.input.evaluate(o);if(T<=h[0])return g[0].evaluate(o);const C=h.length;return T>=h[C-1]?g[C-1].evaluate(o):g[En(h,T)].evaluate(o)}eachChild(o){o(this.input);for(const h of this.outputs)o(h)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function Tn(c,o,h){return c*(1-h)+o*h}var ki=Object.freeze({__proto__:null,number:Tn,color:function(c,o,h){return new f(Tn(c.r,o.r,h),Tn(c.g,o.g,h),Tn(c.b,o.b,h),Tn(c.a,o.a,h))},array:function(c,o,h){return c.map((g,T)=>Tn(g,o[T],h))},padding:function(c,o,h){const g=c.values,T=o.values;return new Ee([Tn(g[0],T[0],h),Tn(g[1],T[1],h),Tn(g[2],T[2],h),Tn(g[3],T[3],h)])}});const On=.95047,f0=1.08883,A0=4/29,d0=6/29,Iu=3*d0*d0,z1=Math.PI/180,ku=180/Math.PI;function ol(c){return c>.008856451679035631?Math.pow(c,1/3):c/Iu+A0}function al(c){return c>d0?c*c*c:Iu*(c-A0)}function fc(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Ac(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function qn(c){const o=Ac(c.r),h=Ac(c.g),g=Ac(c.b),T=ol((.4124564*o+.3575761*h+.1804375*g)/On),C=ol((.2126729*o+.7151522*h+.072175*g)/1);return{l:116*C-16,a:500*(T-C),b:200*(C-ol((.0193339*o+.119192*h+.9503041*g)/f0)),alpha:c.a}}function dc(c){let o=(c.l+16)/116,h=isNaN(c.a)?o:o+c.a/500,g=isNaN(c.b)?o:o-c.b/200;return o=1*al(o),h=On*al(h),g=f0*al(g),new f(fc(3.2404542*h-1.5371385*o-.4985314*g),fc(-.969266*h+1.8760108*o+.041556*g),fc(.0556434*h-.2040259*o+1.0572252*g),c.alpha)}function Lu(c,o,h){const g=o-c;return c+h*(g>180||g<-180?g-360*Math.round(g/360):g)}const ll={forward:qn,reverse:dc,interpolate:function(c,o,h){return{l:Tn(c.l,o.l,h),a:Tn(c.a,o.a,h),b:Tn(c.b,o.b,h),alpha:Tn(c.alpha,o.alpha,h)}}},cl={forward:function(c){const{l:o,a:h,b:g}=qn(c),T=Math.atan2(g,h)*ku;return{h:T<0?T+360:T,c:Math.sqrt(h*h+g*g),l:o,alpha:c.a}},reverse:function(c){const o=c.h*z1,h=c.c;return dc({l:c.l,a:Math.cos(o)*h,b:Math.sin(o)*h,alpha:c.alpha})},interpolate:function(c,o,h){return{h:Lu(c.h,o.h,h),c:Tn(c.c,o.c,h),l:Tn(c.l,o.l,h),alpha:Tn(c.alpha,o.alpha,h)}}};var Du=Object.freeze({__proto__:null,lab:ll,hcl:cl});class ui{constructor(o,h,g,T,C){this.type=o,this.operator=h,this.interpolation=g,this.input=T,this.labels=[],this.outputs=[];for(const[k,B]of C)this.labels.push(k),this.outputs.push(B)}static interpolationFactor(o,h,g,T){let C=0;if(o.name==="exponential")C=Zs(h,o.base,g,T);else if(o.name==="linear")C=Zs(h,1,g,T);else if(o.name==="cubic-bezier"){const k=o.controlPoints;C=new y(k[0],k[1],k[2],k[3]).solve(Zs(h,1,g,T))}return C}static parse(o,h){let[g,T,C,...k]=o;if(!Array.isArray(T)||T.length===0)return h.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){const j=T[1];if(typeof j!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:j}}else{if(T[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(T[0])}`,1,0);{const j=T.slice(1);if(j.length!==4||j.some(Q=>typeof Q!="number"||Q<0||Q>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:j}}}if(o.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(C=h.parse(C,2,bt),!C)return null;const B=[];let F=null;g==="interpolate-hcl"||g==="interpolate-lab"?F=Ii:h.expectedType&&h.expectedType.kind!=="value"&&(F=h.expectedType);for(let j=0;j<k.length;j+=2){const Q=k[j],te=k[j+1],ae=j+3,he=j+4;if(typeof Q!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ae);if(B.length&&B[B.length-1][0]>=Q)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ae);const fe=h.parse(te,he,F);if(!fe)return null;F=F||fe.type,B.push([Q,fe])}return F.kind==="number"||F.kind==="color"||F.kind==="padding"||F.kind==="array"&&F.itemType.kind==="number"&&typeof F.N=="number"?new ui(F,g,T,C,B):h.error(`Type ${Hn(F)} is not interpolatable.`)}evaluate(o){const h=this.labels,g=this.outputs;if(h.length===1)return g[0].evaluate(o);const T=this.input.evaluate(o);if(T<=h[0])return g[0].evaluate(o);const C=h.length;if(T>=h[C-1])return g[C-1].evaluate(o);const k=En(h,T),B=ui.interpolationFactor(this.interpolation,T,h[k],h[k+1]),F=g[k].evaluate(o),j=g[k+1].evaluate(o);return this.operator==="interpolate"?ki[this.type.kind.toLowerCase()](F,j,B):this.operator==="interpolate-hcl"?cl.reverse(cl.interpolate(cl.forward(F),cl.forward(j),B)):ll.reverse(ll.interpolate(ll.forward(F),ll.forward(j),B))}eachChild(o){o(this.input);for(const h of this.outputs)o(h)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function Zs(c,o,h,g){const T=g-h,C=c-h;return T===0?0:o===1?C/T:(Math.pow(o,C)-1)/(Math.pow(o,T)-1)}class qi{constructor(o,h){this.type=o,this.args=h}static parse(o,h){if(o.length<2)return h.error("Expectected at least one argument.");let g=null;const T=h.expectedType;T&&T.kind!=="value"&&(g=T);const C=[];for(const B of o.slice(1)){const F=h.parse(B,1+C.length,g,void 0,{typeAnnotation:"omit"});if(!F)return null;g=g||F.type,C.push(F)}if(!g)throw new Error("No output type");const k=T&&C.some(B=>Dr(T,B.type));return new qi(k?un:g,C)}evaluate(o){let h,g=null,T=0;for(const C of this.args)if(T++,g=C.evaluate(o),g&&g instanceof Me&&!g.available&&(h||(h=g.name),g=null,T===this.args.length&&(g=h)),g!==null)break;return g}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}class Sa{constructor(o,h){this.type=h.type,this.bindings=[].concat(o),this.result=h}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const h of this.bindings)o(h[1]);o(this.result)}static parse(o,h){if(o.length<4)return h.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const g=[];for(let C=1;C<o.length-1;C+=2){const k=o[C];if(typeof k!="string")return h.error(`Expected string, but found ${typeof k} instead.`,C);if(/[^a-zA-Z0-9_]/.test(k))return h.error("Variable names must contain only alphanumeric characters or '_'.",C);const B=h.parse(o[C+1],C+1);if(!B)return null;g.push([k,B])}const T=h.parse(o[o.length-1],o.length-1,h.expectedType,g);return T?new Sa(g,T):null}outputDefined(){return this.result.outputDefined()}}class p0{constructor(o,h,g){this.type=o,this.index=h,this.input=g}static parse(o,h){if(o.length!==3)return h.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const g=h.parse(o[1],1,bt),T=h.parse(o[2],2,Wi(h.expectedType||un));return g&&T?new p0(T.type.itemType,g,T):null}evaluate(o){const h=this.index.evaluate(o),g=this.input.evaluate(o);if(h<0)throw new Ct(`Array index out of bounds: ${h} < 0.`);if(h>=g.length)throw new Ct(`Array index out of bounds: ${h} > ${g.length-1}.`);if(h!==Math.floor(h))throw new Ct(`Array index must be an integer, but found ${h} instead.`);return g[h]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}}class Ca{constructor(o,h){this.type=dn,this.needle=o,this.haystack=h}static parse(o,h){if(o.length!==3)return h.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const g=h.parse(o[1],1,un),T=h.parse(o[2],2,un);return g&&T?Rr(g.type,[dn,mn,bt,us,un])?new Ca(g,T):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(g.type)} instead`):null}evaluate(o){const h=this.needle.evaluate(o),g=this.haystack.evaluate(o);if(!g)return!1;if(!qr(h,["boolean","string","number","null"]))throw new Ct(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(Ve(h))} instead.`);if(!qr(g,["string","array"]))throw new Ct(`Expected second argument to be of type array or string, but found ${Hn(Ve(g))} instead.`);return g.indexOf(h)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}}class m0{constructor(o,h,g){this.type=bt,this.needle=o,this.haystack=h,this.fromIndex=g}static parse(o,h){if(o.length<=2||o.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const g=h.parse(o[1],1,un),T=h.parse(o[2],2,un);if(!g||!T)return null;if(!Rr(g.type,[dn,mn,bt,us,un]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(g.type)} instead`);if(o.length===4){const C=h.parse(o[3],3,bt);return C?new m0(g,T,C):null}return new m0(g,T)}evaluate(o){const h=this.needle.evaluate(o),g=this.haystack.evaluate(o);if(!qr(h,["boolean","string","number","null"]))throw new Ct(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(Ve(h))} instead.`);if(!qr(g,["string","array"]))throw new Ct(`Expected second argument to be of type array or string, but found ${Hn(Ve(g))} instead.`);if(this.fromIndex){const T=this.fromIndex.evaluate(o);return g.indexOf(h,T)}return g.indexOf(h)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}}class pc{constructor(o,h,g,T,C,k){this.inputType=o,this.type=h,this.input=g,this.cases=T,this.outputs=C,this.otherwise=k}static parse(o,h){if(o.length<5)return h.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return h.error("Expected an even number of arguments.");let g,T;h.expectedType&&h.expectedType.kind!=="value"&&(T=h.expectedType);const C={},k=[];for(let j=2;j<o.length-1;j+=2){let Q=o[j];const te=o[j+1];Array.isArray(Q)||(Q=[Q]);const ae=h.concat(j);if(Q.length===0)return ae.error("Expected at least one branch label.");for(const fe of Q){if(typeof fe!="number"&&typeof fe!="string")return ae.error("Branch labels must be numbers or strings.");if(typeof fe=="number"&&Math.abs(fe)>Number.MAX_SAFE_INTEGER)return ae.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof fe=="number"&&Math.floor(fe)!==fe)return ae.error("Numeric branch labels must be integer values.");if(g){if(ae.checkSubtype(g,Ve(fe)))return null}else g=Ve(fe);if(C[String(fe)]!==void 0)return ae.error("Branch labels must be unique.");C[String(fe)]=k.length}const he=h.parse(te,j,T);if(!he)return null;T=T||he.type,k.push(he)}const B=h.parse(o[1],1,un);if(!B)return null;const F=h.parse(o[o.length-1],o.length-1,T);return F?B.type.kind!=="value"&&h.concat(1).checkSubtype(g,B.type)?null:new pc(g,T,B,C,k,F):null}evaluate(o){const h=this.input.evaluate(o);return(Ve(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}}class mc{constructor(o,h,g){this.type=o,this.branches=h,this.otherwise=g}static parse(o,h){if(o.length<4)return h.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return h.error("Expected an odd number of arguments.");let g;h.expectedType&&h.expectedType.kind!=="value"&&(g=h.expectedType);const T=[];for(let k=1;k<o.length-1;k+=2){const B=h.parse(o[k],k,dn);if(!B)return null;const F=h.parse(o[k+1],k+1,g);if(!F)return null;T.push([B,F]),g=g||F.type}const C=h.parse(o[o.length-1],o.length-1,g);if(!C)return null;if(!g)throw new Error("Can't infer output type");return new mc(g,T,C)}evaluate(o){for(const[h,g]of this.branches)if(h.evaluate(o))return g.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[h,g]of this.branches)o(h),o(g);o(this.otherwise)}outputDefined(){return this.branches.every(([o,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class ul{constructor(o,h,g,T){this.type=o,this.input=h,this.beginIndex=g,this.endIndex=T}static parse(o,h){if(o.length<=2||o.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const g=h.parse(o[1],1,un),T=h.parse(o[2],2,bt);if(!g||!T)return null;if(!Rr(g.type,[Wi(un),mn,un]))return h.error(`Expected first argument to be of type array or string, but found ${Hn(g.type)} instead`);if(o.length===4){const C=h.parse(o[3],3,bt);return C?new ul(g.type,g,T,C):null}return new ul(g.type,g,T)}evaluate(o){const h=this.input.evaluate(o),g=this.beginIndex.evaluate(o);if(!qr(h,["string","array"]))throw new Ct(`Expected first argument to be of type array or string, but found ${Hn(Ve(h))} instead.`);if(this.endIndex){const T=this.endIndex.evaluate(o);return h.slice(g,T)}return h.slice(g)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}}function hl(c,o){return c==="=="||c==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function wo(c,o,h,g){return g.compare(o,h)===0}function $o(c,o,h){const g=c!=="=="&&c!=="!=";return class pP{constructor(C,k,B){this.type=dn,this.lhs=C,this.rhs=k,this.collator=B,this.hasUntypedArgument=C.type.kind==="value"||k.type.kind==="value"}static parse(C,k){if(C.length!==3&&C.length!==4)return k.error("Expected two or three arguments.");const B=C[0];let F=k.parse(C[1],1,un);if(!F)return null;if(!hl(B,F.type))return k.concat(1).error(`"${B}" comparisons are not supported for type '${Hn(F.type)}'.`);let j=k.parse(C[2],2,un);if(!j)return null;if(!hl(B,j.type))return k.concat(2).error(`"${B}" comparisons are not supported for type '${Hn(j.type)}'.`);if(F.type.kind!==j.type.kind&&F.type.kind!=="value"&&j.type.kind!=="value")return k.error(`Cannot compare types '${Hn(F.type)}' and '${Hn(j.type)}'.`);g&&(F.type.kind==="value"&&j.type.kind!=="value"?F=new Gt(j.type,[F]):F.type.kind!=="value"&&j.type.kind==="value"&&(j=new Gt(F.type,[j])));let Q=null;if(C.length===4){if(F.type.kind!=="string"&&j.type.kind!=="string"&&F.type.kind!=="value"&&j.type.kind!=="value")return k.error("Cannot use collator to compare non-string types.");if(Q=k.parse(C[3],3,pt),!Q)return null}return new pP(F,j,Q)}evaluate(C){const k=this.lhs.evaluate(C),B=this.rhs.evaluate(C);if(g&&this.hasUntypedArgument){const F=Ve(k),j=Ve(B);if(F.kind!==j.kind||F.kind!=="string"&&F.kind!=="number")throw new Ct(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${F.kind}, ${j.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const F=Ve(k),j=Ve(B);if(F.kind!=="string"||j.kind!=="string")return o(C,k,B)}return this.collator?h(C,k,B,this.collator.evaluate(C)):o(C,k,B)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const Ru=$o("==",function(c,o,h){return o===h},wo),g0=$o("!=",function(c,o,h){return o!==h},function(c,o,h,g){return!wo(0,o,h,g)}),qo=$o("<",function(c,o,h){return o<h},function(c,o,h,g){return g.compare(o,h)<0}),bo=$o(">",function(c,o,h){return o>h},function(c,o,h,g){return g.compare(o,h)>0}),zu=$o("<=",function(c,o,h){return o<=h},function(c,o,h,g){return g.compare(o,h)<=0}),Bu=$o(">=",function(c,o,h){return o>=h},function(c,o,h,g){return g.compare(o,h)>=0});class fl{constructor(o,h,g,T,C){this.type=mn,this.number=o,this.locale=h,this.currency=g,this.minFractionDigits=T,this.maxFractionDigits=C}static parse(o,h){if(o.length!==3)return h.error("Expected two arguments.");const g=h.parse(o[1],1,bt);if(!g)return null;const T=o[2];if(typeof T!="object"||Array.isArray(T))return h.error("NumberFormat options argument must be an object.");let C=null;if(T.locale&&(C=h.parse(T.locale,1,mn),!C))return null;let k=null;if(T.currency&&(k=h.parse(T.currency,1,mn),!k))return null;let B=null;if(T["min-fraction-digits"]&&(B=h.parse(T["min-fraction-digits"],1,bt),!B))return null;let F=null;return T["max-fraction-digits"]&&(F=h.parse(T["max-fraction-digits"],1,bt),!F)?null:new fl(g,C,k,B,F)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}}class _0{constructor(o){this.type=zi,this.sections=o}static parse(o,h){if(o.length<2)return h.error("Expected at least one argument.");const g=o[1];if(!Array.isArray(g)&&typeof g=="object")return h.error("First argument must be an image or text section.");const T=[];let C=!1;for(let k=1;k<=o.length-1;++k){const B=o[k];if(C&&typeof B=="object"&&!Array.isArray(B)){C=!1;let F=null;if(B["font-scale"]&&(F=h.parse(B["font-scale"],1,bt),!F))return null;let j=null;if(B["text-font"]&&(j=h.parse(B["text-font"],1,Wi(mn)),!j))return null;let Q=null;if(B["text-color"]&&(Q=h.parse(B["text-color"],1,Ii),!Q))return null;const te=T[T.length-1];te.scale=F,te.font=j,te.textColor=Q}else{const F=h.parse(o[k],1,un);if(!F)return null;const j=F.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,T.push({content:F,scale:null,font:null,textColor:null})}}return new _0(T)}evaluate(o){return new Ce(this.sections.map(h=>{const g=h.content.evaluate(o);return Ve(g)===bi?new ke("",g,null,null,null):new ke(ft(g),null,h.scale?h.scale.evaluate(o):null,h.font?h.font.evaluate(o).join(","):null,h.textColor?h.textColor.evaluate(o):null)}))}eachChild(o){for(const h of this.sections)o(h.content),h.scale&&o(h.scale),h.font&&o(h.font),h.textColor&&o(h.textColor)}outputDefined(){return!1}}class gc{constructor(o){this.type=bi,this.input=o}static parse(o,h){if(o.length!==2)return h.error("Expected two arguments.");const g=h.parse(o[1],1,mn);return g?new gc(g):h.error("No image name provided.")}evaluate(o){const h=this.input.evaluate(o),g=Me.fromString(h);return g&&o.availableImages&&(g.available=o.availableImages.indexOf(h)>-1),g}eachChild(o){o(this.input)}outputDefined(){return!1}}class y0{constructor(o){this.type=bt,this.input=o}static parse(o,h){if(o.length!==2)return h.error(`Expected 1 argument, but found ${o.length-1} instead.`);const g=h.parse(o[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Hn(g.type)} instead.`):new y0(g):null}evaluate(o){const h=this.input.evaluate(o);if(typeof h=="string"||Array.isArray(h))return h.length;throw new Ct(`Expected value to be of type string or array, but found ${Hn(Ve(h))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}}const Pa={"==":Ru,"!=":g0,">":bo,"<":qo,">=":Bu,"<=":zu,array:Gt,at:p0,boolean:Gt,case:mc,coalesce:qi,collator:Wn,format:_0,image:gc,in:Ca,"index-of":m0,interpolate:ui,"interpolate-hcl":ui,"interpolate-lab":ui,length:y0,let:Sa,literal:Lt,match:pc,number:Gt,"number-format":fl,object:Gt,slice:ul,step:_i,string:Gt,"to-boolean":$t,"to-color":$t,"to-number":$t,"to-string":$t,var:Qe,within:ks};function Ou(c,[o,h,g,T]){o=o.evaluate(c),h=h.evaluate(c),g=g.evaluate(c);const C=T?T.evaluate(c):1,k=Ne(o,h,g,C);if(k)throw new Ct(k);return new f(o/255*C,h/255*C,g/255*C,C)}function Fu(c,o){return c in o}function v0(c,o){const h=o[c];return h===void 0?null:h}function Zo(c){return{type:c}}function Nu(c){return{result:"success",value:c}}function Ma(c){return{result:"error",value:c}}function di(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function Al(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Rn(c){return!!c.expression&&c.expression.interpolated}function Qn(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function fi(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function ii(c){return c}function dl(c,o){const h=o.type==="color",g=c.stops&&typeof c.stops[0][0]=="object",T=g||!(g||c.property!==void 0),C=c.type||(Rn(o)?"exponential":"interval");if(h||o.type==="padding"){const j=h?f.parse:Ee.parse;(c=or({},c)).stops&&(c.stops=c.stops.map(Q=>[Q[0],j(Q[1])])),c.default=j(c.default?c.default:o.default)}if(c.colorSpace&&c.colorSpace!=="rgb"&&!Du[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let k,B,F;if(C==="exponential")k=Vu;else if(C==="interval")k=Ia;else if(C==="categorical"){k=Uu,B=Object.create(null);for(const j of c.stops)B[j[0]]=j[1];F=typeof c.stops[0][0]}else{if(C!=="identity")throw new Error(`Unknown function type "${C}"`);k=_c}if(g){const j={},Q=[];for(let he=0;he<c.stops.length;he++){const fe=c.stops[he],Le=fe[0].zoom;j[Le]===void 0&&(j[Le]={zoom:Le,type:c.type,property:c.property,default:c.default,stops:[]},Q.push(Le)),j[Le].stops.push([fe[0].value,fe[1]])}const te=[];for(const he of Q)te.push([j[he].zoom,dl(j[he],o)]);const ae={name:"linear"};return{kind:"composite",interpolationType:ae,interpolationFactor:ui.interpolationFactor.bind(void 0,ae),zoomStops:te.map(he=>he[0]),evaluate:({zoom:he},fe)=>Vu({stops:te,base:c.base},o,he).evaluate(he,fe)}}if(T){const j=C==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:ui.interpolationFactor.bind(void 0,j),zoomStops:c.stops.map(Q=>Q[0]),evaluate:({zoom:Q})=>k(c,o,Q,B,F)}}return{kind:"source",evaluate(j,Q){const te=Q&&Q.properties?Q.properties[c.property]:void 0;return te===void 0?Eo(c.default,o.default):k(c,o,te,B,F)}}}function Eo(c,o,h){return c!==void 0?c:o!==void 0?o:h!==void 0?h:void 0}function Uu(c,o,h,g,T){return Eo(typeof h===T?g[h]:void 0,c.default,o.default)}function Ia(c,o,h){if(Qn(h)!=="number")return Eo(c.default,o.default);const g=c.stops.length;if(g===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[g-1][0])return c.stops[g-1][1];const T=En(c.stops.map(C=>C[0]),h);return c.stops[T][1]}function Vu(c,o,h){const g=c.base!==void 0?c.base:1;if(Qn(h)!=="number")return Eo(c.default,o.default);const T=c.stops.length;if(T===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[T-1][0])return c.stops[T-1][1];const C=En(c.stops.map(Q=>Q[0]),h),k=function(Q,te,ae,he){const fe=he-ae,Le=Q-ae;return fe===0?0:te===1?Le/fe:(Math.pow(te,Le)-1)/(Math.pow(te,fe)-1)}(h,g,c.stops[C][0],c.stops[C+1][0]),B=c.stops[C][1],F=c.stops[C+1][1];let j=ki[o.type]||ii;if(c.colorSpace&&c.colorSpace!=="rgb"){const Q=Du[c.colorSpace];j=(te,ae)=>Q.reverse(Q.interpolate(Q.forward(te),Q.forward(ae),k))}return typeof B.evaluate=="function"?{evaluate(...Q){const te=B.evaluate.apply(void 0,Q),ae=F.evaluate.apply(void 0,Q);if(te!==void 0&&ae!==void 0)return j(te,ae,k)}}:j(B,F,k)}function _c(c,o,h){switch(o.type){case"color":h=f.parse(h);break;case"formatted":h=Ce.fromString(h.toString());break;case"resolvedImage":h=Me.fromString(h.toString());break;case"padding":h=Ee.parse(h);break;default:Qn(h)===o.type||o.type==="enum"&&o.values[h]||(h=void 0)}return Eo(h,c.default,o.default)}Ln.register(Pa,{error:[{kind:"error"},[mn],(c,[o])=>{throw new Ct(o.evaluate(c))}],typeof:[mn,[un],(c,[o])=>Hn(Ve(o.evaluate(c)))],"to-rgba":[Wi(bt,4),[Ii],(c,[o])=>o.evaluate(c).toArray()],rgb:[Ii,[bt,bt,bt],Ou],rgba:[Ii,[bt,bt,bt,bt],Ou],has:{type:dn,overloads:[[[mn],(c,[o])=>Fu(o.evaluate(c),c.properties())],[[mn,hs],(c,[o,h])=>Fu(o.evaluate(c),h.evaluate(c))]]},get:{type:un,overloads:[[[mn],(c,[o])=>v0(o.evaluate(c),c.properties())],[[mn,hs],(c,[o,h])=>v0(o.evaluate(c),h.evaluate(c))]]},"feature-state":[un,[mn],(c,[o])=>v0(o.evaluate(c),c.featureState||{})],properties:[hs,[],c=>c.properties()],"geometry-type":[mn,[],c=>c.geometryType()],id:[un,[],c=>c.id()],zoom:[bt,[],c=>c.globals.zoom],"heatmap-density":[bt,[],c=>c.globals.heatmapDensity||0],"line-progress":[bt,[],c=>c.globals.lineProgress||0],accumulated:[un,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[bt,Zo(bt),(c,o)=>{let h=0;for(const g of o)h+=g.evaluate(c);return h}],"*":[bt,Zo(bt),(c,o)=>{let h=1;for(const g of o)h*=g.evaluate(c);return h}],"-":{type:bt,overloads:[[[bt,bt],(c,[o,h])=>o.evaluate(c)-h.evaluate(c)],[[bt],(c,[o])=>-o.evaluate(c)]]},"/":[bt,[bt,bt],(c,[o,h])=>o.evaluate(c)/h.evaluate(c)],"%":[bt,[bt,bt],(c,[o,h])=>o.evaluate(c)%h.evaluate(c)],ln2:[bt,[],()=>Math.LN2],pi:[bt,[],()=>Math.PI],e:[bt,[],()=>Math.E],"^":[bt,[bt,bt],(c,[o,h])=>Math.pow(o.evaluate(c),h.evaluate(c))],sqrt:[bt,[bt],(c,[o])=>Math.sqrt(o.evaluate(c))],log10:[bt,[bt],(c,[o])=>Math.log(o.evaluate(c))/Math.LN10],ln:[bt,[bt],(c,[o])=>Math.log(o.evaluate(c))],log2:[bt,[bt],(c,[o])=>Math.log(o.evaluate(c))/Math.LN2],sin:[bt,[bt],(c,[o])=>Math.sin(o.evaluate(c))],cos:[bt,[bt],(c,[o])=>Math.cos(o.evaluate(c))],tan:[bt,[bt],(c,[o])=>Math.tan(o.evaluate(c))],asin:[bt,[bt],(c,[o])=>Math.asin(o.evaluate(c))],acos:[bt,[bt],(c,[o])=>Math.acos(o.evaluate(c))],atan:[bt,[bt],(c,[o])=>Math.atan(o.evaluate(c))],min:[bt,Zo(bt),(c,o)=>Math.min(...o.map(h=>h.evaluate(c)))],max:[bt,Zo(bt),(c,o)=>Math.max(...o.map(h=>h.evaluate(c)))],abs:[bt,[bt],(c,[o])=>Math.abs(o.evaluate(c))],round:[bt,[bt],(c,[o])=>{const h=o.evaluate(c);return h<0?-Math.round(-h):Math.round(h)}],floor:[bt,[bt],(c,[o])=>Math.floor(o.evaluate(c))],ceil:[bt,[bt],(c,[o])=>Math.ceil(o.evaluate(c))],"filter-==":[dn,[mn,un],(c,[o,h])=>c.properties()[o.value]===h.value],"filter-id-==":[dn,[un],(c,[o])=>c.id()===o.value],"filter-type-==":[dn,[mn],(c,[o])=>c.geometryType()===o.value],"filter-<":[dn,[mn,un],(c,[o,h])=>{const g=c.properties()[o.value],T=h.value;return typeof g==typeof T&&g<T}],"filter-id-<":[dn,[un],(c,[o])=>{const h=c.id(),g=o.value;return typeof h==typeof g&&h<g}],"filter->":[dn,[mn,un],(c,[o,h])=>{const g=c.properties()[o.value],T=h.value;return typeof g==typeof T&&g>T}],"filter-id->":[dn,[un],(c,[o])=>{const h=c.id(),g=o.value;return typeof h==typeof g&&h>g}],"filter-<=":[dn,[mn,un],(c,[o,h])=>{const g=c.properties()[o.value],T=h.value;return typeof g==typeof T&&g<=T}],"filter-id-<=":[dn,[un],(c,[o])=>{const h=c.id(),g=o.value;return typeof h==typeof g&&h<=g}],"filter->=":[dn,[mn,un],(c,[o,h])=>{const g=c.properties()[o.value],T=h.value;return typeof g==typeof T&&g>=T}],"filter-id->=":[dn,[un],(c,[o])=>{const h=c.id(),g=o.value;return typeof h==typeof g&&h>=g}],"filter-has":[dn,[un],(c,[o])=>o.value in c.properties()],"filter-has-id":[dn,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[dn,[Wi(mn)],(c,[o])=>o.value.indexOf(c.geometryType())>=0],"filter-id-in":[dn,[Wi(un)],(c,[o])=>o.value.indexOf(c.id())>=0],"filter-in-small":[dn,[mn,Wi(un)],(c,[o,h])=>h.value.indexOf(c.properties()[o.value])>=0],"filter-in-large":[dn,[mn,Wi(un)],(c,[o,h])=>function(g,T,C,k){for(;C<=k;){const B=C+k>>1;if(T[B]===g)return!0;T[B]>g?k=B-1:C=B+1}return!1}(c.properties()[o.value],h.value,0,h.value.length-1)],all:{type:dn,overloads:[[[dn,dn],(c,[o,h])=>o.evaluate(c)&&h.evaluate(c)],[Zo(dn),(c,o)=>{for(const h of o)if(!h.evaluate(c))return!1;return!0}]]},any:{type:dn,overloads:[[[dn,dn],(c,[o,h])=>o.evaluate(c)||h.evaluate(c)],[Zo(dn),(c,o)=>{for(const h of o)if(h.evaluate(c))return!0;return!1}]]},"!":[dn,[dn],(c,[o])=>!o.evaluate(c)],"is-supported-script":[dn,[mn],(c,[o])=>{const h=c.globals&&c.globals.isSupportedScript;return!h||h(o.evaluate(c))}],upcase:[mn,[mn],(c,[o])=>o.evaluate(c).toUpperCase()],downcase:[mn,[mn],(c,[o])=>o.evaluate(c).toLowerCase()],concat:[mn,Zo(un),(c,o)=>o.map(h=>ft(h.evaluate(c))).join("")],"resolved-locale":[mn,[pt],(c,[o])=>o.evaluate(c).resolvedLocale()]});class pl{constructor(o,h){this.expression=o,this._warningHistory={},this._evaluator=new wn,this._defaultValue=h?function(g){return g.type==="color"&&fi(g.default)?new f(0,0,0,0):g.type==="color"?f.parse(g.default)||null:g.type==="padding"?Ee.parse(g.default)||null:g.default===void 0?null:g.default}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(o,h,g,T,C,k){return this._evaluator.globals=o,this._evaluator.feature=h,this._evaluator.featureState=g,this._evaluator.canonical=T,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=k,this.expression.evaluate(this._evaluator)}evaluate(o,h,g,T,C,k){this._evaluator.globals=o,this._evaluator.feature=h||null,this._evaluator.featureState=g||null,this._evaluator.canonical=T,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=k||null;try{const B=this.expression.evaluate(this._evaluator);if(B==null||typeof B=="number"&&B!=B)return this._defaultValue;if(this._enumValues&&!(B in this._enumValues))throw new Ct(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(B)} instead.`);return B}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(B.message)),this._defaultValue}}}function ml(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Pa}function ka(c,o){const h=new gt(Pa,[],o?function(T){const C={color:Ii,string:mn,number:bt,enum:mn,boolean:dn,formatted:zi,padding:$s,resolvedImage:bi};return T.type==="array"?Wi(C[T.value]||un,T.length):C[T.type]}(o):void 0),g=h.parse(c,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?Nu(new pl(g,o)):Ma(h.errors)}class Xo{constructor(o,h){this.kind=o,this._styleExpression=h,this.isStateDependent=o!=="constant"&&!me(h.expression)}evaluateWithoutErrorHandling(o,h,g,T,C,k){return this._styleExpression.evaluateWithoutErrorHandling(o,h,g,T,C,k)}evaluate(o,h,g,T,C,k){return this._styleExpression.evaluate(o,h,g,T,C,k)}}class gl{constructor(o,h,g,T){this.kind=o,this.zoomStops=g,this._styleExpression=h,this.isStateDependent=o!=="camera"&&!me(h.expression),this.interpolationType=T}evaluateWithoutErrorHandling(o,h,g,T,C,k){return this._styleExpression.evaluateWithoutErrorHandling(o,h,g,T,C,k)}evaluate(o,h,g,T,C,k){return this._styleExpression.evaluate(o,h,g,T,C,k)}interpolationFactor(o,h,g){return this.interpolationType?ui.interpolationFactor(this.interpolationType,o,h,g):0}}function _l(c,o){const h=ka(c,o);if(h.result==="error")return h;const g=h.value.expression,T=ue(g);if(!T&&!di(o))return Ma([new Ar("","data expressions not supported")]);const C=Ie(g,["zoom"]);if(!C&&!Al(o))return Ma([new Ar("","zoom expressions not supported")]);const k=x0(g);return k||C?k instanceof Ar?Ma([k]):k instanceof ui&&!Rn(o)?Ma([new Ar("",'"interpolate" expressions cannot be used with this property')]):Nu(k?new gl(T?"camera":"composite",h.value,k.labels,k instanceof ui?k.interpolation:void 0):new Xo(T?"constant":"source",h.value)):Ma([new Ar("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ri{constructor(o,h){this._parameters=o,this._specification=h,or(this,dl(this._parameters,this._specification))}static deserialize(o){return new ri(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function x0(c){let o=null;if(c instanceof Sa)o=x0(c.result);else if(c instanceof qi){for(const h of c.args)if(o=x0(h),o)break}else(c instanceof _i||c instanceof ui)&&c.input instanceof Ln&&c.input.name==="zoom"&&(o=c);return o instanceof Ar||c.eachChild(h=>{const g=x0(h);g instanceof Ar?o=g:!o&&g?o=new Ar("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&g&&o!==g&&(o=new Ar("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}function As(c){const o=c.key,h=c.value,g=c.valueSpec||{},T=c.objectElementValidators||{},C=c.style,k=c.styleSpec;let B=[];const F=Qn(h);if(F!=="object")return[new wt(o,h,`object expected, ${F} found`)];for(const j in h){const Q=j.split(".")[0],te=g[Q]||g["*"];let ae;if(T[Q])ae=T[Q];else if(g[Q])ae=zr;else if(T["*"])ae=T["*"];else{if(!g["*"]){B.push(new wt(o,h[j],`unknown property "${j}"`));continue}ae=zr}B=B.concat(ae({key:(o&&`${o}.`)+j,value:h[j],valueSpec:te,style:C,styleSpec:k,object:h,objectKey:j},h))}for(const j in g)T[j]||g[j].required&&g[j].default===void 0&&h[j]===void 0&&B.push(new wt(o,h,`missing required property "${j}"`));return B}function Gu(c){const o=c.value,h=c.valueSpec,g=c.style,T=c.styleSpec,C=c.key,k=c.arrayElementValidator||zr;if(Qn(o)!=="array")return[new wt(C,o,`array expected, ${Qn(o)} found`)];if(h.length&&o.length!==h.length)return[new wt(C,o,`array length ${h.length} expected, length ${o.length} found`)];if(h["min-length"]&&o.length<h["min-length"])return[new wt(C,o,`array length at least ${h["min-length"]} expected, length ${o.length} found`)];let B={type:h.value,values:h.values};T.$version<7&&(B.function=h.function),Qn(h.value)==="object"&&(B=h.value);let F=[];for(let j=0;j<o.length;j++)F=F.concat(k({array:o,arrayIndex:j,value:o[j],valueSpec:B,style:g,styleSpec:T,key:`${C}[${j}]`}));return F}function yc(c){const o=c.key,h=c.value,g=c.valueSpec;let T=Qn(h);return T==="number"&&h!=h&&(T="NaN"),T!=="number"?[new wt(o,h,`number expected, ${T} found`)]:"minimum"in g&&h<g.minimum?[new wt(o,h,`${h} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&h>g.maximum?[new wt(o,h,`${h} is greater than the maximum value ${g.maximum}`)]:[]}function ju(c){const o=c.valueSpec,h=In(c.value.type);let g,T,C,k={};const B=h!=="categorical"&&c.value.property===void 0,F=!B,j=Qn(c.value.stops)==="array"&&Qn(c.value.stops[0])==="array"&&Qn(c.value.stops[0][0])==="object",Q=As({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(he){if(h==="identity")return[new wt(he.key,he.value,'identity function may not have a "stops" property')];let fe=[];const Le=he.value;return fe=fe.concat(Gu({key:he.key,value:Le,valueSpec:he.valueSpec,style:he.style,styleSpec:he.styleSpec,arrayElementValidator:te})),Qn(Le)==="array"&&Le.length===0&&fe.push(new wt(he.key,Le,"array must have at least one stop")),fe},default:function(he){return zr({key:he.key,value:he.value,valueSpec:o,style:he.style,styleSpec:he.styleSpec})}}});return h==="identity"&&B&&Q.push(new wt(c.key,c.value,'missing required property "property"')),h==="identity"||c.value.stops||Q.push(new wt(c.key,c.value,'missing required property "stops"')),h==="exponential"&&c.valueSpec.expression&&!Rn(c.valueSpec)&&Q.push(new wt(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(F&&!di(c.valueSpec)?Q.push(new wt(c.key,c.value,"property functions not supported")):B&&!Al(c.valueSpec)&&Q.push(new wt(c.key,c.value,"zoom functions not supported"))),h!=="categorical"&&!j||c.value.property!==void 0||Q.push(new wt(c.key,c.value,'"property" property is required')),Q;function te(he){let fe=[];const Le=he.value,Pe=he.key;if(Qn(Le)!=="array")return[new wt(Pe,Le,`array expected, ${Qn(Le)} found`)];if(Le.length!==2)return[new wt(Pe,Le,`array length 2 expected, length ${Le.length} found`)];if(j){if(Qn(Le[0])!=="object")return[new wt(Pe,Le,`object expected, ${Qn(Le[0])} found`)];if(Le[0].zoom===void 0)return[new wt(Pe,Le,"object stop key must have zoom")];if(Le[0].value===void 0)return[new wt(Pe,Le,"object stop key must have value")];if(C&&C>In(Le[0].zoom))return[new wt(Pe,Le[0].zoom,"stop zoom values must appear in ascending order")];In(Le[0].zoom)!==C&&(C=In(Le[0].zoom),T=void 0,k={}),fe=fe.concat(As({key:`${Pe}[0]`,value:Le[0],valueSpec:{zoom:{}},style:he.style,styleSpec:he.styleSpec,objectElementValidators:{zoom:yc,value:ae}}))}else fe=fe.concat(ae({key:`${Pe}[0]`,value:Le[0],valueSpec:{},style:he.style,styleSpec:he.styleSpec},Le));return ml(wr(Le[1]))?fe.concat([new wt(`${Pe}[1]`,Le[1],"expressions are not allowed in function stops.")]):fe.concat(zr({key:`${Pe}[1]`,value:Le[1],valueSpec:o,style:he.style,styleSpec:he.styleSpec}))}function ae(he,fe){const Le=Qn(he.value),Pe=In(he.value),Ge=he.value!==null?he.value:fe;if(g){if(Le!==g)return[new wt(he.key,Ge,`${Le} stop domain type must match previous stop domain type ${g}`)]}else g=Le;if(Le!=="number"&&Le!=="string"&&Le!=="boolean")return[new wt(he.key,Ge,"stop domain value must be a number, string, or boolean")];if(Le!=="number"&&h!=="categorical"){let Ye=`number expected, ${Le} found`;return di(o)&&h===void 0&&(Ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new wt(he.key,Ge,Ye)]}return h!=="categorical"||Le!=="number"||isFinite(Pe)&&Math.floor(Pe)===Pe?h!=="categorical"&&Le==="number"&&T!==void 0&&Pe<T?[new wt(he.key,Ge,"stop domain values must appear in ascending order")]:(T=Pe,h==="categorical"&&Pe in k?[new wt(he.key,Ge,"stop domain values must be unique")]:(k[Pe]=!0,[])):[new wt(he.key,Ge,`integer expected, found ${Pe}`)]}}function Qo(c){const o=(c.expressionContext==="property"?_l:ka)(wr(c.value),c.valueSpec);if(o.result==="error")return o.value.map(g=>new wt(`${c.key}${g.key}`,c.value,g.message));const h=o.value.expression||o.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!h.outputDefined())return[new wt(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!me(h))return[new wt(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!me(h))return[new wt(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Ie(h,["zoom","feature-state"]))return[new wt(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!ue(h))return[new wt(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function yl(c){const o=c.key,h=c.value,g=c.valueSpec,T=[];return Array.isArray(g.values)?g.values.indexOf(In(h))===-1&&T.push(new wt(o,h,`expected one of [${g.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(g.values).indexOf(In(h))===-1&&T.push(new wt(o,h,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(h)} found`)),T}function Ni(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const o of c.slice(1))if(!Ni(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}const vc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ls(c){if(c==null)return{filter:()=>!0,needGeometry:!1};Ni(c)||(c=vl(c));const o=ka(c,vc);if(o.result==="error")throw new Error(o.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,g,T)=>o.value.evaluate(h,g,{},T),needGeometry:w0(c)}}function Hu(c,o){return c<o?-1:c>o?1:0}function w0(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let o=1;o<c.length;o++)if(w0(c[o]))return!0;return!1}function vl(c){if(!c)return!0;const o=c[0];return c.length<=1?o!=="any":o==="=="?br(c[1],c[2],"=="):o==="!="?ds(br(c[1],c[2],"==")):o==="<"||o===">"||o==="<="||o===">="?br(c[1],c[2],o):o==="any"?(h=c.slice(1),["any"].concat(h.map(vl))):o==="all"?["all"].concat(c.slice(1).map(vl)):o==="none"?["all"].concat(c.slice(1).map(vl).map(ds)):o==="in"?xl(c[1],c.slice(2)):o==="!in"?ds(xl(c[1],c.slice(2))):o==="has"?Yo(c[1]):o==="!has"?ds(Yo(c[1])):o!=="within"||c;var h}function br(c,o,h){switch(c){case"$type":return[`filter-type-${h}`,o];case"$id":return[`filter-id-${h}`,o];default:return[`filter-${h}`,c,o]}}function xl(c,o){if(o.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(h=>typeof h!=typeof o[0])?["filter-in-large",c,["literal",o.sort(Hu)]]:["filter-in-small",c,["literal",o]]}}function Yo(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function ds(c){return["!",c]}function Xs(c){return Ni(wr(c.value))?Qo(or({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):La(c)}function La(c){const o=c.value,h=c.key;if(Qn(o)!=="array")return[new wt(h,o,`array expected, ${Qn(o)} found`)];const g=c.styleSpec;let T,C=[];if(o.length<1)return[new wt(h,o,"filter array must have at least 1 element")];switch(C=C.concat(yl({key:`${h}[0]`,value:o[0],valueSpec:g.filter_operator,style:c.style,styleSpec:c.styleSpec})),In(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&In(o[1])==="$type"&&C.push(new wt(h,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&C.push(new wt(h,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(T=Qn(o[1]),T!=="string"&&C.push(new wt(`${h}[1]`,o[1],`string expected, ${T} found`)));for(let k=2;k<o.length;k++)T=Qn(o[k]),In(o[1])==="$type"?C=C.concat(yl({key:`${h}[${k}]`,value:o[k],valueSpec:g.geometry_type,style:c.style,styleSpec:c.styleSpec})):T!=="string"&&T!=="number"&&T!=="boolean"&&C.push(new wt(`${h}[${k}]`,o[k],`string, number, or boolean expected, ${T} found`));break;case"any":case"all":case"none":for(let k=1;k<o.length;k++)C=C.concat(La({key:`${h}[${k}]`,value:o[k],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":T=Qn(o[1]),o.length!==2?C.push(new wt(h,o,`filter array for "${o[0]}" operator must have 2 elements`)):T!=="string"&&C.push(new wt(`${h}[1]`,o[1],`string expected, ${T} found`));break;case"within":T=Qn(o[1]),o.length!==2?C.push(new wt(h,o,`filter array for "${o[0]}" operator must have 2 elements`)):T!=="object"&&C.push(new wt(`${h}[1]`,o[1],`object expected, ${T} found`))}return C}function wl(c,o){const h=c.key,g=c.style,T=c.styleSpec,C=c.value,k=c.objectKey,B=T[`${o}_${c.layerType}`];if(!B)return[];const F=k.match(/^(.*)-transition$/);if(o==="paint"&&F&&B[F[1]]&&B[F[1]].transition)return zr({key:h,value:C,valueSpec:T.transition,style:g,styleSpec:T});const j=c.valueSpec||B[k];if(!j)return[new wt(h,C,`unknown property "${k}"`)];let Q;if(Qn(C)==="string"&&di(j)&&!j.tokens&&(Q=/^{([^}]+)}$/.exec(C)))return[new wt(h,C,`"${k}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Q[1])} }\`.`)];const te=[];return c.layerType==="symbol"&&(k==="text-field"&&g&&!g.glyphs&&te.push(new wt(h,C,'use of "text-field" requires a style "glyphs" property')),k==="text-font"&&fi(wr(C))&&In(C.type)==="identity"&&te.push(new wt(h,C,'"text-font" does not support identity functions'))),te.concat(zr({key:c.key,value:C,valueSpec:j,style:g,styleSpec:T,expressionContext:"property",propertyType:o,propertyKey:k}))}function xc(c){return wl(c,"paint")}function Wu(c){return wl(c,"layout")}function b0(c){let o=[];const h=c.value,g=c.key,T=c.style,C=c.styleSpec;h.type||h.ref||o.push(new wt(g,h,'either "type" or "ref" is required'));let k=In(h.type);const B=In(h.ref);if(h.id){const F=In(h.id);for(let j=0;j<c.arrayIndex;j++){const Q=T.layers[j];In(Q.id)===F&&o.push(new wt(g,h.id,`duplicate layer id "${h.id}", previously used at line ${Q.id.__line__}`))}}if("ref"in h){let F;["type","source","source-layer","filter","layout"].forEach(j=>{j in h&&o.push(new wt(g,h[j],`"${j}" is prohibited for ref layers`))}),T.layers.forEach(j=>{In(j.id)===B&&(F=j)}),F?F.ref?o.push(new wt(g,h.ref,"ref cannot reference another ref layer")):k=In(F.type):o.push(new wt(g,h.ref,`ref layer "${B}" not found`))}else if(k!=="background")if(h.source){const F=T.sources&&T.sources[h.source],j=F&&In(F.type);F?j==="vector"&&k==="raster"?o.push(new wt(g,h.source,`layer "${h.id}" requires a raster source`)):j==="raster"&&k!=="raster"?o.push(new wt(g,h.source,`layer "${h.id}" requires a vector source`)):j!=="vector"||h["source-layer"]?j==="raster-dem"&&k!=="hillshade"?o.push(new wt(g,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!h.paint||!h.paint["line-gradient"]||j==="geojson"&&F.lineMetrics||o.push(new wt(g,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new wt(g,h,`layer "${h.id}" must specify a "source-layer"`)):o.push(new wt(g,h.source,`source "${h.source}" not found`))}else o.push(new wt(g,h,'missing required property "source"'));return o=o.concat(As({key:g,value:h,valueSpec:C.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>zr({key:`${g}.type`,value:h.type,valueSpec:C.layer.type,style:c.style,styleSpec:c.styleSpec,object:h,objectKey:"type"}),filter:Xs,layout:F=>As({layer:h,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":j=>Wu(or({layerType:k},j))}}),paint:F=>As({layer:h,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":j=>xc(or({layerType:k},j))}})}})),o}function Da(c){const o=c.value,h=c.key,g=Qn(o);return g!=="string"?[new wt(h,o,`string expected, ${g} found`)]:[]}const $u={promoteId:function({key:c,value:o}){if(Qn(o)==="string")return Da({key:c,value:o});{const h=[];for(const g in o)h.push(...Da({key:`${c}.${g}`,value:o[g]}));return h}}};function Ra(c){const o=c.value,h=c.key,g=c.styleSpec,T=c.style;if(!o.type)return[new wt(h,o,'"type" is required')];const C=In(o.type);let k;switch(C){case"vector":case"raster":case"raster-dem":return k=As({key:h,value:o,valueSpec:g[`source_${C.replace("-","_")}`],style:c.style,styleSpec:g,objectElementValidators:$u}),k;case"geojson":if(k=As({key:h,value:o,valueSpec:g.source_geojson,style:T,styleSpec:g,objectElementValidators:$u}),o.cluster)for(const B in o.clusterProperties){const[F,j]=o.clusterProperties[B],Q=typeof F=="string"?[F,["accumulated"],["get",B]]:F;k.push(...Qo({key:`${h}.${B}.map`,value:j,expressionContext:"cluster-map"})),k.push(...Qo({key:`${h}.${B}.reduce`,value:Q,expressionContext:"cluster-reduce"}))}return k;case"video":return As({key:h,value:o,valueSpec:g.source_video,style:T,styleSpec:g});case"image":return As({key:h,value:o,valueSpec:g.source_image,style:T,styleSpec:g});case"canvas":return[new wt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return yl({key:`${h}.type`,value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:T,styleSpec:g})}}function za(c){const o=c.value,h=c.styleSpec,g=h.light,T=c.style;let C=[];const k=Qn(o);if(o===void 0)return C;if(k!=="object")return C=C.concat([new wt("light",o,`object expected, ${k} found`)]),C;for(const B in o){const F=B.match(/^(.*)-transition$/);C=C.concat(F&&g[F[1]]&&g[F[1]].transition?zr({key:B,value:o[B],valueSpec:h.transition,style:T,styleSpec:h}):g[B]?zr({key:B,value:o[B],valueSpec:g[B],style:T,styleSpec:h}):[new wt(B,o[B],`unknown property "${B}"`)])}return C}function Ji(c){const o=c.value,h=c.styleSpec,g=h.terrain,T=c.style;let C=[];const k=Qn(o);if(o===void 0)return C;if(k!=="object")return C=C.concat([new wt("terrain",o,`object expected, ${k} found`)]),C;for(const B in o)C=C.concat(g[B]?zr({key:B,value:o[B],valueSpec:g[B],style:T,styleSpec:h}):[new wt(B,o[B],`unknown property "${B}"`)]);return C}const Ds={"*":()=>[],array:Gu,boolean:function(c){const o=c.value,h=c.key,g=Qn(o);return g!=="boolean"?[new wt(h,o,`boolean expected, ${g} found`)]:[]},number:yc,color:function(c){const o=c.key,h=c.value,g=Qn(h);return g!=="string"?[new wt(o,h,`color expected, ${g} found`)]:Is(h)===null?[new wt(o,h,`color expected, "${h}" found`)]:[]},constants:Ms,enum:yl,filter:Xs,function:ju,layer:b0,object:As,source:Ra,light:za,terrain:Ji,string:Da,formatted:function(c){return Da(c).length===0?[]:Qo(c)},resolvedImage:function(c){return Da(c).length===0?[]:Qo(c)},padding:function(c){const o=c.key,h=c.value;if(Qn(h)==="array"){if(h.length<1||h.length>4)return[new wt(o,h,`padding requires 1 to 4 values; ${h.length} values found`)];const g={type:"number"};let T=[];for(let C=0;C<h.length;C++)T=T.concat(zr({key:`${o}[${C}]`,value:h[C],valueSpec:g}));return T}return yc({key:o,value:h,valueSpec:{}})}};function zr(c){const o=c.value,h=c.valueSpec,g=c.styleSpec;return h.expression&&fi(In(o))?ju(c):h.expression&&ml(wr(o))?Qo(c):h.type&&Ds[h.type]?Ds[h.type](c):As(or({},c,{valueSpec:h.type?g[h.type]:h}))}function bl(c){const o=c.value,h=c.key,g=Da(c);return g.length||(o.indexOf("{fontstack}")===-1&&g.push(new wt(h,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&g.push(new wt(h,o,'"glyphs" url must include a "{range}" token'))),g}function To(c,o=nt){let h=[];return h=h.concat(zr({key:"",value:c,valueSpec:o.$root,styleSpec:o,style:c,objectElementValidators:{glyphs:bl,"*":()=>[]}})),c.constants&&(h=h.concat(Ms({key:"constants",value:c.constants,style:c,styleSpec:o}))),qu(h)}function qu(c){return[].concat(c).sort((o,h)=>o.line-h.line)}function Qs(c){return function(...o){return qu(c.apply(this,o))}}To.source=Qs(Ra),To.light=Qs(za),To.terrain=Qs(Ji),To.layer=Qs(b0),To.filter=Qs(Xs),To.paintProperty=Qs(xc),To.layoutProperty=Qs(Wu);const El=To,wc=El.light,B1=El.paintProperty,O1=El.layoutProperty;function Ba(c,o){let h=!1;if(o&&o.length)for(const g of o)c.fire(new vo(new Error(g.message))),h=!0;return h}class Oa{constructor(o,h,g){const T=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;const k=new Int32Array(this.arrayBuffer);o=k[0],this.d=(h=k[1])+2*(g=k[2]);for(let F=0;F<this.d*this.d;F++){const j=k[3+F],Q=k[3+F+1];T.push(j===Q?null:k.subarray(j,Q))}const B=k[3+T.length+1];this.keys=k.subarray(k[3+T.length],B),this.bboxes=k.subarray(B),this.insert=this._insertReadonly}else{this.d=h+2*g;for(let k=0;k<this.d*this.d;k++)T.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=o,this.padding=g,this.scale=h/o,this.uid=0;const C=g/h*o;this.min=-C,this.max=o+C}insert(o,h,g,T,C){this._forEachCell(h,g,T,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(o),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(T),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(o,h,g,T,C,k){this.cells[C].push(k)}query(o,h,g,T,C){const k=this.min,B=this.max;if(o<=k&&h<=k&&B<=g&&B<=T&&!C)return Array.prototype.slice.call(this.keys);{const F=[];return this._forEachCell(o,h,g,T,this._queryCell,F,{},C),F}}_queryCell(o,h,g,T,C,k,B,F){const j=this.cells[C];if(j!==null){const Q=this.keys,te=this.bboxes;for(let ae=0;ae<j.length;ae++){const he=j[ae];if(B[he]===void 0){const fe=4*he;(F?F(te[fe+0],te[fe+1],te[fe+2],te[fe+3]):o<=te[fe+2]&&h<=te[fe+3]&&g>=te[fe+0]&&T>=te[fe+1])?(B[he]=!0,k.push(Q[he])):B[he]=!1}}}}_forEachCell(o,h,g,T,C,k,B,F){const j=this._convertToCellCoord(o),Q=this._convertToCellCoord(h),te=this._convertToCellCoord(g),ae=this._convertToCellCoord(T);for(let he=j;he<=te;he++)for(let fe=Q;fe<=ae;fe++){const Le=this.d*fe+he;if((!F||F(this._convertFromCellCoord(he),this._convertFromCellCoord(fe),this._convertFromCellCoord(he+1),this._convertFromCellCoord(fe+1)))&&C.call(this,o,h,g,T,Le,k,B,F))return}}_convertFromCellCoord(o){return(o-this.padding)/this.scale}_convertToCellCoord(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const o=this.cells,h=3+this.cells.length+1+1;let g=0;for(let k=0;k<this.cells.length;k++)g+=this.cells[k].length;const T=new Int32Array(h+g+this.keys.length+this.bboxes.length);T[0]=this.extent,T[1]=this.n,T[2]=this.padding;let C=h;for(let k=0;k<o.length;k++){const B=o[k];T[3+k]=C,T.set(B,C),C+=B.length}return T[3+o.length]=C,T.set(this.keys,C),C+=this.keys.length,T[3+o.length+1]=C,T.set(this.bboxes,C),C+=this.bboxes.length,T.buffer}static serialize(o,h){const g=o.toArrayBuffer();return h&&h.push(g),{buffer:g}}static deserialize(o){return new Oa(o.buffer)}}const ps={};function Ft(c,o,h={}){if(ps[c])throw new Error(`${c} is already registered.`);Object.defineProperty(o,"_classRegistryKey",{value:c,writeable:!1}),ps[c]={klass:o,omit:h.omit||[],shallow:h.shallow||[]}}Ft("Object",Object),Ft("TransferableGridIndex",Oa),Ft("Color",f),Ft("Error",Error),Ft("AJAXError",jn),Ft("ResolvedImage",Me),Ft("StylePropertyFunction",ri),Ft("StyleExpression",pl,{omit:["_evaluator"]}),Ft("ZoomDependentExpression",gl),Ft("ZoomConstantExpression",Xo),Ft("CompoundExpression",Ln,{omit:["_evaluate"]});for(const c in Pa)Pa[c]._classRegistryKey||Ft(`Expression_${c}`,Pa[c]);function Zu(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Ko(c,o){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob)return c;if(Zu(c)||St(c))return o&&o.push(c),c;if(ArrayBuffer.isView(c)){const h=c;return o&&o.push(h.buffer),h}if(c instanceof ImageData)return o&&o.push(c.data.buffer),c;if(Array.isArray(c)){const h=[];for(const g of c)h.push(Ko(g,o));return h}if(typeof c=="object"){const h=c.constructor,g=h._classRegistryKey;if(!g)throw new Error("can't serialize object of unregistered class");if(!ps[g])throw new Error(`${g} is not registered.`);const T=h.serialize?h.serialize(c,o):{};if(h.serialize){if(o&&T===o[o.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in c){if(!c.hasOwnProperty(C)||ps[g].omit.indexOf(C)>=0)continue;const k=c[C];T[C]=ps[g].shallow.indexOf(C)>=0?k:Ko(k,o)}c instanceof Error&&(T.message=c.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return g!=="Object"&&(T.$name=g),T}throw new Error("can't serialize object of type "+typeof c)}function So(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||Zu(c)||St(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(So);if(typeof c=="object"){const o=c.$name||"Object";if(!ps[o])throw new Error(`can't deserialize unregistered class ${o}`);const{klass:h}=ps[o];if(!h)throw new Error(`can't deserialize unregistered class ${o}`);if(h.deserialize)return h.deserialize(c);const g=Object.create(h.prototype);for(const T of Object.keys(c)){if(T==="$name")continue;const C=c[T];g[T]=ps[o].shallow.indexOf(T)>=0?C:So(C)}return g}throw new Error("can't deserialize object of type "+typeof c)}class bc{constructor(){this.first=!0}update(o,h){const g=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=h),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=g,!0))}}const Dt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function E0(c){for(const o of c)if(T0(o.charCodeAt(0)))return!0;return!1}function Xu(c){for(const o of c)if(!Ec(o.charCodeAt(0)))return!1;return!0}function Ec(c){return!(Dt.Arabic(c)||Dt["Arabic Supplement"](c)||Dt["Arabic Extended-A"](c)||Dt["Arabic Presentation Forms-A"](c)||Dt["Arabic Presentation Forms-B"](c))}function T0(c){return!(c!==746&&c!==747&&(c<4352||!(Dt["Bopomofo Extended"](c)||Dt.Bopomofo(c)||Dt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Dt["CJK Compatibility Ideographs"](c)||Dt["CJK Compatibility"](c)||Dt["CJK Radicals Supplement"](c)||Dt["CJK Strokes"](c)||!(!Dt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Dt["CJK Unified Ideographs Extension A"](c)||Dt["CJK Unified Ideographs"](c)||Dt["Enclosed CJK Letters and Months"](c)||Dt["Hangul Compatibility Jamo"](c)||Dt["Hangul Jamo Extended-A"](c)||Dt["Hangul Jamo Extended-B"](c)||Dt["Hangul Jamo"](c)||Dt["Hangul Syllables"](c)||Dt.Hiragana(c)||Dt["Ideographic Description Characters"](c)||Dt.Kanbun(c)||Dt["Kangxi Radicals"](c)||Dt["Katakana Phonetic Extensions"](c)||Dt.Katakana(c)&&c!==12540||!(!Dt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Dt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Dt["Unified Canadian Aboriginal Syllabics"](c)||Dt["Unified Canadian Aboriginal Syllabics Extended"](c)||Dt["Vertical Forms"](c)||Dt["Yijing Hexagram Symbols"](c)||Dt["Yi Syllables"](c)||Dt["Yi Radicals"](c))))}function Rs(c){return!(T0(c)||function(o){return!!(Dt["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||Dt["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||Dt["Letterlike Symbols"](o)||Dt["Number Forms"](o)||Dt["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||Dt["Control Pictures"](o)&&o!==9251||Dt["Optical Character Recognition"](o)||Dt["Enclosed Alphanumerics"](o)||Dt["Geometric Shapes"](o)||Dt["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Dt["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Dt["CJK Symbols and Punctuation"](o)||Dt.Katakana(o)||Dt["Private Use Area"](o)||Dt["CJK Compatibility Forms"](o)||Dt["Small Form Variants"](o)||Dt["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(c))}function Tc(c){return c>=1424&&c<=2303||Dt["Arabic Presentation Forms-A"](c)||Dt["Arabic Presentation Forms-B"](c)}function F1(c,o){return!(!o&&Tc(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Dt.Khmer(c))}function Qu(c){for(const o of c)if(Tc(o.charCodeAt(0)))return!0;return!1}const Sc="deferred",Cc="loading",Pc="loaded";let zs=null,pr="unavailable",Ys=null;const Yu=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(pr="error"),zs&&zs(c)};function Fa(){Mc.fire(new Lr("pluginStateChange",{pluginStatus:pr,pluginURL:Ys}))}const Mc=new $r,Tl=function(){return pr},Ku=function(){if(pr!==Sc||!Ys)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");pr=Cc,Fa(),Ys&&ci({url:Ys},c=>{c?Yu(c):(pr=Pc,Fa())})},Zr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>pr===Pc||Zr.applyArabicShaping!=null,isLoading:()=>pr===Cc,setState(c){if(!et())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");pr=c.pluginStatus,Ys=c.pluginURL},isParsed(){if(!et())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Zr.applyArabicShaping!=null&&Zr.processBidirectionalText!=null&&Zr.processStyledBidirectionalText!=null},getPluginURL(){if(!et())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ys}};class mi{constructor(o,h){this.zoom=o,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new bc,this.transition={})}isSupportedScript(o){return function(h,g){for(const T of h)if(!F1(T.charCodeAt(0),g))return!1;return!0}(o,Zr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const o=this.zoom,h=o-Math.floor(o),g=this.crossFadingFactor();return o>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*h}}}class Sl{constructor(o,h){this.property=o,this.value=h,this.expression=function(g,T){if(fi(g))return new ri(g,T);if(ml(g)){const C=_l(g,T);if(C.result==="error")throw new Error(C.value.map(k=>`${k.key}: ${k.message}`).join(", "));return C.value}{let C=g;return T.type==="color"&&typeof g=="string"?C=f.parse(g):T.type!=="padding"||typeof g!="number"&&!Array.isArray(g)||(C=Ee.parse(g)),{kind:"constant",evaluate:()=>C}}}(h===void 0?o.specification.default:h,o.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,h,g){return this.property.possiblyEvaluate(this,o,h,g)}}class S0{constructor(o){this.property=o,this.value=new Sl(o,void 0)}transitioned(o,h){return new eh(this.property,this.value,h,q({},o.transition,this.transition),o.now)}untransitioned(){return new eh(this.property,this.value,null,{},0)}}class Ju{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return re(this._values[o].value.value)}setValue(o,h){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new S0(this._values[o].property)),this._values[o].value=new Sl(this._values[o].property,h===null?void 0:re(h))}getTransition(o){return re(this._values[o].transition)}setTransition(o,h){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new S0(this._values[o].property)),this._values[o].transition=re(h)||void 0}serialize(){const o={};for(const h of Object.keys(this._values)){const g=this.getValue(h);g!==void 0&&(o[h]=g);const T=this.getTransition(h);T!==void 0&&(o[`${h}-transition`]=T)}return o}transitioned(o,h){const g=new Ic(this._properties);for(const T of Object.keys(this._values))g._values[T]=this._values[T].transitioned(o,h._values[T]);return g}untransitioned(){const o=new Ic(this._properties);for(const h of Object.keys(this._values))o._values[h]=this._values[h].untransitioned();return o}}class eh{constructor(o,h,g,T,C){this.property=o,this.value=h,this.begin=C+T.delay||0,this.end=this.begin+T.duration||0,o.specification.transition&&(T.delay||T.duration)&&(this.prior=g)}possiblyEvaluate(o,h,g){const T=o.now||0,C=this.value.possiblyEvaluate(o,h,g),k=this.prior;if(k){if(T>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(T<this.begin)return k.possiblyEvaluate(o,h,g);{const B=(T-this.begin)/(this.end-this.begin);return this.property.interpolate(k.possiblyEvaluate(o,h,g),C,function(F){if(F<=0)return 0;if(F>=1)return 1;const j=F*F,Q=j*F;return 4*(F<.5?Q:3*(F-j)+Q-.75)}(B))}}return C}}class Ic{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,h,g){const T=new Cl(this._properties);for(const C of Object.keys(this._values))T._values[C]=this._values[C].possiblyEvaluate(o,h,g);return T}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class th{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return re(this._values[o].value)}setValue(o,h){this._values[o]=new Sl(this._values[o].property,h===null?void 0:re(h))}serialize(){const o={};for(const h of Object.keys(this._values)){const g=this.getValue(h);g!==void 0&&(o[h]=g)}return o}possiblyEvaluate(o,h,g){const T=new Cl(this._properties);for(const C of Object.keys(this._values))T._values[C]=this._values[C].possiblyEvaluate(o,h,g);return T}}class si{constructor(o,h,g){this.property=o,this.value=h,this.parameters=g}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,h,g,T){return this.property.evaluate(this.value,this.parameters,o,h,g,T)}}class Cl{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class Wt{constructor(o){this.specification=o}possiblyEvaluate(o,h){if(o.isDataDriven())throw new Error("Value should not be data driven");return o.expression.evaluate(h)}interpolate(o,h,g){const T=ki[this.specification.type];return T?T(o,h,g):o}}class en{constructor(o,h){this.specification=o,this.overrides=h}possiblyEvaluate(o,h,g,T){return new si(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(h,null,{},g,T)}:o.expression,h)}interpolate(o,h,g){if(o.value.kind!=="constant"||h.value.kind!=="constant")return o;if(o.value.value===void 0||h.value.value===void 0)return new si(this,{kind:"constant",value:void 0},o.parameters);const T=ki[this.specification.type];return T?new si(this,{kind:"constant",value:T(o.value.value,h.value.value,g)},o.parameters):o}evaluate(o,h,g,T,C,k){return o.kind==="constant"?o.value:o.evaluate(h,g,T,C,k)}}class er extends en{possiblyEvaluate(o,h,g,T){if(o.value===void 0)return new si(this,{kind:"constant",value:void 0},h);if(o.expression.kind==="constant"){const C=o.expression.evaluate(h,null,{},g,T),k=o.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,B=this._calculate(k,k,k,h);return new si(this,{kind:"constant",value:B},h)}if(o.expression.kind==="camera"){const C=this._calculate(o.expression.evaluate({zoom:h.zoom-1}),o.expression.evaluate({zoom:h.zoom}),o.expression.evaluate({zoom:h.zoom+1}),h);return new si(this,{kind:"constant",value:C},h)}return new si(this,o.expression,h)}evaluate(o,h,g,T,C,k){if(o.kind==="source"){const B=o.evaluate(h,g,T,C,k);return this._calculate(B,B,B,h)}return o.kind==="composite"?this._calculate(o.evaluate({zoom:Math.floor(h.zoom)-1},g,T),o.evaluate({zoom:Math.floor(h.zoom)},g,T),o.evaluate({zoom:Math.floor(h.zoom)+1},g,T),h):o.value}_calculate(o,h,g,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:o,to:h}:{from:g,to:h}}interpolate(o){return o}}class kc{constructor(o){this.specification=o}possiblyEvaluate(o,h,g,T){if(o.value!==void 0){if(o.expression.kind==="constant"){const C=o.expression.evaluate(h,null,{},g,T);return this._calculate(C,C,C,h)}return this._calculate(o.expression.evaluate(new mi(Math.floor(h.zoom-1),h)),o.expression.evaluate(new mi(Math.floor(h.zoom),h)),o.expression.evaluate(new mi(Math.floor(h.zoom+1),h)),h)}}_calculate(o,h,g,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:o,to:h}:{from:g,to:h}}interpolate(o){return o}}class Co{constructor(o){this.specification=o}possiblyEvaluate(o,h,g,T){return!!o.expression.evaluate(h,null,{},g,T)}interpolate(){return!1}}class tr{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in o){const g=o[h];g.specification.overridable&&this.overridableProperties.push(h);const T=this.defaultPropertyValues[h]=new Sl(g,void 0),C=this.defaultTransitionablePropertyValues[h]=new S0(g);this.defaultTransitioningPropertyValues[h]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=T.possiblyEvaluate({})}}}Ft("DataDrivenProperty",en),Ft("DataConstantProperty",Wt),Ft("CrossFadedDataDrivenProperty",er),Ft("CrossFadedProperty",kc),Ft("ColorRampProperty",Co);const Ks="-transition";class ms extends $r{constructor(o,h){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1},o.type!=="custom"&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type!=="background"&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),h.layout&&(this._unevaluatedLayout=new th(h.layout)),h.paint)){this._transitionablePaint=new Ju(h.paint);for(const g in o.paint)this.setPaintProperty(g,o.paint[g],{validate:!1});for(const g in o.layout)this.setLayoutProperty(g,o.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Cl(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,h,g={}){h!=null&&this._validate(O1,`layers.${this.id}.layout.${o}`,o,h,g)||(o!=="visibility"?this._unevaluatedLayout.setValue(o,h):this.visibility=h)}getPaintProperty(o){return o.endsWith(Ks)?this._transitionablePaint.getTransition(o.slice(0,-Ks.length)):this._transitionablePaint.getValue(o)}setPaintProperty(o,h,g={}){if(h!=null&&this._validate(B1,`layers.${this.id}.paint.${o}`,o,h,g))return!1;if(o.endsWith(Ks))return this._transitionablePaint.setTransition(o.slice(0,-Ks.length),h||void 0),!1;{const T=this._transitionablePaint._values[o],C=T.property.specification["property-type"]==="cross-faded-data-driven",k=T.value.isDataDriven(),B=T.value;this._transitionablePaint.setValue(o,h),this._handleSpecialPaintPropertyUpdate(o);const F=this._transitionablePaint._values[o].value;return F.isDataDriven()||k||C||this._handleOverridablePaintPropertyUpdate(o,B,F)}}_handleSpecialPaintPropertyUpdate(o){}_handleOverridablePaintPropertyUpdate(o,h,g){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,h){o.getCrossfadeParameters&&(this._crossfadeParameters=o.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,h)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),ie(o,(h,g)=>!(h===void 0||g==="layout"&&!Object.keys(h).length||g==="paint"&&!Object.keys(h).length))}_validate(o,h,g,T,C={}){return(!C||C.validate!==!1)&&Ba(this,o.call(El,{key:h,layerType:this.type,objectKey:g,value:T,styleSpec:nt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const h=this.paint.get(o);if(h instanceof si&&di(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const Lc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Js{constructor(o,h){this._structArray=o,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,h){return o._trim(),h&&(o.isTransferred=!0,h.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const h=Object.create(this.prototype);return h.arrayBuffer=o.arrayBuffer,h.length=o.length,h.capacity=o.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Bi(c,o=1){let h=0,g=0;return{members:c.map(T=>{const C=Lc[T.type].BYTES_PER_ELEMENT,k=h=Dc(h,Math.max(o,C)),B=T.components||1;return g=Math.max(g,C),h+=C*B,{name:T.name,type:T.type,components:B,offset:k}}),size:Dc(h,Math.max(g,o)),alignment:o}}function Dc(c,o){return Math.ceil(c/o)*o}class Jo extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,h)}emplace(o,h,g){const T=2*o;return this.int16[T+0]=h,this.int16[T+1]=g,o}}Jo.prototype.bytesPerElement=4,Ft("StructArrayLayout2i4",Jo);class b extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T){const C=this.length;return this.resize(C+1),this.emplace(C,o,h,g,T)}emplace(o,h,g,T,C){const k=4*o;return this.int16[k+0]=h,this.int16[k+1]=g,this.int16[k+2]=T,this.int16[k+3]=C,o}}b.prototype.bytesPerElement=8,Ft("StructArrayLayout4i8",b);class l extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k){const B=this.length;return this.resize(B+1),this.emplace(B,o,h,g,T,C,k)}emplace(o,h,g,T,C,k,B){const F=6*o;return this.int16[F+0]=h,this.int16[F+1]=g,this.int16[F+2]=T,this.int16[F+3]=C,this.int16[F+4]=k,this.int16[F+5]=B,o}}l.prototype.bytesPerElement=12,Ft("StructArrayLayout2i4i12",l);class p extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k){const B=this.length;return this.resize(B+1),this.emplace(B,o,h,g,T,C,k)}emplace(o,h,g,T,C,k,B){const F=4*o,j=8*o;return this.int16[F+0]=h,this.int16[F+1]=g,this.uint8[j+4]=T,this.uint8[j+5]=C,this.uint8[j+6]=k,this.uint8[j+7]=B,o}}p.prototype.bytesPerElement=8,Ft("StructArrayLayout2i4ub8",p);class v extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,h)}emplace(o,h,g){const T=2*o;return this.float32[T+0]=h,this.float32[T+1]=g,o}}v.prototype.bytesPerElement=8,Ft("StructArrayLayout2f8",v);class E extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j,Q){const te=this.length;return this.resize(te+1),this.emplace(te,o,h,g,T,C,k,B,F,j,Q)}emplace(o,h,g,T,C,k,B,F,j,Q,te){const ae=10*o;return this.uint16[ae+0]=h,this.uint16[ae+1]=g,this.uint16[ae+2]=T,this.uint16[ae+3]=C,this.uint16[ae+4]=k,this.uint16[ae+5]=B,this.uint16[ae+6]=F,this.uint16[ae+7]=j,this.uint16[ae+8]=Q,this.uint16[ae+9]=te,o}}E.prototype.bytesPerElement=20,Ft("StructArrayLayout10ui20",E);class P extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j,Q,te,ae){const he=this.length;return this.resize(he+1),this.emplace(he,o,h,g,T,C,k,B,F,j,Q,te,ae)}emplace(o,h,g,T,C,k,B,F,j,Q,te,ae,he){const fe=12*o;return this.int16[fe+0]=h,this.int16[fe+1]=g,this.int16[fe+2]=T,this.int16[fe+3]=C,this.uint16[fe+4]=k,this.uint16[fe+5]=B,this.uint16[fe+6]=F,this.uint16[fe+7]=j,this.int16[fe+8]=Q,this.int16[fe+9]=te,this.int16[fe+10]=ae,this.int16[fe+11]=he,o}}P.prototype.bytesPerElement=24,Ft("StructArrayLayout4i4ui4i24",P);class z extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,o,h,g)}emplace(o,h,g,T){const C=3*o;return this.float32[C+0]=h,this.float32[C+1]=g,this.float32[C+2]=T,o}}z.prototype.bytesPerElement=12,Ft("StructArrayLayout3f12",z);class N extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const h=this.length;return this.resize(h+1),this.emplace(h,o)}emplace(o,h){return this.uint32[1*o+0]=h,o}}N.prototype.bytesPerElement=4,Ft("StructArrayLayout1ul4",N);class G extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j){const Q=this.length;return this.resize(Q+1),this.emplace(Q,o,h,g,T,C,k,B,F,j)}emplace(o,h,g,T,C,k,B,F,j,Q){const te=10*o,ae=5*o;return this.int16[te+0]=h,this.int16[te+1]=g,this.int16[te+2]=T,this.int16[te+3]=C,this.int16[te+4]=k,this.int16[te+5]=B,this.uint32[ae+3]=F,this.uint16[te+8]=j,this.uint16[te+9]=Q,o}}G.prototype.bytesPerElement=20,Ft("StructArrayLayout6i1ul2ui20",G);class $ extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k){const B=this.length;return this.resize(B+1),this.emplace(B,o,h,g,T,C,k)}emplace(o,h,g,T,C,k,B){const F=6*o;return this.int16[F+0]=h,this.int16[F+1]=g,this.int16[F+2]=T,this.int16[F+3]=C,this.int16[F+4]=k,this.int16[F+5]=B,o}}$.prototype.bytesPerElement=12,Ft("StructArrayLayout2i2i2i12",$);class K extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C){const k=this.length;return this.resize(k+1),this.emplace(k,o,h,g,T,C)}emplace(o,h,g,T,C,k){const B=4*o,F=8*o;return this.float32[B+0]=h,this.float32[B+1]=g,this.float32[B+2]=T,this.int16[F+6]=C,this.int16[F+7]=k,o}}K.prototype.bytesPerElement=16,Ft("StructArrayLayout2f1f2i16",K);class se extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g,T){const C=this.length;return this.resize(C+1),this.emplace(C,o,h,g,T)}emplace(o,h,g,T,C){const k=12*o,B=3*o;return this.uint8[k+0]=h,this.uint8[k+1]=g,this.float32[B+1]=T,this.float32[B+2]=C,o}}se.prototype.bytesPerElement=12,Ft("StructArrayLayout2ub2f12",se);class ce extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,o,h,g)}emplace(o,h,g,T){const C=3*o;return this.uint16[C+0]=h,this.uint16[C+1]=g,this.uint16[C+2]=T,o}}ce.prototype.bytesPerElement=6,Ft("StructArrayLayout3ui6",ce);class xe extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j,Q,te,ae,he,fe,Le,Pe,Ge){const Ye=this.length;return this.resize(Ye+1),this.emplace(Ye,o,h,g,T,C,k,B,F,j,Q,te,ae,he,fe,Le,Pe,Ge)}emplace(o,h,g,T,C,k,B,F,j,Q,te,ae,he,fe,Le,Pe,Ge,Ye){const Fe=24*o,Ze=12*o,ct=48*o;return this.int16[Fe+0]=h,this.int16[Fe+1]=g,this.uint16[Fe+2]=T,this.uint16[Fe+3]=C,this.uint32[Ze+2]=k,this.uint32[Ze+3]=B,this.uint32[Ze+4]=F,this.uint16[Fe+10]=j,this.uint16[Fe+11]=Q,this.uint16[Fe+12]=te,this.float32[Ze+7]=ae,this.float32[Ze+8]=he,this.uint8[ct+36]=fe,this.uint8[ct+37]=Le,this.uint8[ct+38]=Pe,this.uint32[Ze+10]=Ge,this.int16[Fe+22]=Ye,o}}xe.prototype.bytesPerElement=48,Ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",xe);class ve extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g,T,C,k,B,F,j,Q,te,ae,he,fe,Le,Pe,Ge,Ye,Fe,Ze,ct,lt,Nt,jt,Rt,Pt,Tt,zt){const kt=this.length;return this.resize(kt+1),this.emplace(kt,o,h,g,T,C,k,B,F,j,Q,te,ae,he,fe,Le,Pe,Ge,Ye,Fe,Ze,ct,lt,Nt,jt,Rt,Pt,Tt,zt)}emplace(o,h,g,T,C,k,B,F,j,Q,te,ae,he,fe,Le,Pe,Ge,Ye,Fe,Ze,ct,lt,Nt,jt,Rt,Pt,Tt,zt,kt){const _t=34*o,rn=17*o;return this.int16[_t+0]=h,this.int16[_t+1]=g,this.int16[_t+2]=T,this.int16[_t+3]=C,this.int16[_t+4]=k,this.int16[_t+5]=B,this.int16[_t+6]=F,this.int16[_t+7]=j,this.uint16[_t+8]=Q,this.uint16[_t+9]=te,this.uint16[_t+10]=ae,this.uint16[_t+11]=he,this.uint16[_t+12]=fe,this.uint16[_t+13]=Le,this.uint16[_t+14]=Pe,this.uint16[_t+15]=Ge,this.uint16[_t+16]=Ye,this.uint16[_t+17]=Fe,this.uint16[_t+18]=Ze,this.uint16[_t+19]=ct,this.uint16[_t+20]=lt,this.uint16[_t+21]=Nt,this.uint16[_t+22]=jt,this.uint32[rn+12]=Rt,this.float32[rn+13]=Pt,this.float32[rn+14]=Tt,this.float32[rn+15]=zt,this.float32[rn+16]=kt,o}}ve.prototype.bytesPerElement=68,Ft("StructArrayLayout8i15ui1ul4f68",ve);class le extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const h=this.length;return this.resize(h+1),this.emplace(h,o)}emplace(o,h){return this.float32[1*o+0]=h,o}}le.prototype.bytesPerElement=4,Ft("StructArrayLayout1f4",le);class ye extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,o,h,g)}emplace(o,h,g,T){const C=3*o;return this.int16[C+0]=h,this.int16[C+1]=g,this.int16[C+2]=T,o}}ye.prototype.bytesPerElement=6,Ft("StructArrayLayout3i6",ye);class ze extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h,g){const T=this.length;return this.resize(T+1),this.emplace(T,o,h,g)}emplace(o,h,g,T){const C=4*o;return this.uint32[2*o+0]=h,this.uint16[C+2]=g,this.uint16[C+3]=T,o}}ze.prototype.bytesPerElement=8,Ft("StructArrayLayout1ul2ui8",ze);class je extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,h){const g=this.length;return this.resize(g+1),this.emplace(g,o,h)}emplace(o,h,g){const T=2*o;return this.uint16[T+0]=h,this.uint16[T+1]=g,o}}je.prototype.bytesPerElement=4,Ft("StructArrayLayout2ui4",je);class Se extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const h=this.length;return this.resize(h+1),this.emplace(h,o)}emplace(o,h){return this.uint16[1*o+0]=h,o}}Se.prototype.bytesPerElement=2,Ft("StructArrayLayout1ui2",Se);class Xe extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,h,g,T){const C=this.length;return this.resize(C+1),this.emplace(C,o,h,g,T)}emplace(o,h,g,T,C){const k=4*o;return this.float32[k+0]=h,this.float32[k+1]=g,this.float32[k+2]=T,this.float32[k+3]=C,o}}Xe.prototype.bytesPerElement=16,Ft("StructArrayLayout4f16",Xe);class He extends Js{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Ot(this.anchorPointX,this.anchorPointY)}}He.prototype.size=20;class it extends G{get(o){return new He(this,o)}}Ft("CollisionBoxArray",it);class Je extends Js{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(o){this._structArray.uint8[this._pos1+37]=o}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(o){this._structArray.uint8[this._pos1+38]=o}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(o){this._structArray.uint32[this._pos4+10]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Je.prototype.size=48;class d extends xe{get(o){return new Je(this,o)}}Ft("PlacedSymbolArray",d);class A extends Js{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(o){this._structArray.uint32[this._pos4+12]=o}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}A.prototype.size=68;class m extends ve{get(o){return new A(this,o)}}Ft("SymbolInstanceArray",m);class _ extends le{getoffsetX(o){return this.float32[1*o+0]}}Ft("GlyphOffsetArray",_);class x extends ye{getx(o){return this.int16[3*o+0]}gety(o){return this.int16[3*o+1]}gettileUnitDistanceFromAnchor(o){return this.int16[3*o+2]}}Ft("SymbolLineVertexArray",x);class S extends Js{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}S.prototype.size=8;class M extends ze{get(o){return new S(this,o)}}Ft("FeatureIndexArray",M);class L extends Jo{}class O extends Jo{}class H extends Jo{}class ee extends l{}class Ae extends p{}class we extends v{}class Re extends E{}class Te extends P{}class Be extends z{}class tt extends N{}class Ke extends ${}class We extends se{}class $e extends ce{}class Oe extends je{}const It=Bi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Et}=It;class st{constructor(o=[]){this.segments=o}prepareSegment(o,h,g,T){let C=this.segments[this.segments.length-1];return o>st.MAX_VERTEX_ARRAY_LENGTH&&be(`Max vertices per segment is ${st.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!C||C.vertexLength+o>st.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==T)&&(C={vertexOffset:h.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},T!==void 0&&(C.sortKey=T),this.segments.push(C)),C}get(){return this.segments}destroy(){for(const o of this.segments)for(const h in o.vaos)o.vaos[h].destroy()}static simpleSegment(o,h,g,T){return new st([{vertexOffset:o,primitiveOffset:h,vertexLength:g,primitiveLength:T,vaos:{},sortKey:0}])}}function dt(c,o){return 256*(c=D(Math.floor(c),0,255))+D(Math.floor(o),0,255)}st.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft("SegmentVector",st);const gn=Bi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var hn={exports:{}},sn={exports:{}};sn.exports=function(c,o){var h,g,T,C,k,B,F,j;for(g=c.length-(h=3&c.length),T=o,k=3432918353,B=461845907,j=0;j<g;)F=255&c.charCodeAt(j)|(255&c.charCodeAt(++j))<<8|(255&c.charCodeAt(++j))<<16|(255&c.charCodeAt(++j))<<24,++j,T=27492+(65535&(C=5*(65535&(T=(T^=F=(65535&(F=(F=(65535&F)*k+(((F>>>16)*k&65535)<<16)&4294967295)<<15|F>>>17))*B+(((F>>>16)*B&65535)<<16)&4294967295)<<13|T>>>19))+((5*(T>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(F=0,h){case 3:F^=(255&c.charCodeAt(j+2))<<16;case 2:F^=(255&c.charCodeAt(j+1))<<8;case 1:T^=F=(65535&(F=(F=(65535&(F^=255&c.charCodeAt(j)))*k+(((F>>>16)*k&65535)<<16)&4294967295)<<15|F>>>17))*B+(((F>>>16)*B&65535)<<16)&4294967295}return T^=c.length,T=2246822507*(65535&(T^=T>>>16))+((2246822507*(T>>>16)&65535)<<16)&4294967295,T=3266489909*(65535&(T^=T>>>13))+((3266489909*(T>>>16)&65535)<<16)&4294967295,(T^=T>>>16)>>>0};var an={exports:{}};an.exports=function(c,o){for(var h,g=c.length,T=o^g,C=0;g>=4;)h=1540483477*(65535&(h=255&c.charCodeAt(C)|(255&c.charCodeAt(++C))<<8|(255&c.charCodeAt(++C))<<16|(255&c.charCodeAt(++C))<<24))+((1540483477*(h>>>16)&65535)<<16),T=1540483477*(65535&T)+((1540483477*(T>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),g-=4,++C;switch(g){case 3:T^=(255&c.charCodeAt(C+2))<<16;case 2:T^=(255&c.charCodeAt(C+1))<<8;case 1:T=1540483477*(65535&(T^=255&c.charCodeAt(C)))+((1540483477*(T>>>16)&65535)<<16)}return T=1540483477*(65535&(T^=T>>>13))+((1540483477*(T>>>16)&65535)<<16),(T^=T>>>15)>>>0};var fn=sn.exports,vn=an.exports;hn.exports=fn,hn.exports.murmur3=fn,hn.exports.murmur2=vn;class Zn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,h,g,T){this.ids.push(_n(o)),this.positions.push(h,g,T)}getPositions(o){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=_n(o);let g=0,T=this.ids.length-1;for(;g<T;){const k=g+T>>1;this.ids[k]>=h?T=k:g=k+1}const C=[];for(;this.ids[g]===h;)C.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return C}static serialize(o,h){const g=new Float64Array(o.ids),T=new Uint32Array(o.positions);return oi(g,T,0,g.length-1),h&&h.push(g.buffer,T.buffer),{ids:g,positions:T}}static deserialize(o){const h=new Zn;return h.ids=o.ids,h.positions=o.positions,h.indexed=!0,h}}function _n(c){const o=+c;return!isNaN(o)&&o<=Number.MAX_SAFE_INTEGER?o:hn.exports(String(c))}function oi(c,o,h,g){for(;h<g;){const T=c[h+g>>1];let C=h-1,k=g+1;for(;;){do C++;while(c[C]<T);do k--;while(c[k]>T);if(C>=k)break;Ti(c,C,k),Ti(o,3*C,3*k),Ti(o,3*C+1,3*k+1),Ti(o,3*C+2,3*k+2)}k-h<g-k?(oi(c,o,h,k),h=k+1):(oi(c,o,k+1,g),g=k)}}function Ti(c,o,h){const g=c[o];c[o]=c[h],c[h]=g}Ft("FeaturePositionMap",Zn);class Po{constructor(o,h){this.gl=o.gl,this.location=h}}class Pl extends Po{constructor(o,h){super(o,h),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class nh extends Po{constructor(o,h){super(o,h),this.current=[0,0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3]))}}class Z8 extends Po{constructor(o,h){super(o,h),this.current=f.transparent}set(o){o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a))}}const bP=new Float32Array(16);function N3(c){return[dt(255*c.r,255*c.g),dt(255*c.b,255*c.a)]}class N1{constructor(o,h,g){this.value=o,this.uniformNames=h.map(T=>`u_${T}`),this.type=g}setUniform(o,h,g){o.set(g.constantOr(this.value))}getBinding(o,h,g){return this.type==="color"?new Z8(o,h):new Pl(o,h)}}class ih{constructor(o,h){this.uniformNames=h.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(o,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=o.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=o.tlbr}setUniform(o,h,g,T){const C=T==="u_pattern_to"?this.patternTo:T==="u_pattern_from"?this.patternFrom:T==="u_pixel_ratio_to"?this.pixelRatioTo:T==="u_pixel_ratio_from"?this.pixelRatioFrom:null;C&&o.set(C)}getBinding(o,h,g){return g.substr(0,9)==="u_pattern"?new nh(o,h):new Pl(o,h)}}class Ml{constructor(o,h,g,T){this.expression=o,this.type=g,this.maxValue=0,this.paintVertexAttributes=h.map(C=>({name:`a_${C}`,type:"Float32",components:g==="color"?2:1,offset:0})),this.paintVertexArray=new T}populatePaintArray(o,h,g,T,C){const k=this.paintVertexArray.length,B=this.expression.evaluate(new mi(0),h,{},T,[],C);this.paintVertexArray.resize(o),this._setPaintValue(k,o,B)}updatePaintArray(o,h,g,T){const C=this.expression.evaluate({zoom:0},g,T);this._setPaintValue(o,h,C)}_setPaintValue(o,h,g){if(this.type==="color"){const T=N3(g);for(let C=o;C<h;C++)this.paintVertexArray.emplace(C,T[0],T[1])}else{for(let T=o;T<h;T++)this.paintVertexArray.emplace(T,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ea{constructor(o,h,g,T,C,k){this.expression=o,this.uniformNames=h.map(B=>`u_${B}_t`),this.type=g,this.useIntegerZoom=T,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=h.map(B=>({name:`a_${B}`,type:"Float32",components:g==="color"?4:2,offset:0})),this.paintVertexArray=new k}populatePaintArray(o,h,g,T,C){const k=this.expression.evaluate(new mi(this.zoom),h,{},T,[],C),B=this.expression.evaluate(new mi(this.zoom+1),h,{},T,[],C),F=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(F,o,k,B)}updatePaintArray(o,h,g,T){const C=this.expression.evaluate({zoom:this.zoom},g,T),k=this.expression.evaluate({zoom:this.zoom+1},g,T);this._setPaintValue(o,h,C,k)}_setPaintValue(o,h,g,T){if(this.type==="color"){const C=N3(g),k=N3(T);for(let B=o;B<h;B++)this.paintVertexArray.emplace(B,C[0],C[1],k[0],k[1])}else{for(let C=o;C<h;C++)this.paintVertexArray.emplace(C,g,T);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(T))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,h){const g=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,T=D(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);o.set(T)}getBinding(o,h,g){return new Pl(o,h)}}class C0{constructor(o,h,g,T,C,k){this.expression=o,this.type=h,this.useIntegerZoom=g,this.zoom=T,this.layerId=k,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(o,h,g){const T=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(o),this.zoomOutPaintVertexArray.resize(o),this._setPaintValues(T,o,h.patterns&&h.patterns[this.layerId],g)}updatePaintArray(o,h,g,T,C){this._setPaintValues(o,h,g.patterns&&g.patterns[this.layerId],C)}_setPaintValues(o,h,g,T){if(!T||!g)return;const{min:C,mid:k,max:B}=g,F=T[C],j=T[k],Q=T[B];if(F&&j&&Q)for(let te=o;te<h;te++)this.zoomInPaintVertexArray.emplace(te,j.tl[0],j.tl[1],j.br[0],j.br[1],F.tl[0],F.tl[1],F.br[0],F.br[1],j.pixelRatio,F.pixelRatio),this.zoomOutPaintVertexArray.emplace(te,j.tl[0],j.tl[1],j.br[0],j.br[1],Q.tl[0],Q.tl[1],Q.br[0],Q.br[1],j.pixelRatio,Q.pixelRatio)}upload(o){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=o.createVertexBuffer(this.zoomInPaintVertexArray,gn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=o.createVertexBuffer(this.zoomOutPaintVertexArray,gn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class X8{constructor(o,h,g){this.binders={},this._buffers=[];const T=[];for(const C in o.paint._values){if(!g(C))continue;const k=o.paint.get(C);if(!(k instanceof si&&di(k.property.specification)))continue;const B=EP(C,o.type),F=k.value,j=k.property.specification.type,Q=k.property.useIntegerZoom,te=k.property.specification["property-type"],ae=te==="cross-faded"||te==="cross-faded-data-driven";if(F.kind==="constant")this.binders[C]=ae?new ih(F.value,B):new N1(F.value,B,j),T.push(`/u_${C}`);else if(F.kind==="source"||ae){const he=Q8(C,j,"source");this.binders[C]=ae?new C0(F,j,Q,h,he,o.id):new Ml(F,B,j,he),T.push(`/a_${C}`)}else{const he=Q8(C,j,"composite");this.binders[C]=new ea(F,B,j,Q,h,he),T.push(`/z_${C}`)}}this.cacheKey=T.sort().join("")}getMaxValue(o){const h=this.binders[o];return h instanceof Ml||h instanceof ea?h.maxValue:0}populatePaintArrays(o,h,g,T,C){for(const k in this.binders){const B=this.binders[k];(B instanceof Ml||B instanceof ea||B instanceof C0)&&B.populatePaintArray(o,h,g,T,C)}}setConstantPatternPositions(o,h){for(const g in this.binders){const T=this.binders[g];T instanceof ih&&T.setConstantPatternPositions(o,h)}}updatePaintArrays(o,h,g,T,C){let k=!1;for(const B in o){const F=h.getPositions(B);for(const j of F){const Q=g.feature(j.index);for(const te in this.binders){const ae=this.binders[te];if((ae instanceof Ml||ae instanceof ea||ae instanceof C0)&&ae.expression.isStateDependent===!0){const he=T.paint.get(te);ae.expression=he.value,ae.updatePaintArray(j.start,j.end,Q,o[B],C),k=!0}}}}return k}defines(){const o=[];for(const h in this.binders){const g=this.binders[h];(g instanceof N1||g instanceof ih)&&o.push(...g.uniformNames.map(T=>`#define HAS_UNIFORM_${T}`))}return o}getBinderAttributes(){const o=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof Ml||g instanceof ea)for(let T=0;T<g.paintVertexAttributes.length;T++)o.push(g.paintVertexAttributes[T].name);else if(g instanceof C0)for(let T=0;T<gn.members.length;T++)o.push(gn.members[T].name)}return o}getBinderUniforms(){const o=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof N1||g instanceof ih||g instanceof ea)for(const T of g.uniformNames)o.push(T)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o,h){const g=[];for(const T in this.binders){const C=this.binders[T];if(C instanceof N1||C instanceof ih||C instanceof ea){for(const k of C.uniformNames)if(h[k]){const B=C.getBinding(o,h[k],k);g.push({name:k,property:T,binding:B})}}}return g}setUniforms(o,h,g,T){for(const{name:C,property:k,binding:B}of h)this.binders[k].setUniform(B,T,g.get(k),C)}updatePaintBuffers(o){this._buffers=[];for(const h in this.binders){const g=this.binders[h];if(o&&g instanceof C0){const T=o.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;T&&this._buffers.push(T)}else(g instanceof Ml||g instanceof ea)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(o){for(const h in this.binders){const g=this.binders[h];(g instanceof Ml||g instanceof ea||g instanceof C0)&&g.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const h=this.binders[o];(h instanceof Ml||h instanceof ea||h instanceof C0)&&h.destroy()}}}class Rc{constructor(o,h,g=()=>!0){this.programConfigurations={};for(const T of o)this.programConfigurations[T.id]=new X8(T,h,g);this.needsUpload=!1,this._featureMap=new Zn,this._bufferOffset=0}populatePaintArrays(o,h,g,T,C,k){for(const B in this.programConfigurations)this.programConfigurations[B].populatePaintArrays(o,h,T,C,k);h.id!==void 0&&this._featureMap.add(h.id,g,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,h,g,T){for(const C of g)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(o,this._featureMap,h,C,T)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}function EP(c,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${o}-`,"").replace(/-/g,"_")]}function Q8(c,o,h){const g={color:{source:v,composite:Xe},number:{source:le,composite:v}},T=function(C){return{"line-pattern":{source:Re,composite:Re},"fill-pattern":{source:Re,composite:Re},"fill-extrusion-pattern":{source:Re,composite:Re}}[C]}(c);return T&&T[h]||g[o][h]}Ft("ConstantBinder",N1),Ft("CrossFadedConstantBinder",ih),Ft("SourceExpressionBinder",Ml),Ft("CrossFadedCompositeBinder",C0),Ft("CompositeExpressionBinder",ea),Ft("ProgramConfiguration",X8,{omit:["_buffers"]}),Ft("ProgramConfigurationSet",Rc);var nr=8192;const U3=Math.pow(2,14)-1,Y8=-U3-1;function zc(c){const o=nr/c.extent,h=c.loadGeometry();for(let g=0;g<h.length;g++){const T=h[g];for(let C=0;C<T.length;C++){const k=T[C],B=Math.round(k.x*o),F=Math.round(k.y*o);k.x=D(B,Y8,U3),k.y=D(F,Y8,U3),(B<k.x||B>k.x+1||F<k.y||F>k.y+1)&&be("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Bc(c,o){return{type:c.type,id:c.id,properties:c.properties,geometry:o?zc(c):[]}}function Y2(c,o,h,g,T){c.emplaceBack(2*o+(g+1)/2,2*h+(T+1)/2)}class V3{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(h=>h.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new O,this.indexArray=new $e,this.segments=new st,this.programConfigurations=new Rc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(o,h,g){const T=this.layers[0],C=[];let k=null,B=!1;T.type==="circle"&&(k=T.layout.get("circle-sort-key"),B=!k.isConstant());for(const{feature:F,id:j,index:Q,sourceLayerIndex:te}of o){const ae=this.layers[0]._featureFilter.needGeometry,he=Bc(F,ae);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),he,g))continue;const fe=B?k.evaluate(he,{},g):void 0,Le={id:j,properties:F.properties,type:F.type,sourceLayerIndex:te,index:Q,geometry:ae?he.geometry:zc(F),patterns:{},sortKey:fe};C.push(Le)}B&&C.sort((F,j)=>F.sortKey-j.sortKey);for(const F of C){const{geometry:j,index:Q,sourceLayerIndex:te}=F,ae=o[Q].feature;this.addFeature(F,j,Q,g),h.featureIndex.insert(ae,j,Q,te,this.index)}}update(o,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,h,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Et),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,h,g,T){for(const C of h)for(const k of C){const B=k.x,F=k.y;if(B<0||B>=nr||F<0||F>=nr)continue;const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),Q=j.vertexLength;Y2(this.layoutVertexArray,B,F,-1,-1),Y2(this.layoutVertexArray,B,F,1,-1),Y2(this.layoutVertexArray,B,F,1,1),Y2(this.layoutVertexArray,B,F,-1,1),this.indexArray.emplaceBack(Q,Q+1,Q+2),this.indexArray.emplaceBack(Q,Q+3,Q+2),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,{},T)}}function K8(c,o){for(let h=0;h<c.length;h++)if(rh(o,c[h]))return!0;for(let h=0;h<o.length;h++)if(rh(c,o[h]))return!0;return!!G3(c,o)}function TP(c,o,h){return!!rh(c,o)||!!j3(o,c,h)}function J8(c,o){if(c.length===1)return t7(o,c[0]);for(let h=0;h<o.length;h++){const g=o[h];for(let T=0;T<g.length;T++)if(rh(c,g[T]))return!0}for(let h=0;h<c.length;h++)if(t7(o,c[h]))return!0;for(let h=0;h<o.length;h++)if(G3(c,o[h]))return!0;return!1}function SP(c,o,h){if(c.length>1){if(G3(c,o))return!0;for(let g=0;g<o.length;g++)if(j3(o[g],c,h))return!0}for(let g=0;g<c.length;g++)if(j3(c[g],o,h))return!0;return!1}function G3(c,o){if(c.length===0||o.length===0)return!1;for(let h=0;h<c.length-1;h++){const g=c[h],T=c[h+1];for(let C=0;C<o.length-1;C++)if(CP(g,T,o[C],o[C+1]))return!0}return!1}function CP(c,o,h,g){return De(c,h,g)!==De(o,h,g)&&De(c,o,h)!==De(c,o,g)}function j3(c,o,h){const g=h*h;if(o.length===1)return c.distSqr(o[0])<g;for(let T=1;T<o.length;T++)if(e7(c,o[T-1],o[T])<g)return!0;return!1}function e7(c,o,h){const g=o.distSqr(h);if(g===0)return c.distSqr(o);const T=((c.x-o.x)*(h.x-o.x)+(c.y-o.y)*(h.y-o.y))/g;return c.distSqr(T<0?o:T>1?h:h.sub(o)._mult(T)._add(o))}function t7(c,o){let h,g,T,C=!1;for(let k=0;k<c.length;k++){h=c[k];for(let B=0,F=h.length-1;B<h.length;F=B++)g=h[B],T=h[F],g.y>o.y!=T.y>o.y&&o.x<(T.x-g.x)*(o.y-g.y)/(T.y-g.y)+g.x&&(C=!C)}return C}function rh(c,o){let h=!1;for(let g=0,T=c.length-1;g<c.length;T=g++){const C=c[g],k=c[T];C.y>o.y!=k.y>o.y&&o.x<(k.x-C.x)*(o.y-C.y)/(k.y-C.y)+C.x&&(h=!h)}return h}function PP(c,o,h){const g=h[0],T=h[2];if(c.x<g.x&&o.x<g.x||c.x>T.x&&o.x>T.x||c.y<g.y&&o.y<g.y||c.y>T.y&&o.y>T.y)return!1;const C=De(c,o,h[0]);return C!==De(c,o,h[1])||C!==De(c,o,h[2])||C!==De(c,o,h[3])}function U1(c,o,h){const g=o.paint.get(c).value;return g.kind==="constant"?g.value:h.programConfigurations.get(o.id).getMaxValue(c)}function K2(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function J2(c,o,h,g,T){if(!o[0]&&!o[1])return c;const C=Ot.convert(o)._mult(T);h==="viewport"&&C._rotate(-g);const k=[];for(let B=0;B<c.length;B++)k.push(c[B].sub(C));return k}Ft("CircleBucket",V3,{omit:["layers"]});const MP=new tr({"circle-sort-key":new en(nt.layout_circle["circle-sort-key"])});var IP={paint:new tr({"circle-radius":new en(nt.paint_circle["circle-radius"]),"circle-color":new en(nt.paint_circle["circle-color"]),"circle-blur":new en(nt.paint_circle["circle-blur"]),"circle-opacity":new en(nt.paint_circle["circle-opacity"]),"circle-translate":new Wt(nt.paint_circle["circle-translate"]),"circle-translate-anchor":new Wt(nt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Wt(nt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Wt(nt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new en(nt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new en(nt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new en(nt.paint_circle["circle-stroke-opacity"])}),layout:MP},Xr=1e-6,Qr=typeof Float32Array<"u"?Float32Array:Array;function n7(){var c=new Qr(9);return Qr!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function H3(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function i7(c,o,h){var g=o[0],T=o[1],C=o[2],k=o[3],B=o[4],F=o[5],j=o[6],Q=o[7],te=o[8],ae=o[9],he=o[10],fe=o[11],Le=o[12],Pe=o[13],Ge=o[14],Ye=o[15],Fe=h[0],Ze=h[1],ct=h[2],lt=h[3];return c[0]=Fe*g+Ze*B+ct*te+lt*Le,c[1]=Fe*T+Ze*F+ct*ae+lt*Pe,c[2]=Fe*C+Ze*j+ct*he+lt*Ge,c[3]=Fe*k+Ze*Q+ct*fe+lt*Ye,c[4]=(Fe=h[4])*g+(Ze=h[5])*B+(ct=h[6])*te+(lt=h[7])*Le,c[5]=Fe*T+Ze*F+ct*ae+lt*Pe,c[6]=Fe*C+Ze*j+ct*he+lt*Ge,c[7]=Fe*k+Ze*Q+ct*fe+lt*Ye,c[8]=(Fe=h[8])*g+(Ze=h[9])*B+(ct=h[10])*te+(lt=h[11])*Le,c[9]=Fe*T+Ze*F+ct*ae+lt*Pe,c[10]=Fe*C+Ze*j+ct*he+lt*Ge,c[11]=Fe*k+Ze*Q+ct*fe+lt*Ye,c[12]=(Fe=h[12])*g+(Ze=h[13])*B+(ct=h[14])*te+(lt=h[15])*Le,c[13]=Fe*T+Ze*F+ct*ae+lt*Pe,c[14]=Fe*C+Ze*j+ct*he+lt*Ge,c[15]=Fe*k+Ze*Q+ct*fe+lt*Ye,c}Math.hypot||(Math.hypot=function(){for(var c=0,o=arguments.length;o--;)c+=arguments[o]*arguments[o];return Math.sqrt(c)});var V1,kP=i7;function r7(){var c=new Qr(3);return Qr!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function s7(c,o,h){var g=new Qr(3);return g[0]=c,g[1]=o,g[2]=h,g}function eA(c,o,h){var g=o[0],T=o[1],C=o[2],k=o[3];return c[0]=h[0]*g+h[4]*T+h[8]*C+h[12]*k,c[1]=h[1]*g+h[5]*T+h[9]*C+h[13]*k,c[2]=h[2]*g+h[6]*T+h[10]*C+h[14]*k,c[3]=h[3]*g+h[7]*T+h[11]*C+h[15]*k,c}function o7(){var c=new Qr(4);return Qr!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function a7(c,o){const h=eA([],[c.x,c.y,0,1],o);return new Ot(h[0]/h[3],h[1]/h[3])}r7(),V1=new Qr(4),Qr!=Float32Array&&(V1[0]=0,V1[1]=0,V1[2]=0,V1[3]=0),r7(),s7(1,0,0),s7(0,1,0),o7(),o7(),n7(),function(){var c;c=new Qr(2),Qr!=Float32Array&&(c[0]=0,c[1]=0)}();class l7 extends V3{}Ft("HeatmapBucket",l7,{omit:["layers"]});var LP={paint:new tr({"heatmap-radius":new en(nt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new en(nt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Wt(nt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Co(nt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Wt(nt.paint_heatmap["heatmap-opacity"])})};function W3(c,{width:o,height:h},g,T){if(T){if(T instanceof Uint8ClampedArray)T=new Uint8Array(T.buffer);else if(T.length!==o*h*g)throw new RangeError(`mismatched image size. expected: ${T.length} but got: ${o*h*g}`)}else T=new Uint8Array(o*h*g);return c.width=o,c.height=h,c.data=T,c}function c7(c,{width:o,height:h},g){if(o===c.width&&h===c.height)return;const T=W3({},{width:o,height:h},g);$3(c,T,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,o),height:Math.min(c.height,h)},g),c.width=o,c.height=h,c.data=T.data}function $3(c,o,h,g,T,C){if(T.width===0||T.height===0)return o;if(T.width>c.width||T.height>c.height||h.x>c.width-T.width||h.y>c.height-T.height)throw new RangeError("out of range source coordinates for image copy");if(T.width>o.width||T.height>o.height||g.x>o.width-T.width||g.y>o.height-T.height)throw new RangeError("out of range destination coordinates for image copy");const k=c.data,B=o.data;if(k===B)throw new Error("srcData equals dstData, so image is already copied");for(let F=0;F<T.height;F++){const j=((h.y+F)*c.width+h.x)*C,Q=((g.y+F)*o.width+g.x)*C;for(let te=0;te<T.width*C;te++)B[Q+te]=k[j+te]}return o}class G1{constructor(o,h){W3(this,o,1,h)}resize(o){c7(this,o,1)}clone(){return new G1({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,h,g,T,C){$3(o,h,g,T,C,1)}}class eo{constructor(o,h){W3(this,o,4,h)}resize(o){c7(this,o,4)}replace(o,h){h?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new eo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,h,g,T,C){$3(o,h,g,T,C,4)}}function u7(c){const o={},h=c.resolution||256,g=c.clips?c.clips.length:1,T=c.image||new eo({width:h,height:g});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const C=(k,B,F)=>{o[c.evaluationKey]=F;const j=c.expression.evaluate(o);T.data[k+B+0]=Math.floor(255*j.r/j.a),T.data[k+B+1]=Math.floor(255*j.g/j.a),T.data[k+B+2]=Math.floor(255*j.b/j.a),T.data[k+B+3]=Math.floor(255*j.a)};if(c.clips)for(let k=0,B=0;k<g;++k,B+=4*h)for(let F=0,j=0;F<h;F++,j+=4){const Q=F/(h-1),{start:te,end:ae}=c.clips[k];C(B,j,te*(1-Q)+ae*Q)}else for(let k=0,B=0;k<h;k++,B+=4)C(0,B,k/(h-1));return T}Ft("AlphaImage",G1),Ft("RGBAImage",eo);var DP={paint:new tr({"hillshade-illumination-direction":new Wt(nt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Wt(nt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Wt(nt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Wt(nt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Wt(nt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Wt(nt.paint_hillshade["hillshade-accent-color"])})};const RP=Bi([{name:"a_pos",components:2,type:"Int16"}],4),{members:zP}=RP;var tA={exports:{}};function nA(c,o,h){h=h||2;var g,T,C,k,B,F,j,Q=o&&o.length,te=Q?o[0]*h:c.length,ae=h7(c,0,te,h,!0),he=[];if(!ae||ae.next===ae.prev)return he;if(Q&&(ae=function(Le,Pe,Ge,Ye){var Fe,Ze,ct,lt=[];for(Fe=0,Ze=Pe.length;Fe<Ze;Fe++)(ct=h7(Le,Pe[Fe]*Ye,Fe<Ze-1?Pe[Fe+1]*Ye:Le.length,Ye,!1))===ct.next&&(ct.steiner=!0),lt.push(jP(ct));for(lt.sort(UP),Fe=0;Fe<lt.length;Fe++)Ge=VP(lt[Fe],Ge);return Ge}(c,o,ae,h)),c.length>80*h){g=C=c[0],T=k=c[1];for(var fe=h;fe<te;fe+=h)(B=c[fe])<g&&(g=B),(F=c[fe+1])<T&&(T=F),B>C&&(C=B),F>k&&(k=F);j=(j=Math.max(C-g,k-T))!==0?32767/j:0}return j1(ae,he,h,g,T,j,0),he}function h7(c,o,h,g,T){var C,k;if(T===X3(c,o,h,g)>0)for(C=o;C<h;C+=g)k=d7(C,c[C],c[C+1],k);else for(C=h-g;C>=o;C-=g)k=d7(C,c[C],c[C+1],k);return k&&iA(k,k.next)&&(W1(k),k=k.next),k}function Oc(c,o){if(!c)return c;o||(o=c);var h,g=c;do if(h=!1,g.steiner||!iA(g,g.next)&&Ui(g.prev,g,g.next)!==0)g=g.next;else{if(W1(g),(g=o=g.prev)===g.next)break;h=!0}while(h||g!==o);return o}function j1(c,o,h,g,T,C,k){if(c){!k&&C&&function(Q,te,ae,he){var fe=Q;do fe.z===0&&(fe.z=q3(fe.x,fe.y,te,ae,he)),fe.prevZ=fe.prev,fe.nextZ=fe.next,fe=fe.next;while(fe!==Q);fe.prevZ.nextZ=null,fe.prevZ=null,function(Le){var Pe,Ge,Ye,Fe,Ze,ct,lt,Nt,jt=1;do{for(Ge=Le,Le=null,Ze=null,ct=0;Ge;){for(ct++,Ye=Ge,lt=0,Pe=0;Pe<jt&&(lt++,Ye=Ye.nextZ);Pe++);for(Nt=jt;lt>0||Nt>0&&Ye;)lt!==0&&(Nt===0||!Ye||Ge.z<=Ye.z)?(Fe=Ge,Ge=Ge.nextZ,lt--):(Fe=Ye,Ye=Ye.nextZ,Nt--),Ze?Ze.nextZ=Fe:Le=Fe,Fe.prevZ=Ze,Ze=Fe;Ge=Ye}Ze.nextZ=null,jt*=2}while(ct>1)}(fe)}(c,g,T,C);for(var B,F,j=c;c.prev!==c.next;)if(B=c.prev,F=c.next,C?OP(c,g,T,C):BP(c))o.push(B.i/h|0),o.push(c.i/h|0),o.push(F.i/h|0),W1(c),c=F.next,j=F.next;else if((c=F)===j){k?k===1?j1(c=FP(Oc(c),o,h),o,h,g,T,C,2):k===2&&NP(c,o,h,g,T,C):j1(Oc(c),o,h,g,T,C,1);break}}}function BP(c){var o=c.prev,h=c,g=c.next;if(Ui(o,h,g)>=0)return!1;for(var T=o.x,C=h.x,k=g.x,B=o.y,F=h.y,j=g.y,Q=T<C?T<k?T:k:C<k?C:k,te=B<F?B<j?B:j:F<j?F:j,ae=T>C?T>k?T:k:C>k?C:k,he=B>F?B>j?B:j:F>j?F:j,fe=g.next;fe!==o;){if(fe.x>=Q&&fe.x<=ae&&fe.y>=te&&fe.y<=he&&sh(T,B,C,F,k,j,fe.x,fe.y)&&Ui(fe.prev,fe,fe.next)>=0)return!1;fe=fe.next}return!0}function OP(c,o,h,g){var T=c.prev,C=c,k=c.next;if(Ui(T,C,k)>=0)return!1;for(var B=T.x,F=C.x,j=k.x,Q=T.y,te=C.y,ae=k.y,he=B<F?B<j?B:j:F<j?F:j,fe=Q<te?Q<ae?Q:ae:te<ae?te:ae,Le=B>F?B>j?B:j:F>j?F:j,Pe=Q>te?Q>ae?Q:ae:te>ae?te:ae,Ge=q3(he,fe,o,h,g),Ye=q3(Le,Pe,o,h,g),Fe=c.prevZ,Ze=c.nextZ;Fe&&Fe.z>=Ge&&Ze&&Ze.z<=Ye;){if(Fe.x>=he&&Fe.x<=Le&&Fe.y>=fe&&Fe.y<=Pe&&Fe!==T&&Fe!==k&&sh(B,Q,F,te,j,ae,Fe.x,Fe.y)&&Ui(Fe.prev,Fe,Fe.next)>=0||(Fe=Fe.prevZ,Ze.x>=he&&Ze.x<=Le&&Ze.y>=fe&&Ze.y<=Pe&&Ze!==T&&Ze!==k&&sh(B,Q,F,te,j,ae,Ze.x,Ze.y)&&Ui(Ze.prev,Ze,Ze.next)>=0))return!1;Ze=Ze.nextZ}for(;Fe&&Fe.z>=Ge;){if(Fe.x>=he&&Fe.x<=Le&&Fe.y>=fe&&Fe.y<=Pe&&Fe!==T&&Fe!==k&&sh(B,Q,F,te,j,ae,Fe.x,Fe.y)&&Ui(Fe.prev,Fe,Fe.next)>=0)return!1;Fe=Fe.prevZ}for(;Ze&&Ze.z<=Ye;){if(Ze.x>=he&&Ze.x<=Le&&Ze.y>=fe&&Ze.y<=Pe&&Ze!==T&&Ze!==k&&sh(B,Q,F,te,j,ae,Ze.x,Ze.y)&&Ui(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.nextZ}return!0}function FP(c,o,h){var g=c;do{var T=g.prev,C=g.next.next;!iA(T,C)&&f7(T,g,g.next,C)&&H1(T,C)&&H1(C,T)&&(o.push(T.i/h|0),o.push(g.i/h|0),o.push(C.i/h|0),W1(g),W1(g.next),g=c=C),g=g.next}while(g!==c);return Oc(g)}function NP(c,o,h,g,T,C){var k=c;do{for(var B=k.next.next;B!==k.prev;){if(k.i!==B.i&&HP(k,B)){var F=A7(k,B);return k=Oc(k,k.next),F=Oc(F,F.next),j1(k,o,h,g,T,C,0),void j1(F,o,h,g,T,C,0)}B=B.next}k=k.next}while(k!==c)}function UP(c,o){return c.x-o.x}function VP(c,o){var h=function(T,C){var k,B=C,F=T.x,j=T.y,Q=-1/0;do{if(j<=B.y&&j>=B.next.y&&B.next.y!==B.y){var te=B.x+(j-B.y)*(B.next.x-B.x)/(B.next.y-B.y);if(te<=F&&te>Q&&(Q=te,k=B.x<B.next.x?B:B.next,te===F))return k}B=B.next}while(B!==C);if(!k)return null;var ae,he=k,fe=k.x,Le=k.y,Pe=1/0;B=k;do F>=B.x&&B.x>=fe&&F!==B.x&&sh(j<Le?F:Q,j,fe,Le,j<Le?Q:F,j,B.x,B.y)&&(ae=Math.abs(j-B.y)/(F-B.x),H1(B,T)&&(ae<Pe||ae===Pe&&(B.x>k.x||B.x===k.x&&GP(k,B)))&&(k=B,Pe=ae)),B=B.next;while(B!==he);return k}(c,o);if(!h)return o;var g=A7(h,c);return Oc(g,g.next),Oc(h,h.next)}function GP(c,o){return Ui(c.prev,c,o.prev)<0&&Ui(o.next,c,c.next)<0}function q3(c,o,h,g,T){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-h)*T|0)|c<<8))|c<<4))|c<<2))|c<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-g)*T|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function jP(c){var o=c,h=c;do(o.x<h.x||o.x===h.x&&o.y<h.y)&&(h=o),o=o.next;while(o!==c);return h}function sh(c,o,h,g,T,C,k,B){return(T-k)*(o-B)>=(c-k)*(C-B)&&(c-k)*(g-B)>=(h-k)*(o-B)&&(h-k)*(C-B)>=(T-k)*(g-B)}function HP(c,o){return c.next.i!==o.i&&c.prev.i!==o.i&&!function(h,g){var T=h;do{if(T.i!==h.i&&T.next.i!==h.i&&T.i!==g.i&&T.next.i!==g.i&&f7(T,T.next,h,g))return!0;T=T.next}while(T!==h);return!1}(c,o)&&(H1(c,o)&&H1(o,c)&&function(h,g){var T=h,C=!1,k=(h.x+g.x)/2,B=(h.y+g.y)/2;do T.y>B!=T.next.y>B&&T.next.y!==T.y&&k<(T.next.x-T.x)*(B-T.y)/(T.next.y-T.y)+T.x&&(C=!C),T=T.next;while(T!==h);return C}(c,o)&&(Ui(c.prev,c,o.prev)||Ui(c,o.prev,o))||iA(c,o)&&Ui(c.prev,c,c.next)>0&&Ui(o.prev,o,o.next)>0)}function Ui(c,o,h){return(o.y-c.y)*(h.x-o.x)-(o.x-c.x)*(h.y-o.y)}function iA(c,o){return c.x===o.x&&c.y===o.y}function f7(c,o,h,g){var T=sA(Ui(c,o,h)),C=sA(Ui(c,o,g)),k=sA(Ui(h,g,c)),B=sA(Ui(h,g,o));return T!==C&&k!==B||!(T!==0||!rA(c,h,o))||!(C!==0||!rA(c,g,o))||!(k!==0||!rA(h,c,g))||!(B!==0||!rA(h,o,g))}function rA(c,o,h){return o.x<=Math.max(c.x,h.x)&&o.x>=Math.min(c.x,h.x)&&o.y<=Math.max(c.y,h.y)&&o.y>=Math.min(c.y,h.y)}function sA(c){return c>0?1:c<0?-1:0}function H1(c,o){return Ui(c.prev,c,c.next)<0?Ui(c,o,c.next)>=0&&Ui(c,c.prev,o)>=0:Ui(c,o,c.prev)<0||Ui(c,c.next,o)<0}function A7(c,o){var h=new Z3(c.i,c.x,c.y),g=new Z3(o.i,o.x,o.y),T=c.next,C=o.prev;return c.next=o,o.prev=c,h.next=T,T.prev=h,g.next=h,h.prev=g,C.next=g,g.prev=C,g}function d7(c,o,h,g){var T=new Z3(c,o,h);return g?(T.next=g.next,T.prev=g,g.next.prev=T,g.next=T):(T.prev=T,T.next=T),T}function W1(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Z3(c,o,h){this.i=c,this.x=o,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function X3(c,o,h,g){for(var T=0,C=o,k=h-g;C<h;C+=g)T+=(c[k]-c[C])*(c[C+1]+c[k+1]),k=C;return T}function WP(c,o,h,g,T){p7(c,o,h||0,g||c.length-1,T||$P)}function p7(c,o,h,g,T){for(;g>h;){if(g-h>600){var C=g-h+1,k=o-h+1,B=Math.log(C),F=.5*Math.exp(2*B/3),j=.5*Math.sqrt(B*F*(C-F)/C)*(k-C/2<0?-1:1);p7(c,o,Math.max(h,Math.floor(o-k*F/C+j)),Math.min(g,Math.floor(o+(C-k)*F/C+j)),T)}var Q=c[o],te=h,ae=g;for($1(c,h,o),T(c[g],Q)>0&&$1(c,h,g);te<ae;){for($1(c,te,ae),te++,ae--;T(c[te],Q)<0;)te++;for(;T(c[ae],Q)>0;)ae--}T(c[h],Q)===0?$1(c,h,ae):$1(c,++ae,g),ae<=o&&(h=ae+1),o<=ae&&(g=ae-1)}}function $1(c,o,h){var g=c[o];c[o]=c[h],c[h]=g}function $P(c,o){return c<o?-1:c>o?1:0}function Q3(c,o){const h=c.length;if(h<=1)return[c];const g=[];let T,C;for(let k=0;k<h;k++){const B=qe(c[k]);B!==0&&(c[k].area=Math.abs(B),C===void 0&&(C=B<0),C===B<0?(T&&g.push(T),T=[c[k]]):T.push(c[k]))}if(T&&g.push(T),o>1)for(let k=0;k<g.length;k++)g[k].length<=o||(WP(g[k],o,1,g[k].length-1,qP),g[k]=g[k].slice(0,o));return g}function qP(c,o){return o.area-c.area}function Y3(c,o,h){const g=h.patternDependencies;let T=!1;for(const C of o){const k=C.paint.get(`${c}-pattern`);k.isConstant()||(T=!0);const B=k.constantOr(null);B&&(T=!0,g[B.to]=!0,g[B.from]=!0)}return T}function K3(c,o,h,g,T){const C=T.patternDependencies;for(const k of o){const B=k.paint.get(`${c}-pattern`).value;if(B.kind!=="constant"){let F=B.evaluate({zoom:g-1},h,{},T.availableImages),j=B.evaluate({zoom:g},h,{},T.availableImages),Q=B.evaluate({zoom:g+1},h,{},T.availableImages);F=F&&F.name?F.name:F,j=j&&j.name?j.name:j,Q=Q&&Q.name?Q.name:Q,C[F]=!0,C[j]=!0,C[Q]=!0,h.patterns[k.id]={min:F,mid:j,max:Q}}}return h}tA.exports=nA,tA.exports.default=nA,nA.deviation=function(c,o,h,g){var T=o&&o.length,C=Math.abs(X3(c,0,T?o[0]*h:c.length,h));if(T)for(var k=0,B=o.length;k<B;k++)C-=Math.abs(X3(c,o[k]*h,k<B-1?o[k+1]*h:c.length,h));var F=0;for(k=0;k<g.length;k+=3){var j=g[k]*h,Q=g[k+1]*h,te=g[k+2]*h;F+=Math.abs((c[j]-c[te])*(c[Q+1]-c[j+1])-(c[j]-c[Q])*(c[te+1]-c[j+1]))}return C===0&&F===0?0:Math.abs((F-C)/C)},nA.flatten=function(c){for(var o=c[0][0].length,h={vertices:[],holes:[],dimensions:o},g=0,T=0;T<c.length;T++){for(var C=0;C<c[T].length;C++)for(var k=0;k<o;k++)h.vertices.push(c[T][C][k]);T>0&&h.holes.push(g+=c[T-1].length)}return h};class J3{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(h=>h.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new H,this.indexArray=new $e,this.indexArray2=new Oe,this.programConfigurations=new Rc(o.layers,o.zoom),this.segments=new st,this.segments2=new st,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(o,h,g){this.hasPattern=Y3("fill",this.layers,h);const T=this.layers[0].layout.get("fill-sort-key"),C=!T.isConstant(),k=[];for(const{feature:B,id:F,index:j,sourceLayerIndex:Q}of o){const te=this.layers[0]._featureFilter.needGeometry,ae=Bc(B,te);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),ae,g))continue;const he=C?T.evaluate(ae,{},g,h.availableImages):void 0,fe={id:F,properties:B.properties,type:B.type,sourceLayerIndex:Q,index:j,geometry:te?ae.geometry:zc(B),patterns:{},sortKey:he};k.push(fe)}C&&k.sort((B,F)=>B.sortKey-F.sortKey);for(const B of k){const{geometry:F,index:j,sourceLayerIndex:Q}=B;if(this.hasPattern){const te=K3("fill",this.layers,B,this.zoom,h);this.patternFeatures.push(te)}else this.addFeature(B,F,j,g,{});h.featureIndex.insert(o[j].feature,F,j,Q,this.index)}}update(o,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,h,this.stateDependentLayers,g)}addFeatures(o,h,g){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,h,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,zP),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,h,g,T,C){for(const k of Q3(h,500)){let B=0;for(const he of k)B+=he.length;const F=this.segments.prepareSegment(B,this.layoutVertexArray,this.indexArray),j=F.vertexLength,Q=[],te=[];for(const he of k){if(he.length===0)continue;he!==k[0]&&te.push(Q.length/2);const fe=this.segments2.prepareSegment(he.length,this.layoutVertexArray,this.indexArray2),Le=fe.vertexLength;this.layoutVertexArray.emplaceBack(he[0].x,he[0].y),this.indexArray2.emplaceBack(Le+he.length-1,Le),Q.push(he[0].x),Q.push(he[0].y);for(let Pe=1;Pe<he.length;Pe++)this.layoutVertexArray.emplaceBack(he[Pe].x,he[Pe].y),this.indexArray2.emplaceBack(Le+Pe-1,Le+Pe),Q.push(he[Pe].x),Q.push(he[Pe].y);fe.vertexLength+=he.length,fe.primitiveLength+=he.length}const ae=tA.exports(Q,te);for(let he=0;he<ae.length;he+=3)this.indexArray.emplaceBack(j+ae[he],j+ae[he+1],j+ae[he+2]);F.vertexLength+=B,F.primitiveLength+=ae.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,C,T)}}Ft("FillBucket",J3,{omit:["layers","patternFeatures"]});const ZP=new tr({"fill-sort-key":new en(nt.layout_fill["fill-sort-key"])});var XP={paint:new tr({"fill-antialias":new Wt(nt.paint_fill["fill-antialias"]),"fill-opacity":new en(nt.paint_fill["fill-opacity"]),"fill-color":new en(nt.paint_fill["fill-color"]),"fill-outline-color":new en(nt.paint_fill["fill-outline-color"]),"fill-translate":new Wt(nt.paint_fill["fill-translate"]),"fill-translate-anchor":new Wt(nt.paint_fill["fill-translate-anchor"]),"fill-pattern":new er(nt.paint_fill["fill-pattern"])}),layout:ZP};const QP=Bi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),YP=Bi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:KP}=QP;var P0={},JP=Ot,m7=oh;function oh(c,o,h,g,T){this.properties={},this.extent=h,this.type=0,this._pbf=c,this._geometry=-1,this._keys=g,this._values=T,c.readFields(eM,this,o)}function eM(c,o,h){c==1?o.id=h.readVarint():c==2?function(g,T){for(var C=g.readVarint()+g.pos;g.pos<C;){var k=T._keys[g.readVarint()],B=T._values[g.readVarint()];T.properties[k]=B}}(h,o):c==3?o.type=h.readVarint():c==4&&(o._geometry=h.pos)}function tM(c){for(var o,h,g=0,T=0,C=c.length,k=C-1;T<C;k=T++)g+=((h=c[k]).x-(o=c[T]).x)*(o.y+h.y);return g}oh.types=["Unknown","Point","LineString","Polygon"],oh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var o,h=c.readVarint()+c.pos,g=1,T=0,C=0,k=0,B=[];c.pos<h;){if(T<=0){var F=c.readVarint();g=7&F,T=F>>3}if(T--,g===1||g===2)C+=c.readSVarint(),k+=c.readSVarint(),g===1&&(o&&B.push(o),o=[]),o.push(new JP(C,k));else{if(g!==7)throw new Error("unknown command "+g);o&&o.push(o[0].clone())}}return o&&B.push(o),B},oh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var o=c.readVarint()+c.pos,h=1,g=0,T=0,C=0,k=1/0,B=-1/0,F=1/0,j=-1/0;c.pos<o;){if(g<=0){var Q=c.readVarint();h=7&Q,g=Q>>3}if(g--,h===1||h===2)(T+=c.readSVarint())<k&&(k=T),T>B&&(B=T),(C+=c.readSVarint())<F&&(F=C),C>j&&(j=C);else if(h!==7)throw new Error("unknown command "+h)}return[k,F,B,j]},oh.prototype.toGeoJSON=function(c,o,h){var g,T,C=this.extent*Math.pow(2,h),k=this.extent*c,B=this.extent*o,F=this.loadGeometry(),j=oh.types[this.type];function Q(he){for(var fe=0;fe<he.length;fe++){var Le=he[fe];he[fe]=[360*(Le.x+k)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(Le.y+B)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var te=[];for(g=0;g<F.length;g++)te[g]=F[g][0];Q(F=te);break;case 2:for(g=0;g<F.length;g++)Q(F[g]);break;case 3:for(F=function(he){var fe=he.length;if(fe<=1)return[he];for(var Le,Pe,Ge=[],Ye=0;Ye<fe;Ye++){var Fe=tM(he[Ye]);Fe!==0&&(Pe===void 0&&(Pe=Fe<0),Pe===Fe<0?(Le&&Ge.push(Le),Le=[he[Ye]]):Le.push(he[Ye]))}return Le&&Ge.push(Le),Ge}(F),g=0;g<F.length;g++)for(T=0;T<F[g].length;T++)Q(F[g][T])}F.length===1?F=F[0]:j="Multi"+j;var ae={type:"Feature",geometry:{type:j,coordinates:F},properties:this.properties};return"id"in this&&(ae.id=this.id),ae};var nM=m7,g7=_7;function _7(c,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(iM,this,o),this.length=this._features.length}function iM(c,o,h){c===15?o.version=h.readVarint():c===1?o.name=h.readString():c===5?o.extent=h.readVarint():c===2?o._features.push(h.pos):c===3?o._keys.push(h.readString()):c===4&&o._values.push(function(g){for(var T=null,C=g.readVarint()+g.pos;g.pos<C;){var k=g.readVarint()>>3;T=k===1?g.readString():k===2?g.readFloat():k===3?g.readDouble():k===4?g.readVarint64():k===5?g.readVarint():k===6?g.readSVarint():k===7?g.readBoolean():null}return T}(h))}_7.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var o=this._pbf.readVarint()+this._pbf.pos;return new nM(this._pbf,o,this.extent,this._keys,this._values)};var rM=g7;function sM(c,o,h){if(c===3){var g=new rM(h,h.readVarint()+h.pos);g.length&&(o[g.name]=g)}}P0.VectorTile=function(c,o){this.layers=c.readFields(sM,{},o)},P0.VectorTileFeature=m7,P0.VectorTileLayer=g7;const oM=P0.VectorTileFeature.types,em=Math.pow(2,13);function q1(c,o,h,g,T,C,k,B){c.emplaceBack(o,h,2*Math.floor(g*em)+k,T*em*2,C*em*2,Math.round(B))}class tm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(h=>h.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new ee,this.centroidVertexArray=new L,this.indexArray=new $e,this.programConfigurations=new Rc(o.layers,o.zoom),this.segments=new st,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(o,h,g){this.features=[],this.hasPattern=Y3("fill-extrusion",this.layers,h);for(const{feature:T,id:C,index:k,sourceLayerIndex:B}of o){const F=this.layers[0]._featureFilter.needGeometry,j=Bc(T,F);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),j,g))continue;const Q={id:C,sourceLayerIndex:B,index:k,geometry:F?j.geometry:zc(T),properties:T.properties,type:T.type,patterns:{}};this.hasPattern?this.features.push(K3("fill-extrusion",this.layers,Q,this.zoom,h)):this.addFeature(Q,Q.geometry,k,g,{}),h.featureIndex.insert(T,Q.geometry,k,B,this.index,!0)}}addFeatures(o,h,g){for(const T of this.features){const{geometry:C}=T;this.addFeature(T,C,T.index,h,g)}}update(o,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,h,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,KP),this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,YP.members,!0),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(o,h,g,T,C){const k={x:0,y:0,vertexCount:0};for(const B of Q3(h,500)){let F=0;for(const fe of B)F+=fe.length;let j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const fe of B){if(fe.length===0||lM(fe))continue;let Le=0;for(let Pe=0;Pe<fe.length;Pe++){const Ge=fe[Pe];if(Pe>=1){const Ye=fe[Pe-1];if(!aM(Ge,Ye)){j.vertexLength+4>st.MAX_VERTEX_ARRAY_LENGTH&&(j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Fe=Ge.sub(Ye)._perp()._unit(),Ze=Ye.dist(Ge);Le+Ze>32768&&(Le=0),q1(this.layoutVertexArray,Ge.x,Ge.y,Fe.x,Fe.y,0,0,Le),q1(this.layoutVertexArray,Ge.x,Ge.y,Fe.x,Fe.y,0,1,Le),k.x+=2*Ge.x,k.y+=2*Ge.y,k.vertexCount+=2,Le+=Ze,q1(this.layoutVertexArray,Ye.x,Ye.y,Fe.x,Fe.y,0,0,Le),q1(this.layoutVertexArray,Ye.x,Ye.y,Fe.x,Fe.y,0,1,Le),k.x+=2*Ye.x,k.y+=2*Ye.y,k.vertexCount+=2;const ct=j.vertexLength;this.indexArray.emplaceBack(ct,ct+2,ct+1),this.indexArray.emplaceBack(ct+1,ct+2,ct+3),j.vertexLength+=4,j.primitiveLength+=2}}}}if(j.vertexLength+F>st.MAX_VERTEX_ARRAY_LENGTH&&(j=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray)),oM[o.type]!=="Polygon")continue;const Q=[],te=[],ae=j.vertexLength;for(const fe of B)if(fe.length!==0){fe!==B[0]&&te.push(Q.length/2);for(let Le=0;Le<fe.length;Le++){const Pe=fe[Le];q1(this.layoutVertexArray,Pe.x,Pe.y,0,0,1,1,0),k.x+=Pe.x,k.y+=Pe.y,k.vertexCount+=1,Q.push(Pe.x),Q.push(Pe.y)}}const he=tA.exports(Q,te);for(let fe=0;fe<he.length;fe+=3)this.indexArray.emplaceBack(ae+he[fe],ae+he[fe+2],ae+he[fe+1]);j.primitiveLength+=he.length/3,j.vertexLength+=F}for(let B=0;B<k.vertexCount;B++)this.centroidVertexArray.emplaceBack(Math.floor(k.x/k.vertexCount),Math.floor(k.y/k.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,C,T)}}function aM(c,o){return c.x===o.x&&(c.x<0||c.x>nr)||c.y===o.y&&(c.y<0||c.y>nr)}function lM(c){return c.every(o=>o.x<0)||c.every(o=>o.x>nr)||c.every(o=>o.y<0)||c.every(o=>o.y>nr)}Ft("FillExtrusionBucket",tm,{omit:["layers","features"]});var cM={paint:new tr({"fill-extrusion-opacity":new Wt(nt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new en(nt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Wt(nt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Wt(nt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new er(nt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new en(nt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new en(nt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Wt(nt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Z1(c,o){return c.x*o.x+c.y*o.y}function y7(c,o){if(c.length===1){let h=0;const g=o[h++];let T;for(;!T||g.equals(T);)if(T=o[h++],!T)return 1/0;for(;h<o.length;h++){const C=o[h],k=c[0],B=T.sub(g),F=C.sub(g),j=k.sub(g),Q=Z1(B,B),te=Z1(B,F),ae=Z1(F,F),he=Z1(j,B),fe=Z1(j,F),Le=Q*ae-te*te,Pe=(ae*he-te*fe)/Le,Ge=(Q*fe-te*he)/Le,Ye=g.z*(1-Pe-Ge)+T.z*Pe+C.z*Ge;if(isFinite(Ye))return Ye}return 1/0}{let h=1/0;for(const g of o)h=Math.min(h,g.z);return h}}const uM=Bi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:hM}=uM,fM=Bi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:AM}=fM,dM=P0.VectorTileFeature.types,pM=Math.cos(Math.PI/180*37.5),v7=Math.pow(2,14)/.5;class nm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(h=>h.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new Ae,this.layoutVertexArray2=new we,this.indexArray=new $e,this.programConfigurations=new Rc(o.layers,o.zoom),this.segments=new st,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(o,h,g){this.hasPattern=Y3("line",this.layers,h);const T=this.layers[0].layout.get("line-sort-key"),C=!T.isConstant(),k=[];for(const{feature:B,id:F,index:j,sourceLayerIndex:Q}of o){const te=this.layers[0]._featureFilter.needGeometry,ae=Bc(B,te);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),ae,g))continue;const he=C?T.evaluate(ae,{},g):void 0,fe={id:F,properties:B.properties,type:B.type,sourceLayerIndex:Q,index:j,geometry:te?ae.geometry:zc(B),patterns:{},sortKey:he};k.push(fe)}C&&k.sort((B,F)=>B.sortKey-F.sortKey);for(const B of k){const{geometry:F,index:j,sourceLayerIndex:Q}=B;if(this.hasPattern){const te=K3("line",this.layers,B,this.zoom,h);this.patternFeatures.push(te)}else this.addFeature(B,F,j,g,{});h.featureIndex.insert(o[j].feature,F,j,Q,this.index)}}update(o,h,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,h,this.stateDependentLayers,g)}addFeatures(o,h,g){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,h,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,AM)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,hM),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,h,g,T,C){const k=this.layers[0].layout,B=k.get("line-join").evaluate(o,{}),F=k.get("line-cap"),j=k.get("line-miter-limit"),Q=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const te of h)this.addLine(te,o,B,F,j,Q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,C,T)}addLine(o,h,g,T,C,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ge=0;Ge<o.length-1;Ge++)this.totalDistance+=o[Ge].dist(o[Ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const B=dM[h.type]==="Polygon";let F=o.length;for(;F>=2&&o[F-1].equals(o[F-2]);)F--;let j=0;for(;j<F-1&&o[j].equals(o[j+1]);)j++;if(F<(B?3:2))return;g==="bevel"&&(C=1.05);const Q=this.overscaling<=16?122880/(512*this.overscaling):0,te=this.segments.prepareSegment(10*F,this.layoutVertexArray,this.indexArray);let ae,he,fe,Le,Pe;this.e1=this.e2=-1,B&&(ae=o[F-2],Pe=o[j].sub(ae)._unit()._perp());for(let Ge=j;Ge<F;Ge++){if(fe=Ge===F-1?B?o[j+1]:void 0:o[Ge+1],fe&&o[Ge].equals(fe))continue;Pe&&(Le=Pe),ae&&(he=ae),ae=o[Ge],Pe=fe?fe.sub(ae)._unit()._perp():Le,Le=Le||Pe;let Ye=Le.add(Pe);Ye.x===0&&Ye.y===0||Ye._unit();const Fe=Le.x*Pe.x+Le.y*Pe.y,Ze=Ye.x*Pe.x+Ye.y*Pe.y,ct=Ze!==0?1/Ze:1/0,lt=2*Math.sqrt(2-2*Ze),Nt=Ze<pM&&he&&fe,jt=Le.x*Pe.y-Le.y*Pe.x>0;if(Nt&&Ge>j){const Tt=ae.dist(he);if(Tt>2*Q){const zt=ae.sub(ae.sub(he)._mult(Q/Tt)._round());this.updateDistance(he,zt),this.addCurrentVertex(zt,Le,0,0,te),he=zt}}const Rt=he&&fe;let Pt=Rt?g:B?"butt":T;if(Rt&&Pt==="round"&&(ct<k?Pt="miter":ct<=2&&(Pt="fakeround")),Pt==="miter"&&ct>C&&(Pt="bevel"),Pt==="bevel"&&(ct>2&&(Pt="flipbevel"),ct<C&&(Pt="miter")),he&&this.updateDistance(he,ae),Pt==="miter")Ye._mult(ct),this.addCurrentVertex(ae,Ye,0,0,te);else if(Pt==="flipbevel"){if(ct>100)Ye=Pe.mult(-1);else{const Tt=ct*Le.add(Pe).mag()/Le.sub(Pe).mag();Ye._perp()._mult(Tt*(jt?-1:1))}this.addCurrentVertex(ae,Ye,0,0,te),this.addCurrentVertex(ae,Ye.mult(-1),0,0,te)}else if(Pt==="bevel"||Pt==="fakeround"){const Tt=-Math.sqrt(ct*ct-1),zt=jt?Tt:0,kt=jt?0:Tt;if(he&&this.addCurrentVertex(ae,Le,zt,kt,te),Pt==="fakeround"){const _t=Math.round(180*lt/Math.PI/20);for(let rn=1;rn<_t;rn++){let qt=rn/_t;if(qt!==.5){const yi=qt-.5;qt+=qt*yi*(qt-1)*((1.0904+Fe*(Fe*(3.55645-1.43519*Fe)-3.2452))*yi*yi+(.848013+Fe*(.215638*Fe-1.06021)))}const kn=Pe.sub(Le)._mult(qt)._add(Le)._unit()._mult(jt?-1:1);this.addHalfVertex(ae,kn.x,kn.y,!1,jt,0,te)}}fe&&this.addCurrentVertex(ae,Pe,-zt,-kt,te)}else if(Pt==="butt")this.addCurrentVertex(ae,Ye,0,0,te);else if(Pt==="square"){const Tt=he?1:-1;this.addCurrentVertex(ae,Ye,Tt,Tt,te)}else Pt==="round"&&(he&&(this.addCurrentVertex(ae,Le,0,0,te),this.addCurrentVertex(ae,Le,1,1,te,!0)),fe&&(this.addCurrentVertex(ae,Pe,-1,-1,te,!0),this.addCurrentVertex(ae,Pe,0,0,te)));if(Nt&&Ge<F-1){const Tt=ae.dist(fe);if(Tt>2*Q){const zt=ae.add(fe.sub(ae)._mult(Q/Tt)._round());this.updateDistance(ae,zt),this.addCurrentVertex(zt,Pe,0,0,te),ae=zt}}}}addCurrentVertex(o,h,g,T,C,k=!1){const B=h.y*T-h.x,F=-h.y-h.x*T;this.addHalfVertex(o,h.x+h.y*g,h.y-h.x*g,k,!1,g,C),this.addHalfVertex(o,B,F,k,!0,-T,C),this.distance>v7/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(o,h,g,T,C,k))}addHalfVertex({x:o,y:h},g,T,C,k,B,F){const j=.5*(this.lineClips?this.scaledDistance*(v7-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(C?1:0),(h<<1)+(k?1:0),Math.round(63*g)+128,Math.round(63*T)+128,1+(B===0?0:B<0?-1:1)|(63&j)<<2,j>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Q=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Q),F.primitiveLength++),k?this.e2=Q:this.e1=Q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(o,h){this.distance+=o.dist(h),this.updateScaledDistance()}}Ft("LineBucket",nm,{omit:["layers","patternFeatures"]});const mM=new tr({"line-cap":new Wt(nt.layout_line["line-cap"]),"line-join":new en(nt.layout_line["line-join"]),"line-miter-limit":new Wt(nt.layout_line["line-miter-limit"]),"line-round-limit":new Wt(nt.layout_line["line-round-limit"]),"line-sort-key":new en(nt.layout_line["line-sort-key"])});var x7={paint:new tr({"line-opacity":new en(nt.paint_line["line-opacity"]),"line-color":new en(nt.paint_line["line-color"]),"line-translate":new Wt(nt.paint_line["line-translate"]),"line-translate-anchor":new Wt(nt.paint_line["line-translate-anchor"]),"line-width":new en(nt.paint_line["line-width"]),"line-gap-width":new en(nt.paint_line["line-gap-width"]),"line-offset":new en(nt.paint_line["line-offset"]),"line-blur":new en(nt.paint_line["line-blur"]),"line-dasharray":new kc(nt.paint_line["line-dasharray"]),"line-pattern":new er(nt.paint_line["line-pattern"]),"line-gradient":new Co(nt.paint_line["line-gradient"])}),layout:mM};const w7=new class extends en{possiblyEvaluate(c,o){return o=new mi(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(c,o)}evaluate(c,o,h,g){return o=q({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(c,o,h,g)}}(x7.paint.properties["line-width"].specification);function b7(c,o){return o>0?o+2*c:c}w7.useIntegerZoom=!0;const gM=Bi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_M=Bi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Bi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const yM=Bi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Bi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const E7=Bi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),vM=Bi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function xM(c,o,h){return c.sections.forEach(g=>{g.text=function(T,C,k){const B=C.layout.get("text-transform").evaluate(k,{});return B==="uppercase"?T=T.toLocaleUpperCase():B==="lowercase"&&(T=T.toLocaleLowerCase()),Zr.applyArabicShaping&&(T=Zr.applyArabicShaping(T)),T}(g.text,o,h)}),c}Bi([{name:"triangle",components:3,type:"Uint16"}]),Bi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Bi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Bi([{type:"Float32",name:"offsetX"}]),Bi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const X1={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var mr=24,im=Ai,T7=function(c,o,h,g,T){var C,k,B=8*T-g-1,F=(1<<B)-1,j=F>>1,Q=-7,te=h?T-1:0,ae=h?-1:1,he=c[o+te];for(te+=ae,C=he&(1<<-Q)-1,he>>=-Q,Q+=B;Q>0;C=256*C+c[o+te],te+=ae,Q-=8);for(k=C&(1<<-Q)-1,C>>=-Q,Q+=g;Q>0;k=256*k+c[o+te],te+=ae,Q-=8);if(C===0)C=1-j;else{if(C===F)return k?NaN:1/0*(he?-1:1);k+=Math.pow(2,g),C-=j}return(he?-1:1)*k*Math.pow(2,C-g)},S7=function(c,o,h,g,T,C){var k,B,F,j=8*C-T-1,Q=(1<<j)-1,te=Q>>1,ae=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,he=g?0:C-1,fe=g?1:-1,Le=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(B=isNaN(o)?1:0,k=Q):(k=Math.floor(Math.log(o)/Math.LN2),o*(F=Math.pow(2,-k))<1&&(k--,F*=2),(o+=k+te>=1?ae/F:ae*Math.pow(2,1-te))*F>=2&&(k++,F/=2),k+te>=Q?(B=0,k=Q):k+te>=1?(B=(o*F-1)*Math.pow(2,T),k+=te):(B=o*Math.pow(2,te-1)*Math.pow(2,T),k=0));T>=8;c[h+he]=255&B,he+=fe,B/=256,T-=8);for(k=k<<T|B,j+=T;j>0;c[h+he]=255&k,he+=fe,k/=256,j-=8);c[h+he-fe]|=128*Le};function Ai(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Ai.Varint=0,Ai.Fixed64=1,Ai.Bytes=2,Ai.Fixed32=5;var M0,rm=4294967296,C7=1/rm,P7=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Il(c){return c.type===Ai.Bytes?c.readVarint()+c.pos:c.pos+1}function ah(c,o,h){return h?4294967296*o+(c>>>0):4294967296*(o>>>0)+(c>>>0)}function M7(c,o,h){var g=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));h.realloc(g);for(var T=h.pos-1;T>=c;T--)h.buf[T+g]=h.buf[T]}function wM(c,o){for(var h=0;h<c.length;h++)o.writeVarint(c[h])}function bM(c,o){for(var h=0;h<c.length;h++)o.writeSVarint(c[h])}function EM(c,o){for(var h=0;h<c.length;h++)o.writeFloat(c[h])}function TM(c,o){for(var h=0;h<c.length;h++)o.writeDouble(c[h])}function SM(c,o){for(var h=0;h<c.length;h++)o.writeBoolean(c[h])}function CM(c,o){for(var h=0;h<c.length;h++)o.writeFixed32(c[h])}function PM(c,o){for(var h=0;h<c.length;h++)o.writeSFixed32(c[h])}function MM(c,o){for(var h=0;h<c.length;h++)o.writeFixed64(c[h])}function IM(c,o){for(var h=0;h<c.length;h++)o.writeSFixed64(c[h])}function oA(c,o){return(c[o]|c[o+1]<<8|c[o+2]<<16)+16777216*c[o+3]}function lh(c,o,h){c[h]=o,c[h+1]=o>>>8,c[h+2]=o>>>16,c[h+3]=o>>>24}function I7(c,o){return(c[o]|c[o+1]<<8|c[o+2]<<16)+(c[o+3]<<24)}function kM(c,o,h){c===1&&h.readMessage(LM,o)}function LM(c,o,h){if(c===3){const{id:g,bitmap:T,width:C,height:k,left:B,top:F,advance:j}=h.readMessage(DM,{});o.push({id:g,bitmap:new G1({width:C+6,height:k+6},T),metrics:{width:C,height:k,left:B,top:F,advance:j}})}}function DM(c,o,h){c===1?o.id=h.readVarint():c===2?o.bitmap=h.readBytes():c===3?o.width=h.readVarint():c===4?o.height=h.readVarint():c===5?o.left=h.readSVarint():c===6?o.top=h.readSVarint():c===7&&(o.advance=h.readVarint())}function k7(c){let o=0,h=0;for(const k of c)o+=k.w*k.h,h=Math.max(h,k.w);c.sort((k,B)=>B.h-k.h);const g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),h),h:1/0}];let T=0,C=0;for(const k of c)for(let B=g.length-1;B>=0;B--){const F=g[B];if(!(k.w>F.w||k.h>F.h)){if(k.x=F.x,k.y=F.y,C=Math.max(C,k.y+k.h),T=Math.max(T,k.x+k.w),k.w===F.w&&k.h===F.h){const j=g.pop();B<g.length&&(g[B]=j)}else k.h===F.h?(F.x+=k.w,F.w-=k.w):k.w===F.w?(F.y+=k.h,F.h-=k.h):(g.push({x:F.x+k.w,y:F.y,w:F.w-k.w,h:k.h}),F.y+=k.h,F.h-=k.h);break}}return{w:T,h:C,fill:o/(T*C)||0}}Ai.prototype={destroy:function(){this.buf=null},readFields:function(c,o,h){for(h=h||this.length;this.pos<h;){var g=this.readVarint(),T=g>>3,C=this.pos;this.type=7&g,c(T,o,this),this.pos===C&&this.skip(g)}return o},readMessage:function(c,o){return this.readFields(c,o,this.readVarint()+this.pos)},readFixed32:function(){var c=oA(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=I7(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=oA(this.buf,this.pos)+oA(this.buf,this.pos+4)*rm;return this.pos+=8,c},readSFixed64:function(){var c=oA(this.buf,this.pos)+I7(this.buf,this.pos+4)*rm;return this.pos+=8,c},readFloat:function(){var c=T7(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=T7(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var o,h,g=this.buf;return o=127&(h=g[this.pos++]),h<128?o:(o|=(127&(h=g[this.pos++]))<<7,h<128?o:(o|=(127&(h=g[this.pos++]))<<14,h<128?o:(o|=(127&(h=g[this.pos++]))<<21,h<128?o:function(T,C,k){var B,F,j=k.buf;if(B=(112&(F=j[k.pos++]))>>4,F<128||(B|=(127&(F=j[k.pos++]))<<3,F<128)||(B|=(127&(F=j[k.pos++]))<<10,F<128)||(B|=(127&(F=j[k.pos++]))<<17,F<128)||(B|=(127&(F=j[k.pos++]))<<24,F<128)||(B|=(1&(F=j[k.pos++]))<<31,F<128))return ah(T,B,C);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(h=g[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,o=this.pos;return this.pos=c,c-o>=12&&P7?function(h,g,T){return P7.decode(h.subarray(g,T))}(this.buf,o,c):function(h,g,T){for(var C="",k=g;k<T;){var B,F,j,Q=h[k],te=null,ae=Q>239?4:Q>223?3:Q>191?2:1;if(k+ae>T)break;ae===1?Q<128&&(te=Q):ae===2?(192&(B=h[k+1]))==128&&(te=(31&Q)<<6|63&B)<=127&&(te=null):ae===3?(F=h[k+2],(192&(B=h[k+1]))==128&&(192&F)==128&&((te=(15&Q)<<12|(63&B)<<6|63&F)<=2047||te>=55296&&te<=57343)&&(te=null)):ae===4&&(F=h[k+2],j=h[k+3],(192&(B=h[k+1]))==128&&(192&F)==128&&(192&j)==128&&((te=(15&Q)<<18|(63&B)<<12|(63&F)<<6|63&j)<=65535||te>=1114112)&&(te=null)),te===null?(te=65533,ae=1):te>65535&&(te-=65536,C+=String.fromCharCode(te>>>10&1023|55296),te=56320|1023&te),C+=String.fromCharCode(te),k+=ae}return C}(this.buf,o,c)},readBytes:function(){var c=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,c);return this.pos=c,o},readPackedVarint:function(c,o){if(this.type!==Ai.Bytes)return c.push(this.readVarint(o));var h=Il(this);for(c=c||[];this.pos<h;)c.push(this.readVarint(o));return c},readPackedSVarint:function(c){if(this.type!==Ai.Bytes)return c.push(this.readSVarint());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Ai.Bytes)return c.push(this.readBoolean());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Ai.Bytes)return c.push(this.readFloat());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Ai.Bytes)return c.push(this.readDouble());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Ai.Bytes)return c.push(this.readFixed32());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Ai.Bytes)return c.push(this.readSFixed32());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Ai.Bytes)return c.push(this.readFixed64());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Ai.Bytes)return c.push(this.readSFixed64());var o=Il(this);for(c=c||[];this.pos<o;)c.push(this.readSFixed64());return c},skip:function(c){var o=7&c;if(o===Ai.Varint)for(;this.buf[this.pos++]>127;);else if(o===Ai.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Ai.Fixed32)this.pos+=4;else{if(o!==Ai.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(c,o){this.writeVarint(c<<3|o)},realloc:function(c){for(var o=this.length||16;o<this.pos+c;)o*=2;if(o!==this.length){var h=new Uint8Array(o);h.set(this.buf),this.buf=h,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),lh(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),lh(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),lh(this.buf,-1&c,this.pos),lh(this.buf,Math.floor(c*C7),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),lh(this.buf,-1&c,this.pos),lh(this.buf,Math.floor(c*C7),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(o,h){var g,T;if(o>=0?(g=o%4294967296|0,T=o/4294967296|0):(T=~(-o/4294967296),4294967295^(g=~(-o%4294967296))?g=g+1|0:(g=0,T=T+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(C,k,B){B.buf[B.pos++]=127&C|128,C>>>=7,B.buf[B.pos++]=127&C|128,C>>>=7,B.buf[B.pos++]=127&C|128,C>>>=7,B.buf[B.pos++]=127&C|128,B.buf[B.pos]=127&(C>>>=7)}(g,0,h),function(C,k){var B=(7&C)<<4;k.buf[k.pos++]|=B|((C>>>=3)?128:0),C&&(k.buf[k.pos++]=127&C|((C>>>=7)?128:0),C&&(k.buf[k.pos++]=127&C|((C>>>=7)?128:0),C&&(k.buf[k.pos++]=127&C|((C>>>=7)?128:0),C&&(k.buf[k.pos++]=127&C|((C>>>=7)?128:0),C&&(k.buf[k.pos++]=127&C)))))}(T,h)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var o=this.pos;this.pos=function(g,T,C){for(var k,B,F=0;F<T.length;F++){if((k=T.charCodeAt(F))>55295&&k<57344){if(!B){k>56319||F+1===T.length?(g[C++]=239,g[C++]=191,g[C++]=189):B=k;continue}if(k<56320){g[C++]=239,g[C++]=191,g[C++]=189,B=k;continue}k=B-55296<<10|k-56320|65536,B=null}else B&&(g[C++]=239,g[C++]=191,g[C++]=189,B=null);k<128?g[C++]=k:(k<2048?g[C++]=k>>6|192:(k<65536?g[C++]=k>>12|224:(g[C++]=k>>18|240,g[C++]=k>>12&63|128),g[C++]=k>>6&63|128),g[C++]=63&k|128)}return C}(this.buf,c,this.pos);var h=this.pos-o;h>=128&&M7(o,h,this),this.pos=o-1,this.writeVarint(h),this.pos+=h},writeFloat:function(c){this.realloc(4),S7(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),S7(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var o=c.length;this.writeVarint(o),this.realloc(o);for(var h=0;h<o;h++)this.buf[this.pos++]=c[h]},writeRawMessage:function(c,o){this.pos++;var h=this.pos;c(o,this);var g=this.pos-h;g>=128&&M7(h,g,this),this.pos=h-1,this.writeVarint(g),this.pos+=g},writeMessage:function(c,o,h){this.writeTag(c,Ai.Bytes),this.writeRawMessage(o,h)},writePackedVarint:function(c,o){o.length&&this.writeMessage(c,wM,o)},writePackedSVarint:function(c,o){o.length&&this.writeMessage(c,bM,o)},writePackedBoolean:function(c,o){o.length&&this.writeMessage(c,SM,o)},writePackedFloat:function(c,o){o.length&&this.writeMessage(c,EM,o)},writePackedDouble:function(c,o){o.length&&this.writeMessage(c,TM,o)},writePackedFixed32:function(c,o){o.length&&this.writeMessage(c,CM,o)},writePackedSFixed32:function(c,o){o.length&&this.writeMessage(c,PM,o)},writePackedFixed64:function(c,o){o.length&&this.writeMessage(c,MM,o)},writePackedSFixed64:function(c,o){o.length&&this.writeMessage(c,IM,o)},writeBytesField:function(c,o){this.writeTag(c,Ai.Bytes),this.writeBytes(o)},writeFixed32Field:function(c,o){this.writeTag(c,Ai.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(c,o){this.writeTag(c,Ai.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(c,o){this.writeTag(c,Ai.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(c,o){this.writeTag(c,Ai.Fixed64),this.writeSFixed64(o)},writeVarintField:function(c,o){this.writeTag(c,Ai.Varint),this.writeVarint(o)},writeSVarintField:function(c,o){this.writeTag(c,Ai.Varint),this.writeSVarint(o)},writeStringField:function(c,o){this.writeTag(c,Ai.Bytes),this.writeString(o)},writeFloatField:function(c,o){this.writeTag(c,Ai.Fixed32),this.writeFloat(o)},writeDoubleField:function(c,o){this.writeTag(c,Ai.Fixed64),this.writeDouble(o)},writeBooleanField:function(c,o){this.writeVarintField(c,!!o)}};class sm{constructor(o,{pixelRatio:h,version:g,stretchX:T,stretchY:C,content:k}){this.paddedRect=o,this.pixelRatio=h,this.stretchX=T,this.stretchY=C,this.content=k,this.version=g}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class L7{constructor(o,h){const g={},T={};this.haveRenderCallbacks=[];const C=[];this.addImages(o,g,C),this.addImages(h,T,C);const{w:k,h:B}=k7(C),F=new eo({width:k||1,height:B||1});for(const j in o){const Q=o[j],te=g[j].paddedRect;eo.copy(Q.data,F,{x:0,y:0},{x:te.x+1,y:te.y+1},Q.data)}for(const j in h){const Q=h[j],te=T[j].paddedRect,ae=te.x+1,he=te.y+1,fe=Q.data.width,Le=Q.data.height;eo.copy(Q.data,F,{x:0,y:0},{x:ae,y:he},Q.data),eo.copy(Q.data,F,{x:0,y:Le-1},{x:ae,y:he-1},{width:fe,height:1}),eo.copy(Q.data,F,{x:0,y:0},{x:ae,y:he+Le},{width:fe,height:1}),eo.copy(Q.data,F,{x:fe-1,y:0},{x:ae-1,y:he},{width:1,height:Le}),eo.copy(Q.data,F,{x:0,y:0},{x:ae+fe,y:he},{width:1,height:Le})}this.image=F,this.iconPositions=g,this.patternPositions=T}addImages(o,h,g){for(const T in o){const C=o[T],k={x:0,y:0,w:C.data.width+2,h:C.data.height+2};g.push(k),h[T]=new sm(k,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(T)}}patchUpdatedImages(o,h){o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const g in o.updatedImages)this.patchUpdatedImage(this.iconPositions[g],o.getImage(g),h),this.patchUpdatedImage(this.patternPositions[g],o.getImage(g),h)}patchUpdatedImage(o,h,g){if(!o||!h||o.version===h.version)return;o.version=h.version;const[T,C]=o.tl;g.update(h.data,void 0,{x:T,y:C})}}Ft("ImagePosition",sm),Ft("ImageAtlas",L7),a.WritingMode=void 0,(M0=a.WritingMode||(a.WritingMode={}))[M0.none=0]="none",M0[M0.horizontal=1]="horizontal",M0[M0.vertical=2]="vertical",M0[M0.horizontalOnly=3]="horizontalOnly";const aA=-17;class Q1{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,h){const g=new Q1;return g.scale=o||1,g.fontStack=h,g}static forImage(o){const h=new Q1;return h.imageName=o,h}}class ch{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,h){const g=new ch;for(let T=0;T<o.sections.length;T++){const C=o.sections[T];C.image?g.addImageSection(C):g.addTextSection(C,h)}return g}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(){this.text=function(o){let h="";for(let g=0;g<o.length;g++){const T=o.charCodeAt(g+1)||null,C=o.charCodeAt(g-1)||null;h+=T&&Rs(T)&&!X1[o[g+1]]||C&&Rs(C)&&!X1[o[g-1]]||!X1[o[g]]?o[g]:X1[o[g]]}return h}(this.text)}trim(){let o=0;for(let g=0;g<this.text.length&&cA[this.text.charCodeAt(g)];g++)o++;let h=this.text.length;for(let g=this.text.length-1;g>=0&&g>=o&&cA[this.text.charCodeAt(g)];g--)h--;this.text=this.text.substring(o,h),this.sectionIndex=this.sectionIndex.slice(o,h)}substring(o,h){const g=new ch;return g.text=this.text.substring(o,h),g.sectionIndex=this.sectionIndex.slice(o,h),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,h)=>Math.max(o,this.sections[h].scale),0)}addTextSection(o,h){this.text+=o.text,this.sections.push(Q1.forText(o.scale,o.fontStack||h));const g=this.sections.length-1;for(let T=0;T<o.text.length;++T)this.sectionIndex.push(g)}addImageSection(o){const h=o.image?o.image.name:"";if(h.length===0)return void be("Can't add FormattedSection with an empty image.");const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Q1.forImage(h)),this.sectionIndex.push(this.sections.length-1)):be("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function lA(c,o,h,g,T,C,k,B,F,j,Q,te,ae,he,fe,Le){const Pe=ch.fromFeature(c,T);let Ge;te===a.WritingMode.vertical&&Pe.verticalizePunctuation();const{processBidirectionalText:Ye,processStyledBidirectionalText:Fe}=Zr;if(Ye&&Pe.sections.length===1){Ge=[];const lt=Ye(Pe.toString(),om(Pe,j,C,o,g,he,fe));for(const Nt of lt){const jt=new ch;jt.text=Nt,jt.sections=Pe.sections;for(let Rt=0;Rt<Nt.length;Rt++)jt.sectionIndex.push(0);Ge.push(jt)}}else if(Fe){Ge=[];const lt=Fe(Pe.text,Pe.sectionIndex,om(Pe,j,C,o,g,he,fe));for(const Nt of lt){const jt=new ch;jt.text=Nt[0],jt.sectionIndex=Nt[1],jt.sections=Pe.sections,Ge.push(jt)}}else Ge=function(lt,Nt){const jt=[],Rt=lt.text;let Pt=0;for(const Tt of Nt)jt.push(lt.substring(Pt,Tt)),Pt=Tt;return Pt<Rt.length&&jt.push(lt.substring(Pt,Rt.length)),jt}(Pe,om(Pe,j,C,o,g,he,fe));const Ze=[],ct={positionedLines:Ze,text:Pe.toString(),top:Q[1],bottom:Q[1],left:Q[0],right:Q[0],writingMode:te,iconsInText:!1,verticalizable:!1};return function(lt,Nt,jt,Rt,Pt,Tt,zt,kt,_t,rn,qt,kn){let yi=0,xi=aA,ir=0,no=0;const Er=kt==="right"?1:kt==="left"?0:.5;let Zi=0;for(const Xi of Pt){Xi.trim();const Sr=Xi.getMaxScale(),Or=(Sr-1)*mr,Yr={positionedGlyphs:[],lineOffset:0};lt.positionedLines[Zi]=Yr;const _s=Yr.positionedGlyphs;let ys=0;if(!Xi.length()){xi+=Tt,++Zi;continue}for(let cr=0;cr<Xi.length();cr++){const Fn=Xi.getSection(cr),Bs=Xi.getSectionIndex(cr),Cr=Xi.getCharCode(cr);let Fr=0,Mo=null,ta=null,na=null,Ll=mr;const Io=!(_t===a.WritingMode.horizontal||!qt&&!T0(Cr)||qt&&(cA[Cr]||(lr=Cr,Dt.Arabic(lr)||Dt["Arabic Supplement"](lr)||Dt["Arabic Extended-A"](lr)||Dt["Arabic Presentation Forms-A"](lr)||Dt["Arabic Presentation Forms-B"](lr))));if(Fn.imageName){const io=Rt[Fn.imageName];if(!io)continue;na=Fn.imageName,lt.iconsInText=lt.iconsInText||!0,ta=io.paddedRect;const vs=io.displaySize;Fn.scale=Fn.scale*mr/kn,Mo={width:vs[0],height:vs[1],left:1,top:-3,advance:Io?vs[1]:vs[0]},Fr=Or+(mr-vs[1]*Fn.scale),Ll=Mo.advance;const Dl=Io?vs[0]*Fn.scale-mr*Sr:vs[1]*Fn.scale-mr*Sr;Dl>0&&Dl>ys&&(ys=Dl)}else{const io=jt[Fn.fontStack],vs=io&&io[Cr];if(vs&&vs.rect)ta=vs.rect,Mo=vs.metrics;else{const Dl=Nt[Fn.fontStack],J1=Dl&&Dl[Cr];if(!J1)continue;Mo=J1.metrics}Fr=(Sr-Fn.scale)*mr}Io?(lt.verticalizable=!0,_s.push({glyph:Cr,imageName:na,x:yi,y:xi+Fr,vertical:Io,scale:Fn.scale,fontStack:Fn.fontStack,sectionIndex:Bs,metrics:Mo,rect:ta}),yi+=Ll*Fn.scale+rn):(_s.push({glyph:Cr,imageName:na,x:yi,y:xi+Fr,vertical:Io,scale:Fn.scale,fontStack:Fn.fontStack,sectionIndex:Bs,metrics:Mo,rect:ta}),yi+=Mo.advance*Fn.scale+rn)}_s.length!==0&&(ir=Math.max(yi-rn,ir),BM(_s,0,_s.length-1,Er,ys)),yi=0;const Si=Tt*Sr+ys;Yr.lineOffset=Math.max(ys,Or),xi+=Si,no=Math.max(Si,no),++Zi}var lr;const Tr=xi-aA,{horizontalAlign:Br,verticalAlign:gs}=am(zt);(function(Xi,Sr,Or,Yr,_s,ys,Si,cr,Fn){const Bs=(Sr-Or)*_s;let Cr=0;Cr=ys!==Si?-cr*Yr-aA:(-Yr*Fn+.5)*Si;for(const Fr of Xi)for(const Mo of Fr.positionedGlyphs)Mo.x+=Bs,Mo.y+=Cr})(lt.positionedLines,Er,Br,gs,ir,no,Tt,Tr,Pt.length),lt.top+=-gs*Tr,lt.bottom=lt.top+Tr,lt.left+=-Br*ir,lt.right=lt.left+ir}(ct,o,h,g,Ge,k,B,F,te,j,ae,Le),!function(lt){for(const Nt of lt)if(Nt.positionedGlyphs.length!==0)return!1;return!0}(Ze)&&ct}const cA={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},RM={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function D7(c,o,h,g,T,C){if(o.imageName){const k=g[o.imageName];return k?k.displaySize[0]*o.scale*mr/C+T:0}{const k=h[o.fontStack],B=k&&k[c];return B?B.metrics.advance*o.scale+T:0}}function R7(c,o,h,g){const T=Math.pow(c-o,2);return g?c<o?T/2:2*T:T+Math.abs(h)*h}function zM(c,o,h){let g=0;return c===10&&(g-=1e4),h&&(g+=150),c!==40&&c!==65288||(g+=50),o!==41&&o!==65289||(g+=50),g}function z7(c,o,h,g,T,C){let k=null,B=R7(o,h,T,C);for(const F of g){const j=R7(o-F.x,h,T,C)+F.badness;j<=B&&(k=F,B=j)}return{index:c,x:o,priorBreak:k,badness:B}}function B7(c){return c?B7(c.priorBreak).concat(c.index):[]}function om(c,o,h,g,T,C,k){if(C!=="point")return[];if(!c)return[];const B=[],F=function(ae,he,fe,Le,Pe,Ge){let Ye=0;for(let Fe=0;Fe<ae.length();Fe++){const Ze=ae.getSection(Fe);Ye+=D7(ae.getCharCode(Fe),Ze,Le,Pe,he,Ge)}return Ye/Math.max(1,Math.ceil(Ye/fe))}(c,o,h,g,T,k),j=c.text.indexOf("​")>=0;let Q=0;for(let ae=0;ae<c.length();ae++){const he=c.getSection(ae),fe=c.getCharCode(ae);if(cA[fe]||(Q+=D7(fe,he,g,T,o,k)),ae<c.length()-1){const Le=!((te=fe)<11904||!(Dt["Bopomofo Extended"](te)||Dt.Bopomofo(te)||Dt["CJK Compatibility Forms"](te)||Dt["CJK Compatibility Ideographs"](te)||Dt["CJK Compatibility"](te)||Dt["CJK Radicals Supplement"](te)||Dt["CJK Strokes"](te)||Dt["CJK Symbols and Punctuation"](te)||Dt["CJK Unified Ideographs Extension A"](te)||Dt["CJK Unified Ideographs"](te)||Dt["Enclosed CJK Letters and Months"](te)||Dt["Halfwidth and Fullwidth Forms"](te)||Dt.Hiragana(te)||Dt["Ideographic Description Characters"](te)||Dt["Kangxi Radicals"](te)||Dt["Katakana Phonetic Extensions"](te)||Dt.Katakana(te)||Dt["Vertical Forms"](te)||Dt["Yi Radicals"](te)||Dt["Yi Syllables"](te)));(RM[fe]||Le||he.imageName)&&B.push(z7(ae+1,Q,F,B,zM(fe,c.getCharCode(ae+1),Le&&j),!1))}}var te;return B7(z7(c.length(),Q,F,B,0,!0))}function am(c){let o=.5,h=.5;switch(c){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:o,verticalAlign:h}}function BM(c,o,h,g,T){if(!g&&!T)return;const C=c[h],k=(c[h].x+C.metrics.advance*C.scale)*g;for(let B=o;B<=h;B++)c[B].x-=k,c[B].y+=T}function OM(c,o,h){const{horizontalAlign:g,verticalAlign:T}=am(h),C=o[0]-c.displaySize[0]*g,k=o[1]-c.displaySize[1]*T;return{image:c,top:k,bottom:k+c.displaySize[1],left:C,right:C+c.displaySize[0]}}function O7(c,o,h,g,T,C){const k=c.image;let B;if(k.content){const Pe=k.content,Ge=k.pixelRatio||1;B=[Pe[0]/Ge,Pe[1]/Ge,k.displaySize[0]-Pe[2]/Ge,k.displaySize[1]-Pe[3]/Ge]}const F=o.left*C,j=o.right*C;let Q,te,ae,he;h==="width"||h==="both"?(he=T[0]+F-g[3],te=T[0]+j+g[1]):(he=T[0]+(F+j-k.displaySize[0])/2,te=he+k.displaySize[0]);const fe=o.top*C,Le=o.bottom*C;return h==="height"||h==="both"?(Q=T[1]+fe-g[0],ae=T[1]+Le+g[2]):(Q=T[1]+(fe+Le-k.displaySize[1])/2,ae=Q+k.displaySize[1]),{image:k,top:Q,right:te,bottom:ae,left:he,collisionPadding:B}}const kl=128;function F7(c,o){const{expression:h}=o;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new mi(c+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:T}=h;let C=0;for(;C<g.length&&g[C]<=c;)C++;C=Math.max(0,C-1);let k=C;for(;k<g.length&&g[k]<c+1;)k++;k=Math.min(g.length-1,k);const B=g[C],F=g[k];return h.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:F,interpolationType:T}:{kind:"camera",minZoom:B,maxZoom:F,minSize:h.evaluate(new mi(B)),maxSize:h.evaluate(new mi(F)),interpolationType:T}}}class I0 extends Ot{constructor(o,h,g,T){super(o,h),this.angle=g,T!==void 0&&(this.segment=T)}clone(){return new I0(this.x,this.y,this.angle,this.segment)}}function N7(c,o,h,g,T){if(o.segment===void 0)return!0;let C=o,k=o.segment+1,B=0;for(;B>-h/2;){if(k--,k<0)return!1;B-=c[k].dist(C),C=c[k]}B+=c[k].dist(c[k+1]),k++;const F=[];let j=0;for(;B<h/2;){const Q=c[k],te=c[k+1];if(!te)return!1;let ae=c[k-1].angleTo(Q)-Q.angleTo(te);for(ae=Math.abs((ae+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:B,angleDelta:ae}),j+=ae;B-F[0].distance>g;)j-=F.shift().angleDelta;if(j>T)return!1;k++,B+=Q.dist(te)}return!0}function U7(c){let o=0;for(let h=0;h<c.length-1;h++)o+=c[h].dist(c[h+1]);return o}function V7(c,o,h){return c?.6*o*h:0}function G7(c,o){return Math.max(c?c.right-c.left:0,o?o.right-o.left:0)}function FM(c,o,h,g,T,C){const k=V7(h,T,C),B=G7(h,g)*C;let F=0;const j=U7(c)/2;for(let Q=0;Q<c.length-1;Q++){const te=c[Q],ae=c[Q+1],he=te.dist(ae);if(F+he>j){const fe=(j-F)/he,Le=Tn(te.x,ae.x,fe),Pe=Tn(te.y,ae.y,fe),Ge=new I0(Le,Pe,ae.angleTo(te),Q);return Ge._round(),!k||N7(c,Ge,B,k,o)?Ge:void 0}F+=he}}function NM(c,o,h,g,T,C,k,B,F){const j=V7(g,C,k),Q=G7(g,T),te=Q*k,ae=c[0].x===0||c[0].x===F||c[0].y===0||c[0].y===F;return o-te<o/4&&(o=te+o/4),j7(c,ae?o/2*B%o:(Q/2+2*C)*k*B%o,o,j,h,te,ae,!1,F)}function j7(c,o,h,g,T,C,k,B,F){const j=C/2,Q=U7(c);let te=0,ae=o-h,he=[];for(let fe=0;fe<c.length-1;fe++){const Le=c[fe],Pe=c[fe+1],Ge=Le.dist(Pe),Ye=Pe.angleTo(Le);for(;ae+h<te+Ge;){ae+=h;const Fe=(ae-te)/Ge,Ze=Tn(Le.x,Pe.x,Fe),ct=Tn(Le.y,Pe.y,Fe);if(Ze>=0&&Ze<F&&ct>=0&&ct<F&&ae-j>=0&&ae+j<=Q){const lt=new I0(Ze,ct,Ye,fe);lt._round(),g&&!N7(c,lt,C,g,T)||he.push(lt)}}te+=Ge}return B||he.length||k||(he=j7(c,te/2,h,g,T,C,k,!0,F)),he}function H7(c,o,h,g,T){const C=[];for(let k=0;k<c.length;k++){const B=c[k];let F;for(let j=0;j<B.length-1;j++){let Q=B[j],te=B[j+1];Q.x<o&&te.x<o||(Q.x<o?Q=new Ot(o,Q.y+(o-Q.x)/(te.x-Q.x)*(te.y-Q.y))._round():te.x<o&&(te=new Ot(o,Q.y+(o-Q.x)/(te.x-Q.x)*(te.y-Q.y))._round()),Q.y<h&&te.y<h||(Q.y<h?Q=new Ot(Q.x+(h-Q.y)/(te.y-Q.y)*(te.x-Q.x),h)._round():te.y<h&&(te=new Ot(Q.x+(h-Q.y)/(te.y-Q.y)*(te.x-Q.x),h)._round()),Q.x>=g&&te.x>=g||(Q.x>=g?Q=new Ot(g,Q.y+(g-Q.x)/(te.x-Q.x)*(te.y-Q.y))._round():te.x>=g&&(te=new Ot(g,Q.y+(g-Q.x)/(te.x-Q.x)*(te.y-Q.y))._round()),Q.y>=T&&te.y>=T||(Q.y>=T?Q=new Ot(Q.x+(T-Q.y)/(te.y-Q.y)*(te.x-Q.x),T)._round():te.y>=T&&(te=new Ot(Q.x+(T-Q.y)/(te.y-Q.y)*(te.x-Q.x),T)._round()),F&&Q.equals(F[F.length-1])||(F=[Q],C.push(F)),F.push(te)))))}}return C}function W7(c,o,h,g){const T=[],C=c.image,k=C.pixelRatio,B=C.paddedRect.w-2,F=C.paddedRect.h-2,j=c.right-c.left,Q=c.bottom-c.top,te=C.stretchX||[[0,B]],ae=C.stretchY||[[0,F]],he=(Tt,zt)=>Tt+zt[1]-zt[0],fe=te.reduce(he,0),Le=ae.reduce(he,0),Pe=B-fe,Ge=F-Le;let Ye=0,Fe=fe,Ze=0,ct=Le,lt=0,Nt=Pe,jt=0,Rt=Ge;if(C.content&&g){const Tt=C.content;Ye=uA(te,0,Tt[0]),Ze=uA(ae,0,Tt[1]),Fe=uA(te,Tt[0],Tt[2]),ct=uA(ae,Tt[1],Tt[3]),lt=Tt[0]-Ye,jt=Tt[1]-Ze,Nt=Tt[2]-Tt[0]-Fe,Rt=Tt[3]-Tt[1]-ct}const Pt=(Tt,zt,kt,_t)=>{const rn=hA(Tt.stretch-Ye,Fe,j,c.left),qt=fA(Tt.fixed-lt,Nt,Tt.stretch,fe),kn=hA(zt.stretch-Ze,ct,Q,c.top),yi=fA(zt.fixed-jt,Rt,zt.stretch,Le),xi=hA(kt.stretch-Ye,Fe,j,c.left),ir=fA(kt.fixed-lt,Nt,kt.stretch,fe),no=hA(_t.stretch-Ze,ct,Q,c.top),Er=fA(_t.fixed-jt,Rt,_t.stretch,Le),Zi=new Ot(rn,kn),lr=new Ot(xi,kn),Tr=new Ot(xi,no),Br=new Ot(rn,no),gs=new Ot(qt/k,yi/k),Xi=new Ot(ir/k,Er/k),Sr=o*Math.PI/180;if(Sr){const _s=Math.sin(Sr),ys=Math.cos(Sr),Si=[ys,-_s,_s,ys];Zi._matMult(Si),lr._matMult(Si),Br._matMult(Si),Tr._matMult(Si)}const Or=Tt.stretch+Tt.fixed,Yr=zt.stretch+zt.fixed;return{tl:Zi,tr:lr,bl:Br,br:Tr,tex:{x:C.paddedRect.x+1+Or,y:C.paddedRect.y+1+Yr,w:kt.stretch+kt.fixed-Or,h:_t.stretch+_t.fixed-Yr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:gs,pixelOffsetBR:Xi,minFontScaleX:Nt/k/j,minFontScaleY:Rt/k/Q,isSDF:h}};if(g&&(C.stretchX||C.stretchY)){const Tt=$7(te,Pe,fe),zt=$7(ae,Ge,Le);for(let kt=0;kt<Tt.length-1;kt++){const _t=Tt[kt],rn=Tt[kt+1];for(let qt=0;qt<zt.length-1;qt++)T.push(Pt(_t,zt[qt],rn,zt[qt+1]))}}else T.push(Pt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:F+1}));return T}function uA(c,o,h){let g=0;for(const T of c)g+=Math.max(o,Math.min(h,T[1]))-Math.max(o,Math.min(h,T[0]));return g}function $7(c,o,h){const g=[{fixed:-1,stretch:0}];for(const[T,C]of c){const k=g[g.length-1];g.push({fixed:T-k.stretch,stretch:k.stretch}),g.push({fixed:T-k.stretch,stretch:k.stretch+(C-T)})}return g.push({fixed:o+1,stretch:h}),g}function hA(c,o,h,g){return c/o*h+g}function fA(c,o,h,g){return c-o*h/g}Ft("Anchor",I0);class AA{constructor(o,h,g,T,C,k,B,F,j,Q){if(this.boxStartIndex=o.length,j){let te=k.top,ae=k.bottom;const he=k.collisionPadding;he&&(te-=he[1],ae+=he[3]);let fe=ae-te;fe>0&&(fe=Math.max(10,fe),this.circleDiameter=fe)}else{let te=k.top*B-F[0],ae=k.bottom*B+F[2],he=k.left*B-F[3],fe=k.right*B+F[1];const Le=k.collisionPadding;if(Le&&(he-=Le[0]*B,te-=Le[1]*B,fe+=Le[2]*B,ae+=Le[3]*B),Q){const Pe=new Ot(he,te),Ge=new Ot(fe,te),Ye=new Ot(he,ae),Fe=new Ot(fe,ae),Ze=Q*Math.PI/180;Pe._rotate(Ze),Ge._rotate(Ze),Ye._rotate(Ze),Fe._rotate(Ze),he=Math.min(Pe.x,Ge.x,Ye.x,Fe.x),fe=Math.max(Pe.x,Ge.x,Ye.x,Fe.x),te=Math.min(Pe.y,Ge.y,Ye.y,Fe.y),ae=Math.max(Pe.y,Ge.y,Ye.y,Fe.y)}o.emplaceBack(h.x,h.y,he,te,fe,ae,g,T,C)}this.boxEndIndex=o.length}}class UM{constructor(o=[],h=VM){if(this.data=o,this.length=this.data.length,this.compare=h,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const o=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:h,compare:g}=this,T=h[o];for(;o>0;){const C=o-1>>1,k=h[C];if(g(T,k)>=0)break;h[o]=k,o=C}h[o]=T}_down(o){const{data:h,compare:g}=this,T=this.length>>1,C=h[o];for(;o<T;){let k=1+(o<<1),B=h[k];const F=k+1;if(F<this.length&&g(h[F],B)<0&&(k=F,B=h[F]),g(B,C)>=0)break;h[o]=B,o=k}h[o]=C}}function VM(c,o){return c<o?-1:c>o?1:0}function GM(c,o=1,h=!1){let g=1/0,T=1/0,C=-1/0,k=-1/0;const B=c[0];for(let he=0;he<B.length;he++){const fe=B[he];(!he||fe.x<g)&&(g=fe.x),(!he||fe.y<T)&&(T=fe.y),(!he||fe.x>C)&&(C=fe.x),(!he||fe.y>k)&&(k=fe.y)}const F=Math.min(C-g,k-T);let j=F/2;const Q=new UM([],jM);if(F===0)return new Ot(g,T);for(let he=g;he<C;he+=F)for(let fe=T;fe<k;fe+=F)Q.push(new uh(he+j,fe+j,j,c));let te=function(he){let fe=0,Le=0,Pe=0;const Ge=he[0];for(let Ye=0,Fe=Ge.length,Ze=Fe-1;Ye<Fe;Ze=Ye++){const ct=Ge[Ye],lt=Ge[Ze],Nt=ct.x*lt.y-lt.x*ct.y;Le+=(ct.x+lt.x)*Nt,Pe+=(ct.y+lt.y)*Nt,fe+=3*Nt}return new uh(Le/fe,Pe/fe,0,he)}(c),ae=Q.length;for(;Q.length;){const he=Q.pop();(he.d>te.d||!te.d)&&(te=he,h&&console.log("found best %d after %d probes",Math.round(1e4*he.d)/1e4,ae)),he.max-te.d<=o||(j=he.h/2,Q.push(new uh(he.p.x-j,he.p.y-j,j,c)),Q.push(new uh(he.p.x+j,he.p.y-j,j,c)),Q.push(new uh(he.p.x-j,he.p.y+j,j,c)),Q.push(new uh(he.p.x+j,he.p.y+j,j,c)),ae+=4)}return h&&(console.log(`num probes: ${ae}`),console.log(`best distance: ${te.d}`)),te.p}function jM(c,o){return o.max-c.max}function uh(c,o,h,g){this.p=new Ot(c,o),this.h=h,this.d=function(T,C){let k=!1,B=1/0;for(let F=0;F<C.length;F++){const j=C[F];for(let Q=0,te=j.length,ae=te-1;Q<te;ae=Q++){const he=j[Q],fe=j[ae];he.y>T.y!=fe.y>T.y&&T.x<(fe.x-he.x)*(T.y-he.y)/(fe.y-he.y)+he.x&&(k=!k),B=Math.min(B,e7(T,he,fe))}}return(k?1:-1)*Math.sqrt(B)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}const lm=Number.POSITIVE_INFINITY;function q7(c,o){return o[1]!==lm?function(h,g,T){let C=0,k=0;switch(g=Math.abs(g),T=Math.abs(T),h){case"top-right":case"top-left":case"top":k=T-7;break;case"bottom-right":case"bottom-left":case"bottom":k=7-T}switch(h){case"top-right":case"bottom-right":case"right":C=-g;break;case"top-left":case"bottom-left":case"left":C=g}return[C,k]}(c,o[0],o[1]):function(h,g){let T=0,C=0;g<0&&(g=0);const k=g/Math.sqrt(2);switch(h){case"top-right":case"top-left":C=k-7;break;case"bottom-right":case"bottom-left":C=7-k;break;case"bottom":C=7-g;break;case"top":C=g-7}switch(h){case"top-right":case"bottom-right":T=-k;break;case"top-left":case"bottom-left":T=k;break;case"left":T=g;break;case"right":T=-g}return[T,C]}(c,o[0])}function cm(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function HM(c,o,h,g,T,C,k,B,F,j,Q){let te=C.textMaxSize.evaluate(o,{});te===void 0&&(te=k);const ae=c.layers[0].layout,he=ae.get("icon-offset").evaluate(o,{},Q),fe=X7(h.horizontal),Le=k/24,Pe=c.tilePixelRatio*Le,Ge=c.tilePixelRatio*te/24,Ye=c.tilePixelRatio*B,Fe=c.tilePixelRatio*ae.get("symbol-spacing"),Ze=ae.get("text-padding")*c.tilePixelRatio,ct=function(_t,rn,qt,kn=1){const yi=_t.get("icon-padding").evaluate(rn,{},qt),xi=yi&&yi.values;return[xi[0]*kn,xi[1]*kn,xi[2]*kn,xi[3]*kn]}(ae,o,Q,c.tilePixelRatio),lt=ae.get("text-max-angle")/180*Math.PI,Nt=ae.get("text-rotation-alignment")!=="viewport"&&ae.get("symbol-placement")!=="point",jt=ae.get("icon-rotation-alignment")==="map"&&ae.get("symbol-placement")!=="point",Rt=ae.get("symbol-placement"),Pt=Fe/2,Tt=ae.get("icon-text-fit");let zt;g&&Tt!=="none"&&(c.allowVerticalPlacement&&h.vertical&&(zt=O7(g,h.vertical,Tt,ae.get("icon-text-fit-padding"),he,Le)),fe&&(g=O7(g,fe,Tt,ae.get("icon-text-fit-padding"),he,Le)));const kt=(_t,rn)=>{rn.x<0||rn.x>=nr||rn.y<0||rn.y>=nr||function(qt,kn,yi,xi,ir,no,Er,Zi,lr,Tr,Br,gs,Xi,Sr,Or,Yr,_s,ys,Si,cr,Fn,Bs,Cr,Fr,Mo){const ta=qt.addToLineVertexArray(kn,yi);let na,Ll,Io,io,vs=0,Dl=0,J1=0,h9=0,ym=-1,vm=-1;const Rl={};let f9=hn.exports(""),xm=0,wm=0;if(Zi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[xm,wm]=Zi.layout.get("text-offset").evaluate(Fn,{},Fr).map(xs=>xs*mr):(xm=Zi.layout.get("text-radial-offset").evaluate(Fn,{},Fr)*mr,wm=lm),qt.allowVerticalPlacement&&xi.vertical){const xs=Zi.layout.get("text-rotate").evaluate(Fn,{},Fr)+90;Io=new AA(lr,kn,Tr,Br,gs,xi.vertical,Xi,Sr,Or,xs),Er&&(io=new AA(lr,kn,Tr,Br,gs,Er,_s,ys,Or,xs))}if(ir){const xs=Zi.layout.get("icon-rotate").evaluate(Fn,{}),Na=Zi.layout.get("icon-text-fit")!=="none",ef=W7(ir,xs,Cr,Na),tf=Er?W7(Er,xs,Cr,Na):void 0;Ll=new AA(lr,kn,Tr,Br,gs,ir,_s,ys,!1,xs),vs=4*ef.length;const p9=qt.iconSizeData;let Nc=null;p9.kind==="source"?(Nc=[kl*Zi.layout.get("icon-size").evaluate(Fn,{})],Nc[0]>k0&&be(`${qt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):p9.kind==="composite"&&(Nc=[kl*Bs.compositeIconSizes[0].evaluate(Fn,{},Fr),kl*Bs.compositeIconSizes[1].evaluate(Fn,{},Fr)],(Nc[0]>k0||Nc[1]>k0)&&be(`${qt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),qt.addSymbols(qt.icon,ef,Nc,cr,Si,Fn,a.WritingMode.none,kn,ta.lineStartIndex,ta.lineLength,-1,Fr),ym=qt.icon.placedSymbolArray.length-1,tf&&(Dl=4*tf.length,qt.addSymbols(qt.icon,tf,Nc,cr,Si,Fn,a.WritingMode.vertical,kn,ta.lineStartIndex,ta.lineLength,-1,Fr),vm=qt.icon.placedSymbolArray.length-1)}const A9=Object.keys(xi.horizontal);for(const xs of A9){const Na=xi.horizontal[xs];if(!na){f9=hn.exports(Na.text);const tf=Zi.layout.get("text-rotate").evaluate(Fn,{},Fr);na=new AA(lr,kn,Tr,Br,gs,Na,Xi,Sr,Or,tf)}const ef=Na.positionedLines.length===1;if(J1+=Z7(qt,kn,Na,no,Zi,Or,Fn,Yr,ta,xi.vertical?a.WritingMode.horizontal:a.WritingMode.horizontalOnly,ef?A9:[xs],Rl,ym,Bs,Fr),ef)break}xi.vertical&&(h9+=Z7(qt,kn,xi.vertical,no,Zi,Or,Fn,Yr,ta,a.WritingMode.vertical,["vertical"],Rl,vm,Bs,Fr));const iI=na?na.boxStartIndex:qt.collisionBoxArray.length,rI=na?na.boxEndIndex:qt.collisionBoxArray.length,sI=Io?Io.boxStartIndex:qt.collisionBoxArray.length,oI=Io?Io.boxEndIndex:qt.collisionBoxArray.length,aI=Ll?Ll.boxStartIndex:qt.collisionBoxArray.length,lI=Ll?Ll.boxEndIndex:qt.collisionBoxArray.length,cI=io?io.boxStartIndex:qt.collisionBoxArray.length,uI=io?io.boxEndIndex:qt.collisionBoxArray.length;let ia=-1;const _A=(xs,Na)=>xs&&xs.circleDiameter?Math.max(xs.circleDiameter,Na):Na;ia=_A(na,ia),ia=_A(Io,ia),ia=_A(Ll,ia),ia=_A(io,ia);const d9=ia>-1?1:0;d9&&(ia*=Mo/mr),qt.glyphOffsetArray.length>=hh.MAX_GLYPHS&&be("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fn.sortKey!==void 0&&qt.addToSortKeyRanges(qt.symbolInstances.length,Fn.sortKey),qt.symbolInstances.emplaceBack(kn.x,kn.y,Rl.right>=0?Rl.right:-1,Rl.center>=0?Rl.center:-1,Rl.left>=0?Rl.left:-1,Rl.vertical||-1,ym,vm,f9,iI,rI,sI,oI,aI,lI,cI,uI,Tr,J1,h9,vs,Dl,d9,0,Xi,xm,wm,ia)}(c,rn,_t,h,g,T,zt,c.layers[0],c.collisionBoxArray,o.index,o.sourceLayerIndex,c.index,Pe,[Ze,Ze,Ze,Ze],Nt,F,Ye,ct,jt,he,o,C,j,Q,k)};if(Rt==="line")for(const _t of H7(o.geometry,0,0,nr,nr)){const rn=NM(_t,Fe,lt,h.vertical||fe,g,24,Ge,c.overscaling,nr);for(const qt of rn){const kn=fe;kn&&WM(c,kn.text,Pt,qt)||kt(_t,qt)}}else if(Rt==="line-center"){for(const _t of o.geometry)if(_t.length>1){const rn=FM(_t,lt,h.vertical||fe,g,24,Ge);rn&&kt(_t,rn)}}else if(o.type==="Polygon")for(const _t of Q3(o.geometry,0)){const rn=GM(_t,16);kt(_t[0],new I0(rn.x,rn.y,0))}else if(o.type==="LineString")for(const _t of o.geometry)kt(_t,new I0(_t[0].x,_t[0].y,0));else if(o.type==="Point")for(const _t of o.geometry)for(const rn of _t)kt([rn],new I0(rn.x,rn.y,0))}const k0=32640;function Z7(c,o,h,g,T,C,k,B,F,j,Q,te,ae,he,fe){const Le=function(Ye,Fe,Ze,ct,lt,Nt,jt,Rt){const Pt=ct.layout.get("text-rotate").evaluate(Nt,{})*Math.PI/180,Tt=[];for(const zt of Fe.positionedLines)for(const kt of zt.positionedGlyphs){if(!kt.rect)continue;const _t=kt.rect||{};let rn=4,qt=!0,kn=1,yi=0;const xi=(lt||Rt)&&kt.vertical,ir=kt.metrics.advance*kt.scale/2;if(Rt&&Fe.verticalizable){const Si=(kt.scale-1)*mr,cr=(mr-kt.metrics.width*kt.scale)/2;yi=zt.lineOffset/2-(kt.imageName?-cr:Si)}if(kt.imageName){const Si=jt[kt.imageName];qt=Si.sdf,kn=Si.pixelRatio,rn=1/kn}const no=lt?[kt.x+ir,kt.y]:[0,0];let Er=lt?[0,0]:[kt.x+ir+Ze[0],kt.y+Ze[1]-yi],Zi=[0,0];xi&&(Zi=Er,Er=[0,0]);const lr=(kt.metrics.left-rn)*kt.scale-ir+Er[0],Tr=(-kt.metrics.top-rn)*kt.scale+Er[1],Br=lr+_t.w*kt.scale/kn,gs=Tr+_t.h*kt.scale/kn,Xi=new Ot(lr,Tr),Sr=new Ot(Br,Tr),Or=new Ot(lr,gs),Yr=new Ot(Br,gs);if(xi){const Si=new Ot(-ir,ir-aA),cr=-Math.PI/2,Fn=12-ir,Bs=new Ot(22-Fn,-(kt.imageName?Fn:0)),Cr=new Ot(...Zi);Xi._rotateAround(cr,Si)._add(Bs)._add(Cr),Sr._rotateAround(cr,Si)._add(Bs)._add(Cr),Or._rotateAround(cr,Si)._add(Bs)._add(Cr),Yr._rotateAround(cr,Si)._add(Bs)._add(Cr)}if(Pt){const Si=Math.sin(Pt),cr=Math.cos(Pt),Fn=[cr,-Si,Si,cr];Xi._matMult(Fn),Sr._matMult(Fn),Or._matMult(Fn),Yr._matMult(Fn)}const _s=new Ot(0,0),ys=new Ot(0,0);Tt.push({tl:Xi,tr:Sr,bl:Or,br:Yr,tex:_t,writingMode:Fe.writingMode,glyphOffset:no,sectionIndex:kt.sectionIndex,isSDF:qt,pixelOffsetTL:_s,pixelOffsetBR:ys,minFontScaleX:0,minFontScaleY:0})}return Tt}(0,h,B,T,C,k,g,c.allowVerticalPlacement),Pe=c.textSizeData;let Ge=null;Pe.kind==="source"?(Ge=[kl*T.layout.get("text-size").evaluate(k,{})],Ge[0]>k0&&be(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Pe.kind==="composite"&&(Ge=[kl*he.compositeTextSizes[0].evaluate(k,{},fe),kl*he.compositeTextSizes[1].evaluate(k,{},fe)],(Ge[0]>k0||Ge[1]>k0)&&be(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,Le,Ge,B,C,k,j,o,F.lineStartIndex,F.lineLength,ae,fe);for(const Ye of Q)te[Ye]=c.text.placedSymbolArray.length-1;return 4*Le.length}function X7(c){for(const o in c)return c[o];return null}function WM(c,o,h,g){const T=c.compareText;if(o in T){const C=T[o];for(let k=C.length-1;k>=0;k--)if(g.dist(C[k])<h)return!0}else T[o]=[];return T[o].push(g),!1}const $M=P0.VectorTileFeature.types,qM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function dA(c,o,h,g,T,C,k,B,F,j,Q,te,ae){const he=B?Math.min(k0,Math.round(B[0])):0,fe=B?Math.min(k0,Math.round(B[1])):0;c.emplaceBack(o,h,Math.round(32*g),Math.round(32*T),C,k,(he<<1)+(F?1:0),fe,16*j,16*Q,256*te,256*ae)}function um(c,o,h){c.emplaceBack(o.x,o.y,h),c.emplaceBack(o.x,o.y,h),c.emplaceBack(o.x,o.y,h),c.emplaceBack(o.x,o.y,h)}function ZM(c){for(const o of c.sections)if(Qu(o.text))return!0;return!1}class hm{constructor(o){this.layoutVertexArray=new Te,this.indexArray=new $e,this.programConfigurations=o,this.segments=new st,this.dynamicLayoutVertexArray=new Be,this.opacityVertexArray=new tt,this.placedSymbolArray=new d}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(o,h,g,T){this.isEmpty()||(g&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,gM.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,_M.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,qM,!0),this.opacityVertexBuffer.itemSize=1),(g||T)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ft("SymbolBuffers",hm);class fm{constructor(o,h,g){this.layoutVertexArray=new o,this.layoutAttributes=h,this.indexArray=new g,this.segments=new st,this.collisionVertexArray=new We}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,yM.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ft("CollisionBuffers",fm);class hh{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(k=>k.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=H3([]),this.placementViewportMatrix=H3([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=F7(this.zoom,h["text-size"]),this.iconSizeData=F7(this.zoom,h["icon-size"]);const g=this.layers[0].layout,T=g.get("symbol-sort-key"),C=g.get("symbol-z-order");this.canOverlap=dm(g,"text-overlap","text-allow-overlap")!=="never"||dm(g,"icon-overlap","icon-allow-overlap")!=="never"||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!T.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(k=>a.WritingMode[k])),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.sourceID=o.sourceID}createArrays(){this.text=new hm(new Rc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new hm(new Rc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new _,this.lineVertexArray=new x,this.symbolInstances=new m}calculateGlyphDependencies(o,h,g,T,C){for(let k=0;k<o.length;k++)if(h[o.charCodeAt(k)]=!0,(g||T)&&C){const B=X1[o.charAt(k)];B&&(h[B.charCodeAt(0)]=!0)}}populate(o,h,g){const T=this.layers[0],C=T.layout,k=C.get("text-font"),B=C.get("text-field"),F=C.get("icon-image"),j=(B.value.kind!=="constant"||B.value.value instanceof Ce&&!B.value.value.isEmpty()||B.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),Q=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,te=C.get("symbol-sort-key");if(this.features=[],!j&&!Q)return;const ae=h.iconDependencies,he=h.glyphDependencies,fe=h.availableImages,Le=new mi(this.zoom);for(const{feature:Pe,id:Ge,index:Ye,sourceLayerIndex:Fe}of o){const Ze=T._featureFilter.needGeometry,ct=Bc(Pe,Ze);if(!T._featureFilter.filter(Le,ct,g))continue;let lt,Nt;if(Ze||(ct.geometry=zc(Pe)),j){const Rt=T.getValueAndResolveTokens("text-field",ct,g,fe),Pt=Ce.factory(Rt);ZM(Pt)&&(this.hasRTLText=!0),(!this.hasRTLText||Tl()==="unavailable"||this.hasRTLText&&Zr.isParsed())&&(lt=xM(Pt,T,ct))}if(Q){const Rt=T.getValueAndResolveTokens("icon-image",ct,g,fe);Nt=Rt instanceof Me?Rt:Me.fromString(Rt)}if(!lt&&!Nt)continue;const jt=this.sortFeaturesByKey?te.evaluate(ct,{},g):void 0;if(this.features.push({id:Ge,text:lt,icon:Nt,index:Ye,sourceLayerIndex:Fe,geometry:ct.geometry,properties:Pe.properties,type:$M[Pe.type],sortKey:jt}),Nt&&(ae[Nt.name]=!0),lt){const Rt=k.evaluate(ct,{},g).join(","),Pt=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.WritingMode.vertical)>=0;for(const Tt of lt.sections)if(Tt.image)ae[Tt.image.name]=!0;else{const zt=E0(lt.toString()),kt=Tt.fontStack||Rt,_t=he[kt]=he[kt]||{};this.calculateGlyphDependencies(Tt.text,_t,Pt,this.allowVerticalPlacement,zt)}}}C.get("symbol-placement")==="line"&&(this.features=function(Pe){const Ge={},Ye={},Fe=[];let Ze=0;function ct(Rt){Fe.push(Pe[Rt]),Ze++}function lt(Rt,Pt,Tt){const zt=Ye[Rt];return delete Ye[Rt],Ye[Pt]=zt,Fe[zt].geometry[0].pop(),Fe[zt].geometry[0]=Fe[zt].geometry[0].concat(Tt[0]),zt}function Nt(Rt,Pt,Tt){const zt=Ge[Pt];return delete Ge[Pt],Ge[Rt]=zt,Fe[zt].geometry[0].shift(),Fe[zt].geometry[0]=Tt[0].concat(Fe[zt].geometry[0]),zt}function jt(Rt,Pt,Tt){const zt=Tt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${Rt}:${zt.x}:${zt.y}`}for(let Rt=0;Rt<Pe.length;Rt++){const Pt=Pe[Rt],Tt=Pt.geometry,zt=Pt.text?Pt.text.toString():null;if(!zt){ct(Rt);continue}const kt=jt(zt,Tt),_t=jt(zt,Tt,!0);if(kt in Ye&&_t in Ge&&Ye[kt]!==Ge[_t]){const rn=Nt(kt,_t,Tt),qt=lt(kt,_t,Fe[rn].geometry);delete Ge[kt],delete Ye[_t],Ye[jt(zt,Fe[qt].geometry,!0)]=qt,Fe[rn].geometry=null}else kt in Ye?lt(kt,_t,Tt):_t in Ge?Nt(kt,_t,Tt):(ct(Rt),Ge[kt]=Ze-1,Ye[_t]=Ze-1)}return Fe.filter(Rt=>Rt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Pe,Ge)=>Pe.sortKey-Ge.sortKey)}update(o,h,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,h,this.layers,g),this.icon.programConfigurations.updatePaintArrays(o,h,this.layers,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,h){const g=this.lineVertexArray.length;if(o.segment!==void 0){let T=o.dist(h[o.segment+1]),C=o.dist(h[o.segment]);const k={};for(let B=o.segment+1;B<h.length;B++)k[B]={x:h[B].x,y:h[B].y,tileUnitDistanceFromAnchor:T},B<h.length-1&&(T+=h[B+1].dist(h[B]));for(let B=o.segment||0;B>=0;B--)k[B]={x:h[B].x,y:h[B].y,tileUnitDistanceFromAnchor:C},B>0&&(C+=h[B-1].dist(h[B]));for(let B=0;B<h.length;B++){const F=k[B];this.lineVertexArray.emplaceBack(F.x,F.y,F.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(o,h,g,T,C,k,B,F,j,Q,te,ae){const he=o.indexArray,fe=o.layoutVertexArray,Le=o.segments.prepareSegment(4*h.length,fe,he,this.canOverlap?k.sortKey:void 0),Pe=this.glyphOffsetArray.length,Ge=Le.vertexLength,Ye=this.allowVerticalPlacement&&B===a.WritingMode.vertical?Math.PI/2:0,Fe=k.text&&k.text.sections;for(let Ze=0;Ze<h.length;Ze++){const{tl:ct,tr:lt,bl:Nt,br:jt,tex:Rt,pixelOffsetTL:Pt,pixelOffsetBR:Tt,minFontScaleX:zt,minFontScaleY:kt,glyphOffset:_t,isSDF:rn,sectionIndex:qt}=h[Ze],kn=Le.vertexLength,yi=_t[1];dA(fe,F.x,F.y,ct.x,yi+ct.y,Rt.x,Rt.y,g,rn,Pt.x,Pt.y,zt,kt),dA(fe,F.x,F.y,lt.x,yi+lt.y,Rt.x+Rt.w,Rt.y,g,rn,Tt.x,Pt.y,zt,kt),dA(fe,F.x,F.y,Nt.x,yi+Nt.y,Rt.x,Rt.y+Rt.h,g,rn,Pt.x,Tt.y,zt,kt),dA(fe,F.x,F.y,jt.x,yi+jt.y,Rt.x+Rt.w,Rt.y+Rt.h,g,rn,Tt.x,Tt.y,zt,kt),um(o.dynamicLayoutVertexArray,F,Ye),he.emplaceBack(kn,kn+1,kn+2),he.emplaceBack(kn+1,kn+2,kn+3),Le.vertexLength+=4,Le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_t[0]),Ze!==h.length-1&&qt===h[Ze+1].sectionIndex||o.programConfigurations.populatePaintArrays(fe.length,k,k.index,{},ae,Fe&&Fe[qt])}o.placedSymbolArray.emplaceBack(F.x,F.y,Pe,this.glyphOffsetArray.length-Pe,Ge,j,Q,F.segment,g?g[0]:0,g?g[1]:0,T[0],T[1],B,0,!1,0,te)}_addCollisionDebugVertex(o,h,g,T,C,k){return h.emplaceBack(0,0),o.emplaceBack(g.x,g.y,T,C,Math.round(k.x),Math.round(k.y))}addCollisionDebugVertices(o,h,g,T,C,k,B){const F=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),j=F.vertexLength,Q=C.layoutVertexArray,te=C.collisionVertexArray,ae=B.anchorX,he=B.anchorY;this._addCollisionDebugVertex(Q,te,k,ae,he,new Ot(o,h)),this._addCollisionDebugVertex(Q,te,k,ae,he,new Ot(g,h)),this._addCollisionDebugVertex(Q,te,k,ae,he,new Ot(g,T)),this._addCollisionDebugVertex(Q,te,k,ae,he,new Ot(o,T)),F.vertexLength+=4;const fe=C.indexArray;fe.emplaceBack(j,j+1),fe.emplaceBack(j+1,j+2),fe.emplaceBack(j+2,j+3),fe.emplaceBack(j+3,j),F.primitiveLength+=4}addDebugCollisionBoxes(o,h,g,T){for(let C=o;C<h;C++){const k=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(k.x1,k.y1,k.x2,k.y2,T?this.textCollisionBox:this.iconCollisionBox,k.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fm(Ke,E7.members,Oe),this.iconCollisionBox=new fm(Ke,E7.members,Oe);for(let o=0;o<this.symbolInstances.length;o++){const h=this.symbolInstances.get(o);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(o,h,g,T,C,k,B,F,j){const Q={};for(let te=h;te<g;te++){const ae=o.get(te);Q.textBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},Q.textFeatureIndex=ae.featureIndex;break}for(let te=T;te<C;te++){const ae=o.get(te);Q.verticalTextBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},Q.verticalTextFeatureIndex=ae.featureIndex;break}for(let te=k;te<B;te++){const ae=o.get(te);Q.iconBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},Q.iconFeatureIndex=ae.featureIndex;break}for(let te=F;te<j;te++){const ae=o.get(te);Q.verticalIconBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},Q.verticalIconFeatureIndex=ae.featureIndex;break}return Q}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const g=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,h){const g=o.placedSymbolArray.get(h),T=g.vertexStartIndex+4*g.numGlyphs;for(let C=g.vertexStartIndex;C<T;C+=4)o.indexArray.emplaceBack(C,C+1,C+2),o.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(o),g=Math.cos(o),T=[],C=[],k=[];for(let B=0;B<this.symbolInstances.length;++B){k.push(B);const F=this.symbolInstances.get(B);T.push(0|Math.round(h*F.anchorX+g*F.anchorY)),C.push(F.featureIndex)}return k.sort((B,F)=>T[B]-T[F]||C[F]-C[B]),k}addToSortKeyRanges(o,h){const g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===h?g.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const g=this.symbolInstances.get(h);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((T,C,k)=>{T>=0&&k.indexOf(T)===C&&this.addIndicesForPlacedSymbol(this.text,T)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ft("SymbolBucket",hh,{omit:["layers","collisionBoxArray","features","compareText"]}),hh.MAX_GLYPHS=65535,hh.addDynamicAttributes=um;const XM=new tr({"symbol-placement":new Wt(nt.layout_symbol["symbol-placement"]),"symbol-spacing":new Wt(nt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Wt(nt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new en(nt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Wt(nt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Wt(nt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Wt(nt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Wt(nt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Wt(nt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Wt(nt.layout_symbol["icon-rotation-alignment"]),"icon-size":new en(nt.layout_symbol["icon-size"]),"icon-text-fit":new Wt(nt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Wt(nt.layout_symbol["icon-text-fit-padding"]),"icon-image":new en(nt.layout_symbol["icon-image"]),"icon-rotate":new en(nt.layout_symbol["icon-rotate"]),"icon-padding":new en(nt.layout_symbol["icon-padding"]),"icon-keep-upright":new Wt(nt.layout_symbol["icon-keep-upright"]),"icon-offset":new en(nt.layout_symbol["icon-offset"]),"icon-anchor":new en(nt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Wt(nt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Wt(nt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Wt(nt.layout_symbol["text-rotation-alignment"]),"text-field":new en(nt.layout_symbol["text-field"]),"text-font":new en(nt.layout_symbol["text-font"]),"text-size":new en(nt.layout_symbol["text-size"]),"text-max-width":new en(nt.layout_symbol["text-max-width"]),"text-line-height":new Wt(nt.layout_symbol["text-line-height"]),"text-letter-spacing":new en(nt.layout_symbol["text-letter-spacing"]),"text-justify":new en(nt.layout_symbol["text-justify"]),"text-radial-offset":new en(nt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Wt(nt.layout_symbol["text-variable-anchor"]),"text-anchor":new en(nt.layout_symbol["text-anchor"]),"text-max-angle":new Wt(nt.layout_symbol["text-max-angle"]),"text-writing-mode":new Wt(nt.layout_symbol["text-writing-mode"]),"text-rotate":new en(nt.layout_symbol["text-rotate"]),"text-padding":new Wt(nt.layout_symbol["text-padding"]),"text-keep-upright":new Wt(nt.layout_symbol["text-keep-upright"]),"text-transform":new en(nt.layout_symbol["text-transform"]),"text-offset":new en(nt.layout_symbol["text-offset"]),"text-allow-overlap":new Wt(nt.layout_symbol["text-allow-overlap"]),"text-overlap":new Wt(nt.layout_symbol["text-overlap"]),"text-ignore-placement":new Wt(nt.layout_symbol["text-ignore-placement"]),"text-optional":new Wt(nt.layout_symbol["text-optional"])});var Am={paint:new tr({"icon-opacity":new en(nt.paint_symbol["icon-opacity"]),"icon-color":new en(nt.paint_symbol["icon-color"]),"icon-halo-color":new en(nt.paint_symbol["icon-halo-color"]),"icon-halo-width":new en(nt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new en(nt.paint_symbol["icon-halo-blur"]),"icon-translate":new Wt(nt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Wt(nt.paint_symbol["icon-translate-anchor"]),"text-opacity":new en(nt.paint_symbol["text-opacity"]),"text-color":new en(nt.paint_symbol["text-color"],{runtimeType:Ii,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new en(nt.paint_symbol["text-halo-color"]),"text-halo-width":new en(nt.paint_symbol["text-halo-width"]),"text-halo-blur":new en(nt.paint_symbol["text-halo-blur"]),"text-translate":new Wt(nt.paint_symbol["text-translate"]),"text-translate-anchor":new Wt(nt.paint_symbol["text-translate-anchor"])}),layout:XM};class Q7{constructor(o){if(o.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=o.property.overrides?o.property.overrides.runtimeType:us,this.defaultValue=o}evaluate(o){if(o.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(o.formattedSection))return h.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft("FormatSectionOverride",Q7,{omit:["defaultValue"]});class pA extends ms{constructor(o){super(o,Am)}recalculate(o,h){if(super.recalculate(o,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const g=this.layout.get("text-writing-mode");if(g){const T=[];for(const C of g)T.indexOf(C)<0&&T.push(C);this.layout._values["text-writing-mode"]=T}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(o,h,g,T){const C=this.layout.get(o).evaluate(h,{},g,T),k=this._unevaluatedLayout._values[o];return k.isDataDriven()||ml(k.value)||!C?C:function(B,F){return F.replace(/{([^{}]+)}/g,(j,Q)=>Q in B?String(B[Q]):"")}(h.properties,C)}createBucket(o){return new hh(o)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const o of Am.paint.overridableProperties){if(!pA.hasPaintOverride(this.layout,o))continue;const h=this.paint.get(o),g=new Q7(h),T=new pl(g,h.property.specification);let C=null;C=h.value.kind==="constant"||h.value.kind==="source"?new Xo("source",T):new gl("composite",T,h.value.zoomStops),this.paint._values[o]=new si(h.property,C,h.parameters)}}_handleOverridablePaintPropertyUpdate(o,h,g){return!(!this.layout||h.isDataDriven()||g.isDataDriven())&&pA.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,h){const g=o.get("text-field"),T=Am.paint.properties[h];let C=!1;const k=B=>{for(const F of B)if(T.overrides&&T.overrides.hasOverride(F))return void(C=!0)};if(g.value.kind==="constant"&&g.value.value instanceof Ce)k(g.value.value.sections);else if(g.value.kind==="source"){const B=j=>{C||(j instanceof Lt&&Ve(j.value)===zi?k(j.value.sections):j instanceof _0?k(j.sections):j.eachChild(B))},F=g.value;F._styleExpression&&B(F._styleExpression.expression)}return C}}function dm(c,o,h){let g="never";const T=c.get(o);return T?g=T:c.get(h)&&(g="always"),g}var QM={paint:new tr({"background-color":new Wt(nt.paint_background["background-color"]),"background-pattern":new kc(nt.paint_background["background-pattern"]),"background-opacity":new Wt(nt.paint_background["background-opacity"])})},YM={paint:new tr({"raster-opacity":new Wt(nt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Wt(nt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Wt(nt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Wt(nt.paint_raster["raster-brightness-max"]),"raster-saturation":new Wt(nt.paint_raster["raster-saturation"]),"raster-contrast":new Wt(nt.paint_raster["raster-contrast"]),"raster-resampling":new Wt(nt.paint_raster["raster-resampling"]),"raster-fade-duration":new Wt(nt.paint_raster["raster-fade-duration"])})};class KM extends ms{constructor(o){super(o,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=o}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const JM={circle:class extends ms{constructor(c){super(c,IP)}createBucket(c){return new V3(c)}queryRadius(c){const o=c;return U1("circle-radius",this,o)+U1("circle-stroke-width",this,o)+K2(this.paint.get("circle-translate"))}queryIntersectsFeature(c,o,h,g,T,C,k,B){const F=J2(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),C.angle,k),j=this.paint.get("circle-radius").evaluate(o,h)+this.paint.get("circle-stroke-width").evaluate(o,h),Q=this.paint.get("circle-pitch-alignment")==="map",te=Q?F:function(he,fe){return he.map(Le=>a7(Le,fe))}(F,B),ae=Q?j*k:j;for(const he of g)for(const fe of he){const Le=Q?fe:a7(fe,B);let Pe=ae;const Ge=eA([],[fe.x,fe.y,0,1],B);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Pe*=Ge[3]/C.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Pe*=C.cameraToCenterDistance/Ge[3]),TP(te,Le,Pe))return!0}return!1}},heatmap:class extends ms{constructor(c){super(c,LP),this._updateColorRamp()}createBucket(c){return new l7(c)}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=u7({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends ms{constructor(c){super(c,DP)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends ms{constructor(c){super(c,XP)}recalculate(c,o){super.recalculate(c,o);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new J3(c)}queryRadius(){return K2(this.paint.get("fill-translate"))}queryIntersectsFeature(c,o,h,g,T,C,k){return J8(J2(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),C.angle,k),g)}isTileClipped(){return!0}},"fill-extrusion":class extends ms{constructor(c){super(c,cM)}createBucket(c){return new tm(c)}queryRadius(){return K2(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(c,o,h,g,T,C,k,B){const F=J2(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),C.angle,k),j=this.paint.get("fill-extrusion-height").evaluate(o,h),Q=this.paint.get("fill-extrusion-base").evaluate(o,h),te=function(he,fe,Le,Pe){const Ge=[];for(const Ye of he){const Fe=[Ye.x,Ye.y,0,1];eA(Fe,Fe,fe),Ge.push(new Ot(Fe[0]/Fe[3],Fe[1]/Fe[3]))}return Ge}(F,B),ae=function(he,fe,Le,Pe){const Ge=[],Ye=[],Fe=Pe[8]*fe,Ze=Pe[9]*fe,ct=Pe[10]*fe,lt=Pe[11]*fe,Nt=Pe[8]*Le,jt=Pe[9]*Le,Rt=Pe[10]*Le,Pt=Pe[11]*Le;for(const Tt of he){const zt=[],kt=[];for(const _t of Tt){const rn=_t.x,qt=_t.y,kn=Pe[0]*rn+Pe[4]*qt+Pe[12],yi=Pe[1]*rn+Pe[5]*qt+Pe[13],xi=Pe[2]*rn+Pe[6]*qt+Pe[14],ir=Pe[3]*rn+Pe[7]*qt+Pe[15],no=xi+ct,Er=ir+lt,Zi=kn+Nt,lr=yi+jt,Tr=xi+Rt,Br=ir+Pt,gs=new Ot((kn+Fe)/Er,(yi+Ze)/Er);gs.z=no/Er,zt.push(gs);const Xi=new Ot(Zi/Br,lr/Br);Xi.z=Tr/Br,kt.push(Xi)}Ge.push(zt),Ye.push(kt)}return[Ge,Ye]}(g,Q,j,B);return function(he,fe,Le){let Pe=1/0;J8(Le,fe)&&(Pe=y7(Le,fe[0]));for(let Ge=0;Ge<fe.length;Ge++){const Ye=fe[Ge],Fe=he[Ge];for(let Ze=0;Ze<Ye.length-1;Ze++){const ct=Ye[Ze],lt=[ct,Ye[Ze+1],Fe[Ze+1],Fe[Ze],ct];K8(Le,lt)&&(Pe=Math.min(Pe,y7(Le,lt)))}}return Pe!==1/0&&Pe}(ae[0],ae[1],te)}},line:class extends ms{constructor(c){super(c,x7),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){c==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof _i,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,o){super.recalculate(c,o),this.paint._values["line-floorwidth"]=w7.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new nm(c)}queryRadius(c){const o=c,h=b7(U1("line-width",this,o),U1("line-gap-width",this,o)),g=U1("line-offset",this,o);return h/2+Math.abs(g)+K2(this.paint.get("line-translate"))}queryIntersectsFeature(c,o,h,g,T,C,k){const B=J2(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),C.angle,k),F=k/2*b7(this.paint.get("line-width").evaluate(o,h),this.paint.get("line-gap-width").evaluate(o,h)),j=this.paint.get("line-offset").evaluate(o,h);return j&&(g=function(Q,te){const ae=[];for(let he=0;he<Q.length;he++){const fe=Q[he],Le=[];for(let Pe=0;Pe<fe.length;Pe++){const Ge=fe[Pe-1],Ye=fe[Pe],Fe=fe[Pe+1],Ze=Pe===0?new Ot(0,0):Ye.sub(Ge)._unit()._perp(),ct=Pe===fe.length-1?new Ot(0,0):Fe.sub(Ye)._unit()._perp(),lt=Ze._add(ct)._unit(),Nt=lt.x*ct.x+lt.y*ct.y;Nt!==0&&lt._mult(1/Nt),Le.push(lt._mult(te)._add(Ye))}ae.push(Le)}return ae}(g,j*k)),function(Q,te,ae){for(let he=0;he<te.length;he++){const fe=te[he];if(Q.length>=3){for(let Le=0;Le<fe.length;Le++)if(rh(Q,fe[Le]))return!0}if(SP(Q,fe,ae))return!0}return!1}(B,g,F)}isTileClipped(){return!0}},symbol:pA,background:class extends ms{constructor(c){super(c,QM)}},raster:class extends ms{constructor(c){super(c,YM)}}};class eI{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Y7=63710088e-1;class Oi{constructor(o,h){if(isNaN(o)||isNaN(h))throw new Error(`Invalid LngLat object: (${o}, ${h})`);if(this.lng=+o,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Oi(U(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const h=Math.PI/180,g=this.lat*h,T=o.lat*h,C=Math.sin(g)*Math.sin(T)+Math.cos(g)*Math.cos(T)*Math.cos((o.lng-this.lng)*h);return Y7*Math.acos(Math.min(C,1))}toBounds(o=0){const h=360*o/40075017,g=h/Math.cos(Math.PI/180*this.lat);return new Fc(new Oi(this.lng-g,this.lat-h),new Oi(this.lng+g,this.lat+h))}static convert(o){if(o instanceof Oi)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new Oi(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new Oi(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Fc{constructor(o,h){o&&(h?this.setSouthWest(o).setNorthEast(h):o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof Oi?new Oi(o.lng,o.lat):Oi.convert(o),this}setSouthWest(o){return this._sw=o instanceof Oi?new Oi(o.lng,o.lat):Oi.convert(o),this}extend(o){const h=this._sw,g=this._ne;let T,C;if(o instanceof Oi)T=o,C=o;else{if(!(o instanceof Fc))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Fc.convert(o)):this.extend(Oi.convert(o)):this;if(T=o._sw,C=o._ne,!T||!C)return this}return h||g?(h.lng=Math.min(T.lng,h.lng),h.lat=Math.min(T.lat,h.lat),g.lng=Math.max(C.lng,g.lng),g.lat=Math.max(C.lat,g.lat)):(this._sw=new Oi(T.lng,T.lat),this._ne=new Oi(C.lng,C.lat)),this}getCenter(){return new Oi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Oi(this.getWest(),this.getNorth())}getSouthEast(){return new Oi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:h,lat:g}=Oi.convert(o);let T=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(T=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&T}static convert(o){return o instanceof Fc?o:o&&new Fc(o)}}const K7=2*Math.PI*Y7;function J7(c){return K7*Math.cos(c*Math.PI/180)}function e9(c){return(180+c)/360}function t9(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function n9(c,o){return c/J7(o)}function pm(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class mA{constructor(o,h,g=0){this.x=+o,this.y=+h,this.z=+g}static fromLngLat(o,h=0){const g=Oi.convert(o);return new mA(e9(g.lng),t9(g.lat),n9(h,g.lat))}toLngLat(){return new Oi(360*this.x-180,pm(this.y))}toAltitude(){return this.z*J7(pm(this.y))}meterInMercatorCoordinateUnits(){return 1/K7*(o=pm(this.y),1/Math.cos(o*Math.PI/180));var o}}function i9(c,o,h){var g=2*Math.PI*6378137/256/Math.pow(2,h);return[c*g-2*Math.PI*6378137/2,o*g-2*Math.PI*6378137/2]}class mm{constructor(o,h,g){if(o<0||o>25||g<0||g>=Math.pow(2,o)||h<0||h>=Math.pow(2,o))throw new Error(`x=${h}, y=${g}, z=${o} outside of bounds. 0<=x<${Math.pow(2,o)}, 0<=y<${Math.pow(2,o)} 0<=z<=25 `);this.z=o,this.x=h,this.y=g,this.key=Y1(0,o,o,h,g)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,h,g){const T=(k=this.y,B=this.z,F=i9(256*(C=this.x),256*(k=Math.pow(2,B)-k-1),B),j=i9(256*(C+1),256*(k+1),B),F[0]+","+F[1]+","+j[0]+","+j[1]);var C,k,B,F,j;const Q=function(te,ae,he){let fe,Le="";for(let Pe=te;Pe>0;Pe--)fe=1<<Pe-1,Le+=(ae&fe?1:0)+(he&fe?2:0);return Le}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(g==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,Q).replace(/{bbox-epsg-3857}/g,T)}isChildOf(o){const h=this.z-o.z;return h>0&&o.x===this.x>>h&&o.y===this.y>>h}getTilePoint(o){const h=Math.pow(2,this.z);return new Ot((o.x*h-this.x)*nr,(o.y*h-this.y)*nr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class r9{constructor(o,h){this.wrap=o,this.canonical=h,this.key=Y1(o,h.z,h.z,h.x,h.y)}}class to{constructor(o,h,g,T,C){if(o<g)throw new Error(`overscaledZ should be >= z; overscaledZ = ${o}; z = ${g}`);this.overscaledZ=o,this.wrap=h,this.canonical=new mm(g,+T,+C),this.key=Y1(h,o,g,T,C)}clone(){return new to(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-o;return o>this.canonical.z?new to(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new to(o,this.wrap,o,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(o,h){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-o;return o>this.canonical.z?Y1(this.wrap*+h,o,this.canonical.z,this.canonical.x,this.canonical.y):Y1(this.wrap*+h,o,o,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(o){if(o.wrap!==this.wrap)return!1;const h=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>h&&o.canonical.y===this.canonical.y>>h}children(o){if(this.overscaledZ>=o)return[new to(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,g=2*this.canonical.x,T=2*this.canonical.y;return[new to(h,this.wrap,h,g,T),new to(h,this.wrap,h,g+1,T),new to(h,this.wrap,h,g,T+1),new to(h,this.wrap,h,g+1,T+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new to(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new to(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new r9(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(o){return this.canonical.getTilePoint(new mA(o.x-this.wrap,o.y))}}function Y1(c,o,h,g,T){(c*=2)<0&&(c=-1*c-1);const C=1<<h;return(C*C*c+C*T+g).toString(36)+h.toString(36)+o.toString(36)}Ft("CanonicalTileID",mm),Ft("OverscaledTileID",to,{omit:["posMatrix"]});class s9{constructor(o,h,g){if(this.uid=o,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(g&&g!=="mapbox"&&g!=="terrarium")return void be(`"${g}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=h.height;const T=this.dim=h.height-2;this.data=new Uint32Array(h.data.buffer),this.encoding=g||"mapbox";for(let C=0;C<T;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(T,C)]=this.data[this._idx(T-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,T)]=this.data[this._idx(C,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<T;C++)for(let k=0;k<T;k++){const B=this.get(C,k);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(o,h){const g=new Uint8Array(this.data.buffer),T=4*this._idx(o,h);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(g[T],g[T+1],g[T+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(o,h){if(o<-1||o>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(o+1)}_unpackMapbox(o,h,g){return(256*o*256+256*h+g)/10-1e4}_unpackTerrarium(o,h,g){return 256*o+h+g/256-32768}getPixels(){return new eo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(o,h,g){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let T=h*this.dim,C=h*this.dim+this.dim,k=g*this.dim,B=g*this.dim+this.dim;switch(h){case-1:T=C-1;break;case 1:C=T+1}switch(g){case-1:k=B-1;break;case 1:B=k+1}const F=-h*this.dim,j=-g*this.dim;for(let Q=k;Q<B;Q++)for(let te=T;te<C;te++)this.data[this._idx(te,Q)]=o.data[this._idx(te+F,Q+j)]}}Ft("DEMData",s9);class o9{constructor(o){this._stringToNumber={},this._numberToString=[];for(let h=0;h<o.length;h++){const g=o[h];this._stringToNumber[g]=h,this._numberToString[h]=g}}encode(o){return this._stringToNumber[o]}decode(o){if(o>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${o} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[o]}}class a9{constructor(o,h,g,T,C){this.type="Feature",this._vectorTileFeature=o,o._z=h,o._x=g,o._y=T,this.properties=o.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(o[h]=this[h]);return o}}class l9{constructor(o,h){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Oa(nr,16,0),this.grid3D=new Oa(nr,16,0),this.featureIndexArray=new M,this.promoteId=h}insert(o,h,g,T,C,k){const B=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,T,C);const F=k?this.grid3D:this.grid;for(let j=0;j<h.length;j++){const Q=h[j],te=[1/0,1/0,-1/0,-1/0];for(let ae=0;ae<Q.length;ae++){const he=Q[ae];te[0]=Math.min(te[0],he.x),te[1]=Math.min(te[1],he.y),te[2]=Math.max(te[2],he.x),te[3]=Math.max(te[3],he.y)}te[0]<nr&&te[1]<nr&&te[2]>=0&&te[3]>=0&&F.insert(B,te[0],te[1],te[2],te[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new P0.VectorTile(new im(this.rawTileData)).layers,this.sourceLayerCoder=new o9(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(o,h,g,T){this.loadVTLayers();const C=o.params||{},k=nr/o.tileSize/o.scale,B=Ls(C.filter),F=o.queryGeometry,j=o.queryPadding*k,Q=u9(F),te=this.grid.query(Q.minX-j,Q.minY-j,Q.maxX+j,Q.maxY+j),ae=u9(o.cameraQueryGeometry),he=this.grid3D.query(ae.minX-j,ae.minY-j,ae.maxX+j,ae.maxY+j,(Pe,Ge,Ye,Fe)=>function(Ze,ct,lt,Nt,jt){for(const Pt of Ze)if(ct<=Pt.x&&lt<=Pt.y&&Nt>=Pt.x&&jt>=Pt.y)return!0;const Rt=[new Ot(ct,lt),new Ot(ct,jt),new Ot(Nt,jt),new Ot(Nt,lt)];if(Ze.length>2){for(const Pt of Rt)if(rh(Ze,Pt))return!0}for(let Pt=0;Pt<Ze.length-1;Pt++)if(PP(Ze[Pt],Ze[Pt+1],Rt))return!0;return!1}(o.cameraQueryGeometry,Pe-j,Ge-j,Ye+j,Fe+j));for(const Pe of he)te.push(Pe);te.sort(tI);const fe={};let Le;for(let Pe=0;Pe<te.length;Pe++){const Ge=te[Pe];if(Ge===Le)continue;Le=Ge;const Ye=this.featureIndexArray.get(Ge);let Fe=null;this.loadMatchingFeature(fe,Ye.bucketIndex,Ye.sourceLayerIndex,Ye.featureIndex,B,C.layers,C.availableImages,h,g,T,(Ze,ct,lt)=>(Fe||(Fe=zc(Ze)),ct.queryIntersectsFeature(F,Ze,lt,Fe,this.z,o.transform,k,o.pixelPosMatrix)))}return fe}loadMatchingFeature(o,h,g,T,C,k,B,F,j,Q,te){const ae=this.bucketLayerIDs[h];if(k&&!function(Pe,Ge){for(let Ye=0;Ye<Pe.length;Ye++)if(Ge.indexOf(Pe[Ye])>=0)return!0;return!1}(k,ae))return;const he=this.sourceLayerCoder.decode(g),fe=this.vtLayers[he].feature(T);if(C.needGeometry){const Pe=Bc(fe,!0);if(!C.filter(new mi(this.tileID.overscaledZ),Pe,this.tileID.canonical))return}else if(!C.filter(new mi(this.tileID.overscaledZ),fe))return;const Le=this.getId(fe,he);for(let Pe=0;Pe<ae.length;Pe++){const Ge=ae[Pe];if(k&&k.indexOf(Ge)<0)continue;const Ye=F[Ge];if(!Ye)continue;let Fe={};Le&&Q&&(Fe=Q.getState(Ye.sourceLayer||"_geojsonTileLayer",Le));const Ze=q({},j[Ge]);Ze.paint=c9(Ze.paint,Ye.paint,fe,Fe,B),Ze.layout=c9(Ze.layout,Ye.layout,fe,Fe,B);const ct=!te||te(fe,Ye,Fe);if(!ct)continue;const lt=new a9(fe,this.z,this.x,this.y,Le);lt.layer=Ze;let Nt=o[Ge];Nt===void 0&&(Nt=o[Ge]=[]),Nt.push({featureIndex:T,feature:lt,intersectionZ:ct})}}lookupSymbolFeatures(o,h,g,T,C,k,B,F){const j={};this.loadVTLayers();const Q=Ls(C);for(const te of o)this.loadMatchingFeature(j,g,T,te,Q,k,B,F,h);return j}hasLayer(o){for(const h of this.bucketLayerIDs)for(const g of h)if(o===g)return!0;return!1}getId(o,h){let g=o.id;return this.promoteId&&(g=o.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof g=="boolean"&&(g=Number(g))),g}}function c9(c,o,h,g,T){return J(c,(C,k)=>{const B=o instanceof Cl?o.get(k):null;return B&&B.evaluate?B.evaluate(h,g,T):B})}function u9(c){let o=1/0,h=1/0,g=-1/0,T=-1/0;for(const C of c)o=Math.min(o,C.x),h=Math.min(h,C.y),g=Math.max(g,C.x),T=Math.max(T,C.y);return{minX:o,minY:h,maxX:g,maxY:T}}function tI(c,o){return o-c}var gm;Ft("FeatureIndex",l9,{omit:["rawTileData","sourceLayerCoder"]}),a.PerformanceMarkers=void 0,(gm=a.PerformanceMarkers||(a.PerformanceMarkers={})).create="create",gm.load="load",gm.fullLoad="fullLoad";let gA=null,K1=[];const _m=1e3/30,nI={mark(c){performance.mark(c)},frame(c){const o=c;gA!=null&&K1.push(o-gA),gA=o},clearMetrics(){gA=null,K1=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const c in a.PerformanceMarkers)performance.clearMarks(a.PerformanceMarkers[c])},getPerformanceMetrics(){performance.measure("loadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.load),performance.measure("fullLoadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.fullLoad);const c=performance.getEntriesByName("loadTime")[0].duration,o=performance.getEntriesByName("fullLoadTime")[0].duration,h=K1.length,g=1/(K1.reduce((C,k)=>C+k,0)/h/1e3),T=K1.filter(C=>C>_m).reduce((C,k)=>C+(k-_m)/_m,0);return{loadTime:c,fullLoadTime:o,fps:g,percentDroppedFrames:T/(h+T)*100}}};a.AJAXError=jn,a.ARRAY_TYPE=Qr,a.Actor=class{constructor(c,o,h){this.target=c,this.parent=o,this.mapId=h,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},pe(["receive","process"],this),this.invoker=new eI(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=et()?c:window}send(c,o,h,g,T=!1){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(this.callbacks[C]=h);const k=ut(this.globalScope)?void 0:[];return this.target.postMessage({id:C,type:c,hasCallback:!!h,targetMapId:g,mustQueue:T,sourceMapId:this.mapId,data:Ko(o,k)},k),{cancel:()=>{h&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(c){const o=c.data,h=o.id;if(h&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){delete this.tasks[h];const g=this.cancelCallbacks[h];delete this.cancelCallbacks[h],g&&g()}else et()||o.mustQueue?(this.tasks[h]=o,this.taskQueue.push(h),this.invoker.trigger()):this.processTask(h,o)}process(){if(!this.taskQueue.length)return;const c=this.taskQueue.shift(),o=this.tasks[c];delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(c,o)}processTask(c,o){if(o.type==="<response>"){const h=this.callbacks[c];delete this.callbacks[c],h&&(o.error?h(So(o.error)):h(null,So(o.data)))}else{let h=!1;const g=ut(this.globalScope)?void 0:[],T=o.hasCallback?(B,F)=>{h=!0,delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:B?Ko(B):null,data:Ko(F,g)},g)}:B=>{h=!0};let C=null;const k=So(o.data);if(this.parent[o.type])C=this.parent[o.type](o.sourceMapId,k,T);else if(this.parent.getWorkerSource){const B=o.type.split(".");C=this.parent.getWorkerSource(o.sourceMapId,B[0],k.source)[B[1]](k,T)}else T(new Error(`Could not find function ${o.type}`));!h&&C&&C.cancel&&(this.cancelCallbacks[c]=C.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.AlphaImage=G1,a.CanonicalTileID=mm,a.CollisionBoxArray=it,a.CollisionCircleLayoutArray=class extends K{},a.Color=f,a.DEMData=s9,a.DataConstantProperty=Wt,a.DictionaryCoder=o9,a.EXTENT=nr,a.ErrorEvent=vo,a.EvaluationParameters=mi,a.Event=Lr,a.Evented=$r,a.FeatureIndex=l9,a.FillBucket=J3,a.FillExtrusionBucket=tm,a.GeoJSONFeature=a9,a.ImageAtlas=L7,a.ImagePosition=sm,a.LineBucket=nm,a.LineStripIndexArray=class extends Se{},a.LngLat=Oi,a.LngLatBounds=Fc,a.MercatorCoordinate=mA,a.ONE_EM=mr,a.OverscaledTileID=to,a.PerformanceUtils=nI,a.PosArray=L,a.Properties=tr,a.QuadTriangleArray=class extends ce{},a.RGBAImage=eo,a.RasterBoundsArray=class extends b{},a.RequestPerformance=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},a.ResourceType=mt,a.SegmentVector=st,a.SymbolBucket=hh,a.Transitionable=Ju,a.TriangleIndexArray=$e,a.Uniform1f=Pl,a.Uniform1i=class extends Po{constructor(c,o){super(c,o),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},a.Uniform2f=class extends Po{constructor(c,o){super(c,o),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},a.Uniform3f=class extends Po{constructor(c,o){super(c,o),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},a.Uniform4f=nh,a.UniformColor=Z8,a.UniformMatrix4f=class extends Po{constructor(c,o){super(c,o),this.current=bP}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let o=1;o<16;o++)if(c[o]!==this.current[o]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},a.UnwrappedTileID=r9,a.ValidationError=wt,a.ZoomHistory=bc,a.add=function(c,o,h){return c[0]=o[0]+h[0],c[1]=o[1]+h[1],c[2]=o[2]+h[2],c},a.addDynamicAttributes=um,a.asyncAll=function(c,o,h){if(!c.length)return h(null,[]);let g=c.length;const T=new Array(c.length);let C=null;c.forEach((k,B)=>{o(k,(F,j)=>{F&&(C=F),T[B]=j,--g==0&&h(C,T)})})},a.bezier=I,a.bindAll=pe,a.cacheEntryPossiblyAdded=function(c){ti++,ti>pn&&(c.getActor().send("enforceCacheSizeLimit",bn),ti=0)},a.clamp=D,a.clearTileCache=function(c){const o=caches.delete(Bt);c&&o.catch(c).then(()=>c())},a.clipLine=H7,a.clone=function(c){var o=new Qr(16);return o[0]=c[0],o[1]=c[1],o[2]=c[2],o[3]=c[3],o[4]=c[4],o[5]=c[5],o[6]=c[6],o[7]=c[7],o[8]=c[8],o[9]=c[9],o[10]=c[10],o[11]=c[11],o[12]=c[12],o[13]=c[13],o[14]=c[14],o[15]=c[15],o},a.clone$1=re,a.clone$2=function(c){var o=new Qr(3);return o[0]=c[0],o[1]=c[1],o[2]=c[2],o},a.collisionCircleLayout=vM,a.config=vt,a.copy=function(c,o){return c[0]=o[0],c[1]=o[1],c[2]=o[2],c[3]=o[3],c[4]=o[4],c[5]=o[5],c[6]=o[6],c[7]=o[7],c[8]=o[8],c[9]=o[9],c[10]=o[10],c[11]=o[11],c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15],c},a.create=function(){var c=new Qr(16);return Qr!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},a.create$1=n7,a.createExpression=ka,a.createFilter=Ls,a.createLayout=Bi,a.createStyleLayer=function(c){return c.type==="custom"?new KM(c):new JM[c.type](c)},a.cross=function(c,o,h){var g=o[0],T=o[1],C=o[2],k=h[0],B=h[1],F=h[2];return c[0]=T*F-C*B,c[1]=C*k-g*F,c[2]=g*B-T*k,c},a.dot=function(c,o){return c[0]*o[0]+c[1]*o[1]+c[2]*o[2]},a.dot$1=function(c,o){return c[0]*o[0]+c[1]*o[1]+c[2]*o[2]+c[3]*o[3]},a.ease=R,a.emitValidationErrors=Ba,a.enforceCacheSizeLimit=function(c){Nn(),Qt&&Qt.then(o=>{o.keys().then(h=>{for(let g=0;g<h.length-c;g++)o.delete(h[g])})})},a.equals=function(c,o){var h=c[0],g=c[1],T=c[2],C=c[3],k=c[4],B=c[5],F=c[6],j=c[7],Q=c[8],te=c[9],ae=c[10],he=c[11],fe=c[12],Le=c[13],Pe=c[14],Ge=c[15],Ye=o[0],Fe=o[1],Ze=o[2],ct=o[3],lt=o[4],Nt=o[5],jt=o[6],Rt=o[7],Pt=o[8],Tt=o[9],zt=o[10],kt=o[11],_t=o[12],rn=o[13],qt=o[14],kn=o[15];return Math.abs(h-Ye)<=Xr*Math.max(1,Math.abs(h),Math.abs(Ye))&&Math.abs(g-Fe)<=Xr*Math.max(1,Math.abs(g),Math.abs(Fe))&&Math.abs(T-Ze)<=Xr*Math.max(1,Math.abs(T),Math.abs(Ze))&&Math.abs(C-ct)<=Xr*Math.max(1,Math.abs(C),Math.abs(ct))&&Math.abs(k-lt)<=Xr*Math.max(1,Math.abs(k),Math.abs(lt))&&Math.abs(B-Nt)<=Xr*Math.max(1,Math.abs(B),Math.abs(Nt))&&Math.abs(F-jt)<=Xr*Math.max(1,Math.abs(F),Math.abs(jt))&&Math.abs(j-Rt)<=Xr*Math.max(1,Math.abs(j),Math.abs(Rt))&&Math.abs(Q-Pt)<=Xr*Math.max(1,Math.abs(Q),Math.abs(Pt))&&Math.abs(te-Tt)<=Xr*Math.max(1,Math.abs(te),Math.abs(Tt))&&Math.abs(ae-zt)<=Xr*Math.max(1,Math.abs(ae),Math.abs(zt))&&Math.abs(he-kt)<=Xr*Math.max(1,Math.abs(he),Math.abs(kt))&&Math.abs(fe-_t)<=Xr*Math.max(1,Math.abs(fe),Math.abs(_t))&&Math.abs(Le-rn)<=Xr*Math.max(1,Math.abs(Le),Math.abs(rn))&&Math.abs(Pe-qt)<=Xr*Math.max(1,Math.abs(Pe),Math.abs(qt))&&Math.abs(Ge-kn)<=Xr*Math.max(1,Math.abs(Ge),Math.abs(kn))},a.evaluateSizeForFeature=function(c,{uSize:o,uSizeT:h},{lowerSize:g,upperSize:T}){return c.kind==="source"?g/kl:c.kind==="composite"?Tn(g/kl,T/kl,h):o},a.evaluateSizeForZoom=function(c,o){let h=0,g=0;if(c.kind==="constant")g=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:T,minZoom:C,maxZoom:k}=c,B=T?D(ui.interpolationFactor(T,o,C,k),0,1):0;c.kind==="camera"?g=Tn(c.minSize,c.maxSize,B):h=B}return{uSizeT:h,uSize:g}},a.evaluateVariableOffset=q7,a.evented=Mc,a.exported=Pn,a.exported$1=Ue,a.extend=q,a.filterObject=ie,a.fromRotation=function(c,o){var h=Math.sin(o),g=Math.cos(o);return c[0]=g,c[1]=h,c[2]=0,c[3]=-h,c[4]=g,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},a.fromScaling=function(c,o){return c[0]=o[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=o[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=o[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},a.getAnchorAlignment=am,a.getAnchorJustification=cm,a.getArrayBuffer=ci,a.getImage=Wr,a.getJSON=function(c,o){return ei(q(c,{type:"json"}),o)},a.getOverlapMode=dm,a.getRTLTextPluginStatus=Tl,a.getReferrer=Bn,a.getVideo=function(c,o){const h=window.document.createElement("video");h.muted=!0,h.onloadstart=function(){o(null,h)};for(let g=0;g<c.length;g++){const T=window.document.createElement("source");hr(c[g])||(h.crossOrigin="Anonymous"),T.src=c[g],h.appendChild(T)}return{cancel:()=>{}}},a.identity=H3,a.invert=function(c,o){var h=o[0],g=o[1],T=o[2],C=o[3],k=o[4],B=o[5],F=o[6],j=o[7],Q=o[8],te=o[9],ae=o[10],he=o[11],fe=o[12],Le=o[13],Pe=o[14],Ge=o[15],Ye=h*B-g*k,Fe=h*F-T*k,Ze=h*j-C*k,ct=g*F-T*B,lt=g*j-C*B,Nt=T*j-C*F,jt=Q*Le-te*fe,Rt=Q*Pe-ae*fe,Pt=Q*Ge-he*fe,Tt=te*Pe-ae*Le,zt=te*Ge-he*Le,kt=ae*Ge-he*Pe,_t=Ye*kt-Fe*zt+Ze*Tt+ct*Pt-lt*Rt+Nt*jt;return _t?(c[0]=(B*kt-F*zt+j*Tt)*(_t=1/_t),c[1]=(T*zt-g*kt-C*Tt)*_t,c[2]=(Le*Nt-Pe*lt+Ge*ct)*_t,c[3]=(ae*lt-te*Nt-he*ct)*_t,c[4]=(F*Pt-k*kt-j*Rt)*_t,c[5]=(h*kt-T*Pt+C*Rt)*_t,c[6]=(Pe*Ze-fe*Nt-Ge*Fe)*_t,c[7]=(Q*Nt-ae*Ze+he*Fe)*_t,c[8]=(k*zt-B*Pt+j*jt)*_t,c[9]=(g*Pt-h*zt-C*jt)*_t,c[10]=(fe*lt-Le*Ze+Ge*Ye)*_t,c[11]=(te*Ze-Q*lt-he*Ye)*_t,c[12]=(B*Rt-k*Tt-F*jt)*_t,c[13]=(h*Tt-g*Rt+T*jt)*_t,c[14]=(Le*Fe-fe*ct-Pe*Ye)*_t,c[15]=(Q*ct-te*Fe+ae*Ye)*_t,c):null},a.isImageBitmap=St,a.isSafari=ut,a.isWorker=et,a.keysDifference=function(c,o){const h=[];for(const g in c)g in o||h.push(g);return h},a.lazyLoadRTLTextPlugin=function(){Zr.isLoading()||Zr.isLoaded()||Tl()!=="deferred"||Ku()},a.makeRequest=ei,a.mapObject=J,a.mercatorXfromLng=e9,a.mercatorYfromLat=t9,a.mercatorZfromAltitude=n9,a.mul=kP,a.mul$1=function(c,o,h){return c[0]=o[0]*h[0],c[1]=o[1]*h[1],c[2]=o[2]*h[2],c[3]=o[3]*h[3],c},a.multiply=i7,a.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},a.normalize=function(c,o){var h=o[0],g=o[1],T=o[2],C=h*h+g*g+T*T;return C>0&&(C=1/Math.sqrt(C)),c[0]=o[0]*C,c[1]=o[1]*C,c[2]=o[2]*C,c},a.number=Tn,a.ortho=function(c,o,h,g,T,C,k){var B=1/(o-h),F=1/(g-T),j=1/(C-k);return c[0]=-2*B,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*F,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*j,c[11]=0,c[12]=(o+h)*B,c[13]=(T+g)*F,c[14]=(k+C)*j,c[15]=1,c},a.parseCacheControl=ht,a.parseGlyphPbf=function(c){return new im(c).readFields(kM,[])},a.pbf=im,a.performSymbolLayout=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=nr/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const o=c.bucket.layers[0].layout,h=c.bucket.layers[0]._unevaluatedLayout._values,g={layoutIconSize:h["icon-size"].possiblyEvaluate(new mi(c.bucket.zoom+1),c.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new mi(c.bucket.zoom+1),c.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new mi(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:j}=c.bucket.textSizeData;g.compositeTextSizes=[h["text-size"].possiblyEvaluate(new mi(F),c.canonical),h["text-size"].possiblyEvaluate(new mi(j),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:j}=c.bucket.iconSizeData;g.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new mi(F),c.canonical),h["icon-size"].possiblyEvaluate(new mi(j),c.canonical)]}const T=o.get("text-line-height")*mr,C=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",k=o.get("text-keep-upright"),B=o.get("text-size");for(const F of c.bucket.features){const j=o.get("text-font").evaluate(F,{},c.canonical).join(","),Q=B.evaluate(F,{},c.canonical),te=g.layoutTextSize.evaluate(F,{},c.canonical),ae=g.layoutIconSize.evaluate(F,{},c.canonical),he={horizontal:{},vertical:void 0},fe=F.text;let Le,Pe=[0,0];if(fe){const Fe=fe.toString(),Ze=o.get("text-letter-spacing").evaluate(F,{},c.canonical)*mr,ct=Xu(Fe)?Ze:0,lt=o.get("text-anchor").evaluate(F,{},c.canonical),Nt=o.get("text-variable-anchor");if(!Nt){const zt=o.get("text-radial-offset").evaluate(F,{},c.canonical);Pe=zt?q7(lt,[zt*mr,lm]):o.get("text-offset").evaluate(F,{},c.canonical).map(kt=>kt*mr)}let jt=C?"center":o.get("text-justify").evaluate(F,{},c.canonical);const Rt=o.get("symbol-placement"),Pt=Rt==="point"?o.get("text-max-width").evaluate(F,{},c.canonical)*mr:0,Tt=()=>{c.bucket.allowVerticalPlacement&&E0(Fe)&&(he.vertical=lA(fe,c.glyphMap,c.glyphPositions,c.imagePositions,j,Pt,T,lt,"left",ct,Pe,a.WritingMode.vertical,!0,Rt,te,Q))};if(!C&&Nt){const zt=jt==="auto"?Nt.map(_t=>cm(_t)):[jt];let kt=!1;for(let _t=0;_t<zt.length;_t++){const rn=zt[_t];if(!he.horizontal[rn])if(kt)he.horizontal[rn]=he.horizontal[0];else{const qt=lA(fe,c.glyphMap,c.glyphPositions,c.imagePositions,j,Pt,T,"center",rn,ct,Pe,a.WritingMode.horizontal,!1,Rt,te,Q);qt&&(he.horizontal[rn]=qt,kt=qt.positionedLines.length===1)}}Tt()}else{jt==="auto"&&(jt=cm(lt));const zt=lA(fe,c.glyphMap,c.glyphPositions,c.imagePositions,j,Pt,T,lt,jt,ct,Pe,a.WritingMode.horizontal,!1,Rt,te,Q);zt&&(he.horizontal[jt]=zt),Tt(),E0(Fe)&&C&&k&&(he.vertical=lA(fe,c.glyphMap,c.glyphPositions,c.imagePositions,j,Pt,T,lt,jt,ct,Pe,a.WritingMode.vertical,!1,Rt,te,Q))}}let Ge=!1;if(F.icon&&F.icon.name){const Fe=c.imageMap[F.icon.name];Fe&&(Le=OM(c.imagePositions[F.icon.name],o.get("icon-offset").evaluate(F,{},c.canonical),o.get("icon-anchor").evaluate(F,{},c.canonical)),Ge=!!Fe.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=Ge:c.bucket.sdfIcons!==Ge&&be("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Fe.pixelRatio!==c.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const Ye=X7(he.horizontal)||he.vertical;c.bucket.iconsInText=!!Ye&&Ye.iconsInText,(Ye||Le)&&HM(c.bucket,F,he,Le,c.imageMap,g,te,ae,Pe,Ge,c.canonical)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},a.perspective=function(c,o,h,g,T){var C,k=1/Math.tan(o/2);return c[0]=k/h,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=k,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,T!=null&&T!==1/0?(c[10]=(T+g)*(C=1/(g-T)),c[14]=2*T*g*C):(c[10]=-1,c[14]=-2*g),c},a.pick=function(c,o){const h={};for(let g=0;g<o.length;g++){const T=o[g];T in c&&(h[T]=c[T])}return h},a.plugin=Zr,a.pointGeometry=Ot,a.polygonIntersectsPolygon=K8,a.potpack=k7,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=Ft,a.registerForPluginStateChange=function(c){return c({pluginStatus:pr,pluginURL:Ys}),Mc.on("pluginStateChange",c),c},a.renderColorRamp=u7,a.rotateX=function(c,o,h){var g=Math.sin(h),T=Math.cos(h),C=o[4],k=o[5],B=o[6],F=o[7],j=o[8],Q=o[9],te=o[10],ae=o[11];return o!==c&&(c[0]=o[0],c[1]=o[1],c[2]=o[2],c[3]=o[3],c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15]),c[4]=C*T+j*g,c[5]=k*T+Q*g,c[6]=B*T+te*g,c[7]=F*T+ae*g,c[8]=j*T-C*g,c[9]=Q*T-k*g,c[10]=te*T-B*g,c[11]=ae*T-F*g,c},a.rotateZ=function(c,o,h){var g=Math.sin(h),T=Math.cos(h),C=o[0],k=o[1],B=o[2],F=o[3],j=o[4],Q=o[5],te=o[6],ae=o[7];return o!==c&&(c[8]=o[8],c[9]=o[9],c[10]=o[10],c[11]=o[11],c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15]),c[0]=C*T+j*g,c[1]=k*T+Q*g,c[2]=B*T+te*g,c[3]=F*T+ae*g,c[4]=j*T-C*g,c[5]=Q*T-k*g,c[6]=te*T-B*g,c[7]=ae*T-F*g,c},a.scale=function(c,o,h){var g=h[0],T=h[1],C=h[2];return c[0]=o[0]*g,c[1]=o[1]*g,c[2]=o[2]*g,c[3]=o[3]*g,c[4]=o[4]*T,c[5]=o[5]*T,c[6]=o[6]*T,c[7]=o[7]*T,c[8]=o[8]*C,c[9]=o[9]*C,c[10]=o[10]*C,c[11]=o[11]*C,c[12]=o[12],c[13]=o[13],c[14]=o[14],c[15]=o[15],c},a.scale$1=function(c,o,h){return c[0]=o[0]*h,c[1]=o[1]*h,c[2]=o[2]*h,c},a.setCacheLimits=function(c,o){bn=c,pn=o},a.setRTLTextPlugin=function(c,o,h=!1){if(pr===Sc||pr===Cc||pr===Pc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ys=Pn.resolveURL(c),pr=Sc,zs=o,Fa(),h||Ku()},a.spec=nt,a.sphericalToCartesian=function([c,o,h]){return o+=90,o*=Math.PI/180,h*=Math.PI/180,{x:c*Math.cos(o)*Math.sin(h),y:c*Math.sin(o)*Math.sin(h),z:c*Math.cos(h)}},a.sqrLen=function(c){var o=c[0],h=c[1];return o*o+h*h},a.sub=function(c,o,h){return c[0]=o[0]-h[0],c[1]=o[1]-h[1],c[2]=o[2]-h[2],c},a.toEvaluationFeature=Bc,a.transformMat3=function(c,o,h){var g=o[0],T=o[1],C=o[2];return c[0]=g*h[0]+T*h[3]+C*h[6],c[1]=g*h[1]+T*h[4]+C*h[7],c[2]=g*h[2]+T*h[5]+C*h[8],c},a.transformMat4=eA,a.transformMat4$1=function(c,o,h){var g=o[0],T=o[1];return c[0]=h[0]*g+h[4]*T+h[12],c[1]=h[1]*g+h[5]*T+h[13],c},a.translate=function(c,o,h){var g,T,C,k,B,F,j,Q,te,ae,he,fe,Le=h[0],Pe=h[1],Ge=h[2];return o===c?(c[12]=o[0]*Le+o[4]*Pe+o[8]*Ge+o[12],c[13]=o[1]*Le+o[5]*Pe+o[9]*Ge+o[13],c[14]=o[2]*Le+o[6]*Pe+o[10]*Ge+o[14],c[15]=o[3]*Le+o[7]*Pe+o[11]*Ge+o[15]):(T=o[1],C=o[2],k=o[3],B=o[4],F=o[5],j=o[6],Q=o[7],te=o[8],ae=o[9],he=o[10],fe=o[11],c[0]=g=o[0],c[1]=T,c[2]=C,c[3]=k,c[4]=B,c[5]=F,c[6]=j,c[7]=Q,c[8]=te,c[9]=ae,c[10]=he,c[11]=fe,c[12]=g*Le+B*Pe+te*Ge+o[12],c[13]=T*Le+F*Pe+ae*Ge+o[13],c[14]=C*Le+j*Pe+he*Ge+o[14],c[15]=k*Le+Q*Pe+fe*Ge+o[15]),c},a.triggerPluginCompletionEvent=Yu,a.unicodeBlockLookup=Dt,a.uniqueId=function(){return ne++},a.validateCustomStyleLayer=function(c){const o=[],h=c.id;return h===void 0&&o.push({message:`layers.${h}: missing required property "id"`}),c.render===void 0&&o.push({message:`layers.${h}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&o.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),o},a.validateLight=wc,a.validateStyle=El,a.vectorTile=P0,a.warnOnce=be,a.wrap=U}),s(["./shared"],function(a){function y(Y){const V=typeof Y;if(V==="number"||V==="boolean"||V==="string"||Y==null)return JSON.stringify(Y);if(Array.isArray(Y)){let f="[";for(const W of Y)f+=`${y(W)},`;return`${f}]`}const X=Object.keys(Y).sort();let oe="{";for(let f=0;f<X.length;f++)oe+=`${JSON.stringify(X[f])}:${y(Y[X[f]])},`;return`${oe}}`}function w(Y){let V="";for(const X of a.refProperties)V+=`/${y(Y[X])}`;return V}class I{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,X){for(const f of V){this._layerConfigs[f.id]=f;const W=this._layers[f.id]=a.createStyleLayer(f);W._featureFilter=a.createFilter(W.filter),this.keyCache[f.id]&&delete this.keyCache[f.id]}for(const f of X)delete this.keyCache[f],delete this._layerConfigs[f],delete this._layers[f];this.familiesBySource={};const oe=function(f,W){const ke={};for(let Ee=0;Ee<f.length;Ee++){const Me=W&&W[f[Ee].id]||w(f[Ee]);W&&(W[f[Ee].id]=Me);let Ne=ke[Me];Ne||(Ne=ke[Me]=[]),Ne.push(f[Ee])}const Ce=[];for(const Ee in ke)Ce.push(ke[Ee]);return Ce}(Object.values(this._layerConfigs),this.keyCache);for(const f of oe){const W=f.map(rt=>this._layers[rt.id]),ke=W[0];if(ke.visibility==="none")continue;const Ce=ke.source||"";let Ee=this.familiesBySource[Ce];Ee||(Ee=this.familiesBySource[Ce]={});const Me=ke.sourceLayer||"_geojsonTileLayer";let Ne=Ee[Me];Ne||(Ne=Ee[Me]=[]),Ne.push(W)}}}class R{constructor(V){const X={},oe=[];for(const Ce in V){const Ee=V[Ce],Me=X[Ce]={};for(const Ne in Ee){const rt=Ee[+Ne];if(!rt||rt.bitmap.width===0||rt.bitmap.height===0)continue;const Ve={x:0,y:0,w:rt.bitmap.width+2,h:rt.bitmap.height+2};oe.push(Ve),Me[Ne]={rect:Ve,metrics:rt.metrics}}}const{w:f,h:W}=a.potpack(oe),ke=new a.AlphaImage({width:f||1,height:W||1});for(const Ce in V){const Ee=V[Ce];for(const Me in Ee){const Ne=Ee[+Me];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const rt=X[Ce][Me].rect;a.AlphaImage.copy(Ne.bitmap,ke,{x:0,y:0},{x:rt.x+1,y:rt.y+1},Ne.bitmap)}}this.image=ke,this.positions=X}}a.register("GlyphAtlas",R);class D{constructor(V){this.tileID=new a.OverscaledTileID(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId}parse(V,X,oe,f,W){this.status="parsing",this.data=V,this.collisionBoxArray=new a.CollisionBoxArray;const ke=new a.DictionaryCoder(Object.keys(V.layers).sort()),Ce=new a.FeatureIndex(this.tileID,this.promoteId);Ce.bucketLayerIDs=[];const Ee={},Me={featureIndex:Ce,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:oe},Ne=X.familiesBySource[this.source];for(const $t in Ne){const Kt=V.layers[$t];if(!Kt)continue;Kt.version===1&&a.warnOnce(`Vector tile source "${this.source}" layer "${$t}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const wn=ke.encode($t),Ln=[];for(let Wn=0;Wn<Kt.length;Wn++){const Vt=Kt.feature(Wn),_e=Ce.getId(Vt,$t);Ln.push({feature:Vt,id:_e,index:Wn,sourceLayerIndex:wn})}for(const Wn of Ne[$t]){const Vt=Wn[0];Vt.source!==this.source&&a.warnOnce(`layer.source = ${Vt.source} does not equal this.source = ${this.source}`),Vt.minzoom&&this.zoom<Math.floor(Vt.minzoom)||Vt.maxzoom&&this.zoom>=Vt.maxzoom||Vt.visibility!=="none"&&(U(Wn,this.zoom,oe),(Ee[Vt.id]=Vt.createBucket({index:Ce.bucketLayerIDs.length,layers:Wn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:wn,sourceID:this.source})).populate(Ln,Me,this.tileID.canonical),Ce.bucketLayerIDs.push(Wn.map(_e=>_e.id)))}}let rt,Ve,ft,Lt;const Ct=a.mapObject(Me.glyphDependencies,$t=>Object.keys($t).map(Number));Object.keys(Ct).length?f.send("getGlyphs",{uid:this.uid,stacks:Ct},($t,Kt)=>{rt||(rt=$t,Ve=Kt,on.call(this))}):Ve={};const Yt=Object.keys(Me.iconDependencies);Yt.length?f.send("getImages",{icons:Yt,source:this.source,tileID:this.tileID,type:"icons"},($t,Kt)=>{rt||(rt=$t,ft=Kt,on.call(this))}):ft={};const Gt=Object.keys(Me.patternDependencies);function on(){if(rt)return W(rt);if(Ve&&ft&&Lt){const $t=new R(Ve),Kt=new a.ImageAtlas(ft,Lt);for(const wn in Ee){const Ln=Ee[wn];Ln instanceof a.SymbolBucket?(U(Ln.layers,this.zoom,oe),a.performSymbolLayout({bucket:Ln,glyphMap:Ve,glyphPositions:$t.positions,imageMap:ft,imagePositions:Kt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ln.hasPattern&&(Ln instanceof a.LineBucket||Ln instanceof a.FillBucket||Ln instanceof a.FillExtrusionBucket)&&(U(Ln.layers,this.zoom,oe),Ln.addFeatures(Me,this.tileID.canonical,Kt.patternPositions))}this.status="done",W(null,{buckets:Object.values(Ee).filter(wn=>!wn.isEmpty()),featureIndex:Ce,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:$t.image,imageAtlas:Kt,glyphMap:this.returnDependencies?Ve:null,iconMap:this.returnDependencies?ft:null,glyphPositions:this.returnDependencies?$t.positions:null})}}Gt.length?f.send("getImages",{icons:Gt,source:this.source,tileID:this.tileID,type:"patterns"},($t,Kt)=>{rt||(rt=$t,Lt=Kt,on.call(this))}):Lt={},on.call(this)}}function U(Y,V,X){const oe=new a.EvaluationParameters(V);for(const f of Y)f.recalculate(oe,X)}function q(Y,V){const X=a.getArrayBuffer(Y.request,(oe,f,W,ke)=>{oe?V(oe):f&&V(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(f)),rawData:f,cacheControl:W,expires:ke})});return()=>{X.cancel(),V()}}class ne{constructor(V,X,oe,f){this.actor=V,this.layerIndex=X,this.availableImages=oe,this.loadVectorData=f||q,this.loading={},this.loaded={}}loadTile(V,X){const oe=V.uid;this.loading||(this.loading={});const f=!!(V&&V.request&&V.request.collectResourceTiming)&&new a.RequestPerformance(V.request),W=this.loading[oe]=new D(V);W.abort=this.loadVectorData(V,(ke,Ce)=>{if(delete this.loading[oe],ke||!Ce)return W.status="done",this.loaded[oe]=W,X(ke);const Ee=Ce.rawData,Me={};Ce.expires&&(Me.expires=Ce.expires),Ce.cacheControl&&(Me.cacheControl=Ce.cacheControl);const Ne={};if(f){const rt=f.finish();rt&&(Ne.resourceTiming=JSON.parse(JSON.stringify(rt)))}W.vectorTile=Ce.vectorTile,W.parse(Ce.vectorTile,this.layerIndex,this.availableImages,this.actor,(rt,Ve)=>{if(rt||!Ve)return X(rt);X(null,a.extend({rawTileData:Ee.slice(0)},Ve,Me,Ne))}),this.loaded=this.loaded||{},this.loaded[oe]=W})}reloadTile(V,X){const oe=this.loaded,f=V.uid,W=this;if(oe&&oe[f]){const ke=oe[f];ke.showCollisionBoxes=V.showCollisionBoxes;const Ce=(Ee,Me)=>{const Ne=ke.reloadCallback;Ne&&(delete ke.reloadCallback,ke.parse(ke.vectorTile,W.layerIndex,this.availableImages,W.actor,Ne)),X(Ee,Me)};ke.status==="parsing"?ke.reloadCallback=Ce:ke.status==="done"&&(ke.vectorTile?ke.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,Ce):Ce())}}abortTile(V,X){const oe=this.loading,f=V.uid;oe&&oe[f]&&oe[f].abort&&(oe[f].abort(),delete oe[f]),X()}removeTile(V,X){const oe=this.loaded,f=V.uid;oe&&oe[f]&&delete oe[f],X()}}class pe{constructor(){this.loaded={}}loadTile(V,X){const{uid:oe,encoding:f,rawImageData:W}=V,ke=a.isImageBitmap(W)?this.getImageData(W):W,Ce=new a.DEMData(oe,ke,f);this.loaded=this.loaded||{},this.loaded[oe]=Ce,X(null,Ce)}getImageData(V){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(V.width,V.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=V.width,this.offscreenCanvas.height=V.height,this.offscreenCanvasContext.drawImage(V,0,0,V.width,V.height);const X=this.offscreenCanvasContext.getImageData(-1,-1,V.width+2,V.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:X.width,height:X.height},X.data)}removeTile(V){const X=this.loaded,oe=V.uid;X&&X[oe]&&delete X[oe]}}var J=function Y(V,X){var oe,f=V&&V.type;if(f==="FeatureCollection")for(oe=0;oe<V.features.length;oe++)Y(V.features[oe],X);else if(f==="GeometryCollection")for(oe=0;oe<V.geometries.length;oe++)Y(V.geometries[oe],X);else if(f==="Feature")Y(V.geometry,X);else if(f==="Polygon")ie(V.coordinates,X);else if(f==="MultiPolygon")for(oe=0;oe<V.coordinates.length;oe++)ie(V.coordinates[oe],X);return V};function ie(Y,V){if(Y.length!==0){re(Y[0],V);for(var X=1;X<Y.length;X++)re(Y[X],!V)}}function re(Y,V){for(var X=0,oe=0,f=0,W=Y.length,ke=W-1;f<W;ke=f++){var Ce=(Y[f][0]-Y[ke][0])*(Y[ke][1]+Y[f][1]),Ee=X+Ce;oe+=Math.abs(X)>=Math.abs(Ce)?X-Ee+Ce:Ce-Ee+X,X=Ee}X+oe>=0!=!!V&&Y.reverse()}const ge=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class be{constructor(V){this._feature=V,this.extent=a.EXTENT,this.type=V.type,this.properties=V.tags,"id"in V&&!isNaN(V.id)&&(this.id=parseInt(V.id,10))}loadGeometry(){if(this._feature.type===1){const V=[];for(const X of this._feature.geometry)V.push([new a.pointGeometry(X[0],X[1])]);return V}{const V=[];for(const X of this._feature.geometry){const oe=[];for(const f of X)oe.push(new a.pointGeometry(f[0],f[1]));V.push(oe)}return V}}toGeoJSON(V,X,oe){return ge.call(this,V,X,oe)}}class De{constructor(V){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=V.length,this._features=V}feature(V){return new be(this._features[V])}}var qe={exports:{}},et=a.pointGeometry,ht=a.vectorTile.VectorTileFeature,ot=at;function at(Y,V){this.options=V||{},this.features=Y,this.length=Y.length}function Mt(Y,V){this.id=typeof Y.id=="number"?Y.id:void 0,this.type=Y.type,this.rawGeometry=Y.type===1?[Y.geometry]:Y.geometry,this.properties=Y.tags,this.extent=V||4096}at.prototype.feature=function(Y){return new Mt(this.features[Y],this.options.extent)},Mt.prototype.loadGeometry=function(){var Y=this.rawGeometry;this.geometry=[];for(var V=0;V<Y.length;V++){for(var X=Y[V],oe=[],f=0;f<X.length;f++)oe.push(new et(X[f][0],X[f][1]));this.geometry.push(oe)}return this.geometry},Mt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Y=this.geometry,V=1/0,X=-1/0,oe=1/0,f=-1/0,W=0;W<Y.length;W++)for(var ke=Y[W],Ce=0;Ce<ke.length;Ce++){var Ee=ke[Ce];V=Math.min(V,Ee.x),X=Math.max(X,Ee.x),oe=Math.min(oe,Ee.y),f=Math.max(f,Ee.y)}return[V,oe,X,f]},Mt.prototype.toGeoJSON=ht.prototype.toGeoJSON;var ut=a.pbf,St=ot;function Pn(Y){var V=new ut;return function(X,oe){for(var f in X.layers)oe.writeMessage(3,Ot,X.layers[f])}(Y,V),V.finish()}function Ot(Y,V){var X;V.writeVarintField(15,Y.version||1),V.writeStringField(1,Y.name||""),V.writeVarintField(5,Y.extent||4096);var oe={keys:[],values:[],keycache:{},valuecache:{}};for(X=0;X<Y.length;X++)oe.feature=Y.feature(X),V.writeMessage(2,Gn,oe);var f=oe.keys;for(X=0;X<f.length;X++)V.writeStringField(3,f[X]);var W=oe.values;for(X=0;X<W.length;X++)V.writeMessage(4,bn,W[X])}function Gn(Y,V){var X=Y.feature;X.id!==void 0&&V.writeVarintField(1,X.id),V.writeMessage(2,vt,Y),V.writeVarintField(3,X.type),V.writeMessage(4,Mn,X)}function vt(Y,V){var X=Y.feature,oe=Y.keys,f=Y.values,W=Y.keycache,ke=Y.valuecache;for(var Ce in X.properties){var Ee=X.properties[Ce],Me=W[Ce];if(Ee!==null){Me===void 0&&(oe.push(Ce),W[Ce]=Me=oe.length-1),V.writeVarint(Me);var Ne=typeof Ee;Ne!=="string"&&Ne!=="boolean"&&Ne!=="number"&&(Ee=JSON.stringify(Ee));var rt=Ne+":"+Ee,Ve=ke[rt];Ve===void 0&&(f.push(Ee),ke[rt]=Ve=f.length-1),V.writeVarint(Ve)}}}function Bt(Y,V){return(V<<3)+(7&Y)}function Qt(Y){return Y<<1^Y>>31}function Mn(Y,V){for(var X=Y.loadGeometry(),oe=Y.type,f=0,W=0,ke=X.length,Ce=0;Ce<ke;Ce++){var Ee=X[Ce],Me=1;oe===1&&(Me=Ee.length),V.writeVarint(Bt(1,Me));for(var Ne=oe===3?Ee.length-1:Ee.length,rt=0;rt<Ne;rt++){rt===1&&oe!==1&&V.writeVarint(Bt(2,Ne-1));var Ve=Ee[rt].x-f,ft=Ee[rt].y-W;V.writeVarint(Qt(Ve)),V.writeVarint(Qt(ft)),f+=Ve,W+=ft}oe===3&&V.writeVarint(Bt(7,1))}}function bn(Y,V){var X=typeof Y;X==="string"?V.writeStringField(1,Y):X==="boolean"?V.writeBooleanField(7,Y):X==="number"&&(Y%1!=0?V.writeDoubleField(3,Y):Y<0?V.writeSVarintField(6,Y):V.writeVarintField(5,Y))}function pn(Y,V,X,oe,f,W){if(f-oe<=X)return;const ke=oe+f>>1;Nn(Y,V,ke,oe,f,W%2),pn(Y,V,X,oe,ke-1,W+1),pn(Y,V,X,ke+1,f,W+1)}function Nn(Y,V,X,oe,f,W){for(;f>oe;){if(f-oe>600){const Me=f-oe+1,Ne=X-oe+1,rt=Math.log(Me),Ve=.5*Math.exp(2*rt/3),ft=.5*Math.sqrt(rt*Ve*(Me-Ve)/Me)*(Ne-Me/2<0?-1:1);Nn(Y,V,X,Math.max(oe,Math.floor(X-Ne*Ve/Me+ft)),Math.min(f,Math.floor(X+(Me-Ne)*Ve/Me+ft)),W)}const ke=V[2*X+W];let Ce=oe,Ee=f;for(ti(Y,V,oe,X),V[2*f+W]>ke&&ti(Y,V,oe,f);Ce<Ee;){for(ti(Y,V,Ce,Ee),Ce++,Ee--;V[2*Ce+W]<ke;)Ce++;for(;V[2*Ee+W]>ke;)Ee--}V[2*oe+W]===ke?ti(Y,V,oe,Ee):(Ee++,ti(Y,V,Ee,f)),Ee<=X&&(oe=Ee+1),X<=Ee&&(f=Ee-1)}}function ti(Y,V,X,oe){Ue(Y,X,oe),Ue(V,2*X,2*oe),Ue(V,2*X+1,2*oe+1)}function Ue(Y,V,X){const oe=Y[V];Y[V]=Y[X],Y[X]=oe}function An(Y,V,X,oe){const f=Y-X,W=V-oe;return f*f+W*W}qe.exports=Pn,qe.exports.fromVectorTileJs=Pn,qe.exports.fromGeojsonVt=function(Y,V){V=V||{};var X={};for(var oe in Y)X[oe]=new St(Y[oe].features,V),X[oe].name=oe,X[oe].version=V.version,X[oe].extent=V.extent;return Pn({layers:X})},qe.exports.GeoJSONWrapper=St;const Un=Y=>Y[0],At=Y=>Y[1];class Xt{constructor(V,X=Un,oe=At,f=64,W=Float64Array){this.nodeSize=f,this.points=V;const ke=V.length<65536?Uint16Array:Uint32Array,Ce=this.ids=new ke(V.length),Ee=this.coords=new W(2*V.length);for(let Me=0;Me<V.length;Me++)Ce[Me]=Me,Ee[2*Me]=X(V[Me]),Ee[2*Me+1]=oe(V[Me]);pn(Ce,Ee,f,0,Ce.length-1,0)}range(V,X,oe,f){return function(W,ke,Ce,Ee,Me,Ne,rt){const Ve=[0,W.length-1,0],ft=[];let Lt,Ct;for(;Ve.length;){const Yt=Ve.pop(),Gt=Ve.pop(),on=Ve.pop();if(Gt-on<=rt){for(let wn=on;wn<=Gt;wn++)Lt=ke[2*wn],Ct=ke[2*wn+1],Lt>=Ce&&Lt<=Me&&Ct>=Ee&&Ct<=Ne&&ft.push(W[wn]);continue}const $t=Math.floor((on+Gt)/2);Lt=ke[2*$t],Ct=ke[2*$t+1],Lt>=Ce&&Lt<=Me&&Ct>=Ee&&Ct<=Ne&&ft.push(W[$t]);const Kt=(Yt+1)%2;(Yt===0?Ce<=Lt:Ee<=Ct)&&(Ve.push(on),Ve.push($t-1),Ve.push(Kt)),(Yt===0?Me>=Lt:Ne>=Ct)&&(Ve.push($t+1),Ve.push(Gt),Ve.push(Kt))}return ft}(this.ids,this.coords,V,X,oe,f,this.nodeSize)}within(V,X,oe){return function(f,W,ke,Ce,Ee,Me){const Ne=[0,f.length-1,0],rt=[],Ve=Ee*Ee;for(;Ne.length;){const ft=Ne.pop(),Lt=Ne.pop(),Ct=Ne.pop();if(Lt-Ct<=Me){for(let Kt=Ct;Kt<=Lt;Kt++)An(W[2*Kt],W[2*Kt+1],ke,Ce)<=Ve&&rt.push(f[Kt]);continue}const Yt=Math.floor((Ct+Lt)/2),Gt=W[2*Yt],on=W[2*Yt+1];An(Gt,on,ke,Ce)<=Ve&&rt.push(f[Yt]);const $t=(ft+1)%2;(ft===0?ke-Ee<=Gt:Ce-Ee<=on)&&(Ne.push(Ct),Ne.push(Yt-1),Ne.push($t)),(ft===0?ke+Ee>=Gt:Ce+Ee>=on)&&(Ne.push(Yt+1),Ne.push(Lt),Ne.push($t))}return rt}(this.ids,this.coords,V,X,oe,this.nodeSize)}}const yn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Y=>Y},mt=Math.fround||(jn=new Float32Array(1),Y=>(jn[0]=+Y,jn[0]));var jn;class Bn{constructor(V){this.options=Wr(Object.create(yn),V),this.trees=new Array(this.options.maxZoom+1)}load(V){const{log:X,minZoom:oe,maxZoom:f,nodeSize:W}=this.options;X&&console.time("total time");const ke=`prepare ${V.length} points`;X&&console.time(ke),this.points=V;let Ce=[];for(let Ee=0;Ee<V.length;Ee++)V[Ee].geometry&&Ce.push(ei(V[Ee],Ee));this.trees[f+1]=new Xt(Ce,yo,sr,W,Float32Array),X&&console.timeEnd(ke);for(let Ee=f;Ee>=oe;Ee--){const Me=+Date.now();Ce=this._cluster(Ce,Ee),this.trees[Ee]=new Xt(Ce,yo,sr,W,Float32Array),X&&console.log("z%d: %d clusters in %dms",Ee,Ce.length,+Date.now()-Me)}return X&&console.timeEnd("total time"),this}getClusters(V,X){let oe=((V[0]+180)%360+360)%360-180;const f=Math.max(-90,Math.min(90,V[1]));let W=V[2]===180?180:((V[2]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)oe=-180,W=180;else if(oe>W){const Ne=this.getClusters([oe,f,180,ke],X),rt=this.getClusters([-180,f,W,ke],X);return Ne.concat(rt)}const Ce=this.trees[this._limitZoom(X)],Ee=Ce.range(Dn(oe),fr(ke),Dn(W),fr(f)),Me=[];for(const Ne of Ee){const rt=Ce.points[Ne];Me.push(rt.numPoints?ci(rt):this.points[rt.index])}return Me}getChildren(V){const X=this._getOriginId(V),oe=this._getOriginZoom(V),f="No cluster with the specified id.",W=this.trees[oe];if(!W)throw new Error(f);const ke=W.points[X];if(!ke)throw new Error(f);const Ce=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),Ee=W.within(ke.x,ke.y,Ce),Me=[];for(const Ne of Ee){const rt=W.points[Ne];rt.parentId===V&&Me.push(rt.numPoints?ci(rt):this.points[rt.index])}if(Me.length===0)throw new Error(f);return Me}getLeaves(V,X,oe){const f=[];return this._appendLeaves(f,V,X=X||10,oe=oe||0,0),f}getTile(V,X,oe){const f=this.trees[this._limitZoom(V)],W=Math.pow(2,V),{extent:ke,radius:Ce}=this.options,Ee=Ce/ke,Me=(oe-Ee)/W,Ne=(oe+1+Ee)/W,rt={features:[]};return this._addTileFeatures(f.range((X-Ee)/W,Me,(X+1+Ee)/W,Ne),f.points,X,oe,W,rt),X===0&&this._addTileFeatures(f.range(1-Ee/W,Me,1,Ne),f.points,W,oe,W,rt),X===W-1&&this._addTileFeatures(f.range(0,Me,Ee/W,Ne),f.points,-1,oe,W,rt),rt.features.length?rt:null}getClusterExpansionZoom(V){let X=this._getOriginZoom(V)-1;for(;X<=this.options.maxZoom;){const oe=this.getChildren(V);if(X++,oe.length!==1)break;V=oe[0].properties.cluster_id}return X}_appendLeaves(V,X,oe,f,W){const ke=this.getChildren(X);for(const Ce of ke){const Ee=Ce.properties;if(Ee&&Ee.cluster?W+Ee.point_count<=f?W+=Ee.point_count:W=this._appendLeaves(V,Ee.cluster_id,oe,f,W):W<f?W++:V.push(Ce),V.length===oe)break}return W}_addTileFeatures(V,X,oe,f,W,ke){for(const Ce of V){const Ee=X[Ce],Me=Ee.numPoints;let Ne,rt,Ve;if(Me)Ne=hr(Ee),rt=Ee.x,Ve=Ee.y;else{const Ct=this.points[Ee.index];Ne=Ct.properties,rt=Dn(Ct.geometry.coordinates[0]),Ve=fr(Ct.geometry.coordinates[1])}const ft={type:1,geometry:[[Math.round(this.options.extent*(rt*W-oe)),Math.round(this.options.extent*(Ve*W-f))]],tags:Ne};let Lt;Me?Lt=Ee.id:this.options.generateId?Lt=Ee.index:this.points[Ee.index].id&&(Lt=this.points[Ee.index].id),Lt!==void 0&&(ft.id=Lt),ke.features.push(ft)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,X){const oe=[],{radius:f,extent:W,reduce:ke,minPoints:Ce}=this.options,Ee=f/(W*Math.pow(2,X));for(let Me=0;Me<V.length;Me++){const Ne=V[Me];if(Ne.zoom<=X)continue;Ne.zoom=X;const rt=this.trees[X+1],Ve=rt.within(Ne.x,Ne.y,Ee),ft=Ne.numPoints||1;let Lt=ft;for(const Ct of Ve){const Yt=rt.points[Ct];Yt.zoom>X&&(Lt+=Yt.numPoints||1)}if(Lt>ft&&Lt>=Ce){let Ct=Ne.x*ft,Yt=Ne.y*ft,Gt=ke&&ft>1?this._map(Ne,!0):null;const on=(Me<<5)+(X+1)+this.points.length;for(const $t of Ve){const Kt=rt.points[$t];if(Kt.zoom<=X)continue;Kt.zoom=X;const wn=Kt.numPoints||1;Ct+=Kt.x*wn,Yt+=Kt.y*wn,Kt.parentId=on,ke&&(Gt||(Gt=this._map(Ne,!0)),ke(Gt,this._map(Kt)))}Ne.parentId=on,oe.push(li(Ct/Lt,Yt/Lt,on,Lt,Gt))}else if(oe.push(Ne),Lt>1)for(const Ct of Ve){const Yt=rt.points[Ct];Yt.zoom<=X||(Yt.zoom=X,oe.push(Yt))}}return oe}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,X){if(V.numPoints)return X?Wr({},V.properties):V.properties;const oe=this.points[V.index].properties,f=this.options.map(oe);return X&&f===oe?Wr({},f):f}}function li(Y,V,X,oe,f){return{x:mt(Y),y:mt(V),zoom:1/0,id:X,parentId:-1,numPoints:oe,properties:f}}function ei(Y,V){const[X,oe]=Y.geometry.coordinates;return{x:mt(Dn(X)),y:mt(fr(oe)),zoom:1/0,index:V,parentId:-1}}function ci(Y){return{type:"Feature",id:Y.id,properties:hr(Y),geometry:{type:"Point",coordinates:[(V=Y.x,360*(V-.5)),ni(Y.y)]}};var V}function hr(Y){const V=Y.numPoints,X=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V;return Wr(Wr({},Y.properties),{cluster:!0,cluster_id:Y.id,point_count:V,point_count_abbreviated:X})}function Dn(Y){return Y/360+.5}function fr(Y){const V=Math.sin(Y*Math.PI/180),X=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return X<0?0:X>1?1:X}function ni(Y){const V=(180-360*Y)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function Wr(Y,V){for(const X in V)Y[X]=V[X];return Y}function yo(Y){return Y.x}function sr(Y){return Y.y}function Lr(Y,V,X,oe){for(var f,W=oe,ke=X-V>>1,Ce=X-V,Ee=Y[V],Me=Y[V+1],Ne=Y[X],rt=Y[X+1],Ve=V+3;Ve<X;Ve+=3){var ft=vo(Y[Ve],Y[Ve+1],Ee,Me,Ne,rt);if(ft>W)f=Ve,W=ft;else if(ft===W){var Lt=Math.abs(Ve-ke);Lt<Ce&&(f=Ve,Ce=Lt)}}W>oe&&(f-V>3&&Lr(Y,V,f,oe),Y[f+2]=W,X-f>3&&Lr(Y,f,X,oe))}function vo(Y,V,X,oe,f,W){var ke=f-X,Ce=W-oe;if(ke!==0||Ce!==0){var Ee=((Y-X)*ke+(V-oe)*Ce)/(ke*ke+Ce*Ce);Ee>1?(X=f,oe=W):Ee>0&&(X+=ke*Ee,oe+=Ce*Ee)}return(ke=Y-X)*ke+(Ce=V-oe)*Ce}function $r(Y,V,X,oe){var f={id:Y===void 0?null:Y,type:V,geometry:X,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(W){var ke=W.geometry,Ce=W.type;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")nt(W,ke);else if(Ce==="Polygon"||Ce==="MultiLineString")for(var Ee=0;Ee<ke.length;Ee++)nt(W,ke[Ee]);else if(Ce==="MultiPolygon")for(Ee=0;Ee<ke.length;Ee++)for(var Me=0;Me<ke[Ee].length;Me++)nt(W,ke[Ee][Me])}(f),f}function nt(Y,V){for(var X=0;X<V.length;X+=3)Y.minX=Math.min(Y.minX,V[X]),Y.minY=Math.min(Y.minY,V[X+1]),Y.maxX=Math.max(Y.maxX,V[X]),Y.maxY=Math.max(Y.maxY,V[X+1])}function wt(Y,V,X,oe){if(V.geometry){var f=V.geometry.coordinates,W=V.geometry.type,ke=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2),Ce=[],Ee=V.id;if(X.promoteId?Ee=V.properties[X.promoteId]:X.generateId&&(Ee=oe||0),W==="Point")Ms(f,Ce);else if(W==="MultiPoint")for(var Me=0;Me<f.length;Me++)Ms(f[Me],Ce);else if(W==="LineString")or(f,Ce,ke,!1);else if(W==="MultiLineString"){if(X.lineMetrics){for(Me=0;Me<f.length;Me++)or(f[Me],Ce=[],ke,!1),Y.push($r(Ee,"LineString",Ce,V.properties));return}In(f,Ce,ke,!1)}else if(W==="Polygon")In(f,Ce,ke,!0);else{if(W!=="MultiPolygon"){if(W==="GeometryCollection"){for(Me=0;Me<V.geometry.geometries.length;Me++)wt(Y,{id:Ee,geometry:V.geometry.geometries[Me],properties:V.properties},X,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Me=0;Me<f.length;Me++){var Ne=[];In(f[Me],Ne,ke,!0),Ce.push(Ne)}}Y.push($r(Ee,W,Ce,V.properties))}}function Ms(Y,V){V.push(wr(Y[0])),V.push(Ar(Y[1])),V.push(0)}function or(Y,V,X,oe){for(var f,W,ke=0,Ce=0;Ce<Y.length;Ce++){var Ee=wr(Y[Ce][0]),Me=Ar(Y[Ce][1]);V.push(Ee),V.push(Me),V.push(0),Ce>0&&(ke+=oe?(f*Me-Ee*W)/2:Math.sqrt(Math.pow(Ee-f,2)+Math.pow(Me-W,2))),f=Ee,W=Me}var Ne=V.length-3;V[2]=1,Lr(V,0,Ne,X),V[Ne+2]=1,V.size=Math.abs(ke),V.start=0,V.end=V.size}function In(Y,V,X,oe){for(var f=0;f<Y.length;f++){var W=[];or(Y[f],W,X,oe),V.push(W)}}function wr(Y){return Y/360+.5}function Ar(Y){var V=Math.sin(Y*Math.PI/180),X=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return X<0?0:X>1?1:X}function dr(Y,V,X,oe,f,W,ke,Ce){if(oe/=V,W>=(X/=V)&&ke<oe)return Y;if(ke<X||W>=oe)return null;for(var Ee=[],Me=0;Me<Y.length;Me++){var Ne=Y[Me],rt=Ne.geometry,Ve=Ne.type,ft=f===0?Ne.minX:Ne.minY,Lt=f===0?Ne.maxX:Ne.maxY;if(ft>=X&&Lt<oe)Ee.push(Ne);else if(!(Lt<X||ft>=oe)){var Ct=[];if(Ve==="Point"||Ve==="MultiPoint")us(rt,Ct,X,oe,f);else if(Ve==="LineString")bt(rt,Ct,X,oe,f,!1,Ce.lineMetrics);else if(Ve==="MultiLineString")dn(rt,Ct,X,oe,f,!1);else if(Ve==="Polygon")dn(rt,Ct,X,oe,f,!0);else if(Ve==="MultiPolygon")for(var Yt=0;Yt<rt.length;Yt++){var Gt=[];dn(rt[Yt],Gt,X,oe,f,!0),Gt.length&&Ct.push(Gt)}if(Ct.length){if(Ce.lineMetrics&&Ve==="LineString"){for(Yt=0;Yt<Ct.length;Yt++)Ee.push($r(Ne.id,Ve,Ct[Yt],Ne.tags));continue}Ve!=="LineString"&&Ve!=="MultiLineString"||(Ct.length===1?(Ve="LineString",Ct=Ct[0]):Ve="MultiLineString"),Ve!=="Point"&&Ve!=="MultiPoint"||(Ve=Ct.length===3?"Point":"MultiPoint"),Ee.push($r(Ne.id,Ve,Ct,Ne.tags))}}}return Ee.length?Ee:null}function us(Y,V,X,oe,f){for(var W=0;W<Y.length;W+=3){var ke=Y[W+f];ke>=X&&ke<=oe&&(V.push(Y[W]),V.push(Y[W+1]),V.push(Y[W+2]))}}function bt(Y,V,X,oe,f,W,ke){for(var Ce,Ee,Me=mn(Y),Ne=f===0?hs:un,rt=Y.start,Ve=0;Ve<Y.length-3;Ve+=3){var ft=Y[Ve],Lt=Y[Ve+1],Ct=Y[Ve+2],Yt=Y[Ve+3],Gt=Y[Ve+4],on=f===0?ft:Lt,$t=f===0?Yt:Gt,Kt=!1;ke&&(Ce=Math.sqrt(Math.pow(ft-Yt,2)+Math.pow(Lt-Gt,2))),on<X?$t>X&&(Ee=Ne(Me,ft,Lt,Yt,Gt,X),ke&&(Me.start=rt+Ce*Ee)):on>oe?$t<oe&&(Ee=Ne(Me,ft,Lt,Yt,Gt,oe),ke&&(Me.start=rt+Ce*Ee)):Ii(Me,ft,Lt,Ct),$t<X&&on>=X&&(Ee=Ne(Me,ft,Lt,Yt,Gt,X),Kt=!0),$t>oe&&on<=oe&&(Ee=Ne(Me,ft,Lt,Yt,Gt,oe),Kt=!0),!W&&Kt&&(ke&&(Me.end=rt+Ce*Ee),V.push(Me),Me=mn(Y)),ke&&(rt+=Ce)}var wn=Y.length-3;ft=Y[wn],Lt=Y[wn+1],Ct=Y[wn+2],(on=f===0?ft:Lt)>=X&&on<=oe&&Ii(Me,ft,Lt,Ct),wn=Me.length-3,W&&wn>=3&&(Me[wn]!==Me[0]||Me[wn+1]!==Me[1])&&Ii(Me,Me[0],Me[1],Me[2]),Me.length&&V.push(Me)}function mn(Y){var V=[];return V.size=Y.size,V.start=Y.start,V.end=Y.end,V}function dn(Y,V,X,oe,f,W){for(var ke=0;ke<Y.length;ke++)bt(Y[ke],V,X,oe,f,W,!1)}function Ii(Y,V,X,oe){Y.push(V),Y.push(X),Y.push(oe)}function hs(Y,V,X,oe,f,W){var ke=(W-V)/(oe-V);return Y.push(W),Y.push(X+(f-X)*ke),Y.push(1),ke}function un(Y,V,X,oe,f,W){var ke=(W-X)/(f-X);return Y.push(V+(oe-V)*ke),Y.push(W),Y.push(1),ke}function pt(Y,V){for(var X=[],oe=0;oe<Y.length;oe++){var f,W=Y[oe],ke=W.type;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")f=zi(W.geometry,V);else if(ke==="MultiLineString"||ke==="Polygon"){f=[];for(var Ce=0;Ce<W.geometry.length;Ce++)f.push(zi(W.geometry[Ce],V))}else if(ke==="MultiPolygon")for(f=[],Ce=0;Ce<W.geometry.length;Ce++){for(var Ee=[],Me=0;Me<W.geometry[Ce].length;Me++)Ee.push(zi(W.geometry[Ce][Me],V));f.push(Ee)}X.push($r(W.id,ke,f,W.tags))}return X}function zi(Y,V){var X=[];X.size=Y.size,Y.start!==void 0&&(X.start=Y.start,X.end=Y.end);for(var oe=0;oe<Y.length;oe+=3)X.push(Y[oe]+V,Y[oe+1],Y[oe+2]);return X}function $s(Y,V){if(Y.transformed)return Y;var X,oe,f,W=1<<Y.z,ke=Y.x,Ce=Y.y;for(X=0;X<Y.features.length;X++){var Ee=Y.features[X],Me=Ee.geometry,Ne=Ee.type;if(Ee.geometry=[],Ne===1)for(oe=0;oe<Me.length;oe+=2)Ee.geometry.push(bi(Me[oe],Me[oe+1],V,W,ke,Ce));else for(oe=0;oe<Me.length;oe++){var rt=[];for(f=0;f<Me[oe].length;f+=2)rt.push(bi(Me[oe][f],Me[oe][f+1],V,W,ke,Ce));Ee.geometry.push(rt)}}return Y.transformed=!0,Y}function bi(Y,V,X,oe,f,W){return[Math.round(X*(Y*oe-f)),Math.round(X*(V*oe-W))]}function Wi(Y,V,X,oe,f){for(var W=V===f.maxZoom?0:f.tolerance/((1<<V)*f.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:X,y:oe,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ce=0;Ce<Y.length;Ce++){ke.numFeatures++,Hn(ke,Y[Ce],W,f);var Ee=Y[Ce].minX,Me=Y[Ce].minY,Ne=Y[Ce].maxX,rt=Y[Ce].maxY;Ee<ke.minX&&(ke.minX=Ee),Me<ke.minY&&(ke.minY=Me),Ne>ke.maxX&&(ke.maxX=Ne),rt>ke.maxY&&(ke.maxY=rt)}return ke}function Hn(Y,V,X,oe){var f=V.geometry,W=V.type,ke=[];if(W==="Point"||W==="MultiPoint")for(var Ce=0;Ce<f.length;Ce+=3)ke.push(f[Ce]),ke.push(f[Ce+1]),Y.numPoints++,Y.numSimplified++;else if(W==="LineString")qs(ke,f,Y,X,!1,!1);else if(W==="MultiLineString"||W==="Polygon")for(Ce=0;Ce<f.length;Ce++)qs(ke,f[Ce],Y,X,W==="Polygon",Ce===0);else if(W==="MultiPolygon")for(var Ee=0;Ee<f.length;Ee++){var Me=f[Ee];for(Ce=0;Ce<Me.length;Ce++)qs(ke,Me[Ce],Y,X,!0,Ce===0)}if(ke.length){var Ne=V.tags||null;if(W==="LineString"&&oe.lineMetrics){for(var rt in Ne={},V.tags)Ne[rt]=V.tags[rt];Ne.mapbox_clip_start=f.start/f.size,Ne.mapbox_clip_end=f.end/f.size}var Ve={geometry:ke,type:W==="Polygon"||W==="MultiPolygon"?3:W==="LineString"||W==="MultiLineString"?2:1,tags:Ne};V.id!==null&&(Ve.id=V.id),Y.features.push(Ve)}}function qs(Y,V,X,oe,f,W){var ke=oe*oe;if(oe>0&&V.size<(f?ke:oe))X.numPoints+=V.length/3;else{for(var Ce=[],Ee=0;Ee<V.length;Ee+=3)(oe===0||V[Ee+2]>ke)&&(X.numSimplified++,Ce.push(V[Ee]),Ce.push(V[Ee+1])),X.numPoints++;f&&function(Me,Ne){for(var rt=0,Ve=0,ft=Me.length,Lt=ft-2;Ve<ft;Lt=Ve,Ve+=2)rt+=(Me[Ve]-Me[Lt])*(Me[Ve+1]+Me[Lt+1]);if(rt>0===Ne)for(Ve=0,ft=Me.length;Ve<ft/2;Ve+=2){var Ct=Me[Ve],Yt=Me[Ve+1];Me[Ve]=Me[ft-2-Ve],Me[Ve+1]=Me[ft-1-Ve],Me[ft-2-Ve]=Ct,Me[ft-1-Ve]=Yt}}(Ce,W),Y.push(Ce)}}function Dr(Y,V){var X=(V=this.options=function(f,W){for(var ke in W)f[ke]=W[ke];return f}(Object.create(this.options),V)).debug;if(X&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");var oe=function(f,W){var ke=[];if(f.type==="FeatureCollection")for(var Ce=0;Ce<f.features.length;Ce++)wt(ke,f.features[Ce],W,Ce);else wt(ke,f.type==="Feature"?f:{geometry:f},W);return ke}(Y,V);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),oe=function(f,W){var ke=W.buffer/W.extent,Ce=f,Ee=dr(f,1,-1-ke,ke,0,-1,2,W),Me=dr(f,1,1-ke,2+ke,0,-1,2,W);return(Ee||Me)&&(Ce=dr(f,1,-ke,1+ke,0,-1,2,W)||[],Ee&&(Ce=pt(Ee,1).concat(Ce)),Me&&(Ce=Ce.concat(pt(Me,-1)))),Ce}(oe,V),oe.length&&this.splitTile(oe,0,0,0),X&&(oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Rr(Y,V,X){return 32*((1<<Y)*X+V)+Y}function qr(Y,V){const X=Y.tileID.canonical;if(!this._geoJSONIndex)return V(null,null);const oe=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!oe)return V(null,null);const f=new De(oe.features);let W=qe.exports(f);W.byteOffset===0&&W.byteLength===W.buffer.byteLength||(W=new Uint8Array(W)),V(null,{vectorTile:f,rawData:W.buffer})}Dr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Dr.prototype.splitTile=function(Y,V,X,oe,f,W,ke){for(var Ce=[Y,V,X,oe],Ee=this.options,Me=Ee.debug;Ce.length;){oe=Ce.pop(),X=Ce.pop(),V=Ce.pop(),Y=Ce.pop();var Ne=1<<V,rt=Rr(V,X,oe),Ve=this.tiles[rt];if(!Ve&&(Me>1&&console.time("creation"),Ve=this.tiles[rt]=Wi(Y,V,X,oe,Ee),this.tileCoords.push({z:V,x:X,y:oe}),Me)){Me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,X,oe,Ve.numFeatures,Ve.numPoints,Ve.numSimplified),console.timeEnd("creation"));var ft="z"+V;this.stats[ft]=(this.stats[ft]||0)+1,this.total++}if(Ve.source=Y,f){if(V===Ee.maxZoom||V===f)continue;var Lt=1<<f-V;if(X!==Math.floor(W/Lt)||oe!==Math.floor(ke/Lt))continue}else if(V===Ee.indexMaxZoom||Ve.numPoints<=Ee.indexMaxPoints)continue;if(Ve.source=null,Y.length!==0){Me>1&&console.time("clipping");var Ct,Yt,Gt,on,$t,Kt,wn=.5*Ee.buffer/Ee.extent,Ln=.5-wn,Wn=.5+wn,Vt=1+wn;Ct=Yt=Gt=on=null,$t=dr(Y,Ne,X-wn,X+Wn,0,Ve.minX,Ve.maxX,Ee),Kt=dr(Y,Ne,X+Ln,X+Vt,0,Ve.minX,Ve.maxX,Ee),Y=null,$t&&(Ct=dr($t,Ne,oe-wn,oe+Wn,1,Ve.minY,Ve.maxY,Ee),Yt=dr($t,Ne,oe+Ln,oe+Vt,1,Ve.minY,Ve.maxY,Ee),$t=null),Kt&&(Gt=dr(Kt,Ne,oe-wn,oe+Wn,1,Ve.minY,Ve.maxY,Ee),on=dr(Kt,Ne,oe+Ln,oe+Vt,1,Ve.minY,Ve.maxY,Ee),Kt=null),Me>1&&console.timeEnd("clipping"),Ce.push(Ct||[],V+1,2*X,2*oe),Ce.push(Yt||[],V+1,2*X,2*oe+1),Ce.push(Gt||[],V+1,2*X+1,2*oe),Ce.push(on||[],V+1,2*X+1,2*oe+1)}}},Dr.prototype.getTile=function(Y,V,X){var oe=this.options,f=oe.extent,W=oe.debug;if(Y<0||Y>24)return null;var ke=1<<Y,Ce=Rr(Y,V=(V%ke+ke)%ke,X);if(this.tiles[Ce])return $s(this.tiles[Ce],f);W>1&&console.log("drilling down to z%d-%d-%d",Y,V,X);for(var Ee,Me=Y,Ne=V,rt=X;!Ee&&Me>0;)Me--,Ne=Math.floor(Ne/2),rt=Math.floor(rt/2),Ee=this.tiles[Rr(Me,Ne,rt)];return Ee&&Ee.source?(W>1&&console.log("found parent tile z%d-%d-%d",Me,Ne,rt),W>1&&console.time("drilling down"),this.splitTile(Ee.source,Me,Ne,rt,Y,V,X),W>1&&console.timeEnd("drilling down"),this.tiles[Ce]?$s(this.tiles[Ce],f):null):null};class Is extends ne{constructor(V,X,oe,f){super(V,X,oe,qr),f&&(this.loadGeoJSON=f)}loadData(V,X){var oe;(oe=this._pendingRequest)===null||oe===void 0||oe.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const f=!!(V&&V.request&&V.request.collectResourceTiming)&&new a.RequestPerformance(V.request);this._pendingCallback=X,this._pendingRequest=this.loadGeoJSON(V,(W,ke)=>{if(delete this._pendingCallback,delete this._pendingRequest,W||!ke)return X(W);if(typeof ke!="object")return X(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));{J(ke,!0);try{if(V.filter){const Ee=a.createExpression(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ee.result==="error")throw new Error(Ee.value.map(Ne=>`${Ne.key}: ${Ne.message}`).join(", "));ke={type:"FeatureCollection",features:ke.features.filter(Ne=>Ee.value.evaluate({zoom:0},Ne))}}this._geoJSONIndex=V.cluster?new Bn(function({superclusterOptions:Ee,clusterProperties:Me}){if(!Me||!Ee)return Ee;const Ne={},rt={},Ve={accumulated:null,zoom:0},ft={properties:null},Lt=Object.keys(Me);for(const Ct of Lt){const[Yt,Gt]=Me[Ct],on=a.createExpression(Gt),$t=a.createExpression(typeof Yt=="string"?[Yt,["accumulated"],["get",Ct]]:Yt);Ne[Ct]=on.value,rt[Ct]=$t.value}return Ee.map=Ct=>{ft.properties=Ct;const Yt={};for(const Gt of Lt)Yt[Gt]=Ne[Gt].evaluate(Ve,ft);return Yt},Ee.reduce=(Ct,Yt)=>{ft.properties=Yt;for(const Gt of Lt)Ve.accumulated=Ct[Gt],Ct[Gt]=rt[Gt].evaluate(Ve,ft)},Ee}(V)).load(ke.features):function(Ee,Me){return new Dr(Ee,Me)}(ke,V.geojsonVtOptions)}catch(Ee){return X(Ee)}this.loaded={};const Ce={};if(f){const Ee=f.finish();Ee&&(Ce.resourceTiming={},Ce.resourceTiming[V.source]=JSON.parse(JSON.stringify(Ee)))}X(null,Ce)}})}reloadTile(V,X){const oe=this.loaded;return oe&&oe[V.uid]?super.reloadTile(V,X):this.loadTile(V,X)}loadGeoJSON(V,X){if(V.request)return a.getJSON(V.request,X);if(typeof V.data=="string")try{X(null,JSON.parse(V.data))}catch{X(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`))}else X(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(V,X){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),X()}getClusterExpansionZoom(V,X){try{X(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(oe){X(oe)}}getClusterChildren(V,X){try{X(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(oe){X(oe)}}getClusterLeaves(V,X){try{X(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(oe){X(oe)}}}class ar{constructor(V){this.self=V,this.actor=new a.Actor(V,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ne,geojson:Is},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(X,oe)=>{if(this.workerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.workerSourceTypes[X]=oe},this.self.registerRTLTextPlugin=X=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=X.applyArabicShaping,a.plugin.processBidirectionalText=X.processBidirectionalText,a.plugin.processStyledBidirectionalText=X.processStyledBidirectionalText}}setReferrer(V,X){this.referrer=X}setImages(V,X,oe){this.availableImages[V]=X;for(const f in this.workerSources[V]){const W=this.workerSources[V][f];for(const ke in W)W[ke].availableImages=X}oe()}setLayers(V,X,oe){this.getLayerIndex(V).replace(X),oe()}updateLayers(V,X,oe){this.getLayerIndex(V).update(X.layers,X.removedIds),oe()}loadTile(V,X,oe){this.getWorkerSource(V,X.type,X.source).loadTile(X,oe)}loadDEMTile(V,X,oe){this.getDEMWorkerSource(V,X.source).loadTile(X,oe)}reloadTile(V,X,oe){this.getWorkerSource(V,X.type,X.source).reloadTile(X,oe)}abortTile(V,X,oe){this.getWorkerSource(V,X.type,X.source).abortTile(X,oe)}removeTile(V,X,oe){this.getWorkerSource(V,X.type,X.source).removeTile(X,oe)}removeDEMTile(V,X){this.getDEMWorkerSource(V,X.source).removeTile(X)}removeSource(V,X,oe){if(!this.workerSources[V]||!this.workerSources[V][X.type]||!this.workerSources[V][X.type][X.source])return;const f=this.workerSources[V][X.type][X.source];delete this.workerSources[V][X.type][X.source],f.removeSource!==void 0?f.removeSource(X,oe):oe()}loadWorkerSource(V,X,oe){try{this.self.importScripts(X.url),oe()}catch(f){oe(f.toString())}}syncRTLPluginState(V,X,oe){try{a.plugin.setState(X);const f=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&f!=null){this.self.importScripts(f);const W=a.plugin.isParsed();oe(W?void 0:new Error(`RTL Text Plugin failed to import scripts from ${f}`),W)}}catch(f){oe(f.toString())}}getAvailableImages(V){let X=this.availableImages[V];return X||(X=[]),X}getLayerIndex(V){let X=this.layerIndexes[V];return X||(X=this.layerIndexes[V]=new I),X}getWorkerSource(V,X,oe){if(this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][X]||(this.workerSources[V][X]={}),!this.workerSources[V][X][oe]){const f={send:(W,ke,Ce)=>{this.actor.send(W,ke,Ce,V)}};this.workerSources[V][X][oe]=new this.workerSourceTypes[X](f,this.getLayerIndex(V),this.getAvailableImages(V))}return this.workerSources[V][X][oe]}getDEMWorkerSource(V,X){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][X]||(this.demWorkerSources[V][X]=new pe),this.demWorkerSources[V][X]}enforceCacheSizeLimit(V,X){a.enforceCacheSizeLimit(X)}}return a.isWorker()&&(self.worker=new ar(self)),ar}),s(["./shared"],function(a){var y=w;function w(b){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,E,P=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(P);try{E=new Worker(z),v=!0}catch{v=!1}return E&&E.terminate(),URL.revokeObjectURL(z),v}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var v=document.createElement("canvas");v.width=v.height=1;var E=v.getContext("2d");if(!E)return!1;var P=E.getImageData(0,0,1,1);return P&&P.width===v.width}()?(I[p=l&&l.failIfMajorPerformanceCaveat]===void 0&&(I[p]=function(v){var E,P=function(z){var N=document.createElement("canvas"),G=Object.create(w.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=z,N.getContext("webgl",G)||N.getContext("experimental-webgl",G)}(v);if(!P)return!1;try{E=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!E||P.isContextLost())&&(P.shaderSource(E,"void main() {}"),P.compileShader(E),P.getShaderParameter(E,P.COMPILE_STATUS)===!0)}(p)),I[p]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var p}(b)}var I={};function R(b,l){if(Array.isArray(b)){if(!Array.isArray(l)||b.length!==l.length)return!1;for(let p=0;p<b.length;p++)if(!R(b[p],l[p]))return!1;return!0}if(typeof b=="object"&&b!==null&&l!==null){if(typeof l!="object"||Object.keys(b).length!==Object.keys(l).length)return!1;for(const p in b)if(!R(b[p],l[p]))return!1;return!0}return b===l}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class D{static testProp(l){if(!D.docStyle)return l[0];for(let p=0;p<l.length;p++)if(l[p]in D.docStyle)return l[p];return l[0]}static create(l,p,v){const E=window.document.createElement(l);return p!==void 0&&(E.className=p),v&&v.appendChild(E),E}static createNS(l,p){return window.document.createElementNS(l,p)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(l,p){l.style[D.transformProp]=p}static addEventListener(l,p,v,E={}){l.addEventListener(p,v,"passive"in E?E:E.capture)}static removeEventListener(l,p,v,E={}){l.removeEventListener(p,v,"passive"in E?E:E.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static mousePos(l,p){const v=l.getBoundingClientRect();return new a.pointGeometry(p.clientX-v.left-l.clientLeft,p.clientY-v.top-l.clientTop)}static touchPos(l,p){const v=l.getBoundingClientRect(),E=[];for(let P=0;P<p.length;P++)E.push(new a.pointGeometry(p[P].clientX-v.left-l.clientLeft,p[P].clientY-v.top-l.clientTop));return E}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);class U{constructor(l){this._transformRequestFn=l}transformRequest(l,p){return this._transformRequestFn&&this._transformRequestFn(l,p)||{url:l}}normalizeSpriteURL(l,p,v){const E=function(P){const z=P.match(q);if(!z)throw new Error(`Unable to parse URL "${P}"`);return{protocol:z[1],authority:z[2],path:z[3]||"/",params:z[4]?z[4].split("&"):[]}}(l);return E.path+=`${p}${v}`,function(P){const z=P.params.length?`?${P.params.join("&")}`:"";return`${P.protocol}://${P.authority}${P.path}${z}`}(E)}setTransformRequest(l){this._transformRequestFn=l}}const q=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class ne{constructor(l,p,v,E){this.context=l,this.format=v,this.texture=l.gl.createTexture(),this.update(p,E)}update(l,p,v){const{width:E,height:P}=l,z=!(this.size&&this.size[0]===E&&this.size[1]===P||v),{context:N}=this,{gl:G}=N;if(this.useMipmap=!!(p&&p.useMipmap),G.bindTexture(G.TEXTURE_2D,this.texture),N.pixelStoreUnpackFlipY.set(!1),N.pixelStoreUnpack.set(1),N.pixelStoreUnpackPremultiplyAlpha.set(this.format===G.RGBA&&(!p||p.premultiply!==!1)),z)this.size=[E,P],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||a.isImageBitmap(l)?G.texImage2D(G.TEXTURE_2D,0,this.format,this.format,G.UNSIGNED_BYTE,l):G.texImage2D(G.TEXTURE_2D,0,this.format,E,P,0,this.format,G.UNSIGNED_BYTE,l.data);else{const{x:$,y:K}=v||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||a.isImageBitmap(l)?G.texSubImage2D(G.TEXTURE_2D,0,$,K,G.RGBA,G.UNSIGNED_BYTE,l):G.texSubImage2D(G.TEXTURE_2D,0,$,K,E,P,G.RGBA,G.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&G.generateMipmap(G.TEXTURE_2D)}bind(l,p,v){const{context:E}=this,{gl:P}=E;P.bindTexture(P.TEXTURE_2D,this.texture),v!==P.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=P.LINEAR),l!==this.filter&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,l),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,v||l),this.filter=l),p!==this.wrap&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,p),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,p),this.wrap=p)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function pe(b){const{userImage:l}=b;return!!(l&&l.render&&l.render())&&(b.data.replace(new Uint8Array(l.data.buffer)),!0)}class J extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:p,callback:v}of this.requestors)this._notify(p,v);this.requestors=[]}}getImage(l){return this.images[l]}addImage(l,p){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,p)&&(this.images[l]=p)}_validate(l,p){let v=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),v=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),v=!1),this._validateContent(p.content,p)||(this.fire(new a.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),v=!1),v}_validateStretch(l,p){if(!l)return!0;let v=0;for(const E of l){if(E[0]<v||E[1]<E[0]||p<E[1])return!1;v=E[1]}return!0}_validateContent(l,p){return!(l&&(l.length!==4||l[0]<0||p.data.width<l[0]||l[1]<0||p.data.height<l[1]||l[2]<0||p.data.width<l[2]||l[3]<0||p.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,p){const v=this.images[l];if(v.data.width!==p.data.width||v.data.height!==p.data.height)throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${p.data.width}x${p.data.height}).`);p.version=v.version+1,this.images[l]=p,this.updatedImages[l]=!0}removeImage(l){const p=this.images[l];delete this.images[l],delete this.patterns[l],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,p){let v=!0;if(!this.isLoaded())for(const E of l)this.images[E]||(v=!1);this.isLoaded()||v?this._notify(l,p):this.requestors.push({ids:l,callback:p})}_notify(l,p){const v={};for(const E of l){this.images[E]||this.fire(new a.Event("styleimagemissing",{id:E}));const P=this.images[E];P?v[E]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:a.warnOnce(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,v)}getPixelSize(){const{width:l,height:p}=this.atlasImage;return{width:l,height:p}}getPattern(l){const p=this.patterns[l],v=this.getImage(l);if(!v)return null;if(p&&p.position.version===v.version)return p.position;if(p)p.position.version=v.version;else{const E={w:v.data.width+2,h:v.data.height+2,x:0,y:0},P=new a.ImagePosition(E,v);this.patterns[l]={bin:E,position:P}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const p=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ne(l,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const P in this.patterns)l.push(this.patterns[P].bin);const{w:p,h:v}=a.potpack(l),E=this.atlasImage;E.resize({width:p||1,height:v||1});for(const P in this.patterns){const{bin:z}=this.patterns[P],N=z.x+1,G=z.y+1,$=this.images[P].data,K=$.width,se=$.height;a.RGBAImage.copy($,E,{x:0,y:0},{x:N,y:G},{width:K,height:se}),a.RGBAImage.copy($,E,{x:0,y:se-1},{x:N,y:G-1},{width:K,height:1}),a.RGBAImage.copy($,E,{x:0,y:0},{x:N,y:G+se},{width:K,height:1}),a.RGBAImage.copy($,E,{x:K-1,y:0},{x:N-1,y:G},{width:1,height:se}),a.RGBAImage.copy($,E,{x:0,y:0},{x:N+K,y:G},{width:1,height:se})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const p of l){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const v=this.images[p];v||a.warnOnce(`Image with ID: "${p}" was not found`),pe(v)&&this.updateImage(p,v)}}}const ie=1e20;function re(b,l,p,v,E,P,z,N,G){for(let $=l;$<l+v;$++)ge(b,p*P+$,P,E,z,N,G);for(let $=p;$<p+E;$++)ge(b,$*P+l,1,v,z,N,G)}function ge(b,l,p,v,E,P,z){P[0]=0,z[0]=-ie,z[1]=ie,E[0]=b[l];for(let N=1,G=0,$=0;N<v;N++){E[N]=b[l+N*p];const K=N*N;do{const se=P[G];$=(E[N]-E[se]+K-se*se)/(N-se)/2}while($<=z[G]&&--G>-1);G++,P[G]=N,z[G]=$,z[G+1]=ie}for(let N=0,G=0;N<v;N++){for(;z[G+1]<N;)G++;const $=P[G],K=N-$;b[l+N*p]=E[$]+K*K}}class be{constructor(l,p){this.requestManager=l,this.localIdeographFontFamily=p,this.entries={}}setURL(l){this.url=l}getGlyphs(l,p){const v=[];for(const E in l)for(const P of l[E])v.push({stack:E,id:P});a.asyncAll(v,({stack:E,id:P},z)=>{let N=this.entries[E];N||(N=this.entries[E]={glyphs:{},requests:{},ranges:{}});let G=N.glyphs[P];if(G!==void 0)return void z(null,{stack:E,id:P,glyph:G});if(G=this._tinySDF(N,E,P),G)return N.glyphs[P]=G,void z(null,{stack:E,id:P,glyph:G});const $=Math.floor(P/256);if(256*$>65535)return void z(new Error("glyphs > 65535 not supported"));if(N.ranges[$])return void z(null,{stack:E,id:P,glyph:G});let K=N.requests[$];K||(K=N.requests[$]=[],be.loadGlyphRange(E,$,this.url,this.requestManager,(se,ce)=>{if(ce){for(const xe in ce)this._doesCharSupportLocalGlyph(+xe)||(N.glyphs[+xe]=ce[+xe]);N.ranges[$]=!0}for(const xe of K)xe(se,ce);delete N.requests[$]})),K.push((se,ce)=>{se?z(se):ce&&z(null,{stack:E,id:P,glyph:ce[P]||null})})},(E,P)=>{if(E)p(E);else if(P){const z={};for(const{stack:N,id:G,glyph:$}of P)(z[N]||(z[N]={}))[G]=$&&{id:$.id,bitmap:$.bitmap.clone(),metrics:$.metrics};p(null,z)}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(a.unicodeBlockLookup["CJK Unified Ideographs"](l)||a.unicodeBlockLookup["Hangul Syllables"](l)||a.unicodeBlockLookup.Hiragana(l)||a.unicodeBlockLookup.Katakana(l))}_tinySDF(l,p,v){const E=this.localIdeographFontFamily;if(!E||!this._doesCharSupportLocalGlyph(v))return;let P=l.tinySDF;if(!P){let N="400";/bold/i.test(p)?N="900":/medium/i.test(p)?N="500":/light/i.test(p)&&(N="200"),P=l.tinySDF=new be.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:E,fontWeight:N})}const z=P.draw(String.fromCharCode(v));return{id:v,bitmap:new a.AlphaImage({width:z.width||30,height:z.height||30},z.data),metrics:{width:z.glyphWidth||24,height:z.glyphHeight||24,left:z.glyphLeft||0,top:z.glyphTop-27||-8,advance:z.glyphAdvance||24}}}}be.loadGlyphRange=function(b,l,p,v,E){const P=256*l,z=P+255,N=v.transformRequest(p.replace("{fontstack}",b).replace("{range}",`${P}-${z}`),a.ResourceType.Glyphs);a.getArrayBuffer(N,(G,$)=>{if(G)E(G);else if($){const K={};for(const se of a.parseGlyphPbf($))K[se.id]=se;E(null,K)}})},be.TinySDF=class{constructor({fontSize:b=24,buffer:l=3,radius:p=8,cutoff:v=.25,fontFamily:E="sans-serif",fontWeight:P="normal",fontStyle:z="normal"}={}){this.buffer=l,this.cutoff=v,this.radius=p;const N=this.size=b+4*l,G=this._createCanvas(N),$=this.ctx=G.getContext("2d",{willReadFrequently:!0});$.font=`${z} ${P} ${b}px ${E}`,$.textBaseline="alphabetic",$.textAlign="left",$.fillStyle="black",this.gridOuter=new Float64Array(N*N),this.gridInner=new Float64Array(N*N),this.f=new Float64Array(N),this.z=new Float64Array(N+1),this.v=new Uint16Array(N)}_createCanvas(b){const l=document.createElement("canvas");return l.width=l.height=b,l}draw(b){const{width:l,actualBoundingBoxAscent:p,actualBoundingBoxDescent:v,actualBoundingBoxLeft:E,actualBoundingBoxRight:P}=this.ctx.measureText(b),z=Math.ceil(p),N=Math.min(this.size-this.buffer,Math.ceil(P-E)),G=Math.min(this.size-this.buffer,z+Math.ceil(v)),$=N+2*this.buffer,K=G+2*this.buffer,se=Math.max($*K,0),ce=new Uint8ClampedArray(se),xe={data:ce,width:$,height:K,glyphWidth:N,glyphHeight:G,glyphTop:z,glyphLeft:0,glyphAdvance:l};if(N===0||G===0)return xe;const{ctx:ve,buffer:le,gridInner:ye,gridOuter:ze}=this;ve.clearRect(le,le,N,G),ve.fillText(b,le,le+z);const je=ve.getImageData(le,le,N,G);ze.fill(ie,0,se),ye.fill(0,0,se);for(let Se=0;Se<G;Se++)for(let Xe=0;Xe<N;Xe++){const He=je.data[4*(Se*N+Xe)+3]/255;if(He===0)continue;const it=(Se+le)*$+Xe+le;if(He===1)ze[it]=0,ye[it]=ie;else{const Je=.5-He;ze[it]=Je>0?Je*Je:0,ye[it]=Je<0?Je*Je:0}}re(ze,0,0,$,K,$,this.f,this.v,this.z),re(ye,le,le,N,G,$,this.f,this.v,this.z);for(let Se=0;Se<se;Se++){const Xe=Math.sqrt(ze[Se])-Math.sqrt(ye[Se]);ce[Se]=Math.round(255-255*(Xe/this.radius+this.cutoff))}return xe}};const De=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(b,l){return a.sphericalToCartesian(b.expression.evaluate(l))}interpolate(b,l,p){return{x:a.number(b.x,l.x,p),y:a.number(b.y,l.y,p),z:a.number(b.z,l.z,p)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),qe="-transition";class et extends a.Evented{constructor(l){super(),this._transitionable=new a.Transitionable(De),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,p={}){if(!this._validate(a.validateLight,l,p))for(const v in l){const E=l[v];v.endsWith(qe)?this._transitionable.setTransition(v.slice(0,-qe.length),E):this._transitionable.setValue(v,E)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,v){return(!v||v.validate!==!1)&&a.emitValidationErrors(this,l.call(a.validateStyle,a.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class ht{constructor(l,p){this.width=l,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,p){const v=l.join(",")+String(p);return this.dashEntry[v]||(this.dashEntry[v]=this.addDash(l,p)),this.dashEntry[v]}getDashRanges(l,p,v){const E=[];let P=l.length%2==1?-l[l.length-1]*v:0,z=l[0]*v,N=!0;E.push({left:P,right:z,isDash:N,zeroLength:l[0]===0});let G=l[0];for(let $=1;$<l.length;$++){N=!N;const K=l[$];P=G*v,G+=K,z=G*v,E.push({left:P,right:z,isDash:N,zeroLength:K===0})}return E}addRoundDash(l,p,v){const E=p/2;for(let P=-v;P<=v;P++){const z=this.width*(this.nextRow+v+P);let N=0,G=l[N];for(let $=0;$<this.width;$++){$/G.right>1&&(G=l[++N]);const K=Math.abs($-G.left),se=Math.abs($-G.right),ce=Math.min(K,se);let xe;const ve=P/v*(E+1);if(G.isDash){const le=E-Math.abs(ve);xe=Math.sqrt(ce*ce+le*le)}else xe=E-Math.sqrt(ce*ce+ve*ve);this.data[z+$]=Math.max(0,Math.min(255,xe+128))}}}addRegularDash(l){for(let N=l.length-1;N>=0;--N){const G=l[N],$=l[N+1];G.zeroLength?l.splice(N,1):$&&$.isDash===G.isDash&&($.left=G.left,l.splice(N,1))}const p=l[0],v=l[l.length-1];p.isDash===v.isDash&&(p.left=v.left-this.width,v.right=p.right+this.width);const E=this.width*this.nextRow;let P=0,z=l[P];for(let N=0;N<this.width;N++){N/z.right>1&&(z=l[++P]);const G=Math.abs(N-z.left),$=Math.abs(N-z.right),K=Math.min(G,$);this.data[E+N]=Math.max(0,Math.min(255,(z.isDash?K:-K)+128))}}addDash(l,p){const v=p?7:0,E=2*v+1;if(this.nextRow+E>this.height)return a.warnOnce("LineAtlas out of space"),null;let P=0;for(let N=0;N<l.length;N++)P+=l[N];if(P!==0){const N=this.width/P,G=this.getDashRanges(l,this.width,N);p?this.addRoundDash(G,N,v):this.addRegularDash(G)}const z={y:(this.nextRow+v+.5)/this.height,height:2*v/this.height,width:P};return this.nextRow+=E,this.dirty=!0,z}bind(l){const p=l.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))}}class ot{constructor(l,p){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const v=this.workerPool.acquire(this.id);for(let E=0;E<v.length;E++){const P=new ot.Actor(v[E],p,this.id);P.name=`Worker ${E}`,this.actors.push(P)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,p,v){a.asyncAll(this.actors,(E,P)=>{E.send(l,p,P)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function at(b,l,p){const v=function(E,P){if(E)return p(E);if(P){const z=a.pick(a.extend(P,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(z.vectorLayers=P.vector_layers,z.vectorLayerIds=z.vectorLayers.map(N=>N.id)),p(null,z)}};return b.url?a.getJSON(l.transformRequest(b.url,a.ResourceType.Source),v):a.exported.frame(()=>v(null,b))}ot.Actor=a.Actor;class Mt{constructor(l,p,v){this.bounds=a.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=p||0,this.maxzoom=v||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const p=Math.pow(2,l.z),v=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*p),E=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*p),P=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*p),z=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*p);return l.x>=v&&l.x<P&&l.y>=E&&l.y<z}}class ut extends a.Evented{constructor(l,p,v,E){if(super(),this.id=l,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(p,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(E)}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=at(this._options,this.map._requestManager,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l?this.fire(new a.ErrorEvent(l)):p&&(a.extend(this,p),p.bounds&&(this.tileBounds=new Mt(p.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(l,p){const v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),E={request:this.map._requestManager.transformRequest(v,a.ResourceType.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function P(z,N){return delete l.request,l.aborted?p(null):z&&z.status!==404?p(z):(N&&N.resourceTiming&&(l.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&l.setExpiryData(N),l.loadVectorData(N,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}E.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired"?l.state==="loading"?l.reloadCallback=p:l.request=l.actor.send("reloadTile",E,P.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",E,P.bind(this)))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class St extends a.Evented{constructor(l,p,v,E){super(),this.id=l,this.dispatcher=v,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},p),a.extend(this,a.pick(p,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=at(this._options,this.map._requestManager,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new a.ErrorEvent(l)):p&&(a.extend(this,p),p.bounds&&(this.tileBounds=new Mt(p.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,p){const v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.request=a.getImage(this.map._requestManager.transformRequest(v,a.ResourceType.Tile),(E,P,z)=>{if(delete l.request,l.aborted)l.state="unloaded",p(null);else if(E)l.state="errored",p(E);else if(P){this.map._refreshExpiredTiles&&l.setExpiryData(z);const N=this.map.painter.context,G=N.gl;l.texture=this.map.painter.getTileTexture(P.width),l.texture?l.texture.update(P,{useMipmap:!0}):(l.texture=new ne(N,P,G.RGBA,{useMipmap:!0}),l.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),N.extTextureFilterAnisotropic&&G.texParameterf(G.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax)),l.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),p(null)}})}abortTile(l,p){l.request&&(l.request.cancel(),delete l.request),p()}unloadTile(l,p){l.texture&&this.map.painter.saveTileTexture(l.texture),p()}hasTransition(){return!1}}let Pn;class Ot extends St{constructor(l,p,v,E){super(l,p,v,E),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(l,p){const v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function E(P,z){P&&(l.state="errored",p(P)),z&&(l.dem=z,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded",p(null))}l.request=a.getImage(this.map._requestManager.transformRequest(v,a.ResourceType.Tile),function(P,z){if(delete l.request,l.aborted)l.state="unloaded",p(null);else if(P)l.state="errored",p(P);else if(z){this.map._refreshExpiredTiles&&l.setExpiryData(z),delete z.cacheControl,delete z.expires;const N=a.isImageBitmap(z)&&(Pn==null&&(Pn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Pn)?z:a.exported.getImageData(z,1),G={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:N,encoding:this.encoding};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",G,E.bind(this)))}}.bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)}_getNeighboringTiles(l){const p=l.canonical,v=Math.pow(2,p.z),E=(p.x-1+v)%v,P=p.x===0?l.wrap-1:l.wrap,z=(p.x+1+v)%v,N=p.x+1===v?l.wrap+1:l.wrap,G={};return G[new a.OverscaledTileID(l.overscaledZ,P,p.z,E,p.y).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,N,p.z,z,p.y).key]={backfilled:!1},p.y>0&&(G[new a.OverscaledTileID(l.overscaledZ,P,p.z,E,p.y-1).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,l.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,N,p.z,z,p.y-1).key]={backfilled:!1}),p.y+1<v&&(G[new a.OverscaledTileID(l.overscaledZ,P,p.z,E,p.y+1).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,l.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},G[new a.OverscaledTileID(l.overscaledZ,N,p.z,z,p.y+1).key]={backfilled:!1}),G}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})}}class Gn extends a.Evented{constructor(l,p,v,E){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=v.getActor(),this.setEventedParent(E),this._data=p.data,this._options=a.extend({},p),this._collectResourceTiming=p.collectResourceTiming,p.maxzoom!==void 0&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId;const P=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:(p.buffer!==void 0?p.buffer:128)*P,tolerance:(p.tolerance!==void 0?p.tolerance:.375)*P,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:p.clusterMaxZoom!==void 0?p.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,p.clusterMinPoints||2),extent:a.EXTENT,radius:(p.clusterRadius||50)*P,log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData("content"),this}getClusterExpansionZoom(l,p){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},p),this}getClusterChildren(l,p){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},p),this}getClusterLeaves(l,p,v,E){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:p,offset:v},E),this}_updateWorkerData(l){const p=a.extend({},this.workerOptions),v=this._data;typeof v=="string"?(p.request=this.map._requestManager.transformRequest(a.exported.resolveURL(v),a.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(v),this._pendingLoads++,this.fire(new a.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,p,(E,P)=>{if(this._pendingLoads--,this._removed||P&&P.abandoned)return void this.fire(new a.Event("dataabort",{dataType:"source",sourceDataType:l}));let z=null;if(P&&P.resourceTiming&&P.resourceTiming[this.id]&&(z=P.resourceTiming[this.id].slice(0)),E)return void this.fire(new a.ErrorEvent(E));const N={dataType:"source",sourceDataType:l};this._collectResourceTiming&&z&&z.length>0&&a.extend(N,{resourceTiming:z}),this.fire(new a.Event("data",N))})}loaded(){return this._pendingLoads===0}loadTile(l,p){const v=l.actor?"reloadTile":"loadTile";l.actor=this.actor;const E={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.request=this.actor.send(v,E,(P,z)=>(delete l.request,l.unloadVectorData(),l.aborted?p(null):P?p(P):(l.loadVectorData(z,this.map.painter,v==="reloadTile"),p(null))))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var vt=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Bt extends a.Evented{constructor(l,p,v,E){super(),this.id=l,this.dispatcher=v,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=p}load(l,p){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(v,E)=>{this._loaded=!0,v?this.fire(new a.ErrorEvent(v)):E&&(this.image=E,l&&(this.coordinates=l),p&&p(),this._finishLoading())})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}setCoordinates(l){this.coordinates=l;const p=l.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(E){let P=1/0,z=1/0,N=-1/0,G=-1/0;for(const ce of E)P=Math.min(P,ce.x),z=Math.min(z,ce.y),N=Math.max(N,ce.x),G=Math.max(G,ce.y);const $=Math.max(N-P,G-z),K=Math.max(0,Math.floor(-Math.log($)/Math.LN2)),se=Math.pow(2,K);return new a.CanonicalTileID(K,Math.floor((P+N)/2*se),Math.floor((z+G)/2*se))}(p),this.minzoom=this.maxzoom=this.tileID.z;const v=p.map(E=>this.tileID.getTilePoint(E)._round());return this._boundsArray=new a.RasterBoundsArray,this._boundsArray.emplaceBack(v[0].x,v[0].y,0,0),this._boundsArray.emplaceBack(v[1].x,v[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(v[3].x,v[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(v[2].x,v[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,p=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ne(l,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));for(const v in this.tiles){const E=this.tiles[v];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}loadTile(l,p){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},p(null)):(l.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Qt extends Bt{constructor(l,p,v,E){super(l,p,v,E),this.roundZoom=!0,this.type="video",this.options=p}load(){this._loaded=!1;const l=this.options;this.urls=[];for(const p of l.urls)this.urls.push(this.map._requestManager.transformRequest(p,a.ResourceType.Source).url);a.getVideo(this.urls,(p,v)=>{this._loaded=!0,p?this.fire(new a.ErrorEvent(p)):v&&(this.video=v,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const p=this.video.seekable;l<p.start(0)||l>p.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${p.start(0)} and ${p.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,p=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new ne(l,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));for(const v in this.tiles){const E=this.tiles[v];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Mn extends Bt{constructor(l,p,v,E){super(l,p,v,E),p.coordinates?Array.isArray(p.coordinates)&&p.coordinates.length===4&&!p.coordinates.some(P=>!Array.isArray(P)||P.length!==2||P.some(z=>typeof z!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'missing required property "coordinates"'))),p.animate&&typeof p.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),p.canvas?typeof p.canvas=="string"||p.canvas instanceof HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${l}`,null,'missing required property "canvas"'))),this.options=p,this.animate=p.animate===void 0||p.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const p=this.map.painter.context,v=p.gl;this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ne(p,this.canvas,v.RGBA,{premultiply:!0});for(const E in this.tiles){const P=this.tiles[E];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const bn={vector:ut,raster:St,"raster-dem":Ot,geojson:Gn,video:Qt,image:Bt,canvas:Mn};function pn(b,l){const p=a.create();return a.translate(p,p,[1,1,0]),a.scale(p,p,[.5*b.width,.5*b.height,1]),a.multiply(p,p,b.calculatePosMatrix(l.toUnwrapped()))}function Nn(b,l,p,v,E,P){const z=function(se,ce,xe){if(se)for(const ve of se){const le=ce[ve];if(le&&le.source===xe&&le.type==="fill-extrusion")return!0}else for(const ve in ce){const le=ce[ve];if(le.source===xe&&le.type==="fill-extrusion")return!0}return!1}(E&&E.layers,l,b.id),N=P.maxPitchScaleFactor(),G=b.tilesIn(v,N,z);G.sort(ti);const $=[];for(const se of G)$.push({wrappedTileID:se.tileID.wrapped().key,queryResults:se.tile.queryRenderedFeatures(l,p,b._state,se.queryGeometry,se.cameraQueryGeometry,se.scale,E,P,N,pn(b.transform,se.tileID))});const K=function(se){const ce={},xe={};for(const ve of se){const le=ve.queryResults,ye=ve.wrappedTileID,ze=xe[ye]=xe[ye]||{};for(const je in le){const Se=le[je],Xe=ze[je]=ze[je]||{},He=ce[je]=ce[je]||[];for(const it of Se)Xe[it.featureIndex]||(Xe[it.featureIndex]=!0,He.push(it))}}return ce}($);for(const se in K)K[se].forEach(ce=>{const xe=ce.feature,ve=b.getFeatureState(xe.layer["source-layer"],xe.id);xe.source=xe.layer.source,xe.layer["source-layer"]&&(xe.sourceLayer=xe.layer["source-layer"]),xe.state=ve});return K}function ti(b,l){const p=b.tileID,v=l.tileID;return p.overscaledZ-v.overscaledZ||p.canonical.y-v.canonical.y||p.wrap-v.wrap||p.canonical.x-v.canonical.x}class Ue{constructor(l,p){this.tileID=l,this.uid=a.uniqueId(),this.uses=0,this.tileSize=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const p=l+this.timeAdded;p<a.exported.now()||this.fadeEndTime&&p<this.fadeEndTime||(this.fadeEndTime=p)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.textures.forEach(p=>l.saveTileTexture(p)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(l,p,v){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(E,P){const z={};if(!P)return z;for(const N of E){const G=N.layerIds.map($=>P.getLayer($)).filter(Boolean);if(G.length!==0){N.layers=G,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map($=>G.filter(K=>K.id===$)[0]));for(const $ of G)z[$.id]=N}}return z}(l.buckets,p.style),this.hasSymbolBuckets=!1;for(const E in this.buckets){const P=this.buckets[E];if(P instanceof a.SymbolBucket){if(this.hasSymbolBuckets=!0,!v)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const E in this.buckets){const P=this.buckets[E];if(P instanceof a.SymbolBucket&&P.hasRTLText){this.hasRTLText=!0,a.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const E in this.buckets){const P=this.buckets[E];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(E).queryRadius(P))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new a.CollisionBoxArray}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const v in this.buckets){const E=this.buckets[v];E.uploadPending()&&E.upload(l)}const p=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ne(l,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ne(l,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,p,v,E,P,z,N,G,$,K){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:E,cameraQueryGeometry:P,scale:z,tileSize:this.tileSize,pixelPosMatrix:K,transform:G,params:N,queryPadding:this.queryPadding*$},l,p,v):{}}querySourceFeatures(l,p){const v=this.latestFeatureIndex;if(!v||!v.rawTileData)return;const E=v.loadVTLayers(),P=p?p.sourceLayer:"",z=E._geojsonTileLayer||E[P];if(!z)return;const N=a.createFilter(p&&p.filter),{z:G,x:$,y:K}=this.tileID.canonical,se={z:G,x:$,y:K};for(let ce=0;ce<z.length;ce++){const xe=z.feature(ce);if(N.needGeometry){const ye=a.toEvaluationFeature(xe,!0);if(!N.filter(new a.EvaluationParameters(this.tileID.overscaledZ),ye,this.tileID.canonical))continue}else if(!N.filter(new a.EvaluationParameters(this.tileID.overscaledZ),xe))continue;const ve=v.getId(xe,P),le=new a.GeoJSONFeature(xe,G,$,K,ve);le.tile=se,l.push(le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const p=this.expirationTime;if(l.cacheControl){const v=a.parseCacheControl(l.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const v=Date.now();let E=!1;if(this.expirationTime>v)E=!1;else if(p)if(this.expirationTime<p)E=!0;else{const P=this.expirationTime-p;P?this.expirationTime=v+Math.max(P,3e4):E=!0}else E=!0;E?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,p){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const v=this.latestFeatureIndex.loadVTLayers();for(const E in this.buckets){if(!p.style.hasLayer(E))continue;const P=this.buckets[E],z=P.layers[0].sourceLayer||"_geojsonTileLayer",N=v[z],G=l[z];if(!N||!G||Object.keys(G).length===0)continue;P.update(G,N,this.imageAtlas&&this.imageAtlas.patternPositions||{});const $=p&&p.style&&p.style.getLayer(E);$&&(this.queryPadding=Math.max(this.queryPadding,$.queryRadius(P)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=a.exported.now()+l}setDependencies(l,p){const v={};for(const E of p)v[E]=!0;this.dependencies[l]=v}hasDependency(l,p){for(const v of l){const E=this.dependencies[v];if(E){for(const P of p)if(E[P])return!0}}return!1}}class An{constructor(l,p){this.max=l,this.onRemove=p,this.reset()}reset(){for(const l in this.data)for(const p of this.data[l])p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value);return this.data={},this.order=[],this}add(l,p,v){const E=l.wrapped().key;this.data[E]===void 0&&(this.data[E]=[]);const P={value:p,timeout:void 0};if(v!==void 0&&(P.timeout=setTimeout(()=>{this.remove(l,P)},v)),this.data[E].push(P),this.order.push(E),this.order.length>this.max){const z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const p=this.data[l].shift();return p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),p.value}getByKey(l){const p=this.data[l];return p?p[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,p){if(!this.has(l))return this;const v=l.wrapped().key,E=p===void 0?0:this.data[v].indexOf(p),P=this.data[v][E];return this.data[v].splice(E,1),P.timeout&&clearTimeout(P.timeout),this.data[v].length===0&&delete this.data[v],this.onRemove(P.value),this.order.splice(this.order.indexOf(v),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}filter(l){const p=[];for(const v in this.data)for(const E of this.data[v])l(E.value)||p.push(E);for(const v of p)this.remove(v.value.tileID,v)}}class Un{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,p,v){const E=String(p);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][E]=this.stateChanges[l][E]||{},a.extend(this.stateChanges[l][E],v),this.deletedStates[l]===null){this.deletedStates[l]={};for(const P in this.state[l])P!==E&&(this.deletedStates[l][P]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][E]===null){this.deletedStates[l][E]={};for(const P in this.state[l][E])v[P]||(this.deletedStates[l][E][P]=null)}else for(const P in v)this.deletedStates[l]&&this.deletedStates[l][E]&&this.deletedStates[l][E][P]===null&&delete this.deletedStates[l][E][P]}removeFeatureState(l,p,v){if(this.deletedStates[l]===null)return;const E=String(p);if(this.deletedStates[l]=this.deletedStates[l]||{},v&&p!==void 0)this.deletedStates[l][E]!==null&&(this.deletedStates[l][E]=this.deletedStates[l][E]||{},this.deletedStates[l][E][v]=null);else if(p!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][E])for(v in this.deletedStates[l][E]={},this.stateChanges[l][E])this.deletedStates[l][E][v]=null;else this.deletedStates[l][E]=null;else this.deletedStates[l]=null}getState(l,p){const v=String(p),E=a.extend({},(this.state[l]||{})[v],(this.stateChanges[l]||{})[v]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const P=this.deletedStates[l][p];if(P===null)return{};for(const z in P)delete E[z]}return E}initializeTileState(l,p){l.setFeatureState(this.state,p)}coalesceChanges(l,p){const v={};for(const E in this.stateChanges){this.state[E]=this.state[E]||{};const P={};for(const z in this.stateChanges[E])this.state[E][z]||(this.state[E][z]={}),a.extend(this.state[E][z],this.stateChanges[E][z]),P[z]=this.state[E][z];v[E]=P}for(const E in this.deletedStates){this.state[E]=this.state[E]||{};const P={};if(this.deletedStates[E]===null)for(const z in this.state[E])P[z]={},this.state[E][z]={};else for(const z in this.deletedStates[E]){if(this.deletedStates[E][z]===null)this.state[E][z]={};else for(const N of Object.keys(this.deletedStates[E][z]))delete this.state[E][z][N];P[z]=this.state[E][z]}v[E]=v[E]||{},a.extend(v[E],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(const E in l)l[E].setFeatureState(v,p)}}class At extends a.Evented{constructor(l,p,v){super(),this.id=l,this.dispatcher=v,this.on("data",E=>{E.dataType==="source"&&E.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&E.dataType==="source"&&E.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(E,P,z,N){const G=new bn[P.type](E,P,z,N);if(G.id!==E)throw new Error(`Expected Source id to be ${E} instead of ${G.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],G),G}(l,p,v,this),this._tiles={},this._cache=new An(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Un}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const l in this._tiles){const p=this._tiles[l];if(p.state!=="loaded"&&p.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,p){return this._source.loadTile(l,p)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l,()=>{})}_abortTile(l){this._source.abortTile&&this._source.abortTile(l,()=>{}),this._source.fire(new a.Event("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const p in this._tiles){const v=this._tiles[p];v.upload(l),v.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Xt).map(l=>l.key)}getRenderableIds(l){const p=[];for(const v in this._tiles)this._isIdRenderable(v,l)&&p.push(this._tiles[v]);return l?p.sort((v,E)=>{const P=v.tileID,z=E.tileID,N=new a.pointGeometry(P.canonical.x,P.canonical.y)._rotate(this.transform.angle),G=new a.pointGeometry(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return P.overscaledZ-z.overscaledZ||G.y-N.y||G.x-N.x}).map(v=>v.tileID.key):p.map(v=>v.tileID).sort(Xt).map(v=>v.key)}hasRenderableParent(l){const p=this.findLoadedParent(l,0);return!!p&&this._isIdRenderable(p.tileID.key)}_isIdRenderable(l,p){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(p||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,p){const v=this._tiles[l];v&&(v.state!=="loading"&&(v.state=p),this._loadTile(v,this._tileLoaded.bind(this,v,l,p)))}_tileLoaded(l,p,v,E){if(E)return l.state="errored",void(E.status!==404?this._source.fire(new a.ErrorEvent(E,{tile:l})):this.update(this.transform,this.terrain));l.timeAdded=a.exported.now(),v==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(p,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new a.Event("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const p=this.getRenderableIds();for(let E=0;E<p.length;E++){const P=p[E];if(l.neighboringTiles&&l.neighboringTiles[P]){const z=this.getTileByID(P);v(l,z),v(z,l)}}function v(E,P){E.needsHillshadePrepare=!0,E.needsTerrainPrepare=!0;let z=P.tileID.canonical.x-E.tileID.canonical.x;const N=P.tileID.canonical.y-E.tileID.canonical.y,G=Math.pow(2,E.tileID.canonical.z),$=P.tileID.key;z===0&&N===0||Math.abs(N)>1||(Math.abs(z)>1&&(Math.abs(z+G)===1?z+=G:Math.abs(z-G)===1&&(z-=G)),P.dem&&E.dem&&(E.dem.backfillBorder(P.dem,z,N),E.neighboringTiles&&E.neighboringTiles[$]&&(E.neighboringTiles[$].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,p,v,E){for(const P in this._tiles){let z=this._tiles[P];if(E[P]||!z.hasData()||z.tileID.overscaledZ<=p||z.tileID.overscaledZ>v)continue;let N=z.tileID;for(;z&&z.tileID.overscaledZ>p+1;){const $=z.tileID.scaledTo(z.tileID.overscaledZ-1);z=this._tiles[$.key],z&&z.hasData()&&(N=$)}let G=N;for(;G.overscaledZ>p;)if(G=G.scaledTo(G.overscaledZ-1),l[G.key]){E[N.key]=N;break}}}findLoadedParent(l,p){if(l.key in this._loadedParentTiles){const v=this._loadedParentTiles[l.key];return v&&v.tileID.overscaledZ>=p?v:null}for(let v=l.overscaledZ-1;v>=p;v--){const E=l.scaledTo(v),P=this._getLoadedTile(E);if(P)return P}}_getLoadedTile(l){const p=this._tiles[l.key];return p&&p.hasData()?p:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const p=Math.ceil(l.width/this._source.tileSize)+1,v=Math.ceil(l.height/this._source.tileSize)+1,E=Math.floor(p*v*5),P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(P)}handleWrapJump(l){const p=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,p){const v={};for(const E in this._tiles){const P=this._tiles[E];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+p),v[P.tileID.key]=P}this._tiles=v;for(const E in this._timers)clearTimeout(this._timers[E]),delete this._timers[E];for(const E in this._tiles)this._setTileReloadTimer(E,this._tiles[E])}}update(l,p){if(this.transform=l,this.terrain=p,!this._sourceLoaded||this._paused)return;let v;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?v=l.getVisibleUnwrappedCoordinates(this._source.tileID).map($=>new a.OverscaledTileID($.canonical.z,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y)):(v=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:p}),this._source.hasTile&&(v=v.filter($=>this._source.hasTile($)))):v=[];const E=l.coveringZoomLevel(this._source),P=Math.max(E-At.maxOverzooming,this._source.minzoom),z=Math.max(E+At.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const $={};for(const K of v)if(K.canonical.z>this._source.minzoom){const se=K.scaledTo(K.canonical.z-1);$[se.key]=se;const ce=K.scaledTo(Math.max(this._source.minzoom,Math.min(K.canonical.z,5)));$[ce.key]=ce}v=v.concat(Object.values($))}const N=this._updateRetainedTiles(v,E);if(yn(this._source.type)){const $={},K={},se=Object.keys(N);for(const ce of se){const xe=N[ce],ve=this._tiles[ce];if(!ve||ve.fadeEndTime&&ve.fadeEndTime<=a.exported.now())continue;const le=this.findLoadedParent(xe,P);le&&(this._addTile(le.tileID),$[le.tileID.key]=le.tileID),K[ce]=xe}this._retainLoadedChildren(K,E,z,N);for(const ce in $)N[ce]||(this._coveredTiles[ce]=!0,N[ce]=$[ce]);if(p){const ce={},xe={};for(const ve of v)this._tiles[ve.key].hasData()?ce[ve.key]=ve:xe[ve.key]=ve;for(const ve in xe){const le=xe[ve].children(this._source.maxzoom);this._tiles[le[0].key]&&this._tiles[le[1].key]&&this._tiles[le[2].key]&&this._tiles[le[3].key]&&(ce[le[0].key]=N[le[0].key]=le[0],ce[le[1].key]=N[le[1].key]=le[1],ce[le[2].key]=N[le[2].key]=le[2],ce[le[3].key]=N[le[3].key]=le[3],delete xe[ve])}for(const ve in xe){const le=this.findLoadedParent(xe[ve],this._source.minzoom);if(le){ce[le.tileID.key]=N[le.tileID.key]=le.tileID;for(const ye in ce)ce[ye].isChildOf(le.tileID)&&delete ce[ye]}}for(const ve in this._tiles)ce[ve]||(this._coveredTiles[ve]=!0)}}for(const $ in N)this._tiles[$].clearFadeHold();const G=a.keysDifference(this._tiles,N);for(const $ of G){const K=this._tiles[$];K.hasSymbolBuckets&&!K.holdingForFade()?K.setHoldDuration(this.map._fadeDuration):K.hasSymbolBuckets&&!K.symbolFadeFinished()||this._removeTile($)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,p){const v={},E={},P=Math.max(p-At.maxOverzooming,this._source.minzoom),z=Math.max(p+At.maxUnderzooming,this._source.minzoom),N={};for(const G of l){const $=this._addTile(G);v[G.key]=G,$.hasData()||p<this._source.maxzoom&&(N[G.key]=G)}this._retainLoadedChildren(N,p,z,v);for(const G of l){let $=this._tiles[G.key];if($.hasData())continue;if(p+1>this._source.maxzoom){const se=G.children(this._source.maxzoom)[0],ce=this.getTile(se);if(ce&&ce.hasData()){v[se.key]=se;continue}}else{const se=G.children(this._source.maxzoom);if(v[se[0].key]&&v[se[1].key]&&v[se[2].key]&&v[se[3].key])continue}let K=$.wasRequested();for(let se=G.overscaledZ-1;se>=P;--se){const ce=G.scaledTo(se);if(E[ce.key]||(E[ce.key]=!0,$=this.getTile(ce),!$&&K&&($=this._addTile(ce)),$&&(v[ce.key]=ce,K=$.wasRequested(),$.hasData())))break}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const p=[];let v,E=this._tiles[l].tileID;for(;E.overscaledZ>0;){if(E.key in this._loadedParentTiles){v=this._loadedParentTiles[E.key];break}p.push(E.key);const P=E.scaledTo(E.overscaledZ-1);if(v=this._getLoadedTile(P),v)break;E=P}for(const P of p)this._loadedParentTiles[P]=v}}_addTile(l){let p=this._tiles[l.key];if(p)return p;p=this._cache.getAndRemove(l),p&&(this._setTileReloadTimer(l.key,p),p.tileID=l,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,p)));const v=p;return p||(p=new Ue(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(p,this._tileLoaded.bind(this,p,l.key,p.state))),p.uses++,this._tiles[l.key]=p,v||this._source.fire(new a.Event("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p}_setTileReloadTimer(l,p){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const v=p.getExpiryTimeout();v&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},v))}_removeTile(l){const p=this._tiles[l];p&&(p.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),p.uses>0||(p.hasData()&&p.state!=="reloading"?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,p,v){const E=[],P=this.transform;if(!P)return E;const z=v?P.getCameraQueryGeometry(l):l,N=l.map(ve=>P.pointCoordinate(ve,this.terrain)),G=z.map(ve=>P.pointCoordinate(ve,this.terrain)),$=this.getIds();let K=1/0,se=1/0,ce=-1/0,xe=-1/0;for(const ve of G)K=Math.min(K,ve.x),se=Math.min(se,ve.y),ce=Math.max(ce,ve.x),xe=Math.max(xe,ve.y);for(let ve=0;ve<$.length;ve++){const le=this._tiles[$[ve]];if(le.holdingForFade())continue;const ye=le.tileID,ze=Math.pow(2,P.zoom-le.tileID.overscaledZ),je=p*le.queryPadding*a.EXTENT/le.tileSize/ze,Se=[ye.getTilePoint(new a.MercatorCoordinate(K,se)),ye.getTilePoint(new a.MercatorCoordinate(ce,xe))];if(Se[0].x-je<a.EXTENT&&Se[0].y-je<a.EXTENT&&Se[1].x+je>=0&&Se[1].y+je>=0){const Xe=N.map(it=>ye.getTilePoint(it)),He=G.map(it=>ye.getTilePoint(it));E.push({tile:le,tileID:ye,queryGeometry:Xe,cameraQueryGeometry:He,scale:ze})}}return E}getVisibleCoordinates(l){const p=this.getRenderableIds(l).map(v=>this._tiles[v].tileID);for(const v of p)v.posMatrix=this.transform.calculatePosMatrix(v.toUnwrapped());return p}hasTransition(){if(this._source.hasTransition())return!0;if(yn(this._source.type))for(const l in this._tiles){const p=this._tiles[l];if(p.fadeEndTime!==void 0&&p.fadeEndTime>=a.exported.now())return!0}return!1}setFeatureState(l,p,v){this._state.updateState(l=l||"_geojsonTileLayer",p,v)}removeFeatureState(l,p,v){this._state.removeFeatureState(l=l||"_geojsonTileLayer",p,v)}getFeatureState(l,p){return this._state.getState(l=l||"_geojsonTileLayer",p)}setDependencies(l,p,v){const E=this._tiles[l];E&&E.setDependencies(p,v)}reloadTilesForDependencies(l,p){for(const v in this._tiles)this._tiles[v].hasDependency(l,p)&&this._reloadTile(v,"reloading");this._cache.filter(v=>!v.hasDependency(l,p))}}function Xt(b,l){const p=Math.abs(2*b.wrap)-+(b.wrap<0),v=Math.abs(2*l.wrap)-+(l.wrap<0);return b.overscaledZ-l.overscaledZ||v-p||l.canonical.y-b.canonical.y||l.canonical.x-b.canonical.x}function yn(b){return b==="raster"||b==="image"||b==="video"}At.maxOverzooming=10,At.maxUnderzooming=3;const mt="mapboxgl_preloaded_worker_pool";class jn{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<jn.workerCount;)this.workers.push(new Worker(Jo.workerUrl));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[mt]}numActive(){return Object.keys(this.active).length}}const Bn=Math.floor(a.exported.hardwareConcurrency/2);let li;function ei(){return li||(li=new jn),li}function ci(b,l){const p={};for(const v in b)v!=="ref"&&(p[v]=b[v]);return a.refProperties.forEach(v=>{v in l&&(p[v]=l[v])}),p}function hr(b){b=b.slice();const l=Object.create(null);for(let p=0;p<b.length;p++)l[b[p].id]=b[p];for(let p=0;p<b.length;p++)"ref"in b[p]&&(b[p]=ci(b[p],l[b[p].ref]));return b}jn.workerCount=Math.max(Math.min(Bn,6),1);const Dn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function fr(b,l,p){p.push({command:Dn.addSource,args:[b,l[b]]})}function ni(b,l,p){l.push({command:Dn.removeSource,args:[b]}),p[b]=!0}function Wr(b,l,p,v){ni(b,p,v),fr(b,l,p)}function yo(b,l,p){let v;for(v in b[p])if(Object.prototype.hasOwnProperty.call(b[p],v)&&v!=="data"&&!R(b[p][v],l[p][v]))return!1;for(v in l[p])if(Object.prototype.hasOwnProperty.call(l[p],v)&&v!=="data"&&!R(b[p][v],l[p][v]))return!1;return!0}function sr(b,l,p,v,E,P){let z;for(z in l=l||{},b=b||{})Object.prototype.hasOwnProperty.call(b,z)&&(R(b[z],l[z])||p.push({command:P,args:[v,z,l[z],E]}));for(z in l)Object.prototype.hasOwnProperty.call(l,z)&&!Object.prototype.hasOwnProperty.call(b,z)&&(R(b[z],l[z])||p.push({command:P,args:[v,z,l[z],E]}))}function Lr(b){return b.id}function vo(b,l){return b[l.id]=l,b}class $r{constructor(l,p){this.reset(l,p)}reset(l,p){this.points=l||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=a.clamp(l,0,1);let p=1,v=this._distances[p];const E=l*this.paddedLength+this.padding;for(;v<E&&p<this._distances.length;)v=this._distances[++p];const P=p-1,z=this._distances[P],N=v-z,G=N>0?(E-z)/N:0;return this.points[P].mult(1-G).add(this.points[p].mult(G))}}function nt(b,l){let p=!0;return b==="always"||b!=="never"&&l!=="never"||(p=!1),p}class wt{constructor(l,p,v){const E=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(l/v),this.yCellCount=Math.ceil(p/v);for(let z=0;z<this.xCellCount*this.yCellCount;z++)E.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=p,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,p,v,E,P){this._forEachCell(p,v,E,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(E),this.bboxes.push(P)}insertCircle(l,p,v,E){this._forEachCell(p-E,v-E,p+E,v+E,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(p),this.circles.push(v),this.circles.push(E)}_insertBoxCell(l,p,v,E,P,z){this.boxCells[P].push(z)}_insertCircleCell(l,p,v,E,P,z){this.circleCells[P].push(z)}_query(l,p,v,E,P,z,N){if(v<0||l>this.width||E<0||p>this.height)return[];const G=[];if(l<=0&&p<=0&&this.width<=v&&this.height<=E){if(P)return[{key:null,x1:l,y1:p,x2:v,y2:E}];for(let $=0;$<this.boxKeys.length;$++)G.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(let $=0;$<this.circleKeys.length;$++){const K=this.circles[3*$],se=this.circles[3*$+1],ce=this.circles[3*$+2];G.push({key:this.circleKeys[$],x1:K-ce,y1:se-ce,x2:K+ce,y2:se+ce})}}else this._forEachCell(l,p,v,E,this._queryCell,G,{hitTest:P,overlapMode:z,seenUids:{box:{},circle:{}}},N);return G}query(l,p,v,E){return this._query(l,p,v,E,!1,null)}hitTest(l,p,v,E,P,z){return this._query(l,p,v,E,!0,P,z).length>0}hitTestCircle(l,p,v,E,P){const z=l-v,N=l+v,G=p-v,$=p+v;if(N<0||z>this.width||$<0||G>this.height)return!1;const K=[];return this._forEachCell(z,G,N,$,this._queryCellCircle,K,{hitTest:!0,overlapMode:E,circle:{x:l,y:p,radius:v},seenUids:{box:{},circle:{}}},P),K.length>0}_queryCell(l,p,v,E,P,z,N,G){const{seenUids:$,hitTest:K,overlapMode:se}=N,ce=this.boxCells[P];if(ce!==null){const ve=this.bboxes;for(const le of ce)if(!$.box[le]){$.box[le]=!0;const ye=4*le,ze=this.boxKeys[le];if(l<=ve[ye+2]&&p<=ve[ye+3]&&v>=ve[ye+0]&&E>=ve[ye+1]&&(!G||G(ze))&&(!K||!nt(se,ze.overlapMode))&&(z.push({key:ze,x1:ve[ye],y1:ve[ye+1],x2:ve[ye+2],y2:ve[ye+3]}),K))return!0}}const xe=this.circleCells[P];if(xe!==null){const ve=this.circles;for(const le of xe)if(!$.circle[le]){$.circle[le]=!0;const ye=3*le,ze=this.circleKeys[le];if(this._circleAndRectCollide(ve[ye],ve[ye+1],ve[ye+2],l,p,v,E)&&(!G||G(ze))&&(!K||!nt(se,ze.overlapMode))){const je=ve[ye],Se=ve[ye+1],Xe=ve[ye+2];if(z.push({key:ze,x1:je-Xe,y1:Se-Xe,x2:je+Xe,y2:Se+Xe}),K)return!0}}}return!1}_queryCellCircle(l,p,v,E,P,z,N,G){const{circle:$,seenUids:K,overlapMode:se}=N,ce=this.boxCells[P];if(ce!==null){const ve=this.bboxes;for(const le of ce)if(!K.box[le]){K.box[le]=!0;const ye=4*le,ze=this.boxKeys[le];if(this._circleAndRectCollide($.x,$.y,$.radius,ve[ye+0],ve[ye+1],ve[ye+2],ve[ye+3])&&(!G||G(ze))&&!nt(se,ze.overlapMode))return z.push(!0),!0}}const xe=this.circleCells[P];if(xe!==null){const ve=this.circles;for(const le of xe)if(!K.circle[le]){K.circle[le]=!0;const ye=3*le,ze=this.circleKeys[le];if(this._circlesCollide(ve[ye],ve[ye+1],ve[ye+2],$.x,$.y,$.radius)&&(!G||G(ze))&&!nt(se,ze.overlapMode))return z.push(!0),!0}}}_forEachCell(l,p,v,E,P,z,N,G){const $=this._convertToXCellCoord(l),K=this._convertToYCellCoord(p),se=this._convertToXCellCoord(v),ce=this._convertToYCellCoord(E);for(let xe=$;xe<=se;xe++)for(let ve=K;ve<=ce;ve++)if(P.call(this,l,p,v,E,this.xCellCount*ve+xe,z,N,G))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,p,v,E,P,z){const N=E-l,G=P-p,$=v+z;return $*$>N*N+G*G}_circleAndRectCollide(l,p,v,E,P,z,N){const G=(z-E)/2,$=Math.abs(l-(E+G));if($>G+v)return!1;const K=(N-P)/2,se=Math.abs(p-(P+K));if(se>K+v)return!1;if($<=G||se<=K)return!0;const ce=$-G,xe=se-K;return ce*ce+xe*xe<=v*v}}function Ms(b,l,p,v,E){const P=a.create();return l?(a.scale(P,P,[1/E,1/E,1]),p||a.rotateZ(P,P,v.angle)):a.multiply(P,v.labelPlaneMatrix,b),P}function or(b,l,p,v,E){if(l){const P=a.clone(b);return a.scale(P,P,[E,E,1]),p||a.rotateZ(P,P,-v.angle),P}return v.glCoordMatrix}function In(b,l,p){let v;p?(v=[b.x,b.y,p(b.x,b.y),1],a.transformMat4(v,v,l)):(v=[b.x,b.y,0,1],pt(v,v,l));const E=v[3];return{point:new a.pointGeometry(v[0]/E,v[1]/E),signedDistanceFromCamera:E}}function wr(b,l){return .5+b/l*.5}function Ar(b,l){const p=b[0]/b[3],v=b[1]/b[3];return p>=-l[0]&&p<=l[0]&&v>=-l[1]&&v<=l[1]}function dr(b,l,p,v,E,P,z,N,G,$){const K=v?b.textSizeData:b.iconSizeData,se=a.evaluateSizeForZoom(K,p.transform.zoom),ce=[256/p.width*2+1,256/p.height*2+1],xe=v?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;xe.clear();const ve=b.lineVertexArray,le=v?b.text.placedSymbolArray:b.icon.placedSymbolArray,ye=p.transform.width/p.transform.height;let ze=!1;for(let je=0;je<le.length;je++){const Se=le.get(je);if(Se.hidden||Se.writingMode===a.WritingMode.vertical&&!ze){un(Se.numGlyphs,xe);continue}let Xe;if(ze=!1,$?(Xe=[Se.anchorX,Se.anchorY,$(Se.anchorX,Se.anchorY),1],a.transformMat4(Xe,Xe,l)):(Xe=[Se.anchorX,Se.anchorY,0,1],pt(Xe,Xe,l)),!Ar(Xe,ce)){un(Se.numGlyphs,xe);continue}const He=wr(p.transform.cameraToCenterDistance,Xe[3]),it=a.evaluateSizeForFeature(K,se,Se),Je=z?it/He:it*He,d=new a.pointGeometry(Se.anchorX,Se.anchorY),A=In(d,E,$).point,m={},_=mn(Se,Je,!1,N,l,E,P,b.glyphOffsetArray,ve,xe,A,d,m,ye,G,$);ze=_.useVertical,(_.notEnoughRoom||ze||_.needsFlipping&&mn(Se,Je,!0,N,l,E,P,b.glyphOffsetArray,ve,xe,A,d,m,ye,G,$).notEnoughRoom)&&un(Se.numGlyphs,xe)}v?b.text.dynamicLayoutVertexBuffer.updateData(xe):b.icon.dynamicLayoutVertexBuffer.updateData(xe)}function us(b,l,p,v,E,P,z,N,G,$,K,se,ce){const xe=N.glyphStartIndex+N.numGlyphs,ve=N.lineStartIndex,le=N.lineStartIndex+N.lineLength,ye=l.getoffsetX(N.glyphStartIndex),ze=l.getoffsetX(xe-1),je=Ii(b*ye,p,v,E,P,z,N.segment,ve,le,G,$,K,se,ce);if(!je)return null;const Se=Ii(b*ze,p,v,E,P,z,N.segment,ve,le,G,$,K,se,ce);return Se?{first:je,last:Se}:null}function bt(b,l,p,v){return b===a.WritingMode.horizontal&&Math.abs(p.y-l.y)>Math.abs(p.x-l.x)*v?{useVertical:!0}:(b===a.WritingMode.vertical?l.y<p.y:l.x>p.x)?{needsFlipping:!0}:null}function mn(b,l,p,v,E,P,z,N,G,$,K,se,ce,xe,ve,le){const ye=l/24,ze=b.lineOffsetX*ye,je=b.lineOffsetY*ye;let Se;if(b.numGlyphs>1){const Xe=b.glyphStartIndex+b.numGlyphs,He=b.lineStartIndex,it=b.lineStartIndex+b.lineLength,Je=us(ye,N,ze,je,p,K,se,b,G,P,ce,ve,le);if(!Je)return{notEnoughRoom:!0};const d=In(Je.first.point,z,le).point,A=In(Je.last.point,z,le).point;if(v&&!p){const m=bt(b.writingMode,d,A,xe);if(m)return m}Se=[Je.first];for(let m=b.glyphStartIndex+1;m<Xe-1;m++)Se.push(Ii(ye*N.getoffsetX(m),ze,je,p,K,se,b.segment,He,it,G,P,ce,ve,le));Se.push(Je.last)}else{if(v&&!p){const He=In(se,E,le).point,it=b.lineStartIndex+b.segment+1,Je=new a.pointGeometry(G.getx(it),G.gety(it)),d=In(Je,E,le),A=d.signedDistanceFromCamera>0?d.point:dn(se,Je,He,1,E,le),m=bt(b.writingMode,He,A,xe);if(m)return m}const Xe=Ii(ye*N.getoffsetX(b.glyphStartIndex),ze,je,p,K,se,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,G,P,ce,ve,le);if(!Xe)return{notEnoughRoom:!0};Se=[Xe]}for(const Xe of Se)a.addDynamicAttributes($,Xe.point,Xe.angle);return{}}function dn(b,l,p,v,E,P){const z=In(b.add(b.sub(l)._unit()),E,P).point,N=p.sub(z);return p.add(N._mult(v/N.mag()))}function Ii(b,l,p,v,E,P,z,N,G,$,K,se,ce,xe){const ve=v?b-l:b+l;let le=ve>0?1:-1,ye=0;v&&(le*=-1,ye=Math.PI),le<0&&(ye+=Math.PI);let ze=le>0?N+z:N+z+1,je=E,Se=E,Xe=0,He=0;const it=Math.abs(ve),Je=[];for(;Xe+He<=it;){if(ze+=le,ze<N||ze>=G)return null;if(Se=je,Je.push(je),je=se[ze],je===void 0){const x=new a.pointGeometry($.getx(ze),$.gety(ze)),S=In(x,K,xe);if(S.signedDistanceFromCamera>0)je=se[ze]=S.point;else{const M=ze-le;je=dn(Xe===0?P:new a.pointGeometry($.getx(M),$.gety(M)),x,Se,it-Xe+1,K,xe)}}Xe+=He,He=Se.dist(je)}const d=(it-Xe)/He,A=je.sub(Se),m=A.mult(d)._add(Se);m._add(A._unit()._perp()._mult(p*le));const _=ye+Math.atan2(je.y-Se.y,je.x-Se.x);return Je.push(m),{point:m,angle:ce?_:0,path:Je}}const hs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function un(b,l){for(let p=0;p<b;p++){const v=l.length;l.resize(v+4),l.float32.set(hs,3*v)}}function pt(b,l,p){const v=l[0],E=l[1];return b[0]=p[0]*v+p[4]*E+p[12],b[1]=p[1]*v+p[5]*E+p[13],b[3]=p[3]*v+p[7]*E+p[15],b}const zi=100;class $s{constructor(l,p=new wt(l.width+200,l.height+200,25),v=new wt(l.width+200,l.height+200,25)){this.transform=l,this.grid=p,this.ignoredGrid=v,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+zi,this.screenBottomBoundary=l.height+zi,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,p,v,E,P,z){const N=this.projectAndGetPerspectiveRatio(E,l.anchorPointX,l.anchorPointY,z),G=v*N.perspectiveRatio,$=l.x1*G+N.point.x,K=l.y1*G+N.point.y,se=l.x2*G+N.point.x,ce=l.y2*G+N.point.y;return!this.isInsideGrid($,K,se,ce)||p!=="always"&&this.grid.hitTest($,K,se,ce,p,P)||N.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[$,K,se,ce],offscreen:this.isOffscreen($,K,se,ce)}}placeCollisionCircles(l,p,v,E,P,z,N,G,$,K,se,ce,xe,ve){const le=[],ye=new a.pointGeometry(p.anchorX,p.anchorY),ze=In(ye,z,ve),je=wr(this.transform.cameraToCenterDistance,ze.signedDistanceFromCamera),Se=(K?P/je:P*je)/a.ONE_EM,Xe=In(ye,N,ve).point,He=us(Se,E,p.lineOffsetX*Se,p.lineOffsetY*Se,!1,Xe,ye,p,v,N,{},!1,ve);let it=!1,Je=!1,d=!0;if(He){const A=.5*ce*je+xe,m=new a.pointGeometry(-100,-100),_=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),x=new $r,S=He.first,M=He.last;let L=[];for(let ee=S.path.length-1;ee>=1;ee--)L.push(S.path[ee]);for(let ee=1;ee<M.path.length;ee++)L.push(M.path[ee]);const O=2.5*A;if(G){const ee=L.map(Ae=>In(Ae,G,ve));L=ee.some(Ae=>Ae.signedDistanceFromCamera<=0)?[]:ee.map(Ae=>Ae.point)}let H=[];if(L.length>0){const ee=L[0].clone(),Ae=L[0].clone();for(let we=1;we<L.length;we++)ee.x=Math.min(ee.x,L[we].x),ee.y=Math.min(ee.y,L[we].y),Ae.x=Math.max(Ae.x,L[we].x),Ae.y=Math.max(Ae.y,L[we].y);H=ee.x>=m.x&&Ae.x<=_.x&&ee.y>=m.y&&Ae.y<=_.y?[L]:Ae.x<m.x||ee.x>_.x||Ae.y<m.y||ee.y>_.y?[]:a.clipLine([L],m.x,m.y,_.x,_.y)}for(const ee of H){x.reset(ee,.25*A);let Ae=0;Ae=x.length<=.5*A?1:Math.ceil(x.paddedLength/O)+1;for(let we=0;we<Ae;we++){const Re=we/Math.max(Ae-1,1),Te=x.lerp(Re),Be=Te.x+zi,tt=Te.y+zi;le.push(Be,tt,A,0);const Ke=Be-A,We=tt-A,$e=Be+A,Oe=tt+A;if(d=d&&this.isOffscreen(Ke,We,$e,Oe),Je=Je||this.isInsideGrid(Ke,We,$e,Oe),l!=="always"&&this.grid.hitTestCircle(Be,tt,A,l,se)&&(it=!0,!$))return{circles:[],offscreen:!1,collisionDetected:it}}}}return{circles:!$&&it||!Je||je<this.perspectiveRatioCutoff?[]:le,offscreen:d,collisionDetected:it}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[];let v=1/0,E=1/0,P=-1/0,z=-1/0;for(const K of l){const se=new a.pointGeometry(K.x+zi,K.y+zi);v=Math.min(v,se.x),E=Math.min(E,se.y),P=Math.max(P,se.x),z=Math.max(z,se.y),p.push(se)}const N=this.grid.query(v,E,P,z).concat(this.ignoredGrid.query(v,E,P,z)),G={},$={};for(const K of N){const se=K.key;if(G[se.bucketInstanceId]===void 0&&(G[se.bucketInstanceId]={}),G[se.bucketInstanceId][se.featureIndex])continue;const ce=[new a.pointGeometry(K.x1,K.y1),new a.pointGeometry(K.x2,K.y1),new a.pointGeometry(K.x2,K.y2),new a.pointGeometry(K.x1,K.y2)];a.polygonIntersectsPolygon(p,ce)&&(G[se.bucketInstanceId][se.featureIndex]=!0,$[se.bucketInstanceId]===void 0&&($[se.bucketInstanceId]=[]),$[se.bucketInstanceId].push(se.featureIndex))}return $}insertCollisionBox(l,p,v,E,P,z){(v?this.ignoredGrid:this.grid).insert({bucketInstanceId:E,featureIndex:P,collisionGroupID:z,overlapMode:p},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,p,v,E,P,z){const N=v?this.ignoredGrid:this.grid,G={bucketInstanceId:E,featureIndex:P,collisionGroupID:z,overlapMode:p};for(let $=0;$<l.length;$+=4)N.insertCircle(G,l[$],l[$+1],l[$+2])}projectAndGetPerspectiveRatio(l,p,v,E){let P;return E?(P=[p,v,E(p,v),1],a.transformMat4(P,P,l)):(P=[p,v,0,1],pt(P,P,l)),{point:new a.pointGeometry((P[0]/P[3]+1)/2*this.transform.width+zi,(-P[1]/P[3]+1)/2*this.transform.height+zi),perspectiveRatio:.5+this.transform.cameraToCenterDistance/P[3]*.5}}isOffscreen(l,p,v,E){return v<zi||l>=this.screenRightBoundary||E<zi||p>this.screenBottomBoundary}isInsideGrid(l,p,v,E){return v>=0&&l<this.gridRightBoundary&&E>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const l=a.identity([]);return a.translate(l,l,[-100,-100,0]),l}}function bi(b,l,p){return l*(a.EXTENT/(b.tileSize*Math.pow(2,p-b.tileID.overscaledZ)))}class Wi{constructor(l,p,v,E){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?p:-p))):E&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class Hn{constructor(l,p,v,E,P){this.text=new Wi(l?l.text:null,p,v,P),this.icon=new Wi(l?l.icon:null,p,E,P)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qs{constructor(l,p,v){this.text=l,this.icon=p,this.skipFade=v}}class Dr{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Rr{constructor(l,p,v,E,P){this.bucketInstanceId=l,this.featureIndex=p,this.sourceLayerIndex=v,this.bucketIndex=E,this.tileID=P}}class qr{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const p=++this.maxGroupID;this.collisionGroups[l]={ID:p,predicate:v=>v.collisionGroupID===p}}return this.collisionGroups[l]}}function Is(b,l,p,v,E){const{horizontalAlign:P,verticalAlign:z}=a.getAnchorAlignment(b),N=-(P-.5)*l,G=-(z-.5)*p,$=a.evaluateVariableOffset(b,v);return new a.pointGeometry(N+$[0]*E,G+$[1]*E)}function ar(b,l,p,v,E,P){const{x1:z,x2:N,y1:G,y2:$,anchorPointX:K,anchorPointY:se}=b,ce=new a.pointGeometry(l,p);return v&&ce._rotate(E?P:-P),{x1:z+ce.x,y1:G+ce.y,x2:N+ce.x,y2:$+ce.y,anchorPointX:K,anchorPointY:se}}class Y{constructor(l,p,v,E,P){this.transform=l.clone(),this.terrain=p,this.collisionIndex=new $s(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new qr(E),this.collisionCircleArrays={},this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,p,v,E){const P=v.getBucket(p),z=v.latestFeatureIndex;if(!P||!z||p.id!==P.layerIds[0])return;const N=v.collisionBoxArray,G=P.layers[0].layout,$=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),K=v.tileSize/a.EXTENT,se=this.transform.calculatePosMatrix(v.tileID.toUnwrapped()),ce=G.get("text-pitch-alignment")==="map",xe=G.get("text-rotation-alignment")==="map",ve=bi(v,1,this.transform.zoom),le=Ms(se,ce,xe,this.transform,ve);let ye=null;if(ce){const je=or(se,ce,xe,this.transform,ve);ye=a.multiply([],this.transform.labelPlaneMatrix,je)}this.retainedQueryData[P.bucketInstanceId]=new Rr(P.bucketInstanceId,z,P.sourceLayerIndex,P.index,v.tileID);const ze={bucket:P,layout:G,posMatrix:se,textLabelPlaneMatrix:le,labelToScreenMatrix:ye,scale:$,textPixelRatio:K,holdingForFade:v.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(P.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(E)for(const je of P.sortKeyRanges){const{sortKey:Se,symbolInstanceStart:Xe,symbolInstanceEnd:He}=je;l.push({sortKey:Se,symbolInstanceStart:Xe,symbolInstanceEnd:He,parameters:ze})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:ze})}attemptAnchorPlacement(l,p,v,E,P,z,N,G,$,K,se,ce,xe,ve,le,ye){const ze=[ce.textOffset0,ce.textOffset1],je=Is(l,v,E,ze,P),Se=this.collisionIndex.placeCollisionBox(ar(p,je.x,je.y,z,N,this.transform.angle),se,G,$,K.predicate,ye);if((!le||this.collisionIndex.placeCollisionBox(ar(le,je.x,je.y,z,N,this.transform.angle),se,G,$,K.predicate,ye).box.length!==0)&&Se.box.length>0){let Xe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(Xe=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ce.crossTileID]={textOffset:ze,width:v,height:E,anchor:l,textBoxScale:P,prevAnchor:Xe},this.markUsedJustification(xe,l,ce,ve),xe.allowVerticalPlacement&&(this.markUsedOrientation(xe,ve,ce),this.placedOrientations[ce.crossTileID]=ve),{shift:je,placedGlyphBoxes:Se}}}placeLayerBucketPart(l,p,v){const{bucket:E,layout:P,posMatrix:z,textLabelPlaneMatrix:N,labelToScreenMatrix:G,textPixelRatio:$,holdingForFade:K,collisionBoxArray:se,partiallyEvaluatedTextSize:ce,collisionGroup:xe}=l.parameters,ve=P.get("text-optional"),le=P.get("icon-optional"),ye=a.getOverlapMode(P,"text-overlap","text-allow-overlap"),ze=ye==="always",je=a.getOverlapMode(P,"icon-overlap","icon-allow-overlap"),Se=je==="always",Xe=P.get("text-rotation-alignment")==="map",He=P.get("text-pitch-alignment")==="map",it=P.get("icon-text-fit")!=="none",Je=P.get("symbol-z-order")==="viewport-y",d=ze&&(Se||!E.hasIconData()||le),A=Se&&(ze||!E.hasTextData()||ve);!E.collisionArrays&&se&&E.deserializeCollisionBoxes(se);const m=(_,x)=>{if(p[_.crossTileID])return;if(K)return void(this.placements[_.crossTileID]=new qs(!1,!1,!1));let S=!1,M=!1,L=!0,O=null,H={box:null,offscreen:null},ee={box:null,offscreen:null},Ae=null,we=null,Re=null,Te=0,Be=0,tt=0;x.textFeatureIndex?Te=x.textFeatureIndex:_.useRuntimeCollisionCircles&&(Te=_.featureIndex),x.verticalTextFeatureIndex&&(Be=x.verticalTextFeatureIndex);const Ke=this.retainedQueryData[E.bucketInstanceId].tileID,We=this.terrain?(Et,st)=>this.terrain.getElevation(Ke,Et,st):null;for(const Et of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const st=x[Et];st&&(st.elevation=We?We(st.anchorPointX,st.anchorPointY):0)}const $e=x.textBox;if($e){const Et=dt=>{let gn=a.WritingMode.horizontal;if(E.allowVerticalPlacement&&!dt&&this.prevPlacement){const hn=this.prevPlacement.placedOrientations[_.crossTileID];hn&&(this.placedOrientations[_.crossTileID]=hn,gn=hn,this.markUsedOrientation(E,gn,_))}return gn},st=(dt,gn)=>{if(E.allowVerticalPlacement&&_.numVerticalGlyphVertices>0&&x.verticalTextBox){for(const hn of E.writingModes)if(hn===a.WritingMode.vertical?(H=gn(),ee=H):H=dt(),H&&H.box&&H.box.length)break}else H=dt()};if(P.get("text-variable-anchor")){let dt=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[_.crossTileID]){const sn=this.prevPlacement.variableOffsets[_.crossTileID];dt.indexOf(sn.anchor)>0&&(dt=dt.filter(an=>an!==sn.anchor),dt.unshift(sn.anchor))}const gn=(sn,an,fn)=>{const vn=sn.x2-sn.x1,Zn=sn.y2-sn.y1,_n=_.textBoxScale,oi=it&&je==="never"?an:null;let Ti={box:[],offscreen:!1};const Po=ye!=="never"?2*dt.length:dt.length;for(let Pl=0;Pl<Po;++Pl){const nh=this.attemptAnchorPlacement(dt[Pl%dt.length],sn,vn,Zn,_n,Xe,He,$,z,xe,Pl>=dt.length?ye:"never",_,E,fn,oi,We);if(nh&&(Ti=nh.placedGlyphBoxes,Ti&&Ti.box&&Ti.box.length)){S=!0,O=nh.shift;break}}return Ti};st(()=>gn($e,x.iconBox,a.WritingMode.horizontal),()=>{const sn=x.verticalTextBox;return E.allowVerticalPlacement&&!(H&&H.box&&H.box.length)&&_.numVerticalGlyphVertices>0&&sn?gn(sn,x.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),H&&(S=H.box,L=H.offscreen);const hn=Et(H&&H.box);if(!S&&this.prevPlacement){const sn=this.prevPlacement.variableOffsets[_.crossTileID];sn&&(this.variableOffsets[_.crossTileID]=sn,this.markUsedJustification(E,sn.anchor,_,hn))}}else{const dt=(gn,hn)=>{const sn=this.collisionIndex.placeCollisionBox(gn,ye,$,z,xe.predicate,We);return sn&&sn.box&&sn.box.length&&(this.markUsedOrientation(E,hn,_),this.placedOrientations[_.crossTileID]=hn),sn};st(()=>dt($e,a.WritingMode.horizontal),()=>{const gn=x.verticalTextBox;return E.allowVerticalPlacement&&_.numVerticalGlyphVertices>0&&gn?dt(gn,a.WritingMode.vertical):{box:null,offscreen:null}}),Et(H&&H.box&&H.box.length)}}if(Ae=H,S=Ae&&Ae.box&&Ae.box.length>0,L=Ae&&Ae.offscreen,_.useRuntimeCollisionCircles){const Et=E.text.placedSymbolArray.get(_.centerJustifiedTextSymbolIndex),st=a.evaluateSizeForFeature(E.textSizeData,ce,Et),dt=P.get("text-padding");we=this.collisionIndex.placeCollisionCircles(ye,Et,E.lineVertexArray,E.glyphOffsetArray,st,z,N,G,v,He,xe.predicate,_.collisionCircleDiameter,dt,We),we.circles.length&&we.collisionDetected&&!v&&a.warnOnce("Collisions detected, but collision boxes are not shown"),S=ze||we.circles.length>0&&!we.collisionDetected,L=L&&we.offscreen}if(x.iconFeatureIndex&&(tt=x.iconFeatureIndex),x.iconBox){const Et=st=>{const dt=it&&O?ar(st,O.x,O.y,Xe,He,this.transform.angle):st;return this.collisionIndex.placeCollisionBox(dt,je,$,z,xe.predicate,We)};ee&&ee.box&&ee.box.length&&x.verticalIconBox?(Re=Et(x.verticalIconBox),M=Re.box.length>0):(Re=Et(x.iconBox),M=Re.box.length>0),L=L&&Re.offscreen}const Oe=ve||_.numHorizontalGlyphVertices===0&&_.numVerticalGlyphVertices===0,It=le||_.numIconVertices===0;if(Oe||It?It?Oe||(M=M&&S):S=M&&S:M=S=M&&S,S&&Ae&&Ae.box&&this.collisionIndex.insertCollisionBox(Ae.box,ye,P.get("text-ignore-placement"),E.bucketInstanceId,ee&&ee.box&&Be?Be:Te,xe.ID),M&&Re&&this.collisionIndex.insertCollisionBox(Re.box,je,P.get("icon-ignore-placement"),E.bucketInstanceId,tt,xe.ID),we&&(S&&this.collisionIndex.insertCollisionCircles(we.circles,ye,P.get("text-ignore-placement"),E.bucketInstanceId,Te,xe.ID),v)){const Et=E.bucketInstanceId;let st=this.collisionCircleArrays[Et];st===void 0&&(st=this.collisionCircleArrays[Et]=new Dr);for(let dt=0;dt<we.circles.length;dt+=4)st.circles.push(we.circles[dt+0]),st.circles.push(we.circles[dt+1]),st.circles.push(we.circles[dt+2]),st.circles.push(we.collisionDetected?1:0)}if(_.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(E.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[_.crossTileID]=new qs(S||d,M||A,L||E.justReloaded),p[_.crossTileID]=!0};if(Je){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const _=E.getSortedSymbolIndexes(this.transform.angle);for(let x=_.length-1;x>=0;--x){const S=_[x];m(E.symbolInstances.get(S),E.collisionArrays[S])}}else for(let _=l.symbolInstanceStart;_<l.symbolInstanceEnd;_++)m(E.symbolInstances.get(_),E.collisionArrays[_]);if(v&&E.bucketInstanceId in this.collisionCircleArrays){const _=this.collisionCircleArrays[E.bucketInstanceId];a.invert(_.invProjMatrix,z),_.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(l,p,v,E){let P;P=E===a.WritingMode.vertical?v.verticalPlacedTextSymbolIndex:{left:v.leftJustifiedTextSymbolIndex,center:v.centerJustifiedTextSymbolIndex,right:v.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(p)];const z=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex,v.verticalPlacedTextSymbolIndex];for(const N of z)N>=0&&(l.text.placedSymbolArray.get(N).crossTileID=P>=0&&N!==P?0:v.crossTileID)}markUsedOrientation(l,p,v){const E=p===a.WritingMode.horizontal||p===a.WritingMode.horizontalOnly?p:0,P=p===a.WritingMode.vertical?p:0,z=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex];for(const N of z)l.text.placedSymbolArray.get(N).placedOrientation=E;v.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(v.verticalPlacedTextSymbolIndex).placedOrientation=P)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let v=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const E=p?p.symbolFadeChange(l):1,P=p?p.opacities:{},z=p?p.variableOffsets:{},N=p?p.placedOrientations:{};for(const G in this.placements){const $=this.placements[G],K=P[G];K?(this.opacities[G]=new Hn(K,E,$.text,$.icon),v=v||$.text!==K.text.placed||$.icon!==K.icon.placed):(this.opacities[G]=new Hn(null,E,$.text,$.icon,$.skipFade),v=v||$.text||$.icon)}for(const G in P){const $=P[G];if(!this.opacities[G]){const K=new Hn($,E,!1,!1);K.isHidden()||(this.opacities[G]=K,v=v||$.text.placed||$.icon.placed)}}for(const G in z)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=z[G]);for(const G in N)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=N[G]);if(p&&p.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");v?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:l)}updateLayerOpacities(l,p){const v={};for(const E of p){const P=E.getBucket(l);P&&E.latestFeatureIndex&&l.id===P.layerIds[0]&&this.updateBucketOpacities(P,v,E.collisionBoxArray)}}updateBucketOpacities(l,p,v){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const E=l.layers[0].layout,P=new Hn(null,0,!1,!1,!0),z=E.get("text-allow-overlap"),N=E.get("icon-allow-overlap"),G=E.get("text-variable-anchor"),$=E.get("text-rotation-alignment")==="map",K=E.get("text-pitch-alignment")==="map",se=E.get("icon-text-fit")!=="none",ce=new Hn(null,0,z&&(N||!l.hasIconData()||E.get("icon-optional")),N&&(z||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&v&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(v);const xe=(ve,le,ye)=>{for(let ze=0;ze<le/4;ze++)ve.opacityVertexArray.emplaceBack(ye)};for(let ve=0;ve<l.symbolInstances.length;ve++){const le=l.symbolInstances.get(ve),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:ze,crossTileID:je}=le;let Se=this.opacities[je];p[je]?Se=P:Se||(Se=ce,this.opacities[je]=Se),p[je]=!0;const Xe=le.numIconVertices>0,He=this.placedOrientations[le.crossTileID],it=He===a.WritingMode.vertical,Je=He===a.WritingMode.horizontal||He===a.WritingMode.horizontalOnly;if(ye>0||ze>0){const d=Me(Se.text);xe(l.text,ye,it?Ne:d),xe(l.text,ze,Je?Ne:d);const A=Se.text.isHidden();[le.rightJustifiedTextSymbolIndex,le.centerJustifiedTextSymbolIndex,le.leftJustifiedTextSymbolIndex].forEach(x=>{x>=0&&(l.text.placedSymbolArray.get(x).hidden=A||it?1:0)}),le.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(le.verticalPlacedTextSymbolIndex).hidden=A||Je?1:0);const m=this.variableOffsets[le.crossTileID];m&&this.markUsedJustification(l,m.anchor,le,He);const _=this.placedOrientations[le.crossTileID];_&&(this.markUsedJustification(l,"left",le,_),this.markUsedOrientation(l,_,le))}if(Xe){const d=Me(Se.icon),A=!(se&&le.verticalPlacedIconSymbolIndex&&it);le.placedIconSymbolIndex>=0&&(xe(l.icon,le.numIconVertices,A?d:Ne),l.icon.placedSymbolArray.get(le.placedIconSymbolIndex).hidden=Se.icon.isHidden()),le.verticalPlacedIconSymbolIndex>=0&&(xe(l.icon,le.numVerticalIconVertices,A?Ne:d),l.icon.placedSymbolArray.get(le.verticalPlacedIconSymbolIndex).hidden=Se.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const d=l.collisionArrays[ve];if(d){let A=new a.pointGeometry(0,0);if(d.textBox||d.verticalTextBox){let _=!0;if(G){const x=this.variableOffsets[je];x?(A=Is(x.anchor,x.width,x.height,x.textOffset,x.textBoxScale),$&&A._rotate(K?this.transform.angle:-this.transform.angle)):_=!1}d.textBox&&V(l.textCollisionBox.collisionVertexArray,Se.text.placed,!_||it,A.x,A.y),d.verticalTextBox&&V(l.textCollisionBox.collisionVertexArray,Se.text.placed,!_||Je,A.x,A.y)}const m=!!(!Je&&d.verticalIconBox);d.iconBox&&V(l.iconCollisionBox.collisionVertexArray,Se.icon.placed,m,se?A.x:0,se?A.y:0),d.verticalIconBox&&V(l.iconCollisionBox.collisionVertexArray,Se.icon.placed,!m,se?A.x:0,se?A.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const ve=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=ve.invProjMatrix,l.placementViewportMatrix=ve.viewportMatrix,l.collisionCircleArray=ve.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,p){const v=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*v>l}setStale(){this.stale=!0}}function V(b,l,p,v,E){b.emplaceBack(l?1:0,p?1:0,v||0,E||0),b.emplaceBack(l?1:0,p?1:0,v||0,E||0),b.emplaceBack(l?1:0,p?1:0,v||0,E||0),b.emplaceBack(l?1:0,p?1:0,v||0,E||0)}const X=Math.pow(2,25),oe=Math.pow(2,24),f=Math.pow(2,17),W=Math.pow(2,16),ke=Math.pow(2,9),Ce=Math.pow(2,8),Ee=Math.pow(2,1);function Me(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const l=b.placed?1:0,p=Math.floor(127*b.opacity);return p*X+l*oe+p*f+l*W+p*ke+l*Ce+p*Ee+l}const Ne=0;class rt{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,p,v,E,P){const z=this._bucketParts;for(;this._currentTileIndex<l.length;)if(p.getBucketParts(z,E,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort((N,G)=>N.sortKey-G.sortKey));this._currentPartIndex<z.length;)if(p.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,v),this._currentPartIndex++,P())return!0;return!1}}class Ve{constructor(l,p,v,E,P,z,N,G){this.placement=new Y(l,p,z,N,G),this._currentPlacementIndex=v.length-1,this._forceFullPlacement=E,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(l,p,v){const E=a.exported.now(),P=()=>{const z=a.exported.now()-E;return!this._forceFullPlacement&&z>2};for(;this._currentPlacementIndex>=0;){const z=p[l[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=N)&&(!z.maxzoom||z.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new rt(z)),this._inProgressLayer.continuePlacement(v[z.source],this.placement,this._showCollisionBoxes,z,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const ft=512/a.EXTENT/2;class Lt{constructor(l,p,v){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=v;for(let E=0;E<p.length;E++){const P=p.get(E),z=P.key;this.indexedSymbolInstances[z]||(this.indexedSymbolInstances[z]=[]),this.indexedSymbolInstances[z].push({crossTileID:P.crossTileID,coord:this.getScaledCoordinates(P,l)})}}getScaledCoordinates(l,p){const v=ft/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*a.EXTENT+l.anchorX)*v),y:Math.floor((p.canonical.y*a.EXTENT+l.anchorY)*v)}}findMatches(l,p,v){const E=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z);for(let P=0;P<l.length;P++){const z=l.get(P);if(z.crossTileID)continue;const N=this.indexedSymbolInstances[z.key];if(!N)continue;const G=this.getScaledCoordinates(z,p);for(const $ of N)if(Math.abs($.coord.x-G.x)<=E&&Math.abs($.coord.y-G.y)<=E&&!v[$.crossTileID]){v[$.crossTileID]=!0,z.crossTileID=$.crossTileID;break}}}}class Ct{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Yt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const p=Math.round((l-this.lng)/360);if(p!==0)for(const v in this.indexes){const E=this.indexes[v],P={};for(const z in E){const N=E[z];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+p),P[N.tileID.key]=N}this.indexes[v]=P}this.lng=l}addBucket(l,p,v){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let P=0;P<p.symbolInstances.length;P++)p.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const E=this.usedCrossTileIDs[l.overscaledZ];for(const P in this.indexes){const z=this.indexes[P];if(Number(P)>l.overscaledZ)for(const N in z){const G=z[N];G.tileID.isChildOf(l)&&G.findMatches(p.symbolInstances,l,E)}else{const N=z[l.scaledTo(Number(P)).key];N&&N.findMatches(p.symbolInstances,l,E)}}for(let P=0;P<p.symbolInstances.length;P++){const z=p.symbolInstances.get(P);z.crossTileID||(z.crossTileID=v.generate(),E[z.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Lt(l,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(l,p){for(const v in p.indexedSymbolInstances)for(const E of p.indexedSymbolInstances[v])delete this.usedCrossTileIDs[l][E.crossTileID]}removeStaleBuckets(l){let p=!1;for(const v in this.indexes){const E=this.indexes[v];for(const P in E)l[E[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,E[P]),delete E[P],p=!0)}return p}}class Gt{constructor(){this.layerIndexes={},this.crossTileIDs=new Ct,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,p,v){let E=this.layerIndexes[l.id];E===void 0&&(E=this.layerIndexes[l.id]=new Yt);let P=!1;const z={};E.handleWrapJump(v);for(const N of p){const G=N.getBucket(l);G&&l.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(N.tileID,G,this.crossTileIDs)&&(P=!0),z[G.bucketInstanceId]=!0)}return E.removeStaleBuckets(z)&&(P=!0),P}pruneUnusedLayers(l){const p={};l.forEach(v=>{p[v]=!0});for(const v in this.layerIndexes)p[v]||delete this.layerIndexes[v]}}var on=a.createLayout([{name:"a_pos",type:"Int16",components:2}]);class $t extends a.Evented{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=l._cache.max,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const l in this._tiles){const p=this._tiles[l];p.textures.forEach(v=>v.destroy()),p.textures=[]}}update(l,p){this.sourceCache.update(l,p),this._renderableTilesKeys=[];for(const v of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:p}))this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.posMatrix=new Float64Array(16),a.ortho(v.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),this._tiles[v.key]=new Ue(v,this.tileSize))}removeOutdated(l){const p={};this.renderHistory=this.renderHistory.filter((v,E)=>this.renderHistory.indexOf(v)===E).slice(0,this.renderHistorySize);for(const v of this._renderableTilesKeys)p[v]=!0;for(const v of this.renderHistory)p[v]=!0;for(const v in this._tiles)p[v]||(this._tiles[v].clearTextures(l),delete this._tiles[v])}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const p={};for(const v of this._renderableTilesKeys){const E=this._tiles[v].tileID;if(E.canonical.equals(l.canonical)){const P=l.clone();P.posMatrix=new Float64Array(16),a.ortho(P.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),p[v]=P}else if(E.canonical.isChildOf(l.canonical)){const P=l.clone();P.posMatrix=new Float64Array(16);const z=E.canonical.z-l.canonical.z,N=E.canonical.x-(E.canonical.x>>z<<z),G=E.canonical.y-(E.canonical.y>>z<<z),$=a.EXTENT>>z;a.ortho(P.posMatrix,0,$,0,$,0,1),a.translate(P.posMatrix,P.posMatrix,[-N*$,-G*$,0]),p[v]=P}else if(l.canonical.isChildOf(E.canonical)){const P=l.clone();P.posMatrix=new Float64Array(16);const z=l.canonical.z-E.canonical.z,N=l.canonical.x-(l.canonical.x>>z<<z),G=l.canonical.y-(l.canonical.y>>z<<z),$=a.EXTENT>>z;a.ortho(P.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),a.translate(P.posMatrix,P.posMatrix,[N*$,G*$,0]),a.scale(P.posMatrix,P.posMatrix,[1/2**z,1/2**z,0]),p[v]=P}}return p}getSourceTile(l,p){const v=this.sourceCache._source;let E=l.overscaledZ-this.deltaZoom;if(E>v.maxzoom&&(E=v.maxzoom),E<v.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(E).key);let P=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!P||!P.dem)&&p)for(;E>=v.minzoom&&(!P||!P.dem);)P=this.sourceCache.getTileByID(l.scaledTo(E--).key);return P}tilesAfterTime(l=Date.now()){return Object.values(this._tiles).filter(p=>p.timeLoaded>=l)}}class Kt{constructor(l,p,v){this.style=l,this.sourceCache=new $t(p),this.options=v,this.exaggeration=typeof v.exaggeration=="number"?v.exaggeration:1,this.elevationOffset=typeof v.elevationOffset=="number"?v.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(l,p,v,E=a.EXTENT){if(!(p>=0&&p<E&&v>=0&&v<E))return this.elevationOffset;let P=0;const z=this.getTerrainData(l);if(z.tile&&z.tile.dem){const N=a.transformMat4$1([],[p/E*a.EXTENT,v/E*a.EXTENT],z.u_terrain_matrix),G=[N[0]*z.tile.dem.dim,N[1]*z.tile.dem.dim],$=[Math.floor(G[0]),Math.floor(G[1])],K=z.tile.dem.get($[0],$[1]),se=z.tile.dem.get($[0],$[1]+1),ce=z.tile.dem.get($[0]+1,$[1]),xe=z.tile.dem.get($[0]+1,$[1]+1);P=a.number(a.number(K,se,G[0]-$[0]),a.number(ce,xe,G[0]-$[0]),G[1]-$[1])}return P}rememberForRerender(l,p){for(const v in this.sourceCache._tiles){const E=this.sourceCache._tiles[v];(E.tileID.equals(p)||E.tileID.isChildOf(p))&&(l===this.sourceCache.sourceCache.id&&(E.timeLoaded=Date.now()),this._rerender[l]=this._rerender[l]||{},this._rerender[l][E.tileID.key]=!0)}}needsRerender(l,p){return this._rerender[l]&&this._rerender[l][p.key]}clearRerenderCache(){this._rerender={}}getElevation(l,p,v,E=a.EXTENT){return(this.getDEMElevation(l,p,v,E)+this.elevationOffset)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const E=this.style.map.painter.context,P=new a.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ne(E,P,E.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ne(E,new a.RGBAImage({width:1,height:1}),E.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(E.gl.NEAREST,E.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.identity([])}const p=this.sourceCache.getSourceTile(l,!0);if(p&&p.dem&&(!p.demTexture||p.needsTerrainPrepare)){const E=this.style.map.painter.context;p.demTexture=this.style.map.painter.getTileTexture(p.dem.stride),p.demTexture?p.demTexture.update(p.dem.getPixels(),{premultiply:!1}):p.demTexture=new ne(E,p.dem.getPixels(),E.gl.RGBA,{premultiply:!1}),p.demTexture.bind(E.gl.NEAREST,E.gl.CLAMP_TO_EDGE),p.needsTerrainPrepare=!1}const v=p&&p+p.tileID.key+l.key;if(v&&!this._demMatrixCache[v]){const E=this.sourceCache.sourceCache._source.maxzoom;let P=l.canonical.z-p.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=E?P=l.canonical.z-E:a.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const z=l.canonical.x-(l.canonical.x>>P<<P),N=l.canonical.y-(l.canonical.y>>P<<P),G=a.fromScaling(new Float64Array(16),[1/(a.EXTENT<<P),1/(a.EXTENT<<P),0]);a.translate(G,G,[z*a.EXTENT,N*a.EXTENT,0]),this._demMatrixCache[l.key]={matrix:G,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:p&&p.dem&&p.dem.dim||1,u_terrain_matrix:v?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:p&&p.dem&&p.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(p&&p.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:p}}getRTTFramebuffer(){const l=this.style.map.painter;if(!this._rttFramebuffer){const p=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=l.context.createFramebuffer(p,p,!0),this._rttFramebuffer.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,p,p))}return this._rttFramebuffer}getFramebuffer(l){const p=this.style.map.painter,v=p.width/devicePixelRatio,E=p.height/devicePixelRatio;return!this._fbo||this._fbo.width===v&&this._fbo.height===E||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ne(p.context,{width:v,height:E,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ne(p.context,{width:v,height:E,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=p.context.createFramebuffer(v,E,!0),this._fbo.depthAttachment.set(p.context.createRenderbuffer(p.context.gl.DEPTH_COMPONENT16,v,E))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const p=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let P=0,z=0;P<this._coordsTextureSize;P++)for(let N=0;N<this._coordsTextureSize;N++,z+=4)p[z+0]=255&N,p[z+1]=255&P,p[z+2]=N>>8<<4|P>>8,p[z+3]=0;const v=new a.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(p.buffer)),E=new ne(l,v,l.gl.RGBA,{premultiply:!1});return E.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=E,E}pointCoordinate(l){const p=new Uint8Array(4),v=this.style.map.painter,E=v.context,P=E.gl;E.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),P.readPixels(l.x,v.height/devicePixelRatio-l.y-1,1,1,P.RGBA,P.UNSIGNED_BYTE,p),E.bindFramebuffer.set(null);const z=p[0]+(p[2]>>4<<8),N=p[1]+((15&p[2])<<8),G=this.coordsIndex[255-p[3]],$=G&&this.sourceCache.getTileByID(G);if(!$)return null;const K=this._coordsTextureSize,se=(1<<$.tileID.canonical.z)*K;return new a.MercatorCoordinate(($.tileID.canonical.x*K+z)/se,($.tileID.canonical.y*K+N)/se,this.getElevation($.tileID,z,N,K))}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.style.map.painter.context,p=new a.PosArray,v=new a.TriangleIndexArray,E=this.meshSize,P=a.EXTENT/E,z=E*E;for(let N=0;N<=E;N++)for(let G=0;G<=E;G++)p.emplaceBack(G*P,N*P);for(let N=0;N<z;N+=E+1)for(let G=0;G<E;G++)v.emplaceBack(G+N,E+G+N+1,E+G+N+2),v.emplaceBack(G+N,E+G+N+2,G+N+1);return this._mesh={indexBuffer:l.createIndexBuffer(v),vertexBuffer:l.createVertexBuffer(p,on.members),segments:a.SegmentVector.simpleSegment(0,0,p.length,v.length)},this._mesh}getMinMaxElevation(l){const p=this.getTerrainData(l).tile,v={minElevation:null,maxElevation:null};return p&&p.dem&&(v.minElevation=(p.dem.min+this.elevationOffset)*this.exaggeration,v.maxElevation=(p.dem.max+this.elevationOffset)*this.exaggeration),v}}const wn=(b,l)=>a.emitValidationErrors(b,l&&l.filter(p=>p.identifier!=="source.canvas")),Ln=a.pick(Dn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Wn=a.pick(Dn,["setCenter","setZoom","setBearing","setPitch"]),Vt=function(){const b={},l=a.spec.$version;for(const p in a.spec.$root){const v=a.spec.$root[p];if(v.required){let E=null;E=p==="version"?l:v.type==="array"?[]:{},E!=null&&(b[p]=E)}}return b}();class _e extends a.Evented{constructor(l,p={}){super(),this.map=l,this.dispatcher=new ot(ei(),this),this.imageManager=new J,this.imageManager.setEventedParent(this),this.glyphManager=new be(l._requestManager,p.localIdeographFontFamily),this.lineAtlas=new ht(256,512),this.crossTileSymbolIndex=new Gt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const v=this;this._rtlTextPluginCallback=_e.registerForPluginStateChange(E=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},(P,z)=>{if(a.triggerPluginCompletionEvent(P),z&&z.every(N=>N))for(const N in v.sourceCaches)v.sourceCaches[N].reload()})}),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const P=this.sourceCaches[E.sourceId];if(!P)return;const z=P.getSource();if(z&&z.vectorLayerIds)for(const N in this._layers){const G=this._layers[N];G.source===z.id&&this._validateLayer(G)}})}loadURL(l,p={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const v=typeof p.validate!="boolean"||p.validate,E=this.map._requestManager.transformRequest(l,a.ResourceType.Style);this._request=a.getJSON(E,(P,z)=>{this._request=null,P?this.fire(new a.ErrorEvent(P)):z&&this._load(z,v)})}loadJSON(l,p={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(l,p.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Vt,!1)}_load(l,p){if(p&&wn(this,a.validateStyle(l)))return;this._loaded=!0,this.stylesheet=l;for(const E in l.sources)this.addSource(E,l.sources[E],{validate:!1});l.sprite?this._loadSprite(l.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(l.glyphs);const v=hr(this.stylesheet.layers);this._order=v.map(E=>E.id),this._layers={},this._serializedLayers={};for(let E of v)E=a.createStyleLayer(E),E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new et(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}_loadSprite(l){this._spriteRequest=function(p,v,E,P){let z,N,G;const $=E>1?"@2x":"";let K=a.getJSON(v.transformRequest(v.normalizeSpriteURL(p,$,".json"),a.ResourceType.SpriteJSON),(xe,ve)=>{K=null,G||(G=xe,z=ve,ce())}),se=a.getImage(v.transformRequest(v.normalizeSpriteURL(p,$,".png"),a.ResourceType.SpriteImage),(xe,ve)=>{se=null,G||(G=xe,N=ve,ce())});function ce(){if(G)P(G);else if(z&&N){const xe=a.exported.getImageData(N),ve={};for(const le in z){const{width:ye,height:ze,x:je,y:Se,sdf:Xe,pixelRatio:He,stretchX:it,stretchY:Je,content:d}=z[le],A=new a.RGBAImage({width:ye,height:ze});a.RGBAImage.copy(xe,A,{x:je,y:Se},{x:0,y:0},{width:ye,height:ze}),ve[le]={data:A,pixelRatio:He,sdf:Xe,stretchX:it,stretchY:Je,content:d}}P(null,ve)}}return{cancel(){K&&(K.cancel(),K=null),se&&(se.cancel(),se=null)}}}(l,this.map._requestManager,this.map.getPixelRatio(),(p,v)=>{if(this._spriteRequest=null,p)this.fire(new a.ErrorEvent(p));else if(v)for(const E in v)this.imageManager.addImage(E,v[E]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(l){const p=this.sourceCaches[l.source];if(!p)return;const v=l.sourceLayer;if(!v)return;const E=p.getSource();(E.type==="geojson"||E.vectorLayerIds&&E.vectorLayerIds.indexOf(v)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${v}" does not exist on source "${E.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const p=[];for(const v of l){const E=this._layers[v];E.type!=="custom"&&p.push(E.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const p=this._changed;if(this._changed){const E=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(E.length||P.length)&&this._updateWorkerLayers(E,P);for(const z in this._updatedSources){const N=this._updatedSources[z];if(N==="reload")this._reloadSource(z);else{if(N!=="clear")throw new Error(`Invalid action ${N}`);this._clearSource(z)}}this._updateTilesForChangedImages();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}const v={};for(const E in this.sourceCaches){const P=this.sourceCaches[E];v[E]=P.used,P.used=!1}for(const E of this._order){const P=this._layers[E];P.recalculate(l,this._availableImages),!P.isHidden(l.zoom)&&P.source&&(this.sourceCaches[P.source].used=!0)}for(const E in v){const P=this.sourceCaches[E];v[E]!==P.used&&P.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E}))}this.light.recalculate(l),this.z=l.zoom,p&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(l){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),l){const p=this.sourceCaches[l.source];if(!p)throw new Error(`cannot load terrain, because there exists no source with ID: ${l.source}`);this.terrain=new Kt(this,p,l),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=v=>{v.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=v=>{v.tile&&(v.sourceId===l.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(v.sourceId,v.tile.tileID)):v.source.type==="geojson"&&this.terrain.rememberForRerender(v.sourceId,v.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new a.Event("terrain",{terrain:l}))}setState(l){if(this._checkLoaded(),wn(this,a.validateStyle(l)))return!1;(l=a.clone$1(l)).layers=hr(l.layers);const p=function(E,P){if(!E)return[{command:Dn.setStyle,args:[P]}];let z=[];try{if(!R(E.version,P.version))return[{command:Dn.setStyle,args:[P]}];R(E.center,P.center)||z.push({command:Dn.setCenter,args:[P.center]}),R(E.zoom,P.zoom)||z.push({command:Dn.setZoom,args:[P.zoom]}),R(E.bearing,P.bearing)||z.push({command:Dn.setBearing,args:[P.bearing]}),R(E.pitch,P.pitch)||z.push({command:Dn.setPitch,args:[P.pitch]}),R(E.sprite,P.sprite)||z.push({command:Dn.setSprite,args:[P.sprite]}),R(E.glyphs,P.glyphs)||z.push({command:Dn.setGlyphs,args:[P.glyphs]}),R(E.transition,P.transition)||z.push({command:Dn.setTransition,args:[P.transition]}),R(E.light,P.light)||z.push({command:Dn.setLight,args:[P.light]});const N={},G=[];(function(K,se,ce,xe){let ve;for(ve in se=se||{},K=K||{})Object.prototype.hasOwnProperty.call(K,ve)&&(Object.prototype.hasOwnProperty.call(se,ve)||ni(ve,ce,xe));for(ve in se)Object.prototype.hasOwnProperty.call(se,ve)&&(Object.prototype.hasOwnProperty.call(K,ve)?R(K[ve],se[ve])||(K[ve].type==="geojson"&&se[ve].type==="geojson"&&yo(K,se,ve)?ce.push({command:Dn.setGeoJSONSourceData,args:[ve,se[ve].data]}):Wr(ve,se,ce,xe)):fr(ve,se,ce))})(E.sources,P.sources,G,N);const $=[];E.layers&&E.layers.forEach(K=>{N[K.source]?z.push({command:Dn.removeLayer,args:[K.id]}):$.push(K)}),z=z.concat(G),function(K,se,ce){se=se||[];const xe=(K=K||[]).map(Lr),ve=se.map(Lr),le=K.reduce(vo,{}),ye=se.reduce(vo,{}),ze=xe.slice(),je=Object.create(null);let Se,Xe,He,it,Je,d,A;for(Se=0,Xe=0;Se<xe.length;Se++)He=xe[Se],Object.prototype.hasOwnProperty.call(ye,He)?Xe++:(ce.push({command:Dn.removeLayer,args:[He]}),ze.splice(ze.indexOf(He,Xe),1));for(Se=0,Xe=0;Se<ve.length;Se++)He=ve[ve.length-1-Se],ze[ze.length-1-Se]!==He&&(Object.prototype.hasOwnProperty.call(le,He)?(ce.push({command:Dn.removeLayer,args:[He]}),ze.splice(ze.lastIndexOf(He,ze.length-Xe),1)):Xe++,d=ze[ze.length-Se],ce.push({command:Dn.addLayer,args:[ye[He],d]}),ze.splice(ze.length-Se,0,He),je[He]=!0);for(Se=0;Se<ve.length;Se++)if(He=ve[Se],it=le[He],Je=ye[He],!je[He]&&!R(it,Je))if(R(it.source,Je.source)&&R(it["source-layer"],Je["source-layer"])&&R(it.type,Je.type)){for(A in sr(it.layout,Je.layout,ce,He,null,Dn.setLayoutProperty),sr(it.paint,Je.paint,ce,He,null,Dn.setPaintProperty),R(it.filter,Je.filter)||ce.push({command:Dn.setFilter,args:[He,Je.filter]}),R(it.minzoom,Je.minzoom)&&R(it.maxzoom,Je.maxzoom)||ce.push({command:Dn.setLayerZoomRange,args:[He,Je.minzoom,Je.maxzoom]}),it)Object.prototype.hasOwnProperty.call(it,A)&&A!=="layout"&&A!=="paint"&&A!=="filter"&&A!=="metadata"&&A!=="minzoom"&&A!=="maxzoom"&&(A.indexOf("paint.")===0?sr(it[A],Je[A],ce,He,A.slice(6),Dn.setPaintProperty):R(it[A],Je[A])||ce.push({command:Dn.setLayerProperty,args:[He,A,Je[A]]}));for(A in Je)Object.prototype.hasOwnProperty.call(Je,A)&&!Object.prototype.hasOwnProperty.call(it,A)&&A!=="layout"&&A!=="paint"&&A!=="filter"&&A!=="metadata"&&A!=="minzoom"&&A!=="maxzoom"&&(A.indexOf("paint.")===0?sr(it[A],Je[A],ce,He,A.slice(6),Dn.setPaintProperty):R(it[A],Je[A])||ce.push({command:Dn.setLayerProperty,args:[He,A,Je[A]]}))}else ce.push({command:Dn.removeLayer,args:[He]}),d=ze[ze.lastIndexOf(He)+1],ce.push({command:Dn.addLayer,args:[Je,d]})}($,P.layers,z)}catch(N){console.warn("Unable to compute style diff:",N),z=[{command:Dn.setStyle,args:[P]}]}return z}(this.serialize(),l).filter(E=>!(E.command in Wn));if(p.length===0)return!1;const v=p.filter(E=>!(E.command in Ln));if(v.length>0)throw new Error(`Unimplemented: ${v.map(E=>E.command).join(", ")}.`);return p.forEach(E=>{E.command!=="setTransition"&&this[E.command].apply(this,E.args)}),this.stylesheet=l,!0}addImage(l,p){if(this.getImage(l))return this.fire(new a.ErrorEvent(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,p),this._afterImageUpdated(l)}updateImage(l,p){this.imageManager.updateImage(l,p)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new a.ErrorEvent(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,p,v={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(a.validateStyle.source,`sources.${l}`,p,null,v))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const E=this.sourceCaches[l]=new At(l,p,this.dispatcher);E.style=this,E.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:E.serialize(),sourceId:l})),E.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===l)return this.fire(new a.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${v}" is using it.`)));const p=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],p.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),p.setEventedParent(null),p.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,p){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const v=this.sourceCaches[l].getSource();if(v.type!=="geojson")throw new Error(`geojsonSource.type is ${v.type}, which is !== 'geojson`);v.setData(p),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,p,v={}){this._checkLoaded();const E=l.id;if(this.getLayer(E))return void this.fire(new a.ErrorEvent(new Error(`Layer "${E}" already exists on this map.`)));let P;if(l.type==="custom"){if(wn(this,a.validateCustomStyleLayer(l)))return;P=a.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(E,l.source),l=a.clone$1(l),l=a.extend(l,{source:E})),this._validate(a.validateStyle.layer,`layers.${E}`,l,{arrayIndex:-1},v))return;P=a.createStyleLayer(l),this._validateLayer(P),P.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[P.id]=P.serialize()}const z=p?this._order.indexOf(p):this._order.length;if(p&&z===-1)this.fire(new a.ErrorEvent(new Error(`Cannot add layer "${E}" before non-existing layer "${p}".`)));else{if(this._order.splice(z,0,E),this._layerOrderChanged=!0,this._layers[E]=P,this._removedLayers[E]&&P.source&&P.type!=="custom"){const N=this._removedLayers[E];delete this._removedLayers[E],N.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",this.sourceCaches[P.source].pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map)}}moveLayer(l,p){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new a.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===p)return;const v=this._order.indexOf(l);this._order.splice(v,1);const E=p?this._order.indexOf(p):this._order.length;p&&E===-1?this.fire(new a.ErrorEvent(new Error(`Cannot move layer "${l}" before non-existing layer "${p}".`))):(this._order.splice(E,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const p=this._layers[l];if(!p)return void this.fire(new a.ErrorEvent(new Error(`Cannot remove non-existing layer "${l}".`)));p.setEventedParent(null);const v=this._order.indexOf(l);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=p,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],p.onRemove&&p.onRemove(this.map)}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,p,v){this._checkLoaded();const E=this.getLayer(l);E?E.minzoom===p&&E.maxzoom===v||(p!=null&&(E.minzoom=p),v!=null&&(E.maxzoom=v),this._updateLayer(E)):this.fire(new a.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,p,v={}){this._checkLoaded();const E=this.getLayer(l);if(E){if(!R(E.filter,p))return p==null?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(a.validateStyle.filter,`layers.${E.id}.filter`,p,null,v)||(E.filter=a.clone$1(p),this._updateLayer(E)))}else this.fire(new a.ErrorEvent(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return a.clone$1(this.getLayer(l).filter)}setLayoutProperty(l,p,v,E={}){this._checkLoaded();const P=this.getLayer(l);P?R(P.getLayoutProperty(p),v)||(P.setLayoutProperty(p,v,E),this._updateLayer(P)):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,p){const v=this.getLayer(l);if(v)return v.getLayoutProperty(p);this.fire(new a.ErrorEvent(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,p,v,E={}){this._checkLoaded();const P=this.getLayer(l);P?R(P.getPaintProperty(p),v)||(P.setPaintProperty(p,v,E)&&this._updateLayer(P),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,p){return this.getLayer(l).getPaintProperty(p)}setFeatureState(l,p){this._checkLoaded();const v=l.source,E=l.sourceLayer,P=this.sourceCaches[v];if(P===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const z=P.getSource().type;z==="geojson"&&E?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||E?(l.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),P.setFeatureState(E,l.id,p)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,p){this._checkLoaded();const v=l.source,E=this.sourceCaches[v];if(E===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const P=E.getSource().type,z=P==="vector"?l.sourceLayer:void 0;P!=="vector"||z?p&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):E.removeFeatureState(z,l.id,p):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const p=l.source,v=l.sourceLayer,E=this.sourceCaches[p];if(E!==void 0)return E.getSource().type!=="vector"||v?(l.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),E.getFeatureState(v,l.id)):void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,l=>l.serialize()),layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(l){const p=z=>this._layers[z].type==="fill-extrusion",v={},E=[];for(let z=this._order.length-1;z>=0;z--){const N=this._order[z];if(p(N)){v[N]=z;for(const G of l){const $=G[N];if($)for(const K of $)E.push(K)}}}E.sort((z,N)=>N.intersectionZ-z.intersectionZ);const P=[];for(let z=this._order.length-1;z>=0;z--){const N=this._order[z];if(p(N))for(let G=E.length-1;G>=0;G--){const $=E[G].feature;if(v[$.layer.id]<z)break;P.push($),E.pop()}else for(const G of l){const $=G[N];if($)for(const K of $)P.push(K.feature)}}return P}queryRenderedFeatures(l,p,v){p&&p.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",p.filter,null,p);const E={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of p.layers){const N=this._layers[z];if(!N)return this.fire(new a.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];E[N.source]=!0}}const P=[];p.availableImages=this._availableImages;for(const z in this.sourceCaches)p.layers&&!E[z]||P.push(Nn(this.sourceCaches[z],this._layers,this._serializedLayers,l,p,v));return this.placement&&P.push(function(z,N,G,$,K,se,ce){const xe={},ve=se.queryRenderedSymbols($),le=[];for(const ye of Object.keys(ve).map(Number))le.push(ce[ye]);le.sort(ti);for(const ye of le){const ze=ye.featureIndex.lookupSymbolFeatures(ve[ye.bucketInstanceId],N,ye.bucketIndex,ye.sourceLayerIndex,K.filter,K.layers,K.availableImages,z);for(const je in ze){const Se=xe[je]=xe[je]||[],Xe=ze[je];Xe.sort((He,it)=>{const Je=ye.featureSortOrder;if(Je){const d=Je.indexOf(He.featureIndex);return Je.indexOf(it.featureIndex)-d}return it.featureIndex-He.featureIndex});for(const He of Xe)Se.push(He)}}for(const ye in xe)xe[ye].forEach(ze=>{const je=ze.feature,Se=G[z[ye].source].getFeatureState(je.layer["source-layer"],je.id);je.source=je.layer.source,je.layer["source-layer"]&&(je.sourceLayer=je.layer["source-layer"]),je.state=Se});return xe}(this._layers,this._serializedLayers,this.sourceCaches,l,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(l,p){p&&p.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",p.filter,null,p);const v=this.sourceCaches[l];return v?function(E,P){const z=E.getRenderableIds().map($=>E.getTileByID($)),N=[],G={};for(let $=0;$<z.length;$++){const K=z[$],se=K.tileID.canonical.key;G[se]||(G[se]=!0,K.querySourceFeatures(N,P))}return N}(v,p):[]}addSourceType(l,p,v){return _e.getSourceType(l)?v(new Error(`A source type called "${l}" already exists.`)):(_e.setSourceType(l,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:p.workerSourceURL},v):v(null,null))}getLight(){return this.light.getLight()}setLight(l,p={}){this._checkLoaded();const v=this.light.getLight();let E=!1;for(const z in l)if(!R(l[z],v[z])){E=!0;break}if(!E)return;const P={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,p),this.light.updateTransitions(P)}_validate(l,p,v,E,P={}){return(!P||P.validate!==!1)&&wn(this,l.call(a.validateStyle,a.extend({key:p,style:this.serialize(),value:v,styleSpec:a.spec},E)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const p=this.sourceCaches[l];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const p in this.sourceCaches)this.sourceCaches[p].update(l,this.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,p,v,E,P=!1){let z=!1,N=!1;const G={};for(const $ of this._order){const K=this._layers[$];if(K.type!=="symbol")continue;if(!G[K.source]){const ce=this.sourceCaches[K.source];G[K.source]=ce.getRenderableIds(!0).map(xe=>ce.getTileByID(xe)).sort((xe,ve)=>ve.tileID.overscaledZ-xe.tileID.overscaledZ||(xe.tileID.isLessThan(ve.tileID)?-1:1))}const se=this.crossTileSymbolIndex.addLayer(K,G[K.source],l.center.lng);z=z||se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((P=P||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),l.zoom))&&(this.pauseablePlacement=new Ve(l,this.terrain,this._order,P,p,v,E,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,G),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),N=!0),z&&this.pauseablePlacement.placement.setStale()),N||z)for(const $ of this._order){const K=this._layers[$];K.type==="symbol"&&this.placement.updateLayerOpacities(K,G[K.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,p,v){this.imageManager.getImages(p.icons,v),this._updateTilesForChangedImages();const E=this.sourceCaches[p.source];E&&E.setDependencies(p.tileID.key,p.type,p.icons)}getGlyphs(l,p,v){this.glyphManager.getGlyphs(p.stacks,v)}getResource(l,p,v){return a.makeRequest(p,v)}}_e.getSourceType=function(b){return bn[b]},_e.setSourceType=function(b,l){bn[b]=l},_e.registerForPluginStateChange=a.registerForPluginStateChange;var tn="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const $i={prelude:$n(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:$n(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:$n(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:$n(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:$n("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:$n(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:$n(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:$n("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:$n("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:$n("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:$n(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:$n(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:$n(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:$n(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:$n(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:$n(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:$n(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:$n(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:$n(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:$n(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:$n(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:$n(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:$n(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:$n(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:$n(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:$n(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:$n("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",tn),terrainDepth:$n("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",tn),terrainCoords:$n("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",tn)};function $n(b,l){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=l.match(/attribute ([\w]+) ([\w]+)/g),E=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=P?P.concat(E):E,N={};return{fragmentSource:b=b.replace(p,(G,$,K,se,ce)=>(N[ce]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
varying ${K} ${se} ${ce};
#else
uniform ${K} ${se} u_${ce};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ce}
    ${K} ${se} ${ce} = u_${ce};
#endif
`)),vertexSource:l=l.replace(p,(G,$,K,se,ce)=>{const xe=se==="float"?"vec2":"vec4",ve=ce.match(/color/)?"color":xe;return N[ce]?$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${K} ${xe} a_${ce};
varying ${K} ${se} ${ce};
#else
uniform ${K} ${se} u_${ce};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = a_${ce};
#else
    ${K} ${se} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = unpack_mix_${ve}(a_${ce}, u_${ce}_t);
#else
    ${K} ${se} ${ce} = u_${ce};
#endif
`:$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${K} ${xe} a_${ce};
#else
uniform ${K} ${se} u_${ce};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${K} ${se} ${ce} = a_${ce};
#else
    ${K} ${se} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${K} ${se} ${ce} = unpack_mix_${ve}(a_${ce}, u_${ce}_t);
#else
    ${K} ${se} ${ce} = u_${ce};
#endif
`}),staticAttributes:v,staticUniforms:z}}class Ho{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,p,v,E,P,z,N,G,$){this.context=l;let K=this.boundPaintVertexBuffers.length!==E.length;for(let se=0;!K&&se<E.length;se++)this.boundPaintVertexBuffers[se]!==E[se]&&(K=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===v&&!K&&this.boundIndexBuffer===P&&this.boundVertexOffset===z&&this.boundDynamicVertexBuffer===N&&this.boundDynamicVertexBuffer2===G&&this.boundDynamicVertexBuffer3===$?(l.bindVertexArrayOES.set(this.vao),N&&N.bind(),P&&P.dynamicDraw&&P.bind(),G&&G.bind(),$&&$.bind()):this.freshBind(p,v,E,P,z,N,G,$)}freshBind(l,p,v,E,P,z,N,G){let $;const K=l.numAttributes,se=this.context,ce=se.gl;if(se.extVertexArrayObject)this.vao&&this.destroy(),this.vao=se.extVertexArrayObject.createVertexArrayOES(),se.bindVertexArrayOES.set(this.vao),$=0,this.boundProgram=l,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=E,this.boundVertexOffset=P,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=N,this.boundDynamicVertexBuffer3=G;else{$=se.currentNumAttributes||0;for(let xe=K;xe<$;xe++)ce.disableVertexAttribArray(xe)}p.enableAttributes(ce,l);for(const xe of v)xe.enableAttributes(ce,l);z&&z.enableAttributes(ce,l),N&&N.enableAttributes(ce,l),G&&G.enableAttributes(ce,l),p.bind(),p.setVertexAttribPointers(ce,l,P);for(const xe of v)xe.bind(),xe.setVertexAttribPointers(ce,l,P);z&&(z.bind(),z.setVertexAttribPointers(ce,l,P)),E&&E.bind(),N&&(N.bind(),N.setVertexAttribPointers(ce,l,P)),G&&(G.bind(),G.setVertexAttribPointers(ce,l,P)),se.currentNumAttributes=K}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Wo(b){const l=[];for(let p=0;p<b.length;p++){if(b[p]===null)continue;const v=b[p].split(" ");l.push(v.pop())}return l}class wa{constructor(l,p,v,E,P,z,N){const G=l.gl;this.program=G.createProgram();const $=Wo(v.staticAttributes),K=E?E.getBinderAttributes():[],se=$.concat(K),ce=$i.prelude.staticUniforms?Wo($i.prelude.staticUniforms):[],xe=v.staticUniforms?Wo(v.staticUniforms):[],ve=E?E.getBinderUniforms():[],le=ce.concat(xe).concat(ve),ye=[];for(const Je of le)ye.indexOf(Je)<0&&ye.push(Je);const ze=E?E.defines():[];z&&ze.push("#define OVERDRAW_INSPECTOR;"),N&&ze.push("#define TERRAIN3D;");const je=ze.concat($i.prelude.fragmentSource,v.fragmentSource).join(`
`),Se=ze.concat($i.prelude.vertexSource,v.vertexSource).join(`
`),Xe=G.createShader(G.FRAGMENT_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);G.shaderSource(Xe,je),G.compileShader(Xe),G.attachShader(this.program,Xe);const He=G.createShader(G.VERTEX_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);G.shaderSource(He,Se),G.compileShader(He),G.attachShader(this.program,He),this.attributes={};const it={};this.numAttributes=se.length;for(let Je=0;Je<this.numAttributes;Je++)se[Je]&&(G.bindAttribLocation(this.program,Je,se[Je]),this.attributes[se[Je]]=Je);G.linkProgram(this.program),G.deleteShader(He),G.deleteShader(Xe);for(let Je=0;Je<ye.length;Je++){const d=ye[Je];if(d&&!it[d]){const A=G.getUniformLocation(this.program,d);A&&(it[d]=A)}}this.fixedUniforms=P(l,it),this.terrainUniforms=((Je,d)=>({u_depth:new a.Uniform1i(Je,d.u_depth),u_terrain:new a.Uniform1i(Je,d.u_terrain),u_terrain_dim:new a.Uniform1f(Je,d.u_terrain_dim),u_terrain_matrix:new a.UniformMatrix4f(Je,d.u_terrain_matrix),u_terrain_unpack:new a.Uniform4f(Je,d.u_terrain_unpack),u_terrain_offset:new a.Uniform1f(Je,d.u_terrain_offset),u_terrain_exaggeration:new a.Uniform1f(Je,d.u_terrain_exaggeration)}))(l,it),this.binderUniforms=E?E.getUniforms(l,it):[]}draw(l,p,v,E,P,z,N,G,$,K,se,ce,xe,ve,le,ye,ze,je){const Se=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(v),l.setStencilMode(E),l.setColorMode(P),l.setCullFace(z),G){l.activeTexture.set(Se.TEXTURE2),Se.bindTexture(Se.TEXTURE_2D,G.depthTexture),l.activeTexture.set(Se.TEXTURE3),Se.bindTexture(Se.TEXTURE_2D,G.texture);for(const He in this.terrainUniforms)this.terrainUniforms[He].set(G[He])}for(const He in this.fixedUniforms)this.fixedUniforms[He].set(N[He]);le&&le.setUniforms(l,this.binderUniforms,xe,{zoom:ve});let Xe=0;switch(p){case Se.LINES:Xe=2;break;case Se.TRIANGLES:Xe=3;break;case Se.LINE_STRIP:Xe=1}for(const He of ce.get()){const it=He.vaos||(He.vaos={});(it[$]||(it[$]=new Ho)).bind(l,this,K,le?le.getPaintVertexBuffers():[],se,He.vertexOffset,ye,ze,je),Se.drawElements(p,He.primitiveLength*Xe,Se.UNSIGNED_SHORT,He.primitiveOffset*Xe*2)}}}function de(b,l,p){const v=1/bi(p,1,l.transform.tileZoom),E=Math.pow(2,p.tileID.overscaledZ),P=p.tileSize*Math.pow(2,l.transform.tileZoom)/E,z=P*(p.tileID.canonical.x+p.tileID.wrap*E),N=P*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[v,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[z>>16,N>>16],u_pixel_coord_lower:[65535&z,65535&N]}}const xo=(b,l,p,v)=>{const E=l.style.light,P=E.properties.get("position"),z=[P.x,P.y,P.z],N=a.create$1();E.properties.get("anchor")==="viewport"&&a.fromRotation(N,-l.transform.angle),a.transformMat3(z,z,N);const G=E.properties.get("color");return{u_matrix:b,u_lightpos:z,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[G.r,G.g,G.b],u_vertical_gradient:+p,u_opacity:v}},fs=(b,l,p,v,E,P,z)=>a.extend(xo(b,l,p,v),de(P,l,z),{u_height_factor:-Math.pow(2,E.overscaledZ)/z.tileSize/8}),ba=b=>({u_matrix:b}),Ea=(b,l,p,v)=>a.extend(ba(b),de(p,l,v)),Ta=(b,l)=>({u_matrix:b,u_world:l}),rl=(b,l,p,v,E)=>a.extend(Ea(b,l,p,v),{u_world:E}),sl=(b,l,p,v)=>{const E=b.transform;let P,z;if(v.paint.get("circle-pitch-alignment")==="map"){const N=bi(p,1,E.zoom);P=!0,z=[N,N]}else P=!1,z=E.pixelsToGLUnits;return{u_camera_to_center_distance:E.cameraToCenterDistance,u_scale_with_map:+(v.paint.get("circle-pitch-scale")==="map"),u_matrix:b.translatePosMatrix(l.posMatrix,p,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_pitch_with_map:+P,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:z}},ks=(b,l,p)=>{const v=bi(p,1,l.zoom),E=Math.pow(2,l.zoom-p.tileID.overscaledZ),P=p.tileID.overscaleFactor();return{u_matrix:b,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:v,u_extrude_scale:[l.pixelsToGLUnits[0]/(v*E),l.pixelsToGLUnits[1]/(v*E)],u_overscale_factor:P}},ue=(b,l,p=1)=>({u_matrix:b,u_color:l,u_overlay:0,u_overlay_scale:p}),me=b=>({u_matrix:b}),Ie=(b,l,p,v)=>({u_matrix:b,u_extrude_scale:bi(l,1,p),u_intensity:v});function Qe(b,l){const p=Math.pow(2,l.canonical.z),v=l.canonical.y;return[new a.MercatorCoordinate(0,v/p).toLngLat().lat,new a.MercatorCoordinate(0,(v+1)/p).toLngLat().lat]}const gt=(b,l,p,v)=>{const E=b.transform;return{u_matrix:ki(b,l,p,v),u_ratio:1/bi(l,1,E.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Ut=(b,l,p,v,E)=>a.extend(gt(b,l,p,E),{u_image:0,u_image_height:v}),En=(b,l,p,v,E)=>{const P=b.transform,z=Tn(l,P);return{u_matrix:ki(b,l,p,E),u_texsize:l.imageAtlasTexture.size,u_ratio:1/bi(l,1,P.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[z,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},_i=(b,l,p,v,E,P)=>{const z=b.lineAtlas,N=Tn(l,b.transform),G=p.layout.get("line-cap")==="round",$=z.getDash(v.from,G),K=z.getDash(v.to,G),se=$.width*E.fromScale,ce=K.width*E.toScale;return a.extend(gt(b,l,p,P),{u_patternscale_a:[N/se,-$.height/2],u_patternscale_b:[N/ce,-K.height/2],u_sdfgamma:z.width/(256*Math.min(se,ce)*b.pixelRatio)/2,u_image:0,u_tex_y_a:$.y,u_tex_y_b:K.y,u_mix:E.t})};function Tn(b,l){return 1/bi(b,1,l.tileZoom)}function ki(b,l,p,v){return b.translatePosMatrix(v?v.posMatrix:l.tileID.posMatrix,l,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}const On=(b,l,p,v,E)=>{return{u_matrix:b,u_tl_parent:l,u_scale_parent:p,u_buffer_scale:1,u_fade_t:v.mix,u_opacity:v.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(z=E.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(P=E.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:f0(E.paint.get("raster-hue-rotate"))};var P,z};function f0(b){b*=Math.PI/180;const l=Math.sin(b),p=Math.cos(b);return[(2*p+1)/3,(-Math.sqrt(3)*l-p+1)/3,(Math.sqrt(3)*l-p+1)/3]}const A0=(b,l,p,v,E,P,z,N,G,$)=>{const K=E.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:K.width/K.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:z,u_coord_matrix:N,u_is_text:+G,u_pitch_with_map:+v,u_texsize:$,u_texture:0}},d0=(b,l,p,v,E,P,z,N,G,$,K)=>{const se=E.transform;return a.extend(A0(b,l,p,v,E,P,z,N,G,$),{u_gamma_scale:v?Math.cos(se._pitch)*se.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:+K})},Iu=(b,l,p,v,E,P,z,N,G,$)=>a.extend(d0(b,l,p,v,E,P,z,N,!0,G,!0),{u_texsize_icon:$,u_texture_icon:1}),z1=(b,l,p)=>({u_matrix:b,u_opacity:l,u_color:p}),ku=(b,l,p,v,E,P)=>a.extend(function(z,N,G,$){const K=G.imageManager.getPattern(z.from.toString()),se=G.imageManager.getPattern(z.to.toString()),{width:ce,height:xe}=G.imageManager.getPixelSize(),ve=Math.pow(2,$.tileID.overscaledZ),le=$.tileSize*Math.pow(2,G.transform.tileZoom)/ve,ye=le*($.tileID.canonical.x+$.tileID.wrap*ve),ze=le*$.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:K.tl,u_pattern_br_a:K.br,u_pattern_tl_b:se.tl,u_pattern_br_b:se.br,u_texsize:[ce,xe],u_mix:N.t,u_pattern_size_a:K.displaySize,u_pattern_size_b:se.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/bi($,1,G.transform.tileZoom),u_pixel_coord_upper:[ye>>16,ze>>16],u_pixel_coord_lower:[65535&ye,65535&ze]}}(v,P,p,E),{u_matrix:b,u_opacity:l}),ol={fillExtrusion:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_lightpos:new a.Uniform3f(b,l.u_lightpos),u_lightintensity:new a.Uniform1f(b,l.u_lightintensity),u_lightcolor:new a.Uniform3f(b,l.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,l.u_vertical_gradient),u_opacity:new a.Uniform1f(b,l.u_opacity)}),fillExtrusionPattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_lightpos:new a.Uniform3f(b,l.u_lightpos),u_lightintensity:new a.Uniform1f(b,l.u_lightintensity),u_lightcolor:new a.Uniform3f(b,l.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,l.u_vertical_gradient),u_height_factor:new a.Uniform1f(b,l.u_height_factor),u_image:new a.Uniform1i(b,l.u_image),u_texsize:new a.Uniform2f(b,l.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,l.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,l.u_scale),u_fade:new a.Uniform1f(b,l.u_fade),u_opacity:new a.Uniform1f(b,l.u_opacity)}),fill:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),fillPattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_image:new a.Uniform1i(b,l.u_image),u_texsize:new a.Uniform2f(b,l.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,l.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,l.u_scale),u_fade:new a.Uniform1f(b,l.u_fade)}),fillOutline:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_world:new a.Uniform2f(b,l.u_world)}),fillOutlinePattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_world:new a.Uniform2f(b,l.u_world),u_image:new a.Uniform1i(b,l.u_image),u_texsize:new a.Uniform2f(b,l.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,l.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,l.u_scale),u_fade:new a.Uniform1f(b,l.u_fade)}),circle:(b,l)=>({u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(b,l.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(b,l.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(b,l.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),collisionBox:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(b,l.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(b,l.u_extrude_scale),u_overscale_factor:new a.Uniform1f(b,l.u_overscale_factor)}),collisionCircle:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_inv_matrix:new a.UniformMatrix4f(b,l.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(b,l.u_viewport_size)}),debug:(b,l)=>({u_color:new a.UniformColor(b,l.u_color),u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_overlay:new a.Uniform1i(b,l.u_overlay),u_overlay_scale:new a.Uniform1f(b,l.u_overlay_scale)}),clippingMask:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),heatmap:(b,l)=>({u_extrude_scale:new a.Uniform1f(b,l.u_extrude_scale),u_intensity:new a.Uniform1f(b,l.u_intensity),u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),heatmapTexture:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_world:new a.Uniform2f(b,l.u_world),u_image:new a.Uniform1i(b,l.u_image),u_color_ramp:new a.Uniform1i(b,l.u_color_ramp),u_opacity:new a.Uniform1f(b,l.u_opacity)}),hillshade:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_image:new a.Uniform1i(b,l.u_image),u_latrange:new a.Uniform2f(b,l.u_latrange),u_light:new a.Uniform2f(b,l.u_light),u_shadow:new a.UniformColor(b,l.u_shadow),u_highlight:new a.UniformColor(b,l.u_highlight),u_accent:new a.UniformColor(b,l.u_accent)}),hillshadePrepare:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_image:new a.Uniform1i(b,l.u_image),u_dimension:new a.Uniform2f(b,l.u_dimension),u_zoom:new a.Uniform1f(b,l.u_zoom),u_unpack:new a.Uniform4f(b,l.u_unpack)}),line:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_ratio:new a.Uniform1f(b,l.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,l.u_units_to_pixels)}),lineGradient:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_ratio:new a.Uniform1f(b,l.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,l.u_units_to_pixels),u_image:new a.Uniform1i(b,l.u_image),u_image_height:new a.Uniform1f(b,l.u_image_height)}),linePattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_texsize:new a.Uniform2f(b,l.u_texsize),u_ratio:new a.Uniform1f(b,l.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_image:new a.Uniform1i(b,l.u_image),u_units_to_pixels:new a.Uniform2f(b,l.u_units_to_pixels),u_scale:new a.Uniform3f(b,l.u_scale),u_fade:new a.Uniform1f(b,l.u_fade)}),lineSDF:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_ratio:new a.Uniform1f(b,l.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,l.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(b,l.u_patternscale_a),u_patternscale_b:new a.Uniform2f(b,l.u_patternscale_b),u_sdfgamma:new a.Uniform1f(b,l.u_sdfgamma),u_image:new a.Uniform1i(b,l.u_image),u_tex_y_a:new a.Uniform1f(b,l.u_tex_y_a),u_tex_y_b:new a.Uniform1f(b,l.u_tex_y_b),u_mix:new a.Uniform1f(b,l.u_mix)}),raster:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_tl_parent:new a.Uniform2f(b,l.u_tl_parent),u_scale_parent:new a.Uniform1f(b,l.u_scale_parent),u_buffer_scale:new a.Uniform1f(b,l.u_buffer_scale),u_fade_t:new a.Uniform1f(b,l.u_fade_t),u_opacity:new a.Uniform1f(b,l.u_opacity),u_image0:new a.Uniform1i(b,l.u_image0),u_image1:new a.Uniform1i(b,l.u_image1),u_brightness_low:new a.Uniform1f(b,l.u_brightness_low),u_brightness_high:new a.Uniform1f(b,l.u_brightness_high),u_saturation_factor:new a.Uniform1f(b,l.u_saturation_factor),u_contrast_factor:new a.Uniform1f(b,l.u_contrast_factor),u_spin_weights:new a.Uniform3f(b,l.u_spin_weights)}),symbolIcon:(b,l)=>({u_is_size_zoom_constant:new a.Uniform1i(b,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,l.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,l.u_size_t),u_size:new a.Uniform1f(b,l.u_size),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,l.u_pitch),u_rotate_symbol:new a.Uniform1i(b,l.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,l.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,l.u_fade_change),u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,l.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,l.u_coord_matrix),u_is_text:new a.Uniform1i(b,l.u_is_text),u_pitch_with_map:new a.Uniform1i(b,l.u_pitch_with_map),u_texsize:new a.Uniform2f(b,l.u_texsize),u_texture:new a.Uniform1i(b,l.u_texture)}),symbolSDF:(b,l)=>({u_is_size_zoom_constant:new a.Uniform1i(b,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,l.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,l.u_size_t),u_size:new a.Uniform1f(b,l.u_size),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,l.u_pitch),u_rotate_symbol:new a.Uniform1i(b,l.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,l.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,l.u_fade_change),u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,l.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,l.u_coord_matrix),u_is_text:new a.Uniform1i(b,l.u_is_text),u_pitch_with_map:new a.Uniform1i(b,l.u_pitch_with_map),u_texsize:new a.Uniform2f(b,l.u_texsize),u_texture:new a.Uniform1i(b,l.u_texture),u_gamma_scale:new a.Uniform1f(b,l.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(b,l.u_is_halo)}),symbolTextAndIcon:(b,l)=>({u_is_size_zoom_constant:new a.Uniform1i(b,l.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,l.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,l.u_size_t),u_size:new a.Uniform1f(b,l.u_size),u_camera_to_center_distance:new a.Uniform1f(b,l.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,l.u_pitch),u_rotate_symbol:new a.Uniform1i(b,l.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,l.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,l.u_fade_change),u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,l.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,l.u_coord_matrix),u_is_text:new a.Uniform1i(b,l.u_is_text),u_pitch_with_map:new a.Uniform1i(b,l.u_pitch_with_map),u_texsize:new a.Uniform2f(b,l.u_texsize),u_texsize_icon:new a.Uniform2f(b,l.u_texsize_icon),u_texture:new a.Uniform1i(b,l.u_texture),u_texture_icon:new a.Uniform1i(b,l.u_texture_icon),u_gamma_scale:new a.Uniform1f(b,l.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(b,l.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(b,l.u_is_halo)}),background:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_opacity:new a.Uniform1f(b,l.u_opacity),u_color:new a.UniformColor(b,l.u_color)}),backgroundPattern:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_opacity:new a.Uniform1f(b,l.u_opacity),u_image:new a.Uniform1i(b,l.u_image),u_pattern_tl_a:new a.Uniform2f(b,l.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(b,l.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(b,l.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(b,l.u_pattern_br_b),u_texsize:new a.Uniform2f(b,l.u_texsize),u_mix:new a.Uniform1f(b,l.u_mix),u_pattern_size_a:new a.Uniform2f(b,l.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(b,l.u_pattern_size_b),u_scale_a:new a.Uniform1f(b,l.u_scale_a),u_scale_b:new a.Uniform1f(b,l.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(b,l.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,l.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(b,l.u_tile_units_to_pixels)}),terrain:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_texture:new a.Uniform1i(b,l.u_texture)}),terrainDepth:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix)}),terrainCoords:(b,l)=>({u_matrix:new a.UniformMatrix4f(b,l.u_matrix),u_texture:new a.Uniform1i(b,l.u_texture),u_terrain_coords_id:new a.Uniform1f(b,l.u_terrain_coords_id)})};class al{constructor(l,p,v){this.context=l;const E=l.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const p=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const fc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ac{constructor(l,p,v,E){this.length=p.length,this.attributes=v,this.itemSize=p.bytesPerElement,this.dynamicDraw=E,this.context=l;const P=l.gl;this.buffer=P.createBuffer(),l.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,p){for(let v=0;v<this.attributes.length;v++){const E=p.attributes[this.attributes[v].name];E!==void 0&&l.enableVertexAttribArray(E)}}setVertexAttribPointers(l,p,v){for(let E=0;E<this.attributes.length;E++){const P=this.attributes[E],z=p.attributes[P.name];z!==void 0&&l.vertexAttribPointer(z,P.components,l[fc[P.type]],!1,this.itemSize,P.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qn{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class dc extends qn{getDefault(){return a.Color.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Lu extends qn{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class ll extends qn{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class cl extends qn{getDefault(){return[!0,!0,!0,!0]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Du extends qn{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class ui extends qn{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class Zs extends qn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const p=this.current;(l.func!==p.func||l.ref!==p.ref||l.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class qi extends qn{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Sa extends qn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=l,this.dirty=!1}}class p0 extends qn{getDefault(){return[0,1]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class Ca extends qn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=l,this.dirty=!1}}class m0 extends qn{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class pc extends qn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.BLEND):p.disable(p.BLEND),this.current=l,this.dirty=!1}}class mc extends qn{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class ul extends qn{getDefault(){return a.Color.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class hl extends qn{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class wo extends qn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=l,this.dirty=!1}}class $o extends qn{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Ru extends qn{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class g0 extends qn{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class qo extends qn{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class bo extends qn{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class zu extends qn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Bu extends qn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class fl extends qn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class _0 extends qn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class gc extends qn{getDefault(){return null}set(l){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class y0 extends qn{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class Pa extends qn{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Ou extends qn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Fu extends qn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class v0 extends qn{constructor(l,p){super(l),this.context=l,this.parent=p}getDefault(){return null}}class Zo extends v0{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Nu extends v0{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Ma{constructor(l,p,v,E){this.context=l,this.width=p,this.height=v;const P=l.gl,z=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new Zo(l,z),E&&(this.depthAttachment=new Nu(l,z)),P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,p=this.colorAttachment.get();if(p&&l.deleteTexture(p),this.depthAttachment){const v=this.depthAttachment.get();v&&l.deleteRenderbuffer(v)}l.deleteFramebuffer(this.framebuffer)}}class di{constructor(l,p,v){this.blendFunction=l,this.blendColor=p,this.mask=v}}di.Replace=[1,0],di.disabled=new di(di.Replace,a.Color.transparent,[!1,!1,!1,!1]),di.unblended=new di(di.Replace,a.Color.transparent,[!0,!0,!0,!0]),di.alphaBlended=new di([1,771],a.Color.transparent,[!0,!0,!0,!0]);class Al{constructor(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new dc(this),this.clearDepth=new Lu(this),this.clearStencil=new ll(this),this.colorMask=new cl(this),this.depthMask=new Du(this),this.stencilMask=new ui(this),this.stencilFunc=new Zs(this),this.stencilOp=new qi(this),this.stencilTest=new Sa(this),this.depthRange=new p0(this),this.depthTest=new Ca(this),this.depthFunc=new m0(this),this.blend=new pc(this),this.blendFunc=new mc(this),this.blendColor=new ul(this),this.blendEquation=new hl(this),this.cullFace=new wo(this),this.cullFaceSide=new $o(this),this.frontFace=new Ru(this),this.program=new g0(this),this.activeTexture=new qo(this),this.viewport=new bo(this),this.bindFramebuffer=new zu(this),this.bindRenderbuffer=new Bu(this),this.bindTexture=new fl(this),this.bindVertexBuffer=new _0(this),this.bindElementBuffer=new gc(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new y0(this),this.pixelStoreUnpack=new Pa(this),this.pixelStoreUnpackPremultiplyAlpha=new Ou(this),this.pixelStoreUnpackFlipY=new Fu(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,p){return new al(this,l,p)}createVertexBuffer(l,p,v){return new Ac(this,l,p,v)}createRenderbuffer(l,p,v){const E=this.gl,P=E.createRenderbuffer();return this.bindRenderbuffer.set(P),E.renderbufferStorage(E.RENDERBUFFER,l,p,v),this.bindRenderbuffer.set(null),P}createFramebuffer(l,p,v){return new Ma(this,l,p,v)}clear({color:l,depth:p}){const v=this.gl;let E=0;l&&(E|=v.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(E|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),v.clear(E)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){R(l.blendFunction,di.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Rn{constructor(l,p,v){this.func=l,this.mask=p,this.range=v}}Rn.ReadOnly=!1,Rn.ReadWrite=!0,Rn.disabled=new Rn(519,Rn.ReadOnly,[0,1]);const Qn=7680;class fi{constructor(l,p,v,E,P,z){this.test=l,this.ref=p,this.mask=v,this.fail=E,this.depthFail=P,this.pass=z}}fi.disabled=new fi({func:519,mask:0},0,0,Qn,Qn,Qn);class ii{constructor(l,p,v){this.enable=l,this.mode=p,this.frontFace=v}}let dl;function Eo(b,l,p,v,E,P,z){const N=b.context,G=N.gl,$=b.useProgram("collisionBox"),K=[];let se=0,ce=0;for(let Se=0;Se<v.length;Se++){const Xe=v[Se],He=l.getTile(Xe),it=He.getBucket(p);if(!it)continue;let Je=Xe.posMatrix;E[0]===0&&E[1]===0||(Je=b.translatePosMatrix(Xe.posMatrix,He,E,P));const d=z?it.textCollisionBox:it.iconCollisionBox,A=it.collisionCircleArray;if(A.length>0){const m=a.create(),_=Je;a.mul(m,it.placementInvProjMatrix,b.transform.glCoordMatrix),a.mul(m,m,it.placementViewportMatrix),K.push({circleArray:A,circleOffset:ce,transform:_,invTransform:m,coord:Xe}),se+=A.length/4,ce=se}d&&$.draw(N,G.LINES,Rn.disabled,fi.disabled,b.colorModeForRenderPass(),ii.disabled,ks(Je,b.transform,He),b.style.terrain&&b.style.terrain.getTerrainData(Xe),p.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,null,b.transform.zoom,null,null,d.collisionVertexBuffer)}if(!z||!K.length)return;const xe=b.useProgram("collisionCircle"),ve=new a.CollisionCircleLayoutArray;ve.resize(4*se),ve._trim();let le=0;for(const Se of K)for(let Xe=0;Xe<Se.circleArray.length/4;Xe++){const He=4*Xe,it=Se.circleArray[He+0],Je=Se.circleArray[He+1],d=Se.circleArray[He+2],A=Se.circleArray[He+3];ve.emplace(le++,it,Je,d,A,0),ve.emplace(le++,it,Je,d,A,1),ve.emplace(le++,it,Je,d,A,2),ve.emplace(le++,it,Je,d,A,3)}(!dl||dl.length<2*se)&&(dl=function(Se){const Xe=2*Se,He=new a.QuadTriangleArray;He.resize(Xe),He._trim();for(let it=0;it<Xe;it++){const Je=6*it;He.uint16[Je+0]=4*it+0,He.uint16[Je+1]=4*it+1,He.uint16[Je+2]=4*it+2,He.uint16[Je+3]=4*it+2,He.uint16[Je+4]=4*it+3,He.uint16[Je+5]=4*it+0}return He}(se));const ye=N.createIndexBuffer(dl,!0),ze=N.createVertexBuffer(ve,a.collisionCircleLayout.members,!0);for(const Se of K){const Xe={u_matrix:Se.transform,u_inv_matrix:Se.invTransform,u_camera_to_center_distance:(je=b.transform).cameraToCenterDistance,u_viewport_size:[je.width,je.height]};xe.draw(N,G.TRIANGLES,Rn.disabled,fi.disabled,b.colorModeForRenderPass(),ii.disabled,Xe,b.style.terrain&&b.style.terrain.getTerrainData(Se.coord),p.id,ze,ye,a.SegmentVector.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,b.transform.zoom,null,null,null)}var je;ze.destroy(),ye.destroy()}ii.disabled=new ii(!1,1029,2305),ii.backCCW=new ii(!0,1029,2305);const Uu=a.identity(new Float32Array(16));function Ia(b,l,p,v,E,P){const{horizontalAlign:z,verticalAlign:N}=a.getAnchorAlignment(b),G=-(z-.5)*l,$=-(N-.5)*p,K=a.evaluateVariableOffset(b,v);return new a.pointGeometry((G/E+K[0])*P,($/E+K[1])*P)}function Vu(b,l,p,v,E,P,z,N,G,$,K){const se=b.text.placedSymbolArray,ce=b.text.dynamicLayoutVertexArray,xe=b.icon.dynamicLayoutVertexArray,ve={};ce.clear();for(let le=0;le<se.length;le++){const ye=se.get(le),ze=b.allowVerticalPlacement&&!ye.placedOrientation,je=ye.hidden||!ye.crossTileID||ze?null:v[ye.crossTileID];if(je){const Se=new a.pointGeometry(ye.anchorX,ye.anchorY),Xe=In(Se,p?z:P,K),He=wr(E.cameraToCenterDistance,Xe.signedDistanceFromCamera);let it=a.evaluateSizeForFeature(b.textSizeData,G,ye)*He/a.ONE_EM;p&&(it*=b.tilePixelRatio/N);const{width:Je,height:d,anchor:A,textOffset:m,textBoxScale:_}=je,x=Ia(A,Je,d,m,_,it),S=p?In(Se.add(x),P,K).point:Xe.point.add(l?x.rotate(-E.angle):x),M=b.allowVerticalPlacement&&ye.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let L=0;L<ye.numGlyphs;L++)a.addDynamicAttributes(ce,S,M);$&&ye.associatedIconIndex>=0&&(ve[ye.associatedIconIndex]={shiftedAnchor:S,angle:M})}else un(ye.numGlyphs,ce)}if($){xe.clear();const le=b.icon.placedSymbolArray;for(let ye=0;ye<le.length;ye++){const ze=le.get(ye);if(ze.hidden)un(ze.numGlyphs,xe);else{const je=ve[ye];if(je)for(let Se=0;Se<ze.numGlyphs;Se++)a.addDynamicAttributes(xe,je.shiftedAnchor,je.angle);else un(ze.numGlyphs,xe)}}b.icon.dynamicLayoutVertexBuffer.updateData(xe)}b.text.dynamicLayoutVertexBuffer.updateData(ce)}function _c(b,l,p){return p.iconsInText&&l?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function pl(b,l,p,v,E,P,z,N,G,$,K,se){const ce=b.context,xe=ce.gl,ve=b.transform,le=N==="map",ye=G==="map",ze=N!=="viewport"&&p.layout.get("symbol-placement")!=="point",je=le&&!ye&&!ze,Se=!p.layout.get("symbol-sort-key").isConstant();let Xe=!1;const He=b.depthModeForSublayer(0,Rn.ReadOnly),it=p.layout.get("text-variable-anchor"),Je=[];for(const d of v){const A=l.getTile(d),m=A.getBucket(p);if(!m)continue;const _=E?m.text:m.icon;if(!_||!_.segments.get().length)continue;const x=_.programConfigurations.get(p.id),S=E||m.sdfIcons,M=E?m.textSizeData:m.iconSizeData,L=ye||ve.pitch!==0,O=b.useProgram(_c(S,E,m),x),H=a.evaluateSizeForZoom(M,ve.zoom),ee=b.style.terrain&&b.style.terrain.getTerrainData(d);let Ae,we,Re,Te,Be=[0,0],tt=null;if(E){if(we=A.glyphAtlasTexture,Re=xe.LINEAR,Ae=A.glyphAtlasTexture.size,m.iconsInText){Be=A.imageAtlasTexture.size,tt=A.imageAtlasTexture;const an=M.kind==="composite"||M.kind==="camera";Te=L||b.options.rotating||b.options.zooming||an?xe.LINEAR:xe.NEAREST}}else{const an=p.layout.get("icon-size").constantOr(0)!==1||m.iconsNeedLinear;we=A.imageAtlasTexture,Re=S||b.options.rotating||b.options.zooming||an||L?xe.LINEAR:xe.NEAREST,Ae=A.imageAtlasTexture.size}const Ke=bi(A,1,b.transform.zoom),We=Ms(d.posMatrix,ye,le,b.transform,Ke),$e=or(d.posMatrix,ye,le,b.transform,Ke),Oe=it&&m.hasTextData(),It=p.layout.get("icon-text-fit")!=="none"&&Oe&&m.hasIconData();if(ze){const an=b.style.terrain?(vn,Zn)=>b.style.terrain.getElevation(d,vn,Zn):null,fn=p.layout.get("text-rotation-alignment")==="map";dr(m,d.posMatrix,b,E,We,$e,ye,$,fn,an)}const Et=b.translatePosMatrix(d.posMatrix,A,P,z),st=ze||E&&it||It?Uu:We,dt=b.translatePosMatrix($e,A,P,z,!0),gn=S&&p.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let hn;hn=S?m.iconsInText?Iu(M.kind,H,je,ye,b,Et,st,dt,Ae,Be):d0(M.kind,H,je,ye,b,Et,st,dt,E,Ae,!0):A0(M.kind,H,je,ye,b,Et,st,dt,E,Ae);const sn={program:O,buffers:_,uniformValues:hn,atlasTexture:we,atlasTextureIcon:tt,atlasInterpolation:Re,atlasInterpolationIcon:Te,isSDF:S,hasHalo:gn};if(Se&&m.canOverlap){Xe=!0;const an=_.segments.get();for(const fn of an)Je.push({segments:new a.SegmentVector([fn]),sortKey:fn.sortKey,state:sn,terrainData:ee})}else Je.push({segments:_.segments,sortKey:0,state:sn,terrainData:ee})}Xe&&Je.sort((d,A)=>d.sortKey-A.sortKey);for(const d of Je){const A=d.state;if(ce.activeTexture.set(xe.TEXTURE0),A.atlasTexture.bind(A.atlasInterpolation,xe.CLAMP_TO_EDGE),A.atlasTextureIcon&&(ce.activeTexture.set(xe.TEXTURE1),A.atlasTextureIcon&&A.atlasTextureIcon.bind(A.atlasInterpolationIcon,xe.CLAMP_TO_EDGE)),A.isSDF){const m=A.uniformValues;A.hasHalo&&(m.u_is_halo=1,ml(A.buffers,d.segments,p,b,A.program,He,K,se,m,d.terrainData)),m.u_is_halo=0}ml(A.buffers,d.segments,p,b,A.program,He,K,se,A.uniformValues,d.terrainData)}}function ml(b,l,p,v,E,P,z,N,G,$){const K=v.context;E.draw(K,K.gl.TRIANGLES,P,z,N,ii.disabled,G,$,p.id,b.layoutVertexBuffer,b.indexBuffer,l,p.paint,v.transform.zoom,b.programConfigurations.get(p.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function ka(b,l,p,v,E,P,z){const N=b.context.gl,G=p.paint.get("fill-pattern"),$=G&&G.constantOr(1),K=p.getCrossfadeParameters();let se,ce,xe,ve,le;z?(ce=$&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",se=N.LINES):(ce=$?"fillPattern":"fill",se=N.TRIANGLES);for(const ye of v){const ze=l.getTile(ye);if($&&!ze.patternsLoaded())continue;const je=ze.getBucket(p);if(!je)continue;const Se=je.programConfigurations.get(p.id),Xe=b.useProgram(ce,Se),He=b.style.terrain&&b.style.terrain.getTerrainData(ye);$&&(b.context.activeTexture.set(N.TEXTURE0),ze.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Se.updatePaintBuffers(K));const it=G.constantOr(null);if(it&&ze.imageAtlas){const A=ze.imageAtlas,m=A.patternPositions[it.to.toString()],_=A.patternPositions[it.from.toString()];m&&_&&Se.setConstantPatternPositions(m,_)}const Je=He?ye:null,d=b.translatePosMatrix(Je?Je.posMatrix:ye.posMatrix,ze,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(z){ve=je.indexBuffer2,le=je.segments2;const A=[N.drawingBufferWidth,N.drawingBufferHeight];xe=ce==="fillOutlinePattern"&&$?rl(d,b,K,ze,A):Ta(d,A)}else ve=je.indexBuffer,le=je.segments,xe=$?Ea(d,b,K,ze):ba(d);Xe.draw(b.context,se,E,b.stencilModeForClipping(ye),P,ii.disabled,xe,He,p.id,je.layoutVertexBuffer,ve,le,p.paint,b.transform.zoom,Se)}}function Xo(b,l,p,v,E,P,z){const N=b.context,G=N.gl,$=p.paint.get("fill-extrusion-pattern"),K=$.constantOr(1),se=p.getCrossfadeParameters(),ce=p.paint.get("fill-extrusion-opacity");for(const xe of v){const ve=l.getTile(xe),le=ve.getBucket(p);if(!le)continue;const ye=b.style.terrain&&b.style.terrain.getTerrainData(xe),ze=le.programConfigurations.get(p.id),je=b.useProgram(K?"fillExtrusionPattern":"fillExtrusion",ze);K&&(b.context.activeTexture.set(G.TEXTURE0),ve.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),ze.updatePaintBuffers(se));const Se=$.constantOr(null);if(Se&&ve.imageAtlas){const Je=ve.imageAtlas,d=Je.patternPositions[Se.to.toString()],A=Je.patternPositions[Se.from.toString()];d&&A&&ze.setConstantPatternPositions(d,A)}const Xe=b.translatePosMatrix(xe.posMatrix,ve,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),He=p.paint.get("fill-extrusion-vertical-gradient"),it=K?fs(Xe,b,He,ce,xe,se,ve):xo(Xe,b,He,ce);je.draw(N,N.gl.TRIANGLES,E,P,z,ii.backCCW,it,ye,p.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,p.paint,b.transform.zoom,ze,b.style.terrain&&le.centroidVertexBuffer)}}function gl(b,l,p,v,E,P,z){const N=b.context,G=N.gl,$=p.fbo;if(!$)return;const K=b.useProgram("hillshade"),se=b.style.terrain&&b.style.terrain.getTerrainData(l);N.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,$.colorAttachment.get()),K.draw(N,G.TRIANGLES,E,P,z,ii.disabled,((ce,xe,ve,le)=>{const ye=ve.paint.get("hillshade-shadow-color"),ze=ve.paint.get("hillshade-highlight-color"),je=ve.paint.get("hillshade-accent-color");let Se=ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);ve.paint.get("hillshade-illumination-anchor")==="viewport"&&(Se-=ce.transform.angle);const Xe=!ce.options.moving;return{u_matrix:le?le.posMatrix:ce.transform.calculatePosMatrix(xe.tileID.toUnwrapped(),Xe),u_image:0,u_latrange:Qe(0,xe.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),Se],u_shadow:ye,u_highlight:ze,u_accent:je}})(b,p,v,se?l:null),se,v.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}function _l(b,l,p,v,E,P){const z=b.context,N=z.gl,G=l.dem;if(G&&G.data){const $=G.dim,K=G.stride,se=G.getPixels();if(z.activeTexture.set(N.TEXTURE1),z.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||b.getTileTexture(K),l.demTexture){const xe=l.demTexture;xe.update(se,{premultiply:!1}),xe.bind(N.NEAREST,N.CLAMP_TO_EDGE)}else l.demTexture=new ne(z,se,N.RGBA,{premultiply:!1}),l.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);z.activeTexture.set(N.TEXTURE0);let ce=l.fbo;if(!ce){const xe=new ne(z,{width:$,height:$,data:null},N.RGBA);xe.bind(N.LINEAR,N.CLAMP_TO_EDGE),ce=l.fbo=z.createFramebuffer($,$,!0),ce.colorAttachment.set(xe.texture)}z.bindFramebuffer.set(ce.framebuffer),z.viewport.set([0,0,$,$]),b.useProgram("hillshadePrepare").draw(z,N.TRIANGLES,v,E,P,ii.disabled,((xe,ve)=>{const le=ve.stride,ye=a.create();return a.ortho(ye,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(ye,ye,[0,-a.EXTENT,0]),{u_matrix:ye,u_image:1,u_dimension:[le,le],u_zoom:xe.overscaledZ,u_unpack:ve.getUnpackVector()}})(l.tileID,G),null,p.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function ri(b,l,p,v,E,P){const z=v.paint.get("raster-fade-duration");if(!P&&z>0){const N=a.exported.now(),G=(N-b.timeAdded)/z,$=l?(N-l.timeAdded)/z:-1,K=p.getSource(),se=E.coveringZoomLevel({tileSize:K.tileSize,roundZoom:K.roundZoom}),ce=!l||Math.abs(l.tileID.overscaledZ-se)>Math.abs(b.tileID.overscaledZ-se),xe=ce&&b.refreshedUponExpiration?1:a.clamp(ce?G:1-$,0,1);return b.refreshedUponExpiration&&G>=1&&(b.refreshedUponExpiration=!1),l?{opacity:1,mix:1-xe}:{opacity:xe,mix:0}}return{opacity:1,mix:0}}const x0=new a.Color(1,0,0,1),As=new a.Color(0,1,0,1),Gu=new a.Color(0,0,1,1),yc=new a.Color(1,0,1,1),ju=new a.Color(0,1,1,1);function Qo(b,l,p,v){Ni(b,0,l+p/2,b.transform.width,p,v)}function yl(b,l,p,v){Ni(b,l-p/2,0,p,b.transform.height,v)}function Ni(b,l,p,v,E,P){const z=b.context,N=z.gl;N.enable(N.SCISSOR_TEST),N.scissor(l*b.pixelRatio,p*b.pixelRatio,v*b.pixelRatio,E*b.pixelRatio),z.clear({color:P}),N.disable(N.SCISSOR_TEST)}function vc(b,l,p){const v=b.context,E=v.gl,P=p.posMatrix,z=b.useProgram("debug"),N=Rn.disabled,G=fi.disabled,$=b.colorModeForRenderPass(),K="$debug",se=b.style.terrain&&b.style.terrain.getTerrainData(p);v.activeTexture.set(E.TEXTURE0),b.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE);const ce=l.getTileByID(p.key).latestRawTileData,xe=Math.floor((ce&&ce.byteLength||0)/1024),ve=l.getTile(p).tileSize,le=512/Math.min(ve,512)*(p.overscaledZ/b.transform.zoom)*.5;let ye=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(ye+=` => ${p.overscaledZ}`),function(ze,je){ze.initDebugOverlayCanvas();const Se=ze.debugOverlayCanvas,Xe=ze.context.gl,He=ze.debugOverlayCanvas.getContext("2d");He.clearRect(0,0,Se.width,Se.height),He.shadowColor="white",He.shadowBlur=2,He.lineWidth=1.5,He.strokeStyle="white",He.textBaseline="top",He.font="bold 36px Open Sans, sans-serif",He.fillText(je,5,5),He.strokeText(je,5,5),ze.debugOverlayTexture.update(Se),ze.debugOverlayTexture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE)}(b,`${ye} ${xe}kB`),z.draw(v,E.TRIANGLES,N,G,di.alphaBlended,ii.disabled,ue(P,a.Color.transparent,le),null,K,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),z.draw(v,E.LINE_STRIP,N,G,$,ii.disabled,ue(P,a.Color.red),se,K,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function Ls(b,l,p){const v=b.context,E=v.gl,P=b.colorModeForRenderPass(),z=new Rn(E.LEQUAL,Rn.ReadWrite,b.depthRangeFor3D),N=b.useProgram("terrain"),G=l.getTerrainMesh(),$=l.getTerrainData(p.tileID);v.bindFramebuffer.set(null),v.viewport.set([0,0,b.width,b.height]),v.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,l.getRTTFramebuffer().colorAttachment.get());const K=b.transform.calculatePosMatrix(p.tileID.toUnwrapped());N.draw(v,E.TRIANGLES,z,fi.disabled,P,ii.backCCW,{u_matrix:K,u_texture:0},$,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}function Hu(b,l,p,v){const E=b.context,P=p.tileSize*l.qualityFactor;p.textures[v]||(p.textures[v]=b.getTileTexture(P)||new ne(E,{width:P,height:P,data:null},E.gl.RGBA),p.textures[v].bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),v===0&&l.sourceCache.renderHistory.unshift(p.tileID.key));const z=l.getRTTFramebuffer();z.colorAttachment.set(p.textures[v].texture),E.bindFramebuffer.set(z.framebuffer),E.viewport.set([0,0,P,P])}class w0{constructor(l){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=l,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=l.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const l=this.painter.style,p=l.terrain;for(const v in l.sourceCaches){this._coordsDescendingInv[v]={};const E=l.sourceCaches[v].getVisibleCoordinates();for(const P of E){const z=p.sourceCache.getTerrainCoords(P);for(const N in z)this._coordsDescendingInv[v][N]||(this._coordsDescendingInv[v][N]=[]),this._coordsDescendingInv[v][N].push(z[N])}}for(const v of l._order){const E=l._layers[v],P=E.source;if(this._renderToTexture[E.type]&&!this._coordsDescendingInvStr[P]){this._coordsDescendingInvStr[P]={};for(const z in this._coordsDescendingInv[P])this._coordsDescendingInvStr[P][z]=this._coordsDescendingInv[P][z].map(N=>N.key).sort().join()}}return this._renderableTiles.forEach(v=>{for(const E in this._coordsDescendingInvStr){const P=this._coordsDescendingInvStr[E][v.tileID.key];P&&P!==v.textureCoords[E]&&v.clearTextures(this.painter),p.needsRerender(E,v.tileID)&&v.clearTextures(this.painter)}this._rerender[v.tileID.key]=!v.textures.length}),p.clearRerenderCache(),p.sourceCache.removeOutdated(this.painter),this}renderLayer(l){const p=l.type,v=this.painter,E=v.style._order,P=v.currentLayer,z=P+1===E.length;if(this._renderToTexture[p]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=p,this._stacks[this._stacks.length-1].push(E[P]),!z))return!0;if(this._renderToTexture[this._prevType]||p==="hillshade"||this._renderToTexture[p]&&z){this._prevType=p;const N=this._stacks.length-1,G=this._stacks[N]||[];for(const $ of this._renderableTiles){if(Hu(v,v.style.terrain,$,N),this._rerender[$.tileID.key]){v.context.clear({color:a.Color.transparent});for(let K=0;K<G.length;K++){const se=v.style._layers[G[K]],ce=se.source?this._coordsDescendingInv[se.source][$.tileID.key]:[$.tileID];v._renderTileClippingMasks(se,ce),v.renderLayer(v,v.style.sourceCaches[se.source],se,ce),se.source&&($.textureCoords[se.source]=this._coordsDescendingInvStr[se.source][$.tileID.key])}}Ls(v,v.style.terrain,$)}if(p==="hillshade"){this._stacks.push([E[P]]);for(const $ of this._renderableTiles){const K=this._coordsDescendingInv[l.source][$.tileID.key];Hu(v,v.style.terrain,$,this._stacks.length-1),v.context.clear({color:a.Color.transparent}),v._renderTileClippingMasks(l,K),v.renderLayer(v,v.style.sourceCaches[l.source],l,K),Ls(v,v.style.terrain,$)}return!0}return this._renderToTexture[p]}return!1}}const vl={symbol:function(b,l,p,v,E){if(b.renderPass!=="translucent")return;const P=fi.disabled,z=b.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(N,G,$,K,se,ce,xe){const ve=G.transform,le=se==="map",ye=ce==="map";for(const ze of N){const je=K.getTile(ze),Se=je.getBucket($);if(!Se||!Se.text||!Se.text.segments.get().length)continue;const Xe=a.evaluateSizeForZoom(Se.textSizeData,ve.zoom),He=bi(je,1,G.transform.zoom),it=Ms(ze.posMatrix,ye,le,G.transform,He),Je=$.layout.get("icon-text-fit")!=="none"&&Se.hasIconData();if(Xe){const d=Math.pow(2,ve.zoom-je.tileID.overscaledZ);Vu(Se,le,ye,xe,ve,it,ze.posMatrix,d,Xe,Je,G.style.terrain?(A,m)=>G.style.terrain.getElevation(ze,A,m):null)}}}(v,b,p,l,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),E),p.paint.get("icon-opacity").constantOr(1)!==0&&pl(b,l,p,v,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),P,z),p.paint.get("text-opacity").constantOr(1)!==0&&pl(b,l,p,v,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),P,z),l.map.showCollisionBoxes&&(Eo(b,l,p,v,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),Eo(b,l,p,v,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(b,l,p,v){if(b.renderPass!=="translucent")return;const E=p.paint.get("circle-opacity"),P=p.paint.get("circle-stroke-width"),z=p.paint.get("circle-stroke-opacity"),N=!p.layout.get("circle-sort-key").isConstant();if(E.constantOr(1)===0&&(P.constantOr(1)===0||z.constantOr(1)===0))return;const G=b.context,$=G.gl,K=b.depthModeForSublayer(0,Rn.ReadOnly),se=fi.disabled,ce=b.colorModeForRenderPass(),xe=[];for(let ve=0;ve<v.length;ve++){const le=v[ve],ye=l.getTile(le),ze=ye.getBucket(p);if(!ze)continue;const je=ze.programConfigurations.get(p.id),Se=b.useProgram("circle",je),Xe=ze.layoutVertexBuffer,He=ze.indexBuffer,it=b.style.terrain&&b.style.terrain.getTerrainData(le),Je={programConfiguration:je,program:Se,layoutVertexBuffer:Xe,indexBuffer:He,uniformValues:sl(b,le,ye,p),terrainData:it};if(N){const d=ze.segments.get();for(const A of d)xe.push({segments:new a.SegmentVector([A]),sortKey:A.sortKey,state:Je})}else xe.push({segments:ze.segments,sortKey:0,state:Je})}N&&xe.sort((ve,le)=>ve.sortKey-le.sortKey);for(const ve of xe){const{programConfiguration:le,program:ye,layoutVertexBuffer:ze,indexBuffer:je,uniformValues:Se,terrainData:Xe}=ve.state;ye.draw(G,$.TRIANGLES,K,se,ce,ii.disabled,Se,Xe,p.id,ze,je,ve.segments,p.paint,b.transform.zoom,le)}},heatmap:function(b,l,p,v){if(p.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const E=b.context,P=E.gl,z=fi.disabled,N=new di([P.ONE,P.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(G,$,K){const se=G.gl;G.activeTexture.set(se.TEXTURE1),G.viewport.set([0,0,$.width/4,$.height/4]);let ce=K.heatmapFbo;if(ce)se.bindTexture(se.TEXTURE_2D,ce.colorAttachment.get()),G.bindFramebuffer.set(ce.framebuffer);else{const xe=se.createTexture();se.bindTexture(se.TEXTURE_2D,xe),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),ce=K.heatmapFbo=G.createFramebuffer($.width/4,$.height/4,!1),function(ve,le,ye,ze){const je=ve.gl;je.texImage2D(je.TEXTURE_2D,0,je.RGBA,le.width/4,le.height/4,0,je.RGBA,ve.extRenderToTextureHalfFloat?ve.extTextureHalfFloat.HALF_FLOAT_OES:je.UNSIGNED_BYTE,null),ze.colorAttachment.set(ye)}(G,$,xe,ce)}})(E,b,p),E.clear({color:a.Color.transparent});for(let G=0;G<v.length;G++){const $=v[G];if(l.hasRenderableParent($))continue;const K=l.getTile($),se=K.getBucket(p);if(!se)continue;const ce=se.programConfigurations.get(p.id),xe=b.useProgram("heatmap",ce),{zoom:ve}=b.transform;xe.draw(E,P.TRIANGLES,Rn.disabled,z,N,ii.disabled,Ie($.posMatrix,K,ve,p.paint.get("heatmap-intensity")),null,p.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,p.paint,b.transform.zoom,ce)}E.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(E,P){const z=E.context,N=z.gl,G=P.heatmapFbo;if(!G)return;z.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,G.colorAttachment.get()),z.activeTexture.set(N.TEXTURE1);let $=P.colorRampTexture;$||($=P.colorRampTexture=new ne(z,P.colorRamp,N.RGBA)),$.bind(N.LINEAR,N.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(z,N.TRIANGLES,Rn.disabled,fi.disabled,E.colorModeForRenderPass(),ii.disabled,((K,se,ce,xe)=>{const ve=a.create();a.ortho(ve,0,K.width,K.height,0,0,1);const le=K.context.gl;return{u_matrix:ve,u_world:[le.drawingBufferWidth,le.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:se.paint.get("heatmap-opacity")}})(E,P),null,P.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,P.paint,E.transform.zoom)}(b,p))},line:function(b,l,p,v){if(b.renderPass!=="translucent")return;const E=p.paint.get("line-opacity"),P=p.paint.get("line-width");if(E.constantOr(1)===0||P.constantOr(1)===0)return;const z=b.depthModeForSublayer(0,Rn.ReadOnly),N=b.colorModeForRenderPass(),G=p.paint.get("line-dasharray"),$=p.paint.get("line-pattern"),K=$.constantOr(1),se=p.paint.get("line-gradient"),ce=p.getCrossfadeParameters(),xe=K?"linePattern":G?"lineSDF":se?"lineGradient":"line",ve=b.context,le=ve.gl;let ye=!0;for(const ze of v){const je=l.getTile(ze);if(K&&!je.patternsLoaded())continue;const Se=je.getBucket(p);if(!Se)continue;const Xe=Se.programConfigurations.get(p.id),He=b.context.program.get(),it=b.useProgram(xe,Xe),Je=ye||it.program!==He,d=b.style.terrain&&b.style.terrain.getTerrainData(ze),A=$.constantOr(null);if(A&&je.imageAtlas){const x=je.imageAtlas,S=x.patternPositions[A.to.toString()],M=x.patternPositions[A.from.toString()];S&&M&&Xe.setConstantPatternPositions(S,M)}const m=d?ze:null,_=K?En(b,je,p,ce,m):G?_i(b,je,p,G,ce,m):se?Ut(b,je,p,Se.lineClipsArray.length,m):gt(b,je,p,m);if(K)ve.activeTexture.set(le.TEXTURE0),je.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),Xe.updatePaintBuffers(ce);else if(G&&(Je||b.lineAtlas.dirty))ve.activeTexture.set(le.TEXTURE0),b.lineAtlas.bind(ve);else if(se){const x=Se.gradients[p.id];let S=x.texture;if(p.gradientVersion!==x.version){let M=256;if(p.stepInterpolant){const L=l.getSource().maxzoom,O=ze.canonical.z===L?Math.ceil(1<<b.transform.maxZoom-ze.canonical.z):1;M=a.clamp(a.nextPowerOfTwo(Se.maxLineLength/a.EXTENT*1024*O),256,ve.maxTextureSize)}x.gradient=a.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:M,image:x.gradient||void 0,clips:Se.lineClipsArray}),x.texture?x.texture.update(x.gradient):x.texture=new ne(ve,x.gradient,le.RGBA),x.version=p.gradientVersion,S=x.texture}ve.activeTexture.set(le.TEXTURE0),S.bind(p.stepInterpolant?le.NEAREST:le.LINEAR,le.CLAMP_TO_EDGE)}it.draw(ve,le.TRIANGLES,z,b.stencilModeForClipping(ze),N,ii.disabled,_,d,p.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,p.paint,b.transform.zoom,Xe,Se.layoutVertexBuffer2),ye=!1}},fill:function(b,l,p,v){const E=p.paint.get("fill-color"),P=p.paint.get("fill-opacity");if(P.constantOr(1)===0)return;const z=b.colorModeForRenderPass(),N=p.paint.get("fill-pattern"),G=b.opaquePassEnabledForLayer()&&!N.constantOr(1)&&E.constantOr(a.Color.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===G){const $=b.depthModeForSublayer(1,b.renderPass==="opaque"?Rn.ReadWrite:Rn.ReadOnly);ka(b,l,p,v,$,z,!1)}if(b.renderPass==="translucent"&&p.paint.get("fill-antialias")){const $=b.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,Rn.ReadOnly);ka(b,l,p,v,$,z,!0)}},"fill-extrusion":function(b,l,p,v){const E=p.paint.get("fill-extrusion-opacity");if(E!==0&&b.renderPass==="translucent"){const P=new Rn(b.context.gl.LEQUAL,Rn.ReadWrite,b.depthRangeFor3D);if(E!==1||p.paint.get("fill-extrusion-pattern").constantOr(1))Xo(b,l,p,v,P,fi.disabled,di.disabled),Xo(b,l,p,v,P,b.stencilModeFor3D(),b.colorModeForRenderPass());else{const z=b.colorModeForRenderPass();Xo(b,l,p,v,P,fi.disabled,z)}}},hillshade:function(b,l,p,v){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const E=b.context,P=b.depthModeForSublayer(0,Rn.ReadOnly),z=b.colorModeForRenderPass(),[N,G]=b.renderPass==="translucent"?b.stencilConfigForOverlap(v):[{},v];for(const $ of G){const K=l.getTile($);K.needsHillshadePrepare!==void 0&&K.needsHillshadePrepare&&b.renderPass==="offscreen"?_l(b,K,p,P,fi.disabled,z):b.renderPass==="translucent"&&gl(b,$,K,p,P,N[$.overscaledZ],z)}E.viewport.set([0,0,b.width,b.height])},raster:function(b,l,p,v){if(b.renderPass!=="translucent"||p.paint.get("raster-opacity")===0||!v.length)return;const E=b.context,P=E.gl,z=l.getSource(),N=b.useProgram("raster"),G=b.colorModeForRenderPass(),[$,K]=z instanceof Bt?[{},v]:b.stencilConfigForOverlap(v),se=K[K.length-1].overscaledZ,ce=!b.options.moving;for(const xe of K){const ve=b.depthModeForSublayer(xe.overscaledZ-se,p.paint.get("raster-opacity")===1?Rn.ReadWrite:Rn.ReadOnly,P.LESS),le=l.getTile(xe);le.registerFadeDuration(p.paint.get("raster-fade-duration"));const ye=l.findLoadedParent(xe,0),ze=ri(le,ye,l,p,b.transform,b.style.terrain);let je,Se;const Xe=p.paint.get("raster-resampling")==="nearest"?P.NEAREST:P.LINEAR;E.activeTexture.set(P.TEXTURE0),le.texture.bind(Xe,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(P.TEXTURE1),ye?(ye.texture.bind(Xe,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),je=Math.pow(2,ye.tileID.overscaledZ-le.tileID.overscaledZ),Se=[le.tileID.canonical.x*je%1,le.tileID.canonical.y*je%1]):le.texture.bind(Xe,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST);const He=b.style.terrain&&b.style.terrain.getTerrainData(xe),it=He?xe:null,Je=it?it.posMatrix:b.transform.calculatePosMatrix(xe.toUnwrapped(),ce),d=On(Je,Se||[0,0],je||1,ze,p);z instanceof Bt?N.draw(E,P.TRIANGLES,ve,fi.disabled,G,ii.disabled,d,He,p.id,z.boundsBuffer,b.quadTriangleIndexBuffer,z.boundsSegments):N.draw(E,P.TRIANGLES,ve,$[xe.overscaledZ],G,ii.disabled,d,He,p.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}},background:function(b,l,p,v){const E=p.paint.get("background-color"),P=p.paint.get("background-opacity");if(P===0)return;const z=b.context,N=z.gl,G=b.transform,$=G.tileSize,K=p.paint.get("background-pattern");if(b.isPatternMissing(K))return;const se=!K&&E.a===1&&P===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==se)return;const ce=fi.disabled,xe=b.depthModeForSublayer(0,se==="opaque"?Rn.ReadWrite:Rn.ReadOnly),ve=b.colorModeForRenderPass(),le=b.useProgram(K?"backgroundPattern":"background"),ye=v||G.coveringTiles({tileSize:$,terrain:b.style.terrain});K&&(z.activeTexture.set(N.TEXTURE0),b.imageManager.bind(b.context));const ze=p.getCrossfadeParameters();for(const je of ye){const Se=v?je.posMatrix:b.transform.calculatePosMatrix(je.toUnwrapped()),Xe=K?ku(Se,P,b,K,{tileID:je,tileSize:$},ze):z1(Se,P,E),He=b.style.terrain&&b.style.terrain.getTerrainData(je);le.draw(z,N.TRIANGLES,xe,ce,ve,ii.disabled,Xe,He,p.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}},debug:function(b,l,p){for(let v=0;v<p.length;v++)vc(b,l,p[v])},custom:function(b,l,p){const v=b.context,E=p.implementation;if(b.renderPass==="offscreen"){const P=E.prerender;P&&(b.setCustomLayerDefaults(),v.setColorMode(b.colorModeForRenderPass()),P.call(E,v.gl,b.transform.customLayerMatrix()),v.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),v.setColorMode(b.colorModeForRenderPass()),v.setStencilMode(fi.disabled);const P=E.renderingMode==="3d"?new Rn(b.context.gl.LEQUAL,Rn.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,Rn.ReadOnly);v.setDepthMode(P),E.render(v.gl,b.transform.customLayerMatrix()),v.setDirty(),b.setBaseState(),v.bindFramebuffer.set(null)}}};class br{constructor(l,p){this.context=new Al(l),this.transform=p,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.create(),renderTime:0},this.setup(),this.numSublayers=At.maxUnderzooming+At.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gt,this.gpuTimers={}}resize(l,p,v){if(this.width=l*v,this.height=p*v,this.pixelRatio=v,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const E of this.style._order)this.style._layers[E].resize()}setup(){const l=this.context,p=new a.PosArray;p.emplaceBack(0,0),p.emplaceBack(a.EXTENT,0),p.emplaceBack(0,a.EXTENT),p.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(p,on.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const v=new a.PosArray;v.emplaceBack(0,0),v.emplaceBack(a.EXTENT,0),v.emplaceBack(0,a.EXTENT),v.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=l.createVertexBuffer(v,on.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const E=new a.RasterBoundsArray;E.emplaceBack(0,0,0,0),E.emplaceBack(a.EXTENT,0,a.EXTENT,0),E.emplaceBack(0,a.EXTENT,0,a.EXTENT),E.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(E,vt.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const P=new a.PosArray;P.emplaceBack(0,0),P.emplaceBack(1,0),P.emplaceBack(0,1),P.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(P,on.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const z=new a.LineStripIndexArray;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(z);const N=new a.TriangleIndexArray;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(N),this.emptyTexture=new ne(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);const G=this.context.gl;this.stencilClearMode=new fi({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO)}clearStencil(){const l=this.context,p=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const v=a.create();a.ortho(v,0,this.width,this.height,0,0,1),a.scale(v,v,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,p.TRIANGLES,Rn.disabled,this.stencilClearMode,di.disabled,ii.disabled,me(v),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,p){if(this.currentStencilSource===l.source||!l.isTileClipped()||!p||!p.length)return;this.currentStencilSource=l.source;const v=this.context,E=v.gl;this.nextStencilID+p.length>256&&this.clearStencil(),v.setColorMode(di.disabled),v.setDepthMode(Rn.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of p){const N=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,G=this.style.terrain&&this.style.terrain.getTerrainData(z);P.draw(v,E.TRIANGLES,Rn.disabled,new fi({func:E.ALWAYS,mask:0},N,255,E.KEEP,E.KEEP,E.REPLACE),di.disabled,ii.disabled,me(z.posMatrix),G,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,p=this.context.gl;return new fi({func:p.NOTEQUAL,mask:255},l,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(l){const p=this.context.gl;return new fi({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(l){const p=this.context.gl,v=l.sort((z,N)=>N.overscaledZ-z.overscaledZ),E=v[v.length-1].overscaledZ,P=v[0].overscaledZ-E+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const z={};for(let N=0;N<P;N++)z[N+E]=new fi({func:p.GEQUAL,mask:255},N+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=P,[z,v]}return[{[E]:fi.disabled},v]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new di([l.CONSTANT_COLOR,l.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?di.unblended:di.alphaBlended}depthModeForSublayer(l,p,v){if(!this.opaquePassEnabledForLayer())return Rn.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Rn(v||this.context.gl.LEQUAL,p,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,p){this.style=l,this.options=p,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const v=this.style._order,E=this.style.sourceCaches,P=this.style.terrain&&new w0(this);for(const $ in E){const K=E[$];K.used&&K.prepare(this.context)}const z={},N={},G={};for(const $ in E){const K=E[$];z[$]=K.getVisibleCoordinates(),N[$]=z[$].slice().reverse(),G[$]=K.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<v.length;$++)if(this.style._layers[v[$]].is3D()){this.opaquePassCutoff=$;break}if(P){this.opaquePassCutoff=0;const $=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||$.length)&&(a.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(K,se){const ce=K.context,xe=ce.gl,ve=di.unblended,le=new Rn(xe.LEQUAL,Rn.ReadWrite,[0,1]),ye=se.getTerrainMesh(),ze=se.sourceCache.getRenderableTiles(),je=K.useProgram("terrainDepth");ce.bindFramebuffer.set(se.getFramebuffer("depth").framebuffer),ce.viewport.set([0,0,K.width/devicePixelRatio,K.height/devicePixelRatio]),ce.clear({color:a.Color.transparent,depth:1});for(const Se of ze){const Xe=se.getTerrainData(Se.tileID),He=K.transform.calculatePosMatrix(Se.tileID.toUnwrapped());je.draw(ce,xe.TRIANGLES,le,fi.disabled,ve,ii.backCCW,{u_matrix:He},Xe,"terrain",ye.vertexBuffer,ye.indexBuffer,ye.segments)}ce.bindFramebuffer.set(null),ce.viewport.set([0,0,K.width,K.height])}(this,this.style.terrain),function(K,se){const ce=K.context,xe=ce.gl,ve=di.unblended,le=new Rn(xe.LEQUAL,Rn.ReadWrite,[0,1]),ye=se.getTerrainMesh(),ze=se.getCoordsTexture(),je=se.sourceCache.getRenderableTiles(),Se=K.useProgram("terrainCoords");ce.bindFramebuffer.set(se.getFramebuffer("coords").framebuffer),ce.viewport.set([0,0,K.width/devicePixelRatio,K.height/devicePixelRatio]),ce.clear({color:a.Color.transparent,depth:1}),se.coordsIndex=[];for(const Xe of je){const He=se.getTerrainData(Xe.tileID);ce.activeTexture.set(xe.TEXTURE0),xe.bindTexture(xe.TEXTURE_2D,ze.texture);const it=K.transform.calculatePosMatrix(Xe.tileID.toUnwrapped());Se.draw(ce,xe.TRIANGLES,le,fi.disabled,ve,ii.backCCW,{u_matrix:it,u_terrain_coords_id:(255-se.coordsIndex.length)/255,u_texture:0},He,"terrain",ye.vertexBuffer,ye.indexBuffer,ye.segments),se.coordsIndex.push(Xe.tileID.key)}ce.bindFramebuffer.set(null),ce.viewport.set([0,0,K.width,K.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const $ of v){const K=this.style._layers[$];if(!K.hasOffscreenPass()||K.isHidden(this.transform.zoom))continue;const se=N[K.source];(K.type==="custom"||se.length)&&this.renderLayer(this,E[K.source],K,se)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!P)for(this.renderPass="opaque",this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const $=this.style._layers[v[this.currentLayer]],K=E[$.source],se=z[$.source];this._renderTileClippingMasks($,se),this.renderLayer(this,K,$,se)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const $=this.style._layers[v[this.currentLayer]],K=E[$.source];if(P&&P.renderLayer($))continue;const se=($.type==="symbol"?G:N)[$.source];this._renderTileClippingMasks($,z[$.source]),this.renderLayer(this,K,$,se)}if(this.options.showTileBoundaries){let $,K;Object.values(this.style._layers).forEach(se=>{se.source&&!se.isHidden(this.transform.zoom)&&(se.source!==(K&&K.id)&&(K=this.style.sourceCaches[se.source]),(!$||$.getSource().maxzoom<K.getSource().maxzoom)&&($=K))}),$&&vl.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const K=$.transform.padding;Qo($,$.transform.height-(K.top||0),3,x0),Qo($,K.bottom||0,3,As),yl($,K.left||0,3,Gu),yl($,$.transform.width-(K.right||0),3,yc);const se=$.transform.centerPoint;(function(ce,xe,ve,le){Ni(ce,xe-1,ve-10,2,20,le),Ni(ce,xe-10,ve-1,20,2,le)})($,se.x,$.transform.height-se.y,ju)}(this),this.context.setDefault()}renderLayer(l,p,v,E){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="custom"||(E||[]).length)&&(this.id=v.id,this.gpuTimingStart(v),vl[v.type](l,p,v,E,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let v=this.gpuTimers[l.id];v||(v=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),v.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,v.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}queryGpuTimers(l){const p={};for(const v in l){const E=l[v],P=this.context.extTimerQuery,z=P.getQueryObjectEXT(E.query,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(E.query),p[v]=z}return p}translatePosMatrix(l,p,v,E,P){if(!v[0]&&!v[1])return l;const z=P?E==="map"?this.transform.angle:0:E==="viewport"?-this.transform.angle:0;if(z){const $=Math.sin(z),K=Math.cos(z);v=[v[0]*K-v[1]*$,v[0]*$+v[1]*K]}const N=[P?v[0]:bi(p,v[0],this.transform.zoom),P?v[1]:bi(p,v[1],this.transform.zoom),0],G=new Float32Array(16);return a.translate(G,l,N),G}saveTileTexture(l){const p=this._tileTextures[l.size[0]];p?p.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const p=this._tileTextures[l];return p&&p.length>0?p.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const p=this.imageManager.getPattern(l.from.toString()),v=this.imageManager.getPattern(l.to.toString());return!p||!v}useProgram(l,p){this.cache=this.cache||{};const v=l+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[v]||(this.cache[v]=new wa(this.context,l,$i[l],p,ol[l],this._showOverdrawInspector,this.style.terrain)),this.cache[v]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ne(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class xl{constructor(l,p){this.points=l,this.planes=p}static fromInvProjectionMatrix(l,p,v){const E=Math.pow(2,v),P=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const G=1/(N=a.transformMat4([],N,l))[3]/p*E;return a.mul$1(N,N,[G,G,1/N[3],G])}),z=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const G=a.sub([],P[N[0]],P[N[1]]),$=a.sub([],P[N[2]],P[N[1]]),K=a.normalize([],a.cross([],G,$)),se=-a.dot(K,P[N[1]]);return K.concat(se)});return new xl(P,z)}}class Yo{constructor(l,p){this.min=l,this.max=p,this.center=a.scale$1([],a.add([],this.min,this.max),.5)}quadrant(l){const p=[l%2==0,l<2],v=a.clone$2(this.min),E=a.clone$2(this.max);for(let P=0;P<p.length;P++)v[P]=p[P]?this.min[P]:this.center[P],E[P]=p[P]?this.center[P]:this.max[P];return E[2]=this.max[2],new Yo(v,E)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const p=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let v=!0;for(let E=0;E<l.planes.length;E++){const P=l.planes[E];let z=0;for(let N=0;N<p.length;N++)a.dot$1(P,p[N])>=0&&z++;if(z===0)return 0;z!==p.length&&(v=!1)}if(v)return 2;for(let E=0;E<3;E++){let P=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(let N=0;N<l.points.length;N++){const G=l.points[N][E]-this.min[E];P=Math.min(P,G),z=Math.max(z,G)}if(z<0||P>this.max[E]-this.min[E])return 0}return 1}}class ds{constructor(l=0,p=0,v=0,E=0){if(isNaN(l)||l<0||isNaN(p)||p<0||isNaN(v)||v<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=p,this.left=v,this.right=E}interpolate(l,p,v){return p.top!=null&&l.top!=null&&(this.top=a.number(l.top,p.top,v)),p.bottom!=null&&l.bottom!=null&&(this.bottom=a.number(l.bottom,p.bottom,v)),p.left!=null&&l.left!=null&&(this.left=a.number(l.left,p.left,v)),p.right!=null&&l.right!=null&&(this.right=a.number(l.right,p.right,v)),this}getCenter(l,p){const v=a.clamp((this.left+l-this.right)/2,0,l),E=a.clamp((this.top+p-this.bottom)/2,0,p);return new a.pointGeometry(v,E)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new ds(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Xs{constructor(l,p,v,E,P){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=P===void 0||!!P,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=v??0,this._maxPitch=E??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ds,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const l=new Xs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l._elevation=this._elevation,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const p=-a.wrap(l,-180,180)*Math.PI/180;var v;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(v=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v),function(E,P,z){var N=P[0],G=P[1],$=P[2],K=P[3],se=Math.sin(z),ce=Math.cos(z);E[0]=N*ce+$*se,E[1]=G*ce+K*se,E[2]=N*-se+$*ce,E[3]=G*-se+K*ce}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const p=a.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const p=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,p,v){this._unmodified=!1,this._edgeInsets.interpolate(l,p,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const p=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(l){const p=[new a.UnwrappedTileID(0,l)];if(this._renderWorldCopies){const v=this.pointCoordinate(new a.pointGeometry(0,0)),E=this.pointCoordinate(new a.pointGeometry(this.width,0)),P=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),z=this.pointCoordinate(new a.pointGeometry(0,this.height)),N=Math.floor(Math.min(v.x,E.x,P.x,z.x)),G=Math.floor(Math.max(v.x,E.x,P.x,z.x)),$=1;for(let K=N-$;K<=G+$;K++)K!==0&&p.push(new a.UnwrappedTileID(K,l))}return p}coveringTiles(l){var p,v;let E=this.coveringZoomLevel(l);const P=E;if(l.minzoom!==void 0&&E<l.minzoom)return[];l.maxzoom!==void 0&&E>l.maxzoom&&(E=l.maxzoom);const z=this.pointCoordinate(this.getCameraPoint()),N=a.MercatorCoordinate.fromLngLat(this.center),G=Math.pow(2,E),$=[G*z.x,G*z.y,0],K=[G*N.x,G*N.y,0],se=xl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,E);let ce=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ce=E);const xe=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,ve=Se=>({aabb:new Yo([Se*G,0,0],[(Se+1)*G,G,0]),zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),le=[],ye=[],ze=E,je=l.reparseOverscaled?P:E;if(this._renderWorldCopies)for(let Se=1;Se<=3;Se++)le.push(ve(-Se)),le.push(ve(Se));for(le.push(ve(0));le.length>0;){const Se=le.pop(),Xe=Se.x,He=Se.y;let it=Se.fullyVisible;if(!it){const x=Se.aabb.intersects(se);if(x===0)continue;it=x===2}const Je=l.terrain?$:K,d=Se.aabb.distanceX(Je),A=Se.aabb.distanceY(Je),m=Math.max(Math.abs(d),Math.abs(A)),_=xe+(1<<ze-Se.zoom)-2;if(Se.zoom===ze||m>_&&Se.zoom>=ce){const x=ze-Se.zoom,S=$[0]-.5-(Xe<<x),M=$[1]-.5-(He<<x);ye.push({tileID:new a.OverscaledTileID(Se.zoom===ze?je:Se.zoom,Se.wrap,Se.zoom,Xe,He),distanceSq:a.sqrLen([K[0]-.5-Xe,K[1]-.5-He]),tileDistanceToCamera:Math.sqrt(S*S+M*M)})}else for(let x=0;x<4;x++){const S=(Xe<<1)+x%2,M=(He<<1)+(x>>1),L=Se.zoom+1;let O=Se.aabb.quadrant(x);if(l.terrain){const H=new a.OverscaledTileID(L,Se.wrap,L,S,M),ee=l.terrain.getMinMaxElevation(H),Ae=(p=ee.minElevation)!==null&&p!==void 0?p:this.elevation,we=(v=ee.maxElevation)!==null&&v!==void 0?v:this.elevation;O=new Yo([O.min[0],O.min[1],Ae],[O.max[0],O.max[1],we])}le.push({aabb:O,zoom:L,x:S,y:M,wrap:Se.wrap,fullyVisible:it})}}return ye.sort((Se,Xe)=>Se.distanceSq-Xe.distanceSq).map(Se=>Se.tileID)}resize(l,p){this.width=l,this.height=p,this.pixelsToGLUnits=[2/l,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const p=a.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.pointGeometry(a.mercatorXfromLng(l.lng)*this.worldSize,a.mercatorYfromLat(p)*this.worldSize)}unproject(l){return new a.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(l){this.freezeElevation||(this.elevation=l?this.getElevation(this._center,l):0)}getElevation(l,p){const v=a.MercatorCoordinate.fromLngLat(l),E=(1<<this.tileZoom)*a.EXTENT,P=v.x*E,z=v.y*E,N=Math.floor(P/a.EXTENT),G=Math.floor(z/a.EXTENT),$=new a.OverscaledTileID(this.tileZoom,0,this.tileZoom,N,G);return p.getElevation($,P%a.EXTENT,z%a.EXTENT,a.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const p=this.pointLocation(this.centerPoint,l),v=this.getElevation(p,l);if(!(this.elevation-v))return;const E=this.getCameraPosition(),P=a.MercatorCoordinate.fromLngLat(E.lngLat,E.altitude),z=a.MercatorCoordinate.fromLngLat(p,v),N=P.x-z.x,G=P.y-z.y,$=P.z-z.z,K=Math.sqrt(N*N+G*G+$*$),se=this.scaleZoom(this.cameraToCenterDistance/K/this.tileSize);this._elevation=v,this._center=p,this.zoom=se}setLocationAtPoint(l,p){const v=this.pointCoordinate(p),E=this.pointCoordinate(this.centerPoint),P=this.locationCoordinate(l),z=new a.MercatorCoordinate(P.x-(v.x-E.x),P.y-(v.y-E.y));this.center=this.coordinateLocation(z),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,p){return p?this.coordinatePoint(this.locationCoordinate(l),this.getElevation(l,p),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,p){return this.coordinateLocation(this.pointCoordinate(l,p))}locationCoordinate(l){return a.MercatorCoordinate.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,p){if(p){const ce=p.pointCoordinate(l);if(ce!=null)return ce}const v=[l.x,l.y,0,1],E=[l.x,l.y,1,1];a.transformMat4(v,v,this.pixelMatrixInverse),a.transformMat4(E,E,this.pixelMatrixInverse);const P=v[3],z=E[3],N=v[1]/P,G=E[1]/z,$=v[2]/P,K=E[2]/z,se=$===K?0:(0-$)/(K-$);return new a.MercatorCoordinate(a.number(v[0]/P,E[0]/z,se)/this.worldSize,a.number(N,G,se)/this.worldSize)}coordinatePoint(l,p=0,v=this.pixelMatrix){const E=[l.x*this.worldSize,l.y*this.worldSize,p,1];return a.transformMat4(E,E,v),new a.pointGeometry(E[0]/E[3],E[1]/E[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new a.LngLatBounds().extend(this.pointLocation(new a.pointGeometry(0,l))).extend(this.pointLocation(new a.pointGeometry(this.width,l))).extend(this.pointLocation(new a.pointGeometry(this.width,this.height))).extend(this.pointLocation(new a.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(l,p=!1){const v=l.key,E=p?this._alignedPosMatrixCache:this._posMatrixCache;if(E[v])return E[v];const P=l.canonical,z=this.worldSize/this.zoomScale(P.z),N=P.x+Math.pow(2,P.z)*l.wrap,G=a.identity(new Float64Array(16));return a.translate(G,G,[N*z,P.y*z,0]),a.scale(G,G,[z/a.EXTENT,z/a.EXTENT,1]),a.multiply(G,p?this.alignedProjMatrix:this.projMatrix,G),E[v]=new Float32Array(G),E[v]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let l,p,v,E,P=-90,z=90,N=-180,G=180;const $=this.size,K=this._unmodified;if(this.latRange){const xe=this.latRange;P=a.mercatorYfromLat(xe[1])*this.worldSize,z=a.mercatorYfromLat(xe[0])*this.worldSize,l=z-P<$.y?$.y/(z-P):0}if(this.lngRange){const xe=this.lngRange;N=a.wrap(a.mercatorXfromLng(xe[0])*this.worldSize,0,this.worldSize),G=a.wrap(a.mercatorXfromLng(xe[1])*this.worldSize,0,this.worldSize),G<N&&(G+=this.worldSize),p=G-N<$.x?$.x/(G-N):0}const se=this.point,ce=Math.max(p||0,l||0);if(ce)return this.center=this.unproject(new a.pointGeometry(p?(G+N)/2:se.x,l?(z+P)/2:se.y)),this.zoom+=this.scaleZoom(ce),this._unmodified=K,void(this._constraining=!1);if(this.latRange){const xe=se.y,ve=$.y/2;xe-ve<P&&(E=P+ve),xe+ve>z&&(E=z-ve)}if(this.lngRange){const xe=(N+G)/2,ve=a.wrap(se.x,xe-this.worldSize/2,xe+this.worldSize/2),le=$.x/2;ve-le<N&&(v=N+le),ve+le>G&&(v=G-le)}v===void 0&&E===void 0||(this.center=this.unproject(new a.pointGeometry(v!==void 0?v:se.x,E!==void 0?E:se.y)).wrap()),this._unmodified=K,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,p=this.point.x,v=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let E=a.identity(new Float64Array(16));a.scale(E,E,[this.width/2,-this.height/2,1]),a.translate(E,E,[1,-1,0]),this.labelPlaneMatrix=E,E=a.identity(new Float64Array(16)),a.scale(E,E,[1,-1,1]),a.translate(E,E,[-1,-1,0]),a.scale(E,E,[2/this.width,2/this.height,1]),this.glCoordMatrix=E,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const P=Math.PI/2+this._pitch,z=this._fov*(.5+l.y/this.height),N=Math.sin(z)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-P-z,.01,Math.PI-.01)),G=this.getHorizon(),$=2*Math.atan(G/this.cameraToCenterDistance)*(.5+l.y/(2*G)),K=Math.sin($)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-P-$,.01,Math.PI-.01)),se=Math.cos(Math.PI/2-this._pitch)*N+this.cameraToSeaLevelDistance,ce=Math.cos(Math.PI/2-this._pitch)*K+this.cameraToSeaLevelDistance,xe=1.01*Math.min(se,ce),ve=this.height/50;E=new Float64Array(16),a.perspective(E,this._fov,this.width/this.height,ve,xe),E[8]=2*-l.x/this.width,E[9]=2*l.y/this.height,a.scale(E,E,[1,-1,1]),a.translate(E,E,[0,0,-this.cameraToCenterDistance]),a.rotateX(E,E,this._pitch),a.rotateZ(E,E,this.angle),a.translate(E,E,[-p,-v,0]),this.mercatorMatrix=a.scale([],E,[this.worldSize,this.worldSize,this.worldSize]),a.scale(E,E,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,E),a.translate(E,E,[0,0,-this.elevation]),this.projMatrix=E,this.invProjMatrix=a.invert([],E),this.pixelMatrix3D=a.multiply(new Float64Array(16),this.labelPlaneMatrix,E);const le=this.width%2/2,ye=this.height%2/2,ze=Math.cos(this.angle),je=Math.sin(this.angle),Se=p-Math.round(p)+ze*le+je*ye,Xe=v-Math.round(v)+ze*ye+je*le,He=new Float64Array(E);if(a.translate(He,He,[Se>.5?Se-1:Se,Xe>.5?Xe-1:Xe,0]),this.alignedProjMatrix=He,E=a.invert(new Float64Array(16),this.pixelMatrix),!E)throw new Error("failed to invert matrix");this.pixelMatrixInverse=E,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new a.pointGeometry(0,0)),p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return a.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,l))}getCameraQueryGeometry(l){const p=this.getCameraPoint();if(l.length===1)return[l[0],p];{let v=p.x,E=p.y,P=p.x,z=p.y;for(const N of l)v=Math.min(v,N.x),E=Math.min(E,N.y),P=Math.max(P,N.x),z=Math.max(z,N.y);return[new a.pointGeometry(v,E),new a.pointGeometry(P,E),new a.pointGeometry(P,z),new a.pointGeometry(v,z),new a.pointGeometry(v,E)]}}}class La{constructor(l){this._hashName=l&&encodeURIComponent(l),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(p,v){let E=!1,P=null;const z=()=>{P=null,E&&(p(),P=setTimeout(z,300),E=!1)};return()=>(E=!0,P||z(),P)}(this._updateHashUnthrottled.bind(this))}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){const p=this._map.getCenter(),v=Math.round(100*this._map.getZoom())/100,E=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,E),z=Math.round(p.lng*P)/P,N=Math.round(p.lat*P)/P,G=this._map.getBearing(),$=this._map.getPitch();let K="";if(K+=l?`/${z}/${N}/${v}`:`${v}/${N}/${z}`,(G||$)&&(K+="/"+Math.round(10*G)/10),$&&(K+=`/${Math.round($)}`),this._hashName){const se=this._hashName;let ce=!1;const xe=window.location.hash.slice(1).split("&").map(ve=>{const le=ve.split("=")[0];return le===se?(ce=!0,`${le}=${K}`):ve}).filter(ve=>ve);return ce||xe.push(`${se}=${K}`),`#${xe.join("&")}`}return`#${K}`}_getCurrentHash(){const l=window.location.hash.replace("#","");if(this._hashName){let p;return l.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(p=v)}),(p&&p[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,l)}catch{}}}const wl={linearity:.3,easing:a.bezier(0,0,.3,1)},xc=a.extend({deceleration:2500,maxSpeed:1400},wl),Wu=a.extend({deceleration:20,maxSpeed:1400},wl),b0=a.extend({deceleration:1e3,maxSpeed:360},wl),Da=a.extend({deceleration:1e3,maxSpeed:90},wl);class $u{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,p=a.exported.now();for(;l.length>0&&p-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const p={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)p.zoom+=P.zoomDelta||0,p.bearing+=P.bearingDelta||0,p.pitch+=P.pitchDelta||0,P.panDelta&&p.pan._add(P.panDelta),P.around&&(p.around=P.around),P.pinchAround&&(p.pinchAround=P.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(p.pan.mag()){const P=za(p.pan.mag(),v,a.extend({},xc,l||{}));E.offset=p.pan.mult(P.amount/p.pan.mag()),E.center=this._map.transform.center,Ra(E,P)}if(p.zoom){const P=za(p.zoom,v,Wu);E.zoom=this._map.transform.zoom+P.amount,Ra(E,P)}if(p.bearing){const P=za(p.bearing,v,b0);E.bearing=this._map.transform.bearing+a.clamp(P.amount,-179,179),Ra(E,P)}if(p.pitch){const P=za(p.pitch,v,Da);E.pitch=this._map.transform.pitch+P.amount,Ra(E,P)}if(E.zoom||E.bearing){const P=p.pinchAround===void 0?p.around:p.pinchAround;E.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),a.extend(E,{noMoveStart:!0})}}function Ra(b,l){(!b.duration||b.duration<l.duration)&&(b.duration=l.duration,b.easing=l.easing)}function za(b,l,p){const{maxSpeed:v,linearity:E,deceleration:P}=p,z=a.clamp(b*E/(l/1e3),-v,v),N=Math.abs(z)/(P*E);return{easing:p.easing,duration:1e3*N,amount:z*(N/2)}}class Ji extends a.Event{constructor(l,p,v,E={}){const P=D.mousePos(p.getCanvasContainer(),v),z=p.unproject(P);super(l,a.extend({point:P,lngLat:z,originalEvent:v},E)),this._defaultPrevented=!1,this.target=p}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ds extends a.Event{constructor(l,p,v){const E=l==="touchend"?v.changedTouches:v.touches,P=D.touchPos(p.getCanvasContainer(),E),z=P.map(G=>p.unproject(G)),N=P.reduce((G,$,K,se)=>G.add($.div(se.length)),new a.pointGeometry(0,0));super(l,{points:P,point:N,lngLats:z,lngLat:p.unproject(N),originalEvent:v}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class zr extends a.Event{constructor(l,p,v){super(l,{originalEvent:v}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class bl{constructor(l,p){this._map=l,this._clickTolerance=p.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new zr(l.type,this._map,l))}mousedown(l,p){return this._mousedownPos=p,this._firePreventable(new Ji(l.type,this._map,l))}mouseup(l){this._map.fire(new Ji(l.type,this._map,l))}click(l,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new Ji(l.type,this._map,l))}dblclick(l){return this._firePreventable(new Ji(l.type,this._map,l))}mouseover(l){this._map.fire(new Ji(l.type,this._map,l))}mouseout(l){this._map.fire(new Ji(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Ds(l.type,this._map,l))}touchmove(l){this._map.fire(new Ds(l.type,this._map,l))}touchend(l){this._map.fire(new Ds(l.type,this._map,l))}touchcancel(l){this._map.fire(new Ds(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class To{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new Ji(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ji("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new Ji(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qu{constructor(l,p){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,p){this.isEnabled()&&l.shiftKey&&l.button===0&&(D.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(l,p){if(!this._active)return;const v=p;if(this._lastPos.equals(v)||!this._box&&v.dist(this._startPos)<this._clickTolerance)return;const E=this._startPos;this._lastPos=v,this._box||(this._box=D.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const P=Math.min(E.x,v.x),z=Math.max(E.x,v.x),N=Math.min(E.y,v.y),G=Math.max(E.y,v.y);D.setTransform(this._box,`translate(${P}px,${N}px)`),this._box.style.width=z-P+"px",this._box.style.height=G-N+"px"}mouseupWindow(l,p){if(!this._active||l.button!==0)return;const v=this._startPos,E=p;if(this.reset(),D.suppressClick(),v.x!==E.x||v.y!==E.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:P=>P.fitScreenCoordinates(v,E,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,p){return this._map.fire(new a.Event(l,{originalEvent:p}))}}function Qs(b,l){if(b.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${l.length}`);const p={};for(let v=0;v<b.length;v++)p[b[v].identifier]=l[v];return p}class El{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,p,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),v.length===this.numTouches&&(this.centroid=function(E){const P=new a.pointGeometry(0,0);for(const z of E)P._add(z);return P.div(E.length)}(p),this.touches=Qs(v,p)))}touchmove(l,p,v){if(this.aborted||!this.centroid)return;const E=Qs(v,p);for(const P in this.touches){const z=this.touches[P],N=E[P];(!N||N.dist(z)>30)&&(this.aborted=!0)}}touchend(l,p,v){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const E=!this.aborted&&this.centroid;if(this.reset(),E)return E}}}class wc{constructor(l){this.singleTap=new El(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,p,v){this.singleTap.touchstart(l,p,v)}touchmove(l,p,v){this.singleTap.touchmove(l,p,v)}touchend(l,p,v){const E=this.singleTap.touchend(l,p,v);if(E){const P=l.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(E)<30;if(P&&z||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=E,this.count===this.numTaps)return this.reset(),E}}}class B1{constructor(){this._zoomIn=new wc({numTouches:1,numTaps:2}),this._zoomOut=new wc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,p,v){this._zoomIn.touchstart(l,p,v),this._zoomOut.touchstart(l,p,v)}touchmove(l,p,v){this._zoomIn.touchmove(l,p,v),this._zoomOut.touchmove(l,p,v)}touchend(l,p,v){const E=this._zoomIn.touchend(l,p,v),P=this._zoomOut.touchend(l,p,v);return E?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:z.getZoom()+1,around:z.unproject(E)},{originalEvent:l})}):P?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:z.getZoom()-1,around:z.unproject(P)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const O1={0:1,2:2};class Ba{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(l,p){return!1}_move(l,p){return{}}mousedown(l,p){if(this._lastPoint)return;const v=D.mouseButton(l);this._correctButton(l,v)&&(this._lastPoint=p,this._eventButton=v)}mousemoveWindow(l,p){const v=this._lastPoint;if(v){if(l.preventDefault(),function(E,P){const z=O1[P];return E.buttons===void 0||(E.buttons&z)!==z}(l,this._eventButton))this.reset();else if(this._moved||!(p.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(v,p)}}mouseupWindow(l){this._lastPoint&&D.mouseButton(l)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oa extends Ba{mousedown(l,p){super.mousedown(l,p),this._lastPoint&&(this._active=!0)}_correctButton(l,p){return p===0&&!l.ctrlKey}_move(l,p){return{around:p,panDelta:p.sub(l)}}}class ps extends Ba{_correctButton(l,p){return p===0&&l.ctrlKey||p===2}_move(l,p){const v=.8*(p.x-l.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(l){l.preventDefault()}}class Ft extends Ba{_correctButton(l,p){return p===0&&l.ctrlKey||p===2}_move(l,p){const v=-.5*(p.y-l.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(l){l.preventDefault()}}class Zu{constructor(l,p){this._minTouches=l.cooperativeGestures?2:1,this._clickTolerance=l.clickTolerance||1,this._map=p,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(l,p,v){return this._calculateTransform(l,p,v)}touchmove(l,p,v){if(this._map._cooperativeGestures&&(this._minTouches===2&&v.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(l,!1,v.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(v.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,p,v)}touchend(l,p,v){this._calculateTransform(l,p,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,p,v){v.length>0&&(this._active=!0);const E=Qs(v,p),P=new a.pointGeometry(0,0),z=new a.pointGeometry(0,0);let N=0;for(const $ in E){const K=E[$],se=this._touches[$];se&&(P._add(K),z._add(K.sub(se)),N++,E[$]=K)}if(this._touches=E,N<this._minTouches||!z.mag())return;const G=z.div(N);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(N),panDelta:G}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ko{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(l){}_move(l,p,v){return{}}touchstart(l,p,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([p[0],p[1]]))}touchmove(l,p,v){if(!this._firstTwoTouches)return;l.preventDefault();const[E,P]=this._firstTwoTouches,z=So(v,p,E),N=So(v,p,P);if(!z||!N)return;const G=this._aroundCenter?null:z.add(N).div(2);return this._move([z,N],G,l)}touchend(l,p,v){if(!this._firstTwoTouches)return;const[E,P]=this._firstTwoTouches,z=So(v,p,E),N=So(v,p,P);z&&N||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function So(b,l,p){for(let v=0;v<b.length;v++)if(b[v].identifier===p)return l[v]}function bc(b,l){return Math.log(b/l)/Math.LN2}class Dt extends Ko{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,p){const v=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(bc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bc(this._distance,v),pinchAround:p}}}function E0(b,l){return 180*b.angleWith(l)/Math.PI}class Xu extends Ko{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,p){const v=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:E0(this._vector,v),pinchAround:p}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const p=25/(Math.PI*this._minDiameter)*360,v=E0(l,this._startVector);return Math.abs(v)<p}}function Ec(b){return Math.abs(b.y)>Math.abs(b.x)}class T0 extends Ko{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,p,v){super.touchstart(l,p,v),this._currentTouchCount=v.length}_start(l){this._lastPoints=l,Ec(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,p,v){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const E=l[0].sub(this._lastPoints[0]),P=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(E,P,v.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(E.y+P.y)/2*-.5}):void 0}gestureBeginsVertically(l,p,v){if(this._valid!==void 0)return this._valid;const E=l.mag()>=2,P=p.mag()>=2;if(!E&&!P)return;if(!E||!P)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;const z=l.y>0==p.y>0;return Ec(l)&&Ec(p)&&z}}const Rs={panStep:100,bearingStep:15,pitchStep:10};class Tc{constructor(){const l=Rs;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let p=0,v=0,E=0,P=0,z=0;switch(l.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:l.shiftKey?v=-1:(l.preventDefault(),P=-1);break;case 39:l.shiftKey?v=1:(l.preventDefault(),P=1);break;case 38:l.shiftKey?E=1:(l.preventDefault(),z=-1);break;case 40:l.shiftKey?E=-1:(l.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(v=0,E=0),{cameraAnimation:N=>{const G=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:F1,zoom:p?Math.round(G)+p*(l.shiftKey?2:1):G,bearing:N.getBearing()+v*this._bearingStep,pitch:N.getPitch()+E*this._pitchStep,offset:[-P*this._panStep,-z*this._panStep],center:N.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function F1(b){return b*(2-b)}const Qu=4.000244140625;class Sc{constructor(l,p){this._map=l,this._el=l.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;l.preventDefault()}let p=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const v=a.exported.now(),E=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,p!==0&&p%Qu==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":E>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(E*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),l.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=l,this._delta-=p,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=D.mousePos(this._el,l);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;if(this._delta!==0){const N=this._type==="wheel"&&Math.abs(this._delta)>Qu?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&G!==0&&(G=1/G);const $=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom($*G))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,v=this._startZoom,E=this._easing;let P,z=!1;if(this._type==="wheel"&&v&&E){const N=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),G=E(N);P=a.number(v,p,G),N<1?this._frameId||(this._frameId=!0):z=!0}else P=p,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:P-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let p=a.ease;if(this._prevEase){const v=this._prevEase,E=(a.exported.now()-v.start)/v.duration,P=v.easing(E+.01)-v.easing(E),z=.27/Math.sqrt(P*P+1e-4)*.01,N=Math.sqrt(.0729-z*z);p=a.bezier(z,N,.25,1)}return this._prevEase={start:a.exported.now(),duration:l,easing:p},p}reset(){this._active=!1}}class Cc{constructor(l,p){this._clickZoom=l,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Pc{constructor(){this.reset()}reset(){this._active=!1}dblclick(l,p){return l.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(l.shiftKey?-1:1),around:v.unproject(p)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zs{constructor(){this._tap=new wc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(l,p,v){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=p[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(l,p,v))}touchmove(l,p,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const E=p[0],P=E.y-this._swipePoint.y;return this._swipePoint=E,l.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(l,p,v)}touchend(l,p,v){this._tapTime?this._swipePoint&&v.length===0&&this.reset():this._tap.touchend(l,p,v)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pr{constructor(l,p,v){this._el=l,this._mousePan=p,this._touchPan=v}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ys{constructor(l,p,v){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=p,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Yu{constructor(l,p,v,E){this._el=l,this._touchZoom=p,this._touchRotate=v,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Fa=b=>b.zoom||b.drag||b.pitch||b.rotate;class Mc extends a.Event{}function Tl(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class Ku{constructor(l,p){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new $u(l),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),a.bindAll(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(const[E,P,z]of this._listeners)D.addEventListener(E,P,E===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[l,p,v]of this._listeners)D.removeEventListener(l,p,l===document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(l){const p=this._map,v=p.getCanvasContainer();this._add("mapEvent",new bl(p,l));const E=p.boxZoom=new qu(p,l);this._add("boxZoom",E);const P=new B1,z=new Pc;p.doubleClickZoom=new Cc(z,P),this._add("tapZoom",P),this._add("clickZoom",z);const N=new zs;this._add("tapDragZoom",N);const G=p.touchPitch=new T0(p);this._add("touchPitch",G);const $=new ps(l),K=new Ft(l);p.dragRotate=new Ys(l,$,K),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",K,["mouseRotate"]);const se=new Oa(l),ce=new Zu(l,p);p.dragPan=new pr(v,se,ce),this._add("mousePan",se),this._add("touchPan",ce,["touchZoom","touchRotate"]);const xe=new Xu,ve=new Dt;p.touchZoomRotate=new Yu(v,ve,xe,N),this._add("touchRotate",xe,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]);const le=p.scrollZoom=new Sc(p,this);this._add("scrollZoom",le,["mousePan"]);const ye=p.keyboard=new Tc;this._add("keyboard",ye),this._add("blockableMapEvent",new To(p));for(const ze of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[ze]&&p[ze].enable(l[ze])}_add(l,p,v){this._handlers.push({handlerName:l,handler:p,allowed:v}),this._handlersById[l]=p}stop(l){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fa(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,p,v){for(const E in l)if(E!==v&&(!p||p.indexOf(E)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const p=[];for(const v of l)this._el.contains(v.target)&&p.push(v);return p}handleEvent(l,p){if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const v=l.type==="renderFrame"?void 0:l,E={needsRenderFrame:!1},P={},z={},N=l.touches,G=N?this._getMapTouches(N):void 0,$=G?D.touchPos(this._el,G):D.mousePos(this._el,l);for(const{handlerName:ce,handler:xe,allowed:ve}of this._handlers){if(!xe.isEnabled())continue;let le;this._blockedByActive(z,ve,ce)?xe.reset():xe[p||l.type]&&(le=xe[p||l.type](l,$,G),this.mergeHandlerResult(E,P,le,ce,v),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||xe.isActive())&&(z[ce]=xe)}const K={};for(const ce in this._previousActiveHandlers)z[ce]||(K[ce]=v);this._previousActiveHandlers=z,(Object.keys(K).length||Tl(E))&&(this._changes.push([E,P,K]),this._triggerRenderFrame()),(Object.keys(z).length||Tl(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:se}=E;se&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],se(this._map))}mergeHandlerResult(l,p,v,E,P){if(!v)return;a.extend(l,v);const z={handlerName:E,originalEvent:v.originalEvent||P};v.zoomDelta!==void 0&&(p.zoom=z),v.panDelta!==void 0&&(p.drag=z),v.pitchDelta!==void 0&&(p.pitch=z),v.bearingDelta!==void 0&&(p.rotate=z)}_applyChanges(){const l={},p={},v={};for(const[E,P,z]of this._changes)E.panDelta&&(l.panDelta=(l.panDelta||new a.pointGeometry(0,0))._add(E.panDelta)),E.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+E.pitchDelta),E.around!==void 0&&(l.around=E.around),E.pinchAround!==void 0&&(l.pinchAround=E.pinchAround),E.noInertia&&(l.noInertia=E.noInertia),a.extend(p,P),a.extend(v,z);this._updateMapTransform(l,p,v),this._changes=[]}_updateMapTransform(l,p,v){const E=this._map,P=E.transform,z=E.style&&E.style.terrain;if(!(Tl(l)||z&&this._drag))return this._fireEvents(p,v,!0);let{panDelta:N,zoomDelta:G,bearingDelta:$,pitchDelta:K,around:se,pinchAround:ce}=l;ce!==void 0&&(se=ce),E._stop(!0),se=se||E.transform.centerPoint;const xe=P.pointLocation(N?se.sub(N):se);$&&(P.bearing+=$),K&&(P.pitch+=K),G&&(P.zoom+=G),z?p.drag&&!this._drag?(this._drag={center:P.centerPoint,lngLat:P.pointLocation(se),point:se,handlerName:p.drag.handlerName},E.fire(new a.Event("freezeElevation",{freeze:!0}))):this._drag&&v[this._drag.handlerName]?(E.fire(new a.Event("freezeElevation",{freeze:!1})),this._drag=null):p.drag&&this._drag&&(P.center=P.pointLocation(P.centerPoint.sub(N))):P.setLocationAtPoint(xe,se),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(p,v,!0)}_fireEvents(l,p,v){const E=Fa(this._eventsInProgress),P=Fa(l),z={};for(const K in l){const{originalEvent:se}=l[K];this._eventsInProgress[K]||(z[`${K}start`]=se),this._eventsInProgress[K]=l[K]}!E&&P&&this._fireEvent("movestart",P.originalEvent);for(const K in z)this._fireEvent(K,z[K]);P&&this._fireEvent("move",P.originalEvent);for(const K in l){const{originalEvent:se}=l[K];this._fireEvent(K,se)}const N={};let G;for(const K in this._eventsInProgress){const{handlerName:se,originalEvent:ce}=this._eventsInProgress[K];this._handlersById[se].isActive()||(delete this._eventsInProgress[K],G=p[se]||ce,N[`${K}end`]=G)}for(const K in N)this._fireEvent(K,N[K]);const $=Fa(this._eventsInProgress);if(v&&(E||P)&&!$){this._updatingCamera=!0;const K=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),se=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;K?(se(K.bearing||this._map.getBearing())&&(K.bearing=0),this._map.easeTo(K,{originalEvent:G})):(this._map.fire(new a.Event("moveend",{originalEvent:G})),se(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,p){this._map.fire(new a.Event(l,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new Mc("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Zr={extend:(b,...l)=>a.extend(b,...l),run(b){b()},logToElement(b,l=!1,p="log"){const v=window.document.getElementById(p);v&&(l&&(v.innerHTML=""),v.innerHTML+=`<br>${b}`)}};class mi extends a.Evented{constructor(l,p){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=p.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,p){return this.jumpTo({center:l},p)}panBy(l,p,v){return l=a.pointGeometry.convert(l).mult(-1),this.panTo(this.transform.center,a.extend({offset:l},p),v)}panTo(l,p,v){return this.easeTo(a.extend({center:l},p),v)}getZoom(){return this.transform.zoom}setZoom(l,p){return this.jumpTo({zoom:l},p),this}zoomTo(l,p,v){return this.easeTo(a.extend({zoom:l},p),v)}zoomIn(l,p){return this.zoomTo(this.getZoom()+1,l,p),this}zoomOut(l,p){return this.zoomTo(this.getZoom()-1,l,p),this}getBearing(){return this.transform.bearing}setBearing(l,p){return this.jumpTo({bearing:l},p),this}getPadding(){return this.transform.padding}setPadding(l,p){return this.jumpTo({padding:l},p),this}rotateTo(l,p,v){return this.easeTo(a.extend({bearing:l},p),v)}resetNorth(l,p){return this.rotateTo(0,a.extend({duration:1e3},l),p),this}resetNorthPitch(l,p){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},l),p),this}snapToNorth(l,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,p):this}getPitch(){return this.transform.pitch}setPitch(l,p){return this.jumpTo({pitch:l},p),this}cameraForBounds(l,p){l=a.LngLatBounds.convert(l);const v=p&&p.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),v,p)}_cameraForBoxAndBearing(l,p,v,E){const P={top:0,bottom:0,right:0,left:0};if(typeof(E=a.extend({padding:P,offset:[0,0],maxZoom:this.transform.maxZoom},E)).padding=="number"){const He=E.padding;E.padding={top:He,bottom:He,right:He,left:He}}E.padding=a.extend(P,E.padding);const z=this.transform,N=z.padding,G=z.project(a.LngLat.convert(l)),$=z.project(a.LngLat.convert(p)),K=G.rotate(-v*Math.PI/180),se=$.rotate(-v*Math.PI/180),ce=new a.pointGeometry(Math.max(K.x,se.x),Math.max(K.y,se.y)),xe=new a.pointGeometry(Math.min(K.x,se.x),Math.min(K.y,se.y)),ve=ce.sub(xe),le=(z.width-(N.left+N.right+E.padding.left+E.padding.right))/ve.x,ye=(z.height-(N.top+N.bottom+E.padding.top+E.padding.bottom))/ve.y;if(ye<0||le<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ze=Math.min(z.scaleZoom(z.scale*Math.min(le,ye)),E.maxZoom),je=a.pointGeometry.convert(E.offset),Se=new a.pointGeometry((E.padding.left-E.padding.right)/2,(E.padding.top-E.padding.bottom)/2).rotate(v*Math.PI/180),Xe=je.add(Se).mult(z.scale/z.zoomScale(ze));return{center:z.unproject(G.add($).div(2).sub(Xe)),zoom:ze,bearing:v}}fitBounds(l,p,v){return this._fitInternal(this.cameraForBounds(l,p),p,v)}fitScreenCoordinates(l,p,v,E,P){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(l)),this.transform.pointLocation(a.pointGeometry.convert(p)),v,E),E,P)}_fitInternal(l,p,v){return l?(delete(p=a.extend(l,p)).padding,p.linear?this.easeTo(p,v):this.flyTo(p,v)):this}jumpTo(l,p){this.stop();const v=this.transform;let E=!1,P=!1,z=!1;return"zoom"in l&&v.zoom!==+l.zoom&&(E=!0,v.zoom=+l.zoom),l.center!==void 0&&(v.center=a.LngLat.convert(l.center)),"bearing"in l&&v.bearing!==+l.bearing&&(P=!0,v.bearing=+l.bearing),"pitch"in l&&v.pitch!==+l.pitch&&(z=!0,v.pitch=+l.pitch),l.padding==null||v.isPaddingEqual(l.padding)||(v.padding=l.padding),this.fire(new a.Event("movestart",p)).fire(new a.Event("move",p)),E&&this.fire(new a.Event("zoomstart",p)).fire(new a.Event("zoom",p)).fire(new a.Event("zoomend",p)),P&&this.fire(new a.Event("rotatestart",p)).fire(new a.Event("rotate",p)).fire(new a.Event("rotateend",p)),z&&this.fire(new a.Event("pitchstart",p)).fire(new a.Event("pitch",p)).fire(new a.Event("pitchend",p)),this.fire(new a.Event("moveend",p))}calculateCameraOptionsFromTo(l,p,v,E=0){const P=a.MercatorCoordinate.fromLngLat(l,p),z=a.MercatorCoordinate.fromLngLat(v,E),N=z.x-P.x,G=z.y-P.y,$=z.z-P.z,K=Math.hypot(N,G,$);if(K===0)throw new Error("Can't calculate camera options with same From and To");const se=Math.hypot(N,G),ce=this.transform.scaleZoom(this.transform.cameraToCenterDistance/K/this.transform.tileSize),xe=180*Math.atan2(N,-G)/Math.PI;let ve=180*Math.acos(se/K)/Math.PI;return ve=$<0?90-ve:90+ve,{center:z.toLngLat(),zoom:ce,pitch:ve,bearing:xe}}easeTo(l,p){this._stop(!1,l.easeId),((l=a.extend({offset:[0,0],duration:500,easing:a.ease},l)).animate===!1||!l.essential&&a.exported.prefersReducedMotion)&&(l.duration=0);const v=this.transform,E=this.getZoom(),P=this.getBearing(),z=this.getPitch(),N=this.getPadding(),G="zoom"in l?+l.zoom:E,$="bearing"in l?this._normalizeBearing(l.bearing,P):P,K="pitch"in l?+l.pitch:z,se="padding"in l?l.padding:v.padding,ce=a.pointGeometry.convert(l.offset);let xe=v.centerPoint.add(ce);const ve=v.pointLocation(xe),le=a.LngLat.convert(l.center||ve);this._normalizeCenter(le);const ye=v.project(ve),ze=v.project(le).sub(ye),je=v.zoomScale(G-E);let Se,Xe;l.around&&(Se=a.LngLat.convert(l.around),Xe=v.locationPoint(Se));const He={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||G!==E,this._rotating=this._rotating||P!==$,this._pitching=this._pitching||K!==z,this._padding=!v.isPaddingEqual(se),this._easeId=l.easeId,this._prepareEase(p,l.noMoveStart,He),this._ease(it=>{if(this._zooming&&(v.zoom=a.number(E,G,it)),this._rotating&&(v.bearing=a.number(P,$,it)),this._pitching&&(v.pitch=a.number(z,K,it)),this._padding&&(v.interpolatePadding(N,se,it),xe=v.centerPoint.add(ce)),Se)v.setLocationAtPoint(Se,Xe);else{const Je=v.zoomScale(v.zoom-E),d=G>E?Math.min(2,je):Math.max(.5,je),A=Math.pow(d,1-it),m=v.unproject(ye.add(ze.mult(it*A)).mult(Je));v.setLocationAtPoint(v.renderWorldCopies?m.wrap():m,xe)}this._fireMoveEvents(p)},it=>{this._afterEase(p,it)},l),this}_prepareEase(l,p,v={}){this._moving=!0,this.fire(new a.Event("freezeElevation",{freeze:!0})),p||v.moving||this.fire(new a.Event("movestart",l)),this._zooming&&!v.zooming&&this.fire(new a.Event("zoomstart",l)),this._rotating&&!v.rotating&&this.fire(new a.Event("rotatestart",l)),this._pitching&&!v.pitching&&this.fire(new a.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new a.Event("move",l)),this._zooming&&this.fire(new a.Event("zoom",l)),this._rotating&&this.fire(new a.Event("rotate",l)),this._pitching&&this.fire(new a.Event("pitch",l))}_afterEase(l,p){if(this._easeId&&p&&this._easeId===p)return;delete this._easeId,this.fire(new a.Event("freezeElevation",{freeze:!1}));const v=this._zooming,E=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new a.Event("zoomend",l)),E&&this.fire(new a.Event("rotateend",l)),P&&this.fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l))}flyTo(l,p){if(!l.essential&&a.exported.prefersReducedMotion){const L=a.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(L,p)}this.stop(),l=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},l);const v=this.transform,E=this.getZoom(),P=this.getBearing(),z=this.getPitch(),N=this.getPadding(),G="zoom"in l?a.clamp(+l.zoom,v.minZoom,v.maxZoom):E,$="bearing"in l?this._normalizeBearing(l.bearing,P):P,K="pitch"in l?+l.pitch:z,se="padding"in l?l.padding:v.padding,ce=v.zoomScale(G-E),xe=a.pointGeometry.convert(l.offset);let ve=v.centerPoint.add(xe);const le=v.pointLocation(ve),ye=a.LngLat.convert(l.center||le);this._normalizeCenter(ye);const ze=v.project(le),je=v.project(ye).sub(ze);let Se=l.curve;const Xe=Math.max(v.width,v.height),He=Xe/ce,it=je.mag();if("minZoom"in l){const L=a.clamp(Math.min(l.minZoom,E,G),v.minZoom,v.maxZoom),O=Xe/v.zoomScale(L-E);Se=Math.sqrt(O/it*2)}const Je=Se*Se;function d(L){const O=(He*He-Xe*Xe+(L?-1:1)*Je*Je*it*it)/(2*(L?He:Xe)*Je*it);return Math.log(Math.sqrt(O*O+1)-O)}function A(L){return(Math.exp(L)-Math.exp(-L))/2}function m(L){return(Math.exp(L)+Math.exp(-L))/2}const _=d(0);let x=function(L){return m(_)/m(_+Se*L)},S=function(L){return Xe*((m(_)*(A(O=_+Se*L)/m(O))-A(_))/Je)/it;var O},M=(d(1)-_)/Se;if(Math.abs(it)<1e-6||!isFinite(M)){if(Math.abs(Xe-He)<1e-6)return this.easeTo(l,p);const L=He<Xe?-1:1;M=Math.abs(Math.log(He/Xe))/Se,S=function(){return 0},x=function(O){return Math.exp(L*Se*O)}}return l.duration="duration"in l?+l.duration:1e3*M/("screenSpeed"in l?+l.screenSpeed/Se:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=P!==$,this._pitching=K!==z,this._padding=!v.isPaddingEqual(se),this._prepareEase(p,!1),this._ease(L=>{const O=L*M,H=1/x(O);v.zoom=L===1?G:E+v.scaleZoom(H),this._rotating&&(v.bearing=a.number(P,$,L)),this._pitching&&(v.pitch=a.number(z,K,L)),this._padding&&(v.interpolatePadding(N,se,L),ve=v.centerPoint.add(xe));const ee=L===1?ye:v.unproject(ze.add(je.mult(S(O))).mult(H));v.setLocationAtPoint(v.renderWorldCopies?ee.wrap():ee,ve),this._fireMoveEvents(p)},()=>this._afterEase(p),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,p)}if(!l){const v=this.handlers;v&&v.stop(!1)}return this}_ease(l,p,v){v.animate===!1||v.duration===0?(l(1),p()):(this._easeStart=a.exported.now(),this._easeOptions=v,this._onEaseFrame=l,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,p){l=a.wrap(l,-180,180);const v=Math.abs(l-p);return Math.abs(l-360-p)<v&&(l-=360),Math.abs(l+360-p)<v&&(l+=360),l}_normalizeCenter(l){const p=this.transform;if(!p.renderWorldCopies||p.lngRange)return;const v=l.lng-p.center.lng;l.lng+=v>180?-360:v<-180?360:0}}class Sl{constructor(l={}){this.options=l,a.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options&&this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,p){const v=this._map._getUIString(`AttributionControl.${p}`);l.title=v,l.setAttribute("aria-label",v)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(E=>typeof E!="string"?"":E)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}const p=this._map.style.sourceCaches;for(const E in p){const P=p[E];if(P.used||P.usedForTerrain){const z=P.getSource();z.attribution&&l.indexOf(z.attribution)<0&&l.push(z.attribution)}}l=l.filter(E=>String(E).trim()),l.sort((E,P)=>E.length-P.length),l=l.filter((E,P)=>{for(let z=P+1;z<l.length;z++)if(l[z].indexOf(E)>=0)return!1;return!0});const v=l.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,l.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class S0{constructor(l={}){this.options=l,a.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl mapboxgl-ctrl");const p=D.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const l=this._container.children;if(l.length){const p=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact","mapboxgl-compact"):p.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Ju{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const p=++this._id;return this._queue.push({callback:l,id:p,cancelled:!1}),p}remove(l){const p=this._currentlyRunning,v=p?this._queue.concat(p):this._queue;for(const E of v)if(E.id===l)return void(E.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const p=this._currentlyRunning=this._queue;this._queue=[];for(const v of p)if(!v.cancelled&&(v.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const eh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Ic={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},th={showCompass:!0,showZoom:!0,visualizePitch:!1};class si{constructor(l,p,v=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new ps({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,v&&(this.mousePitch=new Ft({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(p,"mousedown",this.mousedown),D.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(p,"touchmove",this.touchmove),D.addEventListener(p,"touchend",this.touchend),D.addEventListener(p,"touchcancel",this.reset)}down(l,p){this.mouseRotate.mousedown(l,p),this.mousePitch&&this.mousePitch.mousedown(l,p),D.disableDrag()}move(l,p){const v=this.map,E=this.mouseRotate.mousemoveWindow(l,p);if(E&&E.bearingDelta&&v.setBearing(v.getBearing()+E.bearingDelta),this.mousePitch){const P=this.mousePitch.mousemoveWindow(l,p);P&&P.pitchDelta&&v.setPitch(v.getPitch()+P.pitchDelta)}}off(){const l=this.element;D.removeEventListener(l,"mousedown",this.mousedown),D.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(l,"touchmove",this.touchmove),D.removeEventListener(l,"touchend",this.touchend),D.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup)}mousedown(l){this.down(a.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),D.mousePos(this.element,l)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)}mousemove(l){this.move(l,D.mousePos(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Cl(b,l,p){if(b=new a.LngLat(b.lng,b.lat),l){const v=new a.LngLat(b.lng-360,b.lat),E=new a.LngLat(b.lng+360,b.lat),P=p.locationPoint(b).distSqr(l);p.locationPoint(v).distSqr(l)<P?b=v:p.locationPoint(E).distSqr(l)<P&&(b=E)}for(;Math.abs(b.lng-p.center.lng)>180;){const v=p.locationPoint(b);if(v.x>=0&&v.y>=0&&v.x<=p.width&&v.y<=p.height)break;b.lng>p.center.lng?b.lng-=360:b.lng+=360}return b}const Wt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function en(b,l,p){const v=b.classList;for(const E in Wt)v.remove(`maplibregl-${p}-anchor-${E}`,`mapboxgl-${p}-anchor-${E}`);v.add(`maplibregl-${p}-anchor-${l}`,`mapboxgl-${p}-anchor-${l}`)}class er extends a.Evented{constructor(l,p){if(super(),(l instanceof HTMLElement||p)&&(l=a.extend({element:l},p)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=a.pointGeometry.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");const v=D.createNS("http://www.w3.org/2000/svg","svg"),E=41,P=27;v.setAttributeNS(null,"display","block"),v.setAttributeNS(null,"height",`${E}px`),v.setAttributeNS(null,"width",`${P}px`),v.setAttributeNS(null,"viewBox",`0 0 ${P} ${E}`);const z=D.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"stroke","none"),z.setAttributeNS(null,"stroke-width","1"),z.setAttributeNS(null,"fill","none"),z.setAttributeNS(null,"fill-rule","evenodd");const N=D.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill-rule","nonzero");const G=D.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(3.0, 29.0)"),G.setAttributeNS(null,"fill","#000000");const $=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const je of $){const Se=D.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",je.rx),Se.setAttributeNS(null,"ry",je.ry),G.appendChild(Se)}const K=D.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"fill",this._color);const se=D.createNS("http://www.w3.org/2000/svg","path");se.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),K.appendChild(se);const ce=D.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"opacity","0.25"),ce.setAttributeNS(null,"fill","#000000");const xe=D.createNS("http://www.w3.org/2000/svg","path");xe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ce.appendChild(xe);const ve=D.createNS("http://www.w3.org/2000/svg","g");ve.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ve.setAttributeNS(null,"fill","#FFFFFF");const le=D.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ye=D.createNS("http://www.w3.org/2000/svg","circle");ye.setAttributeNS(null,"fill","#000000"),ye.setAttributeNS(null,"opacity","0.25"),ye.setAttributeNS(null,"cx","5.5"),ye.setAttributeNS(null,"cy","5.5"),ye.setAttributeNS(null,"r","5.4999962");const ze=D.createNS("http://www.w3.org/2000/svg","circle");ze.setAttributeNS(null,"fill","#FFFFFF"),ze.setAttributeNS(null,"cx","5.5"),ze.setAttributeNS(null,"cy","5.5"),ze.setAttributeNS(null,"r","5.4999962"),le.appendChild(ye),le.appendChild(ze),N.appendChild(G),N.appendChild(K),N.appendChild(ce),N.appendChild(ve),N.appendChild(le),v.appendChild(N),v.setAttributeNS(null,"height",E*this._scale+"px"),v.setAttributeNS(null,"width",P*this._scale+"px"),this._element.appendChild(v),this._offset=a.pointGeometry.convert(l&&l.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()}),en(this._element,this._anchor,"marker"),this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=a.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const E=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[E,-1*(38.1-13.5+E)],"bottom-right":[-E,-1*(38.1-13.5+E)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(l){const p=l.code,v=l.charCode||l.keyCode;p!=="Space"&&p!=="Enter"&&v!==32&&v!==13||this.togglePopup()}_onMapClick(l){const p=l.originalEvent.target,v=this._element;this._popup&&(p===v||v.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this}_update(l){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Cl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),l&&l.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${Wt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${p}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const E=this._map.unproject(this._pos),P=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=E.distanceTo(this._lngLat)>20*P?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(l){return this._offset=a.pointGeometry.convert(l),this._update(),this}_onMove(l){if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const kc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Co,tr=0,Ks=!1;const ms={maxWidth:100,unit:"metric"};function Lc(b,l,p){const v=p&&p.maxWidth||100,E=b._container.clientHeight/2,P=b.unproject([0,E]),z=b.unproject([v,E]),N=P.distanceTo(z);if(p&&p.unit==="imperial"){const G=3.2808*N;G>5280?Js(l,v,G/5280,b._getUIString("ScaleControl.Miles")):Js(l,v,G,b._getUIString("ScaleControl.Feet"))}else p&&p.unit==="nautical"?Js(l,v,N/1852,b._getUIString("ScaleControl.NauticalMiles")):N>=1e3?Js(l,v,N/1e3,b._getUIString("ScaleControl.Kilometers")):Js(l,v,N,b._getUIString("ScaleControl.Meters"))}function Js(b,l,p,v){const E=function(P){const z=Math.pow(10,`${Math.floor(P)}`.length-1);let N=P/z;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(G){const $=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10));return Math.round(G*$)/$}(N),z*N}(p);b.style.width=l*(E/p)+"px",b.innerHTML=`${E}&nbsp;${v}`}const Ei={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Bi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Dc(b){if(b){if(typeof b=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(b,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,b),"top-left":new a.pointGeometry(l,l),"top-right":new a.pointGeometry(-l,l),bottom:new a.pointGeometry(0,-b),"bottom-left":new a.pointGeometry(l,-l),"bottom-right":new a.pointGeometry(-l,-l),left:new a.pointGeometry(b,0),right:new a.pointGeometry(-b,0)}}if(b instanceof a.pointGeometry||Array.isArray(b)){const l=a.pointGeometry.convert(b);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:a.pointGeometry.convert(b.center||[0,0]),top:a.pointGeometry.convert(b.top||[0,0]),"top-left":a.pointGeometry.convert(b["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(b["top-right"]||[0,0]),bottom:a.pointGeometry.convert(b.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(b["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(b["bottom-right"]||[0,0]),left:a.pointGeometry.convert(b.left||[0,0]),right:a.pointGeometry.convert(b.right||[0,0])}}return Dc(new a.pointGeometry(0,0))}const Jo={supported:y,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends mi{constructor(b){var l;if(a.PerformanceUtils.mark(a.PerformanceMarkers.create),(b=a.extend({},Ic,b)).minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Xs(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies),{bearingSnap:b.bearingSnap}),this._interactive=b.interactive,this._cooperativeGestures=b.cooperativeGestures,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=b.collectResourceTiming,this._renderTaskQueue=new Ju,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},eh,b.locale),this._clickTolerance=b.clickTolerance,this._pixelRatio=(l=b.pixelRatio)!==null&&l!==void 0?l:devicePixelRatio,this._requestManager=new U(b.transformRequest),typeof b.container=="string"){if(this._container=document.getElementById(b.container),!this._container)throw new Error(`Container '${b.container}' not found.`)}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Ku(this,b),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=b.hash&&new La(typeof b.hash=="string"&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,a.extend({},b.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=b.localIdeographFontFamily,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new Sl({customAttribution:b.customAttribution})),b.maplibreLogo&&this.addControl(new S0,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",p=>{this._update(p.dataType==="style"),this.fire(new a.Event(`${p.dataType}data`,p))}),this.on("dataloading",p=>{this.fire(new a.Event(`${p.dataType}dataloading`,p))}),this.on("dataabort",p=>{this.fire(new a.Event("sourcedataabort",p))})}_getMapId(){return this._mapId}addControl(b,l){if(l===void 0&&(l=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=b.onAdd(this);this._controls.push(b);const v=this._controlPositions[l];return l.indexOf("bottom")!==-1?v.insertBefore(p,v.firstChild):v.appendChild(p),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(b);return l>-1&&this._controls.splice(l,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,l,p,v){return v==null&&this.style.terrain&&(v=this.transform.getElevation(p,this.style.terrain)),super.calculateCameraOptionsFromTo(b,l,p,v)}resize(b){const l=this._containerDimensions(),p=l[0],v=l[1];this._resizeCanvas(p,v,this.getPixelRatio()),this.transform.resize(p,v),this.painter.resize(p,v,this.getPixelRatio());const E=!this._moving;return E&&(this.stop(),this.fire(new a.Event("movestart",b)).fire(new a.Event("move",b))),this.fire(new a.Event("resize",b)),E&&this.fire(new a.Event("moveend",b)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(b){const[l,p]=this._containerDimensions();this._pixelRatio=b,this._resizeCanvas(l,p,b),this.painter.resize(l,p,b)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(a.LngLatBounds.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this._update()}project(b){return this.transform.locationPoint(a.LngLat.convert(b),this.style&&this.style.terrain)}unproject(b){return this.transform.pointLocation(a.pointGeometry.convert(b),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(b,l,p){if(b==="mouseenter"||b==="mouseover"){let v=!1;return{layer:l,listener:p,delegates:{mousemove:P=>{const z=this.getLayer(l)?this.queryRenderedFeatures(P.point,{layers:[l]}):[];z.length?v||(v=!0,p.call(this,new Ji(b,this,P.originalEvent,{features:z}))):v=!1},mouseout:()=>{v=!1}}}}if(b==="mouseleave"||b==="mouseout"){let v=!1;return{layer:l,listener:p,delegates:{mousemove:z=>{(this.getLayer(l)?this.queryRenderedFeatures(z.point,{layers:[l]}):[]).length?v=!0:v&&(v=!1,p.call(this,new Ji(b,this,z.originalEvent)))},mouseout:z=>{v&&(v=!1,p.call(this,new Ji(b,this,z.originalEvent)))}}}}{const v=E=>{const P=this.getLayer(l)?this.queryRenderedFeatures(E.point,{layers:[l]}):[];P.length&&(E.features=P,p.call(this,E),delete E.features)};return{layer:l,listener:p,delegates:{[b]:v}}}}on(b,l,p){if(p===void 0)return super.on(b,l);const v=this._createDelegatedListener(b,l,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(v);for(const E in v.delegates)this.on(E,v.delegates[E]);return this}once(b,l,p){if(p===void 0)return super.once(b,l);const v=this._createDelegatedListener(b,l,p);for(const E in v.delegates)this.once(E,v.delegates[E]);return this}off(b,l,p){return p===void 0?super.off(b,l):(this._delegatedListeners&&this._delegatedListeners[b]&&(v=>{const E=this._delegatedListeners[b];for(let P=0;P<E.length;P++){const z=E[P];if(z.layer===l&&z.listener===p){for(const N in z.delegates)this.off(N,z.delegates[N]);return E.splice(P,1),this}}})(),this)}queryRenderedFeatures(b,l){if(!this.style)return[];let p;if(l!==void 0||b===void 0||b instanceof a.pointGeometry||Array.isArray(b)||(l=b,b=void 0),l=l||{},(b=b||[[0,0],[this.transform.width,this.transform.height]])instanceof a.pointGeometry||typeof b[0]=="number")p=[a.pointGeometry.convert(b)];else{const v=a.pointGeometry.convert(b[0]),E=a.pointGeometry.convert(b[1]);p=[v,new a.pointGeometry(E.x,v.y),E,new a.pointGeometry(v.x,E.y),v]}return this.style.queryRenderedFeatures(p,l,this.transform)}querySourceFeatures(b,l){return this.style.querySourceFeatures(b,l)}setStyle(b,l){return(l=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(b,l))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const l=this._locale[b];if(l==null)throw new Error(`Missing UI string '${b}'`);return l}_updateStyle(b,l){return this.style&&(this.style.setEventedParent(null),this.style._remove()),b?(this.style=new _e(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b):this.style.loadJSON(b),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new _e(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,l){if(typeof b=="string"){const p=this._requestManager.transformRequest(b,a.ResourceType.Style);a.getJSON(p,(v,E)=>{v?this.fire(new a.ErrorEvent(v)):E&&this._updateDiff(E,l)})}else typeof b=="object"&&this._updateDiff(b,l)}_updateDiff(b,l){try{this.style.setState(b)&&this._update(!0)}catch(p){a.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(b,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(b,l){return this._lazyInitEmptyStyle(),this.style.addSource(b,l),this._update(!0)}isSourceLoaded(b){const l=this.style&&this.style.sourceCaches[b];if(l!==void 0)return l.loaded();this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){return this.style.setTerrain(b),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const l in b){const p=b[l]._tiles;for(const v in p){const E=p[v];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}addSourceType(b,l,p){return this._lazyInitEmptyStyle(),this.style.addSourceType(b,l,p)}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}addImage(b,l,{pixelRatio:p=1,sdf:v=!1,stretchX:E,stretchY:P,content:z}={}){if(this._lazyInitEmptyStyle(),l instanceof HTMLImageElement||a.isImageBitmap(l)){const{width:N,height:G,data:$}=a.exported.getImageData(l);this.style.addImage(b,{data:new a.RGBAImage({width:N,height:G},$),pixelRatio:p,stretchX:E,stretchY:P,content:z,sdf:v,version:0})}else{if(l.width===void 0||l.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:G,data:$}=l,K=l;this.style.addImage(b,{data:new a.RGBAImage({width:N,height:G},new Uint8Array($)),pixelRatio:p,stretchX:E,stretchY:P,content:z,sdf:v,version:0,userImage:K}),K.onAdd&&K.onAdd(this,b)}}}updateImage(b,l){const p=this.style.getImage(b);if(!p)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=l instanceof HTMLImageElement||a.isImageBitmap(l)?a.exported.getImageData(l):l,{width:E,height:P,data:z}=v;if(E===void 0||P===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(E!==p.data.width||P!==p.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const N=!(l instanceof HTMLImageElement||a.isImageBitmap(l));p.data.replace(z,N),this.style.updateImage(b,p)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b,l){a.getImage(this._requestManager.transformRequest(b,a.ResourceType.Image),l)}listImages(){return this.style.listImages()}addLayer(b,l){return this._lazyInitEmptyStyle(),this.style.addLayer(b,l),this._update(!0)}moveLayer(b,l){return this.style.moveLayer(b,l),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}setLayerZoomRange(b,l,p){return this.style.setLayerZoomRange(b,l,p),this._update(!0)}setFilter(b,l,p={}){return this.style.setFilter(b,l,p),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,l,p,v={}){return this.style.setPaintProperty(b,l,p,v),this._update(!0)}getPaintProperty(b,l){return this.style.getPaintProperty(b,l)}setLayoutProperty(b,l,p,v={}){return this.style.setLayoutProperty(b,l,p,v),this._update(!0)}getLayoutProperty(b,l){return this.style.getLayoutProperty(b,l)}setLight(b,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,l),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(b,l){return this.style.setFeatureState(b,l),this._update()}removeFeatureState(b,l){return this.style.removeFeatureState(b,l),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,l=0;return this._container&&(b=this._container.clientWidth||400,l=this._container.clientHeight||300),[b,l]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map","mapboxgl-map");const l=this._canvasContainer=D.create("div","maplibregl-canvas-container mapboxgl-canvas-container",b);this._interactive&&l.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const p=this._containerDimensions();this._resizeCanvas(p[0],p[1],this.getPixelRatio());const v=this._controlContainer=D.create("div","maplibregl-control-container mapboxgl-control-container",b),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{E[P]=D.create("div",`maplibregl-ctrl-${P} mapboxgl-ctrl-${P}`,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const b=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=D.create("div","maplibregl-cooperative-gesture-screen",b);let l="Control",p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",l="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${p}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",v=>{v.key===l&&(this._metaPress=!0)}),document.addEventListener("keyup",v=>{v.key===l&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",v=>{this._onCooperativeGesture(v,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(b,l,p){this._canvas.width=p*b,this._canvas.height=p*l,this._canvas.style.width=`${b}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const b=a.extend({},y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl",b)||this._canvas.getContext("experimental-webgl",b);l?(this.painter=new br(l,this.transform),a.exported$1.testSupport(l)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:b}))}_contextRestored(b){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:b}))}_onMapScroll(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(b,l,p){return!l&&p<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){let l,p=0;const v=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(l=v.createQueryEXT(),v.beginQueryEXT(v.TIME_ELAPSED_EXT,l),p=a.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let E=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,N=a.exported.now();this.style.zoomHistory.update(z,N);const G=new a.EvaluationParameters(z,{now:N,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=G.crossFadingFactor();$===1&&$===this._crossFadingFactor||(E=!0,this._crossFadingFactor=$),this.style.update(G)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.load),this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||E)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const z=a.exported.now()-p;v.endQueryEXT(v.TIME_ELAPSED_EXT,l),setTimeout(()=>{const N=v.getQueryObjectEXT(l,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(l),this.fire(new a.Event("gpu-timing-frame",{cpuTime:z,gpuTime:N}))},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(z);this.fire(new a.Event("gpu-timing-layer",{layerTimes:N}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty;return P||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._cooperativeGestures&&D.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),a.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.exported.frame(b=>{a.PerformanceUtils.frame(b),this._frame=null,this._render(b)}))}_onWindowOnline(){this._update()}_onWindowResize(b){this._trackResize&&this.resize({originalEvent:b})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}_setCacheLimits(b,l){a.setCacheLimits(b,l)}get version(){return"2.4.0"}},NavigationControl:class{constructor(b){this.options=a.extend({},th,b),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const b=this._map.getZoom(),l=b===this._map.getMaxZoom(),p=b===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const b=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=b}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new si(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,l){const p=D.create("button",b,this._container);return p.type="button",p.addEventListener("click",l),p}_setButtonTitle(b,l){const p=this._map._getUIString(`NavigationControl.${l}`);b.title=p,b.setAttribute("aria-label",p)}},GeolocateControl:class extends a.Evented{constructor(b){super(),this.options=a.extend({},kc,b),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(b){var l;return this._map=b,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Co!==void 0?l(Co):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(p=>{Co=p.state!=="denied",l(Co)}):(Co=!!window.navigator.geolocation,l(Co)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,tr=0,Ks=!1}_isOutOfMapMaxBounds(b){const l=this._map.getMaxBounds(),p=b.coords;return l&&(p.longitude<l.getWest()||p.longitude>l.getEast()||p.latitude<l.getSouth()||p.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(b),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",b)),this._finish()}}_updateCamera(b){const l=new a.LngLat(b.coords.longitude,b.coords.latitude),p=b.coords.accuracy,v=this._map.getBearing(),E=a.extend({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(p),E,{geolocateSource:!0})}_updateMarker(b){if(b){const l=new a.LngLat(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const b=this._map._container.clientHeight/2,l=this._map.unproject([0,b]),p=this._map.unproject([1,b]),v=l.distanceTo(p),E=Math.ceil(2*this._accuracy/v);this._circleElement.style.width=`${E}px`,this._circleElement.style.height=`${E}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(b){if(this._map){if(this.options.trackUserLocation)if(b.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(b.code===3&&Ks)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",b)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(b){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",b===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new er(this._dotElement),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new er({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":tr--,Ks=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),tr++,tr>1?(b={maximumAge:6e5,timeout:0},Ks=!0):(b=this.options.positionOptions,Ks=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Sl,LogoControl:S0,ScaleControl:class{constructor(b){this.options=a.extend({},ms,b),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Lc(this._map,this._container,this.options)}onAdd(b){return this._map=b,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(b){this.options.unit=b,Lc(this._map,this._container,this.options)}},FullscreenControl:class{constructor(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const b=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(b){this.options=b,a.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(b){return this._map=b,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=D.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){D.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends a.Evented{constructor(b){super(),this.options=a.extend(Object.create(Ei),b),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const l=document.createDocumentFragment(),p=document.createElement("body");let v;for(p.innerHTML=b;v=p.firstChild,v;)l.appendChild(v);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){this._container&&this._container.classList.add(b)}removeClassName(b){this._container&&this._container.classList.remove(b)}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(b){this._update(b.point)}_onMouseMove(b){this._update(b.point)}_onDrag(b){this._update(b.point)}_update(b){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=D.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(P=>this._container.classList.add(P)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Cl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!b))return;const l=this._pos=this._trackPointer&&b?b:this._map.project(this._lngLat);let p=this.options.anchor;const v=Dc(this.options.offset);if(!p){const P=this._container.offsetWidth,z=this._container.offsetHeight;let N;N=l.y+v.bottom.y<z?["top"]:l.y>this._map.transform.height-z?["bottom"]:[],l.x<P/2?N.push("left"):l.x>this._map.transform.width-P/2&&N.push("right"),p=N.length===0?"bottom":N.join("-")}const E=l.add(v[p]).round();D.setTransform(this._container,`${Wt[p]} translate(${E.x}px,${E.y}px)`),en(this._container,p,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Bi);b&&b.focus()}_onClose(){this.remove()}},Marker:er,Style:_e,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,AJAXError:a.AJAXError,config:a.config,CanvasSource:Mn,GeoJSONSource:Gn,ImageSource:Bt,RasterDEMTileSource:Ot,RasterTileSource:St,VectorTileSource:ut,VideoSource:Qt,prewarm:function(){ei().acquire(mt)},clearPrewarmedResources:function(){const b=li;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(mt),li=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return jn.workerCount},set workerCount(b){jn.workerCount=b},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){a.config.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage(b){a.clearTileCache(b)},workerUrl:"",addProtocol(b,l){a.config.REGISTERED_PROTOCOLS[b]=l},removeProtocol(b){delete a.config.REGISTERED_PROTOCOLS[b]}};return Zr.extend(Jo,{isSafari:a.isSafari,getPerformanceMetrics:a.PerformanceUtils.getPerformanceMetrics}),Jo});var u=r;return u})})(dP);var Cte=dP.exports;const Pte=f3(Cte),Mte=8,Ite="Positron",kte={},Lte={carto:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"}},Dte="https://tiles.basemaps.cartocdn.com/gl/positron-gl-style/sprite",Rte="https://tiles.basemaps.cartocdn.com/fonts/{fontstack}/{range}.pbf",zte=[{id:"waterway_label",type:"symbol",source:"carto","source-layer":"waterway",filter:["all",["has","name"],["==","class","river"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-placement":"line","symbol-spacing":100,"symbol-avoid-edges":!1,"text-size":27,"text-padding":2,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-offset":[0,-.2],"text-letter-spacing":0,"text-keep-upright":!0},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"watername_ocean",type:"symbol",source:"carto","source-layer":"water_name",minzoom:0,maxzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","ocean"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_sea",type:"symbol",source:"carto","source-layer":"water_name",minzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","sea"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_lake",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","Point"],["==","class","lake"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"point","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto"},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"watername_lake_line",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","LineString"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"line","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-spacing":350,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-line-height":1.2},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"place_city_r6",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",6]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,12],[9,13],[10,14],[13,17],[14,20]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_r5",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",0],["<=","rank",5]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,14],[10,16],[13,19],[14,22]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",["!has","capital"],["!in","class","country","state"],[">=","rank",0],["<=","rank",7]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_capital_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",[">","capital",0]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"poi_stadium",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["in","class","stadium","cemetery","attraction"],["<=","rank",3]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"poi_park",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["==","class","park"]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"roadname_minor",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:16,filter:["all",["in","class","minor","service"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":9,"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_sec",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:15,filter:["all",["in","class","secondary","tertiary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,9],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_pri",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:14,filter:["all",["in","class","primary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[14,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_major",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:13,filter:["all",["in","class","trunk","motorway"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[13,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}}],Bte="voyager",Ote="Carto",Fte={version:Mte,name:Ite,metadata:kte,sources:Lte,sprite:Dte,glyphs:Rte,layers:zte,id:Bte,owner:Ote};var mo=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var r="";function s(Y){return e.locateFile?e.locateFile(Y,r):r+Y}var u;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",u=function(V,X,oe){var f=new XMLHttpRequest;f.open("GET",V,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status==200||f.status==0&&f.response){X(f.response);return}var ke=Ii(V);if(ke){X(ke.buffer);return}oe()},f.onerror=oe,f.send(null)};var a=e.print||console.log.bind(console),y=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var w=0,I=function(Y){w=Y},R=function(){return w},D=8;function U(Y,V,X,oe){switch(X=X||"i8",X.charAt(X.length-1)==="*"&&(X="i32"),X){case"i1":Mt[Y>>0]=V;break;case"i8":Mt[Y>>0]=V;break;case"i16":St[Y>>1]=V;break;case"i32":Pn[Y>>2]=V;break;case"i64":Lr=[V>>>0,(sr=V,+jn(sr)>=1?sr>0?(ei(+li(sr/4294967296),4294967295)|0)>>>0:~~+Bn((sr-+(~~sr>>>0))/4294967296)>>>0:0)],Pn[Y>>2]=Lr[0],Pn[Y+4>>2]=Lr[1];break;case"float":Ot[Y>>2]=V;break;case"double":Gn[Y>>3]=V;break;default:ar("invalid type for setValue: "+X)}}function q(Y,V,X){switch(V=V||"i8",V.charAt(V.length-1)==="*"&&(V="i32"),V){case"i1":return Mt[Y>>0];case"i8":return Mt[Y>>0];case"i16":return St[Y>>1];case"i32":return Pn[Y>>2];case"i64":return Pn[Y>>2];case"float":return Ot[Y>>2];case"double":return Gn[Y>>3];default:ar("invalid type for getValue: "+V)}return null}var ne=!1;function pe(Y,V){Y||ar("Assertion failed: "+V)}function J(Y){var V=e["_"+Y];return pe(V,"Cannot call unknown function "+Y+", make sure it is exported"),V}function ie(Y,V,X,oe,f){var W={string:function(ft){var Lt=0;if(ft!=null&&ft!==0){var Ct=(ft.length<<2)+1;Lt=$s(Ct),et(ft,Lt,Ct)}return Lt},array:function(ft){var Lt=$s(ft.length);return ht(ft,Lt),Lt}};function ke(ft){return V==="string"?De(ft):V==="boolean"?!!ft:ft}var Ce=J(Y),Ee=[],Me=0;if(oe)for(var Ne=0;Ne<oe.length;Ne++){var rt=W[X[Ne]];rt?(Me===0&&(Me=Wi()),Ee[Ne]=rt(oe[Ne])):Ee[Ne]=oe[Ne]}var Ve=Ce.apply(null,Ee);return Ve=ke(Ve),Me!==0&&bi(Me),Ve}function re(Y,V,X,oe){X=X||[];var f=X.every(function(ke){return ke==="number"}),W=V!=="string";return W&&f&&!oe?J(Y):function(){return ie(Y,V,X,arguments)}}var ge=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function be(Y,V,X){for(var oe=V+X,f=V;Y[f]&&!(f>=oe);)++f;if(f-V>16&&Y.subarray&&ge)return ge.decode(Y.subarray(V,f));for(var W="";V<f;){var ke=Y[V++];if(!(ke&128)){W+=String.fromCharCode(ke);continue}var Ce=Y[V++]&63;if((ke&224)==192){W+=String.fromCharCode((ke&31)<<6|Ce);continue}var Ee=Y[V++]&63;if((ke&240)==224?ke=(ke&15)<<12|Ce<<6|Ee:ke=(ke&7)<<18|Ce<<12|Ee<<6|Y[V++]&63,ke<65536)W+=String.fromCharCode(ke);else{var Me=ke-65536;W+=String.fromCharCode(55296|Me>>10,56320|Me&1023)}}return W}function De(Y,V){return Y?be(ut,Y,V):""}function qe(Y,V,X,oe){if(!(oe>0))return 0;for(var f=X,W=X+oe-1,ke=0;ke<Y.length;++ke){var Ce=Y.charCodeAt(ke);if(Ce>=55296&&Ce<=57343){var Ee=Y.charCodeAt(++ke);Ce=65536+((Ce&1023)<<10)|Ee&1023}if(Ce<=127){if(X>=W)break;V[X++]=Ce}else if(Ce<=2047){if(X+1>=W)break;V[X++]=192|Ce>>6,V[X++]=128|Ce&63}else if(Ce<=65535){if(X+2>=W)break;V[X++]=224|Ce>>12,V[X++]=128|Ce>>6&63,V[X++]=128|Ce&63}else{if(X+3>=W)break;V[X++]=240|Ce>>18,V[X++]=128|Ce>>12&63,V[X++]=128|Ce>>6&63,V[X++]=128|Ce&63}}return V[X]=0,X-f}function et(Y,V,X){return qe(Y,ut,V,X)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function ht(Y,V){Mt.set(Y,V)}function ot(Y,V){return Y%V>0&&(Y+=V-Y%V),Y}var at,Mt,ut,St,Pn,Ot,Gn;function vt(Y){at=Y,e.HEAP8=Mt=new Int8Array(Y),e.HEAP16=St=new Int16Array(Y),e.HEAP32=Pn=new Int32Array(Y),e.HEAPU8=ut=new Uint8Array(Y),e.HEAPU16=new Uint16Array(Y),e.HEAPU32=new Uint32Array(Y),e.HEAPF32=Ot=new Float32Array(Y),e.HEAPF64=Gn=new Float64Array(Y)}var Bt=5267040,Qt=24128,Mn=e.TOTAL_MEMORY||33554432;e.buffer?at=e.buffer:at=new ArrayBuffer(Mn),Mn=at.byteLength,vt(at),Pn[Qt>>2]=Bt;function bn(Y){for(;Y.length>0;){var V=Y.shift();if(typeof V=="function"){V();continue}var X=V.func;typeof X=="number"?V.arg===void 0?e.dynCall_v(X):e.dynCall_vi(X,V.arg):X(V.arg===void 0?null:V.arg)}}var pn=[],Nn=[],ti=[],Ue=[];function An(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)yn(e.preRun.shift());bn(pn)}function Un(){bn(Nn)}function At(){bn(ti)}function Xt(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)mt(e.postRun.shift());bn(Ue)}function yn(Y){pn.unshift(Y)}function mt(Y){Ue.unshift(Y)}var jn=Math.abs,Bn=Math.ceil,li=Math.floor,ei=Math.min,ci=0,hr=null;function Dn(Y){ci++,e.monitorRunDependencies&&e.monitorRunDependencies(ci)}function fr(Y){if(ci--,e.monitorRunDependencies&&e.monitorRunDependencies(ci),ci==0&&hr){var V=hr;hr=null,V()}}e.preloadedImages={},e.preloadedAudios={};var ni=null,Wr="data:application/octet-stream;base64,";function yo(Y){return String.prototype.startsWith?Y.startsWith(Wr):Y.indexOf(Wr)===0}var sr,Lr;ni="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var vo=24144;function $r(Y){return Y}function nt(Y){var V=/\b__Z[\w\d_]+/g;return Y.replace(V,function(X){var oe=X;return X===oe?X:oe+" ["+X+"]"})}function wt(){var Y=new Error;if(!Y.stack){try{throw new Error(0)}catch(V){Y=V}if(!Y.stack)return"(no stack trace available)"}return Y.stack.toString()}function Ms(){var Y=wt();return e.extraStackTrace&&(Y+=`
`+e.extraStackTrace()),nt(Y)}function or(Y,V,X,oe){ar("Assertion failed: "+De(Y)+", at: "+[V?De(V):"unknown filename",X,oe?De(oe):"unknown function"])}function In(){return Mt.length}function wr(Y,V,X){ut.set(ut.subarray(V,V+X),Y)}function Ar(Y){return e.___errno_location&&(Pn[e.___errno_location()>>2]=Y),Y}function dr(Y){ar("OOM")}function us(Y){try{var V=new ArrayBuffer(Y);return V.byteLength!=Y?void 0:(new Int8Array(V).set(Mt),zi(V),vt(V),1)}catch{}}function bt(Y){var V=In(),X=16777216,oe=2147483648-X;if(Y>oe)return!1;for(var f=16777216,W=Math.max(V,f);W<Y;)W<=536870912?W=ot(2*W,X):W=Math.min(ot((3*W+2147483648)/4,X),oe);var ke=us(W);return!!ke}var mn=typeof atob=="function"?atob:function(Y){var V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",X="",oe,f,W,ke,Ce,Ee,Me,Ne=0;Y=Y.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ke=V.indexOf(Y.charAt(Ne++)),Ce=V.indexOf(Y.charAt(Ne++)),Ee=V.indexOf(Y.charAt(Ne++)),Me=V.indexOf(Y.charAt(Ne++)),oe=ke<<2|Ce>>4,f=(Ce&15)<<4|Ee>>2,W=(Ee&3)<<6|Me,X=X+String.fromCharCode(oe),Ee!==64&&(X=X+String.fromCharCode(f)),Me!==64&&(X=X+String.fromCharCode(W));while(Ne<Y.length);return X};function dn(Y){try{for(var V=mn(Y),X=new Uint8Array(V.length),oe=0;oe<V.length;++oe)X[oe]=V.charCodeAt(oe);return X}catch{throw new Error("Converting base64 string to bytes failed.")}}function Ii(Y){if(yo(Y))return dn(Y.slice(Wr.length))}var hs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},un={a:ar,b:I,c:R,d:or,e:Ar,f:In,g:wr,h:bt,i:dr,j:$r,k:nt,l:us,m:wt,n:Ms,o:vo,p:Qt},pt=function(Y,V,X){"almost asm";var oe=new Y.Int8Array(X),f=new Y.Int32Array(X);new Y.Uint8Array(X),new Y.Float32Array(X);var W=new Y.Float64Array(X),ke=V.o|0,Ce=V.p|0,Ee=Y.Math.floor,Me=Y.Math.abs,Ne=Y.Math.sqrt,rt=Y.Math.pow,Ve=Y.Math.cos,ft=Y.Math.sin,Lt=Y.Math.tan,Ct=Y.Math.acos,Yt=Y.Math.asin,Gt=Y.Math.atan,on=Y.Math.atan2,$t=Y.Math.ceil,Kt=Y.Math.imul,wn=Y.Math.min,Ln=Y.Math.max,Wn=Y.Math.clz32,Vt=V.b,_e=V.c,tn=V.d,$i=V.e,$n=V.f,Ho=V.g,Wo=V.h,wa=V.i,de=24160;function xo(d){return oe=new Int8Array(d),f=new Int32Array(d),W=new Float64Array(d),X=d,!0}function fs(d){d=d|0;var A=0;return A=de,de=de+d|0,de=de+15&-16,A|0}function ba(){return de|0}function Ea(d){d=d|0,de=d}function Ta(d,A){d=d|0,de=d}function rl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;return(d|0)<0?(A=2,A|0):(d|0)>13780509?(A=Ba(15,A)|0,A|0):(m=((d|0)<0)<<31>>31,x=se(d|0,m|0,3,0)|0,_=_e()|0,m=P(d|0,m|0,1,0)|0,m=se(x|0,_|0,m|0,_e()|0)|0,m=P(m|0,_e()|0,1,0)|0,d=_e()|0,f[A>>2]=m,f[A+4>>2]=d,A=0,A|0)}function sl(d,A,m,_){return d=d|0,A=A|0,m=m|0,_=_|0,ks(d,A,m,_,0)|0}function ks(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0;if(O=de,de=de+16|0,M=O,!(ue(d,A,m,_,x)|0))return _=0,de=O,_|0;do if((m|0)>=0){if((m|0)>13780509){if(S=Ba(15,M)|0,S|0)break;L=M,M=f[L>>2]|0,L=f[L+4>>2]|0}else S=((m|0)<0)<<31>>31,H=se(m|0,S|0,3,0)|0,L=_e()|0,S=P(m|0,S|0,1,0)|0,S=se(H|0,L|0,S|0,_e()|0)|0,S=P(S|0,_e()|0,1,0)|0,L=_e()|0,f[M>>2]=S,f[M+4>>2]=L,M=S;if(He(_|0,0,M<<3|0)|0,x|0){He(x|0,0,M<<2|0)|0,S=me(d,A,m,_,x,M,L,0)|0;break}S=E(M,4)|0,S?(H=me(d,A,m,_,S,M,L,0)|0,v(S),S=H):S=13}else S=2;while(0);return H=S,de=O,H|0}function ue(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0;if(Be=de,de=de+16|0,Re=Be,Te=Be+8|0,we=Re,f[we>>2]=d,f[we+4>>2]=A,(m|0)<0)return Te=2,de=Be,Te|0;if(S=_,f[S>>2]=d,f[S+4>>2]=A,S=(x|0)!=0,S&&(f[x>>2]=0),ri(d,A)|0)return Te=9,de=Be,Te|0;f[Te>>2]=0;e:do if((m|0)>=1)if(S)for(ee=1,H=0,Ae=0,we=1,S=d;;){if(!(H|Ae)){if(S=Ie(S,A,4,Te,Re)|0,S|0)break e;if(A=Re,S=f[A>>2]|0,A=f[A+4>>2]|0,ri(S,A)|0){S=9;break e}}if(S=Ie(S,A,f[22384+(Ae<<2)>>2]|0,Te,Re)|0,S|0)break e;if(A=Re,S=f[A>>2]|0,A=f[A+4>>2]|0,d=_+(ee<<3)|0,f[d>>2]=S,f[d+4>>2]=A,f[x+(ee<<2)>>2]=we,d=H+1|0,M=(d|0)==(we|0),L=Ae+1|0,O=(L|0)==6,ri(S,A)|0){S=9;break e}if(we=we+(O&M&1)|0,(we|0)>(m|0)){S=0;break}else ee=ee+1|0,H=M?0:d,Ae=M?O?0:L:Ae}else for(ee=1,H=0,Ae=0,we=1,S=d;;){if(!(H|Ae)){if(S=Ie(S,A,4,Te,Re)|0,S|0)break e;if(A=Re,S=f[A>>2]|0,A=f[A+4>>2]|0,ri(S,A)|0){S=9;break e}}if(S=Ie(S,A,f[22384+(Ae<<2)>>2]|0,Te,Re)|0,S|0)break e;if(A=Re,S=f[A>>2]|0,A=f[A+4>>2]|0,d=_+(ee<<3)|0,f[d>>2]=S,f[d+4>>2]=A,d=H+1|0,M=(d|0)==(we|0),L=Ae+1|0,O=(L|0)==6,ri(S,A)|0){S=9;break e}if(we=we+(O&M&1)|0,(we|0)>(m|0)){S=0;break}else ee=ee+1|0,H=M?0:d,Ae=M?O?0:L:Ae}else S=0;while(0);return Te=S,de=Be,Te|0}function me(d,A,m,_,x,S,M,L){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0,M=M|0,L=L|0;var O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0;if(Be=de,de=de+16|0,Re=Be+8|0,Te=Be,O=xe(d|0,A|0,S|0,M|0)|0,ee=_e()|0,Ae=_+(O<<3)|0,tt=Ae,Ke=f[tt>>2]|0,tt=f[tt+4>>2]|0,H=(Ke|0)==(d|0)&(tt|0)==(A|0),!((Ke|0)==0&(tt|0)==0|H))do O=P(O|0,ee|0,1,0)|0,O=ce(O|0,_e()|0,S|0,M|0)|0,ee=_e()|0,Ae=_+(O<<3)|0,Ke=Ae,tt=f[Ke>>2]|0,Ke=f[Ke+4>>2]|0,H=(tt|0)==(d|0)&(Ke|0)==(A|0);while(!((tt|0)==0&(Ke|0)==0|H));if(O=x+(O<<2)|0,H&&(f[O>>2]|0)<=(L|0)||(Ke=Ae,f[Ke>>2]=d,f[Ke+4>>2]=A,f[O>>2]=L,(L|0)>=(m|0)))return Ke=0,de=Be,Ke|0;switch(H=L+1|0,f[Re>>2]=0,O=Ie(d,A,2,Re,Te)|0,O|0){case 9:{we=9;break}case 0:{O=Te,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,M,H)|0,O||(we=9);break}}e:do if((we|0)==9){switch(f[Re>>2]=0,O=Ie(d,A,3,Re,Te)|0,O|0){case 9:break;case 0:{if(O=Te,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,M,H)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,A,1,Re,Te)|0,O|0){case 9:break;case 0:{if(O=Te,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,M,H)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,A,5,Re,Te)|0,O|0){case 9:break;case 0:{if(O=Te,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,M,H)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,A,4,Re,Te)|0,O|0){case 9:break;case 0:{if(O=Te,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,M,H)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,A,6,Re,Te)|0,O|0){case 9:break;case 0:{if(O=Te,O=me(f[O>>2]|0,f[O+4>>2]|0,m,_,x,S,M,H)|0,O|0)break e;break}default:break e}return Ke=0,de=Be,Ke|0}while(0);return Ke=O,de=Be,Ke|0}function Ie(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0;if(m>>>0>6)return x=1,x|0;if(Ae=(f[_>>2]|0)%6|0,f[_>>2]=Ae,(Ae|0)>0){S=0;do m=qo(m)|0,S=S+1|0;while((S|0)<(f[_>>2]|0))}if(Ae=le(d|0,A|0,45)|0,_e()|0,ee=Ae&127,ee>>>0>121)return x=5,x|0;O=Ni(d,A)|0,S=le(d|0,A|0,52)|0,_e()|0,S=S&15;e:do if(!S)H=8;else{for(;;){if(M=(15-S|0)*3|0,L=le(d|0,A|0,M|0)|0,_e()|0,L=L&7,(L|0)==7){A=5;break}if(Te=(br(S)|0)==0,S=S+-1|0,we=ye(7,0,M|0)|0,A=A&~(_e()|0),Re=ye(f[(Te?432:16)+(L*28|0)+(m<<2)>>2]|0,0,M|0)|0,M=_e()|0,m=f[(Te?640:224)+(L*28|0)+(m<<2)>>2]|0,d=Re|d&~we,A=M|A,!m){m=0;break e}if(!S){H=8;break e}}return A|0}while(0);(H|0)==8&&(Te=f[848+(ee*28|0)+(m<<2)>>2]|0,Re=ye(Te|0,0,45)|0,d=Re|d,A=_e()|0|A&-1040385,m=f[4272+(ee*28|0)+(m<<2)>>2]|0,(Te&127|0)==127&&(Te=ye(f[848+(ee*28|0)+20>>2]|0,0,45)|0,A=_e()|0|A&-1040385,m=f[4272+(ee*28|0)+20>>2]|0,d=Ls(Te|d,A)|0,A=_e()|0,f[_>>2]=(f[_>>2]|0)+1)),L=le(d|0,A|0,45)|0,_e()|0,L=L&127;e:do if(On(L)|0){t:do if((Ni(d,A)|0)==1){if((ee|0)!=(L|0))if(ku(L,f[7696+(ee*28|0)>>2]|0)|0){d=w0(d,A)|0,M=1,A=_e()|0;break}else tn(23313,22416,436,22424);switch(O|0){case 3:{d=Ls(d,A)|0,A=_e()|0,f[_>>2]=(f[_>>2]|0)+1,M=0;break t}case 5:{d=w0(d,A)|0,A=_e()|0,f[_>>2]=(f[_>>2]|0)+5,M=0;break t}case 0:return Te=9,Te|0;default:return Te=1,Te|0}}else M=0;while(0);if((m|0)>0){S=0;do d=vc(d,A)|0,A=_e()|0,S=S+1|0;while((S|0)!=(m|0))}if((ee|0)!=(L|0)){if(!(f0(L)|0)){if((M|0)!=0|(Ni(d,A)|0)!=5)break;f[_>>2]=(f[_>>2]|0)+1;break}switch(Ae&127){case 8:case 118:break e}(Ni(d,A)|0)!=3&&(f[_>>2]=(f[_>>2]|0)+1)}}else if((m|0)>0){S=0;do d=Ls(d,A)|0,A=_e()|0,S=S+1|0;while((S|0)!=(m|0))}while(0);return f[_>>2]=((f[_>>2]|0)+m|0)%6|0,Te=x,f[Te>>2]=d,f[Te+4>>2]=A,Te=0,Te|0}function Qe(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0;for(L=de,de=de+16|0,S=L,M=L+8|0,x=(ri(d,A)|0)==0,x=x?1:2;;){if(f[M>>2]=0,H=(Ie(d,A,x,M,S)|0)==0,O=S,H&((f[O>>2]|0)==(m|0)?(f[O+4>>2]|0)==(_|0):0)){d=4;break}if(x=x+1|0,x>>>0>=7){x=7,d=4;break}}return(d|0)==4?(de=L,x|0):0}function gt(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0;if(Te=de,de=de+16|0,we=Te,Re=Te+8|0,Ae=we,f[Ae>>2]=d,f[Ae+4>>2]=A,!m)return Re=_,f[Re>>2]=d,f[Re+4>>2]=A,Re=0,de=Te,Re|0;f[Re>>2]=0;e:do if(ri(d,A)|0)d=9;else{if(S=(m|0)>0,S){x=0,Ae=d;do{if(d=Ie(Ae,A,4,Re,we)|0,d|0)break e;if(A=we,Ae=f[A>>2]|0,A=f[A+4>>2]|0,x=x+1|0,ri(Ae,A)|0){d=9;break e}}while((x|0)<(m|0));if(ee=_,f[ee>>2]=Ae,f[ee+4>>2]=A,ee=m+-1|0,S){H=0,d=1;do{if(x=22384+(H<<2)|0,(H|0)==5)for(M=f[x>>2]|0,S=0,x=d;;){if(d=we,d=Ie(f[d>>2]|0,f[d+4>>2]|0,M,Re,we)|0,d|0)break e;if((S|0)!=(ee|0))if(O=we,L=f[O>>2]|0,O=f[O+4>>2]|0,d=_+(x<<3)|0,f[d>>2]=L,f[d+4>>2]=O,!(ri(L,O)|0))d=x+1|0;else{d=9;break e}else d=x;if(S=S+1|0,(S|0)>=(m|0))break;x=d}else for(M=we,O=f[x>>2]|0,L=0,x=d,S=f[M>>2]|0,M=f[M+4>>2]|0;;){if(d=Ie(S,M,O,Re,we)|0,d|0)break e;if(M=we,S=f[M>>2]|0,M=f[M+4>>2]|0,d=_+(x<<3)|0,f[d>>2]=S,f[d+4>>2]=M,d=x+1|0,ri(S,M)|0){d=9;break e}if(L=L+1|0,(L|0)>=(m|0))break;x=d}H=H+1|0}while(H>>>0<6);d=we,M=Ae,x=f[d>>2]|0,S=A,d=f[d+4>>2]|0}else M=Ae,x=Ae,S=A,d=A}else M=_,f[M>>2]=d,f[M+4>>2]=A,M=d,x=d,S=A,d=A;d=(M|0)==(x|0)&(S|0)==(d|0)?0:9}while(0);return Re=d,de=Te,Re|0}function Ut(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0;if(L=de,de=de+48|0,x=L+16|0,S=L+8|0,M=L,m|0)return M=15,de=L,M|0;if(H=d,O=f[H+4>>2]|0,m=S,f[m>>2]=f[H>>2],f[m+4>>2]=O,Ys(S,x),A=Lu(x,A,M)|0,!A){if(m=f[S>>2]|0,S=f[d+8>>2]|0,(S|0)>0){x=f[d+12>>2]|0,A=0;do m=(f[x+(A<<3)>>2]|0)+m|0,A=A+1|0;while((A|0)<(S|0))}A=M,x=f[A>>2]|0,A=f[A+4>>2]|0,S=((m|0)<0)<<31>>31,(A|0)<(S|0)|(A|0)==(S|0)&x>>>0<m>>>0?(A=M,f[A>>2]=m,f[A+4>>2]=S,A=S):m=x,O=P(m|0,A|0,12,0)|0,H=_e()|0,A=M,f[A>>2]=O,f[A+4>>2]=H,A=_,f[A>>2]=O,f[A+4>>2]=H,A=0}return H=A,de=L,H|0}function En(d,A,m,_,x,S,M){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0,M=M|0;var L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0,Et=0,st=0,dt=0,gn=0,hn=0,sn=0,an=0,fn=0,vn=0,Zn=0,_n=0,oi=0,Ti=0,Po=0;if(Zn=de,de=de+64|0,sn=Zn+48|0,an=Zn+32|0,fn=Zn+24|0,It=Zn+8|0,Et=Zn,O=f[d>>2]|0,(O|0)<=0)return vn=0,de=Zn,vn|0;for(st=d+4|0,dt=sn+8|0,gn=an+8|0,hn=It+8|0,L=0,$e=0;;){H=f[st>>2]|0,We=H+($e<<4)|0,f[sn>>2]=f[We>>2],f[sn+4>>2]=f[We+4>>2],f[sn+8>>2]=f[We+8>>2],f[sn+12>>2]=f[We+12>>2],($e|0)==(O+-1|0)?(f[an>>2]=f[H>>2],f[an+4>>2]=f[H+4>>2],f[an+8>>2]=f[H+8>>2],f[an+12>>2]=f[H+12>>2]):(We=H+($e+1<<4)|0,f[an>>2]=f[We>>2],f[an+4>>2]=f[We+4>>2],f[an+8>>2]=f[We+8>>2],f[an+12>>2]=f[We+12>>2]),O=ll(sn,an,_,fn)|0;e:do if(O)H=0,L=O;else if(H=fn,O=f[H>>2]|0,H=f[H+4>>2]|0,(H|0)>0|(H|0)==0&O>>>0>0){Ke=0,We=0;t:for(;;){if(Po=+W[sn>>3],tt=z(O|0,H|0,Ke|0,We|0)|0,Ti=+(tt>>>0)+4294967296*+(_e()|0),_n=+(O>>>0)+4294967296*+(H|0),oi=+(Ke>>>0)+4294967296*+(We|0),W[It>>3]=Po*Ti/_n+ +W[an>>3]*oi/_n,W[hn>>3]=+W[dt>>3]*Ti/_n+ +W[gn>>3]*oi/_n,O=xl(It,_,Et)|0,O|0){L=O;break}tt=Et,Be=f[tt>>2]|0,tt=f[tt+4>>2]|0,we=xe(Be|0,tt|0,A|0,m|0)|0,ee=_e()|0,O=M+(we<<3)|0,Ae=O,H=f[Ae>>2]|0,Ae=f[Ae+4>>2]|0;n:do if((H|0)==0&(Ae|0)==0)Oe=O,vn=16;else for(Re=0,Te=0;;){if((Re|0)>(m|0)|(Re|0)==(m|0)&Te>>>0>A>>>0){L=1;break t}if((H|0)==(Be|0)&(Ae|0)==(tt|0))break n;if(O=P(we|0,ee|0,1,0)|0,we=ce(O|0,_e()|0,A|0,m|0)|0,ee=_e()|0,Te=P(Te|0,Re|0,1,0)|0,Re=_e()|0,O=M+(we<<3)|0,Ae=O,H=f[Ae>>2]|0,Ae=f[Ae+4>>2]|0,(H|0)==0&(Ae|0)==0){Oe=O,vn=16;break}}while(0);if((vn|0)==16&&(vn=0,!((Be|0)==0&(tt|0)==0))&&(Te=Oe,f[Te>>2]=Be,f[Te+4>>2]=tt,Te=S+(f[x>>2]<<3)|0,f[Te>>2]=Be,f[Te+4>>2]=tt,Te=x,Te=P(f[Te>>2]|0,f[Te+4>>2]|0,1,0)|0,Be=_e()|0,tt=x,f[tt>>2]=Te,f[tt+4>>2]=Be),Ke=P(Ke|0,We|0,1,0)|0,We=_e()|0,H=fn,O=f[H>>2]|0,H=f[H+4>>2]|0,!((H|0)>(We|0)|(H|0)==(We|0)&O>>>0>Ke>>>0)){H=1;break e}}H=0}else H=1;while(0);if($e=$e+1|0,!H){vn=21;break}if(O=f[d>>2]|0,($e|0)>=(O|0)){L=0,vn=21;break}}return(vn|0)==21?(de=Zn,L|0):0}function _i(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0,Et=0,st=0,dt=0,gn=0,hn=0,sn=0,an=0,fn=0,vn=0,Zn=0,_n=0,oi=0,Ti=0;if(Ti=de,de=de+112|0,vn=Ti+80|0,O=Ti+72|0,Zn=Ti,_n=Ti+56|0,m|0)return oi=15,de=Ti,oi|0;if(H=d+8|0,oi=p((f[H>>2]<<5)+32|0)|0,!oi)return oi=13,de=Ti,oi|0;if(Yu(d,oi),an=d,fn=f[an+4>>2]|0,m=O,f[m>>2]=f[an>>2],f[m+4>>2]=fn,Ys(O,vn),m=Lu(vn,A,Zn)|0,m)an=0,fn=0;else{if(m=f[O>>2]|0,S=f[H>>2]|0,(S|0)>0){M=f[d+12>>2]|0,x=0;do m=(f[M+(x<<3)>>2]|0)+m|0,x=x+1|0;while((x|0)!=(S|0));x=m}else x=m;m=Zn,S=f[m>>2]|0,m=f[m+4>>2]|0,M=((x|0)<0)<<31>>31,(m|0)<(M|0)|(m|0)==(M|0)&S>>>0<x>>>0?(m=Zn,f[m>>2]=x,f[m+4>>2]=M,m=M):x=S,an=P(x|0,m|0,12,0)|0,fn=_e()|0,m=Zn,f[m>>2]=an,f[m+4>>2]=fn,m=0}if(m|0)return v(oi),oi=m,de=Ti,oi|0;if(x=E(an,8)|0,!x)return v(oi),oi=13,de=Ti,oi|0;if(L=E(an,8)|0,!L)return v(oi),v(x),oi=13,de=Ti,oi|0;hn=vn,f[hn>>2]=0,f[hn+4>>2]=0,hn=d,sn=f[hn+4>>2]|0,m=O,f[m>>2]=f[hn>>2],f[m+4>>2]=sn,m=En(O,an,fn,A,vn,x,L)|0;e:do if(m)v(x),v(L),v(oi);else{t:do if((f[H>>2]|0)>0){for(M=d+12|0,S=0;m=En((f[M>>2]|0)+(S<<3)|0,an,fn,A,vn,x,L)|0,S=S+1|0,!(m|0);)if((S|0)>=(f[H>>2]|0))break t;v(x),v(L),v(oi);break e}while(0);(fn|0)>0|(fn|0)==0&an>>>0>0&&He(L|0,0,an<<3|0)|0,sn=vn,hn=f[sn+4>>2]|0;t:do if((hn|0)>0|(hn|0)==0&(f[sn>>2]|0)>>>0>0){st=x,dt=L,gn=x,hn=L,sn=x,m=x,Oe=x,It=L,Et=L,x=L;n:for(;;){for(tt=0,Ke=0,We=0,$e=0,S=0,M=0;;){L=Zn,O=L+56|0;do f[L>>2]=0,L=L+4|0;while((L|0)<(O|0));if(A=st+(tt<<3)|0,H=f[A>>2]|0,A=f[A+4>>2]|0,ue(H,A,1,Zn,0)|0){L=Zn,O=L+56|0;do f[L>>2]=0,L=L+4|0;while((L|0)<(O|0));L=E(7,4)|0,L|0&&(me(H,A,1,Zn,L,7,0,0)|0,v(L))}for(Be=0;;){Te=Zn+(Be<<3)|0,Re=f[Te>>2]|0,Te=f[Te+4>>2]|0;i:do if((Re|0)==0&(Te|0)==0)L=S,O=M;else{if(ee=xe(Re|0,Te|0,an|0,fn|0)|0,H=_e()|0,L=_+(ee<<3)|0,A=L,O=f[A>>2]|0,A=f[A+4>>2]|0,!((O|0)==0&(A|0)==0)){Ae=0,we=0;do{if((Ae|0)>(fn|0)|(Ae|0)==(fn|0)&we>>>0>an>>>0)break n;if((O|0)==(Re|0)&(A|0)==(Te|0)){L=S,O=M;break i}L=P(ee|0,H|0,1,0)|0,ee=ce(L|0,_e()|0,an|0,fn|0)|0,H=_e()|0,we=P(we|0,Ae|0,1,0)|0,Ae=_e()|0,L=_+(ee<<3)|0,A=L,O=f[A>>2]|0,A=f[A+4>>2]|0}while(!((O|0)==0&(A|0)==0))}(Re|0)==0&(Te|0)==0?(L=S,O=M):(Xs(Re,Te,_n)|0,Fa(d,oi,_n)|0&&(we=P(S|0,M|0,1,0)|0,M=_e()|0,Ae=L,f[Ae>>2]=Re,f[Ae+4>>2]=Te,S=dt+(S<<3)|0,f[S>>2]=Re,f[S+4>>2]=Te,S=we),L=S,O=M)}while(0);if(Be=Be+1|0,Be>>>0>=7)break;S=L,M=O}if(tt=P(tt|0,Ke|0,1,0)|0,Ke=_e()|0,We=P(We|0,$e|0,1,0)|0,$e=_e()|0,M=vn,S=f[M>>2]|0,M=f[M+4>>2]|0,($e|0)<(M|0)|($e|0)==(M|0)&We>>>0<S>>>0)S=L,M=O;else break}if((M|0)>0|(M|0)==0&S>>>0>0){S=0,M=0;do $e=st+(S<<3)|0,f[$e>>2]=0,f[$e+4>>2]=0,S=P(S|0,M|0,1,0)|0,M=_e()|0,$e=vn,We=f[$e+4>>2]|0;while((M|0)<(We|0)|((M|0)==(We|0)?S>>>0<(f[$e>>2]|0)>>>0:0))}if($e=vn,f[$e>>2]=L,f[$e+4>>2]=O,(O|0)>0|(O|0)==0&L>>>0>0)Be=x,tt=Et,Ke=sn,We=It,$e=dt,x=Oe,Et=m,It=gn,Oe=Be,m=tt,sn=hn,hn=Ke,gn=We,dt=st,st=$e;else break t}v(gn),v(hn),v(oi),m=1;break e}else m=L;while(0);v(oi),v(x),v(m),m=0}while(0);return oi=m,de=Ti,oi|0}function Tn(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0;if(ee=de,de=de+176|0,O=ee,(A|0)<1)return Ks(m,0,0),H=0,de=ee,H|0;for(L=d,L=le(f[L>>2]|0,f[L+4>>2]|0,52)|0,_e()|0,Ks(m,(A|0)>6?A:6,L&15),L=0;_=d+(L<<3)|0,_=La(f[_>>2]|0,f[_+4>>2]|0,O)|0,!(_|0);){if(_=f[O>>2]|0,(_|0)>0){M=0;do S=O+8+(M<<4)|0,M=M+1|0,_=O+8+(((M|0)%(_|0)|0)<<4)|0,x=Bi(m,_,S)|0,x?Js(m,x)|0:Ei(m,S,_)|0,_=f[O>>2]|0;while((M|0)<(_|0))}if(L=L+1|0,(L|0)>=(A|0)){_=0,H=13;break}}return(H|0)==13?(de=ee,_|0):(ms(m),H=_,de=ee,H|0)}function ki(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0;if(S=de,de=de+32|0,_=S,x=S+16|0,d=Tn(d,A,x)|0,d|0)return m=d,de=S,m|0;if(f[m>>2]=0,f[m+4>>2]=0,f[m+8>>2]=0,d=Lc(x)|0,d|0)do{A=Dt(m)|0;do E0(A,d)|0,M=d+16|0,f[_>>2]=f[M>>2],f[_+4>>2]=f[M+4>>2],f[_+8>>2]=f[M+8>>2],f[_+12>>2]=f[M+12>>2],Js(x,d)|0,d=Dc(x,_)|0;while(d|0);d=Lc(x)|0}while(d|0);return ms(x),d=Ec(m)|0,d?(Xu(m),M=d,de=S,M|0):(M=0,de=S,M|0)}function On(d){return d=d|0,d>>>0>121?(d=0,d|0):(d=f[7696+(d*28|0)+16>>2]|0,d|0)}function f0(d){return d=d|0,(d|0)==4|(d|0)==117|0}function A0(d){return d=d|0,f[11120+((f[d>>2]|0)*216|0)+((f[d+4>>2]|0)*72|0)+((f[d+8>>2]|0)*24|0)+(f[d+12>>2]<<3)>>2]|0}function d0(d){return d=d|0,f[11120+((f[d>>2]|0)*216|0)+((f[d+4>>2]|0)*72|0)+((f[d+8>>2]|0)*24|0)+(f[d+12>>2]<<3)+4>>2]|0}function Iu(d,A){d=d|0,A=A|0,d=7696+(d*28|0)|0,f[A>>2]=f[d>>2],f[A+4>>2]=f[d+4>>2],f[A+8>>2]=f[d+8>>2],f[A+12>>2]=f[d+12>>2]}function z1(d,A){d=d|0,A=A|0;var m=0,_=0;if(A>>>0>20)return A=-1,A|0;do if((f[11120+(A*216|0)>>2]|0)!=(d|0))if((f[11120+(A*216|0)+8>>2]|0)!=(d|0))if((f[11120+(A*216|0)+16>>2]|0)!=(d|0))if((f[11120+(A*216|0)+24>>2]|0)!=(d|0))if((f[11120+(A*216|0)+32>>2]|0)!=(d|0))if((f[11120+(A*216|0)+40>>2]|0)!=(d|0))if((f[11120+(A*216|0)+48>>2]|0)!=(d|0))if((f[11120+(A*216|0)+56>>2]|0)!=(d|0))if((f[11120+(A*216|0)+64>>2]|0)!=(d|0))if((f[11120+(A*216|0)+72>>2]|0)!=(d|0))if((f[11120+(A*216|0)+80>>2]|0)!=(d|0))if((f[11120+(A*216|0)+88>>2]|0)!=(d|0))if((f[11120+(A*216|0)+96>>2]|0)!=(d|0))if((f[11120+(A*216|0)+104>>2]|0)!=(d|0))if((f[11120+(A*216|0)+112>>2]|0)!=(d|0))if((f[11120+(A*216|0)+120>>2]|0)!=(d|0))if((f[11120+(A*216|0)+128>>2]|0)!=(d|0))if((f[11120+(A*216|0)+136>>2]|0)==(d|0))d=2,m=1,_=2;else{if((f[11120+(A*216|0)+144>>2]|0)==(d|0)){d=0,m=2,_=0;break}if((f[11120+(A*216|0)+152>>2]|0)==(d|0)){d=0,m=2,_=1;break}if((f[11120+(A*216|0)+160>>2]|0)==(d|0)){d=0,m=2,_=2;break}if((f[11120+(A*216|0)+168>>2]|0)==(d|0)){d=1,m=2,_=0;break}if((f[11120+(A*216|0)+176>>2]|0)==(d|0)){d=1,m=2,_=1;break}if((f[11120+(A*216|0)+184>>2]|0)==(d|0)){d=1,m=2,_=2;break}if((f[11120+(A*216|0)+192>>2]|0)==(d|0)){d=2,m=2,_=0;break}if((f[11120+(A*216|0)+200>>2]|0)==(d|0)){d=2,m=2,_=1;break}if((f[11120+(A*216|0)+208>>2]|0)==(d|0)){d=2,m=2,_=2;break}else d=-1;return d|0}else d=2,m=1,_=1;else d=2,m=1,_=0;else d=1,m=1,_=2;else d=1,m=1,_=1;else d=1,m=1,_=0;else d=0,m=1,_=2;else d=0,m=1,_=1;else d=0,m=1,_=0;else d=2,m=0,_=2;else d=2,m=0,_=1;else d=2,m=0,_=0;else d=1,m=0,_=2;else d=1,m=0,_=1;else d=1,m=0,_=0;else d=0,m=0,_=2;else d=0,m=0,_=1;else d=0,m=0,_=0;while(0);return A=f[11120+(A*216|0)+(m*72|0)+(d*24|0)+(_<<3)+4>>2]|0,A|0}function ku(d,A){return d=d|0,A=A|0,(f[7696+(d*28|0)+20>>2]|0)==(A|0)?(A=1,A|0):(A=(f[7696+(d*28|0)+24>>2]|0)==(A|0),A|0)}function ol(d,A){return d=d|0,A=A|0,f[848+(d*28|0)+(A<<2)>>2]|0}function al(d,A){return d=d|0,A=A|0,(f[848+(d*28|0)>>2]|0)==(A|0)?(A=0,A|0):(f[848+(d*28|0)+4>>2]|0)==(A|0)?(A=1,A|0):(f[848+(d*28|0)+8>>2]|0)==(A|0)?(A=2,A|0):(f[848+(d*28|0)+12>>2]|0)==(A|0)?(A=3,A|0):(f[848+(d*28|0)+16>>2]|0)==(A|0)?(A=4,A|0):(f[848+(d*28|0)+20>>2]|0)==(A|0)?(A=5,A|0):((f[848+(d*28|0)+24>>2]|0)==(A|0)?6:7)|0}function fc(){return 122}function Ac(d){d=d|0;var A=0,m=0,_=0;A=0;do ye(A|0,0,45)|0,_=_e()|0|134225919,m=d+(A<<3)|0,f[m>>2]=-1,f[m+4>>2]=_,A=A+1|0;while((A|0)!=122);return 0}function qn(d){return d=d|0,+W[d+16>>3]<+W[d+24>>3]|0}function dc(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;return m=+W[A>>3],!(m>=+W[d+8>>3])||!(m<=+W[d>>3])?(A=0,A|0):(_=+W[d+16>>3],m=+W[d+24>>3],x=+W[A+8>>3],A=x>=m,d=x<=_&1,_<m?A&&(d=1):A||(d=0),A=(d|0)!=0,A|0)}function Lu(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0;Te=de,de=de+288|0,ee=Te+264|0,Ae=Te+96|0,H=Te,L=H,O=L+96|0;do f[L>>2]=0,L=L+4|0;while((L|0)<(O|0));return A=b0(A,H)|0,A|0?(Re=A,de=Te,Re|0):(O=H,H=f[O>>2]|0,O=f[O+4>>2]|0,Xs(H,O,ee)|0,La(H,O,Ae)|0,M=+bl(ee,Ae+8|0),W[ee>>3]=+W[d>>3],O=ee+8|0,W[O>>3]=+W[d+16>>3],W[Ae>>3]=+W[d+8>>3],H=Ae+8|0,W[H>>3]=+W[d+24>>3],x=+bl(ee,Ae),tt=+W[O>>3]-+W[H>>3],S=+Me(+tt),Be=+W[ee>>3]-+W[Ae>>3],_=+Me(+Be),!(tt==0|Be==0)&&(tt=+ze(+S,+_),tt=+$t(+(x*x/+je(+(tt/+je(+S,+_)),3)/(M*(M*2.59807621135)*.8))),W[ke>>3]=tt,we=~~tt>>>0,Re=+Me(tt)>=1?tt>0?~~+wn(+Ee(tt/4294967296),4294967295)>>>0:~~+$t((tt-+(~~tt>>>0))/4294967296)>>>0:0,(f[ke+4>>2]&2146435072|0)!=2146435072)?(Ae=(we|0)==0&(Re|0)==0,A=m,f[A>>2]=Ae?1:we,f[A+4>>2]=Ae?0:Re,A=0):A=1,Re=A,de=Te,Re|0)}function ll(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0,ee=0;H=de,de=de+288|0,M=H+264|0,L=H+96|0,O=H,x=O,S=x+96|0;do f[x>>2]=0,x=x+4|0;while((x|0)<(S|0));return m=b0(m,O)|0,m|0?(_=m,de=H,_|0):(m=O,x=f[m>>2]|0,m=f[m+4>>2]|0,Xs(x,m,M)|0,La(x,m,L)|0,ee=+bl(M,L+8|0),ee=+$t(+(+bl(d,A)/(ee*2))),W[ke>>3]=ee,m=~~ee>>>0,x=+Me(ee)>=1?ee>0?~~+wn(+Ee(ee/4294967296),4294967295)>>>0:~~+$t((ee-+(~~ee>>>0))/4294967296)>>>0:0,(f[ke+4>>2]&2146435072|0)==2146435072?(_=1,de=H,_|0):(O=(m|0)==0&(x|0)==0,f[_>>2]=O?1:m,f[_+4>>2]=O?0:x,_=0,de=H,_|0))}function cl(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0,f[d>>2]=A,f[d+4>>2]=m,f[d+8>>2]=_}function Du(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0;Ae=A+8|0,f[Ae>>2]=0,O=+W[d>>3],M=+Me(+O),H=+W[d+8>>3],L=+Me(+H)/.8660254037844386,M=M+L*.5,m=~~M,d=~~L,M=M-+(m|0),L=L-+(d|0);do if(M<.5)if(M<.3333333333333333)if(f[A>>2]=m,L<(M+1)*.5){f[A+4>>2]=d;break}else{d=d+1|0,f[A+4>>2]=d;break}else if(we=1-M,d=(!(L<we)&1)+d|0,f[A+4>>2]=d,we<=L&L<M*2){m=m+1|0,f[A>>2]=m;break}else{f[A>>2]=m;break}else{if(!(M<.6666666666666666))if(m=m+1|0,f[A>>2]=m,L<M*.5){f[A+4>>2]=d;break}else{d=d+1|0,f[A+4>>2]=d;break}if(L<1-M){if(f[A+4>>2]=d,M*2+-1<L){f[A>>2]=m;break}}else d=d+1|0,f[A+4>>2]=d;m=m+1|0,f[A>>2]=m}while(0);do if(O<0)if(d&1){ee=(d+1|0)/2|0,ee=z(m|0,((m|0)<0)<<31>>31|0,ee|0,((ee|0)<0)<<31>>31|0)|0,m=~~(+(m|0)-((+(ee>>>0)+4294967296*+(_e()|0))*2+1)),f[A>>2]=m;break}else{ee=(d|0)/2|0,ee=z(m|0,((m|0)<0)<<31>>31|0,ee|0,((ee|0)<0)<<31>>31|0)|0,m=~~(+(m|0)-(+(ee>>>0)+4294967296*+(_e()|0))*2),f[A>>2]=m;break}while(0);ee=A+4|0,H<0&&(m=m-((d<<1|1|0)/2|0)|0,f[A>>2]=m,d=0-d|0,f[ee>>2]=d),_=d-m|0,(m|0)<0?(x=0-m|0,f[ee>>2]=_,f[Ae>>2]=x,f[A>>2]=0,d=_,m=0):x=0,(d|0)<0&&(m=m-d|0,f[A>>2]=m,x=x-d|0,f[Ae>>2]=x,f[ee>>2]=0,d=0),S=m-x|0,_=d-x|0,(x|0)<0&&(f[A>>2]=S,f[ee>>2]=_,f[Ae>>2]=0,d=_,m=S,x=0),_=(d|0)<(m|0)?d:m,_=(x|0)<(_|0)?x:_,!((_|0)<=0)&&(f[A>>2]=m-_,f[ee>>2]=d-_,f[Ae>>2]=x-_)}function ui(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0;A=f[d>>2]|0,M=d+4|0,m=f[M>>2]|0,(A|0)<0&&(m=m-A|0,f[M>>2]=m,S=d+8|0,f[S>>2]=(f[S>>2]|0)-A,f[d>>2]=0,A=0),(m|0)<0?(A=A-m|0,f[d>>2]=A,S=d+8|0,x=(f[S>>2]|0)-m|0,f[S>>2]=x,f[M>>2]=0,m=0):(x=d+8|0,S=x,x=f[x>>2]|0),(x|0)<0&&(A=A-x|0,f[d>>2]=A,m=m-x|0,f[M>>2]=m,f[S>>2]=0,x=0),_=(m|0)<(A|0)?m:A,_=(x|0)<(_|0)?x:_,!((_|0)<=0)&&(f[d>>2]=A-_,f[M>>2]=m-_,f[S>>2]=x-_)}function Zs(d,A){d=d|0,A=A|0;var m=0,_=0;_=f[d+8>>2]|0,m=+((f[d+4>>2]|0)-_|0),W[A>>3]=+((f[d>>2]|0)-_|0)-m*.5,W[A+8>>3]=m*.8660254037844386}function qi(d,A,m){d=d|0,A=A|0,m=m|0,f[m>>2]=(f[A>>2]|0)+(f[d>>2]|0),f[m+4>>2]=(f[A+4>>2]|0)+(f[d+4>>2]|0),f[m+8>>2]=(f[A+8>>2]|0)+(f[d+8>>2]|0)}function Sa(d,A,m){d=d|0,A=A|0,m=m|0,f[m>>2]=(f[d>>2]|0)-(f[A>>2]|0),f[m+4>>2]=(f[d+4>>2]|0)-(f[A+4>>2]|0),f[m+8>>2]=(f[d+8>>2]|0)-(f[A+8>>2]|0)}function p0(d,A){d=d|0,A=A|0;var m=0,_=0;m=Kt(f[d>>2]|0,A)|0,f[d>>2]=m,m=d+4|0,_=Kt(f[m>>2]|0,A)|0,f[m>>2]=_,d=d+8|0,A=Kt(f[d>>2]|0,A)|0,f[d>>2]=A}function Ca(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;M=f[d>>2]|0,L=(M|0)<0,_=(f[d+4>>2]|0)-(L?M:0)|0,S=(_|0)<0,x=(S?0-_|0:0)+((f[d+8>>2]|0)-(L?M:0))|0,m=(x|0)<0,d=m?0:x,A=(S?0:_)-(m?x:0)|0,x=(L?0:M)-(S?_:0)-(m?x:0)|0,m=(A|0)<(x|0)?A:x,m=(d|0)<(m|0)?d:m,_=(m|0)>0,d=d-(_?m:0)|0,A=A-(_?m:0)|0;e:do switch(x-(_?m:0)|0){case 0:switch(A|0){case 0:return L=d|0?(d|0)==1?1:7:0,L|0;case 1:return L=d|0?(d|0)==1?3:7:2,L|0;default:break e}case 1:switch(A|0){case 0:return L=d|0?(d|0)==1?5:7:4,L|0;case 1:{if(!d)d=6;else break e;return d|0}default:break e}}while(0);return L=7,L|0}function m0(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;M=d+8|0,x=f[M>>2]|0,S=(f[d>>2]|0)-x|0,L=d+4|0,x=(f[L>>2]|0)-x|0;do if(S>>>0>715827881|x>>>0>715827881){if(m=(S|0)>0,m){if((2147483647-S|0)<(S|0)||(2147483647-(S<<1)|0)<(S|0))return L=1,L|0}else if((-2147483648-S|0)>(S|0)||(-2147483648-(S<<1)|0)>(S|0))return L=1,L|0;if(A=S*3|0,(x|0)>0){if((2147483647-x|0)<(x|0))return L=1,L|0}else if((-2147483648-x|0)>(x|0))return L=1,L|0;if(_=x<<1,(S|0)>-1){if((A|-2147483648|0)>=(x|0))return L=1,L|0}else if((A^-2147483648|0)<(x|0))return L=1,L|0;if(m){if((2147483647-S|0)<(_|0))A=1;else{m=_;break}return A|0}else{if((-2147483648-S|0)>(_|0))A=1;else{m=_;break}return A|0}}else m=x<<1,A=S*3|0;while(0);_=l(+(A-x|0)/7)|0,f[d>>2]=_,x=l(+(m+S|0)/7)|0,f[L>>2]=x,f[M>>2]=0,m=(x|0)<(_|0),A=m?_:x,m=m?x:_;do if((m|0)<0){if((A|0)>0){if((A|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-A|0)>=(m|0)))break;tn(23313,22444,355,22455)}if((m|0)==-2147483648|(-2147483648-A|0)>(m|0)&&tn(23313,22444,355,22455),(A|0)>-1){if((A|-2147483648|0)<(m|0))break;tn(23313,22444,355,22455)}else{if((A^-2147483648|0)>=(m|0))break;tn(23313,22444,355,22455)}}while(0);return A=x-_|0,(_|0)<0?(m=0-_|0,f[L>>2]=A,f[M>>2]=m,f[d>>2]=0,_=0):(A=x,m=0),(A|0)<0&&(_=_-A|0,f[d>>2]=_,m=m-A|0,f[M>>2]=m,f[L>>2]=0,A=0),S=_-m|0,x=A-m|0,(m|0)<0?(f[d>>2]=S,f[L>>2]=x,f[M>>2]=0,A=x,x=S,m=0):x=_,_=(A|0)<(x|0)?A:x,_=(m|0)<(_|0)?m:_,(_|0)<=0?(L=0,L|0):(f[d>>2]=x-_,f[L>>2]=A-_,f[M>>2]=m-_,L=0,L|0)}function pc(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;M=d+8|0,x=f[M>>2]|0,S=(f[d>>2]|0)-x|0,L=d+4|0,x=(f[L>>2]|0)-x|0;do if(S>>>0>715827881|x>>>0>715827881){if(m=(S|0)>0,m){if((2147483647-S|0)<(S|0))return L=1,L|0}else if((-2147483648-S|0)>(S|0))return L=1,L|0;if(A=S<<1,(x|0)>0){if((2147483647-x|0)<(x|0)||(2147483647-(x<<1)|0)<(x|0))return L=1,L|0}else if((-2147483648-x|0)>(x|0)||(-2147483648-(x<<1)|0)>(x|0))return L=1,L|0;if(_=x*3|0,m){if((2147483647-A|0)<(x|0))return L=1,L|0}else if((-2147483648-A|0)>(x|0))return L=1,L|0;if((x|0)>-1){if((_|-2147483648|0)<(S|0)){m=_;break}else A=1;return A|0}else{if((_^-2147483648|0)<(S|0))A=1;else{m=_;break}return A|0}}else m=x*3|0,A=S<<1;while(0);_=l(+(A+x|0)/7)|0,f[d>>2]=_,x=l(+(m-S|0)/7)|0,f[L>>2]=x,f[M>>2]=0,m=(x|0)<(_|0),A=m?_:x,m=m?x:_;do if((m|0)<0){if((A|0)>0){if((A|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-A|0)>=(m|0)))break;tn(23313,22444,404,22469)}if((m|0)==-2147483648|(-2147483648-A|0)>(m|0)&&tn(23313,22444,404,22469),(A|0)>-1){if((A|-2147483648|0)<(m|0))break;tn(23313,22444,404,22469)}else{if((A^-2147483648|0)>=(m|0))break;tn(23313,22444,404,22469)}}while(0);return A=x-_|0,(_|0)<0?(m=0-_|0,f[L>>2]=A,f[M>>2]=m,f[d>>2]=0,_=0):(A=x,m=0),(A|0)<0&&(_=_-A|0,f[d>>2]=_,m=m-A|0,f[M>>2]=m,f[L>>2]=0,A=0),S=_-m|0,x=A-m|0,(m|0)<0?(f[d>>2]=S,f[L>>2]=x,f[M>>2]=0,A=x,x=S,m=0):x=_,_=(A|0)<(x|0)?A:x,_=(m|0)<(_|0)?m:_,(_|0)<=0?(L=0,L|0):(f[d>>2]=x-_,f[L>>2]=A-_,f[M>>2]=m-_,L=0,L|0)}function mc(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;M=d+8|0,m=f[M>>2]|0,A=(f[d>>2]|0)-m|0,L=d+4|0,m=(f[L>>2]|0)-m|0,_=l(+((A*3|0)-m|0)/7)|0,f[d>>2]=_,A=l(+((m<<1)+A|0)/7)|0,f[L>>2]=A,f[M>>2]=0,m=A-_|0,(_|0)<0?(S=0-_|0,f[L>>2]=m,f[M>>2]=S,f[d>>2]=0,A=m,_=0,m=S):m=0,(A|0)<0&&(_=_-A|0,f[d>>2]=_,m=m-A|0,f[M>>2]=m,f[L>>2]=0,A=0),S=_-m|0,x=A-m|0,(m|0)<0?(f[d>>2]=S,f[L>>2]=x,f[M>>2]=0,A=x,x=S,m=0):x=_,_=(A|0)<(x|0)?A:x,_=(m|0)<(_|0)?m:_,!((_|0)<=0)&&(f[d>>2]=x-_,f[L>>2]=A-_,f[M>>2]=m-_)}function ul(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;M=d+8|0,m=f[M>>2]|0,A=(f[d>>2]|0)-m|0,L=d+4|0,m=(f[L>>2]|0)-m|0,_=l(+((A<<1)+m|0)/7)|0,f[d>>2]=_,A=l(+((m*3|0)-A|0)/7)|0,f[L>>2]=A,f[M>>2]=0,m=A-_|0,(_|0)<0?(S=0-_|0,f[L>>2]=m,f[M>>2]=S,f[d>>2]=0,A=m,_=0,m=S):m=0,(A|0)<0&&(_=_-A|0,f[d>>2]=_,m=m-A|0,f[M>>2]=m,f[L>>2]=0,A=0),S=_-m|0,x=A-m|0,(m|0)<0?(f[d>>2]=S,f[L>>2]=x,f[M>>2]=0,A=x,x=S,m=0):x=_,_=(A|0)<(x|0)?A:x,_=(m|0)<(_|0)?m:_,!((_|0)<=0)&&(f[d>>2]=x-_,f[L>>2]=A-_,f[M>>2]=m-_)}function hl(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;A=f[d>>2]|0,M=d+4|0,m=f[M>>2]|0,L=d+8|0,_=f[L>>2]|0,x=m+(A*3|0)|0,f[d>>2]=x,m=_+(m*3|0)|0,f[M>>2]=m,A=(_*3|0)+A|0,f[L>>2]=A,_=m-x|0,(x|0)<0?(A=A-x|0,f[M>>2]=_,f[L>>2]=A,f[d>>2]=0,m=_,_=0):_=x,(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[L>>2]=A,f[M>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[M>>2]=x,f[L>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[M>>2]=x-m,f[L>>2]=A-m)}function wo(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;x=f[d>>2]|0,M=d+4|0,A=f[M>>2]|0,L=d+8|0,m=f[L>>2]|0,_=(A*3|0)+x|0,x=m+(x*3|0)|0,f[d>>2]=x,f[M>>2]=_,A=(m*3|0)+A|0,f[L>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[M>>2]=m,f[L>>2]=A,f[d>>2]=0,x=0):m=_,(m|0)<0&&(x=x-m|0,f[d>>2]=x,A=A-m|0,f[L>>2]=A,f[M>>2]=0,m=0),S=x-A|0,_=m-A|0,(A|0)<0?(f[d>>2]=S,f[M>>2]=_,f[L>>2]=0,x=S,A=0):_=m,m=(_|0)<(x|0)?_:x,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=x-m,f[M>>2]=_-m,f[L>>2]=A-m)}function $o(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0;(A+-1|0)>>>0>=6||(x=(f[15440+(A*12|0)>>2]|0)+(f[d>>2]|0)|0,f[d>>2]=x,L=d+4|0,_=(f[15440+(A*12|0)+4>>2]|0)+(f[L>>2]|0)|0,f[L>>2]=_,M=d+8|0,A=(f[15440+(A*12|0)+8>>2]|0)+(f[M>>2]|0)|0,f[M>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[L>>2]=m,f[M>>2]=A,f[d>>2]=0,_=0):(m=_,_=x),(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[M>>2]=A,f[L>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[L>>2]=x,f[M>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[L>>2]=x-m,f[M>>2]=A-m))}function Ru(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;x=f[d>>2]|0,M=d+4|0,A=f[M>>2]|0,L=d+8|0,m=f[L>>2]|0,_=A+x|0,x=m+x|0,f[d>>2]=x,f[M>>2]=_,A=m+A|0,f[L>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[M>>2]=m,f[L>>2]=A,f[d>>2]=0,_=0):(m=_,_=x),(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[L>>2]=A,f[M>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[M>>2]=x,f[L>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[M>>2]=x-m,f[L>>2]=A-m)}function g0(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;A=f[d>>2]|0,M=d+4|0,_=f[M>>2]|0,L=d+8|0,m=f[L>>2]|0,x=_+A|0,f[d>>2]=x,_=m+_|0,f[M>>2]=_,A=m+A|0,f[L>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[M>>2]=m,f[L>>2]=A,f[d>>2]=0,_=0):(m=_,_=x),(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[L>>2]=A,f[M>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[M>>2]=x,f[L>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[M>>2]=x-m,f[L>>2]=A-m)}function qo(d){switch(d=d|0,d|0){case 1:{d=5;break}case 5:{d=4;break}case 4:{d=6;break}case 6:{d=2;break}case 2:{d=3;break}case 3:{d=1;break}}return d|0}function bo(d){switch(d=d|0,d|0){case 1:{d=3;break}case 3:{d=2;break}case 2:{d=6;break}case 6:{d=4;break}case 4:{d=5;break}case 5:{d=1;break}}return d|0}function zu(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;A=f[d>>2]|0,M=d+4|0,m=f[M>>2]|0,L=d+8|0,_=f[L>>2]|0,x=m+(A<<1)|0,f[d>>2]=x,m=_+(m<<1)|0,f[M>>2]=m,A=(_<<1)+A|0,f[L>>2]=A,_=m-x|0,(x|0)<0?(A=A-x|0,f[M>>2]=_,f[L>>2]=A,f[d>>2]=0,m=_,_=0):_=x,(m|0)<0&&(_=_-m|0,f[d>>2]=_,A=A-m|0,f[L>>2]=A,f[M>>2]=0,m=0),S=_-A|0,x=m-A|0,(A|0)<0?(f[d>>2]=S,f[M>>2]=x,f[L>>2]=0,_=S,A=0):x=m,m=(x|0)<(_|0)?x:_,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[M>>2]=x-m,f[L>>2]=A-m)}function Bu(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;x=f[d>>2]|0,M=d+4|0,A=f[M>>2]|0,L=d+8|0,m=f[L>>2]|0,_=(A<<1)+x|0,x=m+(x<<1)|0,f[d>>2]=x,f[M>>2]=_,A=(m<<1)+A|0,f[L>>2]=A,m=_-x|0,(x|0)<0?(A=A-x|0,f[M>>2]=m,f[L>>2]=A,f[d>>2]=0,x=0):m=_,(m|0)<0&&(x=x-m|0,f[d>>2]=x,A=A-m|0,f[L>>2]=A,f[M>>2]=0,m=0),S=x-A|0,_=m-A|0,(A|0)<0?(f[d>>2]=S,f[M>>2]=_,f[L>>2]=0,x=S,A=0):_=m,m=(_|0)<(x|0)?_:x,m=(A|0)<(m|0)?A:m,!((m|0)<=0)&&(f[d>>2]=x-m,f[M>>2]=_-m,f[L>>2]=A-m)}function fl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0;return M=(f[d>>2]|0)-(f[A>>2]|0)|0,L=(M|0)<0,_=(f[d+4>>2]|0)-(f[A+4>>2]|0)-(L?M:0)|0,S=(_|0)<0,x=(L?0-M|0:0)+(f[d+8>>2]|0)-(f[A+8>>2]|0)+(S?0-_|0:0)|0,d=(x|0)<0,A=d?0:x,m=(S?0:_)-(d?x:0)|0,x=(L?0:M)-(S?_:0)-(d?x:0)|0,d=(m|0)<(x|0)?m:x,d=(A|0)<(d|0)?A:d,_=(d|0)>0,A=A-(_?d:0)|0,m=m-(_?d:0)|0,d=x-(_?d:0)|0,d=(d|0)>-1?d:0-d|0,m=(m|0)>-1?m:0-m|0,A=(A|0)>-1?A:0-A|0,A=(m|0)>(A|0)?m:A,((d|0)>(A|0)?d:A)|0}function _0(d,A){d=d|0,A=A|0;var m=0;m=f[d+8>>2]|0,f[A>>2]=(f[d>>2]|0)-m,f[A+4>>2]=(f[d+4>>2]|0)-m}function gc(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0;_=f[d>>2]|0,f[A>>2]=_,x=f[d+4>>2]|0,M=A+4|0,f[M>>2]=x,L=A+8|0,f[L>>2]=0,m=(x|0)<(_|0),d=m?_:x,m=m?x:_;do if((m|0)<0){if((d|0)>0){if((d|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-d|0)>=(m|0)))break;return d=1,d|0}if((m|0)==-2147483648|(-2147483648-d|0)>(m|0))return A=1,A|0;if((d|0)>-1){if((d|-2147483648|0)<(m|0))break;return d=1,d|0}else{if((d^-2147483648|0)<(m|0))d=1;else break;return d|0}}while(0);return d=x-_|0,(_|0)<0?(m=0-_|0,f[M>>2]=d,f[L>>2]=m,f[A>>2]=0,_=0):(d=x,m=0),(d|0)<0&&(_=_-d|0,f[A>>2]=_,m=m-d|0,f[L>>2]=m,f[M>>2]=0,d=0),S=_-m|0,x=d-m|0,(m|0)<0?(f[A>>2]=S,f[M>>2]=x,f[L>>2]=0,d=x,x=S,m=0):x=_,_=(d|0)<(x|0)?d:x,_=(m|0)<(_|0)?m:_,(_|0)<=0?(A=0,A|0):(f[A>>2]=x-_,f[M>>2]=d-_,f[L>>2]=m-_,A=0,A|0)}function y0(d){d=d|0;var A=0,m=0,_=0,x=0;A=d+8|0,x=f[A>>2]|0,m=x-(f[d>>2]|0)|0,f[d>>2]=m,_=d+4|0,d=(f[_>>2]|0)-x|0,f[_>>2]=d,f[A>>2]=0-(d+m)}function Pa(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;m=f[d>>2]|0,A=0-m|0,f[d>>2]=A,M=d+8|0,f[M>>2]=0,L=d+4|0,_=f[L>>2]|0,x=_+m|0,(m|0)>0?(f[L>>2]=x,f[M>>2]=m,f[d>>2]=0,A=0,_=x):m=0,(_|0)<0?(S=A-_|0,f[d>>2]=S,m=m-_|0,f[M>>2]=m,f[L>>2]=0,x=S-m|0,A=0-m|0,(m|0)<0?(f[d>>2]=x,f[L>>2]=A,f[M>>2]=0,_=A,m=0):(_=0,x=S)):x=A,A=(_|0)<(x|0)?_:x,A=(m|0)<(A|0)?m:A,!((A|0)<=0)&&(f[d>>2]=x-A,f[L>>2]=_-A,f[M>>2]=m-A)}function Ou(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0;if(Ae=de,de=de+64|0,ee=Ae,L=Ae+56|0,!(!0&(A&2013265920|0)==134217728&(!0&(_&2013265920|0)==134217728)))return x=5,de=Ae,x|0;if((d|0)==(m|0)&(A|0)==(_|0))return f[x>>2]=0,x=0,de=Ae,x|0;if(M=le(d|0,A|0,52)|0,_e()|0,M=M&15,H=le(m|0,_|0,52)|0,_e()|0,(M|0)!=(H&15|0))return x=12,de=Ae,x|0;if(S=M+-1|0,M>>>0>1){gl(d,A,S,ee)|0,gl(m,_,S,L)|0,H=ee,O=f[H>>2]|0,H=f[H+4>>2]|0;e:do if((O|0)==(f[L>>2]|0)&&(H|0)==(f[L+4>>2]|0)){M=(M^15)*3|0,S=le(d|0,A|0,M|0)|0,_e()|0,S=S&7,M=le(m|0,_|0,M|0)|0,_e()|0,M=M&7;do if((S|0)==0|(M|0)==0)f[x>>2]=1,S=0;else if((S|0)==7)S=5;else{if((S|0)==1|(M|0)==1&&ri(O,H)|0){S=5;break}if((f[15536+(S<<2)>>2]|0)!=(M|0)&&(f[15568+(S<<2)>>2]|0)!=(M|0))break e;f[x>>2]=1,S=0}while(0);return x=S,de=Ae,x|0}while(0)}S=ee,M=S+56|0;do f[S>>2]=0,S=S+4|0;while((S|0)<(M|0));return sl(d,A,1,ee)|0,A=ee,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0))&&(A=ee+8|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))&&(A=ee+16|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))&&(A=ee+24|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))&&(A=ee+32|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))&&(A=ee+40|0,!((f[A>>2]|0)==(m|0)&&(f[A+4>>2]|0)==(_|0)))?(S=ee+48|0,S=((f[S>>2]|0)==(m|0)?(f[S+4>>2]|0)==(_|0):0)&1):S=1,f[x>>2]=S,x=0,de=Ae,x|0}function Fu(d,A,m,_,x){return d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,m=Qe(d,A,m,_)|0,(m|0)==7?(x=11,x|0):(_=ye(m|0,0,56)|0,A=A&-2130706433|(_e()|0)|268435456,f[x>>2]=d|_,f[x+4>>2]=A,x=0,x|0)}function v0(d,A,m){return d=d|0,A=A|0,m=m|0,!0&(A&2013265920|0)==268435456?(f[m>>2]=d,f[m+4>>2]=A&-2130706433|134217728,m=0,m|0):(m=6,m|0)}function Zo(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;return x=de,de=de+16|0,_=x,f[_>>2]=0,!0&(A&2013265920|0)==268435456?(S=le(d|0,A|0,56)|0,_e()|0,_=Ie(d,A&-2130706433|134217728,S&7,_,m)|0,de=x,_|0):(_=6,de=x,_|0)}function Nu(d,A){d=d|0,A=A|0;var m=0;switch(m=le(d|0,A|0,56)|0,_e()|0,m&7){case 0:case 7:return m=0,m|0}return m=A&-2130706433|134217728,!(!0&(A&2013265920|0)==268435456)||!0&(A&117440512|0)==16777216&(ri(d,m)|0)!=0?(m=0,m|0):(m=Xo(d,m)|0,m|0)}function Ma(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0;return x=de,de=de+16|0,_=x,!0&(A&2013265920|0)==268435456?(S=A&-2130706433|134217728,M=m,f[M>>2]=d,f[M+4>>2]=S,f[_>>2]=0,A=le(d|0,A|0,56)|0,_e()|0,_=Ie(d,S,A&7,_,m+8|0)|0,de=x,_|0):(_=6,de=x,_|0)}function di(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;return x=(ri(d,A)|0)==0,A=A&-2130706433,_=m,f[_>>2]=x?d:0,f[_+4>>2]=x?A|285212672:0,_=m+8|0,f[_>>2]=d,f[_+4>>2]=A|301989888,_=m+16|0,f[_>>2]=d,f[_+4>>2]=A|318767104,_=m+24|0,f[_>>2]=d,f[_+4>>2]=A|335544320,_=m+32|0,f[_>>2]=d,f[_+4>>2]=A|352321536,m=m+40|0,f[m>>2]=d,f[m+4>>2]=A|369098752,0}function Al(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0;return M=de,de=de+16|0,x=M,S=A&-2130706433|134217728,!0&(A&2013265920|0)==268435456?(_=le(d|0,A|0,56)|0,_e()|0,_=Wt(d,S,_&7)|0,(_|0)==-1?(f[m>>2]=0,S=6,de=M,S|0):(ds(d,S,x)|0&&tn(23313,22484,282,22499),A=le(d|0,A|0,52)|0,_e()|0,A=A&15,ri(d,S)|0?Eo(x,A,_,2,m):_c(x,A,_,2,m),S=0,de=M,S|0)):(S=6,de=M,S|0)}function Rn(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;_=de,de=de+16|0,x=_,Qn(d,A,m,x),Du(x,m+4|0),de=_}function Qn(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0;if(L=de,de=de+16|0,O=L,fi(d,m,O),S=+Ct(+(1-+W[O>>3]*.5)),S<1e-16){f[_>>2]=0,f[_+4>>2]=0,f[_+8>>2]=0,f[_+12>>2]=0,de=L;return}if(O=f[m>>2]|0,x=+W[15920+(O*24|0)>>3],x=+Ji(x-+Ji(+qu(15600+(O<<4)|0,d))),br(A)|0?M=+Ji(x+-.3334731722518321):M=x,x=+Lt(+S)/.381966011250105,(A|0)>0){d=0;do x=x*2.6457513110645907,d=d+1|0;while((d|0)!=(A|0))}S=+Ve(+M)*x,W[_>>3]=S,M=+ft(+M)*x,W[_+8>>3]=M,de=L}function fi(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if(S=de,de=de+32|0,x=S,Cl(d,x),f[A>>2]=0,W[m>>3]=5,_=+si(16400,x),_<+W[m>>3]&&(f[A>>2]=0,W[m>>3]=_),_=+si(16424,x),_<+W[m>>3]&&(f[A>>2]=1,W[m>>3]=_),_=+si(16448,x),_<+W[m>>3]&&(f[A>>2]=2,W[m>>3]=_),_=+si(16472,x),_<+W[m>>3]&&(f[A>>2]=3,W[m>>3]=_),_=+si(16496,x),_<+W[m>>3]&&(f[A>>2]=4,W[m>>3]=_),_=+si(16520,x),_<+W[m>>3]&&(f[A>>2]=5,W[m>>3]=_),_=+si(16544,x),_<+W[m>>3]&&(f[A>>2]=6,W[m>>3]=_),_=+si(16568,x),_<+W[m>>3]&&(f[A>>2]=7,W[m>>3]=_),_=+si(16592,x),_<+W[m>>3]&&(f[A>>2]=8,W[m>>3]=_),_=+si(16616,x),_<+W[m>>3]&&(f[A>>2]=9,W[m>>3]=_),_=+si(16640,x),_<+W[m>>3]&&(f[A>>2]=10,W[m>>3]=_),_=+si(16664,x),_<+W[m>>3]&&(f[A>>2]=11,W[m>>3]=_),_=+si(16688,x),_<+W[m>>3]&&(f[A>>2]=12,W[m>>3]=_),_=+si(16712,x),_<+W[m>>3]&&(f[A>>2]=13,W[m>>3]=_),_=+si(16736,x),_<+W[m>>3]&&(f[A>>2]=14,W[m>>3]=_),_=+si(16760,x),_<+W[m>>3]&&(f[A>>2]=15,W[m>>3]=_),_=+si(16784,x),_<+W[m>>3]&&(f[A>>2]=16,W[m>>3]=_),_=+si(16808,x),_<+W[m>>3]&&(f[A>>2]=17,W[m>>3]=_),_=+si(16832,x),_<+W[m>>3]&&(f[A>>2]=18,W[m>>3]=_),_=+si(16856,x),!(_<+W[m>>3])){de=S;return}f[A>>2]=19,W[m>>3]=_,de=S}function ii(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0;if(S=+eh(d),S<1e-16){A=15600+(A<<4)|0,f[x>>2]=f[A>>2],f[x+4>>2]=f[A+4>>2],f[x+8>>2]=f[A+8>>2],f[x+12>>2]=f[A+12>>2];return}if(M=+on(+ +W[d+8>>3],+ +W[d>>3]),(m|0)>0){d=0;do S=S/2.6457513110645907,d=d+1|0;while((d|0)!=(m|0))}_?(S=S/3,m=(br(m)|0)==0,S=+Gt(+((m?S:S/2.6457513110645907)*.381966011250105))):(S=+Gt(+(S*.381966011250105)),br(m)|0&&(M=+Ji(M+.3334731722518321))),Qs(15600+(A<<4)|0,+Ji(+W[15920+(A*24|0)>>3]-M),S,x)}function dl(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;_=de,de=de+16|0,x=_,Zs(d+4|0,x),ii(x,f[d>>2]|0,A,0,m),de=_}function Eo(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0,Et=0,st=0,dt=0,gn=0,hn=0,sn=0,an=0,fn=0,vn=0,Zn=0,_n=0;if(vn=de,de=de+272|0,S=vn+256|0,We=vn+240|0,sn=vn,an=vn+224|0,fn=vn+208|0,$e=vn+176|0,Oe=vn+160|0,It=vn+192|0,Et=vn+144|0,st=vn+128|0,dt=vn+112|0,gn=vn+96|0,hn=vn+80|0,f[S>>2]=A,f[We>>2]=f[d>>2],f[We+4>>2]=f[d+4>>2],f[We+8>>2]=f[d+8>>2],f[We+12>>2]=f[d+12>>2],Uu(We,S,sn),f[x>>2]=0,We=_+m+((_|0)==5&1)|0,(We|0)<=(m|0)){de=vn;return}O=f[S>>2]|0,H=an+4|0,ee=$e+4|0,Ae=m+5|0,we=16880+(O<<2)|0,Re=16960+(O<<2)|0,Te=st+8|0,Be=dt+8|0,tt=gn+8|0,Ke=fn+4|0,L=m;e:for(;;){M=sn+(((L|0)%5|0)<<4)|0,f[fn>>2]=f[M>>2],f[fn+4>>2]=f[M+4>>2],f[fn+8>>2]=f[M+8>>2],f[fn+12>>2]=f[M+12>>2];do;while((Ia(fn,O,0,1)|0)==2);if((L|0)>(m|0)&(br(A)|0)!=0){if(f[$e>>2]=f[fn>>2],f[$e+4>>2]=f[fn+4>>2],f[$e+8>>2]=f[fn+8>>2],f[$e+12>>2]=f[fn+12>>2],Zs(H,Oe),_=f[$e>>2]|0,S=f[17040+(_*80|0)+(f[an>>2]<<2)>>2]|0,f[$e>>2]=f[18640+(_*80|0)+(S*20|0)>>2],M=f[18640+(_*80|0)+(S*20|0)+16>>2]|0,(M|0)>0){d=0;do Ru(ee),d=d+1|0;while((d|0)<(M|0))}switch(M=18640+(_*80|0)+(S*20|0)+4|0,f[It>>2]=f[M>>2],f[It+4>>2]=f[M+4>>2],f[It+8>>2]=f[M+8>>2],p0(It,(f[we>>2]|0)*3|0),qi(ee,It,ee),ui(ee),Zs(ee,Et),Zn=+(f[Re>>2]|0),W[st>>3]=Zn*3,W[Te>>3]=0,_n=Zn*-1.5,W[dt>>3]=_n,W[Be>>3]=Zn*2.598076211353316,W[gn>>3]=_n,W[tt>>3]=Zn*-2.598076211353316,f[17040+((f[$e>>2]|0)*80|0)+(f[fn>>2]<<2)>>2]|0){case 1:{d=dt,_=st;break}case 3:{d=gn,_=dt;break}case 2:{d=st,_=gn;break}default:{d=12;break e}}Ic(Oe,Et,_,d,hn),ii(hn,f[$e>>2]|0,O,1,x+8+(f[x>>2]<<4)|0),f[x>>2]=(f[x>>2]|0)+1}if((L|0)<(Ae|0)&&(Zs(Ke,$e),ii($e,f[fn>>2]|0,O,1,x+8+(f[x>>2]<<4)|0),f[x>>2]=(f[x>>2]|0)+1),f[an>>2]=f[fn>>2],f[an+4>>2]=f[fn+4>>2],f[an+8>>2]=f[fn+8>>2],f[an+12>>2]=f[fn+12>>2],L=L+1|0,(L|0)>=(We|0)){d=3;break}}if((d|0)==3){de=vn;return}else(d|0)==12&&tn(22522,22569,571,22579)}function Uu(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0;O=de,de=de+128|0,_=O+64|0,x=O,S=_,M=20240,L=S+60|0;do f[S>>2]=f[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(L|0));S=x,M=20304,L=S+60|0;do f[S>>2]=f[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(L|0));L=(br(f[A>>2]|0)|0)==0,_=L?_:x,x=d+4|0,zu(x),Bu(x),br(f[A>>2]|0)|0&&(wo(x),f[A>>2]=(f[A>>2]|0)+1),f[m>>2]=f[d>>2],A=m+4|0,qi(x,_,A),ui(A),f[m+16>>2]=f[d>>2],A=m+20|0,qi(x,_+12|0,A),ui(A),f[m+32>>2]=f[d>>2],A=m+36|0,qi(x,_+24|0,A),ui(A),f[m+48>>2]=f[d>>2],A=m+52|0,qi(x,_+36|0,A),ui(A),f[m+64>>2]=f[d>>2],m=m+68|0,qi(x,_+48|0,m),ui(m),de=O}function Ia(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0;if(Te=de,de=de+32|0,we=Te+12|0,L=Te,Re=d+4|0,Ae=f[16960+(A<<2)>>2]|0,ee=(_|0)!=0,Ae=ee?Ae*3|0:Ae,x=f[Re>>2]|0,H=d+8|0,M=f[H>>2]|0,ee){if(S=d+12|0,_=f[S>>2]|0,x=M+x+_|0,(x|0)==(Ae|0))return Re=1,de=Te,Re|0;O=S}else O=d+12|0,_=f[O>>2]|0,x=M+x+_|0;if((x|0)<=(Ae|0))return Re=0,de=Te,Re|0;do if((_|0)>0){if(_=f[d>>2]|0,(M|0)>0){S=18640+(_*80|0)+60|0,_=d;break}_=18640+(_*80|0)+40|0,m?(cl(we,Ae,0,0),Sa(Re,we,L),g0(L),qi(L,we,Re),S=_,_=d):(S=_,_=d)}else S=18640+((f[d>>2]|0)*80|0)+20|0,_=d;while(0);if(f[_>>2]=f[S>>2],x=S+16|0,(f[x>>2]|0)>0){_=0;do Ru(Re),_=_+1|0;while((_|0)<(f[x>>2]|0))}return d=S+4|0,f[we>>2]=f[d>>2],f[we+4>>2]=f[d+4>>2],f[we+8>>2]=f[d+8>>2],A=f[16880+(A<<2)>>2]|0,p0(we,ee?A*3|0:A),qi(Re,we,Re),ui(Re),ee?_=((f[H>>2]|0)+(f[Re>>2]|0)+(f[O>>2]|0)|0)==(Ae|0)?1:2:_=2,Re=_,de=Te,Re|0}function Vu(d,A){d=d|0,A=A|0;var m=0;do m=Ia(d,A,0,1)|0;while((m|0)==2);return m|0}function _c(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0,Et=0,st=0,dt=0,gn=0,hn=0,sn=0;if(gn=de,de=de+240|0,S=gn+224|0,It=gn+208|0,Et=gn,st=gn+192|0,dt=gn+176|0,tt=gn+160|0,Ke=gn+144|0,We=gn+128|0,$e=gn+112|0,Oe=gn+96|0,f[S>>2]=A,f[It>>2]=f[d>>2],f[It+4>>2]=f[d+4>>2],f[It+8>>2]=f[d+8>>2],f[It+12>>2]=f[d+12>>2],pl(It,S,Et),f[x>>2]=0,Be=_+m+((_|0)==6&1)|0,(Be|0)<=(m|0)){de=gn;return}O=f[S>>2]|0,H=m+6|0,ee=16960+(O<<2)|0,Ae=Ke+8|0,we=We+8|0,Re=$e+8|0,Te=st+4|0,M=0,L=m,_=-1;e:for(;;){if(S=(L|0)%6|0,d=Et+(S<<4)|0,f[st>>2]=f[d>>2],f[st+4>>2]=f[d+4>>2],f[st+8>>2]=f[d+8>>2],f[st+12>>2]=f[d+12>>2],d=M,M=Ia(st,O,0,1)|0,(L|0)>(m|0)&(br(A)|0)!=0&&(d|0)!=1&&(f[st>>2]|0)!=(_|0)){switch(Zs(Et+(((S+5|0)%6|0)<<4)+4|0,dt),Zs(Et+(S<<4)+4|0,tt),hn=+(f[ee>>2]|0),W[Ke>>3]=hn*3,W[Ae>>3]=0,sn=hn*-1.5,W[We>>3]=sn,W[we>>3]=hn*2.598076211353316,W[$e>>3]=sn,W[Re>>3]=hn*-2.598076211353316,S=f[It>>2]|0,f[17040+(S*80|0)+(((_|0)==(S|0)?f[st>>2]|0:_)<<2)>>2]|0){case 1:{d=We,_=Ke;break}case 3:{d=$e,_=We;break}case 2:{d=Ke,_=$e;break}default:{d=8;break e}}Ic(dt,tt,_,d,Oe),!(th(dt,Oe)|0)&&!(th(tt,Oe)|0)&&(ii(Oe,f[It>>2]|0,O,1,x+8+(f[x>>2]<<4)|0),f[x>>2]=(f[x>>2]|0)+1)}if((L|0)<(H|0)&&(Zs(Te,dt),ii(dt,f[st>>2]|0,O,1,x+8+(f[x>>2]<<4)|0),f[x>>2]=(f[x>>2]|0)+1),L=L+1|0,(L|0)>=(Be|0)){d=3;break}else _=f[st>>2]|0}if((d|0)==3){de=gn;return}else(d|0)==8&&tn(22606,22569,736,22651)}function pl(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0;O=de,de=de+160|0,_=O+80|0,x=O,S=_,M=20368,L=S+72|0;do f[S>>2]=f[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(L|0));S=x,M=20448,L=S+72|0;do f[S>>2]=f[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(L|0));L=(br(f[A>>2]|0)|0)==0,_=L?_:x,x=d+4|0,zu(x),Bu(x),br(f[A>>2]|0)|0&&(wo(x),f[A>>2]=(f[A>>2]|0)+1),f[m>>2]=f[d>>2],A=m+4|0,qi(x,_,A),ui(A),f[m+16>>2]=f[d>>2],A=m+20|0,qi(x,_+12|0,A),ui(A),f[m+32>>2]=f[d>>2],A=m+36|0,qi(x,_+24|0,A),ui(A),f[m+48>>2]=f[d>>2],A=m+52|0,qi(x,_+36|0,A),ui(A),f[m+64>>2]=f[d>>2],A=m+68|0,qi(x,_+48|0,A),ui(A),f[m+80>>2]=f[d>>2],m=m+84|0,qi(x,_+60|0,m),ui(m),de=O}function ml(d,A){return d=d|0,A=A|0,A=le(d|0,A|0,52)|0,_e()|0,A&15|0}function ka(d,A){return d=d|0,A=A|0,A=le(d|0,A|0,45)|0,_e()|0,A&127|0}function Xo(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0;if(!(!0&(A&-16777216|0)==134217728)||(M=le(d|0,A|0,45)|0,_e()|0,M=M&127,M>>>0>121))return A=0,A|0;m=le(d|0,A|0,52)|0,_e()|0,m=m&15;do if(m|0){for(x=1,_=0;;){if(S=le(d|0,A|0,(15-x|0)*3|0)|0,_e()|0,S=S&7,(S|0)!=0&(_^1))if((S|0)==1&(On(M)|0)!=0){L=0,_=13;break}else _=1;if((S|0)==7){L=0,_=13;break}if(x>>>0<m>>>0)x=x+1|0;else{_=9;break}}if((_|0)==9){if((m|0)==15)L=1;else break;return L|0}else if((_|0)==13)return L|0}while(0);for(;;){if(L=le(d|0,A|0,(14-m|0)*3|0)|0,_e()|0,!((L&7|0)==7&!0)){L=0,_=13;break}if(m>>>0<14)m=m+1|0;else{L=1,_=13;break}}return(_|0)==13?L|0:0}function gl(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0;if(S=le(d|0,A|0,52)|0,_e()|0,S=S&15,m>>>0>15)return _=4,_|0;if((S|0)<(m|0))return _=12,_|0;if((S|0)==(m|0))return f[_>>2]=d,f[_+4>>2]=A,_=0,_|0;if(x=ye(m|0,0,52)|0,x=x|d,d=_e()|0|A&-15728641,(S|0)>(m|0))do A=ye(7,0,(14-m|0)*3|0)|0,m=m+1|0,x=A|x,d=_e()|0|d;while((m|0)<(S|0));return f[_>>2]=x,f[_+4>>2]=d,_=0,_|0}function _l(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0;if(S=le(d|0,A|0,52)|0,_e()|0,S=S&15,!((m|0)<16&(S|0)<=(m|0)))return _=4,_|0;x=m-S|0,m=le(d|0,A|0,45)|0,_e()|0;e:do if(!(On(m&127)|0))m=zs(7,0,x,((x|0)<0)<<31>>31)|0,x=_e()|0;else{t:do if(S|0){for(m=1;M=ye(7,0,(15-m|0)*3|0)|0,!!((M&d|0)==0&((_e()|0)&A|0)==0);)if(m>>>0<S>>>0)m=m+1|0;else break t;m=zs(7,0,x,((x|0)<0)<<31>>31)|0,x=_e()|0;break e}while(0);m=zs(7,0,x,((x|0)<0)<<31>>31)|0,m=se(m|0,_e()|0,5,0)|0,m=P(m|0,_e()|0,-5,-1)|0,m=$(m|0,_e()|0,6,0)|0,m=P(m|0,_e()|0,1,0)|0,x=_e()|0}while(0);return M=_,f[M>>2]=m,f[M+4>>2]=x,M=0,M|0}function ri(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;if(x=le(d|0,A|0,45)|0,_e()|0,!(On(x&127)|0))return x=0,x|0;x=le(d|0,A|0,52)|0,_e()|0,x=x&15;e:do if(!x)m=0;else for(_=1;;){if(m=le(d|0,A|0,(15-_|0)*3|0)|0,_e()|0,m=m&7,m|0)break e;if(_>>>0<x>>>0)_=_+1|0;else{m=0;break}}while(0);return x=(m|0)==0&1,x|0}function x0(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0;if(M=de,de=de+16|0,S=M,Ra(S,d,A,m),A=S,d=f[A>>2]|0,A=f[A+4>>2]|0,(d|0)==0&(A|0)==0)return de=M,0;x=0,m=0;do L=_+(x<<3)|0,f[L>>2]=d,f[L+4>>2]=A,x=P(x|0,m|0,1,0)|0,m=_e()|0,za(S),L=S,d=f[L>>2]|0,A=f[L+4>>2]|0;while(!((d|0)==0&(A|0)==0));return de=M,0}function As(d,A,m,_){return d=d|0,A=A|0,m=m|0,_=_|0,(_|0)<(m|0)?(m=A,_=d,Vt(m|0),_|0):(m=ye(-1,-1,((_-m|0)*3|0)+3|0)|0,_=ye(~m|0,~(_e()|0)|0,(15-_|0)*3|0)|0,m=~(_e()|0)&A,_=~_&d,Vt(m|0),_|0)}function Gu(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0;return x=le(d|0,A|0,52)|0,_e()|0,x=x&15,(m|0)<16&(x|0)<=(m|0)?((x|0)<(m|0)&&(x=ye(-1,-1,((m+-1-x|0)*3|0)+3|0)|0,x=ye(~x|0,~(_e()|0)|0,(15-m|0)*3|0)|0,A=~(_e()|0)&A,d=~x&d),x=ye(m|0,0,52)|0,m=A&-15728641|(_e()|0),f[_>>2]=d|x,f[_+4>>2]=m,_=0,_|0):(_=4,_|0)}function yc(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0,Et=0,st=0,dt=0;if((m|0)==0&(_|0)==0)return st=0,st|0;if(x=d,S=f[x>>2]|0,x=f[x+4>>2]|0,!0&(x&15728640|0)==0){if(!((_|0)>0|(_|0)==0&m>>>0>0)||(st=A,f[st>>2]=S,f[st+4>>2]=x,(m|0)==1&(_|0)==0))return st=0,st|0;x=1;do It=d+(x<<3)|0,Et=f[It+4>>2]|0,st=A+(x<<3)|0,f[st>>2]=f[It>>2],f[st+4>>2]=Et,x=x+1|0;while(0<(_|0)|(_|0)==0&x>>>0<m>>>0);return x=0,x|0}if(Oe=m<<3,Et=p(Oe)|0,!Et)return st=13,st|0;if(Xe(Et|0,d|0,Oe|0)|0,It=E(m,8)|0,!It)return v(Et),st=13,st|0;e:do if(m|0){t:for(;;){x=Et,Ke=f[x>>2]|0,x=f[x+4>>2]|0,We=le(Ke|0,x|0,52)|0,_e()|0,We=We&15,$e=We+-1|0,tt=(m|0)>0;n:do if((We|0)!=0&tt){if(Re=((m|0)<0)<<31>>31,Te=ye($e|0,0,52)|0,Be=_e()|0,$e>>>0>15){if(!((Ke|0)==0&(x|0)==0)){st=17;break t}for(S=0;;){if(S=S+1|0,(S|0)>=(m|0))break n;if(_=Et+(S<<3)|0,Be=f[_>>2]|0,_=f[_+4>>2]|0,!((Be|0)==0&(_|0)==0)){x=_,st=17;break t}}}for(S=0,d=Ke,_=x;;){if(!((d|0)==0&(_|0)==0)){if(!(!0&(_&117440512|0)==0)){st=22;break t}if(L=le(d|0,_|0,52)|0,_e()|0,L=L&15,(L|0)<($e|0)){x=12,st=28;break t}if((L|0)!=($e|0)&&(d=d|Te,_=_&-15728641|Be,L>>>0>=We>>>0)){M=$e;do we=ye(7,0,(14-M|0)*3|0)|0,M=M+1|0,d=we|d,_=_e()|0|_;while(M>>>0<L>>>0)}if(M=xe(d|0,_|0,m|0,Re|0)|0,_e()|0,H=It+(M<<3)|0,L=H,O=f[L>>2]|0,L=f[L+4>>2]|0,(O|0)==0&(L|0)==0)M=H;else for(we=0;;){if((we|0)>(m|0)){st=32;break t}if((O|0)==(d|0)&(L&-117440513|0)==(_|0)){ee=le(O|0,L|0,56)|0,_e()|0,ee=ee&7,Ae=ee+1|0,dt=le(O|0,L|0,45)|0,_e()|0;i:do if(!(On(dt&127)|0))L=7;else{if(O=le(O|0,L|0,52)|0,_e()|0,O=O&15,!O){L=6;break}for(L=1;;){if(dt=ye(7,0,(15-L|0)*3|0)|0,!((dt&d|0)==0&((_e()|0)&_|0)==0)){L=7;break i}if(L>>>0<O>>>0)L=L+1|0;else{L=6;break}}}while(0);if((ee+2|0)>>>0>L>>>0){st=42;break t}dt=ye(Ae|0,0,56)|0,_=_e()|0|_&-117440513,Ae=H,f[Ae>>2]=0,f[Ae+4>>2]=0,d=dt|d}else M=(M+1|0)%(m|0)|0;if(H=It+(M<<3)|0,L=H,O=f[L>>2]|0,L=f[L+4>>2]|0,(O|0)==0&(L|0)==0){M=H;break}else we=we+1|0}dt=M,f[dt>>2]=d,f[dt+4>>2]=_}if(S=S+1|0,(S|0)>=(m|0))break n;_=Et+(S<<3)|0,d=f[_>>2]|0,_=f[_+4>>2]|0}}while(0);if((m+5|0)>>>0<11){st=85;break}if(Be=E((m|0)/6|0,8)|0,!Be){st=49;break}n:do if(tt){we=0,Ae=0;do{if(L=It+(we<<3)|0,_=L,S=f[_>>2]|0,_=f[_+4>>2]|0,!((S|0)==0&(_|0)==0)){O=le(S|0,_|0,56)|0,_e()|0,O=O&7,d=O+1|0,H=_&-117440513,dt=le(S|0,_|0,45)|0,_e()|0;i:do if(On(dt&127)|0){if(ee=le(S|0,_|0,52)|0,_e()|0,ee=ee&15,ee|0)for(M=1;;){if(dt=ye(7,0,(15-M|0)*3|0)|0,!((S&dt|0)==0&(H&(_e()|0)|0)==0))break i;if(M>>>0<ee>>>0)M=M+1|0;else break}_=ye(d|0,0,56)|0,S=_|S,_=_e()|0|H,d=L,f[d>>2]=S,f[d+4>>2]=_,d=O+2|0}while(0);(d|0)==7&&(dt=Be+(Ae<<3)|0,f[dt>>2]=S,f[dt+4>>2]=_&-117440513,Ae=Ae+1|0)}we=we+1|0}while((we|0)!=(m|0));if(tt){if(we=((m|0)<0)<<31>>31,Re=ye($e|0,0,52)|0,Te=_e()|0,$e>>>0>15){if(!((Ke|0)==0&(x|0)==0)){x=4,st=84;break t}for(x=0;;){if(x=x+1|0,(x|0)>=(m|0)){S=0,x=Ae;break n}if(dt=Et+(x<<3)|0,!((f[dt>>2]|0)==0&(f[dt+4>>2]|0)==0)){x=4,st=84;break t}}}for(ee=0,S=0,H=Ke;;){do if(!((H|0)==0&(x|0)==0)){if(L=le(H|0,x|0,52)|0,_e()|0,L=L&15,(L|0)<($e|0)){x=12,st=84;break t}do if((L|0)==($e|0))_=H,L=x;else{if(_=H|Re,d=x&-15728641|Te,L>>>0<We>>>0){L=d;break}M=$e;do dt=ye(7,0,(14-M|0)*3|0)|0,M=M+1|0,_=dt|_,d=_e()|0|d;while(M>>>0<L>>>0);L=d}while(0);for(M=xe(_|0,L|0,m|0,we|0)|0,_e()|0,d=0;;){if((d|0)>(m|0)){st=77;break t}if(dt=It+(M<<3)|0,O=f[dt+4>>2]|0,(O&-117440513|0)==(L|0)&&(f[dt>>2]|0)==(_|0)){st=79;break}if(M=(M+1|0)%(m|0)|0,dt=It+(M<<3)|0,(f[dt>>2]|0)==(_|0)&&(f[dt+4>>2]|0)==(L|0))break;d=d+1|0}if((st|0)==79&&(st=0,!0&(O&117440512|0)==100663296))break;dt=A+(S<<3)|0,f[dt>>2]=H,f[dt+4>>2]=x,S=S+1|0}while(0);if(x=ee+1|0,(x|0)>=(m|0)){x=Ae;break n}dt=Et+(x<<3)|0,ee=x,H=f[dt>>2]|0,x=f[dt+4>>2]|0}}else S=0,x=Ae}else S=0,x=0;while(0);if(He(It|0,0,Oe|0)|0,Xe(Et|0,Be|0,x<<3|0)|0,v(Be),x)A=A+(S<<3)|0,m=x;else break e}if((st|0)==17)!0&(x&117440512|0)==0?(x=4,st=28):st=22;else if((st|0)==32)tn(23313,22674,362,22684);else{if((st|0)==42)return v(Et),v(It),dt=10,dt|0;if((st|0)==49)return v(Et),v(It),dt=13,dt|0;if((st|0)==77)tn(23313,22674,462,22684);else{if((st|0)==84)return v(Be),v(Et),v(It),dt=x,dt|0;if((st|0)==85){Xe(A|0,Et|0,m<<3|0)|0;break}}}if((st|0)==22)return v(Et),v(It),dt=5,dt|0;if((st|0)==28)return v(Et),v(It),dt=x,dt|0}while(0);return v(Et),v(It),dt=0,dt|0}function ju(d,A,m,_,x,S,M){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0,M=M|0;var L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0;if(Be=de,de=de+16|0,Te=Be,!((m|0)>0|(m|0)==0&A>>>0>0))return Te=0,de=Be,Te|0;if((M|0)>=16)return Te=12,de=Be,Te|0;we=0,Re=0,Ae=0,L=0;e:for(;;){if(H=d+(we<<3)|0,O=f[H>>2]|0,H=f[H+4>>2]|0,ee=le(O|0,H|0,52)|0,_e()|0,(ee&15|0)>(M|0)){L=12,O=11;break}if(Ra(Te,O,H,M),ee=Te,H=f[ee>>2]|0,ee=f[ee+4>>2]|0,(H|0)==0&(ee|0)==0)O=Ae;else{O=Ae;do{if(!((L|0)<(S|0)|(L|0)==(S|0)&O>>>0<x>>>0)){O=10;break e}Ae=_+(O<<3)|0,f[Ae>>2]=H,f[Ae+4>>2]=ee,O=P(O|0,L|0,1,0)|0,L=_e()|0,za(Te),Ae=Te,H=f[Ae>>2]|0,ee=f[Ae+4>>2]|0}while(!((H|0)==0&(ee|0)==0))}if(we=P(we|0,Re|0,1,0)|0,Re=_e()|0,(Re|0)<(m|0)|(Re|0)==(m|0)&we>>>0<A>>>0)Ae=O;else{L=0,O=11;break}}return(O|0)==10?(Te=14,de=Be,Te|0):(O|0)==11?(de=Be,L|0):0}function Qo(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0;we=de,de=de+16|0,Ae=we;e:do if((m|0)>0|(m|0)==0&A>>>0>0){for(H=0,M=0,S=0,ee=0;;){if(O=d+(H<<3)|0,L=f[O>>2]|0,O=f[O+4>>2]|0,!((L|0)==0&(O|0)==0)&&(O=(_l(L,O,_,Ae)|0)==0,L=Ae,M=P(f[L>>2]|0,f[L+4>>2]|0,M|0,S|0)|0,S=_e()|0,!O)){S=12;break}if(H=P(H|0,ee|0,1,0)|0,ee=_e()|0,!((ee|0)<(m|0)|(ee|0)==(m|0)&H>>>0<A>>>0))break e}return de=we,S|0}else M=0,S=0;while(0);return f[x>>2]=M,f[x+4>>2]=S,x=0,de=we,x|0}function yl(d,A){return d=d|0,A=A|0,A=le(d|0,A|0,52)|0,_e()|0,A&1|0}function Ni(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;if(x=le(d|0,A|0,52)|0,_e()|0,x=x&15,!x)return x=0,x|0;for(_=1;;){if(m=le(d|0,A|0,(15-_|0)*3|0)|0,_e()|0,m=m&7,m|0){_=5;break}if(_>>>0<x>>>0)_=_+1|0;else{m=0,_=5;break}}return(_|0)==5?m|0:0}function vc(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0,O=0;if(O=le(d|0,A|0,52)|0,_e()|0,O=O&15,!O)return L=A,O=d,Vt(L|0),O|0;for(L=1,m=0;;){S=(15-L|0)*3|0,_=ye(7,0,S|0)|0,x=_e()|0,M=le(d|0,A|0,S|0)|0,_e()|0,S=ye(qo(M&7)|0,0,S|0)|0,M=_e()|0,d=S|d&~_,A=M|A&~x;e:do if(!m)if((S&_|0)==0&(M&x|0)==0)m=0;else if(_=le(d|0,A|0,52)|0,_e()|0,_=_&15,!_)m=1;else{m=1;t:for(;;){switch(M=le(d|0,A|0,(15-m|0)*3|0)|0,_e()|0,M&7){case 1:break t;case 0:break;default:{m=1;break e}}if(m>>>0<_>>>0)m=m+1|0;else{m=1;break e}}for(m=1;;)if(M=(15-m|0)*3|0,x=le(d|0,A|0,M|0)|0,_e()|0,S=ye(7,0,M|0)|0,A=A&~(_e()|0),M=ye(qo(x&7)|0,0,M|0)|0,d=d&~S|M,A=A|(_e()|0),m>>>0<_>>>0)m=m+1|0;else{m=1;break}}while(0);if(L>>>0<O>>>0)L=L+1|0;else break}return Vt(A|0),d|0}function Ls(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0;if(_=le(d|0,A|0,52)|0,_e()|0,_=_&15,!_)return m=A,_=d,Vt(m|0),_|0;for(m=1;S=(15-m|0)*3|0,M=le(d|0,A|0,S|0)|0,_e()|0,x=ye(7,0,S|0)|0,A=A&~(_e()|0),S=ye(qo(M&7)|0,0,S|0)|0,d=S|d&~x,A=_e()|0|A,m>>>0<_>>>0;)m=m+1|0;return Vt(A|0),d|0}function Hu(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0,O=0;if(O=le(d|0,A|0,52)|0,_e()|0,O=O&15,!O)return L=A,O=d,Vt(L|0),O|0;for(L=1,m=0;;){S=(15-L|0)*3|0,_=ye(7,0,S|0)|0,x=_e()|0,M=le(d|0,A|0,S|0)|0,_e()|0,S=ye(bo(M&7)|0,0,S|0)|0,M=_e()|0,d=S|d&~_,A=M|A&~x;e:do if(!m)if((S&_|0)==0&(M&x|0)==0)m=0;else if(_=le(d|0,A|0,52)|0,_e()|0,_=_&15,!_)m=1;else{m=1;t:for(;;){switch(M=le(d|0,A|0,(15-m|0)*3|0)|0,_e()|0,M&7){case 1:break t;case 0:break;default:{m=1;break e}}if(m>>>0<_>>>0)m=m+1|0;else{m=1;break e}}for(m=1;;)if(x=(15-m|0)*3|0,S=ye(7,0,x|0)|0,M=A&~(_e()|0),A=le(d|0,A|0,x|0)|0,_e()|0,A=ye(bo(A&7)|0,0,x|0)|0,d=d&~S|A,A=M|(_e()|0),m>>>0<_>>>0)m=m+1|0;else{m=1;break}}while(0);if(L>>>0<O>>>0)L=L+1|0;else break}return Vt(A|0),d|0}function w0(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0;if(_=le(d|0,A|0,52)|0,_e()|0,_=_&15,!_)return m=A,_=d,Vt(m|0),_|0;for(m=1;M=(15-m|0)*3|0,S=ye(7,0,M|0)|0,x=A&~(_e()|0),A=le(d|0,A|0,M|0)|0,_e()|0,A=ye(bo(A&7)|0,0,M|0)|0,d=A|d&~S,A=_e()|0|x,m>>>0<_>>>0;)m=m+1|0;return Vt(A|0),d|0}function vl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0;if(O=de,de=de+64|0,L=O+40|0,_=O+24|0,x=O+12|0,S=O,ye(A|0,0,52)|0,m=_e()|0|134225919,!A)return(f[d+4>>2]|0)>2||(f[d+8>>2]|0)>2||(f[d+12>>2]|0)>2?(M=0,L=0,Vt(M|0),de=O,L|0):(ye(A0(d)|0,0,45)|0,M=_e()|0|m,L=-1,Vt(M|0),de=O,L|0);if(f[L>>2]=f[d>>2],f[L+4>>2]=f[d+4>>2],f[L+8>>2]=f[d+8>>2],f[L+12>>2]=f[d+12>>2],M=L+4|0,(A|0)>0)for(d=-1;f[_>>2]=f[M>>2],f[_+4>>2]=f[M+4>>2],f[_+8>>2]=f[M+8>>2],A&1?(mc(M),f[x>>2]=f[M>>2],f[x+4>>2]=f[M+4>>2],f[x+8>>2]=f[M+8>>2],hl(x)):(ul(M),f[x>>2]=f[M>>2],f[x+4>>2]=f[M+4>>2],f[x+8>>2]=f[M+8>>2],wo(x)),Sa(_,x,S),ui(S),ee=(15-A|0)*3|0,H=ye(7,0,ee|0)|0,m=m&~(_e()|0),ee=ye(Ca(S)|0,0,ee|0)|0,d=ee|d&~H,m=_e()|0|m,(A|0)>1;)A=A+-1|0;else d=-1;e:do if((f[M>>2]|0)<=2&&(f[L+8>>2]|0)<=2&&(f[L+12>>2]|0)<=2){if(_=A0(L)|0,A=ye(_|0,0,45)|0,A=A|d,d=_e()|0|m&-1040385,S=d0(L)|0,!(On(_)|0)){if((S|0)<=0)break;for(x=0;;){if(_=le(A|0,d|0,52)|0,_e()|0,_=_&15,_)for(m=1;ee=(15-m|0)*3|0,L=le(A|0,d|0,ee|0)|0,_e()|0,H=ye(7,0,ee|0)|0,d=d&~(_e()|0),ee=ye(qo(L&7)|0,0,ee|0)|0,A=A&~H|ee,d=d|(_e()|0),m>>>0<_>>>0;)m=m+1|0;if(x=x+1|0,(x|0)==(S|0))break e}}x=le(A|0,d|0,52)|0,_e()|0,x=x&15;t:do if(x){m=1;n:for(;;){switch(ee=le(A|0,d|0,(15-m|0)*3|0)|0,_e()|0,ee&7){case 1:break n;case 0:break;default:break t}if(m>>>0<x>>>0)m=m+1|0;else break t}if(ku(_,f[L>>2]|0)|0)for(m=1;L=(15-m|0)*3|0,H=ye(7,0,L|0)|0,ee=d&~(_e()|0),d=le(A|0,d|0,L|0)|0,_e()|0,d=ye(bo(d&7)|0,0,L|0)|0,A=A&~H|d,d=ee|(_e()|0),m>>>0<x>>>0;)m=m+1|0;else for(m=1;ee=(15-m|0)*3|0,L=le(A|0,d|0,ee|0)|0,_e()|0,H=ye(7,0,ee|0)|0,d=d&~(_e()|0),ee=ye(qo(L&7)|0,0,ee|0)|0,A=A&~H|ee,d=d|(_e()|0),m>>>0<x>>>0;)m=m+1|0}while(0);if((S|0)>0){m=0;do A=vc(A,d)|0,d=_e()|0,m=m+1|0;while((m|0)!=(S|0))}}else A=0,d=0;while(0);return H=d,ee=A,Vt(H|0),de=O,ee|0}function br(d){return d=d|0,(d|0)%2|0|0}function xl(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;return x=de,de=de+16|0,_=x,A>>>0>15?(_=4,de=x,_|0):(f[d+4>>2]&2146435072|0)==2146435072||(f[d+8+4>>2]&2146435072|0)==2146435072?(_=3,de=x,_|0):(Rn(d,A,_),A=vl(_,A)|0,_=_e()|0,f[m>>2]=A,f[m+4>>2]=_,(A|0)==0&(_|0)==0&&tn(23313,22674,786,22697),_=0,de=x,_|0)}function Yo(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0;if(x=m+4|0,S=le(d|0,A|0,52)|0,_e()|0,S=S&15,M=le(d|0,A|0,45)|0,_e()|0,_=(S|0)==0,On(M&127)|0){if(_)return M=1,M|0;_=1}else{if(_)return M=0,M|0;!(f[x>>2]|0)&&!(f[m+8>>2]|0)?_=(f[m+12>>2]|0)!=0&1:_=1}for(m=1;m&1?hl(x):wo(x),M=le(d|0,A|0,(15-m|0)*3|0)|0,_e()|0,$o(x,M&7),m>>>0<S>>>0;)m=m+1|0;return _|0}function ds(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0;if(ee=de,de=de+16|0,O=ee,H=le(d|0,A|0,45)|0,_e()|0,H=H&127,H>>>0>121)return f[m>>2]=0,f[m+4>>2]=0,f[m+8>>2]=0,f[m+12>>2]=0,H=5,de=ee,H|0;e:do if(On(H)|0&&(S=le(d|0,A|0,52)|0,_e()|0,S=S&15,(S|0)!=0)){_=1;t:for(;;){switch(L=le(d|0,A|0,(15-_|0)*3|0)|0,_e()|0,L&7){case 5:break t;case 0:break;default:{_=A;break e}}if(_>>>0<S>>>0)_=_+1|0;else{_=A;break e}}for(x=1,_=A;A=(15-x|0)*3|0,M=ye(7,0,A|0)|0,L=_&~(_e()|0),_=le(d|0,_|0,A|0)|0,_e()|0,_=ye(bo(_&7)|0,0,A|0)|0,d=d&~M|_,_=L|(_e()|0),x>>>0<S>>>0;)x=x+1|0}else _=A;while(0);if(L=7696+(H*28|0)|0,f[m>>2]=f[L>>2],f[m+4>>2]=f[L+4>>2],f[m+8>>2]=f[L+8>>2],f[m+12>>2]=f[L+12>>2],!(Yo(d,_,m)|0))return H=0,de=ee,H|0;if(M=m+4|0,f[O>>2]=f[M>>2],f[O+4>>2]=f[M+4>>2],f[O+8>>2]=f[M+8>>2],S=le(d|0,_|0,52)|0,_e()|0,L=S&15,S&1?(wo(M),S=L+1|0):S=L,!(On(H)|0))_=0;else{e:do if(!L)_=0;else for(A=1;;){if(x=le(d|0,_|0,(15-A|0)*3|0)|0,_e()|0,x=x&7,x|0){_=x;break e}if(A>>>0<L>>>0)A=A+1|0;else{_=0;break}}while(0);_=(_|0)==4&1}if(!(Ia(m,S,_,0)|0))(S|0)!=(L|0)&&(f[M>>2]=f[O>>2],f[M+4>>2]=f[O+4>>2],f[M+8>>2]=f[O+8>>2]);else{if(On(H)|0)do;while(Ia(m,S,0,0)|0);(S|0)!=(L|0)&&ul(M)}return H=0,de=ee,H|0}function Xs(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;return S=de,de=de+16|0,_=S,x=ds(d,A,_)|0,x|0?(de=S,x|0):(x=le(d|0,A|0,52)|0,_e()|0,dl(_,x&15,m),x=0,de=S,x|0)}function La(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0;if(M=de,de=de+16|0,S=M,_=ds(d,A,S)|0,_|0)return S=_,de=M,S|0;_=le(d|0,A|0,45)|0,_e()|0,_=(On(_&127)|0)==0,x=le(d|0,A|0,52)|0,_e()|0,x=x&15;e:do if(!_){if(x|0)for(_=1;;){if(L=ye(7,0,(15-_|0)*3|0)|0,!((L&d|0)==0&((_e()|0)&A|0)==0))break e;if(_>>>0<x>>>0)_=_+1|0;else break}return Eo(S,x,0,5,m),L=0,de=M,L|0}while(0);return _c(S,x,0,6,m),L=0,de=M,L|0}function wl(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if(x=le(d|0,A|0,45)|0,_e()|0,!(On(x&127)|0))return x=2,f[m>>2]=x,0;if(x=le(d|0,A|0,52)|0,_e()|0,x=x&15,!x)return x=5,f[m>>2]=x,0;for(_=1;;){if(S=ye(7,0,(15-_|0)*3|0)|0,!((S&d|0)==0&((_e()|0)&A|0)==0)){_=2,d=6;break}if(_>>>0<x>>>0)_=_+1|0;else{_=5,d=6;break}}return(d|0)==6&&(f[m>>2]=_),0}function xc(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0;Ae=de,de=de+128|0,H=Ae+112|0,S=Ae+96|0,ee=Ae,x=le(d|0,A|0,52)|0,_e()|0,L=x&15,f[H>>2]=L,M=le(d|0,A|0,45)|0,_e()|0,M=M&127;e:do if(On(M)|0){if(L|0)for(_=1;;){if(O=ye(7,0,(15-_|0)*3|0)|0,!((O&d|0)==0&((_e()|0)&A|0)==0)){x=0;break e}if(_>>>0<L>>>0)_=_+1|0;else break}if(x&1)x=1;else return O=ye(L+1|0,0,52)|0,ee=_e()|0|A&-15728641,H=ye(7,0,(14-L|0)*3|0)|0,ee=xc((O|d)&~H,ee&~(_e()|0),m)|0,de=Ae,ee|0}else x=0;while(0);if(_=ds(d,A,S)|0,!_){x?(Uu(S,H,ee),O=5):(pl(S,H,ee),O=6);e:do if(On(M)|0)if(!L)d=5;else for(_=1;;){if(M=ye(7,0,(15-_|0)*3|0)|0,!((M&d|0)==0&((_e()|0)&A|0)==0)){d=2;break e}if(_>>>0<L>>>0)_=_+1|0;else{d=5;break}}else d=2;while(0);He(m|0,-1,d<<2|0)|0;e:do if(x)for(S=0;;){if(M=ee+(S<<4)|0,Vu(M,f[H>>2]|0)|0,M=f[M>>2]|0,L=f[m>>2]|0,(L|0)==-1|(L|0)==(M|0))_=m;else{x=0;do{if(x=x+1|0,x>>>0>=d>>>0){_=1;break e}_=m+(x<<2)|0,L=f[_>>2]|0}while(!((L|0)==-1|(L|0)==(M|0)))}if(f[_>>2]=M,S=S+1|0,S>>>0>=O>>>0){_=0;break}}else for(S=0;;){if(M=ee+(S<<4)|0,Ia(M,f[H>>2]|0,0,1)|0,M=f[M>>2]|0,L=f[m>>2]|0,(L|0)==-1|(L|0)==(M|0))_=m;else{x=0;do{if(x=x+1|0,x>>>0>=d>>>0){_=1;break e}_=m+(x<<2)|0,L=f[_>>2]|0}while(!((L|0)==-1|(L|0)==(M|0)))}if(f[_>>2]=M,S=S+1|0,S>>>0>=O>>>0){_=0;break}}while(0)}return ee=_,de=Ae,ee|0}function Wu(){return 12}function b0(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0,O=0;if(d>>>0>15)return L=4,L|0;if(ye(d|0,0,52)|0,L=_e()|0|134225919,!d){m=0,_=0;do On(_)|0&&(ye(_|0,0,45)|0,M=L|(_e()|0),d=A+(m<<3)|0,f[d>>2]=-1,f[d+4>>2]=M,m=m+1|0),_=_+1|0;while((_|0)!=122);return m=0,m|0}m=0,M=0;do{if(On(M)|0){for(ye(M|0,0,45)|0,_=1,x=-1,S=L|(_e()|0);O=ye(7,0,(15-_|0)*3|0)|0,x=x&~O,S=S&~(_e()|0),(_|0)!=(d|0);)_=_+1|0;O=A+(m<<3)|0,f[O>>2]=x,f[O+4>>2]=S,m=m+1|0}M=M+1|0}while((M|0)!=122);return m=0,m|0}function Da(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0;if(We=de,de=de+16|0,tt=We,Ke=le(d|0,A|0,52)|0,_e()|0,Ke=Ke&15,m>>>0>15)return Ke=4,de=We,Ke|0;if((Ke|0)<(m|0))return Ke=12,de=We,Ke|0;if((Ke|0)!=(m|0))if(S=ye(m|0,0,52)|0,S=S|d,L=_e()|0|A&-15728641,(Ke|0)>(m|0)){O=m;do Be=ye(7,0,(14-O|0)*3|0)|0,O=O+1|0,S=Be|S,L=_e()|0|L;while((O|0)<(Ke|0));Be=S}else Be=S;else Be=d,L=A;Te=le(Be|0,L|0,45)|0,_e()|0;e:do if(On(Te&127)|0){if(O=le(Be|0,L|0,52)|0,_e()|0,O=O&15,O|0)for(S=1;;){if(Te=ye(7,0,(15-S|0)*3|0)|0,!((Te&Be|0)==0&((_e()|0)&L|0)==0)){H=33;break e}if(S>>>0<O>>>0)S=S+1|0;else break}if(Te=_,f[Te>>2]=0,f[Te+4>>2]=0,(Ke|0)>(m|0)){for(Te=A&-15728641,Re=Ke;;){if(we=Re,Re=Re+-1|0,Re>>>0>15|(Ke|0)<(Re|0)){H=19;break}if((Ke|0)!=(Re|0))if(S=ye(Re|0,0,52)|0,S=S|d,O=_e()|0|Te,(Ke|0)<(we|0))Ae=S;else{H=Re;do Ae=ye(7,0,(14-H|0)*3|0)|0,H=H+1|0,S=Ae|S,O=_e()|0|O;while((H|0)<(Ke|0));Ae=S}else Ae=d,O=A;if(ee=le(Ae|0,O|0,45)|0,_e()|0,!(On(ee&127)|0))S=0;else{ee=le(Ae|0,O|0,52)|0,_e()|0,ee=ee&15;t:do if(!ee)S=0;else for(H=1;;){if(S=le(Ae|0,O|0,(15-H|0)*3|0)|0,_e()|0,S=S&7,S|0)break t;if(H>>>0<ee>>>0)H=H+1|0;else{S=0;break}}while(0);S=(S|0)==0&1}if(O=le(d|0,A|0,(15-we|0)*3|0)|0,_e()|0,O=O&7,(O|0)==7){x=5,H=42;break}if(S=(S|0)!=0,(O|0)==1&S){x=5,H=42;break}if(Ae=O+(((O|0)!=0&S)<<31>>31)|0,Ae|0&&(H=Ke-we|0,H=zs(7,0,H,((H|0)<0)<<31>>31)|0,ee=_e()|0,S?(S=se(H|0,ee|0,5,0)|0,S=P(S|0,_e()|0,-5,-1)|0,S=$(S|0,_e()|0,6,0)|0,S=P(S|0,_e()|0,1,0)|0,O=_e()|0):(S=H,O=ee),we=Ae+-1|0,we=se(H|0,ee|0,we|0,((we|0)<0)<<31>>31|0)|0,we=P(S|0,O|0,we|0,_e()|0)|0,Ae=_e()|0,ee=_,ee=P(we|0,Ae|0,f[ee>>2]|0,f[ee+4>>2]|0)|0,Ae=_e()|0,we=_,f[we>>2]=ee,f[we+4>>2]=Ae),(Re|0)<=(m|0)){H=37;break}}if((H|0)==19)tn(23313,22674,1099,22710);else if((H|0)==37){M=_,x=f[M+4>>2]|0,M=f[M>>2]|0;break}else if((H|0)==42)return de=We,x|0}else x=0,M=0}else H=33;while(0);e:do if((H|0)==33)if(Te=_,f[Te>>2]=0,f[Te+4>>2]=0,(Ke|0)>(m|0)){for(S=Ke;;){if(x=le(d|0,A|0,(15-S|0)*3|0)|0,_e()|0,x=x&7,(x|0)==7){x=5;break}if(M=Ke-S|0,M=zs(7,0,M,((M|0)<0)<<31>>31)|0,x=se(M|0,_e()|0,x|0,0)|0,M=_e()|0,Te=_,M=P(f[Te>>2]|0,f[Te+4>>2]|0,x|0,M|0)|0,x=_e()|0,Te=_,f[Te>>2]=M,f[Te+4>>2]=x,S=S+-1|0,(S|0)<=(m|0))break e}return de=We,x|0}else x=0,M=0;while(0);return _l(Be,L,Ke,tt)|0&&tn(23313,22674,1063,22725),Ke=tt,tt=f[Ke+4>>2]|0,((x|0)>-1|(x|0)==-1&M>>>0>4294967295)&((tt|0)>(x|0)|((tt|0)==(x|0)?(f[Ke>>2]|0)>>>0>M>>>0:0))?(Ke=0,de=We,Ke|0):(tn(23313,22674,1139,22710),0)}function $u(d,A,m,_,x,S){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0;var M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0;if(Ae=de,de=de+16|0,M=Ae,x>>>0>15)return S=4,de=Ae,S|0;if(L=le(m|0,_|0,52)|0,_e()|0,L=L&15,(L|0)>(x|0))return S=12,de=Ae,S|0;if(_l(m,_,x,M)|0&&tn(23313,22674,1063,22725),ee=M,H=f[ee+4>>2]|0,!(((A|0)>-1|(A|0)==-1&d>>>0>4294967295)&((H|0)>(A|0)|((H|0)==(A|0)?(f[ee>>2]|0)>>>0>d>>>0:0))))return S=2,de=Ae,S|0;ee=x-L|0,x=ye(x|0,0,52)|0,O=_e()|0|_&-15728641,H=S,f[H>>2]=x|m,f[H+4>>2]=O,H=le(m|0,_|0,45)|0,_e()|0;e:do if(On(H&127)|0){if(L|0)for(M=1;;){if(H=ye(7,0,(15-M|0)*3|0)|0,!((H&m|0)==0&((_e()|0)&_|0)==0))break e;if(M>>>0<L>>>0)M=M+1|0;else break}if((ee|0)<1)return S=0,de=Ae,S|0;for(H=L^15,_=-1,O=1,M=1;;){L=ee-O|0,L=zs(7,0,L,((L|0)<0)<<31>>31)|0,m=_e()|0;do if(M)if(M=se(L|0,m|0,5,0)|0,M=P(M|0,_e()|0,-5,-1)|0,M=$(M|0,_e()|0,6,0)|0,x=_e()|0,(A|0)>(x|0)|(A|0)==(x|0)&d>>>0>M>>>0){A=P(d|0,A|0,-1,-1)|0,A=z(A|0,_e()|0,M|0,x|0)|0,M=_e()|0,we=S,Te=f[we>>2]|0,we=f[we+4>>2]|0,Be=(H+_|0)*3|0,Re=ye(7,0,Be|0)|0,we=we&~(_e()|0),_=$(A|0,M|0,L|0,m|0)|0,d=_e()|0,x=P(_|0,d|0,2,0)|0,Be=ye(x|0,_e()|0,Be|0)|0,we=_e()|0|we,x=S,f[x>>2]=Be|Te&~Re,f[x+4>>2]=we,d=se(_|0,d|0,L|0,m|0)|0,d=z(A|0,M|0,d|0,_e()|0)|0,M=0,A=_e()|0;break}else{Be=S,Re=f[Be>>2]|0,Be=f[Be+4>>2]|0,Te=ye(7,0,(H+_|0)*3|0)|0,Be=Be&~(_e()|0),M=S,f[M>>2]=Re&~Te,f[M+4>>2]=Be,M=1;break}else Re=S,x=f[Re>>2]|0,Re=f[Re+4>>2]|0,_=(H+_|0)*3|0,we=ye(7,0,_|0)|0,Re=Re&~(_e()|0),Be=$(d|0,A|0,L|0,m|0)|0,M=_e()|0,_=ye(Be|0,M|0,_|0)|0,Re=_e()|0|Re,Te=S,f[Te>>2]=_|x&~we,f[Te+4>>2]=Re,M=se(Be|0,M|0,L|0,m|0)|0,d=z(d|0,A|0,M|0,_e()|0)|0,M=0,A=_e()|0;while(0);if((ee|0)>(O|0))_=~O,O=O+1|0;else{A=0;break}}return de=Ae,A|0}while(0);if((ee|0)<1)return Be=0,de=Ae,Be|0;for(x=L^15,M=1;;)if(Te=ee-M|0,Te=zs(7,0,Te,((Te|0)<0)<<31>>31)|0,Be=_e()|0,O=S,m=f[O>>2]|0,O=f[O+4>>2]|0,L=(x-M|0)*3|0,_=ye(7,0,L|0)|0,O=O&~(_e()|0),we=$(d|0,A|0,Te|0,Be|0)|0,Re=_e()|0,L=ye(we|0,Re|0,L|0)|0,O=_e()|0|O,H=S,f[H>>2]=L|m&~_,f[H+4>>2]=O,Be=se(we|0,Re|0,Te|0,Be|0)|0,d=z(d|0,A|0,Be|0,_e()|0)|0,A=_e()|0,(ee|0)<=(M|0)){A=0;break}else M=M+1|0;return de=Ae,A|0}function Ra(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0;x=le(A|0,m|0,52)|0,_e()|0,x=x&15,(A|0)==0&(m|0)==0|((_|0)>15|(x|0)>(_|0))?(_=-1,x=-1,A=0,m=0):(S=As(A,m,x+1|0,_)|0,m=(_e()|0)&-15728641,A=ye(_|0,0,52)|0,A=S|A,m=m|(_e()|0),S=(ri(A,m)|0)==0,_=S?-1:_),S=d,f[S>>2]=A,f[S+4>>2]=m,f[d+8>>2]=x,f[d+12>>2]=_}function za(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0,O=0,H=0;if(m=d,A=f[m>>2]|0,m=f[m+4>>2]|0,!((A|0)==0&(m|0)==0)&&(_=le(A|0,m|0,52)|0,_e()|0,_=_&15,L=ye(1,0,(_^15)*3|0)|0,A=P(L|0,_e()|0,A|0,m|0)|0,m=_e()|0,L=d,f[L>>2]=A,f[L+4>>2]=m,L=d+8|0,M=f[L>>2]|0,!((_|0)<(M|0)))){for(O=d+12|0,S=_;;){if((S|0)==(M|0)){_=5;break}if(H=(S|0)==(f[O>>2]|0),x=(15-S|0)*3|0,_=le(A|0,m|0,x|0)|0,_e()|0,_=_&7,H&((_|0)==1&!0)){_=7;break}if(!((_|0)==7&!0)){_=10;break}if(H=ye(1,0,x|0)|0,A=P(A|0,m|0,H|0,_e()|0)|0,m=_e()|0,H=d,f[H>>2]=A,f[H+4>>2]=m,(S|0)>(M|0))S=S+-1|0;else{_=10;break}}if((_|0)==5){H=d,f[H>>2]=0,f[H+4>>2]=0,f[L>>2]=-1,f[O>>2]=-1;return}else if((_|0)==7){M=ye(1,0,x|0)|0,M=P(A|0,m|0,M|0,_e()|0)|0,L=_e()|0,H=d,f[H>>2]=M,f[H+4>>2]=L,f[O>>2]=S+-1;return}else if((_|0)==10)return}}function Ji(d){d=+d;var A=0;return A=d<0?d+6.283185307179586:d,+(d>=6.283185307179586?A+-6.283185307179586:A)}function Ds(d,A){return d=d|0,A=A|0,+Me(+(+W[d>>3]-+W[A>>3]))<17453292519943298e-27?(A=+Me(+(+W[d+8>>3]-+W[A+8>>3]))<17453292519943298e-27,A|0):(A=0,A|0)}function zr(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return x=+W[A>>3],_=+W[d>>3],S=+ft(+((x-_)*.5)),m=+ft(+((+W[A+8>>3]-+W[d+8>>3])*.5)),m=S*S+m*(+Ve(+x)*+Ve(+_)*m),+(+on(+ +Ne(+m),+ +Ne(+(1-m)))*2)}function bl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return x=+W[A>>3],_=+W[d>>3],S=+ft(+((x-_)*.5)),m=+ft(+((+W[A+8>>3]-+W[d+8>>3])*.5)),m=S*S+m*(+Ve(+x)*+Ve(+_)*m),+(+on(+ +Ne(+m),+ +Ne(+(1-m)))*2*6371.007180918475)}function To(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return x=+W[A>>3],_=+W[d>>3],S=+ft(+((x-_)*.5)),m=+ft(+((+W[A+8>>3]-+W[d+8>>3])*.5)),m=S*S+m*(+Ve(+x)*+Ve(+_)*m),+(+on(+ +Ne(+m),+ +Ne(+(1-m)))*2*6371.007180918475*1e3)}function qu(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0;return S=+W[A>>3],_=+Ve(+S),x=+W[A+8>>3]-+W[d+8>>3],M=_*+ft(+x),m=+W[d>>3],+ +on(+M,+(+ft(+S)*+Ve(+m)-+Ve(+x)*(_*+ft(+m))))}function Qs(d,A,m,_){d=d|0,A=+A,m=+m,_=_|0;var x=0,S=0,M=0,L=0;if(m<1e-16){f[_>>2]=f[d>>2],f[_+4>>2]=f[d+4>>2],f[_+8>>2]=f[d+8>>2],f[_+12>>2]=f[d+12>>2];return}S=A<0?A+6.283185307179586:A,S=A>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)A=+W[d>>3]+m,W[_>>3]=A,x=_;else{if(x=+Me(+(S+-3.141592653589793))<1e-16,A=+W[d>>3],x){A=A-m,W[_>>3]=A,x=_;break}if(M=+Ve(+m),m=+ft(+m),A=M*+ft(+A)+ +Ve(+S)*(m*+Ve(+A)),A=A>1?1:A,A=+Yt(+(A<-1?-1:A)),W[_>>3]=A,+Me(+(A+-1.5707963267948966))<1e-16){W[_>>3]=1.5707963267948966,W[_+8>>3]=0;return}if(+Me(+(A+1.5707963267948966))<1e-16){W[_>>3]=-1.5707963267948966,W[_+8>>3]=0;return}if(L=+Ve(+A),S=m*+ft(+S)/L,m=+W[d>>3],A=(M-+ft(+A)*+ft(+m))/+Ve(+m)/L,M=S>1?1:S,A=A>1?1:A,A=+W[d+8>>3]+ +on(+(M<-1?-1:M),+(A<-1?-1:A)),A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);W[_+8>>3]=A;return}while(0);if(+Me(+(A+-1.5707963267948966))<1e-16){W[x>>3]=1.5707963267948966,W[_+8>>3]=0;return}if(+Me(+(A+1.5707963267948966))<1e-16){W[x>>3]=-1.5707963267948966,W[_+8>>3]=0;return}if(A=+W[d+8>>3],A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);W[_+8>>3]=A}function El(d,A){return d=d|0,A=A|0,d>>>0>15?(A=4,A|0):(W[A>>3]=+W[20528+(d<<3)>>3],A=0,A|0)}function wc(d,A){return d=d|0,A=A|0,d>>>0>15?(A=4,A|0):(W[A>>3]=+W[20656+(d<<3)>>3],A=0,A|0)}function B1(d,A){return d=d|0,A=A|0,d>>>0>15?(A=4,A|0):(W[A>>3]=+W[20784+(d<<3)>>3],A=0,A|0)}function O1(d,A){return d=d|0,A=A|0,d>>>0>15?(A=4,A|0):(W[A>>3]=+W[20912+(d<<3)>>3],A=0,A|0)}function Ba(d,A){d=d|0,A=A|0;var m=0;return d>>>0>15?(A=4,A|0):(m=zs(7,0,d,((d|0)<0)<<31>>31)|0,m=se(m|0,_e()|0,120,0)|0,d=_e()|0,f[A>>2]=m|2,f[A+4>>2]=d,A=0,A|0)}function Oa(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0;return we=+W[A>>3],ee=+W[d>>3],O=+ft(+((we-ee)*.5)),S=+W[A+8>>3],H=+W[d+8>>3],M=+ft(+((S-H)*.5)),L=+Ve(+ee),Ae=+Ve(+we),M=O*O+M*(Ae*L*M),M=+on(+ +Ne(+M),+ +Ne(+(1-M)))*2,O=+W[m>>3],we=+ft(+((O-we)*.5)),_=+W[m+8>>3],S=+ft(+((_-S)*.5)),x=+Ve(+O),S=we*we+S*(Ae*x*S),S=+on(+ +Ne(+S),+ +Ne(+(1-S)))*2,O=+ft(+((ee-O)*.5)),_=+ft(+((H-_)*.5)),_=O*O+_*(L*x*_),_=+on(+ +Ne(+_),+ +Ne(+(1-_)))*2,x=(M+S+_)*.5,+(+Gt(+ +Ne(+(+Lt(+(x*.5))*+Lt(+((x-M)*.5))*+Lt(+((x-S)*.5))*+Lt(+((x-_)*.5)))))*4)}function ps(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0;if(L=de,de=de+192|0,S=L+168|0,M=L,x=Xs(d,A,S)|0,x|0)return m=x,de=L,m|0;if(La(d,A,M)|0&&tn(23313,22742,386,22751),A=f[M>>2]|0,(A|0)>0){if(_=+Oa(M+8|0,M+8+(((A|0)!=1&1)<<4)|0,S)+0,(A|0)!=1){d=1;do x=d,d=d+1|0,_=_+ +Oa(M+8+(x<<4)|0,M+8+(((d|0)%(A|0)|0)<<4)|0,S);while((d|0)<(A|0))}}else _=0;return W[m>>3]=_,m=0,de=L,m|0}function Ft(d,A,m){return d=d|0,A=A|0,m=m|0,d=ps(d,A,m)|0,d|0||(W[m>>3]=+W[m>>3]*6371.007180918475*6371.007180918475),d|0}function Zu(d,A,m){return d=d|0,A=A|0,m=m|0,d=ps(d,A,m)|0,d|0||(W[m>>3]=+W[m>>3]*6371.007180918475*6371.007180918475*1e3*1e3),d|0}function Ko(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0;if(L=de,de=de+176|0,M=L,d=Al(d,A,M)|0,d|0)return M=d,de=L,M|0;if(W[m>>3]=0,d=f[M>>2]|0,(d|0)<=1)return M=0,de=L,M|0;A=d+-1|0,d=0,_=+W[M+8>>3],x=+W[M+16>>3],S=0;do d=d+1|0,H=_,_=+W[M+8+(d<<4)>>3],ee=+ft(+((_-H)*.5)),O=x,x=+W[M+8+(d<<4)+8>>3],O=+ft(+((x-O)*.5)),O=ee*ee+O*(+Ve(+_)*+Ve(+H)*O),S=S+ +on(+ +Ne(+O),+ +Ne(+(1-O)))*2;while((d|0)<(A|0));return W[m>>3]=S,M=0,de=L,M|0}function So(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0;if(L=de,de=de+176|0,M=L,d=Al(d,A,M)|0,d|0)return M=d,S=+W[m>>3],S=S*6371.007180918475,W[m>>3]=S,de=L,M|0;if(W[m>>3]=0,d=f[M>>2]|0,(d|0)<=1)return M=0,S=0,S=S*6371.007180918475,W[m>>3]=S,de=L,M|0;A=d+-1|0,d=0,_=+W[M+8>>3],x=+W[M+16>>3],S=0;do d=d+1|0,H=_,_=+W[M+8+(d<<4)>>3],ee=+ft(+((_-H)*.5)),O=x,x=+W[M+8+(d<<4)+8>>3],O=+ft(+((x-O)*.5)),O=ee*ee+O*(+Ve(+H)*+Ve(+_)*O),S=S+ +on(+ +Ne(+O),+ +Ne(+(1-O)))*2;while((d|0)!=(A|0));return W[m>>3]=S,M=0,ee=S,ee=ee*6371.007180918475,W[m>>3]=ee,de=L,M|0}function bc(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0;if(L=de,de=de+176|0,M=L,d=Al(d,A,M)|0,d|0)return M=d,S=+W[m>>3],S=S*6371.007180918475,S=S*1e3,W[m>>3]=S,de=L,M|0;if(W[m>>3]=0,d=f[M>>2]|0,(d|0)<=1)return M=0,S=0,S=S*6371.007180918475,S=S*1e3,W[m>>3]=S,de=L,M|0;A=d+-1|0,d=0,_=+W[M+8>>3],x=+W[M+16>>3],S=0;do d=d+1|0,H=_,_=+W[M+8+(d<<4)>>3],ee=+ft(+((_-H)*.5)),O=x,x=+W[M+8+(d<<4)+8>>3],O=+ft(+((x-O)*.5)),O=ee*ee+O*(+Ve(+H)*+Ve(+_)*O),S=S+ +on(+ +Ne(+O),+ +Ne(+(1-O)))*2;while((d|0)!=(A|0));return W[m>>3]=S,M=0,ee=S,ee=ee*6371.007180918475,ee=ee*1e3,W[m>>3]=ee,de=L,M|0}function Dt(d){d=d|0;var A=0,m=0,_=0;return A=E(1,12)|0,A||tn(22832,22787,49,22845),m=d+4|0,_=f[m>>2]|0,_|0?(_=_+8|0,f[_>>2]=A,f[m>>2]=A,A|0):(f[d>>2]|0&&tn(22862,22787,61,22885),_=d,f[_>>2]=A,f[m>>2]=A,A|0)}function E0(d,A){d=d|0,A=A|0;var m=0,_=0;return _=p(24)|0,_||tn(22899,22787,78,22913),f[_>>2]=f[A>>2],f[_+4>>2]=f[A+4>>2],f[_+8>>2]=f[A+8>>2],f[_+12>>2]=f[A+12>>2],f[_+16>>2]=0,A=d+4|0,m=f[A>>2]|0,m|0?(f[m+16>>2]=_,f[A>>2]=_,_|0):(f[d>>2]|0&&tn(22928,22787,82,22913),f[d>>2]=_,f[A>>2]=_,_|0)}function Xu(d){d=d|0;var A=0,m=0,_=0,x=0;if(d)for(_=1;;){if(A=f[d>>2]|0,A|0)do{if(m=f[A>>2]|0,m|0)do x=m,m=f[m+16>>2]|0,v(x);while(m|0);x=A,A=f[A+8>>2]|0,v(x)}while(A|0);if(A=d,d=f[d+8>>2]|0,_||v(A),d)_=0;else break}}function Ec(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0,Et=0,st=0,dt=0,gn=0,hn=0,sn=0,an=0,fn=0,vn=0,Zn=0,_n=0;if(x=d+8|0,f[x>>2]|0)return _n=1,_n|0;if(_=f[d>>2]|0,!_)return _n=0,_n|0;A=_,m=0;do m=m+1|0,A=f[A+8>>2]|0;while(A|0);if(m>>>0<2)return _n=0,_n|0;vn=p(m<<2)|0,vn||tn(22948,22787,317,22967),fn=p(m<<5)|0,fn||tn(22989,22787,321,22967),f[d>>2]=0,Et=d+4|0,f[Et>>2]=0,f[x>>2]=0,m=0,an=0,It=0,Ae=0;e:for(;;){if(ee=f[_>>2]|0,ee){S=0,M=ee;do{if(O=+W[M+8>>3],A=M,M=f[M+16>>2]|0,H=(M|0)==0,x=H?ee:M,L=+W[x+8>>3],+Me(+(O-L))>3.141592653589793){_n=14;break}S=S+(L-O)*(+W[A>>3]+ +W[x>>3])}while(!H);if((_n|0)==14){_n=0,S=0,A=ee;do Oe=+W[A+8>>3],sn=A+16|0,hn=f[sn>>2]|0,hn=hn|0?hn:ee,$e=+W[hn+8>>3],S=S+(+W[A>>3]+ +W[hn>>3])*(($e<0?$e+6.283185307179586:$e)-(Oe<0?Oe+6.283185307179586:Oe)),A=f[(A|0?sn:_)>>2]|0;while(A|0)}S>0?(f[vn+(an<<2)>>2]=_,an=an+1|0,x=It,A=Ae):_n=19}else _n=19;if((_n|0)==19){_n=0;do if(m){if(A=m+8|0,f[A>>2]|0){_n=21;break e}if(m=E(1,12)|0,!m){_n=23;break e}f[A>>2]=m,x=m+4|0,M=m,A=Ae}else if(Ae){x=Et,M=Ae+8|0,A=_,m=d;break}else if(f[d>>2]|0){_n=27;break e}else{x=Et,M=d,A=_,m=d;break}while(0);if(f[M>>2]=_,f[x>>2]=_,M=fn+(It<<5)|0,H=f[_>>2]|0,H){for(ee=fn+(It<<5)+8|0,W[ee>>3]=17976931348623157e292,Ae=fn+(It<<5)+24|0,W[Ae>>3]=17976931348623157e292,W[M>>3]=-17976931348623157e292,we=fn+(It<<5)+16|0,W[we>>3]=-17976931348623157e292,Ke=17976931348623157e292,We=-17976931348623157e292,x=0,Re=H,O=17976931348623157e292,Be=17976931348623157e292,tt=-17976931348623157e292,L=-17976931348623157e292;S=+W[Re>>3],Oe=+W[Re+8>>3],Re=f[Re+16>>2]|0,Te=(Re|0)==0,$e=+W[(Te?H:Re)+8>>3],S<O&&(W[ee>>3]=S,O=S),Oe<Be&&(W[Ae>>3]=Oe,Be=Oe),S>tt?W[M>>3]=S:S=tt,Oe>L&&(W[we>>3]=Oe,L=Oe),Ke=Oe>0&Oe<Ke?Oe:Ke,We=Oe<0&Oe>We?Oe:We,x=x|+Me(+(Oe-$e))>3.141592653589793,!Te;)tt=S;x&&(W[we>>3]=We,W[Ae>>3]=Ke)}else f[M>>2]=0,f[M+4>>2]=0,f[M+8>>2]=0,f[M+12>>2]=0,f[M+16>>2]=0,f[M+20>>2]=0,f[M+24>>2]=0,f[M+28>>2]=0;x=It+1|0}if(sn=_+8|0,_=f[sn>>2]|0,f[sn>>2]=0,_)It=x,Ae=A;else{_n=45;break}}if((_n|0)==21)tn(22765,22787,35,22799);else if((_n|0)==23)tn(22819,22787,37,22799);else if((_n|0)==27)tn(22862,22787,61,22885);else if((_n|0)==45){e:do if((an|0)>0){for(sn=(x|0)==0,gn=x<<2,hn=(d|0)==0,dt=0,A=0;;){if(st=f[vn+(dt<<2)>>2]|0,sn)_n=73;else{if(It=p(gn)|0,!It){_n=50;break}if(Et=p(gn)|0,!Et){_n=52;break}t:do if(hn)m=0;else{for(x=0,m=0,M=d;_=fn+(x<<5)|0,T0(f[M>>2]|0,_,f[st>>2]|0)|0?(f[It+(m<<2)>>2]=M,f[Et+(m<<2)>>2]=_,Te=m+1|0):Te=m,M=f[M+8>>2]|0,M;)x=x+1|0,m=Te;if((Te|0)>0)if(_=f[It>>2]|0,(Te|0)==1)m=_;else for(we=0,Re=-1,m=_,Ae=_;;){for(H=f[Ae>>2]|0,_=0,M=0;x=f[f[It+(M<<2)>>2]>>2]|0,(x|0)==(H|0)?ee=_:ee=_+((T0(x,f[Et+(M<<2)>>2]|0,f[H>>2]|0)|0)&1)|0,M=M+1|0,(M|0)!=(Te|0);)_=ee;if(x=(ee|0)>(Re|0),m=x?Ae:m,_=we+1|0,(_|0)==(Te|0))break t;we=_,Re=x?ee:Re,Ae=f[It+(_<<2)>>2]|0}else m=0}while(0);if(v(It),v(Et),m){if(x=m+4|0,_=f[x>>2]|0,_)m=_+8|0;else if(f[m>>2]|0){_n=70;break}f[m>>2]=st,f[x>>2]=st}else _n=73}if((_n|0)==73){if(_n=0,A=f[st>>2]|0,A|0)do Et=A,A=f[A+16>>2]|0,v(Et);while(A|0);v(st),A=1}if(dt=dt+1|0,(dt|0)>=(an|0)){Zn=A;break e}}(_n|0)==50?tn(23004,22787,249,23023):(_n|0)==52?tn(23042,22787,252,23023):(_n|0)==70&&tn(22862,22787,61,22885)}else Zn=0;while(0);return v(vn),v(fn),_n=Zn,_n|0}return 0}function T0(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0;if(!(dc(A,m)|0)||(A=qn(A)|0,_=+W[m>>3],x=+W[m+8>>3],x=A&x<0?x+6.283185307179586:x,d=f[d>>2]|0,!d))return d=0,d|0;if(A){A=0,H=x,m=d;e:for(;;){for(;M=+W[m>>3],x=+W[m+8>>3],m=m+16|0,ee=f[m>>2]|0,ee=ee|0?ee:d,S=+W[ee>>3],L=+W[ee+8>>3],M>S?(O=M,M=L):(O=S,S=M,M=x,x=L),_=_==S|_==O?_+2220446049250313e-31:_,!!(_<S|_>O);)if(m=f[m>>2]|0,!m){m=22;break e}if(L=M<0?M+6.283185307179586:M,M=x<0?x+6.283185307179586:x,H=L==H|M==H?H+-2220446049250313e-31:H,O=L+(M-L)*((_-S)/(O-S)),(O<0?O+6.283185307179586:O)>H&&(A=A^1),m=f[m>>2]|0,!m){m=22;break}}if((m|0)==22)return A|0}else{A=0,H=x,m=d;e:for(;;){for(;M=+W[m>>3],x=+W[m+8>>3],m=m+16|0,ee=f[m>>2]|0,ee=ee|0?ee:d,S=+W[ee>>3],L=+W[ee+8>>3],M>S?(O=M,M=L):(O=S,S=M,M=x,x=L),_=_==S|_==O?_+2220446049250313e-31:_,!!(_<S|_>O);)if(m=f[m>>2]|0,!m){m=22;break e}if(H=M==H|x==H?H+-2220446049250313e-31:H,M+(x-M)*((_-S)/(O-S))>H&&(A=A^1),m=f[m>>2]|0,!m){m=22;break}}if((m|0)==22)return A|0}return 0}function Rs(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0;if(We=de,de=de+32|0,Ke=We+16|0,tt=We,S=le(d|0,A|0,52)|0,_e()|0,S=S&15,Re=le(m|0,_|0,52)|0,_e()|0,(S|0)!=(Re&15|0))return Ke=12,de=We,Ke|0;if(H=le(d|0,A|0,45)|0,_e()|0,H=H&127,ee=le(m|0,_|0,45)|0,_e()|0,ee=ee&127,H>>>0>121|ee>>>0>121)return Ke=5,de=We,Ke|0;if(Re=(H|0)!=(ee|0),Re){if(L=al(H,ee)|0,(L|0)==7)return Ke=1,de=We,Ke|0;O=al(ee,H)|0,(O|0)==7?tn(23066,23090,161,23100):(Te=L,M=O)}else Te=0,M=0;Ae=On(H)|0,we=On(ee)|0,f[Ke>>2]=0,f[Ke+4>>2]=0,f[Ke+8>>2]=0,f[Ke+12>>2]=0;do if(Te){if(ee=f[4272+(H*28|0)+(Te<<2)>>2]|0,L=(ee|0)>0,we)if(L){H=0,O=m,L=_;do O=Hu(O,L)|0,L=_e()|0,M=bo(M)|0,(M|0)==1&&(M=bo(1)|0),H=H+1|0;while((H|0)!=(ee|0));ee=M,H=O,O=L}else ee=M,H=m,O=_;else if(L){H=0,O=m,L=_;do O=w0(O,L)|0,L=_e()|0,M=bo(M)|0,H=H+1|0;while((H|0)!=(ee|0));ee=M,H=O,O=L}else ee=M,H=m,O=_;if(Yo(H,O,Ke)|0,Re||tn(23115,23090,191,23100),L=(Ae|0)!=0,M=(we|0)!=0,L&M&&tn(23142,23090,192,23100),L){if(M=Ni(d,A)|0,(M|0)==7){S=5;break}if(oe[21872+(M*7|0)+Te>>0]|0){S=1;break}O=f[21040+(M*28|0)+(Te<<2)>>2]|0,H=O}else if(M){if(M=Ni(H,O)|0,(M|0)==7){S=5;break}if(oe[21872+(M*7|0)+ee>>0]|0){S=1;break}H=0,O=f[21040+(ee*28|0)+(M<<2)>>2]|0}else H=0,O=0;if((H|O|0)<0)S=5;else{if((O|0)>0){L=Ke+4|0,M=0;do g0(L),M=M+1|0;while((M|0)!=(O|0))}if(f[tt>>2]=0,f[tt+4>>2]=0,f[tt+8>>2]=0,$o(tt,Te),S|0)for(;br(S)|0?hl(tt):wo(tt),(S|0)>1;)S=S+-1|0;if((H|0)>0){S=0;do g0(tt),S=S+1|0;while((S|0)!=(H|0))}Be=Ke+4|0,qi(Be,tt,Be),ui(Be),Be=51}}else if(Yo(m,_,Ke)|0,(Ae|0)!=0&(we|0)!=0)if((ee|0)!=(H|0)&&tn(23173,23090,261,23100),M=Ni(d,A)|0,S=Ni(m,_)|0,(M|0)==7|(S|0)==7)S=5;else if(oe[21872+(M*7|0)+S>>0]|0)S=1;else if(M=f[21040+(M*28|0)+(S<<2)>>2]|0,(M|0)>0){L=Ke+4|0,S=0;do g0(L),S=S+1|0;while((S|0)!=(M|0));Be=51}else Be=51;else Be=51;while(0);return(Be|0)==51&&(S=Ke+4|0,f[x>>2]=f[S>>2],f[x+4>>2]=f[S+4>>2],f[x+8>>2]=f[S+8>>2],S=0),Ke=S,de=We,Ke|0}function Tc(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0;if(Be=de,de=de+48|0,H=Be+36|0,M=Be+24|0,L=Be+12|0,O=Be,x=le(d|0,A|0,52)|0,_e()|0,x=x&15,we=le(d|0,A|0,45)|0,_e()|0,we=we&127,we>>>0>121)return _=5,de=Be,_|0;if(ee=On(we)|0,ye(x|0,0,52)|0,tt=_e()|0|134225919,S=_,f[S>>2]=-1,f[S+4>>2]=tt,!x)return x=Ca(m)|0,(x|0)==7||(x=ol(we,x)|0,(x|0)==127)?(tt=1,de=Be,tt|0):(Re=ye(x|0,0,45)|0,Te=_e()|0,we=_,Te=f[we+4>>2]&-1040385|Te,tt=_,f[tt>>2]=f[we>>2]|Re,f[tt+4>>2]=Te,tt=0,de=Be,tt|0);for(f[H>>2]=f[m>>2],f[H+4>>2]=f[m+4>>2],f[H+8>>2]=f[m+8>>2],m=x;;){if(S=m,m=m+-1|0,f[M>>2]=f[H>>2],f[M+4>>2]=f[H+4>>2],f[M+8>>2]=f[H+8>>2],br(S)|0){if(x=m0(H)|0,x|0){m=13;break}f[L>>2]=f[H>>2],f[L+4>>2]=f[H+4>>2],f[L+8>>2]=f[H+8>>2],hl(L)}else{if(x=pc(H)|0,x|0){m=13;break}f[L>>2]=f[H>>2],f[L+4>>2]=f[H+4>>2],f[L+8>>2]=f[H+8>>2],wo(L)}if(Sa(M,L,O),ui(O),x=_,We=f[x>>2]|0,x=f[x+4>>2]|0,$e=(15-S|0)*3|0,Ke=ye(7,0,$e|0)|0,x=x&~(_e()|0),$e=ye(Ca(O)|0,0,$e|0)|0,x=_e()|0|x,tt=_,f[tt>>2]=$e|We&~Ke,f[tt+4>>2]=x,(S|0)<=1){m=14;break}}e:do if((m|0)!=13&&(m|0)==14)if((f[H>>2]|0)<=1&&(f[H+4>>2]|0)<=1&&(f[H+8>>2]|0)<=1){m=Ca(H)|0,x=ol(we,m)|0,(x|0)==127?O=0:O=On(x)|0;t:do if(m){if(ee){if(x=Ni(d,A)|0,(x|0)==7){x=5;break e}if(S=f[21248+(x*28|0)+(m<<2)>>2]|0,(S|0)>0){x=m,m=0;do x=qo(x)|0,m=m+1|0;while((m|0)!=(S|0))}else x=m;if((x|0)==1){x=9;break e}m=ol(we,x)|0,(m|0)==127&&tn(23200,23090,411,23230),On(m)|0?tn(23245,23090,412,23230):(Te=m,Re=S,Ae=x)}else Te=x,Re=0,Ae=m;if(L=f[4272+(we*28|0)+(Ae<<2)>>2]|0,(L|0)<=-1&&tn(23276,23090,419,23230),!O){if((Re|0)<0){x=5;break e}if(Re|0){S=_,x=0,m=f[S>>2]|0,S=f[S+4>>2]|0;do m=Ls(m,S)|0,S=_e()|0,$e=_,f[$e>>2]=m,f[$e+4>>2]=S,x=x+1|0;while((x|0)<(Re|0))}if((L|0)<=0){x=Te,m=58;break}for(S=_,x=0,m=f[S>>2]|0,S=f[S+4>>2]|0;;)if(m=Ls(m,S)|0,S=_e()|0,$e=_,f[$e>>2]=m,f[$e+4>>2]=S,x=x+1|0,(x|0)==(L|0)){x=Te,m=58;break t}}if(M=al(Te,we)|0,(M|0)==7&&tn(23066,23090,428,23230),x=_,m=f[x>>2]|0,x=f[x+4>>2]|0,(L|0)>0){S=0;do m=Ls(m,x)|0,x=_e()|0,$e=_,f[$e>>2]=m,f[$e+4>>2]=x,S=S+1|0;while((S|0)!=(L|0))}if(x=Ni(m,x)|0,(x|0)==7&&tn(23313,23090,440,23230),m=f0(Te)|0,m=f[(m?21664:21456)+(M*28|0)+(x<<2)>>2]|0,(m|0)<0&&tn(23313,23090,454,23230),!m)x=Te,m=58;else{M=_,x=0,S=f[M>>2]|0,M=f[M+4>>2]|0;do S=vc(S,M)|0,M=_e()|0,$e=_,f[$e>>2]=S,f[$e+4>>2]=M,x=x+1|0;while((x|0)<(m|0));x=Te,m=58}}else if((ee|0)!=0&(O|0)!=0){if(m=Ni(d,A)|0,S=_,S=Ni(f[S>>2]|0,f[S+4>>2]|0)|0,(m|0)==7|(S|0)==7){x=5;break e}if(S=f[21248+(m*28|0)+(S<<2)>>2]|0,(S|0)<0){x=5;break e}if(!S)m=59;else{L=_,m=0,M=f[L>>2]|0,L=f[L+4>>2]|0;do M=Ls(M,L)|0,L=_e()|0,$e=_,f[$e>>2]=M,f[$e+4>>2]=L,m=m+1|0;while((m|0)<(S|0));m=58}}else m=58;while(0);if((m|0)==58&&O&&(m=59),(m|0)==59&&($e=_,(Ni(f[$e>>2]|0,f[$e+4>>2]|0)|0)==1)){x=9;break}$e=_,Ke=f[$e>>2]|0,$e=f[$e+4>>2]&-1040385,We=ye(x|0,0,45)|0,$e=$e|(_e()|0),x=_,f[x>>2]=Ke|We,f[x+4>>2]=$e,x=0}else x=1;while(0);return $e=x,de=Be,$e|0}function F1(d,A,m,_,x,S){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0,S=S|0;var M=0,L=0;return L=de,de=de+16|0,M=L,x?d=15:(d=Rs(d,A,m,_,M)|0,d||(_0(M,S),d=0)),de=L,d|0}function Qu(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0;return M=de,de=de+16|0,S=M,_?m=15:(m=gc(m,S)|0,m||(m=Tc(d,A,S,x)|0)),de=M,m|0}function Sc(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0;return O=de,de=de+32|0,M=O+12|0,L=O,S=Rs(d,A,d,A,M)|0,S|0?(L=S,de=O,L|0):(d=Rs(d,A,m,_,L)|0,d|0?(L=d,de=O,L|0):(M=fl(M,L)|0,L=x,f[L>>2]=M,f[L+4>>2]=((M|0)<0)<<31>>31,L=0,de=O,L|0))}function Cc(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0;return O=de,de=de+32|0,M=O+12|0,L=O,S=Rs(d,A,d,A,M)|0,!S&&(S=Rs(d,A,m,_,L)|0,!S)?(_=fl(M,L)|0,_=P(_|0,((_|0)<0)<<31>>31|0,1,0)|0,M=_e()|0,L=x,f[L>>2]=_,f[L+4>>2]=M,L=0,de=O,L|0):(L=S,de=O,L|0)}function Pc(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0,Et=0,st=0,dt=0;if(st=de,de=de+48|0,M=st+24|0,L=st+12|0,Et=st,S=Rs(d,A,d,A,M)|0,!S&&(S=Rs(d,A,m,_,L)|0,!S)){Oe=fl(M,L)|0,It=((Oe|0)<0)<<31>>31,f[M>>2]=0,f[M+4>>2]=0,f[M+8>>2]=0,f[L>>2]=0,f[L+4>>2]=0,f[L+8>>2]=0,Rs(d,A,d,A,M)|0&&tn(23313,23090,691,23299),Rs(d,A,m,_,L)|0&&tn(23313,23090,696,23299),y0(M),y0(L),Oe?(Ae=f[M>>2]|0,Te=+(Oe|0),Ke=M+4|0,we=f[Ke>>2]|0,We=M+8|0,Re=f[We>>2]|0,$e=M,_=Ae,S=we,m=Re,Be=+((f[L>>2]|0)-Ae|0)/Te,tt=+((f[L+4>>2]|0)-we|0)/Te,Te=+((f[L+8>>2]|0)-Re|0)/Te):(S=M+4|0,m=M+8|0,Ke=S,We=m,$e=M,_=f[M>>2]|0,S=f[S>>2]|0,m=f[m>>2]|0,Be=0,tt=0,Te=0),f[Et>>2]=_,Re=Et+4|0,f[Re>>2]=S,we=Et+8|0,f[we>>2]=m;e:do if((Oe|0)<0)S=0;else for(ee=0,Ae=0,S=_;;){H=+(Ae>>>0)+4294967296*+(ee|0),dt=Be*H+ +(S|0),O=tt*H+ +(f[Ke>>2]|0),H=Te*H+ +(f[We>>2]|0),m=~~+Se(+dt),M=~~+Se(+O),S=~~+Se(+H),dt=+Me(+(+(m|0)-dt)),O=+Me(+(+(M|0)-O)),H=+Me(+(+(S|0)-H));do if(dt>O&dt>H)m=0-(M+S)|0,_=M;else if(L=0-m|0,O>H){_=L-S|0;break}else{_=M,S=L-M|0;break}while(0);if(f[Et>>2]=m,f[Re>>2]=_,f[we>>2]=S,Pa(Et),S=Tc(d,A,Et,x+(Ae<<3)|0)|0,S|0)break e;if(!((ee|0)<(It|0)|(ee|0)==(It|0)&Ae>>>0<Oe>>>0)){S=0;break e}S=P(Ae|0,ee|0,1,0)|0,L=_e()|0,ee=L,Ae=S,S=f[$e>>2]|0}while(0);return Et=S,de=st,Et|0}return Et=S,de=st,Et|0}function zs(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0;if((m|0)==0&(_|0)==0)return x=0,S=1,Vt(x|0),S|0;S=d,x=A,d=1,A=0;do M=(m&1|0)==0&!0,d=se((M?1:S)|0,(M?0:x)|0,d|0,A|0)|0,A=_e()|0,m=ve(m|0,_|0,1)|0,_=_e()|0,S=se(S|0,x|0,S|0,x|0)|0,x=_e()|0;while(!((m|0)==0&(_|0)==0));return Vt(A|0),d|0}function pr(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0;if(!(dc(A,m)|0)||(A=qn(A)|0,_=+W[m>>3],x=+W[m+8>>3],x=A&x<0?x+6.283185307179586:x,we=f[d>>2]|0,(we|0)<=0))return we=0,we|0;if(Ae=f[d+4>>2]|0,A){A=0,ee=x,m=-1,d=0;e:for(;;){for(H=d;M=+W[Ae+(H<<4)>>3],x=+W[Ae+(H<<4)+8>>3],d=(m+2|0)%(we|0)|0,S=+W[Ae+(d<<4)>>3],L=+W[Ae+(d<<4)+8>>3],M>S?(O=M,M=L):(O=S,S=M,M=x,x=L),_=_==S|_==O?_+2220446049250313e-31:_,!!(_<S|_>O);)if(m=H+1|0,(m|0)>=(we|0)){m=22;break e}else d=H,H=m,m=d;if(L=M<0?M+6.283185307179586:M,M=x<0?x+6.283185307179586:x,ee=L==ee|M==ee?ee+-2220446049250313e-31:ee,O=L+(M-L)*((_-S)/(O-S)),(O<0?O+6.283185307179586:O)>ee&&(A=A^1),d=H+1|0,(d|0)>=(we|0)){m=22;break}else m=H}if((m|0)==22)return A|0}else{A=0,ee=x,m=-1,d=0;e:for(;;){for(H=d;M=+W[Ae+(H<<4)>>3],x=+W[Ae+(H<<4)+8>>3],d=(m+2|0)%(we|0)|0,S=+W[Ae+(d<<4)>>3],L=+W[Ae+(d<<4)+8>>3],M>S?(O=M,M=L):(O=S,S=M,M=x,x=L),_=_==S|_==O?_+2220446049250313e-31:_,!!(_<S|_>O);)if(m=H+1|0,(m|0)>=(we|0)){m=22;break e}else d=H,H=m,m=d;if(ee=M==ee|x==ee?ee+-2220446049250313e-31:ee,M+(x-M)*((_-S)/(O-S))>ee&&(A=A^1),d=H+1|0,(d|0)>=(we|0)){m=22;break}else m=H}if((m|0)==22)return A|0}return 0}function Ys(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0;if(Te=f[d>>2]|0,!Te){f[A>>2]=0,f[A+4>>2]=0,f[A+8>>2]=0,f[A+12>>2]=0,f[A+16>>2]=0,f[A+20>>2]=0,f[A+24>>2]=0,f[A+28>>2]=0;return}if(Be=A+8|0,W[Be>>3]=17976931348623157e292,tt=A+24|0,W[tt>>3]=17976931348623157e292,W[A>>3]=-17976931348623157e292,Ke=A+16|0,W[Ke>>3]=-17976931348623157e292,!((Te|0)<=0)){for(we=f[d+4>>2]|0,H=17976931348623157e292,ee=-17976931348623157e292,Ae=0,d=-1,S=17976931348623157e292,M=17976931348623157e292,O=-17976931348623157e292,_=-17976931348623157e292,Re=0;m=+W[we+(Re<<4)>>3],L=+W[we+(Re<<4)+8>>3],d=d+2|0,x=+W[we+(((d|0)==(Te|0)?0:d)<<4)+8>>3],m<S&&(W[Be>>3]=m,S=m),L<M&&(W[tt>>3]=L,M=L),m>O?W[A>>3]=m:m=O,L>_&&(W[Ke>>3]=L,_=L),H=L>0&L<H?L:H,ee=L<0&L>ee?L:ee,Ae=Ae|+Me(+(L-x))>3.141592653589793,d=Re+1|0,(d|0)!=(Te|0);)We=Re,O=m,Re=d,d=We;Ae&&(W[Ke>>3]=ee,W[tt>>3]=H)}}function Yu(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0,Et=0,st=0;if(Te=f[d>>2]|0,Te){if(Be=A+8|0,W[Be>>3]=17976931348623157e292,tt=A+24|0,W[tt>>3]=17976931348623157e292,W[A>>3]=-17976931348623157e292,Ke=A+16|0,W[Ke>>3]=-17976931348623157e292,(Te|0)>0){for(x=f[d+4>>2]|0,we=17976931348623157e292,Re=-17976931348623157e292,_=0,m=-1,O=17976931348623157e292,H=17976931348623157e292,Ae=-17976931348623157e292,M=-17976931348623157e292,We=0;S=+W[x+(We<<4)>>3],ee=+W[x+(We<<4)+8>>3],Et=m+2|0,L=+W[x+(((Et|0)==(Te|0)?0:Et)<<4)+8>>3],S<O&&(W[Be>>3]=S,O=S),ee<H&&(W[tt>>3]=ee,H=ee),S>Ae?W[A>>3]=S:S=Ae,ee>M&&(W[Ke>>3]=ee,M=ee),we=ee>0&ee<we?ee:we,Re=ee<0&ee>Re?ee:Re,_=_|+Me(+(ee-L))>3.141592653589793,m=We+1|0,(m|0)!=(Te|0);)Et=We,Ae=S,We=m,m=Et;_&&(W[Ke>>3]=Re,W[tt>>3]=we)}}else f[A>>2]=0,f[A+4>>2]=0,f[A+8>>2]=0,f[A+12>>2]=0,f[A+16>>2]=0,f[A+20>>2]=0,f[A+24>>2]=0,f[A+28>>2]=0;if(Et=d+8|0,m=f[Et>>2]|0,!((m|0)<=0)){It=d+12|0,Oe=0;do if(x=f[It>>2]|0,_=Oe,Oe=Oe+1|0,tt=A+(Oe<<5)|0,Ke=f[x+(_<<3)>>2]|0,Ke){if(We=A+(Oe<<5)+8|0,W[We>>3]=17976931348623157e292,d=A+(Oe<<5)+24|0,W[d>>3]=17976931348623157e292,W[tt>>3]=-17976931348623157e292,$e=A+(Oe<<5)+16|0,W[$e>>3]=-17976931348623157e292,(Ke|0)>0){for(Te=f[x+(_<<3)+4>>2]|0,we=17976931348623157e292,Re=-17976931348623157e292,x=0,_=-1,Be=0,O=17976931348623157e292,H=17976931348623157e292,ee=-17976931348623157e292,M=-17976931348623157e292;S=+W[Te+(Be<<4)>>3],Ae=+W[Te+(Be<<4)+8>>3],_=_+2|0,L=+W[Te+(((_|0)==(Ke|0)?0:_)<<4)+8>>3],S<O&&(W[We>>3]=S,O=S),Ae<H&&(W[d>>3]=Ae,H=Ae),S>ee?W[tt>>3]=S:S=ee,Ae>M&&(W[$e>>3]=Ae,M=Ae),we=Ae>0&Ae<we?Ae:we,Re=Ae<0&Ae>Re?Ae:Re,x=x|+Me(+(Ae-L))>3.141592653589793,_=Be+1|0,(_|0)!=(Ke|0);)st=Be,Be=_,ee=S,_=st;x&&(W[$e>>3]=Re,W[d>>3]=we)}}else f[tt>>2]=0,f[tt+4>>2]=0,f[tt+8>>2]=0,f[tt+12>>2]=0,f[tt+16>>2]=0,f[tt+20>>2]=0,f[tt+24>>2]=0,f[tt+28>>2]=0,m=f[Et>>2]|0;while((Oe|0)<(m|0))}}function Fa(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if(!(pr(d,A,m)|0))return x=0,x|0;if(x=d+8|0,(f[x>>2]|0)<=0)return x=1,x|0;for(_=d+12|0,d=0;;){if(S=d,d=d+1|0,pr((f[_>>2]|0)+(S<<3)|0,A+(d<<5)|0,m)|0){d=0,_=6;break}if((d|0)>=(f[x>>2]|0)){d=1,_=6;break}}return(_|0)==6?d|0:0}function Mc(){return 8}function Tl(){return 16}function Ku(){return 168}function Zr(){return 8}function mi(){return 16}function Sl(){return 12}function S0(){return 8}function Ju(d){return d=d|0,+(+((f[d>>2]|0)>>>0)+4294967296*+(f[d+4>>2]|0))}function eh(d){d=d|0;var A=0,m=0;return m=+W[d>>3],A=+W[d+8>>3],+ +Ne(+(m*m+A*A))}function Ic(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0;H=+W[d>>3],O=+W[A>>3]-H,L=+W[d+8>>3],M=+W[A+8>>3]-L,Ae=+W[m>>3],S=+W[_>>3]-Ae,we=+W[m+8>>3],ee=+W[_+8>>3]-we,S=(S*(L-we)-(H-Ae)*ee)/(O*ee-M*S),W[x>>3]=H+O*S,W[x+8>>3]=L+M*S}function th(d,A){return d=d|0,A=A|0,+Me(+(+W[d>>3]-+W[A>>3]))<11920928955078125e-23?(A=+Me(+(+W[d+8>>3]-+W[A+8>>3]))<11920928955078125e-23,A|0):(A=0,A|0)}function si(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;return x=+W[d>>3]-+W[A>>3],_=+W[d+8>>3]-+W[A+8>>3],m=+W[d+16>>3]-+W[A+16>>3],+(x*x+_*_+m*m)}function Cl(d,A){d=d|0,A=A|0;var m=0,_=0,x=0;m=+W[d>>3],_=+Ve(+m),m=+ft(+m),W[A+16>>3]=m,m=+W[d+8>>3],x=_*+Ve(+m),W[A>>3]=x,m=_*+ft(+m),W[A+8>>3]=m}function Wt(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if(S=de,de=de+16|0,x=S,_=ri(d,A)|0,(m+-1|0)>>>0>5||(_=(_|0)!=0,(m|0)==1&_))return x=-1,de=S,x|0;do if(en(d,A,x)|0)_=-1;else if(_){_=((f[21936+(m<<2)>>2]|0)+5-(f[x>>2]|0)|0)%5|0;break}else{_=((f[21968+(m<<2)>>2]|0)+6-(f[x>>2]|0)|0)%6|0;break}while(0);return x=_,de=S,x|0}function en(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0,H=0;if(H=de,de=de+32|0,M=H+16|0,L=H,_=ds(d,A,M)|0,_|0)return m=_,de=H,m|0;S=ka(d,A)|0,O=Ni(d,A)|0,Iu(S,L),_=z1(S,f[M>>2]|0)|0;e:do if(On(S)|0){do switch(S|0){case 4:{d=0;break}case 14:{d=1;break}case 24:{d=2;break}case 38:{d=3;break}case 49:{d=4;break}case 58:{d=5;break}case 63:{d=6;break}case 72:{d=7;break}case 83:{d=8;break}case 97:{d=9;break}case 107:{d=10;break}case 117:{d=11;break}default:{_=1;break e}}while(0);if(x=f[22e3+(d*24|0)+8>>2]|0,A=f[22e3+(d*24|0)+16>>2]|0,d=f[M>>2]|0,(d|0)!=(f[L>>2]|0)&&(L=f0(S)|0,d=f[M>>2]|0,L|(d|0)==(A|0)&&(_=(_+1|0)%6|0)),(O|0)==3&(d|0)==(A|0)){_=(_+5|0)%6|0,x=22;break}(O|0)==5&(d|0)==(x|0)&&(_=(_+1|0)%6|0),x=22}else x=22;while(0);return(x|0)==22&&(f[m>>2]=_,_=0),m=_,de=H,m|0}function er(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0;if($e=de,de=de+32|0,We=$e+24|0,tt=$e+20|0,Te=$e+8|0,Re=$e+16|0,we=$e,O=(ri(d,A)|0)==0,O=O?6:5,ee=le(d|0,A|0,52)|0,_e()|0,ee=ee&15,O>>>0<=m>>>0)return _=2,de=$e,_|0;Ae=(ee|0)==0,!Ae&&(Be=ye(7,0,(ee^15)*3|0)|0,(Be&d|0)==0&((_e()|0)&A|0)==0)?x=m:S=4;e:do if((S|0)==4){if(x=(ri(d,A)|0)!=0,((x?4:5)|0)<(m|0)||en(d,A,We)|0||(S=(f[We>>2]|0)+m|0,x?x=22288+(((S|0)%5|0)<<2)|0:x=22320+(((S|0)%6|0)<<2)|0,Be=f[x>>2]|0,(Be|0)==7))return _=1,de=$e,_|0;f[tt>>2]=0,x=Ie(d,A,Be,tt,Te)|0;do if(!x){if(L=Te,H=f[L>>2]|0,L=f[L+4>>2]|0,M=L>>>0<A>>>0|(L|0)==(A|0)&H>>>0<d>>>0,S=M?H:d,M=M?L:A,!Ae&&(Ae=ye(7,0,(ee^15)*3|0)|0,(H&Ae|0)==0&(L&(_e()|0)|0)==0))x=m;else{if(L=(m+-1+O|0)%(O|0)|0,x=ri(d,A)|0,(L|0)<0&&tn(23313,23315,245,23324),O=(x|0)!=0,((O?4:5)|0)<(L|0)&&tn(23313,23315,245,23324),en(d,A,We)|0&&tn(23313,23315,245,23324),x=(f[We>>2]|0)+L|0,O?x=22288+(((x|0)%5|0)<<2)|0:x=22320+(((x|0)%6|0)<<2)|0,L=f[x>>2]|0,(L|0)==7&&tn(23313,23315,245,23324),f[Re>>2]=0,x=Ie(d,A,L,Re,we)|0,x|0)break;H=we,O=f[H>>2]|0,H=f[H+4>>2]|0;do if(H>>>0<M>>>0|(H|0)==(M|0)&O>>>0<S>>>0){if(ri(O,H)|0?S=Qe(O,H,d,A)|0:S=f[22384+((((f[Re>>2]|0)+(f[22352+(L<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,x=ri(O,H)|0,(S+-1|0)>>>0>5){x=-1,S=O,M=H;break}if(x=(x|0)!=0,(S|0)==1&x){x=-1,S=O,M=H;break}do if(en(O,H,We)|0)x=-1;else if(x){x=((f[21936+(S<<2)>>2]|0)+5-(f[We>>2]|0)|0)%5|0;break}else{x=((f[21968+(S<<2)>>2]|0)+6-(f[We>>2]|0)|0)%6|0;break}while(0);S=O,M=H}else x=m;while(0);L=Te,H=f[L>>2]|0,L=f[L+4>>2]|0}if((S|0)==(H|0)&(M|0)==(L|0)){if(O=(ri(H,L)|0)!=0,O?d=Qe(H,L,d,A)|0:d=f[22384+((((f[tt>>2]|0)+(f[22352+(Be<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,x=ri(H,L)|0,(d+-1|0)>>>0<=5&&(Ke=(x|0)!=0,!((d|0)==1&Ke)))do if(en(H,L,We)|0)x=-1;else if(Ke){x=((f[21936+(d<<2)>>2]|0)+5-(f[We>>2]|0)|0)%5|0;break}else{x=((f[21968+(d<<2)>>2]|0)+6-(f[We>>2]|0)|0)%6|0;break}while(0);else x=-1;x=x+1|0,x=(x|0)==6|O&(x|0)==5?0:x}A=M,d=S;break e}while(0);return _=x,de=$e,_|0}while(0);return Ke=ye(x|0,0,56)|0,We=_e()|0|A&-2130706433|536870912,f[_>>2]=Ke|d,f[_+4>>2]=We,_=0,de=$e,_|0}function kc(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;return S=(ri(d,A)|0)==0,_=er(d,A,0,m)|0,x=(_|0)==0,S?!x||(_=er(d,A,1,m+8|0)|0,_|0)||(_=er(d,A,2,m+16|0)|0,_|0)||(_=er(d,A,3,m+24|0)|0,_|0)||(_=er(d,A,4,m+32|0)|0,_)?(S=_,S|0):er(d,A,5,m+40|0)|0:!x||(_=er(d,A,1,m+8|0)|0,_|0)||(_=er(d,A,2,m+16|0)|0,_|0)||(_=er(d,A,3,m+24|0)|0,_|0)||(_=er(d,A,4,m+32|0)|0,_|0)?(S=_,S|0):(S=m+40|0,f[S>>2]=0,f[S+4>>2]=0,S=0,S|0)}function Co(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0,L=0,O=0;return O=de,de=de+192|0,x=O,S=O+168|0,M=le(d|0,A|0,56)|0,_e()|0,M=M&7,L=A&-2130706433|134217728,_=ds(d,L,S)|0,_|0?(L=_,de=O,L|0):(A=le(d|0,A|0,52)|0,_e()|0,A=A&15,ri(d,L)|0?Eo(S,A,M,1,x):_c(S,A,M,1,x),L=x+8|0,f[m>>2]=f[L>>2],f[m+4>>2]=f[L+4>>2],f[m+8>>2]=f[L+8>>2],f[m+12>>2]=f[L+12>>2],L=0,de=O,L|0)}function tr(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return x=de,de=de+16|0,m=x,!(!0&(A&2013265920|0)==536870912)||(_=A&-2130706433|134217728,!(Xo(d,_)|0))?(_=0,de=x,_|0):(S=le(d|0,A|0,56)|0,_e()|0,S=(er(d,_,S&7,m)|0)==0,_=m,_=S&((f[_>>2]|0)==(d|0)?(f[_+4>>2]|0)==(A|0):0)&1,de=x,_|0)}function Ks(d,A,m){d=d|0,A=A|0,m=m|0;var _=0;(A|0)>0?(_=E(A,4)|0,f[d>>2]=_,_||tn(23337,23360,40,23374)):f[d>>2]=0,f[d+4>>2]=A,f[d+8>>2]=0,f[d+12>>2]=m}function ms(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0;x=d+4|0,S=d+12|0,M=d+8|0;e:for(;;){for(m=f[x>>2]|0,A=0;;){if((A|0)>=(m|0))break e;if(_=f[d>>2]|0,L=f[_+(A<<2)>>2]|0,!L)A=A+1|0;else break}A=_+(~~(+Me(+(+rt(10,+ +(15-(f[S>>2]|0)|0))*(+W[L>>3]+ +W[L+8>>3])))%+(m|0))>>>0<<2)|0,m=f[A>>2]|0;t:do if(m|0){if(_=L+32|0,(m|0)==(L|0))f[A>>2]=f[_>>2];else{if(m=m+32|0,A=f[m>>2]|0,!A)break;for(;(A|0)!=(L|0);)if(m=A+32|0,A=f[m>>2]|0,!A)break t;f[m>>2]=f[_>>2]}v(L),f[M>>2]=(f[M>>2]|0)+-1}while(0)}v(f[d>>2]|0)}function Lc(d){d=d|0;var A=0,m=0,_=0;for(_=f[d+4>>2]|0,m=0;;){if((m|0)>=(_|0)){A=0,m=4;break}if(A=f[(f[d>>2]|0)+(m<<2)>>2]|0,!A)m=m+1|0;else{m=4;break}}return(m|0)==4?A|0:0}function Js(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;if(m=~~(+Me(+(+rt(10,+ +(15-(f[d+12>>2]|0)|0))*(+W[A>>3]+ +W[A+8>>3])))%+(f[d+4>>2]|0))>>>0,m=(f[d>>2]|0)+(m<<2)|0,_=f[m>>2]|0,!_)return S=1,S|0;S=A+32|0;do if((_|0)!=(A|0)){if(m=f[_+32>>2]|0,!m)return S=1,S|0;for(x=m;;){if((x|0)==(A|0)){x=8;break}if(m=f[x+32>>2]|0,m)_=x,x=m;else{m=1,x=10;break}}if((x|0)==8){f[_+32>>2]=f[S>>2];break}else if((x|0)==10)return m|0}else f[m>>2]=f[S>>2];while(0);return v(A),S=d+8|0,f[S>>2]=(f[S>>2]|0)+-1,S=0,S|0}function Ei(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0;S=p(40)|0,S||tn(23390,23360,98,23403),f[S>>2]=f[A>>2],f[S+4>>2]=f[A+4>>2],f[S+8>>2]=f[A+8>>2],f[S+12>>2]=f[A+12>>2],x=S+16|0,f[x>>2]=f[m>>2],f[x+4>>2]=f[m+4>>2],f[x+8>>2]=f[m+8>>2],f[x+12>>2]=f[m+12>>2],f[S+32>>2]=0,x=~~(+Me(+(+rt(10,+ +(15-(f[d+12>>2]|0)|0))*(+W[A>>3]+ +W[A+8>>3])))%+(f[d+4>>2]|0))>>>0,x=(f[d>>2]|0)+(x<<2)|0,_=f[x>>2]|0;do if(!_)f[x>>2]=S;else{for(;!(Ds(_,A)|0&&Ds(_+16|0,m)|0);)if(x=f[_+32>>2]|0,_=x|0?x:_,!(f[_+32>>2]|0)){M=10;break}if((M|0)==10){f[_+32>>2]=S;break}return v(S),M=_,M|0}while(0);return M=d+8|0,f[M>>2]=(f[M>>2]|0)+1,M=S,M|0}function Bi(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0;if(x=~~(+Me(+(+rt(10,+ +(15-(f[d+12>>2]|0)|0))*(+W[A>>3]+ +W[A+8>>3])))%+(f[d+4>>2]|0))>>>0,x=f[(f[d>>2]|0)+(x<<2)>>2]|0,!x)return m=0,m|0;if(!m){for(d=x;;){if(Ds(d,A)|0){_=10;break}if(d=f[d+32>>2]|0,!d){d=0,_=10;break}}if((_|0)==10)return d|0}for(d=x;;){if(Ds(d,A)|0&&Ds(d+16|0,m)|0){_=10;break}if(d=f[d+32>>2]|0,!d){d=0,_=10;break}}return(_|0)==10?d|0:0}function Dc(d,A){d=d|0,A=A|0;var m=0;if(m=~~(+Me(+(+rt(10,+ +(15-(f[d+12>>2]|0)|0))*(+W[A>>3]+ +W[A+8>>3])))%+(f[d+4>>2]|0))>>>0,d=f[(f[d>>2]|0)+(m<<2)>>2]|0,!d)return m=0,m|0;for(;;){if(Ds(d,A)|0){A=5;break}if(d=f[d+32>>2]|0,!d){d=0,A=5;break}}return(A|0)==5?d|0:0}function Jo(){return 23424}function b(d){return d=+d,+ +it(+d)}function l(d){return d=+d,~~+b(d)|0}function p(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0,Be=0,tt=0,Ke=0,We=0,$e=0,Oe=0,It=0;It=de,de=de+16|0,we=It;do if(d>>>0<245){if(H=d>>>0<11?16:d+11&-8,d=H>>>3,Ae=f[5857]|0,m=Ae>>>d,m&3|0)return A=(m&1^1)+d|0,d=23468+(A<<1<<2)|0,m=d+8|0,_=f[m>>2]|0,x=_+8|0,S=f[x>>2]|0,(S|0)==(d|0)?f[5857]=Ae&~(1<<A):(f[S+12>>2]=d,f[m>>2]=S),Oe=A<<3,f[_+4>>2]=Oe|3,Oe=_+Oe+4|0,f[Oe>>2]=f[Oe>>2]|1,Oe=x,de=It,Oe|0;if(ee=f[5859]|0,H>>>0>ee>>>0){if(m|0)return A=2<<d,A=m<<d&(A|0-A),A=(A&0-A)+-1|0,L=A>>>12&16,A=A>>>L,m=A>>>5&8,A=A>>>m,S=A>>>2&4,A=A>>>S,d=A>>>1&2,A=A>>>d,_=A>>>1&1,_=(m|L|S|d|_)+(A>>>_)|0,A=23468+(_<<1<<2)|0,d=A+8|0,S=f[d>>2]|0,L=S+8|0,m=f[L>>2]|0,(m|0)==(A|0)?(d=Ae&~(1<<_),f[5857]=d):(f[m+12>>2]=A,f[d>>2]=m,d=Ae),Oe=_<<3,M=Oe-H|0,f[S+4>>2]=H|3,x=S+H|0,f[x+4>>2]=M|1,f[S+Oe>>2]=M,ee|0&&(_=f[5862]|0,A=ee>>>3,m=23468+(A<<1<<2)|0,A=1<<A,d&A?(d=m+8|0,A=f[d>>2]|0):(f[5857]=d|A,A=m,d=m+8|0),f[d>>2]=_,f[A+12>>2]=_,f[_+8>>2]=A,f[_+12>>2]=m),f[5859]=M,f[5862]=x,Oe=L,de=It,Oe|0;if(S=f[5858]|0,S){for(m=(S&0-S)+-1|0,x=m>>>12&16,m=m>>>x,_=m>>>5&8,m=m>>>_,M=m>>>2&4,m=m>>>M,L=m>>>1&2,m=m>>>L,O=m>>>1&1,O=f[23732+((_|x|M|L|O)+(m>>>O)<<2)>>2]|0,m=O,L=O,O=(f[O+4>>2]&-8)-H|0;d=f[m+16>>2]|0,!(!d&&(d=f[m+20>>2]|0,!d));)M=(f[d+4>>2]&-8)-H|0,x=M>>>0<O>>>0,m=d,L=x?d:L,O=x?M:O;if(M=L+H|0,M>>>0>L>>>0){x=f[L+24>>2]|0,A=f[L+12>>2]|0;do if((A|0)==(L|0)){if(d=L+20|0,A=f[d>>2]|0,!A&&(d=L+16|0,A=f[d>>2]|0,!A)){m=0;break}for(;;)if(_=A+20|0,m=f[_>>2]|0,m)A=m,d=_;else if(_=A+16|0,m=f[_>>2]|0,m)A=m,d=_;else break;f[d>>2]=0,m=A}else m=f[L+8>>2]|0,f[m+12>>2]=A,f[A+8>>2]=m,m=A;while(0);do if(x|0){if(A=f[L+28>>2]|0,d=23732+(A<<2)|0,(L|0)==(f[d>>2]|0)){if(f[d>>2]=m,!m){f[5858]=S&~(1<<A);break}}else if(Oe=x+16|0,f[((f[Oe>>2]|0)==(L|0)?Oe:x+20|0)>>2]=m,!m)break;f[m+24>>2]=x,A=f[L+16>>2]|0,A|0&&(f[m+16>>2]=A,f[A+24>>2]=m),A=f[L+20>>2]|0,A|0&&(f[m+20>>2]=A,f[A+24>>2]=m)}while(0);return O>>>0<16?(Oe=O+H|0,f[L+4>>2]=Oe|3,Oe=L+Oe+4|0,f[Oe>>2]=f[Oe>>2]|1):(f[L+4>>2]=H|3,f[M+4>>2]=O|1,f[M+O>>2]=O,ee|0&&(_=f[5862]|0,A=ee>>>3,m=23468+(A<<1<<2)|0,A=1<<A,A&Ae?(d=m+8|0,A=f[d>>2]|0):(f[5857]=A|Ae,A=m,d=m+8|0),f[d>>2]=_,f[A+12>>2]=_,f[_+8>>2]=A,f[_+12>>2]=m),f[5859]=O,f[5862]=M),Oe=L+8|0,de=It,Oe|0}else Ae=H}else Ae=H}else Ae=H}else if(d>>>0<=4294967231)if(d=d+11|0,H=d&-8,_=f[5858]|0,_){x=0-H|0,d=d>>>8,d?H>>>0>16777215?O=31:(Ae=(d+1048320|0)>>>16&8,Be=d<<Ae,L=(Be+520192|0)>>>16&4,Be=Be<<L,O=(Be+245760|0)>>>16&2,O=14-(L|Ae|O)+(Be<<O>>>15)|0,O=H>>>(O+7|0)&1|O<<1):O=0,m=f[23732+(O<<2)>>2]|0;e:do if(!m)m=0,d=0,Be=61;else for(d=0,L=H<<((O|0)==31?0:25-(O>>>1)|0),S=0;;){if(M=(f[m+4>>2]&-8)-H|0,M>>>0<x>>>0)if(M)d=m,x=M;else{d=m,x=0,Be=65;break e}if(Be=f[m+20>>2]|0,m=f[m+16+(L>>>31<<2)>>2]|0,S=(Be|0)==0|(Be|0)==(m|0)?S:Be,m)L=L<<1;else{m=S,Be=61;break}}while(0);if((Be|0)==61){if((m|0)==0&(d|0)==0){if(d=2<<O,d=(d|0-d)&_,!d){Ae=H;break}Ae=(d&0-d)+-1|0,M=Ae>>>12&16,Ae=Ae>>>M,S=Ae>>>5&8,Ae=Ae>>>S,L=Ae>>>2&4,Ae=Ae>>>L,O=Ae>>>1&2,Ae=Ae>>>O,m=Ae>>>1&1,d=0,m=f[23732+((S|M|L|O|m)+(Ae>>>m)<<2)>>2]|0}m?Be=65:(L=d,M=x)}if((Be|0)==65)for(S=m;;)if(Ae=(f[S+4>>2]&-8)-H|0,m=Ae>>>0<x>>>0,x=m?Ae:x,d=m?S:d,m=f[S+16>>2]|0,m||(m=f[S+20>>2]|0),m)S=m;else{L=d,M=x;break}if(L|0&&M>>>0<((f[5859]|0)-H|0)>>>0&&(ee=L+H|0,ee>>>0>L>>>0)){S=f[L+24>>2]|0,A=f[L+12>>2]|0;do if((A|0)==(L|0)){if(d=L+20|0,A=f[d>>2]|0,!A&&(d=L+16|0,A=f[d>>2]|0,!A)){A=0;break}for(;;)if(x=A+20|0,m=f[x>>2]|0,m)A=m,d=x;else if(x=A+16|0,m=f[x>>2]|0,m)A=m,d=x;else break;f[d>>2]=0}else Oe=f[L+8>>2]|0,f[Oe+12>>2]=A,f[A+8>>2]=Oe;while(0);do if(S){if(d=f[L+28>>2]|0,m=23732+(d<<2)|0,(L|0)==(f[m>>2]|0)){if(f[m>>2]=A,!A){_=_&~(1<<d),f[5858]=_;break}}else if(Oe=S+16|0,f[((f[Oe>>2]|0)==(L|0)?Oe:S+20|0)>>2]=A,!A)break;f[A+24>>2]=S,d=f[L+16>>2]|0,d|0&&(f[A+16>>2]=d,f[d+24>>2]=A),d=f[L+20>>2]|0,d&&(f[A+20>>2]=d,f[d+24>>2]=A)}while(0);e:do if(M>>>0<16)Oe=M+H|0,f[L+4>>2]=Oe|3,Oe=L+Oe+4|0,f[Oe>>2]=f[Oe>>2]|1;else{if(f[L+4>>2]=H|3,f[ee+4>>2]=M|1,f[ee+M>>2]=M,A=M>>>3,M>>>0<256){m=23468+(A<<1<<2)|0,d=f[5857]|0,A=1<<A,d&A?(d=m+8|0,A=f[d>>2]|0):(f[5857]=d|A,A=m,d=m+8|0),f[d>>2]=ee,f[A+12>>2]=ee,f[ee+8>>2]=A,f[ee+12>>2]=m;break}if(A=M>>>8,A?M>>>0>16777215?m=31:($e=(A+1048320|0)>>>16&8,Oe=A<<$e,We=(Oe+520192|0)>>>16&4,Oe=Oe<<We,m=(Oe+245760|0)>>>16&2,m=14-(We|$e|m)+(Oe<<m>>>15)|0,m=M>>>(m+7|0)&1|m<<1):m=0,A=23732+(m<<2)|0,f[ee+28>>2]=m,d=ee+16|0,f[d+4>>2]=0,f[d>>2]=0,d=1<<m,!(_&d)){f[5858]=_|d,f[A>>2]=ee,f[ee+24>>2]=A,f[ee+12>>2]=ee,f[ee+8>>2]=ee;break}A=f[A>>2]|0;t:do if((f[A+4>>2]&-8|0)!=(M|0)){for(_=M<<((m|0)==31?0:25-(m>>>1)|0);m=A+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(M|0)){A=d;break t}else _=_<<1,A=d;f[m>>2]=ee,f[ee+24>>2]=A,f[ee+12>>2]=ee,f[ee+8>>2]=ee;break e}while(0);$e=A+8|0,Oe=f[$e>>2]|0,f[Oe+12>>2]=ee,f[$e>>2]=ee,f[ee+8>>2]=Oe,f[ee+12>>2]=A,f[ee+24>>2]=0}while(0);return Oe=L+8|0,de=It,Oe|0}else Ae=H}else Ae=H;else Ae=-1;while(0);if(m=f[5859]|0,m>>>0>=Ae>>>0)return A=m-Ae|0,d=f[5862]|0,A>>>0>15?(Oe=d+Ae|0,f[5862]=Oe,f[5859]=A,f[Oe+4>>2]=A|1,f[d+m>>2]=A,f[d+4>>2]=Ae|3):(f[5859]=0,f[5862]=0,f[d+4>>2]=m|3,Oe=d+m+4|0,f[Oe>>2]=f[Oe>>2]|1),Oe=d+8|0,de=It,Oe|0;if(M=f[5860]|0,M>>>0>Ae>>>0)return We=M-Ae|0,f[5860]=We,Oe=f[5863]|0,$e=Oe+Ae|0,f[5863]=$e,f[$e+4>>2]=We|1,f[Oe+4>>2]=Ae|3,Oe=Oe+8|0,de=It,Oe|0;if(f[5975]|0?d=f[5977]|0:(f[5977]=4096,f[5976]=4096,f[5978]=-1,f[5979]=-1,f[5980]=0,f[5968]=0,f[5975]=we&-16^1431655768,d=4096),L=Ae+48|0,O=Ae+47|0,S=d+O|0,x=0-d|0,H=S&x,H>>>0<=Ae>>>0||(d=f[5967]|0,d|0&&(ee=f[5965]|0,we=ee+H|0,we>>>0<=ee>>>0|we>>>0>d>>>0)))return Oe=0,de=It,Oe|0;e:do if(f[5968]&4)A=0,Be=143;else{m=f[5863]|0;t:do if(m){for(_=23876;we=f[_>>2]|0,!(we>>>0<=m>>>0&&(we+(f[_+4>>2]|0)|0)>>>0>m>>>0);)if(d=f[_+8>>2]|0,d)_=d;else{Be=128;break t}if(A=S-M&x,A>>>0<2147483647)if(d=Je(A|0)|0,(d|0)==((f[_>>2]|0)+(f[_+4>>2]|0)|0)){if((d|0)!=-1){M=A,S=d,Be=145;break e}}else _=d,Be=136;else A=0}else Be=128;while(0);do if((Be|0)==128)if(m=Je(0)|0,(m|0)!=-1&&(A=m,Re=f[5976]|0,Te=Re+-1|0,A=(Te&A|0?(Te+A&0-Re)-A|0:0)+H|0,Re=f[5965]|0,Te=A+Re|0,A>>>0>Ae>>>0&A>>>0<2147483647)){if(we=f[5967]|0,we|0&&Te>>>0<=Re>>>0|Te>>>0>we>>>0){A=0;break}if(d=Je(A|0)|0,(d|0)==(m|0)){M=A,S=m,Be=145;break e}else _=d,Be=136}else A=0;while(0);do if((Be|0)==136){if(m=0-A|0,!(L>>>0>A>>>0&(A>>>0<2147483647&(_|0)!=-1)))if((_|0)==-1){A=0;break}else{M=A,S=_,Be=145;break e}if(d=f[5977]|0,d=O-A+d&0-d,d>>>0>=2147483647){M=A,S=_,Be=145;break e}if((Je(d|0)|0)==-1){Je(m|0)|0,A=0;break}else{M=d+A|0,S=_,Be=145;break e}}while(0);f[5968]=f[5968]|4,Be=143}while(0);if((Be|0)==143&&H>>>0<2147483647&&(We=Je(H|0)|0,Te=Je(0)|0,tt=Te-We|0,Ke=tt>>>0>(Ae+40|0)>>>0,!((We|0)==-1|Ke^1|We>>>0<Te>>>0&((We|0)!=-1&(Te|0)!=-1)^1))&&(M=Ke?tt:A,S=We,Be=145),(Be|0)==145){A=(f[5965]|0)+M|0,f[5965]=A,A>>>0>(f[5966]|0)>>>0&&(f[5966]=A),O=f[5863]|0;e:do if(O){for(A=23876;;){if(d=f[A>>2]|0,m=f[A+4>>2]|0,(S|0)==(d+m|0)){Be=154;break}if(_=f[A+8>>2]|0,_)A=_;else break}if((Be|0)==154&&($e=A+4|0,(f[A+12>>2]&8|0)==0)&&S>>>0>O>>>0&d>>>0<=O>>>0){f[$e>>2]=m+M,Oe=(f[5860]|0)+M|0,We=O+8|0,We=We&7|0?0-We&7:0,$e=O+We|0,We=Oe-We|0,f[5863]=$e,f[5860]=We,f[$e+4>>2]=We|1,f[O+Oe+4>>2]=40,f[5864]=f[5979];break}for(S>>>0<(f[5861]|0)>>>0&&(f[5861]=S),m=S+M|0,A=23876;;){if((f[A>>2]|0)==(m|0)){Be=162;break}if(d=f[A+8>>2]|0,d)A=d;else break}if((Be|0)==162&&!(f[A+12>>2]&8|0)){f[A>>2]=S,ee=A+4|0,f[ee>>2]=(f[ee>>2]|0)+M,ee=S+8|0,ee=S+(ee&7|0?0-ee&7:0)|0,A=m+8|0,A=m+(A&7|0?0-A&7:0)|0,H=ee+Ae|0,L=A-ee-Ae|0,f[ee+4>>2]=Ae|3;t:do if((O|0)==(A|0))Oe=(f[5860]|0)+L|0,f[5860]=Oe,f[5863]=H,f[H+4>>2]=Oe|1;else{if((f[5862]|0)==(A|0)){Oe=(f[5859]|0)+L|0,f[5859]=Oe,f[5862]=H,f[H+4>>2]=Oe|1,f[H+Oe>>2]=Oe;break}if(d=f[A+4>>2]|0,(d&3|0)==1){M=d&-8,_=d>>>3;n:do if(d>>>0<256)if(d=f[A+8>>2]|0,m=f[A+12>>2]|0,(m|0)==(d|0)){f[5857]=f[5857]&~(1<<_);break}else{f[d+12>>2]=m,f[m+8>>2]=d;break}else{S=f[A+24>>2]|0,d=f[A+12>>2]|0;do if((d|0)==(A|0)){if(m=A+16|0,_=m+4|0,d=f[_>>2]|0,d)m=_;else if(d=f[m>>2]|0,!d){d=0;break}for(;;)if(x=d+20|0,_=f[x>>2]|0,_)d=_,m=x;else if(x=d+16|0,_=f[x>>2]|0,_)d=_,m=x;else break;f[m>>2]=0}else Oe=f[A+8>>2]|0,f[Oe+12>>2]=d,f[d+8>>2]=Oe;while(0);if(!S)break;m=f[A+28>>2]|0,_=23732+(m<<2)|0;do if((f[_>>2]|0)!=(A|0)){if(Oe=S+16|0,f[((f[Oe>>2]|0)==(A|0)?Oe:S+20|0)>>2]=d,!d)break n}else{if(f[_>>2]=d,d|0)break;f[5858]=f[5858]&~(1<<m);break n}while(0);if(f[d+24>>2]=S,m=A+16|0,_=f[m>>2]|0,_|0&&(f[d+16>>2]=_,f[_+24>>2]=d),m=f[m+4>>2]|0,!m)break;f[d+20>>2]=m,f[m+24>>2]=d}while(0);A=A+M|0,x=M+L|0}else x=L;if(A=A+4|0,f[A>>2]=f[A>>2]&-2,f[H+4>>2]=x|1,f[H+x>>2]=x,A=x>>>3,x>>>0<256){m=23468+(A<<1<<2)|0,d=f[5857]|0,A=1<<A,d&A?(d=m+8|0,A=f[d>>2]|0):(f[5857]=d|A,A=m,d=m+8|0),f[d>>2]=H,f[A+12>>2]=H,f[H+8>>2]=A,f[H+12>>2]=m;break}A=x>>>8;do if(!A)_=0;else{if(x>>>0>16777215){_=31;break}$e=(A+1048320|0)>>>16&8,Oe=A<<$e,We=(Oe+520192|0)>>>16&4,Oe=Oe<<We,_=(Oe+245760|0)>>>16&2,_=14-(We|$e|_)+(Oe<<_>>>15)|0,_=x>>>(_+7|0)&1|_<<1}while(0);if(A=23732+(_<<2)|0,f[H+28>>2]=_,d=H+16|0,f[d+4>>2]=0,f[d>>2]=0,d=f[5858]|0,m=1<<_,!(d&m)){f[5858]=d|m,f[A>>2]=H,f[H+24>>2]=A,f[H+12>>2]=H,f[H+8>>2]=H;break}A=f[A>>2]|0;n:do if((f[A+4>>2]&-8|0)!=(x|0)){for(_=x<<((_|0)==31?0:25-(_>>>1)|0);m=A+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(x|0)){A=d;break n}else _=_<<1,A=d;f[m>>2]=H,f[H+24>>2]=A,f[H+12>>2]=H,f[H+8>>2]=H;break t}while(0);$e=A+8|0,Oe=f[$e>>2]|0,f[Oe+12>>2]=H,f[$e>>2]=H,f[H+8>>2]=Oe,f[H+12>>2]=A,f[H+24>>2]=0}while(0);return Oe=ee+8|0,de=It,Oe|0}for(A=23876;d=f[A>>2]|0,!(d>>>0<=O>>>0&&(Oe=d+(f[A+4>>2]|0)|0,Oe>>>0>O>>>0));)A=f[A+8>>2]|0;x=Oe+-47|0,d=x+8|0,d=x+(d&7|0?0-d&7:0)|0,x=O+16|0,d=d>>>0<x>>>0?O:d,A=d+8|0,m=M+-40|0,We=S+8|0,We=We&7|0?0-We&7:0,$e=S+We|0,We=m-We|0,f[5863]=$e,f[5860]=We,f[$e+4>>2]=We|1,f[S+m+4>>2]=40,f[5864]=f[5979],m=d+4|0,f[m>>2]=27,f[A>>2]=f[5969],f[A+4>>2]=f[5970],f[A+8>>2]=f[5971],f[A+12>>2]=f[5972],f[5969]=S,f[5970]=M,f[5972]=0,f[5971]=A,A=d+24|0;do $e=A,A=A+4|0,f[A>>2]=7;while(($e+8|0)>>>0<Oe>>>0);if((d|0)!=(O|0)){if(S=d-O|0,f[m>>2]=f[m>>2]&-2,f[O+4>>2]=S|1,f[d>>2]=S,A=S>>>3,S>>>0<256){m=23468+(A<<1<<2)|0,d=f[5857]|0,A=1<<A,d&A?(d=m+8|0,A=f[d>>2]|0):(f[5857]=d|A,A=m,d=m+8|0),f[d>>2]=O,f[A+12>>2]=O,f[O+8>>2]=A,f[O+12>>2]=m;break}if(A=S>>>8,A?S>>>0>16777215?_=31:($e=(A+1048320|0)>>>16&8,Oe=A<<$e,We=(Oe+520192|0)>>>16&4,Oe=Oe<<We,_=(Oe+245760|0)>>>16&2,_=14-(We|$e|_)+(Oe<<_>>>15)|0,_=S>>>(_+7|0)&1|_<<1):_=0,m=23732+(_<<2)|0,f[O+28>>2]=_,f[O+20>>2]=0,f[x>>2]=0,A=f[5858]|0,d=1<<_,!(A&d)){f[5858]=A|d,f[m>>2]=O,f[O+24>>2]=m,f[O+12>>2]=O,f[O+8>>2]=O;break}A=f[m>>2]|0;t:do if((f[A+4>>2]&-8|0)!=(S|0)){for(_=S<<((_|0)==31?0:25-(_>>>1)|0);m=A+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(S|0)){A=d;break t}else _=_<<1,A=d;f[m>>2]=O,f[O+24>>2]=A,f[O+12>>2]=O,f[O+8>>2]=O;break e}while(0);$e=A+8|0,Oe=f[$e>>2]|0,f[Oe+12>>2]=O,f[$e>>2]=O,f[O+8>>2]=Oe,f[O+12>>2]=A,f[O+24>>2]=0}}else Oe=f[5861]|0,(Oe|0)==0|S>>>0<Oe>>>0&&(f[5861]=S),f[5969]=S,f[5970]=M,f[5972]=0,f[5866]=f[5975],f[5865]=-1,f[5870]=23468,f[5869]=23468,f[5872]=23476,f[5871]=23476,f[5874]=23484,f[5873]=23484,f[5876]=23492,f[5875]=23492,f[5878]=23500,f[5877]=23500,f[5880]=23508,f[5879]=23508,f[5882]=23516,f[5881]=23516,f[5884]=23524,f[5883]=23524,f[5886]=23532,f[5885]=23532,f[5888]=23540,f[5887]=23540,f[5890]=23548,f[5889]=23548,f[5892]=23556,f[5891]=23556,f[5894]=23564,f[5893]=23564,f[5896]=23572,f[5895]=23572,f[5898]=23580,f[5897]=23580,f[5900]=23588,f[5899]=23588,f[5902]=23596,f[5901]=23596,f[5904]=23604,f[5903]=23604,f[5906]=23612,f[5905]=23612,f[5908]=23620,f[5907]=23620,f[5910]=23628,f[5909]=23628,f[5912]=23636,f[5911]=23636,f[5914]=23644,f[5913]=23644,f[5916]=23652,f[5915]=23652,f[5918]=23660,f[5917]=23660,f[5920]=23668,f[5919]=23668,f[5922]=23676,f[5921]=23676,f[5924]=23684,f[5923]=23684,f[5926]=23692,f[5925]=23692,f[5928]=23700,f[5927]=23700,f[5930]=23708,f[5929]=23708,f[5932]=23716,f[5931]=23716,Oe=M+-40|0,We=S+8|0,We=We&7|0?0-We&7:0,$e=S+We|0,We=Oe-We|0,f[5863]=$e,f[5860]=We,f[$e+4>>2]=We|1,f[S+Oe+4>>2]=40,f[5864]=f[5979];while(0);if(A=f[5860]|0,A>>>0>Ae>>>0)return We=A-Ae|0,f[5860]=We,Oe=f[5863]|0,$e=Oe+Ae|0,f[5863]=$e,f[$e+4>>2]=We|1,f[Oe+4>>2]=Ae|3,Oe=Oe+8|0,de=It,Oe|0}return Oe=Jo()|0,f[Oe>>2]=12,Oe=0,de=It,Oe|0}function v(d){d=d|0;var A=0,m=0,_=0,x=0,S=0,M=0,L=0,O=0;if(d){m=d+-8|0,x=f[5861]|0,d=f[d+-4>>2]|0,A=d&-8,O=m+A|0;do if(d&1)L=m,M=m;else{if(_=f[m>>2]|0,!(d&3)||(M=m+(0-_)|0,S=_+A|0,M>>>0<x>>>0))return;if((f[5862]|0)==(M|0)){if(d=O+4|0,A=f[d>>2]|0,(A&3|0)!=3){L=M,A=S;break}f[5859]=S,f[d>>2]=A&-2,f[M+4>>2]=S|1,f[M+S>>2]=S;return}if(m=_>>>3,_>>>0<256)if(d=f[M+8>>2]|0,A=f[M+12>>2]|0,(A|0)==(d|0)){f[5857]=f[5857]&~(1<<m),L=M,A=S;break}else{f[d+12>>2]=A,f[A+8>>2]=d,L=M,A=S;break}x=f[M+24>>2]|0,d=f[M+12>>2]|0;do if((d|0)==(M|0)){if(A=M+16|0,m=A+4|0,d=f[m>>2]|0,d)A=m;else if(d=f[A>>2]|0,!d){d=0;break}for(;;)if(_=d+20|0,m=f[_>>2]|0,m)d=m,A=_;else if(_=d+16|0,m=f[_>>2]|0,m)d=m,A=_;else break;f[A>>2]=0}else L=f[M+8>>2]|0,f[L+12>>2]=d,f[d+8>>2]=L;while(0);if(x){if(A=f[M+28>>2]|0,m=23732+(A<<2)|0,(f[m>>2]|0)==(M|0)){if(f[m>>2]=d,!d){f[5858]=f[5858]&~(1<<A),L=M,A=S;break}}else if(L=x+16|0,f[((f[L>>2]|0)==(M|0)?L:x+20|0)>>2]=d,!d){L=M,A=S;break}f[d+24>>2]=x,A=M+16|0,m=f[A>>2]|0,m|0&&(f[d+16>>2]=m,f[m+24>>2]=d),A=f[A+4>>2]|0,A?(f[d+20>>2]=A,f[A+24>>2]=d,L=M,A=S):(L=M,A=S)}else L=M,A=S}while(0);if(!(M>>>0>=O>>>0)&&(d=O+4|0,_=f[d>>2]|0,!!(_&1))){if(_&2)f[d>>2]=_&-2,f[L+4>>2]=A|1,f[M+A>>2]=A,x=A;else{if((f[5863]|0)==(O|0)){if(O=(f[5860]|0)+A|0,f[5860]=O,f[5863]=L,f[L+4>>2]=O|1,(L|0)!=(f[5862]|0))return;f[5862]=0,f[5859]=0;return}if((f[5862]|0)==(O|0)){O=(f[5859]|0)+A|0,f[5859]=O,f[5862]=M,f[L+4>>2]=O|1,f[M+O>>2]=O;return}x=(_&-8)+A|0,m=_>>>3;do if(_>>>0<256)if(A=f[O+8>>2]|0,d=f[O+12>>2]|0,(d|0)==(A|0)){f[5857]=f[5857]&~(1<<m);break}else{f[A+12>>2]=d,f[d+8>>2]=A;break}else{S=f[O+24>>2]|0,d=f[O+12>>2]|0;do if((d|0)==(O|0)){if(A=O+16|0,m=A+4|0,d=f[m>>2]|0,d)A=m;else if(d=f[A>>2]|0,!d){m=0;break}for(;;)if(_=d+20|0,m=f[_>>2]|0,m)d=m,A=_;else if(_=d+16|0,m=f[_>>2]|0,m)d=m,A=_;else break;f[A>>2]=0,m=d}else m=f[O+8>>2]|0,f[m+12>>2]=d,f[d+8>>2]=m,m=d;while(0);if(S|0){if(d=f[O+28>>2]|0,A=23732+(d<<2)|0,(f[A>>2]|0)==(O|0)){if(f[A>>2]=m,!m){f[5858]=f[5858]&~(1<<d);break}}else if(_=S+16|0,f[((f[_>>2]|0)==(O|0)?_:S+20|0)>>2]=m,!m)break;f[m+24>>2]=S,d=O+16|0,A=f[d>>2]|0,A|0&&(f[m+16>>2]=A,f[A+24>>2]=m),d=f[d+4>>2]|0,d|0&&(f[m+20>>2]=d,f[d+24>>2]=m)}}while(0);if(f[L+4>>2]=x|1,f[M+x>>2]=x,(L|0)==(f[5862]|0)){f[5859]=x;return}}if(d=x>>>3,x>>>0<256){m=23468+(d<<1<<2)|0,A=f[5857]|0,d=1<<d,A&d?(A=m+8|0,d=f[A>>2]|0):(f[5857]=A|d,d=m,A=m+8|0),f[A>>2]=L,f[d+12>>2]=L,f[L+8>>2]=d,f[L+12>>2]=m;return}d=x>>>8,d?x>>>0>16777215?_=31:(M=(d+1048320|0)>>>16&8,O=d<<M,S=(O+520192|0)>>>16&4,O=O<<S,_=(O+245760|0)>>>16&2,_=14-(S|M|_)+(O<<_>>>15)|0,_=x>>>(_+7|0)&1|_<<1):_=0,d=23732+(_<<2)|0,f[L+28>>2]=_,f[L+20>>2]=0,f[L+16>>2]=0,A=f[5858]|0,m=1<<_;e:do if(!(A&m))f[5858]=A|m,f[d>>2]=L,f[L+24>>2]=d,f[L+12>>2]=L,f[L+8>>2]=L;else{d=f[d>>2]|0;t:do if((f[d+4>>2]&-8|0)!=(x|0)){for(_=x<<((_|0)==31?0:25-(_>>>1)|0);m=d+16+(_>>>31<<2)|0,A=f[m>>2]|0,!!A;)if((f[A+4>>2]&-8|0)==(x|0)){d=A;break t}else _=_<<1,d=A;f[m>>2]=L,f[L+24>>2]=d,f[L+12>>2]=L,f[L+8>>2]=L;break e}while(0);M=d+8|0,O=f[M>>2]|0,f[O+12>>2]=L,f[M>>2]=L,f[L+8>>2]=O,f[L+12>>2]=d,f[L+24>>2]=0}while(0);if(O=(f[5865]|0)+-1|0,f[5865]=O,!(O|0)){for(d=23884;d=f[d>>2]|0,d;)d=d+8|0;f[5865]=-1}}}}function E(d,A){d=d|0,A=A|0;var m=0;return d?(m=Kt(A,d)|0,(A|d)>>>0>65535&&(m=((m>>>0)/(d>>>0)|0|0)==(A|0)?m:-1)):m=0,d=p(m)|0,!d||!(f[d+-4>>2]&3)||He(d|0,0,m|0)|0,d|0}function P(d,A,m,_){return d=d|0,A=A|0,m=m|0,_=_|0,m=d+m>>>0,Vt(A+_+(m>>>0<d>>>0|0)>>>0|0),m|0|0}function z(d,A,m,_){return d=d|0,A=A|0,m=m|0,_=_|0,_=A-_-(m>>>0>d>>>0|0)>>>0,Vt(_|0),d-m>>>0|0|0}function N(d){return d=d|0,(d?31-(Wn(d^d-1)|0)|0:32)|0}function G(d,A,m,_,x){d=d|0,A=A|0,m=m|0,_=_|0,x=x|0;var S=0,M=0,L=0,O=0,H=0,ee=0,Ae=0,we=0,Re=0,Te=0;if(ee=d,O=A,H=O,M=m,we=_,L=we,!H)return S=(x|0)!=0,L?S?(f[x>>2]=d|0,f[x+4>>2]=A&0,we=0,x=0,Vt(we|0),x|0):(we=0,x=0,Vt(we|0),x|0):(S&&(f[x>>2]=(ee>>>0)%(M>>>0),f[x+4>>2]=0),we=0,x=(ee>>>0)/(M>>>0)>>>0,Vt(we|0),x|0);S=(L|0)==0;do if(M){if(!S){if(S=(Wn(L|0)|0)-(Wn(H|0)|0)|0,S>>>0<=31){Ae=S+1|0,L=31-S|0,A=S-31>>31,M=Ae,d=ee>>>(Ae>>>0)&A|H<<L,A=H>>>(Ae>>>0)&A,S=0,L=ee<<L;break}return x?(f[x>>2]=d|0,f[x+4>>2]=O|A&0,we=0,x=0,Vt(we|0),x|0):(we=0,x=0,Vt(we|0),x|0)}if(S=M-1|0,S&M|0){L=(Wn(M|0)|0)+33-(Wn(H|0)|0)|0,Te=64-L|0,Ae=32-L|0,O=Ae>>31,Re=L-32|0,A=Re>>31,M=L,d=Ae-1>>31&H>>>(Re>>>0)|(H<<Ae|ee>>>(L>>>0))&A,A=A&H>>>(L>>>0),S=ee<<Te&O,L=(H<<Te|ee>>>(Re>>>0))&O|ee<<Ae&L-33>>31;break}return x|0&&(f[x>>2]=S&ee,f[x+4>>2]=0),(M|0)==1?(Re=O|A&0,Te=d|0|0,Vt(Re|0),Te|0):(Te=N(M|0)|0,Re=H>>>(Te>>>0)|0,Te=H<<32-Te|ee>>>(Te>>>0)|0,Vt(Re|0),Te|0)}else{if(S)return x|0&&(f[x>>2]=(H>>>0)%(M>>>0),f[x+4>>2]=0),Re=0,Te=(H>>>0)/(M>>>0)>>>0,Vt(Re|0),Te|0;if(!ee)return x|0&&(f[x>>2]=0,f[x+4>>2]=(H>>>0)%(L>>>0)),Re=0,Te=(H>>>0)/(L>>>0)>>>0,Vt(Re|0),Te|0;if(S=L-1|0,!(S&L))return x|0&&(f[x>>2]=d|0,f[x+4>>2]=S&H|A&0),Re=0,Te=H>>>((N(L|0)|0)>>>0),Vt(Re|0),Te|0;if(S=(Wn(L|0)|0)-(Wn(H|0)|0)|0,S>>>0<=30){A=S+1|0,L=31-S|0,M=A,d=H<<L|ee>>>(A>>>0),A=H>>>(A>>>0),S=0,L=ee<<L;break}return x?(f[x>>2]=d|0,f[x+4>>2]=O|A&0,Re=0,Te=0,Vt(Re|0),Te|0):(Re=0,Te=0,Vt(Re|0),Te|0)}while(0);if(!M)H=L,O=0,L=0;else{Ae=m|0|0,ee=we|_&0,H=P(Ae|0,ee|0,-1,-1)|0,m=_e()|0,O=L,L=0;do _=O,O=S>>>31|O<<1,S=L|S<<1,_=d<<1|_>>>31|0,we=d>>>31|A<<1|0,z(H|0,m|0,_|0,we|0)|0,Te=_e()|0,Re=Te>>31|((Te|0)<0?-1:0)<<1,L=Re&1,d=z(_|0,we|0,Re&Ae|0,(((Te|0)<0?-1:0)>>31|((Te|0)<0?-1:0)<<1)&ee|0)|0,A=_e()|0,M=M-1|0;while(M|0);H=O,O=0}return M=0,x|0&&(f[x>>2]=d,f[x+4>>2]=A),Re=(S|0)>>>31|(H|M)<<1|(M<<1|S>>>31)&0|O,Te=(S<<1|0)&-2|L,Vt(Re|0),Te|0}function $(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0;return H=A>>31|((A|0)<0?-1:0)<<1,O=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,S=_>>31|((_|0)<0?-1:0)<<1,x=((_|0)<0?-1:0)>>31|((_|0)<0?-1:0)<<1,L=z(H^d|0,O^A|0,H|0,O|0)|0,M=_e()|0,d=S^H,A=x^O,z((G(L,M,z(S^m|0,x^_|0,S|0,x|0)|0,_e()|0,0)|0)^d|0,(_e()|0)^A|0,d|0,A|0)|0}function K(d,A){d=d|0,A=A|0;var m=0,_=0,x=0,S=0;return S=d&65535,x=A&65535,m=Kt(x,S)|0,_=d>>>16,d=(m>>>16)+(Kt(x,_)|0)|0,x=A>>>16,A=Kt(x,S)|0,Vt((d>>>16)+(Kt(x,_)|0)+(((d&65535)+A|0)>>>16)|0),d+A<<16|m&65535|0|0}function se(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0;return x=d,S=m,m=K(x,S)|0,d=_e()|0,Vt((Kt(A,S)|0)+(Kt(_,x)|0)+d|d&0|0),m|0|0|0}function ce(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0,M=0,L=0,O=0,H=0;return x=de,de=de+16|0,L=x|0,M=A>>31|((A|0)<0?-1:0)<<1,S=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,H=_>>31|((_|0)<0?-1:0)<<1,O=((_|0)<0?-1:0)>>31|((_|0)<0?-1:0)<<1,d=z(M^d|0,S^A|0,M|0,S|0)|0,A=_e()|0,G(d,A,z(H^m|0,O^_|0,H|0,O|0)|0,_e()|0,L)|0,_=z(f[L>>2]^M|0,f[L+4>>2]^S|0,M|0,S|0)|0,m=_e()|0,de=x,Vt(m|0),_|0}function xe(d,A,m,_){d=d|0,A=A|0,m=m|0,_=_|0;var x=0,S=0;return S=de,de=de+16|0,x=S|0,G(d,A,m,_,x)|0,de=S,Vt(f[x+4>>2]|0),f[x>>2]|0|0}function ve(d,A,m){return d=d|0,A=A|0,m=m|0,(m|0)<32?(Vt(A>>m|0),d>>>m|(A&(1<<m)-1)<<32-m):(Vt(((A|0)<0?-1:0)|0),A>>m-32|0)}function le(d,A,m){return d=d|0,A=A|0,m=m|0,(m|0)<32?(Vt(A>>>m|0),d>>>m|(A&(1<<m)-1)<<32-m):(Vt(0),A>>>m-32|0)}function ye(d,A,m){return d=d|0,A=A|0,m=m|0,(m|0)<32?(Vt(A<<m|(d&(1<<m)-1<<32-m)>>>32-m|0),d<<m):(Vt(d<<m-32|0),0)}function ze(d,A){return d=+d,A=+A,d!=d?+A:A!=A?+d:+Ln(+d,+A)}function je(d,A){return d=+d,A=+A,d!=d?+A:A!=A?+d:+wn(+d,+A)}function Se(d){return d=+d,d>=0?+Ee(d+.5):+$t(d-.5)}function Xe(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0;if((m|0)>=8192)return Ho(d|0,A|0,m|0)|0,d|0;if(S=d|0,x=d+m|0,(d&3)==(A&3)){for(;d&3;){if(!m)return S|0;oe[d>>0]=oe[A>>0]|0,d=d+1|0,A=A+1|0,m=m-1|0}for(m=x&-4|0,_=m-64|0;(d|0)<=(_|0);)f[d>>2]=f[A>>2],f[d+4>>2]=f[A+4>>2],f[d+8>>2]=f[A+8>>2],f[d+12>>2]=f[A+12>>2],f[d+16>>2]=f[A+16>>2],f[d+20>>2]=f[A+20>>2],f[d+24>>2]=f[A+24>>2],f[d+28>>2]=f[A+28>>2],f[d+32>>2]=f[A+32>>2],f[d+36>>2]=f[A+36>>2],f[d+40>>2]=f[A+40>>2],f[d+44>>2]=f[A+44>>2],f[d+48>>2]=f[A+48>>2],f[d+52>>2]=f[A+52>>2],f[d+56>>2]=f[A+56>>2],f[d+60>>2]=f[A+60>>2],d=d+64|0,A=A+64|0;for(;(d|0)<(m|0);)f[d>>2]=f[A>>2],d=d+4|0,A=A+4|0}else for(m=x-4|0;(d|0)<(m|0);)oe[d>>0]=oe[A>>0]|0,oe[d+1>>0]=oe[A+1>>0]|0,oe[d+2>>0]=oe[A+2>>0]|0,oe[d+3>>0]=oe[A+3>>0]|0,d=d+4|0,A=A+4|0;for(;(d|0)<(x|0);)oe[d>>0]=oe[A>>0]|0,d=d+1|0,A=A+1|0;return S|0}function He(d,A,m){d=d|0,A=A|0,m=m|0;var _=0,x=0,S=0,M=0;if(S=d+m|0,A=A&255,(m|0)>=67){for(;d&3;)oe[d>>0]=A,d=d+1|0;for(_=S&-4|0,M=A|A<<8|A<<16|A<<24,x=_-64|0;(d|0)<=(x|0);)f[d>>2]=M,f[d+4>>2]=M,f[d+8>>2]=M,f[d+12>>2]=M,f[d+16>>2]=M,f[d+20>>2]=M,f[d+24>>2]=M,f[d+28>>2]=M,f[d+32>>2]=M,f[d+36>>2]=M,f[d+40>>2]=M,f[d+44>>2]=M,f[d+48>>2]=M,f[d+52>>2]=M,f[d+56>>2]=M,f[d+60>>2]=M,d=d+64|0;for(;(d|0)<(_|0);)f[d>>2]=M,d=d+4|0}for(;(d|0)<(S|0);)oe[d>>0]=A,d=d+1|0;return S-m|0}function it(d){return d=+d,d>=0?+Ee(d+.5):+$t(d-.5)}function Je(d){d=d|0;var A=0,m=0,_=0;return _=$n()|0,m=f[Ce>>2]|0,A=m+d|0,(d|0)>0&(A|0)<(m|0)|(A|0)<0?(wa(A|0)|0,$i(12),-1):(A|0)>(_|0)&&!(Wo(A|0)|0)?($i(12),-1):(f[Ce>>2]=A,m|0)}return{___divdi3:$,___muldi3:se,___remdi3:ce,___uremdi3:xe,_areNeighborCells:Ou,_bitshift64Ashr:ve,_bitshift64Lshr:le,_bitshift64Shl:ye,_calloc:E,_cellAreaKm2:Ft,_cellAreaM2:Zu,_cellAreaRads2:ps,_cellToBoundary:La,_cellToCenterChild:Gu,_cellToChildPos:Da,_cellToChildren:x0,_cellToChildrenSize:_l,_cellToLatLng:Xs,_cellToLocalIj:F1,_cellToParent:gl,_cellToVertex:er,_cellToVertexes:kc,_cellsToDirectedEdge:Fu,_cellsToLinkedMultiPolygon:ki,_childPosToCell:$u,_compactCells:yc,_destroyLinkedMultiPolygon:Xu,_directedEdgeToBoundary:Al,_directedEdgeToCells:Ma,_edgeLengthKm:So,_edgeLengthM:bc,_edgeLengthRads:Ko,_emscripten_replace_memory:xo,_free:v,_getBaseCellNumber:ka,_getDirectedEdgeDestination:Zo,_getDirectedEdgeOrigin:v0,_getHexagonAreaAvgKm2:El,_getHexagonAreaAvgM2:wc,_getHexagonEdgeLengthAvgKm:B1,_getHexagonEdgeLengthAvgM:O1,_getIcosahedronFaces:xc,_getNumCells:Ba,_getPentagons:b0,_getRes0Cells:Ac,_getResolution:ml,_greatCircleDistanceKm:bl,_greatCircleDistanceM:To,_greatCircleDistanceRads:zr,_gridDisk:sl,_gridDiskDistances:ks,_gridDistance:Sc,_gridPathCells:Pc,_gridPathCellsSize:Cc,_gridRingUnsafe:gt,_i64Add:P,_i64Subtract:z,_isPentagon:ri,_isResClassIII:yl,_isValidCell:Xo,_isValidDirectedEdge:Nu,_isValidVertex:tr,_latLngToCell:xl,_llvm_maxnum_f64:ze,_llvm_minnum_f64:je,_llvm_round_f64:Se,_localIjToCell:Qu,_malloc:p,_maxFaceCount:wl,_maxGridDiskSize:rl,_maxPolygonToCellsSize:Ut,_memcpy:Xe,_memset:He,_originToDirectedEdges:di,_pentagonCount:Wu,_polygonToCells:_i,_readInt64AsDoubleFromPointer:Ju,_res0CellCount:fc,_round:it,_sbrk:Je,_sizeOfCellBoundary:Ku,_sizeOfCoordIJ:S0,_sizeOfGeoLoop:Zr,_sizeOfGeoPolygon:mi,_sizeOfH3Index:Mc,_sizeOfLatLng:Tl,_sizeOfLinkedGeoPolygon:Sl,_uncompactCells:ju,_uncompactCellsSize:Qo,_vertexToLatLng:Co,establishStackSpace:Ta,stackAlloc:fs,stackRestore:Ea,stackSave:ba}}(hs,un,at);e.___divdi3=pt.___divdi3,e.___muldi3=pt.___muldi3,e.___remdi3=pt.___remdi3,e.___uremdi3=pt.___uremdi3,e._areNeighborCells=pt._areNeighborCells,e._bitshift64Ashr=pt._bitshift64Ashr,e._bitshift64Lshr=pt._bitshift64Lshr,e._bitshift64Shl=pt._bitshift64Shl,e._calloc=pt._calloc,e._cellAreaKm2=pt._cellAreaKm2,e._cellAreaM2=pt._cellAreaM2,e._cellAreaRads2=pt._cellAreaRads2,e._cellToBoundary=pt._cellToBoundary,e._cellToCenterChild=pt._cellToCenterChild,e._cellToChildPos=pt._cellToChildPos,e._cellToChildren=pt._cellToChildren,e._cellToChildrenSize=pt._cellToChildrenSize,e._cellToLatLng=pt._cellToLatLng,e._cellToLocalIj=pt._cellToLocalIj,e._cellToParent=pt._cellToParent,e._cellToVertex=pt._cellToVertex,e._cellToVertexes=pt._cellToVertexes,e._cellsToDirectedEdge=pt._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=pt._cellsToLinkedMultiPolygon,e._childPosToCell=pt._childPosToCell,e._compactCells=pt._compactCells,e._destroyLinkedMultiPolygon=pt._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=pt._directedEdgeToBoundary,e._directedEdgeToCells=pt._directedEdgeToCells,e._edgeLengthKm=pt._edgeLengthKm,e._edgeLengthM=pt._edgeLengthM,e._edgeLengthRads=pt._edgeLengthRads;var zi=e._emscripten_replace_memory=pt._emscripten_replace_memory;e._free=pt._free,e._getBaseCellNumber=pt._getBaseCellNumber,e._getDirectedEdgeDestination=pt._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=pt._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=pt._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=pt._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=pt._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=pt._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=pt._getIcosahedronFaces,e._getNumCells=pt._getNumCells,e._getPentagons=pt._getPentagons,e._getRes0Cells=pt._getRes0Cells,e._getResolution=pt._getResolution,e._greatCircleDistanceKm=pt._greatCircleDistanceKm,e._greatCircleDistanceM=pt._greatCircleDistanceM,e._greatCircleDistanceRads=pt._greatCircleDistanceRads,e._gridDisk=pt._gridDisk,e._gridDiskDistances=pt._gridDiskDistances,e._gridDistance=pt._gridDistance,e._gridPathCells=pt._gridPathCells,e._gridPathCellsSize=pt._gridPathCellsSize,e._gridRingUnsafe=pt._gridRingUnsafe,e._i64Add=pt._i64Add,e._i64Subtract=pt._i64Subtract,e._isPentagon=pt._isPentagon,e._isResClassIII=pt._isResClassIII,e._isValidCell=pt._isValidCell,e._isValidDirectedEdge=pt._isValidDirectedEdge,e._isValidVertex=pt._isValidVertex,e._latLngToCell=pt._latLngToCell,e._llvm_maxnum_f64=pt._llvm_maxnum_f64,e._llvm_minnum_f64=pt._llvm_minnum_f64,e._llvm_round_f64=pt._llvm_round_f64,e._localIjToCell=pt._localIjToCell,e._malloc=pt._malloc,e._maxFaceCount=pt._maxFaceCount,e._maxGridDiskSize=pt._maxGridDiskSize,e._maxPolygonToCellsSize=pt._maxPolygonToCellsSize,e._memcpy=pt._memcpy,e._memset=pt._memset,e._originToDirectedEdges=pt._originToDirectedEdges,e._pentagonCount=pt._pentagonCount,e._polygonToCells=pt._polygonToCells,e._readInt64AsDoubleFromPointer=pt._readInt64AsDoubleFromPointer,e._res0CellCount=pt._res0CellCount,e._round=pt._round,e._sbrk=pt._sbrk,e._sizeOfCellBoundary=pt._sizeOfCellBoundary,e._sizeOfCoordIJ=pt._sizeOfCoordIJ,e._sizeOfGeoLoop=pt._sizeOfGeoLoop,e._sizeOfGeoPolygon=pt._sizeOfGeoPolygon,e._sizeOfH3Index=pt._sizeOfH3Index,e._sizeOfLatLng=pt._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=pt._sizeOfLinkedGeoPolygon,e._uncompactCells=pt._uncompactCells,e._uncompactCellsSize=pt._uncompactCellsSize,e._vertexToLatLng=pt._vertexToLatLng,e.establishStackSpace=pt.establishStackSpace;var $s=e.stackAlloc=pt.stackAlloc,bi=e.stackRestore=pt.stackRestore,Wi=e.stackSave=pt.stackSave;if(e.asm=pt,e.cwrap=re,e.setValue=U,e.getValue=q,ni){yo(ni)||(ni=s(ni));{Dn();var Hn=function(Y){Y.byteLength&&(Y=new Uint8Array(Y)),ut.set(Y,D),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,fr()},qs=function(){u(ni,Hn,function(){throw"could not load memory initializer "+ni})},Dr=Ii(ni);if(Dr)Hn(Dr.buffer);else if(e.memoryInitializerRequest){var Rr=function(){var Y=e.memoryInitializerRequest,V=Y.response;if(Y.status!==200&&Y.status!==0){var X=Ii(e.memoryInitializerRequestURL);if(X)V=X.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+Y.status+", retrying "+ni),qs();return}}Hn(V)};e.memoryInitializerRequest.response?setTimeout(Rr,0):e.memoryInitializerRequest.addEventListener("load",Rr)}else qs()}}var qr;hr=function Y(){qr||Is(),qr||(hr=Y)};function Is(Y){if(ci>0||(An(),ci>0))return;function V(){qr||(qr=!0,!ne&&(Un(),At(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Xt()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),V()},1)):V()}e.run=Is;function ar(Y){throw e.onAbort&&e.onAbort(Y),Y+="",a(Y),y(Y),ne=!0,"abort("+Y+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=ar,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Is(),t}(typeof mo=="object"?mo:{}),zn="number",xn=zn,Tf=zn,Sn=zn,Cn=zn,is=zn,nn=zn,Nte=[["sizeOfH3Index",zn],["sizeOfLatLng",zn],["sizeOfCellBoundary",zn],["sizeOfGeoLoop",zn],["sizeOfGeoPolygon",zn],["sizeOfLinkedGeoPolygon",zn],["sizeOfCoordIJ",zn],["readInt64AsDoubleFromPointer",zn],["isValidCell",Tf,[Sn,Cn]],["latLngToCell",xn,[zn,zn,is,nn]],["cellToLatLng",xn,[Sn,Cn,nn]],["cellToBoundary",xn,[Sn,Cn,nn]],["maxGridDiskSize",xn,[zn,nn]],["gridDisk",xn,[Sn,Cn,zn,nn]],["gridDiskDistances",xn,[Sn,Cn,zn,nn,nn]],["gridRingUnsafe",xn,[Sn,Cn,zn,nn]],["maxPolygonToCellsSize",xn,[nn,is,zn,nn]],["polygonToCells",xn,[nn,is,zn,nn]],["cellsToLinkedMultiPolygon",xn,[nn,zn,nn]],["destroyLinkedMultiPolygon",null,[nn]],["compactCells",xn,[nn,nn,zn,zn]],["uncompactCells",xn,[nn,zn,zn,nn,zn,is]],["uncompactCellsSize",xn,[nn,zn,zn,is,nn]],["isPentagon",Tf,[Sn,Cn]],["isResClassIII",Tf,[Sn,Cn]],["getBaseCellNumber",zn,[Sn,Cn]],["getResolution",zn,[Sn,Cn]],["maxFaceCount",xn,[Sn,Cn,nn]],["getIcosahedronFaces",xn,[Sn,Cn,nn]],["cellToParent",xn,[Sn,Cn,is,nn]],["cellToChildren",xn,[Sn,Cn,is,nn]],["cellToCenterChild",xn,[Sn,Cn,is,nn]],["cellToChildrenSize",xn,[Sn,Cn,is,nn]],["cellToChildPos",xn,[Sn,Cn,is,nn]],["childPosToCell",xn,[zn,zn,Sn,Cn,is,nn]],["areNeighborCells",xn,[Sn,Cn,Sn,Cn,nn]],["cellsToDirectedEdge",xn,[Sn,Cn,Sn,Cn,nn]],["getDirectedEdgeOrigin",xn,[Sn,Cn,nn]],["getDirectedEdgeDestination",xn,[Sn,Cn,nn]],["isValidDirectedEdge",Tf,[Sn,Cn]],["directedEdgeToCells",xn,[Sn,Cn,nn]],["originToDirectedEdges",xn,[Sn,Cn,nn]],["directedEdgeToBoundary",xn,[Sn,Cn,nn]],["gridDistance",xn,[Sn,Cn,Sn,Cn,nn]],["gridPathCells",xn,[Sn,Cn,Sn,Cn,nn]],["gridPathCellsSize",xn,[Sn,Cn,Sn,Cn,nn]],["cellToLocalIj",xn,[Sn,Cn,Sn,Cn,zn,nn]],["localIjToCell",xn,[Sn,Cn,nn,zn,nn]],["getHexagonAreaAvgM2",xn,[is,nn]],["getHexagonAreaAvgKm2",xn,[is,nn]],["getHexagonEdgeLengthAvgM",xn,[is,nn]],["getHexagonEdgeLengthAvgKm",xn,[is,nn]],["greatCircleDistanceM",zn,[nn,nn]],["greatCircleDistanceKm",zn,[nn,nn]],["greatCircleDistanceRads",zn,[nn,nn]],["cellAreaM2",xn,[Sn,Cn,nn]],["cellAreaKm2",xn,[Sn,Cn,nn]],["cellAreaRads2",xn,[Sn,Cn,nn]],["edgeLengthM",xn,[Sn,Cn,nn]],["edgeLengthKm",xn,[Sn,Cn,nn]],["edgeLengthRads",xn,[Sn,Cn,nn]],["getNumCells",xn,[is,nn]],["getRes0Cells",xn,[nn]],["res0CellCount",zn],["getPentagons",xn,[zn,nn]],["pentagonCount",zn],["cellToVertex",xn,[Sn,Cn,zn,nn]],["cellToVertexes",xn,[Sn,Cn,nn]],["vertexToLatLng",xn,[Sn,Cn,nn]],["isValidVertex",Tf,[Sn,Cn]]],Ute=0,Vte=1,Gte=2,jte=3,mP=4,Hte=5,Wte=6,$te=7,qte=8,Zte=9,Xte=10,Qte=11,Yte=12,Kte=13,Jte=14,ene=15,Hr={};Hr[Ute]="Success";Hr[Vte]="The operation failed but a more specific error is not available";Hr[Gte]="Argument was outside of acceptable range";Hr[jte]="Latitude or longitude arguments were outside of acceptable range";Hr[mP]="Resolution argument was outside of acceptable range";Hr[Hte]="Cell argument was not valid";Hr[Wte]="Directed edge argument was not valid";Hr[$te]="Undirected edge argument was not valid";Hr[qte]="Vertex argument was not valid";Hr[Zte]="Pentagon distortion was encountered";Hr[Xte]="Duplicate input";Hr[Qte]="Cell arguments were not neighbors";Hr[Yte]="Cell arguments had incompatible resolutions";Hr[Kte]="Memory allocation failed";Hr[Jte]="Bounds of provided memory were insufficient";Hr[ene]="Mode or flags argument was not valid";var gP=1e3,tne=1001,nne=1002,B3={};B3[gP]="Unknown unit";B3[tne]="Array length out of bounds";B3[nne]="Got unexpected null value for H3 index";var ine="Unknown error";function _P(t,e,n){var i=n&&"value"in n,r=new Error((t[e]||ine)+" (code: "+e+(i?", value: "+n.value:"")+")");return r.code=e,r}function yP(t,e){var n=arguments.length===2?{value:e}:{};return _P(Hr,t,n)}function rne(t,e){var n=arguments.length===2?{value:e}:{};return _P(B3,t,n)}function e3(t){if(t!==0)throw yP(t)}var jo={};Nte.forEach(function(e){jo[e[0]]=mo.cwrap.apply(mo,e)});var pw=16,E1=8;jo.sizeOfH3Index();var sne=jo.sizeOfLatLng(),one=jo.sizeOfCellBoundary();jo.sizeOfGeoPolygon();jo.sizeOfGeoLoop();jo.sizeOfLinkedGeoPolygon();jo.sizeOfCoordIJ();var rc={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function ane(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw yP(mP,t);return t}var lne=/[^0-9a-fA-F]/;function vP(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||lne.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),pw),n=parseInt(t.substring(t.length-8),pw);return[n,e]}function cne(t,e){return e===void 0&&(e=0),mo.getValue(t+E1*e,"double")}function t3(t){return Ane(mo.getValue(t,"double"))}function xP(t){return[t3(t),t3(t+E1)]}function une(t){return[t3(t+E1),t3(t)]}function hne(t,e,n){for(var i=mo.getValue(t,"i32"),r=t+E1,s=[],u=e?une:xP,a=0;a<i*2;a+=2)s.push(u(r+E1*a));return n&&s.push(s[0]),s}function q8(t){var e=mo._malloc(sne),n=vP(t),i=n[0],r=n[1];try{return e3(jo.cellToLatLng(i,r,e)),xP(e)}finally{mo._free(e)}}function fne(t,e){var n=mo._malloc(one),i=vP(t),r=i[0],s=i[1];try{return e3(jo.cellToBoundary(r,s,n)),hne(n,e,e)}finally{mo._free(n)}}function i1(t,e){ane(t);var n=mo._malloc(E1);try{switch(e){case rc.m:e3(jo.getHexagonEdgeLengthAvgM(t,n));break;case rc.km:e3(jo.getHexagonEdgeLengthAvgKm(t,n));break;default:throw rne(gP,e)}return cne(n)}finally{mo._free(n)}}function Ane(t){return t*180/Math.PI}function dne(t){let e,n,i,r,s,u;e=t[0],n=t[1],i=t[2];let a=Math.min(e,n,i),y=Math.max(e,n,i);u=y;let w=y-a;if(y!=0)s=w/y;else return s=0,r=-1,[r,s,void 0];return e===y?r=(n-i)/w:n===y?r=2+(i-e)/w:r=4+(e-n)/w,r*=60,r<0&&(r+=360),isNaN(r)&&(r=0),[r,s,u]}function pne(t){let e,n,i,r,s,u,a;if(n=t[0],i=t[1],r=t[2],i===0)return s=u=a=r,[s,u,a];n/=60,e=Math.floor(n);let y=n-e,w=r*(1-i),I=r*(1-i*y),R=r*(1-i*(1-y));switch(e){case 0:s=r,u=R,a=w;break;case 1:s=I,u=r,a=w;break;case 2:s=w,u=r,a=R;break;case 3:s=w,u=I,a=r;break;case 4:s=R,u=w,a=r;break;default:s=r,u=w,a=I;break}return[s,u,a]}function O3(t,e){e===void 0&&(e=2);let n=dne(t);return n[1]*=e,pne(n)}function Fl(t,e,n){let i={};return n||(n=[]),Object.keys(t).forEach(r=>{if(n.includes(r))return;let s=t[r],u={};Object.keys(s).forEach(a=>{e(s[a])&&(u[a]=s[a])}),i[r]=u}),i}const F3=[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]],mne=[[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]]],gne=T1().domain([0,1]).range(xw(0,F3.length));class sa extends il{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data,resRange:Object.keys(this.props.data).map(e=>parseInt(e))})}renderLayers(){const{hextiles:e,resRange:n}=this.state;if(!e)return;let i=[],r=T1().domain([0,1]).range(n)(this.props.resolution),s=e[r];const u=i1(r,rc.km)/250*1.75;let a=i1(r,rc.km)/i1(5,rc.km);return Object.keys(s).forEach(y=>{let w=s[y];const[I,R]=q8(y),D=this.props.getValue?gne(this.props.getValue({properties:w})):1;for(let[U,q,ne]of this.props.getValue?F3[D]:[[0,0,0]]){let[pe,J]=this.props.offset;i.push({position:[R+U*u+pe*u,I+q*u+J*u,this.props.getElevation({properties:w})+ne*1e4],properties:w})}}),[new k1({id:`${this.props.id}IconHexTileLayer`,data:i,getPosition:y=>y.position,mesh:this.props.mesh,texture:this.props.texture,sizeScale:this.props.sizeScale*a,wireframe:this.props.wireframe,material:this.props.material,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,textureParameters:this.props.textureParameters,autoHighlight:this.props.autoHighlight,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,highlightColor:this.props.highlightColor,loaders:this.props.loaders,modelMatrix:this.props.modelMatrix,opacity:this.props.opacity,pickable:this.props.pickable,visible:this.props.visible,wrapLongitude:this.props.wrapLongitude,updateTriggers:this.props.updateTriggers,extensions:this.props.extensions,transitions:this.props.transitions})]}}sa.layerName="IconHexTileLayer";sa.defaultProps={...il.defaultProps,...k1.defaultProps,thicknessRange:[.7,.9],resolution:0,resRange:[5,5],getValue:void 0,getElevation:()=>0,offset:[0,0]};function mw(t,e,n=1){const i=n,[r,s]=q8(t);return e.map(a=>{let y=Ka(s,a[0],i),w=Ka(r,a[1],i);return[y,w]})}function _ne(t,[e,n]){let i=fne(t).map(u=>[u[1],u[0]]),r=mw(t,i,n),s=mw(t,i,e);return[r,s]}class ao extends il{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data,resRange:Object.keys(this.props.data).map(e=>parseInt(e))})}renderLayers(){const{hextiles:e,resRange:n}=this.state;if(!e)return;let i=[],r=T1().domain([0,1]).range(n)(this.props.resolution),s=e[r];return Object.keys(s).forEach(u=>{let a=s[u],y=_ne(u,[this.props.getValue?1-this.props.getValue({properties:a}):this.props.thicknessRange[0],this.props.thicknessRange[1]]);this.props.raised?i.push({polygon:y.map(w=>w.map(([I,R])=>[I,R,this.props.getElevation({properties:a})])),properties:a}):i.push({polygon:y,properties:a})}),[new H2({id:`${this.props.id}SolidHexTileLayer`,data:i,getPolygon:u=>u.polygon,filled:this.props.filled,wireframe:this.props.wireframe,extruded:this.props.extruded,pickable:this.props.pickable,getFillColor:this.props.getFillColor,getElevation:this.props.getElevation,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,opacity:this.props.opacity,updateTriggers:this.props.updateTriggers,extensions:this.props.extensions,transitions:this.props.transitions})]}}ao.layerName="SolidHexTileLayer";ao.defaultProps={...il.defaultProps,...H2.defaultProps,thicknessRange:[.7,.9],resolution:0,resRange:[5,5],getValue:void 0};const pd=t=>O3(Fz(ga().domain([-250,700]).range([0,1])(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e))),md=t=>O3(Rz(ga().domain([-30,30]).range([0,1])(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e))),Hc=ga().domain([-150,0]).range([1,0]).clamp(!0),gd=ga().domain([0,150]).range([0,1]).clamp(!0),qa=Lz().domain([new Date("10/31/1921"),new Date("9/30/2021")]).range([0,1199]).invert,yne=ga().domain([7,10]).range([0,1]).clamp(!0),vne={longitude:-121.046040643251,latitude:37.53320315272563,zoom:7.3252675985610685,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58},xne={longitude:-120.799348991653,latitude:37.07909824584108,zoom:9.589607161282105,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new M1},gw={longitude:-121.134704643101,latitude:37.71392572292552,zoom:7.714668594935653,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new M1},wne={longitude:-121.724611542995,latitude:38.20436329728941,zoom:8.054386171593723,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new M1},bne={longitude:-121.816103974157,latitude:38.98693235425995,zoom:9.654348182289308,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new M1},Ene={longitude:-121.80183018585,latitude:38.26807071392864,zoom:9.572807132250027,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new M1},Tne={longitude:-120.732027389154,latitude:37.00972667884932,zoom:8.599616427840187,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new M1},Sne=new VE({color:[255,255,255],intensity:1}),Cne=new b$({timestamp:Date.UTC(2019,6,1,22),color:[255,255,255],intensity:.9}),W4={0:"Settlement",1:"Exchange",2:"Project",3:"Non-Project"},oo={0:"bl_h000",1:"CS3_ALT3_2022med_L2020ADV",2:"LTO_BA_EXP1_2022MED"},_w={0:"Scenario 1",1:"Scenario 2",2:"Scenario 3"};function ln(t,e,n){return t>=e&&t<=n}const yw=T1().domain([0,1]).range(xw(0,F3.length));class Ul extends il{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data,resRange:Object.keys(this.props.data).map(e=>parseInt(e)),transitioning:!1,prevGetValueFn:null})}renderLayers(){if(!this.props.visible)return;let{hextiles:e,transitioning:n,prevGetValueFn:i,resRange:r}=this.state;if(i===null?this.setState(Object.assign(this.state,{prevGetValueFn:this.props.getValue})):i!==this.props.getValue&&!n&&(this.setState(Object.assign(this.state,{transitioning:!0})),n=!0,setTimeout(()=>{this.setState(Object.assign(this.state,{transitioning:!1,prevGetValueFn:this.props.getValue}))},300)),!e)return;let s=[];console.log("in rest of draw");let u=T1().domain([0,1]).range(r)(this.props.resolution),a=e[u];const y=i1(u,rc.km)/250*1.75;let w=i1(u,rc.km)/i1(5,rc.km);return Object.keys(a).forEach(I=>{let R=a[I];const[D,U]=q8(I),q=this.props.getValue?yw(this.props.getValue({properties:R})):1;for(let[ne,pe,J]of this.props.getValue?n?mne[yw(i({properties:R}))][q]:F3[q]:[[0,0,0]]){let[ie,re]=this.props.offset;s.push({position:[U+ne*y+ie*y,D+pe*y+re*y,this.props.getElevation({properties:R})+J*1e4],properties:R})}}),[new k1({id:`${this.props.id}AnimatedIconHexTileLayer`,data:s,getPosition:I=>I.position,mesh:this.props.mesh,texture:this.props.texture,sizeScale:this.props.sizeScale*w,wireframe:this.props.wireframe,material:this.props.material,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,textureParameters:this.props.textureParameters,autoHighlight:this.props.autoHighlight,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,highlightColor:this.props.highlightColor,loaders:this.props.loaders,modelMatrix:this.props.modelMatrix,opacity:this.props.opacity,pickable:this.props.pickable,visible:this.props.visible,wrapLongitude:this.props.wrapLongitude,updateTriggers:this.props.updateTriggers,extensions:this.props.extensions,transitions:this.props.transitions})]}}Ul.layerName="AnimatedIconHexTileLayer";Ul.defaultProps={...il.defaultProps,...k1.defaultProps,thicknessRange:[.7,.9],resolution:0,getValue:void 0,getElevation:()=>0,offset:[0,0],transitions:{getPosition:{duration:300,easing:k9.overshoot(2)},getColor:{duration:300,easing:k9.overshoot(2)}}};const wP={0:"This is California’s <b>Central Valley</b>, home to over 7 million people and 18% of California’s total population. (2020 US Census)",1:"We have lots of demand that tends to cycle through highs and lows depending on the time of the year, peaking at around July. Each drop that you see represents a unit of <b>demand</b> for water.",2:"However, our groundwater supply stays consistent throughout the year, and usually cannot keep up during peak demands.",3:"This leads to unmet demand. For example, take May 2007. This is the demand of that month.",4:"As you can see, not everyone will get their demand. Notice anything?",5:"Let’s try another timestep. This is water demand from July 2021.",6:"This is unmet demand.",7:'This is the average over 100 years. We can see that the areas of <span class="purple">unmet demand</span> does not necessarily correspond with areas of <span class="orange">demand</span>.',8:"If we take a closer look at this region, we can investigate what might have contributed to this inequity.",9:'If we overlay the map with land holders, we can see that exchange holders, symbolized with cows, are the ones predominantly demanding high amounts of <span class="orange">demand</span>. However, they aren’t suffering from as high <span class="purple">unmet demand</span>. In fact, they seem to be doing quite well.',10:'What we should expect is more of the following. Here, a patch of land held by project holders are symbolized with a paper scroll. This area contends with high levels of <span class="purple">unmet demand</span>; this is expected, since it has high levels of <span class="orange">demand</span>.',11:'On the other hand, settlement holders are similar to exchange holders in that they also historically have <span class="orange">high demand</span>, but get special treatment as well.',12:"In fact, we can see on average, settlement and exchange land holders get higher water supply rates because they are higher priority; this is how they are able to maintain low average levels of unmet demand even though they have high average levels of demand.",13:"And this does not necessarily correspond to groundwater supply.",14:"Thus, we can see that due to certain government policies, certain regions get higher priority and access to water supply, even if their demand largely outweigh surrounding regions. The question is, is this the only option?",15:"Certainly not. That is where CalSim comes in, a simulation program that plays out the “what-if” scenarios. Imagine an alternate universe where government policies were different; we’ll call this Scenario 1. Let us revisit the first time step from earlier, May 2007.",16:'This time, the rings indicate regions that are doing <span class="green">better</span> or <span class="purple">worse</span> than real-life, or historical, baselines.',17:"Notice that now in this region, unmet demand is now more equal across regions, at the cost of some regions doing better than historical levels and other regions doing worse than historical levels.",18:"What about another alternate scenario, Scenario 2? We can see that this scenario favors less equal distribution of unmet demand at the tradeoff of keeping levels closer to baseline historical level.",19:"Scenario 3 is somewhere in between.",20:"Here’s a timestep with more dramatic differences between scenarios, July 2021.",21:"As you may have noticed, rarely is there a situation where everyone wins. Tradeoffs must be made between regions, if not between months, and who and when to save water. With climate change and increasing population in the Central Valley, these choices become all the more pertinent. Which scenario is best? That choice is up to <b>you</b>.<br/><i>Data from James Gilbert (NOAA)</i>"},Pne=Object.values(wP).length;function Mne({slide:t,transitioning:e}){if(!(e||t>=22))return Vn.createElement("div",{className:"cardContainer"},Vn.createElement("p",{className:"cardP",dangerouslySetInnerHTML:{__html:wP[t%Pne]}}))}const Ine=[-6.1795967885680545,-2.74068993617841,-.7818130172957225,-2.025945041302708,-.18570206401474082,-1.5072469465725338,-12.963296848037203,-15.525215279409002,-19.452466414571056,-23.575180023928628,-18.33541536637407,-10.668586595666818,-4.064098395020311,-1.8591447518930817,-.6164796929841818,-2.328627801425199,-1.04858956791722,-4.2089464332153605,-7.975190426458526,-16.64793622538284,-16.70911768884974,-22.255249068465815,-18.349991367992995,-7.590369355546259,-5.431816941979197,-3.0543942667140263,-1.0977725983523345,-2.4927046405987463,-1.7941288292605633,-4.540602204238128,-20.09304877749699,-23.272142866405414,-24.724693747133813,-27.238008018795874,-21.95314745956582,-11.509922710777635,-3.4445972832353453,-2.5132096799604184,-.8437164307822946,-2.8356895955622745,-1.0873190616797863,-2.75072016673305,-11.332369640572818,-13.016670933655183,-20.21925925305027,-24.13234011030728,-18.332081938995618,-8.439729854646925,-5.816042345466243,-2.7698899203817264,-1.0394764160665577,-2.3789728403971764,-.699103036336698,-4.5018646937787095,-9.10407077029478,-18.70942164328822,-23.49481107911643,-25.777856169310674,-19.88332043235565,-10.096548283520487,-5.203303502411558,-1.668212772420784,-.9457217020927369,-2.481438615312462,-.4799292129915347,-2.1100360819161335,-12.274940733043026,-17.394344733571515,-18.578726735053195,-23.948069978781724,-18.65644588353055,-9.380256694418279,-3.9503644042768475,-2.336577777415818,-.7825939279842343,-2.8143541843189075,-1.2361942677858988,-3.1278035186711697,-15.253424046425403,-19.372120090242536,-21.307808725067705,-24.068678794077766,-20.20165973620545,-10.637134242202432,-6.427343978480874,-1.7243324449098714,-.7883620526997088,-2.542315567153562,-1.277623992866032,-3.6467031953365865,-15.662240871339675,-21.088624232392238,-18.921311084893745,-26.657495913468114,-22.561804186351658,-11.643155489085766,-7.460076575003645,-3.550988477584742,-1.1588717036305138,-2.027891335006261,-1.0188100710040429,-2.876704947499099,-15.18673776537887,-16.921700626330853,-22.91445313145012,-25.72960543146255,-20.34261188648174,-9.160206411833373,-6.303524575679716,-2.8240882678636345,-1.300347314200392,-2.0162291770957057,-1.1107174456612716,-4.825456348575722,-20.026770898515473,-20.66638851928845,-22.048890213733397,-31.560268442677327,-25.350872831175177,-12.038772678824495,-7.264561185435756,-2.4799223418202665,-.7510225287777859,-2.604999326697283,-.620525089720037,-3.428128401150883,-14.717088262594851,-17.442063637636466,-22.843481577475895,-25.890287177448183,-21.304387612629185,-12.118864520815267,-7.373863299014655,-3.499801933772607,-1.1062695193703427,-1.9303267161543987,-1.482699642309893,-3.4904730121297933,-18.395405196118283,-16.46695543525729,-22.36919821018006,-30.055744508657934,-23.57382634803674,-11.37755390123606,-6.830628627729941,-3.6938509577916667,-.9064121323585169,-2.755303667346682,-.9699480213291808,-5.0947998758038,-19.854628487400444,-20.330006699730024,-21.607363290559626,-28.711824776159165,-24.00504231258545,-12.303786819470824,-6.41059877599799,-2.073025305672112,-.8542416260834403,-2.04628745910725,-.977462292005509,-1.1902933425380817,-6.983904739705557,-18.595684280139675,-22.25838613470556,-24.23782469031429,-20.75818419799641,-10.912919580273773,-4.889063379936425,-2.6886681898982623,-1.0887124656250995,-2.5322326683458045,-.33195100033154296,-2.1603498354894644,-12.732734244024837,-17.147648766401517,-18.594332838494495,-23.95833289024715,-20.42718675173729,-10.54672262411126,-5.579436470124167,-3.3670213070380117,-.8801690751561058,-2.1581730979918254,-.42252028598889213,-.7803511088976779,-12.475793737588928,-18.940376596230486,-18.880859709339685,-24.169349262771068,-20.683042427649077,-10.401971156879304,-5.442518763558868,-2.8222329625347844,-.8929194431099478,-2.1277574243463264,-.247667960664832,-.5523907739526576,-9.147889120347925,-17.30030868764833,-19.49368315248442,-22.610124629857122,-18.636664402696663,-9.072304237417018,-4.082856848408974,-3.010641614972163,-.9676789191265738,-2.4812255779964647,-1.1632830744387352,-3.651865873893966,-18.325967971030213,-18.298317484246898,-22.19220121007997,-25.558540476066888,-21.23116516144342,-9.100304390314236,-5.9453571681021975,-3.3799620708427236,-1.2417817193457281,-1.4033694645370443,-.2677909508682667,-1.6832104828984378,-13.184125228900442,-18.50151345316918,-22.127984714797037,-23.503171080703716,-19.427280112249235,-9.298232752964896,-4.789585762556959,-3.0895877000918914,-.7610904910087719,-2.043102589169982,-.10865234098532103,-.959880521199622,-5.9682064098049885,-15.404208044060141,-17.872861500740935,-22.488046555948245,-16.851806084414605,-9.10977032939218,-4.22786868835911,-2.761495688008086,-.719803138164379,-2.1631024125422504,-.6696734744501408,-2.3517838196336536,-7.633160902943327,-13.647093673396343,-19.638170052934523,-23.39939269593963,-18.93867728073727,-9.686189310151313,-5.992475174414384,-2.6966616358468074,-.887753949777013,-2.223032341013827,-1.0657730940092132,-.9585637403358891,-12.758729056112859,-18.701249972097244,-18.490054996387638,-22.86063767609289,-18.80366147580871,-10.871813562213054,-5.972317348192701,-3.0262299370928374,-.9651674941610283,-2.3570883365583453,-.5442744866944589,-3.449370967664504,-12.173204810852024,-17.151276043053088,-17.875618067807704,-22.896207927292433,-20.253214640949906,-11.357687006865731,-5.517971304425901,-1.7303331200482899,-.7964065560156354,-2.878499685643728,-.7683896294773568,-1.656516224651939,-15.67539591625622,-15.700685858062819,-19.536405678823037,-25.118157836435138,-19.86483108811524,-10.583167692714918,-3.1370778580073293,-2.2545516913380346,-.7170095604800993,-2.757259721575085,-.8216389771034907,-2.8782418433327024,-16.13370345404446,-16.31078193396884,-19.849676649073658,-23.223934405804016,-20.134678962764834,-10.5405735006886,-5.612613263028453,-1.7924080359981003,-.7668871623088236,-2.797492710040286,-1.2723822160024127,-3.7597806998227745,-17.16520759441341,-19.91213411197488,-19.492910537253152,-23.745326551822373,-19.223512961628668,-11.466568234694325,-3.610404384906405,-2.7197913646046,-1.0346764546383147,-3.084082253442141,-1.8417433999965365,-3.7282706818989335,-9.246335361890383,-12.960703711411384,-18.752727634483765,-23.283073668232827,-19.25323666896647,-10.30628913686904,-5.745443387906452,-3.1849627432795904,-.9993309162158587,-2.6391244356312367,-1.3677072291831651,-2.056818515453768,-18.540344304823687,-16.977149278070616,-22.29777974648696,-24.94938319772981,-19.032416881577422,-10.950436704783426,-6.9715459410667995,-2.9393238456567516,-1.057693176476435,-2.014299556819264,-1.175605549041718,-2.900218799282745,-15.690648668192713,-18.995747579716976,-20.821983398261096,-25.11169533100527,-20.704098113655256,-9.666849618874739,-3.8236780724931823,-2.100000860666511,-.7195786295821935,-2.396597658615997,-.810117353801596,-3.413934143236141,-13.976081246385748,-17.40594173700334,-20.363332031217823,-23.56459863402372,-19.568498398665923,-10.874496599420917,-4.679434354723177,-2.308615410003443,-.7014812200694779,-1.6730651639490304,-.7485470986151529,-.8725489467138814,-10.221306380911047,-17.764750125111206,-16.56758697710979,-22.697630762768494,-19.04769655069582,-9.927964880566782,-6.658946871295272,-2.368330417195727,-.6246685519843607,-2.6383394677892964,-1.4602752913852517,-3.692282190641183,-10.965998008115609,-14.689949055283027,-17.217440296970853,-24.330446887872807,-17.884050909974974,-10.359707599297126,-6.098008777519426,-2.421199937237742,-1.061625072236721,-2.3827204952843943,-1.131571279592712,-2.1989244213173817,-14.29558003145955,-18.99974880819148,-18.933313047876045,-24.24668162264503,-17.641064540696114,-10.066980869094925,-6.553150774253684,-2.423170431901872,-.8189186227017436,-1.8215314584533484,-.8863988086900573,-4.0888609603912265,-11.652748667986083,-16.683306255853683,-20.07490699846736,-23.14299638313245,-20.88234994614944,-10.651748407125208,-6.545751705213646,-2.6280105006780334,-.6431845315213414,-1.800081321140168,-.8698543796498692,-3.608876141894117,-10.935739741638942,-14.676387103141789,-19.44757902629813,-22.398414724008326,-17.820395099767662,-9.299188253342187,-4.393896562901599,-3.3096944747742896,-1.1912707767118973,-2.19958061447099,-1.0290326655364963,-3.696883703300191,-14.35728183027381,-12.840543138455393,-21.13566322984228,-23.892973047489804,-18.975361093343984,-8.512354461876852,-3.525324990976492,-2.9350079622937244,-.9206667556533582,-2.029131706972648,-.259243889879562,-.5065048824860041,-5.895554947088231,-15.416388887389271,-17.109896127151117,-21.631325461138196,-19.32664855199863,-9.600172405268502,-6.514092817547672,-3.2027894718585794,-1.1748147920291432,-2.1191237173335424,-.6341340453673528,-4.238697570737674,-16.694368241814317,-18.63646737382283,-21.90086953577223,-25.42958851378954,-19.515519447352297,-6.003973389805771,-6.881736780903278,-3.4290883081976675,-1.2348139847410406,-2.3191099634358503,-.6449229371659656,-3.8008041662774925,-14.395719814661522,-18.47178887029837,-23.60584306885149,-26.01469889907678,-20.749022383745935,-11.177453568846957,-6.547789345827946,-1.79696025190667,-1.0164610776077827,-2.1738566222252858,-1.4168642925525081,-3.4070457219848054,-16.684604334662954,-17.08139739030518,-23.47114241542194,-27.439970200983254,-21.039113646163717,-10.752625083257092,-7.130478984521748,-2.0642923723753177,-.906692660304387,-2.469840891229575,-.26352128928830315,-2.2357499788484594,-15.62163321094136,-17.74151373592608,-20.965279814953377,-24.51709835487236,-19.394128488536335,-10.6559313440156,-3.8137932531432894,-3.1773212689881203,-1.0114167849154292,-2.569949285303723,-.7160287600621096,-1.8583521707943091,-6.881723094769083,-14.955149333968285,-18.332713254797437,-21.926085599706386,-18.200019595041738,-9.236259991660267,-3.4758174115162954,-1.9301250954101563,-.9324660579639342,-2.4614358480559266,-1.7846612584485981,-4.692151678211272,-16.830088257038398,-17.43348586488174,-18.658372135046722,-23.84320066650761,-19.329080221480577,-9.703279638090951,-4.179063427600699,-2.0745302019434426,-.6828851750451805,-2.520139499790634,-1.232568772586328,-3.1123129486997163,-8.356811351539942,-17.614947179869866,-17.91192167455511,-22.091031288387907,-16.53358198701324,-9.148488176914514,-6.485310047747085,-1.124924218322211,-.668660683976725,-2.564104146468765,-.9140656277250205,-4.015310280680082,-16.103040428808146,-18.840963396617365,-20.600680627219923,-22.463709084626988,-19.971109611464225,-10.167729292794059,-6.76950090436838,-2.192930375954893,-.7327083455812232,-1.8258681802974916,-1.0798158137662626,-1.7546173376587861,-4.643152877191304,-16.416854258408826,-15.851231039481188,-23.016010187037484,-19.651078019631075,-9.593037999892651,-5.901823275829563,-2.4649693101685957,-.9405959273207031,-2.447549308937944,-1.1486705267439974,-3.330263245109542,-17.105924519266736,-17.99067453406316,-21.464799636837153,-23.72217585151361,-17.087424236988895,-10.32380403975084,-4.983140274143808,-1.7950078590661964,-.7014092129920689,-1.099645032889398,-.018511839115764428,-2.100011717946749,-9.927969785659293,-17.578605857354585,-16.788562720992836,-22.1361320565524,-19.403353402811888,-9.29487962978919,-4.382849075554422,-2.628199004799844,-.9179650296494932,-1.73969347525463,-1.0795399141849205,-2.374044281724527,-14.937965378530645,-18.835382967493864,-19.027759281339232,-23.638132230301256,-19.333359589648275,-10.438732131408807,-5.421632892581787,-1.315222539999328,-.6263759525152724,-2.720030863968866,-1.22918946259428,-3.39807077791164,-14.03540860540736,-13.834234800635059,-18.996376045696767,-23.143980362073354,-19.318558545844763,-9.996535821064098,-5.988052034253673,-2.7164761705675073,-.8600265149485071,-2.7498364785451974,-1.772166013664966,-5.596559319161642,-15.848549131790987,-18.78216479229076,-20.77512261999267,-24.117862295163608,-19.16884499602125,-8.524007141853636,-3.6395407374606585,-.956400964054924,-.6811482095704862,-1.8434846427521971,-.04038649813532185,-1.1327293172106452,-12.911571386131277,-18.776518217805638,-20.04376592057577,-22.413357692348754,-18.232498350202036,-9.172111996437808,-3.55411132347123,-2.1501495552722627,-.7163856995389744,-2.2131818540435364,-1.1096526494585952,-1.4180506014109304,-11.866705472824753,-17.91201339222596,-18.957258217657813,-19.369336490267063,-18.29481198484832,-10.546515063001067,-4.690463199973298,-2.799944882977747,-.8172533320609587,-2.825470041813578,-.703680205128536,-1.3064571526495876,-11.768495930219782,-17.972088790742923,-19.218601900754564,-20.793119696584316,-16.23963529204772,-10.04375381391723,-3.2020941175109225,-3.020857007987761,-1.0919729130029483,-2.988398257070915,-1.473097466965759,-7.782221614964485,-16.06743665673008,-20.76428211010842,-21.42392499146906,-23.97725135107611,-14.546321397844071,-7.679450606107072,-6.284038475010361,-2.705479288127253,-1.2076294893075794,-2.5846767826076977,-1.6134101200653148,-6.283221101707219,-22.217358469026436,-15.536291639524437,-24.868692721663663,-29.0042177565911,-22.964338252460706,-10.918733857020136,-7.698313495135951,-3.214116759870294,-.9787819456082261,-1.6132595838581583,-.19910188935606754,-.6691548686749791,-5.8117684483722245,-17.45786031450988,-19.126965959394667,-22.244715511036258,-18.221298472347076,-7.449445145689366,-6.84904752263295,-2.0217624040396496,-1.026064891433833,-1.8298746640114905,-.3216989926398218,-1.3728804993649022,-12.652441915792418,-17.573086886307237,-20.602809516873414,-21.873944636105538,-17.452987572843917,-10.234235550272496,-3.9980413519597118,-2.470803649407527,-.8896046774907855,-1.776323832178309,-.395962584018116,-1.8190195418246224,-12.240719465807105,-15.210544052803424,-16.80979557433778,-20.5276385888199,-17.075662841100083,-9.1639500477815,-6.144587468557605,-3.1734676317465804,-1.0395237089719755,-1.9836089775210837,-1.2190323904372693,-1.2829899539962757,-14.478241007132445,-18.030996485230446,-21.909170719711515,-24.164190894795507,-19.138643752624144,-9.683042546219559,-3.5304586912689384,-1.477721783090231,-.7653481504713766,-2.1707887584702537,-.7361244545005791,-.5889878648927955,-6.98432141544737,-17.15390289853309,-15.498713378148372,-20.524164607164064,-16.942047074135605,-5.933143189869601,-2.897130986558016,-1.4264559596609818,-.6586211281927978,-1.3848563755656498,-.023064209783243646,-.4600704421159648,-5.529987760458664,-15.396855772143928,-17.718415618169136,-19.899123701511773,-16.44754831741032,-6.909105207189631,-4.74255318273654,-1.4736234767759022,-.5998327756703784,-2.8544648866493194,-1.0093650538519607,-3.8128237088179735,-14.605981180169264,-18.919912972344385,-19.506584289624673,-23.225803857112936,-18.33734983897651,-10.461649022784954,-3.791405533569422,-1.5674399261991177,-.7324141802940697,-2.657658755746242,-1.3702597956926519,-2.7882123751380914,-16.934181001676013,-18.756914043145738,-21.388640211207868,-23.98593023394952,-18.308960263615628,-7.95663710539055,-5.2543532675121165,-1.4653583790896632,-.7546457292413499,-2.560865439455902,-.33092497599314663,-.9367594081020569,-12.262961316051628,-17.13431753773467,-19.728447464734376,-21.727334464288653,-18.747361959156354,-6.893752825201545,-6.1942849395419675,-3.2426005157509943,-1.071152351880117,-2.3995090019238656,-.7513679176865264,-1.862329450424267,-17.6437016285071,-19.04426789756114,-21.37560190827738,-21.606335815389155,-19.07819018520041,-10.760723895464691,-5.405712996151806,-2.726236253379763,-.7792092548619559,-2.2407730973240896,-1.431680154134853,-5.304648258856078,-13.135622211734377,-17.590499700479768,-20.45782178392532,-26.533367560952538,-20.621331692279107,-11.460968785983315,-7.415709108188298,-2.5201958954114576,-.9276308530368435,-2.879435400790552,-1.4702357662685501,-3.1297675220272225,-18.10168959137202,-19.186117381728007,-21.769350396233932,-25.904689474834907,-19.973053479569145,-6.220627591313095,-4.6105326745026876,-3.0333235371043994,-1.3996297750817175,-2.383103511058715,-1.1854833018098403,-5.664062395472064,-18.394699107587183,-13.342782076536594,-22.782793504597887,-26.539072924059614,-20.780970321147425,-11.138549190023232,-7.541492367551319,-3.2517725484112736,-1.3409317513856485,-3.2199862947506044,-1.7498135490390876,-1.0020806111667955,-17.011282062394056,-20.05006852356837,-22.379124176134585,-27.90218908459937,-21.403251450020644,-13.307639820141839,-6.635307709233659,-3.460377753359005,-1.1527631547274868,-2.638559560200563,-.8418461870992842,-2.224790318566403,-16.942429676121076,-22.465357845354934,-21.104737657192825,-23.789437570750657,-22.26864206288548,-11.975949794247343,-4.904363410043745,-3.388636462758785,-.8270191512674996,-1.2991656628371464,-.09691509187266177,-1.2036705456478558,-11.409758986482665,-14.681164622998566,-16.58040233495453,-21.7711484660577,-17.98435374872377,-10.324444401684143,-5.601026114904318,-2.6557331943313645,-.8814666212643483,-2.4452308119198696,-.6990426028498808,-4.240321255297284,-13.879285011222505,-14.635841128979008,-21.9443672624063,-24.85766849165264,-20.60087213500707,-10.652261988417006,-5.7853318190944645,-2.2792948387405776,-.9571765817808889,-.969267156412406,-.7352854630697357,-.5213166962593342,-9.407240815962304,-12.061285104509443,-15.424107108458145,-20.50884195493617,-17.76837389604061,-9.438106811058445,-6.375474014716435,-3.2622941989361327,-.8284878239632654,-2.1625393795410184,-.35348431325139573,-1.7788193269659653,-11.643541772450055,-13.230608236155653,-18.892899291948265,-22.714181304591985,-18.58846117735927,-9.49530139282606,-3.362596126760254,-1.9116220526499548,-.6112666195459109,-1.4260879808400762,-.646567452946567,-3.7202485344398286,-13.371131019769509,-18.10715277666809,-18.009926551820087,-21.52032320200424,-17.257216775886892,-9.799771307770502,-5.296136955655938,-1.6389412392514453,-.7003790107227043,-1.5291284281016393,-.006051135983727867,-1.020457589713509,-7.117033275179669,-5.64122502786545,-14.195955089620899,-20.70527931488056,-17.975305637329864,-8.368099472957315,-4.645812757505568,-2.3979647588344197,-.998406626237546,-2.2674116320277427,-.6789383664604446,-2.545854348392712,-12.766966025472701,-17.025039141844584,-17.949234932251063,-20.771754505331316,-16.535593674585204,-9.994470478926642,-6.481181537617408,-2.803074853981013,-1.1735772688537471,-1.930594134784145,-.4922754159454375,-2.331924094381456,-12.198188481730517,-15.423725454961001,-19.02521457370971,-21.074109629429724,-18.00837292886293,-8.816046225740179,-2.268509456872279,-2.8383522098431926,-1.0910881130656864,-1.987072595761451,-.5857717239452378,-2.5792098206464913,-13.28787714290309,-20.572694213223357,-20.84541109364806,-21.894679113006337,-18.73537435815435,-9.737751320155759,-5.9052109010894895,-2.0291480161908173,-.6732274863062283,-2.5349231199544273,-1.4928680022381573,-3.3903749870397397,-16.1419377101607,-16.60010220586663,-20.536084987653624,-23.241972155064875,-18.787452324266713,-10.63578697105549,-6.628588839386815,-2.1255697955991932,-.6795031489691512,-2.6481876278844663,-.9692787176085648,-2.9990540820084526,-9.513213653374661,-14.9737868483899,-20.125794996006313,-23.811040676656,-17.095241298853693,-10.48488644140573,-7.083236298015181,-2.618010870248309,-.7542455825869467,-2.4939117830754833,-.4698765527026194,-3.763202575505848,-16.48627846785236,-18.312843257342358,-20.395666484690235,-22.38297204672673,-18.632103175620678,-9.93730840016869,-1.9290688833463376,-2.2094577579247114,-.6442047159088691,-1.7644619174508351,-.060794940534856456,-1.331220953859309,-10.331019320662984,-11.91601998892862,-16.230183868146963,-22.63608979799512,-18.600209529568854,-9.092732473749242,-5.855189799580316,-2.992224254968076,-.8008045776849531,-1.952642192958818,-.9155575978542032,-.8218374342232492,-6.087703874423201,-14.695005236405011,-19.359061024750716,-22.715657482847398,-17.42287277741507,-9.529960982113549,-5.604100556603128,-2.68486967259213,-.94960216282484,-2.8423459591769853,-1.1768914997624993,-5.096045541793443,-15.940197447795803,-18.859744607271566,-20.947140514576716,-22.660472537503203,-18.98026376249402,-8.886190819334875,-4.824040315621285,-3.0411942457547263,-.984994703662926,-1.5812195203807173,-.6339076900908927,-3.921366977328213,-17.01809388160119,-18.968168868018942,-21.869524238894073,-24.21992359838067,-20.429117179676492,-11.300085580416038,-6.420119165611007,-2.6789682043612566,-.9884439499578938,-2.494646755778863,-.7379152241664932,-3.3890191832079943,-16.340594026275035,-18.08955099860044,-19.401205598484996,-24.65326365569975,-20.28602836025661,-11.14285383185015,-3.1112399367989965,-3.086664187845293,-.9312181145526686,-1.7524298308807058,-.36126017496366264,-2.43403228926218,-7.651360468561986,-13.900171948430547,-18.59106936040809,-22.091543153512816,-17.60783484454473,-9.5613750045129,-3.9090322970468407,-2.0959609547874987,-.6325507273062707,-2.3159226798910284,-.335925269562561,-.6997752537366073,-12.248091801436056,-12.282444417139162,-12.526906748104977,-20.163577985149548,-17.380799275743655,-9.874082237034028,-4.179652967841068,-2.5476493978523496,-1.1850758293700225,-2.6128308962241196,-1.8944117107342235,-3.2301823984426883,-11.894811757261232,-18.918413757668397,-19.52426361332796,-22.498032315072642,-19.689769558893506,-10.735152164843846,-5.748434098411331,-2.4809252628064473,-.6825774887612729,-2.66213677267912,-1.4734707770525726,-4.67556460551144,-16.81446561998889,-19.13546580806478,-21.30783837491818,-24.73876110258318,-19.351777317064272,-9.480576031124395,-6.8572567880854685,-2.95783981135277,-1.285734856433423,-3.0099431048756955,-1.3301177691381312,-4.640832662238776,-18.17998409631841,-22.553684697525895,-25.052596002210905,-27.218304715249886,-21.68573392379193,-11.450830788295045,-7.8096150731263165,-2.5957559258663085,-.7493715294097866,-3.1378278932960684,-1.3899077835634368,-5.725954591788577,-16.575524704373898,-20.953853660607265,-25.702817571593926,-26.986745523872187,-22.184703285603895,-12.361467160608953,-7.456526774377296,-2.1224717971368965,-.890905647073468,-1.6419938410561234,-.5050438765304314,-.815087285771821,-9.765585347268539,-17.013117142971655,-21.29527922364608,-23.964220358461134,-19.69263493948021,-10.800017953835358,-2.9868418335529263,-2.621377394377524,-.7257833962905781,-1.1090832215116835,-.024440417583161646,-1.271232854181221,-6.2201198694618105,-16.801908524617126,-17.88258001313181,-22.241208530735285,-17.709114847815954,-9.150093866551856,-6.080112231857481,-2.6570688562036957,-1.00003143468928,-2.0534024212789,-1.1768084114763233,-1.2428862794254751,-9.416810087674035,-16.87411567305781,-19.68581192288803,-22.584293332029663,-18.364728986025217,-10.17790346346448,-6.198984335806303,-1.9446623685936082,-.7034748435814534,-2.178234859070873,-.028282609980758475,-.9072505031115516,-10.975320574132807,-9.556358961311426,-18.585189785633528,-20.887914735305777,-17.212692368251385,-8.850062902211564,-6.272785782215765,-2.9614760705665732,-.6142878857136121,-2.637518928142307,-1.2942139007115574,-2.1211786178581806,-11.228055984444099,-17.368945414236904,-20.438665158483463,-23.409398019645828,-19.31829927025021,-10.648164212148181,-7.29946474770521,-3.035274493770477,-.9174026633391232,-1.9324306049349889,-1.1618810359150826,-2.999808542747449,-16.957886805455722,-22.13132188081427,-24.24458948795144,-27.058712417029092,-21.622184435130492,-11.863882659305313],kne=[-6.465259378334524,-2.892687501765461,-.8052262863042114,-1.4722744813519135,-.15312121233544718,-.5783911504131445,-5.727146256805646,-17.066453480215028,-18.697183148732737,-21.742979156134975,-17.79159500541937,-7.262227221474988,-6.718131169196498,-2.0214324601517073,-1.0096436260006931,-1.8297592540537044,-.32090331785221904,-1.3296960875430215,-12.647826601924463,-17.507734305549207,-20.62416525880035,-21.895042954522847,-17.449774853634732,-10.234356216293632,-4.629115104484466,-3.015859467598566,-.964380474392353,-1.5779166364187103,-.6211232803848441,-3.767367684259204,-16.488173822555968,-18.294347159575647,-21.032382177692647,-23.27309126074473,-19.646843748497684,-10.743112992312632,-4.940615945881442,-2.651605136666454,-1.0571648622573333,-2.4992695364691966,-.321294013593245,-2.2233541453816614,-12.69455334701702,-17.02367058301704,-18.484516967345698,-23.81656621974684,-20.18613685701093,-10.45251567010904,-6.734659031032449,-2.9217132154941,-1.0364866997581001,-2.0168459402490275,-1.1616735502235884,-2.8100125802456875,-15.658037453180919,-18.906119827163796,-20.257613712984067,-24.82116029067958,-20.496059936446546,-9.483979521338787,-5.9624633622408805,-2.0383325503517766,-.6727473065237007,-2.546550164761891,-1.493838897892944,-3.36618574602056,-16.03139186691383,-16.477265378713003,-20.437338079342663,-23.385024628466518,-18.824330012540297,-10.593454496915912,-6.610544293466015,-2.1206899709587397,-.6736713469777075,-2.6361973390093714,-.9492624211593,-3.000208358684891,-9.510883374944672,-14.97134195890856,-20.09346894510816,-23.72592355121565,-17.031136283252376,-10.467647196578856,-6.433087707648496,-3.2386573086893784,-1.0882262358001695,-2.013216093584812,-1.3090326843150333,-1.3341219132442532,-14.52857241216132,-18.14262388956908,-22.177254506605646,-24.446220539592492,-19.343559227727784,-9.775006107869215,-5.613534602595714,-2.818538976441391,-.8833603806634528,-2.1250304888142413,-.25215244782262314,-.5570566627554389,-9.133143338348484,-17.29954802580783,-19.505814572169406,-22.625258801612883,-18.64921704324376,-9.079056225175949,-5.391228180010761,-3.109927389509591,-.9481398468933964,-2.6042346994762853,-1.2588941917749312,-1.9753439288648444,-18.004956699474256,-16.482252613280362,-21.438272337702838,-23.941378803017837,-18.303058997464976,-10.522470127470525,-6.753039885984286,-2.913822312031625,-1.029905805600515,-2.005688714739353,-1.1383529751027694,-2.8284466596321285,-15.673744196401003,-19.006170861802484,-20.38658772013341,-24.98100654052566,-20.69546812390478,-9.590608509510554,-6.85010044860903,-2.9391776066598143,-1.0538763559557285,-2.0312757480119155,-1.1946410498853437,-2.8120783326822436,-15.640295856966503,-18.936317821929624,-20.70582475656796,-25.03310597696754,-20.640017996883508,-9.632759475667202,-5.963608796211727,-2.0389329093537993,-.6735107138986249,-2.547756102271145,-1.4968776321107817,-3.369016504341905,-16.032114208834077,-16.478962351851834,-20.451468143213685,-23.435653468420035,-18.86152263941261,-10.594647691510266,-6.339479653512973,-1.7774636391093204,-.9648832202292006,-2.140686859296698,-1.3229557679834394,-3.352324293371543,-16.254384191811354,-16.653630840122116,-22.670164937990357,-26.590628697787384,-20.32947368548744,-10.318504192893142,-5.958151645956583,-2.800732050014816,-1.0616750875929366,-2.4022629534889655,-.7164798895754085,-4.668435053459836,-9.447166127748742,-19.39952586858146,-24.481444738563837,-26.912959083798295,-20.727809999078367,-10.642892618697442,-5.797866818609044,-1.7434917206461302,-.8097262173494306,-2.9186314596635565,-.8110127452799077,-1.7180577971863475,-15.822930081851135,-15.852318677698035,-19.665054123148888,-25.256239022285566,-19.78179699755193,-10.629938876388977,-4.239090409818752,-1.8734061823743706,-.6316954117009574,-2.3597715630134117,-1.1242696120010462,-4.283461790184576,-8.056467959865124,-16.76077927020323,-17.113059295243314,-22.446975649227223,-18.31447634706378,-7.618665134721774,-5.44168970020774,-3.0562007929479758,-1.0994886566868587,-2.494112016660923,-1.7963931915286506,-4.552221531909897,-20.09059533372504,-23.275411841573597,-24.804106733482183,-27.26701709257859,-21.990536257103397,-11.523433250345494,-7.7425433043100655,-3.70574540952375,-1.191572704138872,-2.1316086980247397,-1.1107361325945895,-2.8798019723826145,-15.769847888803058,-17.609035812744107,-23.841788469117127,-26.895457347550057,-21.187736804162576,-9.602183081787897,-6.552510577029016,-2.8718454533701374,-1.3616710493603161,-2.0412210371607107,-1.1534584098014329,-4.932775022153484,-20.210690898993942,-21.15331141500045,-23.038664299176,-33.197384129351946,-26.507613292893026,-12.703528641212143,-3.984979944783568,-2.5527736849101115,-.8771477391691566,-2.859144119583985,-1.1511040993891237,-3.22728223599037,-11.730569740357977,-13.740074617453049,-21.34843046565116,-25.417132768001455,-19.265919462768625,-8.922538402870137,-6.695088425287546,-2.3398975574362124,-.7000899162405694,-2.453268948384992,-.5177954650705333,-3.149940002190541,-14.006902981836417,-16.442395505797236,-21.95396376945521,-24.9675396691627,-20.871908676989396,-11.61105734882683,-6.604676574875132,-1.9965227477943386,-.749577190538696,-2.217089183539954,-.03763796461527405,-.8965087181592323,-11.066826044997653,-9.569526800587097,-18.634721961937686,-20.9342714094718,-17.267524851505904,-8.862392308275794,-6.8254524010374205,-2.019785087666069,-1.0080892136308255,-1.828945847726603,-.3209486532752312,-1.3876778963896432,-12.710747418223049,-17.5195124075119,-20.640156614281647,-21.912794708824734,-17.463412216712605,-10.238839434908192,-3.998183734310073,-2.4702697190078067,-.8887938662369793,-1.77594367885392,-.39529717753111937,-1.8154664874745496,-12.244745075816377,-15.220600997937108,-16.82126978857957,-20.540758347369014,-17.086423227339967,-9.174590436528817,-6.632854839203798,-3.194622354377197,-1.1778288889988286,-2.1200719124877514,-.6349353972915295,-4.25266336747397,-16.729577777128164,-18.657415103119188,-21.88225581118876,-25.900787635803628,-19.503869529430602,-6.004970509547872,-5.7479581431413305,-3.186759474257699,-.9866517133520091,-2.6384739473239276,-1.3356229411884835,-2.074239893649554,-18.337197383886792,-16.692466814751896,-21.742204414302062,-24.42755114693029,-18.64221440202635,-10.6887863150358,-4.433786082460511,-1.8836270947896145,-.643678289963644,-2.378276487946133,-1.1601226944678145,-4.292819893060535,-8.142700101624454,-17.045618461314543,-17.2232170124855,-22.860218234783698,-18.657682526170294,-7.782157442192363,-5.3268298176366375,-3.3556981983122305,-.8707529508082631,-2.153058925477507,-.42469119638668995,-.8378636693488418,-12.44297480868386,-18.700852741864715,-18.733058400324417,-24.51401938234914,-20.60317749467174,-10.324054666861112,-6.188579279335688,-1.9680723105831839,-.7239898125304836,-2.1945297019478156,-.032003026457042685,-.8772435926502553,-10.958474219270599,-9.561520652648746,-18.61836494297764,-20.917472925195153,-17.228904421723453,-8.857231823817957,-5.761433821691946,-2.668194218780871,-.8279701106129201,-2.7110505845368675,-1.6637943993650888,-5.519837373591459,-15.911311781292294,-18.83667315600355,-20.871999784582332,-23.66561369250256,-19.074258167942713,-8.571917265806041,-6.713739051785964,-2.145672197141271,-.6803393084393096,-2.67748538901804,-.9754791957497551,-2.9788849047805486,-9.481018871555765,-14.909224835651335,-20.043388638736477,-23.712514475593643,-17.043271402359263,-10.436526031658605,-3.8189391288666963,-1.570625434593762,-.7397826087181252,-2.6763127015759864,-1.411723517792266,-2.793836335339111,-16.988547696123124,-18.839753243007035,-21.497012944261524,-24.2028394787937,-18.42488046327453,-8.005474944522806,-6.883430229535528,-2.9494125819213224,-1.0516389339347059,-2.0296408441648963,-1.1686299076820408,-2.8515080796306975,-15.859272576028362,-19.10991607880572,-20.95766845662876,-25.25397619503074,-20.817821767292827,-9.713759430632482,-7.097172924471279,-3.458474511665394,-1.0756952404594138,-1.9988508046055193,-.9719636093556008,-2.737185351686474,-14.663303541128036,-16.255420103657183,-21.851377922357912,-24.69473623879096,-19.456537492260455,-8.73528234192143,-5.323720829354839,-2.710286854184264,-.7642946525522389,-2.229011536638375,-1.4158894274686373,-5.272937524243749,-13.012843545829334,-17.187940993329654,-20.04353300132347,-26.123819532784598,-20.267798460924542,-11.344191949807488,-5.5766215974819024,-2.7537824675944007,-.7964244184747705,-2.2504387841110987,-1.4996784630544757,-5.598704602932039,-13.820286298742193,-18.593237000381926,-21.530045581168444,-28.00995162060225,-22.10902496250631,-12.44917780787451,-5.197973700674779,-3.3284145198665747,-.8063846121500291,-1.245949444655325,-.08906775617231555,-1.279824312571881,-11.219843982793318,-14.37991284629504,-16.22176948909207,-21.28990916955042,-17.566142310085475,-10.061875229448745,-3.5827457803033393,-1.9349623104145337,-.9379481833583498,-2.471852608891785,-1.8021220154145472,-4.664833523011978,-16.786370218257186,-17.34705367039548,-18.545946252420308,-23.66007298740104,-19.207902663842038,-9.653518423755305,-3.56356097571048,-1.4962577851255812,-.786762979687821,-2.1886537008967393,-.7603940581196774,-.5990485196504879,-7.017779445827962,-17.23364525459719,-15.577714243123006,-20.63045317553953,-17.024673618232647,-5.959098077042041,-3.2394076941875016,-2.882200308724719,-.8805764570663495,-2.012564873118409,-.2303263783466039,-.5043230128774112,-5.873469872209318,-15.382003621876644,-17.07198560852437,-21.584526397486645,-19.263488535066433,-9.583252898169231,-2.088095319920446,-2.8103141016752686,-1.0590257415048268,-1.9800031001750473,-.5617032043491107,-2.4947585932060066,-13.20701485923989,-20.412033408268503,-20.64636352110056,-21.68267755524576,-18.558101242112727,-9.663885937503427,-3.51508681164063,-1.4763573815075213,-.7637555277769179,-2.1684238225811523,-.7333635933070155,-.5864924885774635,-6.982502323643013,-17.153985013757747,-15.49879284536205,-20.524164606466957,-16.942018786528386,-5.933143190167283,-2.8971309863441115,-1.4264559594954431,-.6586211281260724,-1.384947093939191,-.023064248111667452,-.4601817543428594,-5.533741918049988,-15.417884973035155,-17.743258354536117,-19.92424176321126,-16.466208170708864,-6.9207493366344135,-5.708905219147445,-2.644622942415223,-.9960452430338212,-2.0515987096061665,-1.1768130780733204,-1.2560120701564625,-9.425182009422796,-16.94070923708739,-19.726748223610503,-22.645928940366673,-18.016577865960535,-10.142638430199108,-3.553818241270977,-2.698133899456127,-.9946245599611592,-3.0612747550970902,-1.7907515383686994,-3.708954827700211,-9.208908673501229,-12.890011283842908,-18.635524336498424,-22.919683550898778,-19.054379021404966,-10.164341082180284,-5.6434156220135945,-3.180823730389206,-.997478098835977,-2.6407168616284253,-1.3693195619924863,-2.02976313530353,-18.25922406480482,-16.709523485553024,-21.9507085037682,-24.55222549948434,-18.75573706111032,-10.764502357653255,-6.078057706121148,-2.772848650542273,-1.2312799003548802,-1.9873188292266801,-1.060990576759294,-4.701415501188982,-19.086826883184585,-19.681637740774775,-21.009730295429986,-30.04750165205875,-24.18658261852199,-11.362306955520653,-6.153801952504095,-2.328234998715657,-1.032572586575966,-.9801476470860515,-.7761570857076423,-.5199421750791143,-9.414471588731928,-12.043216937968147,-15.40404309883213,-20.487914781724008,-17.740366942730553,-9.425523624487697,-5.135135736226639,-2.618336259482297,-.8573808164026325,-2.4335425643361757,-.6712757689967234,-4.009324118010521,-13.599473353339095,-14.274643598323557,-21.36149516737631,-24.251695021337568,-20.158625539193253,-10.472255638950326,-6.750033424293765,-3.0417734701482195,-.8543410290072099,-1.5609651539868503,-.1802990919813251,-.6070361317720627,-5.7562449810091945,-17.11383779152793,-18.75710666850643,-21.81288337312394,-17.84563945701048,-7.282372633381147,-6.050477612368889,-2.4768877099551796,-.9461038711114788,-2.465215007757495,-1.1681554309715043,-3.376197424809874,-17.198014833756385,-18.06612753604913,-21.47134288757333,-23.820234307380556,-16.972075778591424,-10.355685100398153,-4.379741838910329,-1.884411286202933,-.6293616025200167,-2.376431047748543,-1.1304928408767452,-4.300407771110451,-8.135058576839093,-17.029195918263547,-17.068123374693503,-22.733302060052296,-18.572507018124092,-7.742787166074125,-6.055264604399783,-1.731259026761218,-.7726097126506062,-1.5119190392244,-.4237208102676398,-.708158149755152,-9.324864040599591,-16.157967633948363,-20.130302294786887,-22.686919870679056,-18.77843796627775,-10.153456757570465,-6.729968054553368,-2.19005938146087,-.7189599495027149,-1.8235966389181542,-1.0583995121251335,-1.763308800297306,-4.643152877159417,-16.40326742070387,-15.853985100147785,-23.01919732302089,-19.622008912463173,-9.578729051487452,-5.901741506668651,-2.464889845943927,-.9405138142146972,-2.4476292672226663,-1.1487571832749843,-3.3954004737605734,-17.255821340521074,-18.160189348411755,-21.689962329419693,-23.968789928664695,-17.06420771285506,-10.414662192034061,-6.892250804671391,-2.5012721545213172,-.8725034020681397,-2.8596223303575865,-1.3770034870460977,-2.9503046607097123,-17.04575045310965,-18.064237312774317,-20.482368336797165,-24.88672367824767,-18.823001489190112,-5.701771130351515,-4.271285521155788,-2.961904717227627,-1.2874332937905943,-2.3650705098830938,-1.1019149404437452,-5.0525910136822985,-18.226103492390802,-13.202806365826785,-22.582999588001016,-26.332473129548244,-20.639945623235768,-11.080365345356627,-7.518935483987178,-3.2483465147012094,-1.3438070166383005,-3.2226384231529823,-1.7628945537030378,-1.0135563983946672,-16.949358529012514,-19.95043591217499,-22.290336126011777,-27.75748900833814,-21.284154826971648,-13.244233527217514,-8.54550447250038,-3.259827856780363,-1.0098505838003669,-2.0665168627374833,-1.357900519187303,-3.364070922529489,-17.53639031679653,-22.933954788500994,-25.107526112925363,-28.04614148390959,-22.469233718130052,-12.370549769624215,-3.659545688626151,-2.5912314394725713,-.881995844048722,-2.917630135550774,-1.14406065867185,-2.92804790587341,-11.435130159701602,-13.289525112318476,-20.63178649191109,-24.726239438829936,-18.709315994800136,-8.628665642280978,-6.900686166039321,-2.084027733189779,-.9027634262709892,-2.4859228735055807,-.26527778962978166,-2.0657745821466316,-15.304142751148978,-17.210693376170198,-20.55766241258143,-23.810926266857933,-18.818449737461638,-10.30409736039116,-6.419457882420013,-1.7221336999458594,-.7863611593646664,-2.5401162935522614,-1.2755827021651958,-3.6411569471643546,-15.675892092083082,-21.064478074034614,-18.884855027981555,-26.57648407381981,-23.216136274377828,-11.780234252799083,-6.029370313363363,-2.3126544796523625,-1.0011072619527472,-.9465154361744902,-.7282758131297659,-.5234762100849694,-9.419195683900389,-12.077220502975393,-15.447151178700336,-20.573076591908507,-17.81263716213362,-9.448000814616199,-6.049558264310236,-2.9617497322284505,-.6142744305884846,-2.6491376279959487,-1.3018154497202692,-2.1185306527421863,-11.224990744740428,-17.35453010256031,-20.34563215691061,-23.121980576806095,-19.21333697633613,-10.602132883708862,-5.706914905442026,-1.9508219123716268,-.7879414557503631,-1.918862695525411,-.8490519416694258,-1.1219918837834317,-6.645839620988883,-17.53057827008143,-21.052438566949295,-22.9606627637953,-19.402113844142935,-10.267766260710342,-6.645826031839583,-3.402953454682646,-1.0290578544134044,-1.9742848752367332,-.9103796007855154,-2.696624589710856,-14.630368001331474,-16.180448652779162,-21.87844001752029,-24.58133064219265,-19.3262898475581,-8.686828053097381,-3.8170888263331215,-2.102401138246913,-.7215274838351272,-2.397274455758133,-.8091199158520808,-3.477522759031397,-14.058510211125528,-17.533225441528526,-20.509330252201,-23.74002155847043,-19.578501406998658,-10.945735887267404,-4.397582188194302,-2.627700625734699,-1.2448108110724827,-2.6784983000745544,-2.0228537698336044,-3.3584734953212103,-12.522148999005356,-19.645472694781724,-20.64532211732314,-23.349775848583732,-20.4610319304456,-11.151444129587173,-6.275000588855617,-2.6492487362678427,-.9611763733164709,-2.474088224350388,-.7237703871518152,-3.3399221899002396,-15.884979924858202,-17.584559478343078,-18.85246801539829,-23.948948742158397,-19.688901084162758,-10.782344326507125,-3.879894700450777,-2.1213347983131308,-.7330200561989298,-2.411831097018635,-.8172394760738356,-3.4515352814619185,-14.019967659101532,-17.47727649757117,-20.45799281926028,-23.664562238082265,-19.52411360944992,-10.91831287481297,-6.753492426223286,-2.184969230912352,-.7196246698014702,-1.8168394878694853,-1.0527835965116275,-1.7588218741249124,-4.638751701212669,-16.378404222413593,-15.829130714960801,-23.020849321430596,-19.625289355256683,-9.573224497265386,-3.436968578357684,-1.5611081367168815,-.7253728466367654,-2.647700513215914,-1.33015590392551,-2.7277920071897195,-16.912025086674014,-18.72800270697148,-21.34764122539639,-24.334676653870282,-18.354357444168496,-7.939708037133208,-6.573138582320759,-2.923138580607772,-.8302455334806759,-1.488085360040382,-.1599865457850939,-.5902065442307921,-5.710322816931369,-17.014190028172617,-18.630949160253905,-21.673333692968484,-17.734011182843336,-7.23795165569514,-2.089182620164731,-2.790270782937282,-1.0597880192165767,-1.9803826470792811,-.562148691592812,-2.496767213764534,-13.247710160031426,-20.456110326537097,-20.689549665494418,-21.69238563851099,-18.585735626233355,-9.717511654910714,-5.578481149989258,-2.805219201834967,-.8743484351337546,-2.111512341475386,-.24617498960252127,-.5540842969987779,-9.163045263254329,-17.317641720459452,-19.515262126188034,-22.624655076407628,-18.667612905190026,-9.080296856263212,-5.9797712274299775,-2.6534090497834164,-1.001735703883566,-2.0550193616962584,-1.1787500673404685,-1.2660671947015945,-9.485407362095685,-17.062244623245146,-19.863207858551213,-22.79316826639488,-18.128798564483155,-10.20756222560497,-6.771206395253692,-3.0503528112881857,-1.170685244461818,-3.0157987593952877,-1.5098381760811979,-.9348395273729169,-15.844511541698699,-18.32624922095244,-20.508402924766138,-25.64488790220734,-19.661294511172834,-12.10203885195595,-7.500081843404319,-3.1247042203781774,-1.1646662818933657,-2.162214926744695,-1.3598082640549813,-2.9286631863126695,-16.221798802476933,-19.873875044390335,-21.431575213408927,-26.142031136857124,-21.549872716682376,-10.136314694345343,-3.902920958165009,-2.146432920253241,-.7557496781385079,-2.423532520693945,-.8205383535910962,-3.4674252699490737,-14.031434261368464,-17.502089015027583,-20.471245255547682,-23.68336872910104,-19.536436425191543,-10.932441233012085,-6.906332040778409,-3.361199219069207,-.8549802247033345,-2.200777264450215,-.37792136832014384,-1.8389885888030595,-11.734834443710527,-13.243076661115936,-19.0174711744363,-22.85767789286738,-18.70243387078396,-9.548051479038193,-3.392022597356958,-1.9213991165497333,-.6160784292408595,-1.4347405555902006,-.6590419110845344,-3.7937660569728573,-13.473698866866735,-18.2664956762072,-18.18609707268695,-21.73032485127312,-17.417061326567367,-9.878990111779153,-5.96252670529803,-2.7300152531064694,-.8439682625664682,-2.7638474011721375,-1.747804294740228,-5.704442472734754,-16.126187328002008,-18.950325380723495,-21.009867720079907,-24.359095496308683,-19.19027703446111,-8.61679631238627,-4.961805737511718,-2.6829585126458197,-1.0774044283671012,-2.559032674150206,-.3506797970577472,-2.159980250256736,-12.626561482533646,-16.86658685266174,-18.327126541573776,-23.633781549894078,-20.03811952352175,-10.38838565789327,-4.309704320556099,-1.8618839541494274,-.620862168594243,-2.338069611145708,-1.087117791572841,-4.288561729252566,-8.040296422368796,-16.743871572848693,-16.7927542101063,-22.38408750489626,-18.39458169015714,-7.57245917683285,-6.530855679027895,-3.013163753035973,-1.1508409891760232,-2.9776300463384406,-1.4607844658535618,-.9123694162781595,-15.570918273870669,-17.984090307329684,-20.141334323844372,-25.053747194465004,-19.211407530349547,-11.843182854056254,-5.942833320934495,-2.0491532877124277,-.8408766877180727,-2.0248546665234763,-.9373692239792258,-1.1324453845765388,-6.73995013188028,-17.468058966877834,-20.96260760570583,-22.879379496059094,-19.327575978029525,-10.2220877231905,-5.638563534025319,-2.0240301455663907,-.6611271349806223,-2.522515752998552,-1.436534338024904,-3.3132485156863996,-16.03673467462334,-16.48582521495047,-20.47252945496909,-23.15675742708891,-18.87307348576735,-10.596563470456204,-4.874502895966566,-2.6402243784000983,-1.042480341438297,-2.4990697744435733,-.3218200890896933,-2.1621311901883753,-12.671574369592781,-16.920840966253493,-18.386605221229562,-23.696316939008607,-20.089496185258675,-10.410725182606429,-5.4706931745092895,-3.3505932015287887,-.8686122724882999,-2.151214933943369,-.42253937657228924,-.7732191612905676,-12.362001405049671,-18.419663444564737,-18.402477091047686,-23.640950627297297,-20.181305215245487,-10.154764562623235,-5.354665732117687,-2.7938893427386153,-.8651634803765506,-2.107344703744371,-.24071056018638143,-.5565180762534312,-9.154542430601303,-17.325796049673517,-19.522552264684876,-22.637925522837953,-18.67742379801182,-9.082766400093242,-4.800421706166012,-2.4124395283053706,-1.0101060759190013,-2.28045153481213,-.6892348515899754,-2.534092450791846,-12.7132561226755,-16.932013780468147,-17.82449393141601,-20.6607229187233,-16.44830864412329,-9.947360353844708,-3.416296089628003,-2.8984408239884583,-.8833087156593383,-2.0027630169300683,-.22640240581449167,-.513670133813388,-5.89488208236875,-15.450443683568562,-17.151406990609157,-21.666456698541833,-19.37278171449548,-9.635231098849586,-5.622648308750676,-2.6823438616031283,-.8273388141434577,-2.7137346710858243,-1.6617880749810585,-5.5313244180335115,-15.945355799718524,-18.859462804790617,-20.834773975139232,-23.553852730000422,-18.96047587981112,-8.508201158110493,-5.289798342978254,-2.7307769461836178,-.7631098252270243,-2.2580923835408053,-1.444444569703978,-5.219063053404126,-12.890725561112047,-17.01437511909057,-19.741538736198088,-25.743111214812174,-19.99250843753344,-11.1904147325866,-5.419358922149879,-1.6600323853741519,-.9498748435271269,-2.475728331322535,-.47835397937932106,-2.1843058629227747,-12.321004158933281,-17.437030540725953,-18.612217418850683,-23.97068163541296,-18.65537379713868,-9.38157706085843,-5.351156715836278,-1.3189117972488837,-.6365765877910221,-2.7448058067449077,-1.2689601086782538,-3.3819042014700513,-14.013458187299156,-13.82428879999643,-18.98635980795312,-23.154433078686246,-19.31845067094379,-10.002900242206792,-6.755765487241093,-1.1328635292283786,-.6817340656143704,-2.590800272097561,-.9582232985366119,-4.080902409911285,-16.131473934091183,-18.89222736150649,-20.56521232769062,-22.532667909498617,-20.035235706065606,-10.217314932188385,-5.361321738531962,-1.504938544573918,-.6277801447534453,-2.9373933923754416,-1.1042124396030253,-3.8566455567567663,-14.606144454720303,-18.93333461325323,-19.540939897038083,-23.284411913051844,-18.38328860322197,-10.48187820578918,-3.5133451422971635,-1.9187738233633822,-.6153940289255021,-1.4307711670153327,-.6607734350736847,-3.771443637559324,-13.359683518252147,-18.094259746061542,-17.994821321896453,-21.505417052469625,-17.260241769404217,-9.783116658142513],Lne=[-.28566258976648584,-.15199756558705438,-.02341326900849085,.5536705599507913,.03258085167929372,.9288557961593887,7.236150591231557,-1.5412382008060317,.7552832658382254,1.8322008677936807,.5438203609546954,3.406359374191849,-2.654032774176198,-.1622877082586206,-.3931639330165138,.4988685473715022,.7276862500650024,2.879250345672337,-4.672636175465958,-.8597980801662731,-3.915047569950582,.36020611394288726,.9002165143581454,-2.6439868607473898,.8027018374947512,.03853479911546427,.133392123959981,.9147880041800339,1.1730055488757198,.773234519978925,3.6048749549410166,4.977795706829762,3.6923115694411885,3.964916758051212,2.306303711068135,.7668097184650083,-1.4960186626460934,-.13839545670603257,-.21344843147503903,.3364200590930765,.7660250480865433,.5273660213513901,-1.3621837064441376,-4.006999649361832,1.734742285704566,.3157738905603927,-1.8540549180153374,-2.0127858154621396,-.9186166855662183,-.15182329511238954,.0029897163084539125,.36212690014814747,-.46257051388688875,1.6918521135330167,-6.553966682886131,-.19669818387557603,3.2371973661323,.95669587863111,-.6127395040909084,.6125687621817293,-.7591598598293615,-.3701197779309942,.2729743955690418,-.06511154944943291,-1.0139096849014062,-1.2561496641044185,-3.756451133870827,.9170793548584728,-1.858611344289471,.5630453503152274,-.1678841290098063,-1.2131978024976406,-2.660179889189152,.21588780645708364,.10892258100652781,.1781568453095428,.286931846626599,.12759515998627377,5.742540671480757,4.40077813133398,1.214339779959506,.3427552428620502,3.1705234529531237,.1694870456235693,-.005743729167621189,-1.5143248637795208,-.2998641831004621,.5290994735687538,-.031408691449000756,2.3125812820923413,1.133668459178374,2.946000342823189,-3.2559434217118506,2.2112753738755693,3.218244958623855,1.8681493812165637,1.8465419724079286,.7324495011433519,.2755113229670665,-.09713915380798883,.7666576231814194,2.3196482847436535,6.0535944270304025,-.3778473994770143,3.408638559280768,3.10434662984966,1.693394843238008,.08115018665744007,.9122963956689703,-.2858391216459624,.3522074673069927,-.5880055223805796,-.1481767461136569,2.8501124197108867,2.021814199041179,4.184135906008106,.6106178760305622,7.618889639659596,7.047813833710233,1.5163025513539756,.5115212994514395,-.4338999702113596,-.2788832768227309,.5993106119579222,-.5178278853827296,.5996817415187475,-.9566559338062501,-1.564107224166108,2.4568938573425263,.9092806369225199,.6089194887244211,2.5282560113046992,.5237628504055956,.5606243271127944,.05239316341461444,-.10094903185752363,.28805859242455295,.6783946794475614,2.755109339151751,-2.4693623866723544,1.6633734536121185,5.02263853169044,2.933808351153317,1.744794425568865,.8670198315182122,1.6549180484378643,.23290141845989454,.20754756507553662,-.5269296107816,1.7257833714618915,3.822514278566346,3.8510443478781995,1.1558951473459853,5.276171307739199,5.143519673172859,1.7091391279605292,.07111912248502193,.29556166656280125,-.1106415941457614,-.09439940018943767,-.34549347597792407,-2.162030950833471,-9.270479452105816,1.9420534400175191,-.41177880328491434,-2.352804007472958,.4287105125090195,.5944153873805911,-1.0690882660201482,-.11206386011654543,.027037378032163436,.1299697148568379,-.3845288892438661,-2.508085217970371,3.285568116276063,-2.2518771021799178,-5.887111900069375,-2.954626193551022,-.3006232473410383,-.09616999458618113,-.21843034848488524,1.623529586391892,.07044285780667454,-.7604583616717339,-.38849245929101583,-.9377066882886699,-3.347136344262199,3.088057918532448,-.784194413809272,-1.0868897595145133,.9012454300970767,-.22796771950966965,1.203428353740131,.9488267801604087,.2612240314089868,-.2320141386670913,-.8766016513362145,-3.7310710162319216,1.091421160482816,.5395294174450626,2.380623857241136,.163148980629892,.3221880556329013,1.4536391026952276,-1.3588328517987858,-.0455591779758182,-.1318097375602831,-.012886438664458075,-.6331101170899126,-.9003556580159404,-1.7646273626948616,-4.977094357326718,-2.611905523402153,-1.7084766165116143,-.7593710956599752,-2.4231288600312393,-1.797186136207853,-.32578333868102344,.0502090152068522,-.7282392334876981,-.8429451817263239,-1.1965914894841774,-2.585722659902587,.8924776404250228,-1.7138037543200186,-3.3922862668462015,-1.760456691913192,-.3039503288229483,-1.762924814472065,.21774224672174508,-.6005805583515421,.0018815520092697897,-1.044806068816112,-3.9728945009538634,-14.242484489188952,-5.74910337094033,-5.165802798435074,-10.709337573403653,-9.655807208478327,-3.5937583118199474,.2428887435755397,.2087220030979769,-.1573446010047755,-.6960417070417297,-.4814306249389848,-.8754984163567061,-4.097408837414673,-.09298094405669846,-1.710260412716648,-2.017740072061805,-.32724218203130906,.763650907281187,-.7026132508731833,.3567640784105891,.18766403353644484,-.23023660737117652,.5479776289386766,-2.19137626185464,-1.2481739257235431,2.2588544663000154,-3.463908773067612,-2.106901993069827,-2.0682472011806907,-.7392437866137791,-.6323592266824236,1.029707189298503,.21559030362233322,.13999915301838667,.5066365220791839,2.5528622495052793,1.1063787658543789,7.5817492424660315,-.7591038941300611,1.96193651782055,2.9856897894440158,2.4952946985899436,-1.3074810966115398,-.2894519676177791,-.21168265761519203,1.04955383791714,.44744097620212486,.26883832826229215,2.9646484980331365,-1.818826549449085,-1.1037509354585662,3.2053631276104144,2.40141887140266,.3443282578067151,-.8611058763027434,-.21571802766977521,-.17178430575687756,.9813160427211609,.42634179957237145,1.0627753558581619,3.8889583782281187,1.0901809360316912,3.028406860494179,2.6831760584349627,3.0482557354248767,1.3659830641598187,-1.020241576175371,-1.4022143183791123,-.4109417266900079,.6774207975525373,.6374468187108842,-.49288266765118627,.43562981728519995,1.2547190088556532,-2.3893452739355636,-2.1554610839812955,-.28035656780194,5.461597725146487,-2.1375537582349344,-.4669681096530901,.048024741286305114,.44560830611821406,.5061204588080523,1.6540307882493894,-9.090862021996426,-3.7317631033404624,-2.9894767798182813,-1.1444774786974168,.6110222669400979,-.38249717816678835,1.3116573054459366,1.3013356484899736,.35565262625221755,.26084794768510544,.2075845347153469,-2.2360013776067804,10.397644203199262,-.06846918324394773,5.074562734001501,2.0891649629460836,.374734355407085,3.16827926259113,1.6447161234301935,-.41637435265549355,.1869402256681726,-.13875936865824065,.7509143526550277,2.062355129933904,3.2476738595088306,.29489483785229886,2.0889249979367217,.5976759486560592,.10092061898341155,-.6572050479863912,-2.364901206842511,.13192855008333576,-.004411182948291135,.20206795666818275,.7781143273445548,2.5366905505858854,3.0176070271151767,7.844421084354548,1.7449670882401354,2.6471257088286126,2.3395939769424348,2.017264775602917,-1.08199946696877,-.3595788087774275,-.12648889054344112,-1.0379854205878416,-.9152473007499391,-4.647288426877586,-5.690005400381247,-1.07192303089232,-4.304412807472557,-.9679829297340172,-.02656161724677359,1.356047614760735,-.05479218049068577,.22265822005445027,-.05567075645495116,-.03914592122873952,.4847960956355008,.7133972858606346,1.4849791365598413,-.21927578036828155,-2.8259483417656446,.6179324122790985,.8407795076156798,-.0768184323614856,2.279069648652677,.8505745026439819,.32184246351859647,-.2935922062915955,-.2801522381995595,-.5949119140217308,-2.6929676646635565,.1599955651844448,-2.5636998963855153,.043842143851294244,-.7838159225784256,2.0615059245721383,-.33027945528183633,-.5262421500194612,-.2327203112329658,-.2081093857115485,-.28223109899198295,1.2373528807605256,-4.206523908042324,-2.426609822952101,-.8827614581613944,-2.110979811898235,.06452817885661281,.9379889764927232,-.5514212192576211,-.8304640109873739,-.4325107089380732,-.1987694834653506,-.10210922970573173,.8716907902076412,-3.727563799489121,-1.5790330005154225,-2.4037988960597425,-2.296321514782686,-1.6361423924928042,.5639059114207494,-.9298242664532305,.5994076205900329,.42697612415966146,-.02943092216737271,-.386856761932142,-1.576053820943557,1.3444382844444844,-4.347397854874239,1.0921302285187466,-2.23084648529474,-1.2924373675805674,-2.831837487930609,-2.051296606505417,.18122549469932792,.12424233717858946,-.22130707713844472,-1.2404345731749176,-5.09219972044602,-7.924731351653943,-3.176848112992737,-4.42014945401738,-6.378626159464025,-2.782376410507656,-2.8490054026060387,1.3161191168728812,-.12562504800798688,.36843017987911164,.8731742726782141,.5450662891950381,2.958873258165785,5.474524259020948,4.256554527527888,5.679100046680209,4.139679344239227,1.949377137266821,-4.057901839642996,3.2989910005999237,1.4941259977831318,.2968658013826868,-.1527426454559315,-1.1571990782485861,-.8640293567344856,-2.3906504035956777,1.1247351999028774,5.0598968164311895,2.354625911675783,1.5411197199038937,1.523935145091633,2.984228370117483,.30070246678108564,.2296980979199633,-.014797078671447635,.6564702344328277,2.807997202334322,9.666824888834984,-.15224786429198753,7.893428172298897,6.8095170254437125,4.014440027931042,4.7935270062150535,3.891071290334252,-.8179079363494032,.026116203238042306,.4572760181111643,.03319491094169846,1.731426965971052,9.74816333873208,2.3595101140494665,3.8932942064289953,2.932571957385756,.13063995347000606,1.0726784458463652,1.7256979332228386,.36700716731284727,-.047608956589396574,.5899461851286848,.15432555571299753,-.6364064224116932,-6.325291764470742,-5.456884074300188,-2.313650266303113,.24340804446060518,-.35808164707095075,-.42762594584315555,-.03926940012433356,.45376771390263515,.16871053018701876,.29301202547477806,1.0512976651415793,4.105659189633805,9.847585933395465,.27950085112402906,3.159579289684703,3.319036060040696,2.387061434952187,3.770136447923671,1.281932441256585,.6480742424479988,.02426404691910531,1.1351924058514398,1.2095045244746638,2.6521311943568486,2.823069433489971,2.1970622068347017,.16866332001892656,2.1667895251765823,.06737381630442627,2.2277388402800877,.7764048285995948,-1.5196987240930069,-.32738455905709274,.5125054368625986,-.26274745034829894,2.7592982105236232,6.677858419385305,1.900254159529992,.8739324036095026,-.18221985573965066,1.9545317455036024,.025090862594932584,3.2156826630973905,-.5052035235012311,-.2619162143799346,-1.2354065747996048,-.7109357246024388,-1.9543374900414232,-4.5657557963099435,3.5268429745658945,-2.7842932970172347,.09632663613878717,.5966989982262126,-.5713030822876537,.25840765381598474,-.7158544202206224,-.05688217151527787,-.19316755269047803,-.22064903524848928,1.3005001098060034,-1.1532995455380302,1.2811510485101378,-.485908866931133,-.8300496479706418,-1.6683128241214276,-.44069831790246244,-1.0949174319773547,-.9778407914760768,-.5298706873628117,-.8876737963372824,-1.0424787376435316,-2.601403783242246,-9.15885709752531,-2.103031883420119,-4.221167574437198,-7.911369595506339,-4.783229215710076,-2.067427325731497,-1.7709528769496785,.2999640060841819,-.11460755692647273,.7595458281685763,.3033828284772761,1.8541021066454177,5.523493789798685,6.7921660295256565,3.623716182507065,3.150217448577221,1.5929926469176552,1.0132085069210737,.28649715635514966,-1.3031137194829767,-.23100486388735608,.28648829963269673,.5579136935975619,-.6112533400988611,.43593525206830236,-.440408797688575,-2.365119121679552,-1.1077146592643667,-.840066993348522,-.475719817886186,-.7619813900400773,-.3252972995807185,.005685485941298859,1.18887132455835,1.5918669216836434,4.989523187389549,10.092304150781837,1.668327000762881,2.0180159514862543,2.3049789220396364,1.323205539010775,1.2416345084724512,-2.4109368749082267,-1.5204867459002593,-.2649556615409905,-.6217303650053011,-1.1277689328361815,-2.243468107599234,-4.286443447625099,.7103906817564895,-1.4275769669976304,-1.406876615031856,1.260422571610587,-1.1835731039604103,-.8256305154390882,.26573826906933207,.08702409701895986,-.16324919370500388,-.020840191418150893,-2.8823571696995254,3.731646895985653,.8828174739623937,1.8891348429642676,-3.3639655697853086,-.27769503327573575,2.8037278969269237,-1.3648014044264778,1.0686858562165285,.04464361941035213,1.3135510025891874,.2799593948608964,.5982990028944326,2.4436318896202303,1.8141211567945172,-.9117003940323526,-1.8938001740947428,-2.538802674230044,-.10970294365325503,-3.527873937042435,.8307976265268945,.3730129635002287,1.1648016181527618,.41469795484062316,6.018912814667171,11.424283779570676,4.361014689404451,5.569939891321192,.958054028055158,-5.075687514619125,-1.8992784453803797,.3822969683416926,.2405894421833248,.2671156750928865,.13704751538503357,.46465293679033015,2.8878206279466467,4.961537128505316,-2.623897708887362,3.178730392243876,5.035427827926451,5.900130539605663,.5040716649860414,.8060626904645564,.7128446053489772,.10627854354008667,-1.2463627464994291,-1.1779015976900278,-2.2811497920347374,-11.233982004737435,-.6063769982644212,-1.3554023774025237,-2.642008167211463,-.6017030168430634,1.747674015337841,2.577762001477188,-.9401423131879817,-.2613684023567599,-.5351958458716012,-.7802159478039217,-3.679710514317414,-5.573661576598365,4.370280520480482,-1.9801900711275866,-4.458528493442739,-3.186958050391791,-.846129795084157,-3.520894132027477,-.7775428652936722,-.45420233914751273,-1.446314590974669,-1.366931969684918,.8054631434299535,-4.7086390632054025,-4.73989185937157,-5.480540551673888,-7.2298504195182085,-4.208491985871562,-4.0802834794359795,-2.4009170039428094,-.08636022503377265,.029673125171609405,-.08290788521640073,-.13886812875003332,-2.081080968533214,-3.058149309664061,-4.902958303270531,-3.1983553932139386,-3.8819505891140227,-3.330589965505899,-2.68750722340467,-.12908699735721607,-1.1135096563823441,-.11664769357734688,-.7468413770805221,-.40793620417127247,-2.339060040980614,-4.450808744254205,3.8643777862146362,-5.133073113762737,-4.202074831665854,-1.767268920664524,-2.695522452411382,-4.0035551794813165,-.6575717735288026,-.24414229807819174,-1.1010664979399223,-.24221357984653785,-1.6057041400306693,-9.7741549906903,-1.8138376040262847,-2.8392467944122166,-3.9118025653461332,-2.370901420051311,-3.3949921532015233,-1.6769046996834742,-.24851022316994942,-.18652838369428681,.3143485930970573,-.26621764831324196,.17166676165361824,-1.0699109119138308,-2.1445651016902265,.621729261643132,-3.350680216707051,-4.878786435401313,-1.3185852300140892,-2.237964779793938,-.7452145534532476,-.2686930816586796,1.7111433195717551,.6419839825628848,2.26473616505312,7.514985317775693,6.679693540170412,5.94148903250758,3.412853642041138,.4963231014820144,-1.4913637092256067,-.7952049967981086,-1.4963913531387842,.14037129865286743,-.0882721885400375,-.9708904737271209,-1.1817712446401285,1.0379705713112286,-.2202125648256669,-.6171846921762851,-1.3946461125173968,-.46597501717974454,-3.7083800585073194,.4873700340999259,1.2917786033793615,.2832108961297554,.48064630639845074,-.0976840239829019,.7403375666408383,10.997862007518222,1.5136896274796563,.3231633413281845,-1.3543269484060878,-.32392365894255465,.4929576347543315,-1.240113035687768,-.6767172013028827,-.2498485995514511,.26648822208735146,.5213005533493409,2.6080236691452234,-1.4947457895970646,1.4100510477005963,-1.4206182335949251,1.9520369187597995,1.2950418447209862,2.7741407328858902,3.5986202818551765,.41779475716454,.20610336920171862,.4821609450324224,.6611158504164681,-.347755237004189,4.043179380246491,1.652891940199479,1.2600201440328964,2.1646679163644222,.3945520725704444,-4.725108295954291,.21295048630838537,.4056229113697016,.15481896400923142,-.2953947890158391,-.8373704680237664,2.3055889001508425,5.872550108581872,-6.302690618245088,2.1374713872748643,3.1892970754756855,.31993839070182706,-.012894939563877253,1.2664917786956973,.6025238121434332,.37975537806917986,.7458980704002101,1.0260431618872703,-2.3378415787334466,1.12630213753586,2.465509045225273,3.526656160736275,3.9532403424409805,1.7143503658578785,2.5252954936347094,2.7554130087828836,1.3390429550458753,.4197430985285594,.22672846318193182,.02460671102544835,-1.2267449628955138,2.922462017019537,4.9880813477836865,.6467448379323957,.12487533266834121,2.7445284534355046,1.057636919434379,-1.8491290161795193,1.2036672318464319,.10739448146603295,-.5176738250323414,-.9558685046389667,-.555151328477059,6.771007285269972,-1.697239599415047,.7512716199937037,-1.2497008553729325,-1.6409356065330032,.7512199044187555,2.164057536546608,1.0946250576144836,.15609377462758656,-.20246970129605787,-.6311133010756272,1.512529248107554,-3.0327400754515397,-4.092161577992516,.5967260370099908,.5229918377822886,2.246514690838591,2.7125539512838404,-.7878067632263104,-.6438437418671978,.12693104830021348,-.5188182036279776,.5752989172846419,-.06888984797145882,3.6969179990309358,-4.952904923663175,-3.2068420517957628,-1.1644917380323707,.034362713197302004,2.2001551553633276,4.286291394551697,.47202341599884723,-.231300195253309,.18215673246173408,-.20866437834141704,-.7179478867985729,-1.604168387581377,-7.225502090381509,-1.7966503735461905,1.021795666081102,.002725551125982291,-.22221026208471797,-2.215885023228995,-.893597149185022,-.2630818155878439,-.6854243606353124,.40039246334404655,3.166164237441061,4.208085756515162,.7895110562086426,-1.50533557436798,-1.1043318744034216,-1.4103961293030824,.71947445150728,-.6836342717740425,-1.0144678105319684,-.30135669316086294,-.5258909335946194,-1.1726989313567424,-.2456096049880823,-2.3683740869160133,-11.421019595379674,-5.667252768930212,-2.087888951514298,-.1534929271533339,-1.83946275264766,-2.1253936377481315,-.6523880524537745,-.17227861822427556,-.7483871273675381,-.8308998096207528,1.6110148210197976,-3.0775455162259906,-1.3012100791078391,-2.559167992515165,-4.873133396875959,-3.125700836587629,-2.1075683730292933,-1.018900305786943,-.3216293663971673,.008910986960381125,-.2316207919605516,-.8675328481095479,-.5967390919312099,-4.023610320746462,-4.450149589429382,-2.406360639699252,-5.067921507427434,-3.541499787819435,-1.3202684686051225,-1.6344115012927494,.6919192895899516,.33533843492718096,-.4364599249324907,-.2347666296458604,-.8882154493025822,-.7435571184653834,3.0706051981958105,.37416583810027493,-1.7886896160947106,-.8010620670372093,-1.194689912856326,-1.0011211396889317,-1.332051202878397,-.18175273839710399,.3341458555042068,1.1149466339180139,1.5513863982366818,4.407103266450122,3.3570255447507207,1.5186138132173397,.3842942621976496,.08501845348277585,1.0877354920172604,3.236566242029837,.20417067904945455,.06342471972829634,1.2134470722942596,.3102368065240313,-.7947119749644118,-3.960485213492011,-3.292708827817335,1.9396979233193672,2.080715825382752,-.3218200277136303,.6058963296265841,1.1207095927171504,-.11200438285815886,-.08972267997952021,-.26993561809666533,-1.2779277420376116,-1.9412398972289011,.36009113985036717,-.6374821233811274,-.6142012353896253,-1.9761234495819653,-.5581738588403804,1.3205120877823928,-3.032736854165365,-.4735007547211238,-.4331997124582317,-.7945707566993717,-.2898848565228909,-.8287592963974363,-2.2955421618707157,-4.950566863733113,-2.0969426734269097,-.9976917518989384,-1.4379099939529145,-1.295653184144037,1.545485479024218,1.1303403008186474,.17994240909071085,-.38542741818688836,-.17156019371863782,-3.466724295029315,-1.9525925479455655,-2.048866336443724,2.566306814644463,.3315699779510551,-.9717089127421956,1.9575018052806832,-.926755122424774,-.3282940804438316,-.20123882635118132,-.13528408716145088,-.28389296609106107,4.183676125515299,.36927917392519033,.8756542999418666,.805806190732271,-2.393274656961759,-.23114376785538052,-2.9569920347213543,-1.118793005313231,.992040958042287,.14411801594485316,-.4436351461427551,-.3034615338883328,2.7889215927516875,10.278143749720849,1.5001099011410688,.9069166331882189,1.3405441023215605,1.1015412016469297,1.0779978572255564,.7815556315856782,.6549380587948629,.32731681497727205,-.027868997219691886,-.6986191138584078,.07577066752159206,.3038593516517035,1.6037257836499594,-1.07132385648413,1.496506228610837,1.4129548744892855,.5462903613939608,-1.763262959167577,.4464398094451894,-.11126222688562644,-.7466399435628619,.03944008587396952,.2719010990738039,-5.020213901030787,-3.0206690178229354,.20446413917849177,-1.6047737854958495,-2.4816613407140258,-.849350178093532,-1.561660877462428,-1.2546322467412867,-.23606154518202505,.16470774594764945,-.0866141070097281,-.07344390755395969,-.11390960361362584,-6.137219027425607,-5.875570342942724,-3.4773726421477384,-2.800505939501746,-.28068232558920714,-1.175012764276608,-.24623994488627832,.3199123489934724,.5054861924797504,1.6537011505478418,2.673664322189246,2.7402693266598592,1.5926177079949524,.0017113486431430288,-.13989320776525105,1.0123457608817146,1.6523857647505646,.9480123922453189,.06848573450106804,-.3275285871577315,.38168523786699543,.7842359254625936,2.1414721547195876,4.101209497313389,2.203452027596743,3.4833444435021397,4.078038183859778,2.9034686729409755,-.4667843227203208,3.4409606984574794,.05939898736431805,.40242614077408134,1.00718008794562,1.1037153633236412,4.127162528425398,12.28510201394965,7.103241013957366,7.9011890116016055,5.551848016707992,2.312952209296513,1.8155996894454645,2.1869667643756476,-.08658793573681778,-.07796728473366783,.424093222210239,-.271880291417626,.19463017375507502,.6301689046553685,2.0943908558166764,4.868043596454705,3.4328927938717766,3.2242274057927554,3.8532660024984833,2.166728431399018,-.6083051490467155,.12779582184644475,-.6160985424846769,-.9394006931735441,-4.403975767632304,-3.125140213843522,-.0012579761189345257,1.553740487447978,-1.7788908563510883,-.2998734980532272,-.39039677875122963,-2.4325170885969634,.9613450090033726,-.22409144723654748,-1.3666451098108496,-.45391356179615966,-.913073008741553,-6.10088428947143,-.6351220161088175,-.7296374057188528,-1.7294731046777971,-.9462589493228004,-.23148319430657172,.7289555160212132,1.3381570589548069,.36345484689826163,-.6914033854660115,-.09215169720193331,-2.139017922044578,-4.5966480996251216,3.0498268730613813,.6994521149348931,-.5701397466566274,-.9537216849185682,.17500322125767628,-.5567811514347909,.8117988393652336,.021740777967079277,-.41256541302668365,-.9299406885558531,-3.17365190679974,-5.156153359958292,-9.335868400195007,-1.9800225420571094,-1.6447531741928472,-2.8225433378142064,-1.3672520299768,.9114640436838267,1.4565375259926552,-.013492259039830853,-.29987446423314357,.19000146110852745,-1.7354669388985873,-3.378088470276222,-1.5643891990162972,.8977252614453305,.12498610659411005,.9350106670282224,.1662860063589994,3.7861196054080466,1.1165006704071079,.3020086344136199,.5016594379196552,.5011076008413967,-.771635094811879,3.598203287203561,4.037062134752723,6.249768166054901,5.5532953645594105,4.361942665726316,2.0807660011627602],Dne=[10.738043677986466,4.573162790875471,1.8474602324099307,3.066196995582262,.3569663870381231,2.566613401176826,22.422500418825965,29.733742054068436,36.897330467857984,43.45624111278399,33.29429690360909,19.66490337780872,7.533961581362516,3.387576028337058,1.5506673328826095,3.447097709458617,1.8210129727340085,6.651608141946243,13.160550521071784,30.987821147837266,32.10655364966504,41.50349044133422,33.12314374480881,14.141956172257775,10.051976577184641,5.068274714831645,2.4758319347997526,3.6776535942355495,2.9212909134775202,7.024101679760495,29.894162985729977,35.70790238638533,38.268910743721115,41.85516559165757,33.07743110494231,17.591145198263295,5.0443444990608555,3.61546039193561,1.5535899395410837,3.820437184052889,1.5059391439412988,4.155345980112216,18.048716696068706,23.311678562157553,36.605805777581125,42.9564991038764,31.747016418090727,14.676714174769774,10.31346130304193,4.581854673399172,2.2619742564422576,3.491689857386686,1.1687462763501129,6.753965362716781,13.20428049450379,32.29959214423227,40.918336389621835,44.5717461937455,33.63432062531396,17.247979060195178,8.665463153683278,3.0685773589266114,2.1049972408792255,3.567077094137196,.7847842179318552,3.3802901965117087,19.937418229446795,31.288679656363804,34.89395050543345,43.53558738514793,33.04103280496397,16.722237231280296,7.198956612666731,3.9392796950297924,1.8831172772839533,4.106223611044033,2.0526119444479383,4.667830624923259,24.154987927809223,34.28575616453526,38.18831966637157,42.713899756990315,35.04311347714135,18.61504925736444,11.175719329413772,3.2053286798047447,1.8531987157276872,3.688057574678137,2.0484977582556136,5.3969644684886005,23.476031740107956,33.99874053261087,31.22567118094068,43.0031907116297,35.6749645763593,18.436400567065046,12.02075661924394,5.550193353608921,2.244237833289043,2.9137911908407097,1.5186733234325376,4.230580026643776,23.17312847690815,28.623719480726308,38.57448301108575,43.056499769196265,33.1925177295531,15.112228992967223,10.529505124318648,4.611826844178395,2.629574142706294,2.970991011203966,1.7107845537430437,7.053021086819451,28.174723100020547,30.82320883221607,33.17968836905789,46.47786558863444,36.59729230786723,17.40155104873017,10.723996227093112,3.619759074890588,1.5945432184374628,3.532276686563998,.8677311377181832,4.870689316914542,22.38112599857208,28.404369517700513,37.942608277974195,41.99399364997257,33.98826213605374,19.524959134938914,11.856104553436143,5.325699033140503,2.2021241077419784,2.7090095686184545,2.0795320337917986,4.998775901243355,27.82010056450263,26.311763531262827,35.64649044596076,45.193365082112045,35.011368272756584,17.41367980724137,10.40234759726436,5.570958001784723,1.8606635368369582,3.7567023818615066,1.3904072649762023,7.237521561002866,28.923621546399794,31.626571624950028,33.37596836297922,42.47612701916743,34.96805884460076,18.550930345749435,9.432958754966572,3.2518082780012993,1.8227312357113366,2.834440997107122,1.3560902362974816,1.8486304084949516,10.60486459192835,32.39236427798812,39.49653781397556,42.21931555538827,34.74589884110406,18.50485996061547,8.66477668396578,4.434652138222447,2.2991990533545623,3.66503124836453,.5464134251279126,3.3462934962137947,20.703290744581967,30.514188496198717,33.84910267763323,42.909693196575525,35.26930863608236,18.370217354473404,10.030661175445381,5.504230008104057,2.0205342921147964,3.173116749555086,.7426497076890934,1.380822434069851,20.08527130649064,33.96124135173743,34.62184938038158,43.13744264612839,35.41858288735428,18.21800818465382,9.663558608329923,4.573936192689223,2.0605166876817926,3.1529774388899114,.4312594457062394,1.0278905442842854,16.40833256113343,32.93366376612099,37.49112613775624,42.49597210239503,34.17415325232956,16.928219375034235,7.711175865141706,5.053456672298917,2.2493518076280017,3.696695519664965,2.0111125122013718,6.094552179393792,29.76982948145021,31.290929651917747,38.397378405218184,43.62317520020738,35.44500393957989,15.672797376386434,10.255657836277358,5.436046943001271,2.578663910791458,2.130612957245916,.4537742807932182,2.725233058913707,21.656219757717597,32.76033051351881,40.40009631811326,42.063933084351746,33.91494109815457,16.248465292470613,8.597725593657296,5.003082225155779,1.7653172615528958,2.9832163017999096,.20533886140769864,1.7092811918199653,10.765881708079236,29.03301479199409,34.840455972412435,42.66439572981825,31.43529630059693,17.272217931391864,8.11625577880297,4.658447191272281,1.7612809058219032,3.276179762287307,1.2459581876548156,4.063539355853831,12.065728285384512,25.880595351623196,37.44037674072754,43.47656194061117,34.47093597141503,17.954902311860298,11.067143938843412,4.467756965679912,2.0863013123605265,3.296814124348974,1.826269782685203,2.021593260260906,20.44531387376739,34.03257001626389,34.53566230225354,41.85344023037935,33.42215558056139,19.176590015615997,10.660690177949656,5.013063586623905,2.22514860613322,3.4935874828471247,.9717978053658058,5.385430717062962,19.155617175450644,29.942624882949087,32.215884537915244,40.65252763431586,34.78005983130811,19.46319612574586,9.436313232697724,3.1475159363092295,1.8455459258687419,4.168097762957995,1.2790021970815566,2.852082608739197,25.947176461801124,28.387246275385042,35.724483334751675,44.54559272836708,34.284426743593706,18.717303502348848,5.662797497071499,3.8268336449507205,1.7265943922055356,4.032512294278391,1.4292382622608268,4.412906569051125,26.618799434983465,29.58676075165988,36.0900328321527,41.57040260147636,34.94786514361852,18.278043383866226,9.992960049725985,3.3158712451653023,1.8409658994801035,4.098904064740345,2.143506139034889,5.619518641931294,27.46077788006002,34.05915233642693,33.822932290314526,41.09952783281252,32.505819516548385,19.427261803496076,5.984612799912657,4.455062152539334,2.2518586966585388,4.414521534603889,2.828372367878801,5.813746725898796,13.635187167398584,22.880458206378545,34.091905247991086,41.33132123588448,33.22795420312874,17.747938133092735,9.991753140733039,5.158767276832909,2.1699932301669826,3.8236296006538653,2.1813352373363304,3.2178509043668146,29.08544315934444,29.122340888527667,38.50759094882325,42.6640121234586,31.84980088369526,18.32790407690667,11.80946718664379,4.831937352781882,2.2739998816417515,2.9609534345058615,1.8415654996857769,4.216225085471314,24.96856101455329,33.142671664380586,36.54658982695707,43.92343810097479,35.32055354049083,16.709860158690738,6.392868731845633,3.6432148186347035,1.6965890371638,3.4500002649362154,1.3170693406440364,5.049905674179993,22.507149987710363,30.709653238589325,37.24999193829454,42.30683214504522,34.00011123455452,18.92367910169378,7.887994578713109,3.9320862857574084,1.7090785694175883,2.5062933649700154,1.2819655636759952,1.5877366792379086,18.178010949336358,33.28448441795332,31.678312673905083,42.1811119709549,34.50352861638824,18.34860744195834,12.092254679227711,4.108535773842121,1.538783461982417,3.887095284890308,2.461122437982105,5.682992067455651,17.582380168628557,26.608006265409266,31.850447231173256,44.0299598024168,31.472275922206062,18.41933829427892,10.758504669378443,4.109064709912856,2.4114365767592765,3.5077383771777453,1.90839115561099,3.3848305928294873,22.425502093434414,33.653716716344334,34.22321801616019,43.050493804133424,30.517856627531852,17.58682724928766,11.494850979266195,4.042610424393376,1.8936704964755824,2.7642368693494834,1.430442256465423,6.156764537322067,17.88998239378424,29.93850678924541,35.97640626183285,40.72106319821167,35.736436918083356,18.37276662438654,11.334586580801162,4.357018203214477,1.524825445407108,2.663614768950993,1.411588297654379,5.784106885947475,18.52161146062428,27.76957623461454,36.931696234913524,41.47708758869049,32.409800273906896,16.920995209039127,8.047694211274715,5.469949612013804,2.682787723034793,3.2750672786327004,1.7608422498176002,5.917177238203159,23.101876729905786,23.417655657320644,38.757244857960316,42.99798582092698,33.32847794649326,14.749422256431327,5.957425218905746,4.8614808761438955,2.0548785340293447,3.02426968674633,.44817084729809187,.9330468849061645,10.687325941353926,29.513627346811067,33.22483599849803,40.813916788833865,35.543840747564815,18.18861188370473,12.248886374526146,5.343017916950534,2.670248406719313,3.2178728966763934,1.161189008945449,6.607955664463354,26.72980493841571,32.7191872583476,38.76394832282076,44.75603774360629,33.495909764456776,10.394533547648386,11.999482186907157,5.539383425061187,2.6266987266277435,3.352256071631856,1.1039287871916457,5.588982025549599,22.173164676958677,31.073809456351007,40.43059315860459,44.17890413952847,34.38288197787685,18.675598995686645,11.031829194389642,3.2303779204698917,2.1664955912115222,3.1281053838354738,2.087605526245803,4.967656818222485,25.06408467551659,28.543023294759518,38.46251652400716,44.62500855629084,33.39472610844875,17.01861463312808,11.487190904657655,3.632960572552396,1.999391104758977,3.6323069252758846,.42642827009786805,3.2502810942052007,25.47074332374212,31.005693204282245,36.931257021751144,42.46924746786548,32.862298370637546,17.82603119456849,5.992126110837323,5.081554454511195,2.2060474152502465,3.7096123185748526,1.1487573888703997,2.9883518405581184,10.842436278023117,27.86817357355284,34.68539960002878,40.41789591351543,32.87930450852451,16.975174470993345,6.5389687277524775,3.4241707462371007,2.1829584598857488,3.6619513890081175,2.9513541464671196,7.172884325142562,27.18837764675706,30.20455874698774,32.54992768168207,41.40096922156487,32.89979541816193,16.63574297127747,7.298156431110755,3.558479279000582,1.675986301347596,3.62991612655546,2.031019341711058,4.939230658185551,14.010527689500377,32.946865856474176,34.10876494841074,41.068141982506965,29.91764950700123,16.94383997872892,11.942000041721116,2.4379682726200764,1.6933051591376893,3.8106669191633573,1.597391733654793,5.886016064591681,25.70240342000377,33.49968036086859,36.73427961470962,39.96098225046069,34.446570569640876,17.70073352734551,11.85033752465379,3.6897920586550983,1.7479768168761824,2.7243539456742947,1.7474905942898349,2.9538055137424366,7.495703871456528,31.9140955545621,30.54184685858726,43.5582790116353,36.3524137806118,18.44763525913035,11.184549364501738,4.245792864755459,2.2211929486144313,3.6101391445151303,1.9975785162032835,5.185733548323152,27.50873434754319,31.867325857382593,38.19994730996505,42.21410246498752,29.131435898534377,17.99133084731935,8.807644718864795,3.2845280410299806,1.6903575945768352,1.790870601744318,.062441820700333196,3.453110722586303,17.638870306429858,33.556886688128365,32.67511089933033,41.81272586180382,35.61587954415788,17.60361523424863,8.248785641512432,4.523460546539433,2.1022228056165444,2.6399795069558105,1.8617080786586904,3.803377233451714,24.277842727178076,33.63155344229772,34.915085038092435,42.75782676344567,34.009261529321826,18.35081564230837,9.593633846176488,2.6566619959493676,1.596310620562725,4.019017686731216,2.0648842559753167,5.034464807744462,22.902695804516757,25.193374486577948,34.752155851618845,41.870028809940266,33.95983411222908,17.58441146958736,10.602545810426435,4.497940456795887,1.935856457852908,4.000987852609974,2.802377221785262,8.772896065035605,25.416075852872066,33.10358389666243,37.3375335868877,41.9726297504455,33.00149429467247,14.871963195303772,6.230221196984792,2.177204564149958,1.688946323599673,2.740166873333132,.10974618562170133,1.864564545311963,22.39345845167539,34.51664520500604,37.78637799974603,41.50277469549748,32.86553182090629,16.621741786136916,6.567293309578705,3.6541528133778276,1.737437948080409,3.294210158369989,1.895810756783375,2.5587358832038976,19.88460260787214,33.15535300938751,36.2446023378167,36.122539280070015,33.29711056181808,19.249669113990326,8.765750647973492,4.687509738736944,1.953041195656554,4.1973536200385695,1.2630927644833947,2.248880787629327,19.52025969607888,33.205346888798225,36.752289033458695,39.04845369547357,29.760401150873687,18.373507578314864,5.951089887575717,5.020797136513342,2.5062664357409794,4.445122412024365,2.5693588835965855,13.148626779454737,25.599501845433085,35.09499568638413,36.37629124571908,40.46681394412217,24.21065501054382,13.339159248429185,10.753790888705007,4.475170995121601,2.4995137594457155,3.7081069211205238,2.47300524070575,9.487266868270815,31.389559601820075,23.133911647389546,36.839846659530984,42.03053478757354,32.649263118037176,15.405519996734913,11.081975936019717,4.407168866845204,1.6333850045251843,2.269937834325381,.2983106102821045,1.1106681275250656,10.67331920654115,32.99756863121351,36.306519965150365,41.4327300945805,33.22476491421422,14.08385279815983,12.54038083152308,3.67816896032867,2.3546931046417106,2.840941486119447,.616331548862511,2.304879058224421,20.881613258095868,32.266451470265366,38.49491192416674,40.49849783880881,31.458839870041096,18.505083550443572,7.196417448468178,4.141987066080274,2.067332855876396,2.726746402267376,.6972570560898417,3.2411640358908254,20.98865939873964,29.033616925672654,32.556451099460666,38.904382450029665,31.606420394719777,17.12991775333911,11.326162858549445,5.280956323577788,2.363522818353818,2.982505499112782,2.1097212940050687,2.286978166502126,23.58674433792655,31.9633349202803,39.4130162354421,43.11395015561659,33.38436324918099,16.840685594547736,6.052201413821684,2.89179267653675,1.821271938909677,3.212140719203139,1.2799149574246624,1.2229230715236177,12.237461590623074,33.70409153788144,31.449145116361617,39.766598069438665,32.1924246513998,11.677007017991786,5.539352085943082,2.8807124370294597,1.7312041636276112,2.2546293993620634,.09991187652445284,.817582460104762,10.153379895220656,30.35063500406965,34.94936085589267,38.641492551583646,31.29158260639996,14.173531052425043,9.529454919943092,2.8758727084925457,1.5263858378061161,4.38878956731281,1.9131246406279032,5.914750296521521,23.766442961144495,34.29424155122113,35.95394730366164,42.21757050363935,32.39598074457734,18.418942762188763,6.644363672347458,2.917160482582685,1.798256467212977,3.8966240976156996,2.2902875604723514,4.236392088589184,27.375213609411286,32.879046391381586,37.96577600201962,42.306103132676405,31.530903320440967,13.666262093936957,9.285858875815833,2.872697933634124,1.7976886327538684,3.7122665406261377,.5611135427209262,1.6719698418242277,20.873619591042488,31.674920082925862,36.72015292405791,39.86811102713999,33.47328466155659,12.46423003507517,11.16546225776516,5.356703902720401,2.4151714027252313,3.565071098007166,1.361514793642497,2.9723991273710366,28.290687172944388,32.97637664964542,37.25218504145036,37.728680970925545,32.35338474781599,18.138765834681507,9.439511436680942,4.459982284223848,1.7963420343224592,3.2719248940490853,2.252012340851531,8.207434445692861,19.678965658221347,28.56317673236804,33.63269802453607,43.06087116379107,32.73451859118566,18.38675915417851,11.955986846706562,4.080287556573152,2.0100346974160384,4.095439031073853,2.190231633167082,4.413521816099529,26.498611264055352,31.153932869338878,34.77747985715958,41.67309590357161,31.398926164538842,9.514235397679784,7.1684950520713375,4.843130264487757,2.658705380778677,3.4553601851996283,1.762635299982852,7.374915784174613,26.925591047568066,21.104969168602825,36.19778558956243,41.520945665914454,31.84915494061017,17.225957942757947,11.78476325453898,4.966565893840724,2.537126662431226,4.368613457873107,2.4352080127791815,1.5378548480901335,23.675332277988474,29.625110699342173,33.36290557935618,41.41183059327702,31.154214016498344,19.145083809117956,9.658310340747374,5.143022240453164,2.173195442466786,3.5641224605092976,1.1260573886371545,2.980576998529559,25.332959105355567,35.644655674240525,33.66519717175156,38.03246906458369,34.4283867703003,18.509028662884113,7.485411781247758,4.784479374996522,1.4860135301305735,1.9220298342398603,.17424155440833014,1.991041119715656,19.5107144221881,26.46805483438103,31.05679450481517,39.56184691528479,31.769341223536458,18.3622768754128,9.831594406223159,4.512274596478163,2.059740860144145,3.668123669325488,1.2549669688865641,6.4735849826880605,22.054764144137437,25.296144459261676,36.95406951487048,41.63549198963446,33.744377419058075,17.647833761095853,9.682516815206029,3.721691730254827,2.041372532860333,1.475426540682359,1.1441740957821371,.9609927748823635,17.42881156939425,23.87570814935875,30.447719447156217,39.380746664200764,33.27407283840477,18.28663495987792,12.209092996921157,5.5241958658946535,1.971026541596967,3.295549796255984,.6938046305102884,3.288652855705718,19.51348496636689,24.2531364369824,36.39585488117813,42.703098190549994,34.05541142223453,17.4480511220739,6.524268903318088,3.5435666656235183,1.6034788188086995,2.252677121926296,1.1369182697876865,5.946993640788973,22.784386205936375,33.12117317865682,33.54739152000708,39.69333877660558,30.61010641072201,17.3733678984226,9.417567999005502,3.115060856255294,1.7807103976589749,2.3627193856246285,.02557623510483612,1.8368047411129622,13.46491673689168,12.515042792385447,29.022779375452206,40.42391085279433,34.21222868540259,16.560811582418374,9.251565310991827,4.1929016412426705,2.3561988434276184,3.507207041728425,1.33829040068645,4.019822838021375,21.005161659220548,31.351433198554982,34.137970073473205,38.75134749125058,30.03417545469573,18.05699467403467,11.616582948016276,4.66600357012841,2.6666241051794395,2.931888589226368,.892355064362221,3.75027010591409,20.005150605262635,28.128148401548586,35.696476205351026,38.856243064220465,32.20757658886586,15.958301519285182,4.299952773628952,4.7341533469911035,2.4791468713545455,3.0235036282357366,1.0910378918870711,4.27627688475656,21.237603527732084,36.328666373143854,37.11984384203146,39.18795114098239,32.623524264613394,17.001782381003093,10.29240576582174,3.5322904768846,1.6083797816010037,3.6771100469374343,2.374452923940923,5.2609031576811205,26.080660474843626,29.12915152576923,36.793810667134075,41.24817600513194,32.48539100182074,18.438061212094993,11.65151163941511,3.7276481560323007,1.6236303920886184,3.8260375664538904,1.6114648377784897,4.647967575518048,14.533496965720916,27.182915637986653,37.07016900362627,42.889584973617026,29.956349313392565,18.420492165621663,12.534766187043717,4.348066701010071,1.7614175833434316,3.6564172200621843,.8205008300059895,5.777934820258415,26.931584207659746,32.64064582843329,36.73390626733841,40.16557229861273,32.15464019038169,17.38861290164952,3.7887901902002943,3.832275872271966,1.6283927939478893,2.6837964455255934,.18756859262444656,2.263499314356143,18.533877342383736,23.358644403498673,31.52412900586439,42.73132330042183,34.23111652236413,16.92401828784934,10.719703765579396,4.9956833232602715,1.9049805292639002,2.9984490270234505,1.6184821931090219,1.7463713657700348,10.003826302648593,28.60971294649531,37.40641528367354,42.75261073824125,32.27053416076819,17.943821364305265,10.72084769181853,4.4751946019376385,2.198532000097325,4.266002539303926,2.0948953879295686,8.218286439814815,25.609033931982,33.05476027489865,36.98346644980967,39.979538957581596,32.67778058342132,15.471214141867756,8.415356568245244,5.024993121167589,2.174589904979542,2.4084946420617244,1.0897294063486629,5.980029638487173,26.380663630969238,32.01966224549688,36.96153238638612,40.68095103331104,33.36252406169553,18.366876936681372,10.56833738947232,4.397108495055231,2.11238497515229,3.625800914102983,1.1722069631351355,5.037300145067397,25.172764494847303,30.270523814845745,33.144644089022066,41.415655108270215,33.107237493383515,18.097130069749138,5.225207656741379,4.96197752172794,2.0146403190430258,2.5959564426895465,.6009173744640447,3.8917919730068165,12.7212577841089,26.064322900108003,35.16381522111186,40.638598591094116,31.650576338810605,17.35430919585124,6.864579498375279,3.730650228133123,1.5932181591055317,3.4942432554277,.642398959187125,1.290124167448581,21.790881639422487,23.968615710943354,25.209506470197933,38.759027716303876,32.47823589033335,18.603286554450143,7.735957438672926,4.405867233662547,2.701918353483895,3.909698416431442,3.2197408507357164,5.187121937247414,18.89740156344899,33.54251027937374,35.25512267238066,39.89509636256852,34.05120918921976,18.68817929904784,10.015815473033285,4.1469494392770425,1.6585263491747773,3.932322986163404,2.430370769428867,7.126788857983838,26.009431020124502,31.994643186621534,35.34277734046137,41.39229568341923,31.579387142510143,15.429275178979681,11.441745750551739,4.747018898363287,2.603207244012067,4.3266465099859515,2.08758563766763,6.439519903889923,25.402571004792783,33.894721589182794,37.76697692034764,40.63786674698872,31.61227063968402,16.514271176849995,11.219114789470359,3.6699300663488144,1.5811879646392837,4.201904837265585,1.7838879523795126,7.4211582280120405,23.256895521017032,30.887374056696906,37.67909790468468,39.29979244173828,31.629334067548434,17.551476543336303,10.838075594021152,2.901193481776517,1.5553637765410806,2.1722604471510207,.695730484668289,1.232924523888437,16.55635671398906,29.27773032117818,37.032503732049236,41.174474610829684,32.77024011274121,17.95908300946313,5.096841543657178,4.373018103989495,1.7389787011759306,1.810092358280849,.07943776786482776,2.1132113131514347,11.578015778236825,32.07620300865218,33.38743151417765,42.074176473000975,32.80149640137697,17.119406976968072,11.230182605805789,4.438977139454255,2.3336009701993614,3.135580804629443,1.9704530765150228,2.090139350256325,15.060281338242545,30.892561808000785,36.281292213947715,41.333503455989685,31.973053134864184,17.987803116599718,11.009378852495294,3.560979622967306,1.7802560028704875,3.2978527933475643,.10430121851359805,1.5539264991417492,19.74077148484785,18.689276201935105,36.10176332546105,39.74731042305091,31.96919837266322,16.447520758865007,11.623571244930314,5.023989571683968,1.578416294235892,3.946978959685913,2.177004211876072,3.3455778822156836,18.285748050424267,29.9749444525683,35.85487916106321,40.457546147632755,32.584850030331296,17.97171729961007,12.361893131235915,4.91598302444709,2.0345091159531115,2.934501743071446,1.7629307689736962,4.355430098688431,25.205986070495705,34.450777309320245,37.86445949062097,41.957156395335176,32.93711384381775,18.257783963338436],Rne=[.6312089057765664,.20186931520809412,.06607897573323818,-.7962591614232871,-.058655776676987785,-1.4559452736405434,-11.749181212032683,3.2464683002425994,-.5908105027270636,-2.023511018065737,-.08656578943336199,-5.581050579874036,4.999907173765551,.2905929318281547,.8040257716885235,-.6061562234536945,-1.2046814238352255,-4.346741646372554,7.721038289451858,1.2613905707668018,6.36949424108471,-1.005036818136477,-1.647846644772429,4.372719840026044,-1.636629484252866,-.04328515929874599,-.3012439626719308,-1.2691589523823446,-1.831562854398259,-1.045954666134204,-3.513499354913389,-3.6703805195826034,-1.325921442372758,-1.1943843315550255,.30258309420102864,.7851835344798364,3.6204321846565195,.819191746325195,.7456091135756165,-.15540593570342204,-.9595257218723139,-.8085449352829404,2.654362508248728,7.202267142897231,-2.757034494138361,-.04719724930051862,3.503772063626965,3.693348691004828,1.4899030364191461,.2500597746404542,.01200804922548732,-.5307364228048793,.6727889456169572,-2.5378615622113747,11.764134824038937,.8600092318523836,-4.3899324830512905,-.6485809938797051,1.7041092171722132,-.5382109208542842,1.6268759342574943,.46371311803670007,-.4966174594386974,.11003295288455452,1.5896229540025033,1.8806129614525604,6.143242244638177,-2.159528129889523,1.8998601628724234,-2.287411379077736,-.572725250451919,1.7254321330973919,4.452555026353636,-.2116315387511637,-.25948688521094776,-.2801860447289808,-.4411471085704943,-.019989980312990666,-9.62158385216886,-7.117795738068421,-1.1183529061337163,.17545266120556713,-5.086929717041007,-.204161889884121,.15037625054726989,2.075607742859685,.510303311302105,-.7055520758343249,.061202025826135834,-3.1100563159192123,.11060668189784569,-2.03554836360364,8.187134896289981,.13157666672096985,-2.3081053773344853,-1.6040451395499664,-2.3617613462401006,-.976273183142179,-.1837299230612856,.23918624819725817,-1.0874138776237436,-3.202705352691056,-6.7648508746639955,4.309845225158837,-1.0834934223923227,-.5813644789475196,.9638396289370491,1.8159328377480548,-.5424457599667039,.5469280712973105,-.4595890085783304,.8526385892096283,.4705281597285046,-3.8351701824784628,.9246832249975199,-1.7008679428251388,5.327902579676158,-3.83442162107567,-4.747491427054863,.9263530266800339,1.0854709596761765,1.2121782780535109,.6794566631159205,-.5713232519821897,.9738344214176597,-.6546255612459194,2.5872412154671727,4.755174900456479,-1.3963278716182899,1.9077252451754163,1.3319990958424668,-2.8152213777836814,-.0527333195700872,-.49378309480934746,.07185934149300537,.2519438659633601,-.23799484173575006,-.78267210073794,-2.8399490215735925,6.830735622151722,.8998667639256579,-1.2701998822461433,.3270615697295072,-.7119676866870138,-.1154221463684482,-2.0386675248214328,-.25228375539643055,-.07959233483975481,.9839999069581609,-1.9766218289708213,-2.8552914217515504,-2.511293613105759,3.417837176508305,-1.2484075235093837,-2.499755812278069,-.10326323340111643,1.6046071499505776,-.02143035775323302,.34376399745658054,.29366438666283656,.7315144540568841,3.1188722284731916,14.447106109425464,-3.849477459076811,-1.0151956551178034,2.405392640444114,-1.3513975727738436,-1.4863519265860299,1.6540827896523669,.14718359155812846,-.0372443649817855,-.17334139100894633,.6223096256907629,3.407630465639238,-7.4990333552713055,1.7853609179630452,7.069168235048785,1.661982791411517,-1.6350417746737702,-1.1308869843431264,-.5980536238265481,-2.3567140717445842,-.1749883663077214,.994981013498424,.536347002482365,1.4712377606593952,5.861871179093145,-5.574029183584801,1.1025819291143928,1.4298699014278244,-1.1164159229382524,.5089634022896087,-2.1296120392924336,-1.1863601642940151,-.5098493547691786,.29412027061816204,1.3897448734186613,5.62371759742762,-3.247782038167956,-1.92905401424127,-5.3845724875936956,-.97257471469188,-1.051009507716628,-2.7862632026480365,2.3455946702253763,.014818042487884328,.22648012726705335,-.019041925420184912,.910178417193474,.9293663772433018,.12412922948491287,4.416730174258035,-.12878709356401896,-1.7885731893973726,-2.3849383496619754,1.9272701708525384,1.4628155384589716,-.297136409564641,-.3347406016186646,.7831782334686177,1.0647636206461017,1.5053469679881692,1.52724030083236,-4.136611033108453,-1.8063804187828207,1.0136747543117859,-.70509251853698,-1.1436791659336143,1.9366427454427098,-.3912553810815895,.8642568813442113,-.01222529052021157,1.5054456922887367,5.345263270732146,17.42581428213325,1.790231323983461,-1.660718886775945,3.8135404634724512,5.1620518388126175,.12935623971702556,-3.0716951216442028,-1.0429854861884447,-.28314790208531926,.3475303242922351,.2599884887800203,.09180662416979879,5.990507560375016,-2.568916790447033,-.8345709620799505,-.5200628369499882,-2.7076224707611085,-3.2781881361517238,-.34243153635915785,-.5406057541713868,-.4917580935852867,.23546256229141288,-.9583480585482669,2.8503822658816946,1.9486123607606562,-5.626702075922362,3.4093064978838092,.16370060595915628,.550559749494493,.3494199752519444,.3486886746852026,-1.4520839638615992,-.4448926032527248,-.1957346893756865,-.8674965877285913,-3.8315042179310987,.5851543098177653,-11.245953050289849,3.885878788655883,-.9052172098059771,-2.794031889253058,-3.0078261912699458,3.1040675992487863,.5306530238559802,.5091471787023923,-1.327156276953082,-.6626706481827704,-.5472035505546776,-5.075753639378391,3.861994484233847,2.7516076644198466,-4.04709488878052,-2.825586874159208,-.21221995022704992,1.5336199514890392,.3151534212063999,.3407384637020782,-1.305765892328888,-.7319811934394339,-1.1717792139813177,-5.6406647715967235,-.5531934787436324,-3.5172851659089237,-2.68391798818727,-3.341513380578421,-1.148158975580582,2.2558962913134217,2.0271378354818306,.8292706951089147,-.881031168207607,-.9823208303618622,.9883721484487442,-.7310267929993984,-1.3400229080926385,4.940928402482713,3.656409847731918,.9900149861785816,-9.028525528248847,4.00711407583499,.7036962298039514,-.08187129189643959,-.5908919341902986,-.6470533298373495,-2.5958958215578076,15.464219157619477,6.241882683012383,4.396792900505707,1.3121227316742115,-1.378153322316282,.570651340554886,-2.4577915595225184,-1.771191248437708,-.6193258972543736,-.37653189114579305,-.3603222647235599,3.430085221977857,-15.928605891618602,1.8822688633520612,-6.385226826421772,-1.1605216810577297,1.2904382110990638,-4.193245397624038,-1.7788060115643003,.6722926551691847,-.25346558938670255,.21216331509639264,-1.098915792180136,-2.836040883832493,-4.873306104192138,.8185696868952801,-1.9247404486411082,-.765020152102292,.11613498315613806,1.508148024109741,4.6107439045795,-.08223519587239878,.08366696571669822,-.1521474714647681,-1.2127681220408553,-3.495979175048136,-2.7663785024420076,-12.020377035514294,-1.1301161363949197,-2.5595217205352414,-2.0309128606747096,-2.4761583426283917,2.719726719353287,.5658541711307982,.22677788839564242,1.4946944877830606,1.5204116580549611,7.184789152937164,7.226280148492754,-.1988975746849301,5.658788215581062,-.22966496128125136,-1.4849670230895773,-3.4706889785459896,-.4470299999181936,-.38088761756350126,.08483728919365377,-.06105771857524878,-.8497288505491685,-1.0350823160665494,-3.048883202393482,.5749093740804297,5.20112196768438,-1.1403748261257314,-1.531063171336222,-.008362896056257398,-4.11414099677818,-1.1919042271755094,-.6131801095031014,.3888857203213312,.38189640487488685,.8513463914051235,4.949425229009118,-.7749731146065126,3.7421263719531117,-.7240849418089567,1.012685485957888,-3.9271063153514176,.31448577714869896,.789298734334102,.3803077505014209,.1967165652323251,.411085973665119,-1.9407650606807731,7.078307604043719,3.220946201279227,.5697508622614549,3.201867261358023,-.41629215035058875,-1.6630776354173198,.6797090011992738,1.1931265539918756,.7193613884800483,.2501764217635393,.10706309223176007,-1.5535268590456075,4.651517018055498,.8385903024814467,1.6427867773149047,1.6005202499728195,.7827174551766654,-1.8087662154937887,1.3918172249916394,-1.0099673279348242,-.8864456886558401,-.003142384725297751,.4911701131535231,2.2860304828706575,-3.4229110732815204,5.145521074845749,-5.124546832813241,.0628853418271826,-.611122965525797,3.6373368975724945,3.4820862173606337,-.4014985920649203,-.25853649965038267,.2476552071610782,1.8038415156730312,7.270160836167632,8.999278169002412,-.9652420728518951,.4078620266490704,2.225788306744751,-2.8264857665973677,.20759705869087247,-4.485466580277761,-.1785172949865718,-.9129234141814606,-1.2958430622495678,-.9869474545081005,-4.616923664747264,-7.2191100925452645,-6.264817092712865,-7.720916891397754,-5.194224701523457,-1.7265963569680816,7.977151430395062,-5.460519654163148,-2.115212678846838,-.4437425887422176,.3096953171680706,1.8474170220444321,1.5809472917240583,5.000190141093199,-.8692507087847292,-7.8957892089225234,-2.797829350040215,-1.4999853211646688,-2.0314218230199708,-4.979627780318095,-.3385852438137725,-.3452236522627241,.08403533528795751,-.8076905687456272,-3.7447887588374664,-12.823730179476598,5.160896150810782,-7.013572967553852,-4.8395255243961985,-1.2189484134559339,-5.337584112731347,-5.532305078176254,1.2285092406330838,.05547835872320811,-.6080372385362635,.02174257719945577,-2.31723420930486,-14.776772427198722,-1.4765918204421038,-3.691141291165643,-1.6553306796102827,2.681542378235005,.37183973380273505,-1.692173337079889,-.34740110742227764,.2730994562434589,-.6861086902730671,-.057719496968379684,1.287925044962922,10.385978167218079,8.460492799402923,2.4344442421553327,-1.229944771403375,-.27307280070918616,.0349827932585709,-.4856310780478498,-.5323780695809864,-.3616865209369459,-.4498106698846782,-1.6714391905786847,-5.949961253866482,-14.94794470943793,3.499532791345911,-1.1170194271385376,-1.6343711521681772,-.707370767907644,-4.958735952722191,-1.758804345401761,-.6777668421294984,.055217862190873976,-1.3752867272458407,-1.9311074652360678,-4.121655189258597,-3.8572089962254026,-2.580348207172153,.8578525743333243,-2.40800046646078,1.3575940545899405,-2.770369153911376,-.7177581491271229,2.0009978869506573,.6402801163768651,-.6750861143151827,.37303756775804175,-3.7959733340604607,-10.64891367673563,-2.6075020048663036,-.45357453578596646,1.3718601012037877,-2.490558898086019,.27767241582608443,-5.865842656495564,.7652395548064977,.5038353188960948,1.6901675890156571,1.0807464184166393,2.859941212315739,6.143749144050972,-9.033637348080177,3.5332245149994805,-2.246835558127246,-3.1244595761631517,-.6996971260791207,-1.1927962237033949,.9129744119309318,-.051199718375332604,.2134904558984547,.18375672893903075,-1.9679185641904315,1.5906188344737986,-2.7614712628115394,.28867423360680644,.4292573733503537,2.7344567364520973,.3365410769169076,1.7218379018630943,1.3272948742809634,.9392071921066708,1.1801204095353766,1.6483359158128863,3.599910364323936,10.53591395125277,-2.7336185139737648,.5203781985980881,4.642843663796722,.9815016268278584,-.19322013010195854,1.1544038456002,-1.1413378283012852,-.32741200027415013,-1.1645529661108802,-.7175294009804756,-2.8423844584617357,-6.857471286014517,-9.766587601324854,-4.4812221492104864,-3.3770800985286686,-.7523841811243789,-.07362556688603816,.2379605600295233,1.8556126003635944,.4634302396033023,-.3508940175125778,-.8099172871215076,1.4389986663009766,-.8594124922098842,.08906073822735246,2.2017806665675104,-.2346829746494193,-.21557567296364297,.0544019093706865,.7658998850865162,.2768974924754326,-.02239298368231069,-1.7310500184510043,-2.5040666146648523,-7.662262201977864,-14.738034278866019,-.1062087876507671,-1.0312721575145418,-.520139732625386,.20600820504583123,-.7881856382517424,4.954251773478496,2.0685815636767755,.532235668786392,.8699722712051945,1.887789426302003,3.3208789263283927,5.1294421545773945,-2.649629415182802,.413091620020388,.690446724930847,-3.74908213994672,1.3693965159159889,.9665403377629068,-.2665767849826243,-.18677061516779195,.15288755113807467,-.07487152953884099,4.089200243140784,-6.724052084906609,-2.1675318619706245,-4.138048687654047,5.400858107633228,-.156871467023786,-5.11501043470762,2.3617510375011137,-1.425086819949389,-.11302183782593332,-1.8559656422920374,-.5673622629098343,-1.0160021452802466,-2.973655258772693,-3.927840011555898,.2798432822402513,2.145590069988541,2.9926974993350104,-.41457471011897207,5.8991539793518015,-1.3310130203768031,-.7582957124908344,-1.7207684664606497,-.8219012848218563,-10.19482126572559,-18.10379797403778,-3.1809001317438277,-5.848882246082821,3.112453073867999,12.141758772074478,5.108476011088391,.4252640302921623,-.2293781305436578,-.2783208109346115,-.09796777658219336,-.47542670575891943,-4.301940339310547,-3.8812485645287786,8.732979140253088,1.3594303805423174,.1828565478452689,-3.518346658653958,2.576632607618545,.8738085651794695,-.3269011302207345,.3766282941412608,1.8255011968738704,1.8917995058464434,3.302853688884648,15.825292056141851,-1.826612757638381,-1.5125057163083875,.24036580840159055,-1.8419711716148544,-4.573201611389879,-5.371885779478963,1.1649613041834934,.3040122761756634,.6144186987798771,1.1463037511199021,5.070036725656488,6.0439777912378565,-11.1709903890141,-2.3150267097719803,1.0430072758893192,.39031507119459236,-1.2791256079884892,4.582326173590343,.824578827883129,.4697938064401785,1.6418670555879058,1.7379509312625099,-1.7033299821381385,2.698848953019326,.5760046253027401,.8063677966167482,2.4871286240530552,-.4683307921309537,2.005178336834183,1.0348639616370006,-.3651704285772466,-.3290719990232163,-.04800375599011009,-.34693347553324455,2.067346929711128,1.6327781878799943,2.487067161978009,-1.53025993369246,-1.1573849463160137,-.4477127117985417,1.407440215469373,-1.0079452119440873,.7236571451534518,-.34315255739813916,.4115693673764137,.2259635552114806,2.9324847911689926,5.818774255136444,-10.392412976705243,5.1749900549937315,3.189901034222483,-.445408235000379,2.999707157716731,5.947838818755275,.7522481354413669,.2681869410536504,1.3776775260789276,.32651639361815116,2.432673961158615,15.317323876639081,.6550201368164781,1.963533121076318,3.827689598352458,1.5541066927678098,3.6524754526498238,1.6462475224171704,.32945597142002525,.32681118804630344,-.7007319924441775,.13536317948713886,-.5175212859224023,-.30184317769628566,-.29550101689188324,-4.741991739760765,.7856202096520346,3.2789838300392424,.017457804156050343,3.03412959230048,.7265624403206173,.24323058157167146,-2.421197556770775,-1.1459983263362092,-3.2754209963881222,-9.954933222487936,-9.003436588442352,-7.518223219152993,-2.906502953298443,1.7257971848896037,4.610843044102179,2.337653383609629,2.1512770589115875,-.21927233842432262,.23471241884807564,1.615847562369861,1.6754097610511909,-2.5878715429189376,-1.716734515111735,-.8834900609942001,.5894351198792618,-.8711881201899525,5.498127010366844,-1.519090543501311,-1.9422954228644194,-.592440167064558,-.7306301009159764,-.005370889739294624,-1.1238681564811768,-17.685921711267444,-.5842904066842585,2.2439343953573614,4.5105172258567405,2.374230715241791,.3659212961139532,2.5748116306393496,1.0901718912854208,.4478546835389827,-.35813370333456124,-.7333566943614459,-3.9768544187909822,3.494162820458415,.06054274804242251,4.961017874794271,-.004371392776036291,.4579991378979534,-3.2819730276415444,-5.562138475320881,-.4370727381233281,-.31344566051099154,-.6454387660261697,-.8731622926282376,.6360026301419303,-3.99177660451319,-.4447277489672477,2.4902953247582587,.633066521801498,2.6180263652568274,9.409174725163629,.5672984073715879,-.4372977892939059,.043115883353783455,.45433823123137385,1.4569441974939656,-2.1881105996773154,-8.02818948351017,12.43754111136338,-.9602952370260751,-1.6258493029052847,2.2020542492229085,1.4526271267717779,-1.2164258648517932,-.5694573989546728,-.42474168732916096,-.7428125436838283,-1.2630010496129367,3.499429027327629,1.4857258662710455,.6306245766863797,-.2016061749468505,.02417688981273624,1.9530001194708004,-1.0479654884106053,-3.264468097779048,-1.4998074220033304,-.4766064055617339,-.1141221954616365,.19100941087837586,2.068696454863794,-2.814767425635519,-4.935084212192655,3.58468688840829,4.253933525346069,-.4283744491712993,.40508604560494116,4.364891844580448,-1.0946901910144269,.2619610813419547,.8023241113238593,1.5732371121733773,.9627643940134761,-12.015010550792718,5.429508226402829,-.529385505178966,4.017420102705121,4.583072559081961,.08535838410479381,-3.18550315187222,-1.5951141137408162,-.2614843928879766,.2285004281735975,1.0353205915993067,-2.237320835704625,5.334598658662154,7.582721836122769,1.0114497680438062,.6703244820927613,-2.229926163555751,-3.981658599265937,1.6866568096885244,1.0533213764211309,-.1278407357320891,.7945112934766122,-.8458634854210024,.14967535278284527,-6.75549236260104,9.121860482540185,5.858800517974764,2.072030733848762,-.04930792429265554,-4.19594396604914,-7.909140223163728,-.7900425188057316,.5081203298967346,-.27204616795419057,.3972332401910547,.9876240298153147,1.7149294788742973,12.055779395511351,.7423523821607589,-3.5151470484379845,-1.4318871555344292,-.43789385782196905,3.134789572823895,1.030369527036122,.4570378690167607,.9003003171116735,-.7056588239788925,-4.919130146621422,-6.376147318835493,-.17073625576374654,3.9435018776435453,2.781688517369292,3.5461634183970294,-.44524660473375866,1.8066496323266727,1.3238992853872031,.552866275898793,.772861419223555,1.9448400357759772,.25320540142413195,1.5884729639794637,18.377006233128714,7.276050450438689,.908708522453703,-2.239869488360563,1.4175086494063716,2.5337497657267574,.773798252331386,.18108647534901093,.8614064161268611,1.097317697257088,-2.4819937318634366,2.67009948704594,-1.7263983409098724,-.7595839013678587,2.6401394239256883,1.1038961756714005,1.0780916425410825,.18610083985932985,.16576376813937455,-.3927546829533425,.029064845355447563,.9489857550783996,.465954979501278,4.963410408547646,5.014523262300207,.8501136207485045,5.067195039712879,3.112976949713159,.7435026200943943,2.0938955977566907,-1.090938528541277,-.7825578344494988,.4264966368119404,.22603144865177188,.7728350532586141,1.2804545566996883,-5.619284765698914,.14816415670112223,3.098167710188921,1.3762584221164877,1.9122183692146835,1.9165425967867282,1.9918574454501343,.3626240466850247,-.3815602507467525,-1.6806567461579698,-1.972250302016178,-6.55889766479368,-4.88663087852247,-.4157034019809831,1.4339563793966654,1.570020420855513,-.9900100907117674,-5.130092766269947,-.18408149035281754,-.020151573451939804,-1.5733604444709806,-.47454656806675627,1.2987426058616978,8.264197484982555,5.955924569810132,-3.523298348863288,-3.1968491198848925,.6532447095697491,-1.0473737770597682,-1.927209863804521,.14984037820159582,.17441900896795617,.34457063269090255,1.9817320815494759,2.991212720218955,-1.5156754490730033,.4450628901562778,.6033640358297261,1.8067641048177288,.8466264638239926,-2.5167459421137237,4.87591898759573,.6023596884608182,.6707854881012654,.9812348028238724,.35884482944453894,1.082691411207672,2.1692543063216863,7.139346993575607,2.3082357705805445,.17807557445058383,1.0197523212867026,1.4460828783915791,-3.18581411940602,-1.6081072948650696,-.35431319635128533,.4486486824846317,.2024893136712314,4.901564760574633,3.1530109650773603,2.3781082009216163,-5.28405116127183,-1.2491202958403178,.8526095838445946,-3.8018651919190227,1.058677420750974,.4915610622961259,.33881935147301273,.10261091855136564,.3408792256158662,-6.680372296904158,-1.9213042775505522,-3.429474883327243,-3.6047257974143028,1.412363173978741,-1.5233511781307325,3.6640401557340425,1.2304655512592222,-1.6105846413115992,-.3518586693188758,.4259463550294681,.266366276815427,-4.131440642288406,-15.775840322379167,.3725862414462265,2.5348311877628547,1.5585025542392834,1.365302325139056,.14747459745619157,-.27597326706301956,-.8648180180919222,-.5040051937117683,.05130913291876686,1.2022173865314782,.22360301289686624,.9078959792376475,-1.1552425678572307,3.6676634056044075,-.18792986938029296,-.6218464917944638,.3505392946285476,3.4429624708431796,-.5273253834671516,.2845587340736659,1.0690748056599277,-.054503952395060284,-.5448542801995089,7.982032959263634,4.449865594430717,-1.3147125425508441,2.2500524288738513,3.6187322982811754,1.0159081597319037,3.160441516133191,1.7735797798179354,.4273161331495223,-.3211265058254427,.10025074831851577,.09069826643748093,-1.695626729061284,9.992625640332562,9.41234290811807,4.399390231537295,2.9584526333135837,-.3944202552907497,1.9276011695935553,.16806895899709043,-.6414016656584437,-.7567209773934679,-2.788481415712038,-4.1592469782730115,-2.4891229741643124,-.5920017965740294,2.2358693684449165,2.58004168224494,.10515040097326135,-1.760016434883978,-.7651108585101956,.04594178216063295,.6976585507028423,-.4251159444317868,-1.0920889501548503,-3.1069660198744153,-5.014765196321434,-.6432099888716608,-1.1875013266410586,-2.6409481932222625,-1.529175033915507,2.6184103929395337,-5.48432053174158,.11446197798472174,-.5483287101113329,-1.3023768232463324,-1.6394147903703042,-5.506473018989573,-14.708600108249485,-4.365620205342774,-4.526861189762075,.17605004126649795,3.93157010918859,1.6835997515212704,-.61139349140394,.8280103905393927,.3546684931739444,-.2009169845125056,1.0184892899503135,1.3513337532302323,2.1473704681576287,2.2158701010147377,-.32369113481435363,2.672311121024643,1.3717519001871972,-2.67357254096617,-1.398670586731511,1.558759680676879,.24096506955870348,1.099664446756382,1.5561765616212095,6.970283197185374,3.1302473963672863,-.7145535890118201,-3.3998057069021943,1.8863965519243366,-.03572152180212163,.42767614454065345,3.56862161003789,-1.3044407450170556,.3660185398671781,1.7569847359705586,.7053464500103125,1.2670082974548904,8.359308868559486,-.7876323138466826,1.5063681516819152,1.4399299829721346,.22210000618677905,-.4057795015415909,-1.632384372814559,-1.7823151433736484,-.7372903495926734,.8834368819386483,.0943958188022007,2.944692935145048,7.842414464737396,-5.69918732205338,-1.529136364459713,.5365253527296321,1.9867809755689978,-.4033916471705238,.9266415921275136,-1.1230113502360002,-.08695084387350147,.5128141256164092,1.4930905150053342,4.331915151184601,5.96146046272457,14.810221708029985,.6322633362708493,.2133967378312891,2.494912699878879,1.2441042505253248,-2.0986023178413378,-2.1481168633664076,-.05203045652760143,.44181060731800903,-.26395007630880285,2.569172414439626,5.480694911234387,4.319297097668368,.09906814374301043,1.760024354532099,-.17164392186771835,.45656056999672384,-5.840474258090778,-1.3724163587675984,-.4310302973164393,-.681824621088539,-.6260124992619617,1.5915635419712806,-2.421599863425291,-1.3115127969311937,-4.300466240431475,-2.263817618785161,-2.3270074325757393,-.8844160651001366],zne=[3.592574868528974,1.7782715162542346,1.028057648204043,1.015641159808127,.17126432302338307,1.0496507247904627,6.733498300523817,10.647033284642559,12.900307828765573,14.764929803585746,11.33493297168024,6.709917680354051,3.035960042581614,1.4825240099446648,.9003043296098643,1.0947621842316377,.7662450651981341,2.244840728526968,3.803363687501226,10.741351093432579,11.568391177275984,14.262299721482394,11.110618769570468,5.063228444614323,3.7087953487282483,1.952719984635347,1.331936217146474,1.1591629849153209,1.1208970635299516,2.127974824734817,6.089366756146667,8.19658774357056,8.8637461603626,9.637949427945522,7.512858526202574,4.077334992112749,1.5115875050523366,1.053189286150481,.674568773268085,.9587503717445821,.41680616825910866,1.3781845800827952,4.5668418862138305,7.62163587721641,12.00608375757697,13.684460886243636,9.97751058758313,4.612820814154541,3.455872561628854,1.7588941590128844,1.1796269197196014,1.0895752416973237,.4692367237298097,2.096033739166935,3.388682601477402,9.86459373531256,12.362807495376082,13.467901539615962,10.068123992527628,5.1747983525910675,2.960311761370201,1.3548893856890774,1.118166011711502,1.0614201682940678,.3048319643846533,1.2521192191484183,5.4552035916052395,10.2997609745892,12.031763239587791,14.322780248665099,10.680850704650137,5.396875644999651,2.745571512371369,1.5564918041742863,1.062073524479536,1.2655427998410904,.8133548206569575,1.4907678480820978,6.364093493015633,10.77314240288866,12.190408450885151,13.499593586739126,10.917616981721839,5.8138256714928085,3.675277311470488,1.4339993351483038,1.0262304912518763,1.1208297052938252,.7657860455592196,1.6664124067771915,5.178255334265811,8.865528143681022,8.450681837356528,11.225636188698939,9.089869207891377,4.611651506300685,3.374559775382857,1.9325823035904304,1.0440564509134382,.8628896320710117,.49731277545331787,1.3162890308996282,5.5900631679196255,8.284534887759953,10.859183456982358,12.14411605643286,9.164644682124457,4.226502435951157,3.1907244954090443,1.7308618040985673,1.2802692606328003,.929951905463079,.596191024058677,1.9302211592062537,4.913077628432266,6.725699068530616,7.198215412814024,9.372121467639312,7.202353508406529,3.367626751637484,2.4239909196683476,1.090471216364356,.8083730613741541,.9020488076448925,.24610189485383754,1.3688759055948747,5.1766981344515655,7.891080349032247,10.349741716099315,11.028697012861366,8.863663845590636,5.071737020922155,3.289376374504574,1.7625295776235812,1.0536913956727103,.7553431239731869,.5912403004205877,1.346639216765495,6.0709693700319365,6.714326002949105,8.774206269932966,9.663682039915173,7.474316826127741,4.021720956501392,2.6827115565532083,1.8107483736970547,.9172895630830922,.9753536979206112,.41945597976621196,1.9949861813155536,5.941866078842538,7.640114361185705,7.514975675488044,8.651594482933769,7.057246261051778,4.0544389895991175,2.237815498367219,1.132237141262634,.9298995066338357,.7648838271143759,.37405005439929906,.6563498369113245,2.5517947502518905,9.973635756004265,12.379853513890149,13.007891939460011,10.16474376931536,5.502400983202632,3.014813477173052,1.6920667876165167,1.1667460459186938,1.108124293113769,.21445615719918137,1.1547717414902077,5.669263428955664,9.88161284245164,11.29843443814054,13.82221967920738,10.966991844598816,5.740882892905357,3.3685936596401986,2.0712851424420946,1.0997970549827571,.9922727830249266,.32007844477020675,.5993282527241576,5.1988035912055395,10.970586455734809,11.633650498086123,13.83514274659052,10.877536705418354,5.733516205892928,3.4695253321545234,1.7002393121765909,1.1266299401651694,1.0011999145455106,.1835818508790818,.4751826222565688,5.2459611744318755,11.71891968788658,13.318898932373068,14.786613051930239,11.74517257994963,5.986726831582308,3.0487354363137054,1.9834851765112245,1.238374409153973,1.189380818670725,.8449551265646652,1.911333935427095,7.563918669286296,9.387656008160358,11.45688031944956,12.826967135559904,10.281530295257175,4.722080564111447,3.3814871134691207,1.9910162877778947,1.289384552910129,.7063765504846481,.1859792064169178,1.0394607763048096,5.9123583528254935,10.723741166447953,13.22487097728799,13.534123753337994,10.733071845190326,5.1414585424191115,3.1837206266025824,1.8558326929598608,.9676756272489851,.9178595560230095,.09668652042237776,.7478821899511726,3.531884732787419,10.5620524321617,12.734882098548226,15.100106193871023,11.125071215865354,6.194608738239029,3.365725953668928,1.8415993802083854,1.0049062992003972,1.0894366564161984,.5738531686596549,1.6951426595068522,3.6700545902707566,9.335169816730037,13.217937931334644,14.87342524812841,11.691908310992433,6.200204423767594,4.030136782510434,1.7224552616198425,1.1580561243893,1.049786749598381,.7570385794884043,1.0567394715636624,5.755003372948347,11.269258255147777,11.801103434236389,13.974734241468505,10.923768681936235,6.0669982830445175,3.678823890913455,1.9267032398103328,1.2162442756509135,1.1115659293977922,.42748715443538116,1.8559443888003062,4.925750982823906,9.364083472700726,10.353441603483063,12.833952169416998,10.667346621402729,5.847851380597669,3.185884044412922,1.3721409867584355,1.0106448784419961,1.2624726697651314,.5101600922739559,1.189012887210481,7.2501211009583475,9.608451978290747,11.987868549893756,14.155490955983716,10.665551092743815,5.969264264874983,2.3490858081282235,1.525757252577729,.9741795904115491,1.2482818533361033,.6043498074570738,1.469267157964551,7.404897453139042,9.665122762479202,11.84350523486676,13.517538444727464,11.03670170510003,5.700124511764036,3.4032745567681695,1.4761731663409245,1.0353469337688381,1.2737694138786209,.864951971642365,1.779492360343897,7.217801625622915,10.168204103931952,10.421653997259423,12.509545937611783,9.751862031017806,5.7129312838408985,2.191466003370001,1.682100570837513,1.173670516443142,1.2996392678527633,.981640079249723,1.858979800960179,3.579661594304435,7.5233879704762385,11.409494166245846,13.202576307181708,10.37625789087761,5.513083075017947,3.368046673027279,1.9135294764197766,1.1296788197847984,1.159463534210141,.8098801307102955,1.121570162799733,7.329392863915222,8.915738045258209,11.518360468136652,12.681969265441817,9.384673798363849,5.25769136436909,3.667175411325159,1.834646772986116,1.172934675522874,.923531412262815,.6623973797083745,1.2788079264103682,6.507081771324024,10.328020450101995,11.278656758280393,13.59835219732764,10.773345606223351,5.106439897583873,2.3303214826231975,1.4968217150800653,.9417474979148932,1.0299839958980133,.5046971603668239,1.579891249433817,5.970487458573141,9.99873044718383,12.322162557076554,13.753383953273493,10.757662090318421,5.890953109317246,2.8998953864321027,1.5759926415453955,.9713793261970208,.812749178826014,.5288471360789613,.7140176502436064,5.536113984288668,11.640104999690594,11.487814682698133,14.532995850903452,11.71749968781859,6.281154251706392,4.239763513953873,1.6890324797777383,.8801530208723334,1.223735789481582,.9932434452276041,1.8695882856756005,4.883750952053358,8.873973441989135,10.84358433910183,14.531347365517473,10.342602660900665,5.945847404804408,3.6913129269998137,1.6374867490518503,1.3038715930888147,1.1004785752665769,.7735161371376837,1.1477659927852237,6.018818051433083,10.70868981578877,11.182890995401731,13.809875725795298,9.76475949974742,5.498510927097412,3.838016591415912,1.5724989015758768,1.0378346372819625,.918664458303389,.5400162345404392,1.9453738577767499,4.484416557127496,9.533073928473138,11.54360837851199,12.82713278331237,10.990548496965301,5.726793710895044,3.763297366719524,1.6772165562492296,.8486009499105032,.842466059071744,.53741794993265,2.085262468504404,5.523150680957408,9.878211921774517,13.051872325365323,14.226808290117887,11.083647313466761,5.758543117402694,3.037499146419897,2.095087023436708,1.4427199336665513,1.0505793695720953,.7297489192768689,2.0911912493980425,6.291495227932463,7.808991505845014,12.890864301611769,14.092984906760712,10.782926368667866,4.954794077100499,2.2819640556215828,1.8683498876574345,1.094048355329374,.9717137536127253,.18892508666745533,.42639554914456124,3.530487001330499,10.781359035181225,12.205560805650904,14.415641626996257,12.362989681829479,6.478363508145815,4.532371592787978,2.0771972300639003,1.4466354163992758,1.0748461338615556,.5269560335930743,2.2379987112115365,6.987914623462631,10.252123041667828,12.120704293761937,14.013158667477155,10.353811037109558,3.2948192819652595,3.9337280758966005,2.044019950127549,1.3439575313859136,1.0094628191540393,.4585404367700089,1.7045834039022203,5.488932782782864,9.136139018526526,11.899324324078574,12.951864284451588,9.907278337243444,5.338460235589533,3.4462053961805936,1.3877011309430947,1.1082125439923443,.9306889468085386,.6650900542024536,1.4876575845242157,5.630328679456813,7.973095493416648,10.399635985067821,11.902680861161455,8.737956000642331,4.400961419026769,3.2684808380998915,1.5205324263957039,1.0525319575940648,1.1361978329184523,.16289997638240114,1.0046979010924113,6.774075427781637,9.679848447711091,11.466976190865394,12.951867202960718,9.928566214139495,5.1771058493928575,2.0723739718100878,1.8453264494725257,1.1523675949004482,1.114721955201715,.4326816789832507,1.110723913928202,3.0649874161391493,9.78925241538671,12.173153296550467,13.78197241698931,11.105015999742424,5.784111259540293,2.691635824021682,1.449405376513078,1.2090280963382365,1.1763592467252388,1.1593942306321248,2.259500456051581,7.243803319217185,9.244577607508987,9.97477884768036,12.680500701432578,9.95095351007465,5.044183986460655,2.582176449132704,1.4386404351967472,.9562834413878941,1.0866203539121626,.7922298495600335,1.7421925757509034,4.326067743684369,11.499041390335439,12.083330948864733,14.2087700647354,10.460718023277009,5.871315130435873,4.269689337471246,1.2674934620647116,.9878642746321289,1.2213762740020995,.6786611979800615,1.8036133433027417,6.809972801026586,10.685306985945658,11.645504385556832,12.761435430516137,10.742202701894444,5.483583394662436,3.8906888190782722,1.4519016144818162,.9788236362344402,.8759940567832173,.6620269916942446,1.192992656201751,2.0865196769820638,11.661764397206168,11.453199641552157,15.394686492317632,12.655616779041951,6.7088501331066634,4.222945912182824,1.7279066943128516,1.2376418195798948,1.1390085376312638,.8451347375969936,1.7951367034594512,7.49518517852617,10.15528803438303,12.181858552631533,13.485353965172045,9.195117631930666,5.610837837303412,3.0893132609121023,1.4439958044981689,.9527981640751102,.6705881302870159,.043929981584568775,1.34297256860034,5.402507319288882,11.944745410870802,11.88255660274153,14.648843467858418,12.256876993181637,6.167734736134466,3.1841253795311535,1.8412044090717135,1.1447293176443356,.8783891155361704,.7776456285432676,1.4080461722943838,6.640507399928699,10.847718296129655,11.654999877867839,14.000171707386176,10.890848630131511,5.783649922410025,3.3005423715742364,1.296814242086902,.9346357256371898,1.2725032261154496,.8298736378006156,1.5844111004506445,6.236157998250972,8.34644134477168,11.509298069147864,13.708834661194253,10.873069059748179,5.552127172282099,3.5942162063945693,1.7283720490643075,1.0382568854149805,1.2249320651173548,1.023163019987869,2.8236310977999657,6.770958968169323,10.556766336273306,11.992710567759786,12.776543612362156,10.138495715229556,4.745717201658643,2.3497551189320007,1.1768373404020416,.9714368440260058,.8756953090610569,.06935968748637954,.7306705590410745,6.59971842004963,11.68036098289296,13.051103461869626,14.105137208905516,10.993513957428142,5.580198328109991,2.565658173038471,1.460833789929884,.9849896020138459,1.0568655722437794,.779498487447236,1.1340064815674835,5.705619422601704,11.268285344281532,12.85582607157389,12.78240450237903,11.31055195549251,6.417763868718123,3.34864292720181,1.83239497095375,1.0955501240724264,1.3442964857694681,.5592034855217916,.9359495027168891,5.464442010733693,11.270881727581957,13.016769389054259,13.612268065656684,10.279554525307587,6.16039402687411,2.485443820553511,1.9409158378018587,1.3657309275151888,1.4259768644007718,1.0922574105311305,4.005379801315109,6.417491592463148,10.134405090409619,10.52623691371089,11.63577639113104,7.104228480134234,3.8997970564087083,3.3625019686210216,1.7141482904345755,1.2450088103086139,1.0985435192652149,.8530215458263749,2.559163236060425,5.240381709649053,4.9652566638000195,7.3622385245679425,8.0416024868898,6.084386391657153,2.839521681671539,2.272549495944147,1.1382812020656417,.6151604374662563,.6357606589970799,.09920872092603653,.4407080064127592,3.31049958458554,11.656018647550313,12.751788334177578,14.284443455729312,11.367769832408339,5.030611661593652,4.449684505235384,1.609047880648062,1.2842675088139432,.9880524535045706,.2942094179638059,.926090927297025,5.947077734998159,10.856113205268196,13.186902362419426,13.841175400441818,10.60816574972271,6.177427552292649,2.8199700295807313,1.6233105385686066,1.1371752937816264,.9265902212445781,.3012838182004052,1.4110092517561685,6.358235249229416,10.365193926621403,11.861964962926985,13.751919059777581,11.057300367791616,5.99793603121401,4.12145992120266,2.045186603239742,1.2802516403013289,.9759942537295929,.8855286094774483,.9717070953095926,6.4730403856324665,10.22483934329707,12.671977204214635,13.836707587167636,10.56716063207671,5.389937022280311,2.3116757847526204,1.3692952670325382,1.0192611200514814,1.0185657381164293,.5422393499540261,.6330564675864794,3.952521594835668,12.532024782680576,12.086495902027517,14.592213250482091,11.783127913448576,4.504550506578345,2.5487547276497398,1.4103804088122278,1.035348037011627,.8479255901246039,.07683973882126663,.3574760091943314,3.658590101499321,11.36236607162803,13.008478299048427,14.158857337600091,11.424531692002915,5.642914829383634,3.9252121990901268,1.359310503191067,.8934343712771432,1.5053667001379907,.8993300301442178,2.002555212467925,6.623485349912585,11.335583778892182,12.000786265462764,13.976807879740313,10.654974498646984,5.831632606037996,2.4827620304917684,1.3060246865178762,1.027880029375235,1.2134609678480401,.913860991732233,1.4101734743747782,7.40947373085775,10.211510117357424,11.854345799485044,13.297057463163627,9.819010641182164,4.368254551798245,3.2039013262276526,1.3619486224778454,1.0058347082790122,1.1268297653108303,.2301761270164639,.7339852248859483,6.076453116375466,10.850087223105898,12.476729859269962,13.378759242544135,11.077656557960461,4.326985399272367,3.922489338345727,2.050723142062091,1.2983022756049776,1.1409489944451816,.6091742651940817,1.075006000814807,7.412339234587382,9.99910585216132,11.296496890920269,11.621364623442238,9.72793904455679,5.2768779895447,3.1468544284610567,1.6808529785614696,.9793880588001449,1.0074361071088254,.8142335194754631,2.5626234132393635,4.556036145313861,7.786736807147777,9.088267274962313,11.381155753159815,8.47386212596555,4.781516593750929,3.3534010054307024,1.5132023040573965,1.041919315339785,1.18869414643354,.7149247257937542,1.2322879417232626,5.582465018557183,8.302994024511548,8.942961237503425,10.827799393489643,7.979109017118832,2.562448211839992,2.1167596032544096,1.7538393652658508,1.2110373566870198,1.0478259686831939,.574620646439143,1.4280569825678116,5.373336383495091,5.530247982588238,8.91447332986782,10.009603719535312,7.573792479447246,4.0936945815726,3.1335607960848257,1.6561500387201098,1.1498649310692086,1.1186802319947053,.6819241134345642,.5235296106445777,4.106232345346104,6.163288427736581,7.063242223788433,8.524317061677381,6.288428342504222,3.5832160562434425,2.0896456716452145,1.621066504808092,.9780801371863381,.901337642628426,.2841855553950747,.7247947672015167,5.752634492166543,8.90050947145432,8.61038314352238,9.616536085947747,8.377992009288809,4.421056034788167,2.0338614594337012,1.3349052920135998,.6222158215239643,.6019405475305789,.07730025615165406,.7830649649488528,5.777550867974764,9.071234747252523,10.720200296726432,13.073651273307926,10.320107459024427,5.917858256674141,3.411865359422788,1.8043678866401254,1.137203570002529,1.1969663545668086,.5545342905696851,2.0746757601413357,5.633513655077592,7.487704755849723,10.523899525925614,11.818137199495256,9.4319464571091,4.9221387750505,3.0402983964213632,1.3975771921328635,1.0440929158055738,.4877544688641648,.403767784734113,.4395451086322427,5.705230683655219,9.174271182972513,11.430756947478468,14.214532204402966,11.868043384632385,6.72660838008173,4.621934821362701,2.196835642322318,1.103332049612432,1.1089836335985144,.34023068696244757,1.4960271323412488,5.984976360708317,8.61114915251904,13.039886391972484,14.903737037376956,11.68480644198988,5.967003328870723,2.7491529080350894,1.5834805768965057,.9560458430309254,.8047922894703602,.48464789157099614,2.0882374558214694,6.541073649868686,11.261605448023904,11.45065191857518,13.41645366670633,10.216827992425506,5.657609808571862,3.4292975314684875,1.430769601673309,1.0425292511351574,.8124527517905523,.019525099121108315,.8149115457654198,4.741113410573391,5.939136991429164,11.28375819152349,14.972182070480695,12.481526199679005,6.372221802607651,3.8392416706415307,1.747247893268132,1.3143801994529387,1.2148697640643982,.658996160033714,1.4481706072106042,5.973472289294829,10.558864529710977,12.081482820474921,13.376891444025274,10.28692896470536,5.960555717412075,4.040293215767313,1.808021772520012,1.4435879888306795,.9777160032340119,.40006406231184366,1.4022745150442646,5.6558406649280135,9.595199523166638,12.327095726491565,13.177614556163185,10.677910803328395,5.341651053334288,1.8252173056229373,1.8394202752492559,1.341584852273993,1.0118661489292984,.5029367208083977,1.6062582484772043,5.676209544049863,11.412315999821555,11.819430182952765,12.5690170623346,10.243889146430087,5.321189727796107,3.5272207726148235,1.4567771834309684,.9003144883129226,1.1176050028429618,.8746540690084935,1.765671032976663,7.065564359733647,9.297336827728346,11.717332161261295,13.052249584063059,10.104873482608339,5.655565470235365,3.844014571204307,1.5534281625891966,.9089677496983316,1.152362144853115,.6373445287905796,1.6004349740922215,3.9466018374137524,9.009295988232944,12.361490849170465,13.980269109612626,9.742198766147105,5.78014953508526,4.189899918474424,1.679939563469058,.9703994393461501,1.1382585316556328,.3504091905338082,1.9432124129066768,7.432137493902003,10.453447020850053,11.823970842523588,12.998103582637334,9.96623571775625,5.44912912367584,1.7092413550173522,1.5756226084432967,.9472451848488572,.8964129556566138,.12578804758117348,.9307295300853975,5.77706243565471,8.870301019240642,11.603567176957666,14.994789369228009,11.843994642110545,5.862651648358786,3.895161800547407,1.9443451756288608,1.0669410012286893,1.0212855029088854,.69938627166429,.9182268544384918,3.3016596489429424,10.504429507895772,13.428016547130541,14.953495782828195,11.293195939311392,6.33501623373261,4.040644698769912,1.7388100258793902,1.2073864111208168,1.3936206343198532,.9153687303291427,2.8328931639230226,6.867147106968077,10.367759124515093,11.529194603422303,12.595831467369743,10.094554520408524,4.867070792201438,2.90252960619984,1.922829513082361,1.1482655960395476,.8054806767181443,.4531545538199864,1.9354307897804368,6.373983007793644,9.218821490276063,10.5465885458148,11.601994846523912,9.278436385853094,4.955437310704395,3.186899146823513,1.6634711515320695,1.0821197685727089,1.1039716897163705,.43268841411844217,1.5629045952787965,6.057082533734519,8.775765629514094,9.757011855634216,11.865249300638508,9.19371075093624,4.874720733868455,1.917291937465262,1.8164099654172883,1.0428117252594042,.8217165285241644,.23915701984679438,1.4336377157495515,3.754207361292713,9.163861528742068,12.300929033195672,13.774492920525041,10.638045500003331,5.886050873025813,2.6700422603409693,1.5871163313780197,.9251604894383523,1.1531310248036475,.3056233944798666,.5896271095895663,6.835698788001762,9.10161362131669,9.78439490807821,14.007474575738456,11.543566240650845,6.571769915965845,3.018578448963432,1.8037223998791778,1.467485239116697,1.2706699348106216,1.3182718922780776,1.8272748308099873,5.169740599834269,10.668606140990955,11.376310317181186,12.633671427587771,10.613235930684523,5.7790533596166656,3.4158385983134685,1.617436182272496,.9409520005592296,1.2426905011459513,.9494152571679447,2.25278517006261,6.300108728432767,9.124631574745285,9.842072983951596,11.721560533752383,8.78438259152621,4.2948316476432415,3.4434990863644352,1.7336341478802755,1.2689934313873086,1.2859922433392714,.7541676712342587,1.6227896226066127,4.405500309607017,7.334993329530139,8.028742594712675,8.544111558957058,6.511920834263762,3.2928552276124323,2.2968172581127666,1.0232306323889622,.7977194450557287,1.0358347552971483,.3905815476201029,1.5184707558065842,4.233432747495994,6.204944700251914,7.344553408889948,7.650058039957238,5.998625054015989,3.240616542991368,2.257630192157824,.7310456568771692,.6262134736248938,.5074187669764597,.18886452191245365,.41671325967321715,4.298013106994024,8.892727032001627,11.216835316352373,12.379343338548393,9.510910856127362,5.131027262063237,1.877346577583812,1.7016084841136958,.9754752270421725,.6799351500151444,.05499735028166584,.8396226868527057,3.955907117443571,11.40109519603637,11.328918923414243,14.803445508023701,11.466906086915596,5.96546548371894,4.057378949353448,1.732654161694799,1.2898431290777321,1.057911966904243,.7903378267250414,.7461139809359696,4.083429781326203,10.31798403906948,12.093867342951366,13.808945768833036,10.163508306019333,5.753112522274058,3.7875392918341793,1.5679349459291336,1.0383019534047442,1.0954380568475302,.07601860853283932,.6452005464422381,6.255922965292566,7.302161894973919,13.081430694767405,14.146148717921484,11.252337294336174,5.808304525612026,4.199251551772032,2.0037062674544717,.9279214182399211,1.2836956219257118,.8770095762307749,1.04451527594023,4.685394662638707,9.220070424560223,10.960475368845541,12.191694193654103,9.693012274527758,5.23349817940084,3.8181015085918215,1.8224781926389244,1.075498546024732,.976092852796735,.5997171749149762,1.16278880596442,5.241649903512771,8.2196891970264,8.985152917625415,9.934601353034566,7.7184488240343345,4.304317990553059],Bne=[3.7928802605708967,1.8275736993952125,1.0688703004047464,.7767457613269099,.1451893980227211,.5314717246870149,3.3951217764273287,12.047425481569727,13.18157114472685,14.786179810532722,11.797473299159051,5.217829585478263,4.580600858612282,1.6093778243417785,1.3006887741760693,.9881678633167156,.295005092783504,.9692627764665096,5.951668601637429,10.92143674606867,13.165503513620745,13.820032866554975,10.611344048219841,6.177288564132186,3.097445342051335,1.9481607255949358,1.1688778924029999,.8087835605168164,.465937616265529,2.089430082936833,6.903903066634446,9.892643198098737,11.383730608216334,12.54882718606437,10.060709817577646,5.512409899511526,2.9632609109866617,1.7291298408867999,1.1982936490298004,1.1410874250086176,.22511314087723416,1.091630783712972,5.707232785728289,10.005348234916857,11.407918915104883,13.963595007802223,11.207717593834586,5.834935358335452,3.9039563601676535,1.8522344983853105,1.1941235763017093,.9209850289285687,.6762991008094447,1.3688928604629438,6.539547290653605,10.41747569138147,11.842793826588183,13.888614336428718,10.981164030708477,5.289217975912259,3.4699016335993984,1.4475926493243134,.9007946679071637,1.1059779581284852,.8736374213416492,1.7898602742817435,7.176110202083876,9.420173655524989,11.816079070708383,12.909197111526195,10.067995793770837,5.697897943023409,3.862059116746667,1.5583079875291712,.9147995516249299,1.164352433600702,.6573608231330359,1.5991537665030537,3.948839225840875,9.01163299843201,12.393614656242937,14.065153679523695,9.806138228335877,5.797300748486421,3.832892403515893,1.979977025376105,1.2315283221461426,.9463871374142648,.7955068056781197,.9205051227338479,6.422603064806302,10.113069188149241,12.403683259335473,13.55445089527537,10.362070637185646,5.29789020886683,3.298446289856358,1.7039172760706998,1.1361802251338675,1.0039268502270768,.1790973638215366,.4705008631124402,5.2606519973178525,11.719581289339748,13.306630963873717,14.77132556739647,11.732495686564617,5.979917299068574,3.722225378355673,1.988552468843439,1.180861793096049,1.194353270103495,.91867064424089,1.2030447493672172,7.864780470289754,9.4106347110711,12.377867877238701,13.68997366033207,10.11403167999184,5.685657939758663,3.885681466505976,1.8601483067484257,1.2007220463454809,.9321422544408774,.6996500130149528,1.3504187362411342,6.523792442935145,10.317367698812555,11.713743015913636,13.72867798106637,10.781683287120845,5.182558605555691,3.7885218369985223,1.8347715975108059,1.176735063667693,.9065552211660068,.6433335712357948,1.3668271080232097,6.557288886873274,10.387277696614332,11.394582783005568,13.676668650140202,10.837205970271196,5.14043802158492,3.46875619962428,1.4469922903198689,.9000312605358647,1.104772020616373,.8705986871256808,1.787026090025427,7.175384702925885,9.418473447238156,11.801943878022396,12.8585625283396,10.03079864472042,5.69670249640357,3.654513606046977,1.407197743543362,1.1597900433847936,.9638587097270246,.7589977428814054,1.5422248318848972,6.0603946776066255,8.40072556811685,11.200348845552355,12.7517220039655,9.447371121513218,4.834975710252973,3.313696017957579,1.7280330857756945,1.1574086801110979,1.0662851286230062,.451836644958673,1.9294219785958895,3.0455641387774266,9.174446779856561,11.376108359158842,12.332728419496876,9.223580661564002,4.6284295337500625,2.905970673836063,1.358982386258197,.9973252170089432,1.2223408958264312,.4675314895628454,1.1274489006662203,7.102552959217283,9.456785051176524,11.859168080044292,14.017347731127927,10.748537419686393,5.922470024236249,2.860953015496058,1.4682625795299828,.8850886109078204,1.0636184226608998,.6905563674962945,2.1703253713482407,3.7220861559050937,10.628508048105438,11.164449571307571,14.07057314216042,11.146133790061286,5.034932665479798,3.6989225902339316,1.9509134583792993,1.3302201588767968,1.1577556088629255,1.1186327171738035,2.1161723739510667,6.091615925259086,8.19307620841245,8.784013742165637,9.608593458744698,7.475193935867165,4.063694622454013,2.7961290201446416,1.3665425514454947,1.0110409262767548,.7591722689218378,.4052512918155844,1.3131920062824418,5.006953046584663,7.597199701029078,9.93184812061149,10.97826414250313,8.319519763559931,3.7845257668154733,2.9417384939622413,1.68310461850423,1.2189455256337989,.9049600455231542,.5534500598661963,1.8229024856964198,4.729196052361793,6.238813456717797,6.20849004428366,7.73507638526551,6.045668878064383,2.7028939117917985,.9712158132442434,1.0136265943423242,.5656805291176122,.738568750213913,.3530286630433096,.9016225107473317,4.168641786356775,6.898232192320517,10.876912545613852,12.399668228121792,9.043673062339757,4.130012266887828,2.994179855180108,1.5378881373621442,.8593056742923465,1.0537791859871783,.34902210594781624,1.6470643050638136,5.888262859837332,8.892246903652444,11.24162004648111,11.95404255177258,9.298238136157313,5.580595048915945,3.3818470528886917,1.5160745665390192,.9921996064590437,1.0565837325621266,.06666325301809489,.6559423313779597,6.164417495166218,7.288994056802342,13.031898519551502,14.099792045561331,11.197504812210619,5.795975119417619,4.473279627288071,1.6110251968279679,1.3022431865449475,.9889812696482144,.29495975736093244,.9112935302305128,5.888772233308783,10.909687685119666,13.149555266561514,13.802325328642144,10.597741105345143,6.172823669144439,2.819827647320168,1.6238444690230653,1.1379861050762108,.9269703742474535,.301949237419942,1.4145256252851295,6.354166295225364,10.355087328905656,11.850416990318648,13.738712898608256,11.046471350119514,5.987262297749857,4.413579537512084,2.085355511252095,1.4436095073283162,1.0738979385455474,.5261509813957055,2.223968040362469,6.952651236636742,10.2311174825061,12.139230388509224,13.541859482320408,10.365385693080022,3.293801835323388,3.3655056528104024,1.9117238509620347,1.1423521972687098,1.1601140222590363,.841948219408677,1.104148784582395,7.532539785878859,9.200420509604282,12.07393580063895,13.203801316423608,9.774876275434085,5.5193417521934105,2.6662723550229006,1.458041667115726,.8731057326456833,1.0451134977279641,.6547119385181658,2.1609672684788643,3.635854014147193,10.343668856994281,11.054291854056121,13.6573305566035,10.802927610954505,4.871440358009638,3.621200311819826,2.082608251026181,1.109213179470856,.99738695556563,.31790753418917395,.5411774598466902,5.231622520117601,11.210110309745104,11.781451805138753,13.490472625464013,10.957401637260514,5.811432694531606,3.7979443484312023,1.5445250037499552,1.0177869844657128,1.0791432141519566,.07229819214460002,.6752074568903427,6.272769320894797,7.297000204738723,13.048255538510961,14.116590529843473,11.236125241991633,5.801135603875041,3.820834418809789,1.776654000949538,1.070313289688684,1.263717959253185,1.1315346342313608,2.8999828105087437,6.7079217058952105,10.501946694934654,11.895400705809628,13.22831010788239,10.232708422752845,4.6976489176190315,3.758729833089509,1.5333257613435527,.9081219492637589,1.1230643835932397,.631072800298891,1.6206041516086622,3.978796619824185,9.073858002459747,12.44389720711363,14.0787953132389,9.794168663643745,5.828509944142415,2.455228435425314,1.3028391782586477,1.0205116009733854,1.1948070219475024,.8723972696470157,1.4043344098052215,7.354820749079178,10.128368127943759,11.745541452461705,13.079666265611477,9.702729234504393,4.319270556948986,3.75516069260497,1.8245298426475904,1.1789672834334761,.908190125009291,.6693357515125956,1.3272930372135858,6.338186847095784,10.213531054174604,11.142538997153295,13.455563691781485,10.659213179556414,5.0593589162523935,3.7373216072520243,2.025047673076761,1.1271819146670534,.8919301623404002,.5441373034994121,1.4558086269738537,6.1134973942618664,8.950815410112105,11.922258667365323,13.178985251261388,10.050719075460677,4.651426506684548,3.2288465949798133,1.696802377661339,.9943026611606458,1.019197667599106,.8300242682206062,2.5943341474425656,4.678814809783299,8.189295514127327,9.502556058352265,11.790703780065845,8.827395357073078,4.898293429612691,2.9759458268580525,1.6533067642539545,.9621728952387768,.9977704201220908,.7462352326404806,2.2685670687618607,3.87137205686814,6.783999507066966,8.016043478514124,9.90457169224739,6.9861688554929895,3.7933075715446645,2.018259181764753,1.775148481841159,.9141618229851741,.6551567658592491,.08514759188134866,.7069020780103183,5.96744629556656,9.372466093922062,11.078805600726321,13.554856696694841,10.738291081245105,6.180413360677343,2.5847012602417285,1.444568161522437,1.2035436489392997,1.165942485708236,1.1419251364355583,2.2868186112345033,7.287521356905889,9.331009802534776,10.08720472985721,12.863628380282266,10.072131067264596,5.093945200717502,2.278573500511453,1.3507592651614009,.9978462908360316,1.000700795614324,.517969746411979,.6229408006890917,3.918985124009786,12.452110334565662,12.007293477072983,14.485675223206632,11.700298779572782,4.478532266634918,2.5678371772248205,1.9211464782436218,1.1341295833960525,.9882805874445435,.2178425981996439,.4285774187458989,3.552572075827776,10.815744302430245,12.243471324856555,14.462440690369462,12.426149700616929,6.495283015466909,2.005631442672489,1.8674583835266545,1.373647223997093,1.0189356446012257,.5270052404210112,1.6907094766598625,5.757071826995554,11.572976804771658,12.018477756104868,12.781018621248109,10.421162264715306,5.3950551100517234,2.327047664585482,1.370659668779027,1.020853742745616,1.0209306739288158,.5450002096276324,.6355518436513058,3.9543406874795752,12.53194266817323,12.08641643569174,14.592213251083441,11.783156200200866,4.504550506740348,2.5487547276556737,1.4103804087641894,1.0353480369884374,.8478348717133635,.07683970044513812,.357357705788772,3.6547747419634073,11.341226345406884,12.983479724709548,14.133570186602707,11.40573529641675,5.6312104724504115,4.4285416958246175,1.7450890955861091,1.293813626052012,1.0597156788043944,.7903093850206889,.7328915704720859,4.074761242305927,10.251007023430784,12.052343907444083,13.746649056380603,10.51114050899675,5.78812342936517,2.2479342152356967,1.7037274969313303,1.2136758502085414,1.322446766303995,1.0324965858497706,1.8782956553122516,3.617088283810757,7.594080398063118,11.526697463848455,13.565966425121523,10.575115539572845,5.655031129742786,3.4700744389787426,1.9176684891764937,1.1315316372631659,1.157871107953773,.8082678057095934,1.1485896227200552,7.610459961959178,9.183322197018317,11.865355106251043,13.079042834649686,9.66129079349953,5.4435935583982875,3.416168861438789,1.7820974925666622,1.3493273184237669,.9588622534577338,.6459110757212667,2.054262006654878,5.853082801546405,7.710509189120306,8.23745287080182,10.885000633768449,8.36673258400449,4.044129276573079,2.392500934974792,1.0090680201133064,.7021351835009101,.4768739783234108,.3629007439954715,.4409196299228196,5.697999912637496,9.192339351508785,11.450820957723662,14.23545937801102,11.896050335796138,6.739191566540048,3.8777557380580245,1.8417648213149616,1.1612893749163482,1.2086546019924322,.5823011243900894,2.3055513887406542,5.913244018919202,7.848841949232183,11.10663862400663,12.423964515698824,9.87407407317433,5.102091806828164,3.5072993263657675,1.6782935742026177,1.0196798237335702,.688055088690433,.11801151514017755,.502792478845689,3.3659765290765504,11.999847648404693,13.121389089187861,14.715988213314194,11.743200233109588,5.197608932686449,4.074215181720167,1.7159815575786281,1.2321229195739352,1.1213428388114823,.8256069291044191,1.7489124470779531,7.402793177538034,10.079524964888094,12.174837611506634,13.386788697898076,9.310095893720733,5.578764231209973,2.7201886647079343,1.4572574756959307,.8874224200868935,1.0469589379288466,.6842680467441932,2.1533793904272014,3.643495538933534,10.360091400049004,11.209385491847502,13.784246731332788,10.888103119000645,4.910810634124255,3.9483184535710625,1.4834878643187464,1.0291649893555441,.8066210994042506,.2701876050591951,.5235965141483364,4.738585557710147,9.747653097207943,12.381440828737762,13.656242306158191,10.424793007426628,5.7774383168569505,3.9301280113353556,1.4547646664418847,.9925659386784527,.878265598069452,.6834102977266129,1.1843011935495966,2.0865196769012675,11.67535123480601,11.45044558095811,15.391499354982423,12.684685888088584,6.723159081802815,4.223027681474103,1.7279861583423024,1.237723932596202,1.138928579347309,.8450480998229702,1.7295924554460251,7.344865047219761,9.985338150347106,11.95602558996822,13.23802875822939,9.217814716896688,5.519709515666142,3.876656963541386,1.5321062249919242,1.0970253675474677,1.2085072170128015,.8080354879781139,1.4117508033558994,6.638404155237603,9.424874094295221,10.229943295166423,11.845765189459224,9.12916100681449,3.0813046727941202,2.456006756639681,1.8252581852139578,1.3232338380097932,1.065858969556106,.658189007802709,2.039528364131901,5.541932000139726,5.670223692899616,9.114267245172595,10.216203515007225,7.714817177613206,4.151878425968633,3.156117679705006,1.6595760725218605,1.1469896656934555,1.1160281035726505,.6688430834388689,.5120330290800299,4.168098418660081,6.262859774499547,7.15194359057814,8.668915602331113,6.407449428063504,3.6465812709298717,2.571195472752869,1.5977277001675716,.9829923289375737,.8420065950434805,.4035547411429711,.7983086711819295,4.662830748119854,7.416681061981081,8.12167804497214,8.946581099802554,6.8709362349275125,3.797426354613895,1.296550802445755,.9751569563828083,.560818802014207,.6800827342511837,.3600039399589216,1.2008568408658258,4.4640813670084665,7.348781697459566,11.593556519358419,13.090561557288424,9.600276530297068,4.42388502747906,3.4982736567402624,1.5007970654879217,1.056461191580757,1.1201158507846871,.16114347609346322,1.1746486248382415,7.091526335387094,10.210630743987162,11.874535655144207,13.657973973387337,10.504193709859798,5.528915143460474,3.6831465203881515,1.4361980802274046,1.0282296947109881,1.1230289790793577,.7678173980125346,1.671958655191907,5.16460411448181,8.889674303832333,8.487137895288013,11.306648030269718,8.435537118606801,4.474572741859546,2.7968020617105234,1.2862487438367032,1.0002767515672633,.5105061892340943,.4108925730327056,.4373639121331088,5.693184763233955,9.158237437905747,11.407546212712834,14.150090197859479,11.823603273520854,6.716629439029189,4.422420084254611,2.0034180266819237,.9279348734327657,1.2720769218679555,.8693649204910725,1.0471632408985942,4.6884598998577385,9.234485734422043,11.053508369243865,12.479111635873409,9.797974570340026,5.279529507781989,3.1499363189408816,1.4170407364275697,.99619967687964,.8923085906430189,.5025140723429731,.7245518580668197,2.8897607388039477,11.038463731153337,13.585382704681304,14.28461620599204,11.520452666802196,6.1473814731053364,4.1886959852032435,2.0805781483613313,1.173829184690977,.9164960917100666,.6057255686733349,1.4963693889547536,6.146432934059893,9.025786860992865,11.895196572202607,13.292390847861029,10.180966720164582,4.699880795510238,2.336910728944405,1.4944214373332467,.9397986433995863,1.0293071988659142,.5056945982120258,1.5159214057022143,5.887743165749498,9.87099862417805,12.175573188843478,13.577291309261499,10.747117069119277,5.8194448427298795,2.8004852493297303,1.7236364135059004,1.4076531680726876,1.2050025309368841,1.1896684795926693,1.6989837339151834,4.542403358794235,9.941547204343136,10.255251812262841,11.78192789449206,9.841973560051425,5.36276139393475,3.332017723776323,1.6931906194500534,1.1093873451271807,1.1245302212747728,.4468332511681829,1.6119853189521973,6.5126805673807215,9.280738358904575,10.3057257010086,12.569534994226132,9.790814669454885,5.235218490329053,2.2740987264143024,1.4754877772638433,.9283060710367685,1.0147505576056197,.4975724969615726,1.542220540491247,5.926543502021519,9.927313909812025,12.227393891407173,13.653298130126236,10.801947965932445,5.847087748154014,3.906663398569324,1.4598598848372895,.9919051065976716,.8850227491128407,.6890472812342685,1.1887881197234198,2.0909208528482424,11.700214433101976,11.475299966140188,15.389847356570376,12.681405445292736,6.728663636018416,2.8371989859397155,1.3123564761413613,1.0349213630515621,1.2234192103030705,.9539648835154252,1.470465900704093,7.431459364736739,10.240241357629113,11.895088066130556,12.948024382080858,9.773398617849567,4.385096688019277,3.684922097723116,1.7971036211459523,1.0438436422169761,.760934882635034,.13832406457120583,.5196563309979719,3.4119452162997264,12.099688934648327,13.247805133201002,14.855825273697429,11.855057121737746,5.242105151258767,2.004544142429305,1.8875017022572769,1.372884946286338,1.0185560976941286,.5265597320709453,1.688700856100449,5.716376526202641,11.528899886508889,11.975291611707938,12.771310537986801,10.393527880592282,5.341429392644723,3.333562945602024,1.7172530728657358,1.1452009482635828,1.0174449975648403,.18507482203988002,.473462049081855,5.23071135727388,11.701417813750819,13.297087218815863,14.771821296328204,11.714012295250724,5.978636130946483,4.157651426274871,1.736296970287822,1.2881145632453728,1.0562950267150728,.7883593652212953,.7228038579328228,4.014435847232421,10.129342306785501,11.915686243627663,13.599186753933376,10.398744789892945,5.723113922611577,3.904398590518015,1.8577037755388268,1.3202700943277843,1.3228677673338598,.922299571557359,.5907449525080164,5.2729317346162885,7.88703188901407,8.93385616776769,10.781492549561133,8.03029177165255,4.788766172597123,3.1378529962123975,1.6490963837315955,1.0658311107229197,.775616042430706,.47796998436355503,1.2503635393071244,5.975931636633961,9.449892984590171,10.66906494237943,12.568016394329396,9.927571001024962,4.636974821736388,2.251078597113266,1.450389655322526,.9055764490947751,1.00304913393219,.4942761604770769,1.52616903662469,5.914943304473099,9.902311537750792,12.213891002315082,13.634207900350244,10.789395515791252,5.83284543168781,4.090932160917116,2.0978826786271214,1.0768169355074526,1.0707457486143455,.3157851791573488,1.4358578704542584,5.893683689064977,8.59868072805106,12.915314510719682,14.760240447258223,11.570833749171234,5.914253241858862,2.7197264373789163,1.573703513044318,.9512340332116612,.7961397148064109,.47217343335619677,2.0144364738958003,6.438146441627475,11.101838242492386,11.27396053239052,13.205849094445014,10.056471053826707,5.578141494999216,3.619576560377777,1.714799588949948,1.0542952722268046,1.2109211426183593,1.047380428683806,2.715522668934383,6.493153677743011,10.388416345534909,11.757702183994263,12.535017064486404,10.116836035974826,4.6528317953606555,2.942003613436707,1.6977598873778756,1.1780333118510566,1.081324287322111,.1957273574152593,1.155038556068774,5.775277094601552,10.162492156797756,11.565391499777771,14.146476697952966,11.355815289250693,5.899103671024196,2.7902821818934718,1.4797848077565783,.8959218540128856,1.0853203745303701,.7276753755788673,2.165225432279263,3.738257693402751,10.645415745462616,11.484754656431537,14.13346128649196,11.066028446961909,5.081138623365958,4.144978975183731,1.8949486044549337,1.3401803824058642,1.3610364803882933,.9715197973866744,.6133001003545089,5.546759976479182,8.22944133656228,9.301279248976785,11.373048473688476,8.48048765099932,5.047790151517755,2.9134683086923046,1.3187093610877614,.9432644449102735,.7863166196474822,.4141485692887896,.7141563825840505,2.795708074824312,11.101145278338077,13.67545780325925,14.366154864495662,11.595201456696179,6.193160862418182,3.7938264962810764,1.4618950541095885,.9124148394504623,1.130012369893577,.9309591589446962,1.842797504613037,7.170767394367854,9.41161381928355,11.78088769508118,13.137464312906646,10.019252320547142,5.694788969483684,3.0293739608964723,1.7405105991512888,1.2129781698487265,1.1412871870357841,.22458706537946688,1.1529903868792268,5.730423302210152,10.10842064116621,11.506162056345326,14.084235630655321,11.304682412190937,5.876880335644915,3.4773369549444473,2.0877132478129394,1.1113538577933462,.9992309470974552,.3200593539992885,.6064602001524305,5.312595923754136,11.491299607042373,12.112033114410535,14.363541379488012,11.379273916681315,5.980722798776093,3.557378363479213,1.7285829319643966,1.1543859030178254,1.0216126352965114,.1905392406745366,.4710397346399608,5.239253892108143,11.693335044440891,13.289895723485866,14.758661600736371,11.704291163494831,5.976208157596481,3.6837720254810193,1.732762703925899,1.302666806240721,1.2018298612811142,.6486910934883441,1.4599325048987453,6.0271821925698745,10.651889890344151,12.206223821305155,13.48792302932771,10.374213996418554,6.007665842699991,2.3909929569161954,1.9049170261420945,1.1314063952237003,.9980824436323321,.22176657073153666,.4192302978103635,3.53115986567009,10.747304240740897,12.164049942774538,14.380510389313645,12.31685652118872,6.4433048147850025,3.9596199317546925,1.7625043581292652,1.070944586153751,1.261033872702688,1.1335409792373414,2.8884619151412143,6.673852578810797,10.479128584711484,11.932586952791809,13.340026990127766,10.346456504162855,4.761350564273494,3.2626626523832605,1.6762831640373956,.9954743002066831,.9901168206942547,.8013638093423328,2.6482086182807762,4.800932794500343,8.362861388367705,9.804550323476239,12.171412098036098,9.102685380468085,5.052070646834918,2.7442563416659227,1.3630697727738537,1.1140128704192322,1.067130452399076,.3064071979409191,1.1777788522427657,5.409046582845978,10.256966205853686,11.998121716733804,14.299987068913513,10.681783883296712,5.395493282216314,3.370974359957404,1.2931249849695743,.9244350904353072,1.2477282832465297,.7900676310542623,1.6005776770758047,6.258108414853642,8.356387344547555,11.519314304983865,13.698381943465554,10.87317693301761,5.545762751093044,3.9992338980458966,1.2595541513149684,.9747908928193806,1.19468014817458,.6345035270271137,1.7378467998010314,6.781367823539758,10.633860570405808,11.680719732658353,12.692201516063944,10.677837841680217,5.433892249484014,3.3063600373051707,1.327995435252243,.8654870021351627,1.4224381941358513,.8044121393419696,1.9587333646566418,6.6233220756716396,11.322162137399282,11.96643065888073,13.918199822071896,10.609035733324323,5.811403423709445,2.598403892441572,1.5763288062328713,.9519184335270121,.8001091033783111,.47044190937023495,2.0370423525882178,6.552521152840278,11.274498477233875,11.465757149163856,13.431359816066127,10.213802999262622,5.674264458316327],One=[2316.4171318266162,2318.009498023818,2321.5521340895366,2324.455592625524,2330.6750604897275,2334.6043109976736,2335.0808931489732,2333.738797736042,2330.1361386831827,2323.6982850054396,2318.593328498391,2315.648741700417,2315.955662605221,2318.1418349585265,2322.667760214156,2326.1406597027008,2328.1425250982606,2329.3992999722786,2330.6412124965955,2326.414740205457,2321.869979383406,2316.9658804908167,2312.36853639339,2309.754581233384,2309.2943083266473,2310.2761026046896,2311.518735189296,2313.199076232673,2314.8413089585274,2314.1920428246954,2308.9280732912766,2299.71688954387,2291.1875987876315,2281.7894986200954,2273.1847684548293,2268.336455915246,2267.896866510422,2268.981771333757,2270.9496394672965,2272.587953079286,2278.164683223944,2280.290512068292,2281.510826490475,2278.327589961756,2273.302049177256,2268.03740052511,2263.7803256733955,2261.6349234539093,2261.482575990463,2262.9849648993218,2264.6764364995897,2267.5393755126306,2271.435694274442,2271.673553306406,2271.593407867882,2265.928496456841,2259.5799487836725,2253.333789242495,2246.8325425746243,2243.092130050325,2242.2663848243515,2245.421856693175,2247.1027147025907,2250.0510340235846,2257.729517430711,2259.6510662203314,2260.283529540906,2254.997188230456,2250.3947081296483,2244.943848442199,2239.7432050986777,2236.6248587228947,2236.906920866225,2239.5308266634233,2241.3275667593384,2243.4452386383855,2245.7290117436205,2250.5579896090208,2246.467287854573,2239.4356596683333,2233.339259763878,2226.8901625961175,2220.2977092211436,2215.62140043625,2214.8825970905423,2216.151184875983,2217.618049154168,2219.0572688999387,2220.550213699205,2220.7364403954157,2217.22928885815,2210.121153553663,2204.4946732826547,2196.801309833464,2189.532475837629,2185.2738591270336,2183.9667834848956,2184.5298575455245,2187.3232565906237,2189.4152879540507,2191.3836882644837,2192.9660038510888,2189.5382834856705,2184.0591626698647,2178.0194874440076,2171.4175321841158,2164.350260337946,2161.0400474780927,2160.469351245215,2161.5551661635795,2162.4392166514936,2164.596283812711,2165.2852511127962,2165.039130093913,2160.600331399581,2152.26078845982,2144.5760503400015,2134.6490082431824,2125.492098999953,2120.2448344907025,2118.696030049703,2119.465003495872,2123.3302918358336,2125.1342768522027,2127.433522967249,2129.342334654581,2129.0545907873834,2124.2832647473674,2118.519828265259,2111.481710861053,2105.904263586782,2102.4811848758727,2101.750836496595,2103.0159025506337,2104.794649744925,2107.303447752114,2108.635464138191,2109.827141663062,2106.2942314591787,2100.757503040687,2094.7894583247166,2086.547149758319,2079.178616406484,2075.1102657403476,2073.8850123098046,2074.894580395498,2077.9469260996843,2080.2101262188935,2082.069665924425,2081.7410691967284,2077.2196067966515,2069.9567279326566,2062.8256845909523,2053.473096982098,2044.9299173579523,2040.1682288784082,2040.11869085974,2041.6649226838142,2043.240734960188,2047.4046923989233,2049.5392724141793,2053.364438299078,2057.169581709553,2053.9679663031366,2049.1400091937453,2044.2445433489372,2040.0621805435983,2037.907324893258,2038.821470536849,2040.5195930829855,2042.6634813926087,2047.6665502250416,2055.0758673380933,2057.3543330753273,2057.8480917442935,2054.0306844969177,2049.639411327292,2044.2360816114724,2039.7139089859832,2037.6110832399902,2037.9449623188527,2039.8110319632744,2041.8005290968556,2044.5269112229062,2050.831380802096,2057.1383881351985,2059.0305647629416,2056.270956036189,2052.7118577699107,2047.6175622153694,2043.301210455805,2041.1655268461448,2042.8451499998769,2046.395832212793,2052.381593953044,2054.8956107515664,2065.724754166437,2075.2697776656305,2076.144794623585,2075.7794455526337,2071.863767297262,2066.0647628334523,2061.944678440559,2061.095705092952,2062.6764210033566,2064.249412915934,2065.9686306468598,2068.309454268907,2070.570844796199,2071.8432493207333,2069.112606505734,2063.6160166013765,2058.1070496450457,2052.0671176067617,2045.2304798950113,2041.7479432259406,2041.5012736965825,2042.4619762103182,2043.9919544894396,2049.1714255631828,2056.036791965638,2062.0720804764874,2061.6454237223015,2056.5012487666772,2051.124079928519,2046.0606366297575,2041.469814103333,2039.2259269425529,2039.6816967845755,2041.5651371966565,2048.2936568762634,2055.557567921789,2065.6315796199738,2072.2608876818254,2076.2452904664237,2074.912389645167,2072.2995767281427,2068.011725221896,2064.9543816940545,2064.206024642581,2065.3134942963325,2067.2950278650433,2074.1925606759505,2080.3959814475165,2087.5282608951165,2088.5283266538786,2092.0437669141365,2089.413769443122,2085.7644049526903,2080.6855840404637,2076.307289248364,2074.570300354687,2074.330048792738,2076.3523644381557,2079.083804205541,2086.4547372664388,2088.968298968174,2095.093778450102,2093.541700525283,2088.660123604609,2084.131264113819,2079.4996575633136,2074.936933848867,2071.9954404910827,2072.8443216795727,2073.7786945795992,2075.495602150065,2077.603343652741,2081.4965442542116,2083.2037552529314,2080.9805371746847,2075.336567614882,2070.510275887143,2064.14019429905,2057.67481622889,2053.87708561273,2053.2789648384296,2055.1537799327375,2057.5042586730774,2059.45663573416,2065.12720239686,2067.4878017286233,2066.01826551097,2062.060217091506,2058.1258602975727,2053.1073823247184,2048.176111488972,2044.999572214996,2045.8261922806291,2048.378774626408,2054.6637714536546,2057.1980563112047,2057.998052635928,2058.8397949431323,2056.584787651486,2051.4314837874076,2045.9353172343228,2040.5688923056791,2034.9991712252008,2031.509119648629,2030.986908266049,2032.6617917276092,2034.7945774056593,2036.1321982015318,2037.7883522442576,2038.6459823671664,2035.272573079334,2028.8369722828584,2023.5690719478712,2016.9610714086593,2009.8587660310072,2005.4539721803699,2005.5736713009385,2006.380463288754,2007.4110513387377,2009.3900520639959,2010.5377210088802,2011.461183804346,2011.8655761931457,2007.3837067251816,2001.8110356691225,1995.2685236854402,1988.656934592161,1984.747226609709,1983.7606568257095,1984.4759124051084,1986.030669652609,1987.2964479042719,1988.4649166947454,1991.0095921340778,1986.8537772524332,1981.2720178805428,1974.3467206705272,1966.9578347994307,1960.422511102787,1956.632219256977,1955.815070883519,1956.5526300350386,1957.6304643300214,1960.2334978746276,1962.955772390146,1963.6620861829085,1961.1677494021849,1955.090887951692,1949.572291360741,1943.2915655934926,1937.2362517773006,1934.209325761057,1934.892906410475,1938.284896313143,1946.2764962048288,1948.5843454404035,1951.3854856689245,1951.6058606288266,1948.6588271034113,1943.0425014766302,1937.8098482051103,1932.4101692805991,1926.5066648176964,1923.0756963771198,1923.3868907062676,1925.0277905502444,1929.7520168674766,1936.6393386226575,1941.9112437048066,1947.7657672624935,1951.1596148402332,1949.8524401875643,1946.6224699030392,1940.3483836737785,1936.2141663700647,1934.5502945473954,1934.6121776451373,1936.0205182744767,1941.3176918279376,1948.8688406329422,1948.6260474917735,1949.8231383961624,1949.6526984680365,1945.8858208169802,1942.200395047933,1937.0311394248952,1932.6783791403855,1930.3242269131836,1930.3752164531465,1932.5139728887389,1934.0356888776657,1937.7007960673222,1940.7835551973408,1943.3279662249215,1941.7733946978478,1934.9786527826222,1929.4359109579902,1923.1481154565336,1917.3484511854197,1913.2970785933187,1912.4359104233502,1914.0931227743872,1916.563880374182,1918.8660575430295,1920.5119385968615,1920.668542101414,1920.134310925437,1915.6069388584813,1911.1890711921394,1905.5894039646623,1899.8710993595428,1896.8963058486993,1896.7969958456056,1898.1299321588308,1907.6480532786334,1918.3496407605194,1921.806377396678,1922.6147669028014,1922.25317869392,1920.4434852478087,1916.1169974610007,1910.44681051926,1905.9226900542087,1904.5813658595494,1906.0210074063004,1907.476772108526,1908.9056480859335,1911.3182544622532,1914.4564809555475,1917.1862074667479,1913.8142046581693,1910.3343565936464,1904.7645636853522,1899.397139592516,1894.113942159216,1891.7606795295635,1893.1499499125523,1894.6379573534123,1897.3697682537465,1901.6395190765422,1912.9482585183612,1919.9472706309082,1924.6510533716732,1922.993802383671,1921.0327784005867,1915.9760373879085,1912.887650358423,1911.9867158345303,1912.5460887773193,1913.7761790861905,1915.551263996908,1919.8069005125997,1923.8136884107573,1922.7454398120183,1919.2874505360335,1913.6594109749724,1908.351923281584,1901.8495580341087,1896.2492208298218,1893.8093109843687,1893.052795491319,1893.938378196158,1895.0001715835315,1896.929375262939,1899.9685083304767,1900.5274430764205,1897.3878314133997,1891.21165754705,1884.9613778382995,1877.89996441183,1871.4129556868036,1867.6898190913953,1866.7896605337826,1868.2532559921779,1870.687109558152,1872.389534071721,1874.8607113729795,1874.7231604517276,1871.072472094934,1865.759177792948,1859.3894577019537,1852.22548884815,1845.7335366064,1842.2392467238683,1840.8230827719722,1841.808660139964,1843.9497222404052,1845.1619348066904,1851.0697711652715,1852.7811858873768,1851.0973860281915,1846.4512718050955,1841.50010512529,1836.2292264094224,1831.5994996162146,1828.5762450101022,1832.1443076704486,1832.789918209595,1835.795447971118,1838.0734101534183,1843.4685241156478,1845.1612764367433,1850.5365653249362,1845.5017684020484,1840.4194589773138,1836.5436185661895,1832.5935819862552,1830.2946204608918,1831.2089193571808,1834.2644288513136,1835.5993999515108,1838.2446945511913,1839.157788668296,1838.5456619518527,1835.684869634944,1830.2847986872562,1824.3707704629107,1818.2815526080442,1812.2175264995376,1809.193500733119,1808.7453294164318,1810.7455042791355,1817.6315578516912,1823.765738786594,1823.779234197836,1824.9493796759466,1827.7394412871524,1822.5124491705876,1818.1634757756167,1813.9359432415256,1809.9280176347393,1807.4853420669556,1807.6332928731804,1811.0705183799857,1812.9109379091583,1816.1625543507262,1818.1453646117263,1818.8408844351977,1816.42371544606,1810.6606227633706,1804.4927683670849,1798.798873940649,1793.1489586429834,1789.8725985498727,1789.4776735118262,1791.897691264649,1795.9871681409677,1800.9989044626175,1803.6543006048505,1809.35752054119,1813.7294994121605,1812.0659461860325,1811.0027794586986,1805.1023176774108,1800.3160550796215,1798.7552015304375,1798.8295995982755,1800.0737975793177,1802.1237191717007,1805.9795453006186,1810.198940082953,1809.861480547696,1805.577425364248,1800.1321060319242,1794.4507086910999,1788.1807932353333,1782.7591306299644,1779.0801053839127,1778.8742645438474,1780.166125122053,1783.4253168398852,1794.2910787411433,1804.4903123486713,1808.6280510611798,1811.3665312633143,1811.187262406205,1808.2351064292177,1802.8713793236907,1799.0700195590828,1798.3255710773337,1799.1929211611068,1800.7842131005607,1806.914913015974,1819.1106564483707,1818.472793088395,1819.080149092613,1815.2652237942577,1809.4379033662772,1805.4504804597423,1800.29092925697,1795.2130122465962,1792.3757901681636,1792.9956622823602,1796.0453638913782,1800.7526263843208,1804.0377721906277,1804.454882081579,1807.706539919067,1806.1647708920389,1801.3339007419968,1795.5538306874748,1789.642765819033,1784.0533009931482,1781.2156825210482,1780.1586710400413,1780.9830320833885,1782.7321092184604,1784.3704477416318,1785.3756081866666,1785.9168744685235,1782.362362520743,1775.6820743241235,1769.752728479372,1762.7480841726376,1756.5396525752483,1752.9342140489312,1753.3078734181474,1755.7213047970652,1757.9555949052808,1764.397729759969,1771.581936675198,1776.7366792001394,1776.1813854398933,1773.267083116634,1769.589917236838,1765.7225933447792,1762.3769641235665,1760.6123413136293,1762.1627719336695,1768.0688157684228,1773.3156728832016,1781.192202149171,1781.4393750648221,1789.3371346547608,1789.0864884575553,1783.9027989035753,1780.0755015276402,1776.2539003521572,1772.400364425708,1770.6462621722685,1771.8521321398846,1773.1395174689533,1775.40186288865,1777.3897355449244,1782.8274974831274,1788.822946711719,1787.001296928756,1781.9149540914145,1777.1246729520678,1771.7691227155574,1766.946017114108,1764.463353433387,1766.061475533428,1766.788780731933,1767.5262733365334,1768.7822329191972,1770.5019996009175,1769.8981046457832,1766.9733406481357,1760.5053049665244,1755.4076297371691,1749.7050406541773,1744.7624369978157,1741.7115615673151,1740.4127789554,1741.4571463261536,1742.6977509958997,1743.9051877297304,1744.6941136075782,1743.125066968763,1737.732731660072,1731.0882155715735,1723.071899654401,1713.574709418186,1705.3555932554718,1700.8447296938448,1699.3957621850568,1700.1295991059649,1702.5794152340118,1709.519188240246,1715.6588623442865,1723.5445887535614,1726.9736112180328,1725.0809835339967,1722.5755173401126,1718.7530254839135,1716.0806886881928,1716.2206082212017,1716.9002688466285,1718.8688753693914,1721.05869209076,1725.4128026550234,1730.255073571874,1734.2841438566238,1734.216558492637,1731.254330192879,1727.0436571487523,1723.0169303061418,1719.9255522564988,1718.0137403750448,1719.71773446213,1721.9567278269485,1725.2780859703605,1733.643834898795,1743.019878256355,1744.163311070514,1742.418947243826,1739.0094179336616,1736.1325417491198,1731.3863653031924,1727.318519883214,1725.7788598411744,1726.911913676569,1728.4452893668104,1730.834097806603,1734.8318849795112,1736.8619963633441,1739.4116131578235,1736.7769557503138,1731.6298470019085,1727.2560094995665,1722.1476389792356,1717.2643411605377,1714.9554187495314,1716.2973849864593,1721.0267105390092,1727.0619385867788,1731.683935190095,1738.8610333282447,1745.3721432355978,1751.5583618577216,1747.0150068896705,1743.299972798389,1738.0887823315395,1734.5098283718614,1734.2537598627414,1736.8610821862944,1740.6723766118748,1746.985315828627,1754.2625238539092,1764.238222933345,1778.2272187429364,1778.9268543322728,1778.942964316913,1777.7767271160242,1773.9317191258015,1770.5073101042303,1769.773636507737,1770.8317061241366,1777.5081317803974,1787.3688282362086,1787.5123609575742,1788.514503363629,1789.3904385804576,1786.541252830932,1780.9578247588695,1775.641773736425,1770.648671958569,1765.8552822516508,1763.218157826347,1764.0546005928677,1767.4644596435137,1769.3048033246846,1770.3037383980918,1771.8769241706643,1773.3363504997762,1770.5015409884209,1764.9287402855318,1760.159646367427,1754.965571600551,1750.0416631173334,1747.984191344632,1747.960395613878,1749.9583633061513,1751.7488670045723,1754.703067242298,1768.8128030653525,1775.7413495425292,1772.294856389777,1768.5568367877415,1765.1576503101405,1760.0349358858093,1756.2762960067555,1755.4329561967556,1756.1378821333378,1757.4878138465403,1758.8838105333775,1761.1538347255319,1763.8572553250237,1766.826920412091,1762.9231621134693,1757.242937275704,1752.5785235301312,1747.597038347138,1742.378246117144,1739.3838970243635,1739.7263355267678,1740.889310260017,1743.6463561815515,1747.07804020502,1747.8067214961604,1747.9902373515,1746.2227271632732,1740.2597668689878,1734.780142250752,1727.6461447253796,1721.3566899254226,1717.7903155234292,1716.9618833051836,1718.4490853081845,1719.928613983312,1721.3906490773943,1722.432103126563,1726.7336274499437,1722.9588064016857,1717.5577791575136,1712.2403016467242,1706.56880618921,1701.2391172546302,1699.5151973270908,1699.5703176490902,1700.2999668226546,1700.6797901025448,1703.0286700640595,1704.1174126295964,1703.8027025586614,1700.0629490674078,1694.5444379872683,1687.8633684460408,1679.9898267048457,1673.3154195948136,1669.3588257646602,1668.0672388761006,1668.629258395962,1669.1792964124709,1669.8855550322955,1670.3149861882005,1674.9794666333441,1670.9754086795551,1663.9687828336728,1657.568555490006,1649.8929777847018,1643.148873907743,1638.718878577324,1637.9978785553112,1638.408450546116,1639.6217290772468,1641.118222903664,1645.3538099718178,1646.906264664126,1643.064700673596,1636.0698078609323,1630.1651114119743,1622.7878973356958,1616.090078201973,1612.042709716764,1612.0376485022082,1612.7256003628368,1615.1001762916087,1622.4177867861215,1628.9468749166228,1635.1865662917435,1636.1046540177394,1634.7720430247598,1632.9262258160925,1628.3357766913887,1625.034955342109,1623.5529564710569,1624.5438375222911,1626.2948948328155,1628.5493496951187,1630.7616950403221,1633.849361668641,1634.3376389804987,1632.4566162609174,1628.0399677570613,1622.934569610706,1616.763970808461,1611.3712412918605,1608.5214414141717,1608.3391557212842,1609.9557024155513,1612.238409147122,1623.9962712712052,1626.927221382448,1642.141454859443,1643.7632099679074,1644.8227498690535,1642.9491981826093,1639.4183523430095,1635.831967602987,1635.3986019303295,1635.9291919441234,1637.5302187812717,1641.8735810154208,1647.021761990872,1657.1174793007153,1660.2868609060697,1660.4648919406557,1659.7459945445278,1655.2710381552106,1651.520748709952,1648.2073708549478,1646.9898413222832,1649.1727881210677,1652.2473384449283,1662.1676530329153,1676.3170578062557,1675.152096298653,1675.087821126113,1673.3679827116148,1670.1773986415683,1667.2378888897476,1663.4044609385244,1659.9676702146062,1658.0363419250848,1659.2903818257464,1662.0890338510349,1665.0383244012517,1674.3736206824474,1691.0201032819289,1696.9224332184874,1699.3704924158758,1702.608724332291,1702.9339896618192,1698.922560928353,1694.8209541666947,1694.280024783221,1695.450118184269,1698.6659552057743,1701.144211630556,1704.9466717823868,1712.0439036141847,1713.768227860333,1712.192243556893,1707.717432624231,1703.5224258136666,1699.71616282146,1696.0683610593865,1694.3412593252913,1694.4364363797904,1695.984922630111,1697.1950430301215,1701.2976549118403,1710.847726425438,1714.1845676077237,1712.4549512462359,1708.7204047304629,1704.6983648029911,1700.9845156163906,1697.2125732429952,1695.1863282014747,1697.0031918566422,1698.1120139894294,1699.2942046395333,1701.6942193462694,1704.689617922092,1706.6042760906973,1704.304599290837,1698.9257238526097,1694.4003959707995,1689.1859815565917,1683.9950653518697,1681.319709724575,1681.1999782016787,1683.0114585041101,1687.2800189341017,1690.9651666379877,1691.5424386810946,1692.3542235765665,1689.7345838969713,1684.9180540881919,1680.5824753824538,1675.3977117474014,1670.1664409301566,1667.2139166717375,1666.5911243920923,1668.136476748627,1673.5474996988437,1676.8980337695446,1677.6183983638105,1678.3943657614566,1679.819934576782,1676.5571892636833,1670.7899460817193,1666.0273778321807,1661.616469639738,1659.1353979369146,1658.756454068095,1659.9018431921395,1663.6318195222857,1666.4835603952038,1673.0086225557911,1674.282911855641,1670.9940385943721,1665.5268781701775,1661.6714623457788,1656.9604409536687,1651.7699594033581,1648.5821961563138,1650.0470899870586,1651.312699460151,1654.737355213758,1659.089447532708,1662.9182225824468,1668.5505828351588,1669.2668589008765,1671.233780625373,1668.6171098924624,1662.881341425028,1659.0179747735367,1657.9866299908692,1659.237515920033,1660.8559753267575,1668.3569101022274,1674.7891238289076,1677.5337844596636,1685.494261536112,1692.978553613594,1690.539873991521,1685.9859226532758,1680.074175517047,1676.5183930556568,1675.513645684069,1675.7678516492276,1677.474607780778,1680.322073768726,1681.9840754955915,1685.491288886284,1685.1313972604605,1682.437753012911,1676.9622874206595,1672.5425392692946,1667.213562922296,1662.026836452709,1659.2836845561362,1659.2343234752002,1660.2754187895412,1661.6619378813946,1665.8886485856412,1668.5946737083232,1668.9710286528837,1666.0899061535233,1660.6163490723927,1655.581744705025,1649.4137327447768,1643.9543817792826,1640.7549830160856,1640.241012458013,1641.4317269642092,1642.667455573764,1644.1115153259632,1647.1791022662858,1647.7979107654141,1644.969410422472,1639.4025176172188,1634.5584435164028,1627.7969033991733,1621.6976296733842,1618.5664814403817,1619.1432943368675,1620.0944889440937,1621.463485551149,1625.9492308501267,1629.2321631289014,1630.404832736862,1632.7642912736205,1629.3408870978087,1625.3520221704803,1620.682099319743,1616.7864122348776,1615.0747886091258,1617.0708756150798,1618.8284312270891,1625.9391511516137,1628.601238537515,1632.341508710144,1643.9290026876656,1643.925508155611,1643.9098723086763,1644.4672484862615,1639.4068441347158,1635.531933142967,1634.5624187667288,1636.3548555162097,1637.8534972823327,1639.2676417216892,1642.1228175859774,1643.3406441588959,1646.3479169661325,1645.432633229419,1639.6801808302332,1634.7048846696407,1629.8864686468132,1625.091252155241,1622.0393694831464,1622.1287094988716,1623.8441126069706,1629.6731525844878,1630.6195337182353,1631.505746025658,1631.1250956861852,1627.3925302259086,1622.2259210609411,1616.8650199767696,1610.6891849356848,1604.9545539118944,1602.04356383992,1600.8170745621187,1601.768672430027,1602.3345116589094,1603.498306791038,1604.4738507911957,1604.629710574504,1599.9348397853053,1592.4549752292864,1584.6224382618555,1575.9017042424127,1568.7931266258581,1564.7118887451213,1563.37276592009,1564.2620469088406,1568.964291745607,1569.2413945639867,1570.7926900535654,1569.563515847017,1565.2769592310874,1558.501672164433,1550.4090793011483,1541.8905237797724,1534.6431168090637,1530.2375143929817,1528.8841926367427,1529.5032677601982,1531.3525513521176,1536.295711835888,1537.7033868460935,1544.2034708075719,1543.2306896461316,1539.2046093980612,1535.1964044912388,1529.8034032678318,1524.6833444382883,1521.7401470276307,1523.4600987821982,1525.2487011989283,1529.7881905803547,1542.104534221988,1559.3561826725927,1564.7067723858222,1568.4815698724487,1566.570242059246,1565.0040455372773,1559.7292797191815,1556.7029089821788,1555.932594378392,1556.3869007668209,1559.196626195257,1560.4959027910304,1563.3410812972868,1564.7372004149295,1570.1516751559823,1571.3248909657352,1566.6504972941736,1562.7982655143724,1558.7764053269593,1554.5968291818258,1552.0509274554242,1552.325258595194,1554.196271060286,1556.5001803451842,1562.0614804443644,1574.039167626275,1586.2020696350894,1589.0279835493916,1589.3474964932334,1588.2268736689427,1583.9518819163404,1581.7849455170413,1581.5607277096824,1582.2325794334306,1583.728224018957,1586.9714797084484,1589.0609080450809,1590.1872331390014,1592.4662985168613,1590.9738655910094,1586.3059604234024,1581.922139733569,1576.9683475792312,1572.1111214195387,1568.9707926011874,1568.4162763544564,1569.642121101962,1570.4373362820058,1572.5377786311349,1574.0387462805013,1574.3777061826422,1570.9502894045258,1563.182839874891,1556.059858083435,1548.5091097187985,1542.0067747594708,1538.2087831826072],$4={averageUnmetDemandBaseline:Ine,averageUnmetDemand:kne,averageDifference:Lne,averageDemandBaseline:Dne,averageDemandDifference:Rne,averageSupplyBaseline:zne,averageSupply:Bne,averageGroundwater:One};function Fne({counter:t,displayMonth:e,dataset:n}){const i=(t+9)%12+1,r=ga().domain([0,xI($4[n],y=>y)]).range([40,90]),s=ga().domain([1,12]).range([0,2*Math.PI]),u=K9().radius(y=>r(y)).curve(e_).angle((y,w)=>s((w+9)%12+1)),a=K9().radius(y=>r(y)).curve(e_).angle((y,w)=>s(w%12+1));yt.useEffect(()=>(ko("#clockContainer").style("visibility","visible"),ko("#pieOutline path").attr("d",Y9().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",n=="averageGroundwater"?"rgb(200, 200, 200)":"rgba(255, 205, 178, 1)"),ko("#demandLine path").data([$4[n]]).join("path").attr("d",y=>u(y)).attr("stroke",n=="averageGroundwater"?"rgba(150, 150, 150, 0.3)":"rgba(178, 108, 71, 0.3)").attr("stroke-width","0.2").attr("fill","none"),function(){ko("#clockContainer").style("visibility","hidden"),ko("#pie path").attr("d",""),ko("#pieOutline path").attr("d",""),ko("#demandLine path").attr("d",""),ko("#demandLineCur path").attr("d",""),ko("#date").text("")}),[n]),yt.useEffect(()=>{ko("#pie path").attr("d",Y9().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*i/12*2)).attr("fill",n=="averageGroundwater"?"rgb(200, 200, 200)":"rgba(255, 205, 178, 1)");let y=qa(t);e?ko("#date").html("<b>"+y.toLocaleString("default",{year:"numeric"})+"</b><br/>"+y.toLocaleString("default",{month:"long"})):ko("#date").html("<b>"+y.toLocaleString("default",{year:"numeric"})+"</b>"),nL("#demandLineCur path").data([$4[n].filter((w,I)=>qa(I).toLocaleString("default",{year:"numeric"})==y.toLocaleString("default",{year:"numeric"}))]).join("path").attr("d",w=>a(w)).attr("stroke",n=="averageGroundwater"?"rgba(150, 150, 150, 1)":"rgba(178, 108, 71, 1)").attr("stroke-width","2").attr("fill","none")})}let Nne=await(await fetch("./src/assets/combine_hex_5_6_100.json")).json(),pi=Fl(Nne,t=>t.DemandBaseline);const Une=ga().domain(F6(Object.values(Object.values(pi).slice(-1)[0]).map(t=>t.UnmetDemandBaselineAverage))).range([1,0]),Vne=ga().domain(F6(Object.values(Object.values(pi).slice(-1)[0]).map(t=>t.DemandBaselineAverage))).range([0,1]),Gne=ga().domain(F6(Object.values(Object.values(pi).slice(-1)[0]).map(t=>t.DemandBaselineAverage+t.UnmetDemandBaselineAverage))).range([0,1]),jne=t=>O3(Uz(Une(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e))),Hne=t=>i3(Gz(Vne(t)),"white")(.5).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),Wne=t=>O3(Bz(Gne(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)));function $ne(){const[t,e]=yt.useState(0),[n]=yt.useState(()=>[new Mg({ambientLight:Sne,dirLight:Cne})]),[i,r]=yt.useState(1026),[s,u]=yt.useState(0),[a,y]=yt.useState(1),[w,I]=yt.useState(0),[R,D]=yt.useState(!1),[U,q]=yt.useState(!1),[ne,pe]=yt.useState(vne),[J,ie]=yt.useState(1026),[re,ge]=yt.useState(!1),[be,De]=yt.useState(!0),[qe,et]=yt.useState(!0),[ht,ot]=yt.useState(!0),[at,Mt]=yt.useState(!1),[ut,St]=yt.useState(!1);yt.useEffect(()=>{if(re){let Ue=setTimeout(()=>ie(An=>(An+1)%1200),250);return function(){clearTimeout(Ue)}}},[J,re]);const Pn=yt.useCallback(({object:Ue})=>{if(U||ln(t,1,6)||t==14){let An=t==14?qa(1026):ln(t,1,2)?qa(i):ln(t,3,4)?qa(1026):qa(1197),Un=t==14?1026:ln(t,1,2)?i:ln(t,3,4)?1026:1197;return Ue&&{html:`        <div><i>${An.toLocaleString("default",{month:"long"})} ${An.toLocaleString("default",{year:"numeric"})}</i></div>
        <div><b>Demand</b></div>
        <div>${Ue.properties.DemandBaseline[Un]}</div>
        <div><b>Supply</b></div>
        <div>${Ue.properties.DemandBaseline[Un]+Ue.properties.UnmetDemandBaseline[Un]}</div>
        <div><b>Unmet Demand</b></div>
        <div>${-Ue.properties.UnmetDemandBaseline[Un]}</div>
        <div><b>Groundwater</b></div>
        <div>${Ue.properties.Groundwater[Un]}</div>
        <div><b>Land Holder</b></div>
        <div>${W4[Ue.properties.LandUse[0]]}</div>
    `}}if(ln(t,15,1e3)){let An=ln(t,14,19)?qa(1026):ln(t,20,20)?qa(1197):ln(t,21,21)?qa(Math.floor(s/3)*67%1200):qa(J),Un=ln(t,14,19)?1026:ln(t,20,20)?1197:ln(t,21,21)?Math.floor(s/3)*67%1200:J,At=t==20?s%3:w;return Ue&&{html:`        <div><i>${An.toLocaleString("default",{month:"long"})} ${An.toLocaleString("default",{year:"numeric"})}</i></div>
        <div><i>${_w[At]}</i></div>
        <div><b>Demand</b></div>
        <div>${Ue.properties.Demand[oo[At]][Un]}</div>
        <div><b>Supply</b></div>
        <div>${Ue.properties.Demand[oo[At]][Un]+Ue.properties.UnmetDemand[oo[At]][Un]}</div>
        <div><b>Unmet Demand</b></div>
        <div>${-Ue.properties.UnmetDemand[oo[At]][Un]}</div>
        <div><b>Groundwater</b></div>
        <div>${Ue.properties.Groundwater[Un]}</div>
        <div><b>Land Holder</b></div>
        <div>${W4[Ue.properties.LandUse[0]]}</div>
    `}}return Ue&&{html:`        <div><b>Demand (Averaged Over 100 Years)</b></div>
        <div>${Ue.properties.DemandBaselineAverage}</div>
        <div><b>Supply (Averaged)</b></div>
        <div>${Ue.properties.DemandBaselineAverage-Ue.properties.UnmetDemandBaselineAverage}</div>
        <div><b>Unmet (Averaged)</b></div>
        <div>${-Ue.properties.UnmetDemandBaselineAverage}</div>
        <div><b>Groundwater (Averaged)</b></div>
        <div>${Ue.properties.GroundwaterAverage}</div>
        <div><b>Land Holder</b></div>
        <div>${W4[Ue.properties.LandUse[0]]}</div>
    `}},[i,t,J,s,w]),Ot=yt.useCallback(()=>{pe({...xne,onTransitionEnd:()=>D(!1)})},[]),Gn=yt.useCallback(()=>{pe({...bne,onTransitionEnd:()=>D(!1)})},[]),vt=yt.useCallback(()=>{pe({...Ene,onTransitionEnd:()=>D(!1)})},[]),Bt=yt.useCallback(()=>{pe({...Tne,onTransitionEnd:()=>D(!1)})},[]),Qt=yt.useCallback(()=>{pe({...gw,onTransitionEnd:()=>D(!1)})},[]),Mn=yt.useCallback(()=>{D(!0),pe({...wne,onTransitionEnd:Gn})},[]),bn=yt.useCallback(()=>{D(!0),pe({...gw,onTransitionEnd:vt})},[]);yt.useEffect(()=>{if(ln(t,1,2)){q(!0);let Ue=setTimeout(()=>r(An=>(An+1)%1200),250);return function(){clearTimeout(Ue),q(!1)}}},[i,t]),yt.useEffect(()=>{if(ln(t,20,21)){let Ue=setTimeout(()=>u(An=>(An+1)%1e3),2e3);return function(){clearTimeout(Ue)}}},[s,t]),yt.useEffect(()=>{t==8?(D(!0),Ot()):t==10?bn():t==11?Mn():t==12?(D(!0),Qt()):t==17&&(D(!0),Bt()),ln(t,15,17)?I(0):t==18?I(1):t==19&&I(2)},[t]);const pn=yne(a),Nn=t>=22,ti=[new Xg({data:"https://services.arcgisonline.com/ArcGIS/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}.png",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:Ue=>{const{bbox:{west:An,south:Un,east:At,north:Xt}}=Ue.tile;return new zg(Ue,{data:null,image:Ue.data,bounds:[An,Un,At,Xt]})}}),new ao({id:"GroundwaterLayer",data:pi,thicknessRange:[.65,.8],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>pd(Ue.properties.Groundwater[t<=2?i:t<=4?1026:1197]),visible:ln(t,1,6),opacity:t>=2?.8:0,transitions:{opacity:250},pickable:!0}),new sa({id:"DemandIcons",data:pi,loaders:[es],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,resolution:pn,getColor:Ue=>[255,158,102],getValue:Ue=>gd(Ue.properties.DemandBaseline[i]),sizeScale:3e3,visible:t==1,opacity:1,pickable:!0}),new Ul({id:"UnmetDemandIcons1",data:pi,loaders:[es],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,resolution:pn,getColor:ln(t,2,3)?Ue=>[255,158,102]:Ue=>[174,0,255],getValue:t==2||t==5?Ue=>0:t==3?Ue=>gd(Ue.properties.DemandBaseline[1026]):Ue=>Hc(Ue.properties.UnmetDemandBaseline[1026]),sizeScale:3e3,visible:ln(t,2,5),opacity:1,pickable:!0}),new Ul({id:"UnmetDemandIcons2",data:pi,loaders:[es],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,resolution:pn,getColor:ln(t,4,5)?Ue=>[255,158,102]:Ue=>[174,0,255],getValue:t==4||t==7?Ue=>0:t==5?Ue=>gd(Ue.properties.DemandBaseline[1197]):Ue=>Hc(Ue.properties.UnmetDemandBaseline[1197]),sizeScale:3e3,visible:ln(t,4,7),opacity:1,pickable:!0}),new ao({id:"AverageDemand",data:pi,thicknessRange:[0,1],filled:!0,resolution:pn,extruded:!0,getElevation:Ue=>!R&&(ln(t,9,9)&&Ue.properties.LandUse[0]==1||ln(t,10,10)&&Ue.properties.LandUse[0]==2||ln(t,11,11)&&Ue.properties.LandUse[0]==0)?1e3:0,raised:!1,getFillColor:Ue=>Hne(Ue.properties.DemandBaselineAverage),visible:ln(t,6,11),opacity:t>=7?.8:0,transitions:{opacity:250},pickable:!0}),new ao({id:"AverageUnmetDemand",data:pi,thicknessRange:[.65,.8],filled:!0,resolution:pn,extruded:!0,getElevation:Ue=>!R&&(ln(t,9,9)&&Ue.properties.LandUse[0]==1||ln(t,10,10)&&Ue.properties.LandUse[0]==2||ln(t,11,11)&&Ue.properties.LandUse[0]==0)?1e3:0,raised:!1,getFillColor:Ue=>jne(Ue.properties.UnmetDemandBaselineAverage),visible:ln(t,6,11),opacity:t>=7?.8:0,transitions:{opacity:250},pickable:!0}),new sa({id:"SettlementIconsLayer",data:Fl(pi,Ue=>Ue.LandUse[0]==0),loaders:[es],mesh:"./src/assets/dam.obj",raised:!0,getElevation:Ue=>!R&&ln(t,11,11)?1e3:0,resolution:pn,getColor:Ue=>[200,200,200],sizeScale:.8*500,visible:ln(t,9,13),opacity:1,pickable:!0}),new sa({id:"ExhangeIconsLayer",data:Fl(pi,Ue=>Ue.LandUse[0]==1),loaders:[es],mesh:"./src/assets/cow.obj",raised:!0,getElevation:Ue=>!R&&ln(t,9,9)?1e3:0,resolution:pn,getColor:Ue=>[200,200,200],sizeScale:.8*550,visible:ln(t,9,13),opacity:1,pickable:!0}),new sa({id:"ProjectIconsLayer",data:Fl(pi,Ue=>Ue.LandUse[0]==2),loaders:[es],mesh:"./src/assets/project.obj",raised:!0,getElevation:Ue=>!R&&ln(t,10,10)?1e3:0,resolution:pn,getColor:Ue=>[200,200,200],sizeScale:.8*180,visible:ln(t,9,13),opacity:1,pickable:!0}),new sa({id:"NonProjectIconsLayer",data:Fl(pi,Ue=>Ue.LandUse[0]==3),loaders:[es],mesh:"./src/assets/nonproject.obj",raised:!0,getElevation:Ue=>0,resolution:pn,getColor:Ue=>[200,200,200],sizeScale:.8*140,visible:ln(t,9,13),opacity:1,pickable:!0}),new ao({id:"GroundwaterAgainLayer",data:pi,thicknessRange:[0,1],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>pd(Ue.properties.GroundwaterAverage),visible:ln(t,12,13),opacity:ln(t,13,13)?.5:0,transitions:{opacity:250},pickable:!0}),new ao({id:"DeliveryWaterLayer",data:pi,thicknessRange:[.85,1],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>Wne(Ue.properties.DemandBaselineAverage+Ue.properties.UnmetDemandBaselineAverage),visible:ln(t,11,13),opacity:ln(t,12,13)?.5:0,transitions:{opacity:250},pickable:!0}),new ao({id:"GroundwaterAgainTimed",data:pi,thicknessRange:[0,1],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>pd(Ue.properties.Groundwater[ln(t,13,19)?1026:t==20?1197:Math.floor(s/3)*67%1200]),visible:ln(t,13,21),opacity:ln(t,14,21)?.5:0,transitions:{opacity:250},pickable:!0}),new Ul({id:"ScenarioUnmet",data:pi,loaders:[es],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,resolution:pn,getColor:Ue=>[174,0,255],getValue:t==13?Ue=>0:t==14?Ue=>Hc(Ue.properties.UnmetDemandBaseline[1026]):Ue=>Hc(Ue.properties.UnmetDemand[oo[w]][1026]),sizeScale:3e3,visible:ln(t,13,19),opacity:1,pickable:!0}),new ao({id:"DifferenceLayer",data:pi,thicknessRange:[.65,.8],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>md(Ue.properties.UnmetDemand[oo[w]][1026]-Ue.properties.UnmetDemandBaseline[1026]),visible:ln(t,15,19),opacity:ln(t,16,19)?.5:0,transitions:{opacity:250},pickable:!0}),new Ul({id:"ScenarioUnmet1197",data:pi,loaders:[es],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,resolution:pn,getColor:Ue=>[174,0,255],getValue:Ue=>Hc(Ue.properties.UnmetDemand[oo[s%3]][1197]),sizeScale:3e3,visible:ln(t,20,20),opacity:1,pickable:!0}),new ao({id:"DifferenceLayer1197",data:pi,thicknessRange:[.65,.8],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>md(Ue.properties.UnmetDemand[oo[s%3]][1197]-Ue.properties.UnmetDemandBaseline[1197]),visible:ln(t,19,20),opacity:ln(t,20,20)?.5:0,transitions:{opacity:250},pickable:!0}),new Ul({id:"ScenarioUnmetRandomized",data:pi,loaders:[es],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,resolution:pn,getColor:Ue=>[174,0,255],getValue:Ue=>Hc(Ue.properties.UnmetDemand[oo[s%3]][Math.floor(s/3)*67%1200]),sizeScale:3e3,visible:ln(t,21,21),opacity:1,pickable:!0}),new ao({id:"DifferenceLayerRandomized",data:pi,thicknessRange:[.65,.8],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>md(Ue.properties.UnmetDemand[oo[s%3]][Math.floor(s/3)*67%1200]-Ue.properties.UnmetDemandBaseline[Math.floor(s/3)*67%1200]),visible:ln(t,20,21),opacity:ln(t,21,21)?.5:0,transitions:{opacity:250},pickable:!0}),new ao({id:"GroundwaterEpilogue",data:pi,thicknessRange:[0,1],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>pd(Ue.properties.Groundwater[J]),visible:be&&Nn,opacity:.5,pickable:!0}),new ao({id:"DifferenceEpilogue",data:pi,thicknessRange:[.65,.8],filled:!0,resolution:pn,extruded:!1,raised:!1,getFillColor:Ue=>md(Ue.properties.UnmetDemand[oo[w]][J]-Ue.properties.UnmetDemandBaseline[J]),visible:qe&&Nn,opacity:.5,pickable:!0}),new Ul({id:"ScenarioUnmetEpilogue",data:pi,loaders:[es],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,resolution:pn,getColor:Ue=>[174,0,255],getValue:Ue=>Hc(Ue.properties.UnmetDemand[oo[w]][J]),sizeScale:3e3,visible:ht&&Nn,opacity:1,pickable:!0}),new Ul({id:"ScenarioDemandEpilogue",data:pi,loaders:[es],mesh:"./src/assets/drop.obj",raised:!0,extruded:!1,resolution:pn,getColor:Ue=>[255,158,102],getValue:Ue=>gd(Ue.properties.Demand[oo[w]][J]),sizeScale:3e3,visible:at&&Nn,opacity:1,pickable:!0}),new sa({id:"SettlementIconsEpilogue",data:Fl(pi,Ue=>Ue.LandUse[0]==0),loaders:[es],mesh:"./src/assets/dam.obj",raised:!1,resolution:pn,getColor:Ue=>[200,200,200],sizeScale:.8*500,visible:ut&&Nn,opacity:1,pickable:!0}),new sa({id:"ExhangeIconsEpilogue",data:Fl(pi,Ue=>Ue.LandUse[0]==1),loaders:[es],mesh:"./src/assets/cow.obj",raised:!1,resolution:pn,getColor:Ue=>[200,200,200],sizeScale:.8*550,visible:ut&&Nn,opacity:1,pickable:!0}),new sa({id:"ProjectIconsEpilogue",data:Fl(pi,Ue=>Ue.LandUse[0]==2),loaders:[es],mesh:"./src/assets/project.obj",raised:!1,resolution:pn,getColor:Ue=>[200,200,200],sizeScale:.8*180,visible:ut&&Nn,opacity:1,pickable:!0}),new sa({id:"NonProjectIconsEpilogue",data:Fl(pi,Ue=>Ue.LandUse[0]==3),loaders:[es],mesh:"./src/assets/nonproject.obj",raised:!1,resolution:pn,getColor:Ue=>[200,200,200],sizeScale:.8*140,visible:ut&&Nn,opacity:1,pickable:!0})];return Vn.createElement(Vn.Fragment,null,Vn.createElement(FK,{onViewStateChange:({viewState:Ue})=>{y(Ue.zoom),console.log(Ue)},layers:ti,effects:n,initialViewState:ne,controller:!0,getTooltip:Pn},Vn.createElement(Ste,{reuseMaps:!0,mapLib:Pte,mapStyle:Fte,preventStyleDiffing:!0})),Vn.createElement(Mne,{slide:t,transitioning:R}),(ln(t,1,6)||ln(t,14,1e3))&&Vn.createElement(Fne,{counter:t>=14?ln(t,14,19)?1026:t==20?1197:t==21?Math.floor(s/3)*67%1200:J:ln(t,3,6)?t<=4?1026:1197:i,displayMonth:ln(t,3,6),dataset:t==2?"averageGroundwater":"averageDemandBaseline"}),t<22&&Vn.createElement("button",{onClick:()=>{e(Ue=>Ue+1)},className:"buttons right"},"⟩"),t>0&&Vn.createElement("button",{onClick:()=>{e(Ue=>Ue-1)},className:"buttons left"},"⟨"),ln(t,15,21)&&Vn.createElement("h1",null,_w[ln(t,20,21)?s%3:w]),Nn&&Vn.createElement("button",{onClick:()=>{ge(Ue=>!Ue)},style:{position:"absolute",display:"block",bottom:"20px",right:"50%",transform:"translateX(50%)"}},re?"Pause":"Play"),Nn&&Vn.createElement("input",{onChange:function(Ue){ge(!1),ie(parseInt(Ue.target.value))},onInput:function(Ue){ie(parseInt(Ue.target.value))},value:J,style:{width:"50vw",position:"absolute",display:"block",bottom:"40px",right:"50%",transform:"translateX(50%)"},type:"range",min:"0",max:"1199",id:"myRange"}),Nn&&Vn.createElement("div",{style:{position:"absolute",display:"block",bottom:"20%",right:"0",transform:"translateY(50%)"}},Vn.createElement("div",null,Vn.createElement("input",{type:"checkbox",value:"display1",checked:be,onChange:()=>De(Ue=>!Ue)}),Vn.createElement("label",{htmlFor:"display1"},"Display Groundwater")),Vn.createElement("div",null,Vn.createElement("input",{type:"checkbox",value:"display2",checked:qe,onChange:()=>et(Ue=>!Ue)}),Vn.createElement("label",{htmlFor:"display2"},"Display Difference to Baseline")),Vn.createElement("div",null,Vn.createElement("input",{type:"checkbox",value:"display3",checked:ht,onChange:()=>ot(Ue=>!Ue)}),Vn.createElement("label",{htmlFor:"display3"},"Display Unmet Demand")),Vn.createElement("div",null,Vn.createElement("input",{type:"checkbox",value:"display4",checked:at,onChange:()=>Mt(Ue=>!Ue)}),Vn.createElement("label",{htmlFor:"display4"},"Display Demand")),Vn.createElement("div",null,Vn.createElement("input",{type:"checkbox",value:"display5",checked:ut,onChange:()=>St(Ue=>!Ue)}),Vn.createElement("label",{htmlFor:"display5"},"Display Land Use"))),Nn&&Vn.createElement("div",{onChange:function(Ue){I(Ue.target.value)},style:{position:"absolute",display:"block",bottom:"50%",right:"0",transform:"translateY(50%)"}},Vn.createElement("div",null,Vn.createElement("input",{type:"radio",name:"scenario",value:"0",checked:w==0}),Vn.createElement("label",{htmlFor:"scenario1"},"Scenario 1")),Vn.createElement("div",null,Vn.createElement("input",{type:"radio",name:"scenario",value:"1",checked:w==1}),Vn.createElement("label",{htmlFor:"scenario2"},"Scenario 2")),Vn.createElement("div",null,Vn.createElement("input",{type:"radio",name:"scenario",value:"2",checked:w==2}),Vn.createElement("label",{htmlFor:"scenario3"},"Scenario 3"))))}function qne(t){AP(t).render(Vn.createElement($ne,null))}qne(document.getElementById("app"));
